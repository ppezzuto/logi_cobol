      *((program: AAASA15.cblx))
000001*-------------* PROGRAMMA BATCH MVS COBOL2 DB2  *----------------*
000002 ID DIVISION.                                                     
000003*-------------*                                                   
000004 PROGRAM-ID. AAASA15.                  
000005                                                                  
000006*---------------------------------------------------------------* 
000007*                                                               * 
000008* ==> ATENZIONE MODIFICATO PER OPLA                             * 
000009*                                                               * 
000010* --->>>>> ELABORAZIONE GIORNALIERA                             * 
000011*---------------------------------------------------------------* 
000012*                                                               * 
000013*  - INVIO ORDINI CREATI O VARIATI DALL'ULTIMA ELABORAZIONE     * 
000014*                                                               * 
000015*  - ELABORA FILE RICEVUTI                                      * 
000016*                                                               * 
000017*  - ELABORA FILE NETMOVER                                      * 
000018*  - ELABORA FILE DAZI                                          * 
000019*  - ELABORA FILE LAVORAZIONI                                   * 
000020*                                                               * 
000021*---------------------------------------------------------------* 
000022                                                                  
000023 ENVIRONMENT DIVISION.                                            
000024*---------------------*                                           
000025 CONFIGURATION SECTION.                                           
000026 SPECIAL-NAMES.                                                   
000027     DECIMAL-POINT IS COMMA.                                      
000028 INPUT-OUTPUT SECTION.                                            
000029 FILE-CONTROL.                                                    
000030     SELECT RICEVUT  ASSIGN TO UT-S-RICEVUT.                      
000031     SELECT NETMOVER ASSIGN TO UT-S-NETMOVER.                     
000032     SELECT OUTRICE  ASSIGN TO UT-S-OUTRICE.                      
000033     SELECT OUTNETM  ASSIGN TO UT-S-OUTNETM.                      
000034     SELECT ORDISCO  ASSIGN TO UT-S-ORDISCO.                      
000035                                                                  
000036 DATA DIVISION.                                                   
000037*--------------*                                                  
000038 FILE SECTION.                                                    
000039 FD  RICEVUT                                                      
000040     RECORDING MODE IS F                                          
000041     BLOCK CONTAINS 0 RECORDS.                                    
000042 01  REC-RICEVUT                  PIC X(300).                     
000043                                                                  
000044 FD  NETMOVER                                                     
000045     RECORDING MODE IS F                                          
000046     BLOCK CONTAINS 0 RECORDS.                                    
000047 01  REC-NETMOVER                 PIC X(120).                     
000048                                                                  
000049 FD  OUTRICE                                                      
000050     RECORDING MODE IS F                                          
000051     BLOCK CONTAINS 0 RECORDS.                                    
000052 01  REC-OUTRICE                  PIC X(300).                     
000053                                                                  
000054 FD  OUTNETM                                                      
000055     RECORDING MODE IS F                                          
000056     BLOCK CONTAINS 0 RECORDS.                                    
000057 01  REC-OUTNETM                  PIC X(120).                     
000058                                                                  
000059 FD  ORDISCO                                                      
000060     RECORDING MODE IS F                                          
000061     BLOCK CONTAINS 0 RECORDS.                                    
000062 01  REC-ORDISCO                  PIC X(50).                      
000063                                                                  
000064 WORKING-STORAGE SECTION.

       01  SQLDA-ID pic 9(4) comp-5.
       01  SQLDSIZE pic 9(4) comp-5.
       01  SQL-STMT-ID pic 9(4) comp-5.
       01  SQLVAR-INDEX pic 9(4) comp-5.
       01  SQL-DATA-TYPE pic 9(4) comp-5.
       01  SQL-HOST-VAR-LENGTH pic 9(9) comp-5.
       01  SQL-S-HOST-VAR-LENGTH pic 9(9) comp-5.
       01  SQL-S-LITERAL pic X(258).
       01  SQL-LITERAL1 pic X(130).
       01  SQL-LITERAL2 pic X(130).
       01  SQL-LITERAL3 pic X(130).
       01  SQL-LITERAL4 pic X(130).
       01  SQL-LITERAL5 pic X(130).
       01  SQL-LITERAL6 pic X(130).
       01  SQL-LITERAL7 pic X(130).
       01  SQL-LITERAL8 pic X(130).
       01  SQL-LITERAL9 pic X(130).
       01  SQL-LITERAL10 pic X(130).
       01  SQL-IS-LITERAL pic 9(4) comp-5 value 1.
       01  SQL-IS-INPUT-HVAR pic 9(4) comp-5 value 2.
       01  SQL-CALL-TYPE pic 9(4) comp-5.
       01  SQL-SECTIONUMBER pic 9(4) comp-5.
       01  SQL-INPUT-SQLDA-ID pic 9(4) comp-5.
       01  SQL-OUTPUT-SQLDA-ID pic 9(4) comp-5.
       01  SQLA-PROGRAM-ID.
           05 SQL-PART1 pic 9(4) COMP-5 value 172.
           05 SQL-PART2 pic X(6) value "AEAQAI".
           05 SQL-PART3 pic X(24) value "bACdKCBp01111 2         ".
           05 SQL-PART4 pic 9(4) COMP-5 value 8.
           05 SQL-PART5 pic X(8) value "DB2XMT  ".
           05 SQL-PART6 pic X(120) value LOW-VALUES.
           05 SQL-PART7 pic 9(4) COMP-5 value 8.
           05 SQL-PART8 pic X(8) value "AAASA15 ".
           05 SQL-PART9 pic X(120) value LOW-VALUES.
                                                                        
000065 01  FILLER                       PIC X(08)  VALUE 'DCPARM**'.    
000066*    COPY DCPARM.                                                 
      *>>((file: DCPARM))
000001***************************************************************** 
000002*******                                                         * 
000003*******       A R E A   P A R A M E T R I C A       *COBOL*     * 
000004*******                                                         * 
000005***************************************************************** 
000006 01  DCPARM.                                                      
000007*******  PPNAME   = NOME PROGRAMMA                                
000008     02  PPNAME           PIC X(8)    VALUE SPACES.               
000009*******  PPROUTIN = ROUTINE DA ESEGUIRE                           
000010     02  PPROUTIN         PIC X       VALUE SPACES.               
000011     02  PPSTAT           PIC X(4)    VALUE SPACES.               
000012*******  PPNUSK   = NUMERO DI SCHEDE X LA FUNZIONE -N-            
000013     02  PPNUSK           PIC X(2)    VALUE SPACES.               
000014     02  PPFIRST          PIC X       VALUE SPACES.               
000015*******                                                           
000016*********************** SKEDE PARAMETRO - MAX 10 **************** 
000017*******                                                           
000018     02  SK-PARM.                                                 
000019         05  PPSK1            PIC X(80)   VALUE SPACES.           
000020         05  PPSK2            PIC X(80)   VALUE SPACES.           
000021         05  PPSK3            PIC X(80)   VALUE SPACES.           
000022         05  PPSK4            PIC X(80)   VALUE SPACES.           
000023         05  PPSK5            PIC X(80)   VALUE SPACES.           
000024         05  PPSK6            PIC X(80)   VALUE SPACES.           
000025         05  PPSK7            PIC X(80)   VALUE SPACES.           
000026         05  PPSK8            PIC X(80)   VALUE SPACES.           
000027         05  PPSK9            PIC X(80)   VALUE SPACES.           
000028         05  PPSK10           PIC X(80)   VALUE SPACES.           
000029         05  PPSK11           PIC X(80)   VALUE SPACES.           
000030     02  TAB-SK-PARM REDEFINES SK-PARM.                           
000031         05  EL-SK-PARM OCCURS 11 TIMES.                          
000032             10  NAME-SK-PARM     PIC XX.                         
000033             10  FILLER           PIC X.                          
000034             10  DATA-SK-PARM     PIC X(77).                      
000035*******                                                           
000036*********************** ELEMENTO DI RICERCA ********************* 
000037*******                                                           
000038*******  PPNMFILE  = NOME FILE                                    
000039     02  PPNMFILE         PIC X(7)    VALUE SPACES.               
000040*******  PPTPFILE  = TIPO FILE                                    
000041     02  PPTPFILE         PIC X(1)    VALUE SPACES.               
000042*******  PPTPOPER  = TIPO OPERAZIONE                              
000043     02  PPTPOPER         PIC X(1)    VALUE SPACES.               
000044     02  FILLER           PIC X(7)    VALUE SPACES.               
000045*******                                                           
000046*********************** TABELLA DI 30 ELEMENTI ****************** 
000047*******                                                           
000048     02  TAB-CONTATORI.                                           
000049         05  EL-CONTATORI OCCURS 30 TIMES.                        
000050             10  EL-PPNMFILE      PIC X(7)        VALUE SPACES.   
000051             10  EL-PPTPFILE      PIC X           VALUE SPACES.   
000052             10  EL-PPTPOPER      PIC X           VALUE SPACES.   
000053             10  EL-CONTATOR      PIC 9(9) COMP-3 VALUE ZEROES.   
000054             10  EL-FILLER        PIC XX          VALUE SPACES.   
000055*    02  FILLER           PIC X(7)     VALUE SPACES.              
000056*******              TIPO FILE                                    
000057*    02  FILLER           PIC X(1)     VALUE SPACES.              
000058*******              TIPO OPERAZIONE                              
000059*    02  FILLER           PIC X(1)     VALUE SPACES.              
000060*******              NUMERO OPERAZIONI                            
000061*    02  FILLER           PIC 9(9)     COMP-3    VALUE ZERO.      
000062*    02  FILLER           PIC X(2)     VALUE SPACES.              
000063*******  29 CAMPI DA 16 BYTES, IN TOTALE 464 BYTES                
000064*    02  FILLER           PIC X(464)   VALUE SPACES.              
000065*******                                                           
000066*********************** STAMPA MESSAGGI ************************* 
000067*******                                                           
000068*******  PPMESSAG  = MESSAGGIO DA STAMPARE                        
000069     02  PPMESSAG         PIC X(132)  VALUE SPACES.               
000070     02  FILLER           PIC X(4)    VALUE SPACES.               
000071*******                                                           
000072*********************** DATE DA TABE TABPRODA ******************* 
000073*******                                                           
000074*******  DATA-PROG = NOME ELEMENTO DI TABE TABPRODA               
000075     02  DATA-PROG        PIC X(7)    VALUE SPACES.               
000076*******  DATA-TIPO = TIPO DI DATA  DI TABE TABPRODA               
000077     02  DATA-TIPO        PIC X       VALUE SPACES.               
000078*******  DATA-INIZ = DATA INIZIO PERIODO                          
000079     02  DATA-INIZ.                                               
000080         05  GG-INIZ.                                             
000081             10  SS-CORSO PIC XX      VALUE SPACES.               
000082         05  MM-INIZ      PIC XX      VALUE SPACES.               
000083         05  AA-INIZ      PIC XX      VALUE SPACES.               
000084*******  DATA-FINE = DATA FINE PERIODO                            
000085     02  DATA-FINE.                                               
000086         05  GG-FINE      PIC XX      VALUE SPACES.               
000087         05  MM-FINE      PIC XX      VALUE SPACES.               
000088         05  AA-FINE      PIC XX      VALUE SPACES.               
000089     02  FILLER           PIC X(4)    VALUE SPACES.               
000090*******                                                           
000091*********************** CALL GENERALIZZATA ********************** 
000092*******                                                           
000093*******  PPCALL    = NOME MODULO X CALLER                         
000094     02  PPCALL           PIC X(8)    VALUE SPACES.               
000095*******                                                           
000096***************************************************************** 
000097*  EJECT                                                          
      *<<((file: DCPARM))
000067 01  FILLER                       PIC X(08)  VALUE 'DCDB2ER*'.    
000068*    COPY DCDB2ER.                                                
      *>>((file: DCDB2ER))
000001******************************************************************
000002*****               AREA PER MODULO SCDB2ER                  *****
000003******************************************************************
000004 01  DCDB2ER.                                                     
000005     02 WCOM-LUNGHEZZ         PIC S9(3) COMP-3 VALUE +171.        
000006     02 WCOM-FILEFUNZ         PIC X(10).                          
000007     02 WCOM-FILENOME         PIC X(30).                          
000008     02 WCOM-FILECTRL         PIC X(30).                          
000009     02 WCOM-MESSAGES         PIC X(80).                          
000010     02 WCOM-CODABEND         PIC X(4).                           
000011     02 MESS-CODERROR         PIC X(6).                           
000012     02 WSWERROR              PIC X.                              
000013        88 ERRORE             VALUE '*'.                          
000014     02 WCOM-PROGNAME         PIC X(8).                           
      *<<((file: DCDB2ER))
000069 01  FILLER                       PIC X(08)  VALUE 'DCWDTEL*'.    
000070*    COPY DCWDTEL.                                                
      *>>((file: DCWDTEL))
000001***************************************************************** 
000002******         AREA PASSAGGIO CHIAMATA                     ****** 
000003******             MODULO  SCTDTEL (LENGTH 100)            ****** 
000004***************************************************************** 
000005 01  DCWDTEL.                                                     
000006*                         ZEROES SE OK  ALTRIMENTI SQLCODE        
000007     05 DTEL-RETCOD              PIC S9(3).                       
000008*                         R = LETTURA   U = AGGIORNAMENTO         
000009     05 DTEL-TIPORICH            PIC X.                           
000010     05 DTEL-SIGLDATA            PIC X(8).                        
000011*         G=AAAAAAA   S=SETTIMA   M=MENSILE   A=ANNUALE   W=WEEK  
000012     05 DTEL-DATATIPO            PIC X(1).                        
000013*                                                                 
000014     05 DTEL-DTINELAB            PIC X(8).                        
000015     05 DTEL-TMINELAB            PIC X(6).                        
000016     05 DTEL-DTFIELAB            PIC X(8).                        
000017     05 DTEL-TMFIELAB            PIC X(6).                        
000018     05 FILLER                   PIC X(59).                       
      *<<((file: DCWDTEL))
000071 01  FILLER                       PIC X(08)  VALUE 'FSGTMO**'.    
000072*    COPY FSGTMO.                                                 
      *>>((file: FSGTMO))
000001******************************************************************
000002*                       -- FSGTMO --                             *
000003*                  DSECT FILE DI OUTPUT X GTM                    *
000004*                      LUNGHEZZA REC. 300                        *
000005******************************************************************
000006 01  FSGTMO.                                                      
000007     03  FSGT-SOCIETAX                  PIC X.                    
000008     03  FSGT-DIVISION                  PIC X.                    
000009     03  FSGT-NUMORDIN                  PIC X(5).                 
000010     03  FSGT-FORNITOR                  PIC X(5).                 
000011     03  FSGT-ARTICOLI.                                           
000012         05  FSGT-DEPOSITO              PIC X.                    
000013         05  FSGT-ARTICOLO              PIC X(4).                 
000014         05  FSGT-VARIANTE              PIC X(3).                 
000015     03  FSGT-CODIARTI REDEFINES FSGT-ARTICOLI.                   
000016         05  FSGT-STABILIM              PIC X.                    
000017         05  FILLER                     PIC X.                    
000018         05  FSGT-CODARTIC              PIC X(4).                 
000019         05  FILLER                     PIC X(2).                 
000020     03  FSGT-NUMBOLLA                  PIC X(5).                 
000021     03  FSGT-DTMAGAZZ.                                           
000022         05  FSGT-GGMAGAZZ              PIC X(2).                 
000023         05  FSGT-MMMAGAZZ              PIC X(2).                 
000024         05  FSGT-AAMAGAZZ              PIC X(2).                 
000025*--- VALORE 'F'   DA FATTURARE                                    
000026*---        'R'   RESO                                            
000027*---        'S'   STORNO                                          
000028*---        'Z'   RESO DA STORNARE                                
000029     03  FSGT-F-R-S-XX                  PIC X.                    
000030     03  FSGT-DTORDINE.                                           
000031         05  FSGT-GGORDINE              PIC 9(2).                 
000032         05  FSGT-MMORDINE              PIC 9(2).                 
000033         05  FSGT-AAORDINE              PIC 9(2).                 
000034     03  FSGT-DTCONSEG.                                           
000035         05  FSGT-GGCONSEG              PIC 9(2).                 
000036         05  FSGT-MMCONSEG              PIC 9(2).                 
000037         05  FSGT-AACONSEG              PIC 9(2).                 
000038     03  FSGT-DESCORDI                  PIC X(16).                
000039     03  FSGT-NUMRICIN                  PIC X(5).                 
000040     03  FSGT-SERVIZIO                  PIC X(3).                 
000041     03  FSGT-VOCIXXXX                  PIC S9(3)       COMP-3.   
000042     03  FSGT-MAGRIC                    PIC X.                    
000043     03  FILLER                         PIC X(3) VALUE SPACE.     
000044     03  FSGT-DIVISAXX                  PIC X(2).                 
000045     03  FSGT-PREZZOXX                  PIC S9(9)V99    COMP-3.   
000046     03  FSGT-SCONTOME.                                           
000047         05  FSGT-SCONTO1X              PIC X(2).                 
000048         05  FSGT-SCONTO2X              PIC X(2).                 
000049         05  FSGT-SCONTO3X              PIC X(2).                 
000050     03  FSGT-QTARICEV                  PIC S9(7)V99    COMP-3.   
000051     03  FSGT-UNMISURA                  PIC X(2).                 
000052*--- VALORE 'A' ACCONTO                                           
000053*---        'S' A SALDO                                           
000054     03  FSGT-ACCOSALD                  PIC X.                    
000055     03  FSGT-CENCOSTO                  PIC X(5).                 
000056     03  FSGT-CONTODCE                  PIC X(4).                 
000057     03  FSGT-DESCARTI                  PIC X(36).                
000058     03  FSGT-NOTEXXXX                  PIC X(30).                
000059     03  FSGT-NRRIGORD                  PIC 9(03).                
000060     03  FSGT-NRRIGORX REDEFINES FSGT-NRRIGORD PIC X(3).          
000061     03  FSGT-AANUMORD                  PIC X(08).                
000062     03  FSGT-DTBOLLAX.                                           
000063         05  FSGT-GGBOLLAX              PIC X(2).                 
000064         05  FSGT-MMBOLLAX              PIC X(2).                 
000065         05  FSGT-AABOLLAX              PIC X(2).                 
000066     03  FSGT-UFFIPROV                  PIC X(5).                 
000067     03  FSGT-STAGIONE                  PIC X(2).                 
000068     03  FSGT-NRDISTIN                  PIC X(5).                 
000069     03  FSGT-TIPOPAGA                  PIC X(1).                 
000070     03  FSGT-GGSCADEN                  PIC X(12).                
000071     03  FSGT-GIORNOPA                  PIC X(2).                 
000072     03  FSGT-SCONTOPA                  PIC X(3).                 
000073*--- TIPO EDIT PER PREZZO                                         
000074*---        ' '   PREZZO SENZA DECIMALI                           
000075*---        '1'   PREZZO CON 1 DECIMALI                           
000076*---        '2'   PREZZO CON 2 DECIMALI                           
000077*---        '3'   PREZZO CON 3 DECIMALI                           
000078*---        '4'   PREZZO CON 4 DECIMALI                           
000079     03  FSGT-EDIPRICE                  PIC X.                    
000080     03  FSGT-QTRUNMIS REDEFINES FSGT-EDIPRICE PIC X.             
000081     03  FSGT-AANUMMOV                  PIC X(10).                
000082     03  FSGT-FLBLOCPA                  PIC X(01).                
000083     03  FSGT-CODDEPOS                  PIC X(02).                
000084     03  FSGT-NUMAUTOR                  PIC X(05).                
000085     03  FSGT-COMMESSA                  PIC X(5).                 
000086     03  FSGT-SOCIETAN                  PIC X(2).                 
000087     03  FSGT-CONTDCEN                  PIC X(6).                 
000088     03  FSGT-TARGVETT                  PIC X(09).                
000089     03  FSGT-NOMUTENT                  PIC X(30).                
000090     03  FSGT-MERCEMAG                  PIC X(02).                
000091     03  FILLER                         PIC X(09).                
000092******************************************************************
      *<<((file: FSGTMO))
000073 01  FILLER                       PIC X(08)  VALUE 'FSNET09*'.    
000074*    COPY FSNET09.                                                
      *>>((file: FSNET09))
000001******************************************************************
000002** -NETMOVER- DSECT PER INVIO DATI A GTM (DAZI/DDT/RDT)         **
000003**                   LUNGHEZZA REC. 120                         **
000004******************************************************************
000005 01  FSNET09.                                                     
000006     05 N09-CODSOCIE             PIC X(02).                       
000007     05 N09-DIVISION             PIC X(01).                       
000008     05 N09-CODFORNI             PIC X(05).                       
000009     05 N09-SERVIZIO             PIC X(03).                       
000010     05 N09-CENCOSTO             PIC X(05).                       
000011     05 N09-CONTODCE             PIC X(06).                       
000012     05 N09-DESCRXXX             PIC X(30).                       
000013     05 N09-IMPORTOX             PIC S9(12)V999.                  
000014     05 N09-CODDIVIS             PIC X(03).                       
000015     05 N09-NUMBOLLA             PIC X(05).                       
000016     05 N09-DATBOLLA             PIC X(08).                       
000017     05 N09-FILLERXX             PIC X(19).                       
000018     05 N09-NRPREFAT             PIC X(10).                       
000019     05 N09-DATAELAB             PIC X(08).                       
      *<<((file: FSNET09))
000075 01  FILLER                       PIC X(08)  VALUE ' DCWCAMB'.    
000076*    COPY DCWCAMB.                                                
      *>>((file: DCWCAMB))
000001******************************************************************
000002******              AREA PASSAGGIO CHIAMATA                 ******
000003******         MODULI SCTCB05, SCBCB05, SCTCB10 E SCBCB10   ******
000004******         LENGTH -250-                                 ******
000005******                                                      ******
000006******   DATI-INPUT                                         ******
000007******         DA : CAMB-SIGLADIV                           ******
000008******          A   CAMB-SIGLACAM                           ******
000009******        OPPURE                                        ******
000010******         DA : CAMB-CODDIVIS                           ******
000011******          A   CAMB-CODCAMBI                           ******
000012******        OPPURE                                        ******
000013******         DA : CAMB-CODDIVIS                           ******
000014******          A   CAMB-SIGLACAM                           ******
000015******        OPPURE                                        ******
000016******         DA : CAMB-SIGLADIV                           ******
000017******          A   CAMB-CODCAMBI                           ******
000018******************************************************************
000019 01  DCWCAMB.                                                     
000020   02  CAMB-DATI-INPUT.                                           
000021     03  CAMB-DATI-COMUNI.                                        
000022       05  CAMB-SIGLACAM            PIC X(3).                     
000023       05  CAMB-SIGLADIV            PIC X(3).                     
000024       05  CAMB-CODCAMBI            PIC X(2).                     
000025       05  CAMB-CODDIVIS            PIC X(2).                     
000026       05  CAMB-IMPORTOO OCCURS 5   PIC S9(11)V99.                
000027       05  CAMB-DTCAMBIO            PIC X(8).                     
000028       05  CAMB-SOCIRIFE            PIC X(2).                     
000029       05  CAMB-CODDRIFE            PIC X(2).                     
000030       05  CAMB-SIGLRIFE            PIC X(3).                     
000031       05  FILLER                   PIC X(23).                    
000032   02  CAMB-DATI-OUTPUT.                                          
000033     03  CAMB-DATI-SIGLACAM.                                      
000034       05  CAMB-CAMBCAMB            PIC S9(9)V9999 COMP-3.        
000035       05  CAMB-DESCCAMB            PIC X(20).                    
000036       05  CAMB-DECICAMB            PIC X.                        
000037       05  CAMB-CAMBBANC            PIC X(3).                     
000038       05  CAMB-CAMBPREZ            PIC X.                        
000039     03  CAMB-DATI-SIGLADIV.                                      
000040       05  FILLER                   PIC X(7).                     
000041       05  CAMB-DESCDIVI            PIC X(20).                    
000042       05  CAMB-DECIDIVI            PIC X.                        
000043       05  CAMB-DIVIBANC            PIC X(3).                     
000044       05  CAMB-DIVIPREZ            PIC X.                        
000045     03  CAMB-CONTROVA OCCURS 5     PIC S9(11)V99  COMP-3.        
000046     03  CAMB-RAPPCAMB              PIC S9(5)      COMP-3.        
000047     03  CAMB-RAPPDIVI              PIC S9(5)      COMP-3.        
000048     03  CAMB-CAMBIODV              PIC S9(7)V9(6) COMP-3.        
000049     03  CAMB-CAMBDV10              PIC S9(5)V9(10) COMP-3.       
000050     03  FILLER                     PIC X(13).                    
000051     03  CAMB-RETCOD                PIC X(4).                     
      *<<((file: DCWCAMB))
000077 01  FILLER                       PIC X(08)  VALUE ' DCWCCOS'.    
000078*    COPY DCWCCOS.                                                
      *>>((file: DCWCCOS))
000001*----------------------------------------------------------------*
000002*-----------------------  DCWCCOS  ------------------------------*
000003*----------------------------------------------------------------*
000004 01  CCOS-LUNGHEZZ               PIC S9(4) COMP   VALUE +100.     
000005 01  DCWCCOS.                                                     
000006     05 CCOS-INPUT.                                               
000007        10  CCOS-MERCEMAG           PIC X(02).                    
000008        10  CCOS-CODARTIC           PIC X(05).                    
000009        10  CCOS-CODDISEG           PIC X(05).                    
000010        10  CCOS-CODVARIA           PIC X(03).                    
000011        10  CCOS-CODLINEA           PIC X(02).                    
000012        10  CCOS-TIPOSTAG           PIC X(01).                    
000013        10  CCOS-CODCLIEN           PIC X(05).                    
000014        10  CCOS-FLREGDIF           PIC X(01).                    
000015        10  CCOS-PAESORDI           PIC X(03).                    
000016        10  CCOS-PROLOMER           PIC X(02).                    
000017        10  CCOS-FLAGADDE           PIC X(01).                    
000018        10  CCOS-RGCLASSE           PIC X(01).                    
000019        10  CCOS-FILLER01           PIC X(19).                    
000020     05 CCOS-OUTPUT.                                              
000021        10  CCOS-SQLCODE            PIC S9(5) COMP-3.             
000022        10  CCOS-CENCOCOM           PIC X(05).                    
000023        10  CCOS-CENCOPRO           PIC X(05).                    
000024        10  CCOS-CENCOALL           PIC X(05).                    
000025        10  CCOS-CENCOGEN           PIC X(05).                    
000026        10  CCOS-CENCOPAE           PIC X(05).                    
000027        10  CCOS-FILLER02           PIC X(22).                    
      *<<((file: DCWCCOS))
000079                                                                  
000080 01  FILLER                       PIC X(08)  VALUE 'COMODI**'.    
000081 01  COMODI.                                                      
000082     05 WS-NUMPROGR-X             PIC  X(5).                      
000083     05 WS-NUMPROGR-9 REDEFINES WS-NUMPROGR-X                     
000084                                  PIC  9(5).                      
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000085     05 WS-PO-ITEMX               PIC  X(5).                      
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000086     05 WS-PO-ITEM REDEFINES      WS-PO-ITEMX                     
000087                                  PIC  9(5).                      
000088     05 WS-PO-ITEM3X              PIC  X(3).                      
000089     05 WS-PO-ITEM3 REDEFINES     WS-PO-ITEM3X                    
000090                                  PIC  9(3).                      
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000091     05 WS-NRRIGORDX              PIC  X(3).                      
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000092     05 WS-NRRIGORD REDEFINES     WS-NRRIGORDX                    
000093                                  PIC  9(3).                      
000094                                                                  
000095     05 WS-PERCSCON               PIC  9(3) VALUE ZEROS.          
000096     05 WS-PREZZMER               PIC S9(11)V9(04) VALUE ZEROS.   
000097     05 WS-AANUMORD               PIC  X(08) VALUE SPACES.        
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000098     05 WS-DATAELAB               PIC  X(08) VALUE SPACES.        
000099     05 WS-CODARTIC               PIC  X(05) VALUE SPACES.        
000100     05 WS-DESARTIC               PIC  X(50) VALUE SPACES.        
000101     05 WS-VOCEDOGA               PIC  X(12) VALUE SPACES.        
000102     05 WS-PESOGRMT               PIC S9(05) COMP-3     VALUE +0. 
000103     05 WS-VOLUMEXX               PIC S9(1)V9(3) COMP-3 VALUE +0. 
000104     05 WS-ELEMENTO-WBS           PIC  X(50) VALUE SPACES.        
000105     05 WS-SOCIEGTM               PIC  X(02) VALUE SPACES.        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000106     05 WS-NOSAPXXX               PIC  X(02) VALUE SPACES.        
000107     05 WS-ODACICS                PIC  X(10) VALUE SPACES.        
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000108     05 WS-FLAGFLAG               PIC  X(01) VALUE SPACES.        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000109     05 WS-PRODTYPE               PIC  X(02) VALUE SPACES.        
000110                                                                  
000111     05 IND1                      PIC S9(3) VALUE ZEROS.          
000112     05 IND2                      PIC S9(3) VALUE ZEROS.          
000113     05 WS-COMODOXX.                                              
000114        10 WS-BYTEBYTE OCCURS 5   PIC X(01).                      
000115     05 WS-COMODOX2.                                              
000116        10 WS-BYTEBYT2 OCCURS 5   PIC X(01).                      
000117                                                                  
000118 01  FILLER                       PIC X(08)  VALUE 'SK-PARAM'.    
000119 01  SK-PARAM.                                                    
000120     05 SK-TIPOELAB               PIC X(10).                      
000121     05 SK-FILLER1                PIC X(70).                      
000122                                                                  
000123 01  FILLER                       PIC X(08)  VALUE 'ORDISCO*'.    
000124 01  WOUT-ORDISCO.                                                
000125     05 WOUT-AANUMORD             PIC X(08) VALUE SPACES.         
000126     05 WOUT-NRCOMMES             PIC X(24) VALUE SPACES.         
000127     05 FILLER                    PIC X(18) VALUE SPACES.         
000128                                                                  
000129*------------------------------- DANAGRAF.TMULTITABLE(SCORCLAU)   
000130 01  FILLER                      PIC X(8)  VALUE 'FDANAB44'.      
000131*    EXEC SQL  INCLUDE FDANAB44   END-EXEC.                       
      *>>((file: FDANAB44))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.VANAGRAF_B44              *
000003******************************************************************
000004 01  DCLVANAGRAF-B44.                                             
000005*                       CODARTSC                                  
000006     10 AB44-CODARTSC        PIC X(10).                           
000007*                       NUMPROGR                                  
000008     10 AB44-NUMPROGR        PIC S9(10)V9(3) USAGE COMP-3.        
000009*                       CODARTS1                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000010     10 AB44-CODARTS1        PIC X(20).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000011*                       CONTODCE                                  
000012     10 AB44-CONTODCE        PIC X(20).                           
000013******************************************************************
000014* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 4       *
000015******************************************************************
      *<<((file: FDANAB44))
000132                                                                  
000133*------------------------------- DANAGRAF.TMULTITABLE(SCORTDCE)   
000134 01  FILLER                      PIC X(8)  VALUE 'FDANAD22'.      
000135*    EXEC SQL  INCLUDE FDANAD22   END-EXEC.                       
      *>>((file: FDANAD22))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.VANAGRAF_D22)                            *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANAD22))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(AD22-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DANAGRAF.VANAGRAF_D22 TABLE                 
000012*     ( CONTGRUP                       CHAR(10) NOT NULL,          
000013*       DECONGRU                       CHAR(20) NOT NULL,          
000014*       CDVALSCO                       CHAR(20) NOT NULL,          
000015*       DEVALSCO                       CHAR(20) NOT NULL,          
000016*       CODTIPSC                       CHAR(20) NOT NULL,          
000017*       SOLLECIT                       CHAR(20) NOT NULL           
000018*     ) END-EXEC
                                                                        
000019******************************************************************
000020* COBOL DECLARATION FOR TABLE DANAGRAF.VANAGRAF_D22              *
000021******************************************************************
000022 01  DCLVANAGRAF-D22.                                             
000023*                       CONTGRUP                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000024     10 AD22-CONTGRUP        PIC X(10).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025*                       DECONGRU                                  
000026     10 AD22-DECONGRU        PIC X(20).                           
000027*                       CDVALSCO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000028     10 AD22-CDVALSCO        PIC X(20).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000029*                       DEVALSCO                                  
000030     10 AD22-DEVALSCO        PIC X(20).                           
000031*                       CODTIPSC                                  
000032     10 AD22-CODTIPSC        PIC X(20).                           
000033*                       SOLLECIT                                  
000034     10 AD22-SOLLECIT        PIC X(20).                           
000035******************************************************************
000036* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 6       *
000037******************************************************************
      *<<((file: FDANAD22))
000136                                                                  
000137*------------------------------- DANAGRAF.TMULTITABLE(SCARDATE)   
000138 01  FILLER                      PIC X(8)  VALUE 'FDANAC64'.      
000139*    EXEC SQL  INCLUDE FDANAC64   END-EXEC.                       
      *>>((file: FDANAC64))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.VANAGRAF_C64)                            *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANAC64))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(AC64-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DANAGRAF.VANAGRAF_C64 TABLE                 
000012*     ( SIGLDATA                       CHAR(10) NOT NULL,          
000013*       DTINELAB                       CHAR(20) NOT NULL,          
000014*       DESCDATA                       CHAR(40) NOT NULL,          
000015*       MIROULMI                       CHAR(20) NOT NULL           
000016*     ) END-EXEC
                                                                        
000017******************************************************************
000018* COBOL DECLARATION FOR TABLE DANAGRAF.VANAGRAF_C64              *
000019******************************************************************
000020 01  DCLVANAGRAF-C64.                                             
000021*                       SIGLDATA                                  
000022     10 AC64-SIGLDATA        PIC X(10).                           
000023*                       DTINELAB                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000024     10 AC64-DTINELAB        PIC X(20).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025*                       DESCDATA                                  
000026     10 AC64-DESCDATA        PIC X(40).                           
000027*                       MIROULMI                                  
000028     10 AC64-MIROULMI        PIC X(20).                           
000029******************************************************************
000030* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 4       *
000031******************************************************************
      *<<((file: FDANAC64))
000140                                                                  
000141*------------------------------- DANAGRAF.TMULTITABLE(RESAMERC)   
000142 01  FILLER                      PIC X(8)  VALUE 'FDANA113'.      
000143*    EXEC SQL  INCLUDE FDANA113   END-EXEC.                       
      *>>((file: FDANA113))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.VANAGRAF_113)                            *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA113))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(A113-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DANAGRAF.VANAGRAF_113 TABLE                 
000012*     ( CODIRESA                       CHAR(10) NOT NULL,          
000013*       DESCRESA                       CHAR(40) NOT NULL,          
000014*       CODILING                       CHAR(20) NOT NULL,          
000015*       INDSEGNO                       CHAR(20) NOT NULL,          
000016*       CONDRESA                       CHAR(20) NOT NULL,          
000017*       FLAGESPR                       CHAR(20) NOT NULL,          
000018*       SPETRASP                       CHAR(20) NOT NULL,          
000019*       CDRESSCA                       DECIMAL(13, 3) NOT NULL,    
000020*       FLGABBEX                       DECIMAL(13, 3) NOT NULL     
000021*     ) END-EXEC
                                                                        
000022******************************************************************
000023* COBOL DECLARATION FOR TABLE DANAGRAF.VANAGRAF_113              *
000024******************************************************************
000025 01  DCLVANAGRAF-113.                                             
000026*                       CODIRESA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000027     10 A113-CODIRESA        PIC X(10).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000028*                       DESCRESA                                  
000029     10 A113-DESCRESA        PIC X(40).                           
000030*                       CODILING                                  
000031     10 A113-CODILING        PIC X(20).                           
000032*                       INDSEGNO                                  
000033     10 A113-INDSEGNO        PIC X(20).                           
000034*                       CONDRESA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000035     10 A113-CONDRESA        PIC X(20).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000036*                       FLAGESPR                                  
000037     10 A113-FLAGESPR        PIC X(20).                           
000038*                       SPETRASP                                  
000039     10 A113-SPETRASP        PIC X(20).                           
000040*                       CDRESSCA                                  
000041     10 A113-CDRESSCA        PIC S9(10)V9(3) USAGE COMP-3.        
000042*                       FLGABBEX                                  
000043     10 A113-FLGABBEX        PIC S9(10)V9(3) USAGE COMP-3.        
000044******************************************************************
000045* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 9       *
000046******************************************************************
      *<<((file: FDANA113))
000144                                                                  
000145*------------------------------- DANAGRAF.TMULTITABLE(BUYER)      
000146 01  FILLER                      PIC X(8)  VALUE 'FDANAD99'.      
000147*    EXEC SQL  INCLUDE FDANAD99   END-EXEC.                       
      *>>((file: FDANAD99))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.VANAGRAF_D99)                            *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANAD99))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(AD99-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DANAGRAF.VANAGRAF_D99 TABLE                 
000012*     ( CODBUYER                       CHAR(10) NOT NULL,          
000013*       DESBUYER                       CHAR(40) NOT NULL,          
000014*       BUYERGTM                       CHAR(20) NOT NULL,          
000015*       CODUTENT                       CHAR(20) NOT NULL           
000016*     ) END-EXEC
                                                                        
000017******************************************************************
000018* COBOL DECLARATION FOR TABLE DANAGRAF.VANAGRAF_D99              *
000019******************************************************************
000020 01  DCLVANAGRAF-D99.                                             
000021*                       CODBUYER                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000022     10 AD99-CODBUYER        PIC X(10).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000023*                       DESBUYER                                  
000024     10 AD99-DESBUYER        PIC X(40).                           
000025*                       BUYERGTM                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000026     10 AD99-BUYERGTM        PIC X(20).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000027*                       CODUTENT                                  
000028     10 AD99-CODUTENT        PIC X(20).                           
000029******************************************************************
000030* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 4       *
000031******************************************************************
      *<<((file: FDANAD99))
000148                                                                  
000149*------------------------------- DANAGRAF.TSOCIETA                
000150 01  FILLER                      PIC X(8)  VALUE 'FDANA531'.      
000151*    EXEC SQL  INCLUDE FDANA531   END-EXEC.                       
      *>>((file: FDANA531))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TSOCIETA                  *
000003******************************************************************
000004 01  DCLTSOCIETA.                                                 
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 A531-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000006     10 A531-NOMSOCIE        PIC X(23).                           
000007     10 A531-CODFORNI        PIC X(5).                            
000008     10 A531-TASSINTE        PIC S9(3)V9(2) USAGE COMP-3.         
000009     10 A531-CODPAESE        PIC X(3).                            
000010     10 A531-NRGGRISC        PIC S9(3)V USAGE COMP-3.             
000011     10 A531-CODPIANO        PIC X(2).                            
000012     10 A531-CITTASOC        PIC X(18).                           
000013     10 A531-FLPAGIVA        PIC X(1).                            
000014     10 A531-FLFATACQ        PIC X(1).                            
000015     10 A531-CODAZIEN        PIC X(5).                            
000016     10 A531-FLIVATRA        PIC X(1).                            
000017     10 A531-CODDIVIS        PIC X(2).                            
000018     10 A531-COSTINTE        PIC S9(3)V9(2) USAGE COMP-3.         
000019     10 A531-FLCONTAB        PIC X(1).                            
000020     10 A531-FLAGMAGA        PIC X(1).                            
000021     10 A531-RAGSOCIE        PIC X(50).                           
000022     10 A531-SOCIECON        PIC X(2).                            
000023     10 A531-DTCREAZI        PIC X(8).                            
000024     10 A531-DTULTVAR        PIC X(8).                            
000025     10 A531-CODUTVAR        PIC X(6).                            
000026     10 A531-INDLEGAL        PIC X(35).                           
000027     10 A531-CAPLEGAL        PIC X(5).                            
000028     10 A531-CITLEGAL        PIC X(18).                           
000029     10 A531-CODFISCA        PIC X(16).                           
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000030     10 A531-CODDIVRI        PIC X(2).                            
000031     10 A531-SOCIEGTM        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000032     10 A531-GENEFATT        PIC X(1).                            
000033     10 A531-FLAGATTI        PIC X(1).                            
000034     10 A531-DIVISOLD        PIC X(2).                            
000035     10 A531-DTFINOLD        PIC X(8).                            
000036     10 A531-DIVRIOLD        PIC X(2).                            
000037     10 A531-DIVIRIFA        PIC X(2).                            
000038     10 A531-FLEURUSA        PIC X(1).                            
000039     10 A531-FLAGLIMI        PIC X(1).                            
000040     10 A531-FLFILIAL        PIC X(1).                            
000041     10 A531-FLPRESEN        PIC X(1).                            
000042     10 A531-CODSOCPA        PIC X(1).                            
000043     10 A531-FLBOLGVB        PIC X(1).                            
000044     10 A531-FLSTCART        PIC X(1).                            
000045     10 A531-FLDIPEST        PIC X(1).                            
000046     10 A531-CODFIRMA        PIC X(8).                            
000047     10 A531-DESFIRMA        PIC X(24).                           
000048     10 A531-CDSOCJDE        PIC X(5).                            
000049     10 A531-CODFORNV        PIC X(5).                            
000050     10 A531-CODFORNA        PIC X(5).                            
000051     10 A531-IMPCCASO        PIC S9(13) COMP-3.                   
000052     10 A531-TRIBCCIA        PIC X(10).                           
000053     10 A531-PROLEGAL        PIC X(2).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000054     10 A531-FLSOCSAP        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000055     10 A531-DIVIXLAV        PIC X(2).                            
000056******************************************************************
000057* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 51      *
000058******************************************************************
      *<<((file: FDANA531))
000152                                                                  
000153*------------------------------- DANAGRAF.TSTABILIMENTI           
000154 01  FILLER                      PIC X(8)  VALUE 'FDANA838'.      
000155*    EXEC SQL  INCLUDE FDANA838   END-EXEC.                       
      *>>((file: FDANA838))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TSTABILIMENTI)                           *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA838))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(A838-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011******************************************************************
000012* COBOL DECLARATION FOR TABLE DANAGRAF.TSTABILIMENTI             *
000013******************************************************************
000014 01  DCLTSTABILIMENTI.                                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000015     10 A838-STABILIM        PIC X(2).                            
000016     10 A838-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000017     10 A838-NOMESTAB        PIC X(24).                           
000018     10 A838-INDISTAB        PIC X(24).                           
000019     10 A838-CITTSTAB        PIC X(18).                           
000020     10 A838-CAPSTABI        PIC X(5).                            
000021     10 A838-CODIZONA        PIC X(2).                            
000022     10 A838-CODPAESE        PIC X(3).                            
000023     10 A838-CENCOSTO        PIC X(5).                            
000024     10 A838-CODFORNI        PIC X(5).                            
000025     10 A838-CODDEPFF        PIC X(2).                            
000026     10 A838-CODDEPGG        PIC X(2).                            
000027     10 A838-CODDEPTT        PIC X(2).                            
000028     10 A838-NRPOSMAG        PIC X(1).                            
000029     10 A838-FLLOCREM        PIC X(1).                            
000030     10 A838-ESNOMSTA        PIC X(50).                           
000031     10 A838-FLPALAUT        PIC X(1).                            
000032     10 A838-FLGESFIL        PIC X(1).                            
000033     10 A838-FLGESSUB        PIC X(1).                            
000034     10 A838-FLGESGRE        PIC X(1).                            
000035     10 A838-DTCREAZI        PIC X(8).                            
000036     10 A838-DTULTVAR        PIC X(8).                            
000037     10 A838-CODUTVAR        PIC X(6).                            
000038     10 A838-PRIMNLOT        PIC X(1).                            
000039     10 A838-LUNGNLOT        PIC X(2).                            
000040     10 A838-FLIMBAUT        PIC X(1).                            
000041     10 A838-FLIMBMAN        PIC X(1).                            
000042     10 A838-FLAGMAGA        PIC X(1).                            
000043     10 A838-FLREPSUC        PIC X(1).                            
000044     10 A838-NRCAMMAX        PIC S9(3)V USAGE COMP-3.             
000045     10 A838-QTORDMIN        PIC S9(7)V USAGE COMP-3.             
000046     10 A838-TMATTMED        PIC S9(3)V USAGE COMP-3.             
000047     10 A838-DLCAMBIL        PIC S9(3)V USAGE COMP-3.             
000048     10 A838-NRMAXLOT        PIC S9(3)V USAGE COMP-3.             
000049     10 A838-FLNWAVAN        PIC X(1).                            
000050     10 A838-FLAGMANU        PIC X(1).                            
000051     10 A838-UTENSTAM        PIC X(6).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000052     10 A838-CENCOSCO        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000053     10 A838-CODDEPSC        PIC X(2).                            
000054     10 A838-CODDEPRI        PIC X(2).                            
000055     10 A838-CENCOOLD        PIC X(5).                            
000056     10 A838-FLXFATIN        PIC X(1).                            
000057     10 A838-FLAGXWMS        PIC X(1).                            
000058     10 A838-FLAGXFTP        PIC X(1).                            
000059******************************************************************
000060* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 44      *
000061******************************************************************
      *<<((file: FDANA838))
000156                                                                  
000157*------------------------------- DANAGRAF.TFORNITORI              
000158 01  FILLER                      PIC X(8)  VALUE 'FDANA972'.      
000159*    EXEC SQL  INCLUDE FDANA972   END-EXEC.                       
      *>>((file: FDANA972))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TFORNITORI)                              *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA972))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(A972-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DANAGRAF.TFORNITORI TABLE                   
000012*     ( CODFORNI                       CHAR(5) NOT NULL,           
000013*       TIPOFORN                       CHAR(1) NOT NULL,           
000014*       RAGFORNI                       CHAR(24) NOT NULL,          
000015*       INDFORNI                       CHAR(24) NOT NULL,          
000016*       CAPFORNI                       CHAR(5) NOT NULL,           
000017*       CITFORNI                       CHAR(18) NOT NULL,          
000018*       CDIVACEE                       CHAR(14) NOT NULL,          
000019*       PERCSCON                       DECIMAL(5, 2) NOT NULL,     
000020*       TIPOPAGA                       CHAR(1) NOT NULL,           
000021*       SCADFORN                       CHAR(12) NOT NULL,          
000022*       GGSCATRA                       CHAR(2) NOT NULL,           
000023*       CODFISCA                       CHAR(16) NOT NULL,          
000024*       SIGLAPRO                       CHAR(2) NOT NULL,           
000025*       TELFORNI                       CHAR(20) NOT NULL,          
000026*       TLXFORNI                       CHAR(20) NOT NULL,          
000027*       FAXFORNI                       CHAR(20) NOT NULL,          
000028*       CATEFORN                       CHAR(2) NOT NULL,           
000029*       ESRAGFOR                       CHAR(11) NOT NULL,          
000030*       ESINDFOR                       CHAR(11) NOT NULL,          
000031*       ESCITFOR                       CHAR(17) NOT NULL,          
000032*       ESINDFO1                       CHAR(35) NOT NULL,          
000033*       INCAPFOR                       CHAR(1) NOT NULL,           
000034*       CAPOFATT                       CHAR(5) NOT NULL,           
000035*       INBLOCOR                       CHAR(1) NOT NULL,           
000036*       CENCOSTO                       CHAR(5) NOT NULL,           
000037*       CODPAESE                       CHAR(3) NOT NULL,           
000038*       INTNFORN                       CHAR(50) NOT NULL,          
000039*       RAGFCOMP                       CHAR(35) NOT NULL,          
000040*       INTNCOMM                       CHAR(50) NOT NULL,          
000041*       INTNALTR                       CHAR(50) NOT NULL,          
000042*       CDFISCAL                       CHAR(16) NOT NULL,          
000043*       FAXCOMME                       CHAR(20) NOT NULL,          
000044*       FAXALTRO                       CHAR(20) NOT NULL,          
000045*       CDALBOTR                       CHAR(11) NOT NULL           
000046*     ) END-EXEC
                                                                        
000047******************************************************************
000048* COBOL DECLARATION FOR TABLE DANAGRAF.TFORNITORI                *
000049******************************************************************
000050 01  DCLTFORNITORI.                                               
000051*                       CODFORNI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000052     10 A972-CODFORNI        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000053*                       TIPOFORN                                  
000054     10 A972-TIPOFORN        PIC X(1).                            
000055*                       RAGFORNI                                  
000056     10 A972-RAGFORNI        PIC X(24).                           
000057*                       INDFORNI                                  
000058     10 A972-INDFORNI        PIC X(24).                           
000059*                       CAPFORNI                                  
000060     10 A972-CAPFORNI        PIC X(5).                            
000061*                       CITFORNI                                  
000062     10 A972-CITFORNI        PIC X(18).                           
000063*                       CDIVACEE                                  
000064     10 A972-CDIVACEE        PIC X(14).                           
000065*                       PERCSCON                                  
000066     10 A972-PERCSCON        PIC S9(3)V9(2) USAGE COMP-3.         
000067*                       TIPOPAGA                                  
000068     10 A972-TIPOPAGA        PIC X(1).                            
000069*                       SCADFORN                                  
000070     10 A972-SCADFORN        PIC X(12).                           
000071*                       GGSCATRA                                  
000072     10 A972-GGSCATRA        PIC X(2).                            
000073*                       CODFISCA                                  
000074     10 A972-CODFISCA        PIC X(16).                           
000075*                       SIGLAPRO                                  
000076     10 A972-SIGLAPRO        PIC X(2).                            
000077*                       TELFORNI                                  
000078     10 A972-TELFORNI        PIC X(20).                           
000079*                       TLXFORNI                                  
000080     10 A972-TLXFORNI        PIC X(20).                           
000081*                       FAXFORNI                                  
000082     10 A972-FAXFORNI        PIC X(20).                           
000083*                       CATEFORN                                  
000084     10 A972-CATEFORN        PIC X(2).                            
000085*                       ESRAGFOR                                  
000086     10 A972-ESRAGFOR        PIC X(11).                           
000087*                       ESINDFOR                                  
000088     10 A972-ESINDFOR        PIC X(11).                           
000089*                       ESCITFOR                                  
000090     10 A972-ESCITFOR        PIC X(17).                           
000091*                       ESINDFO1                                  
000092     10 A972-ESINDFO1        PIC X(35).                           
000093*                       INCAPFOR                                  
000094     10 A972-INCAPFOR        PIC X(1).                            
000095*                       CAPOFATT                                  
000096     10 A972-CAPOFATT        PIC X(5).                            
000097*                       INBLOCOR                                  
000098     10 A972-INBLOCOR        PIC X(1).                            
000099*                       CENCOSTO                                  
000100     10 A972-CENCOSTO        PIC X(5).                            
000101*                       CODPAESE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000102     10 A972-CODPAESE        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000103*                       INTNFORN                                  
000104     10 A972-INTNFORN        PIC X(50).                           
000105*                       RAGFCOMP                                  
000106     10 A972-RAGFCOMP        PIC X(35).                           
000107*                       INTNCOMM                                  
000108     10 A972-INTNCOMM        PIC X(50).                           
000109*                       INTNALTR                                  
000110     10 A972-INTNALTR        PIC X(50).                           
000111*                       CDFISCAL                                  
000112     10 A972-CDFISCAL        PIC X(16).                           
000113*                       FAXCOMME                                  
000114     10 A972-FAXCOMME        PIC X(20).                           
000115*                       FAXALTRO                                  
000116     10 A972-FAXALTRO        PIC X(20).                           
000117*                       CDALBOTR                                  
000118     10 A972-CDALBOTR        PIC X(11).                           
000119******************************************************************
000120* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 34      *
000121******************************************************************
      *<<((file: FDANA972))
000160                                                                  
000161*------------------------------- DANAGRAF.TDIVISE                 
000162 01  FILLER                      PIC X(8)  VALUE 'FDANA963'.      
000163*    EXEC SQL  INCLUDE FDANA963   END-EXEC.                       
      *>>((file: FDANA963))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TDIVISE                   *
000003******************************************************************
000004 01  DCLTDIVISE.                                                  
000005*                       SIGLADIV                                  
000006     10 A963-SIGLADIV        PIC X(3).                            
000007*                       CAMBIODV                                  
000008     10 A963-CAMBIODV        PIC S9(5)V9(6) USAGE COMP-3.         
000009*                       DESCDIVI                                  
000010     10 A963-DESCDIVI        PIC X(20).                           
000011*                       CODDIVIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000012     10 A963-CODDIVIS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000013*                       DECIDIVI                                  
000014     10 A963-DECIDIVI        PIC X(1).                            
000015*                       DIVIBANC                                  
000016     10 A963-DIVIBANC        PIC X(3).                            
000017*                       DIVIPREZ                                  
000018     10 A963-DIVIPREZ        PIC X(1).                            
000019*                       CODDIVRI                                  
000020     10 A963-CODDIVRI        PIC X(2).                            
000021*                       RAPPCAMB                                  
000022     10 A963-RAPPCAMB        PIC S9(5)V USAGE COMP-3.             
000023*                       CODDIGTM                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000024     10 A963-CODDIGTM        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025*                       FLAGEURO                                  
000026     10 A963-FLAGEURO        PIC X(1).                            
000027*                       SLDIVBAN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000028     10 A963-SLDIVBAN        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000029*                       CDDIVSCA                                  
000030     10 A963-CDDIVSCA        PIC X(2).                            
000031*                       FLDIVINT                                  
000032     10 A963-FLDIVINT        PIC X(1).                            
000033     10 A963-VBDIVSCA        PIC X(2).                            
000034******************************************************************
000035* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 15      *
000036******************************************************************
      *<<((file: FDANA963))
000164                                                                  
000165*------------------------------- DCONTCLI.TCONTIDCE               
000166 01  FILLER                      PIC X(8)  VALUE 'FDCLI861'.      
000167*    EXEC SQL  INCLUDE FDCLI861   END-EXEC.                       
      *>>((file: FDCLI861))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DCONTCLI.TCONTIDCE                 *
000003******************************************************************
000004 01  DCLTCONTIDCE.                                                
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 C861-CONTODCE        PIC X(6).                            
000006     10 C861-CODPIANO        PIC X(2).                            
000007     10 C861-CONTPROV        PIC X(6).                            
000008     10 C861-DESCRDCE        PIC X(25).                           
000009     10 C861-ANNULLAM        PIC X(1).                            
000010     10 C861-TIPCONTO        PIC X(2).                            
000011     10 C861-CONTGRUP        PIC X(6).                            
000012     10 C861-NOTECON1        PIC X(33).                           
000013     10 C861-NOTECON2        PIC X(33).                           
000014     10 C861-INDBILQU        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000015     10 C861-FLCOMMES        PIC X(1).                            
000016******************************************************************
000017* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 11 C861- 
000018******************************************************************
      *<<((file: FDCLI861))
000168                                                                  
000169*------------------------------- DSCORTE.TARTISCORN               
000170 01  FILLER                      PIC X(8)  VALUE 'FDSCO457'.      
000171*    EXEC SQL  INCLUDE FDSCO457   END-EXEC.                       
      *>>((file: FDSCO457))
000001******************************************************************
000002* DCLGEN TABLE(DSCORTE.TARTISCORN)                               *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDSCO457))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(S457-)                                            *
000007*        APOST                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DSCORTE.TARTISCORN TABLE                    
000012*     ( CODARTSC                       CHAR(8) NOT NULL,           
000013*       CODILING                       CHAR(1) NOT NULL,           
000014*       NUMPROG3                       DECIMAL(3, 0) NOT NULL,     
000015*       CODFAMSC                       CHAR(6) NOT NULL,           
000016*       DESARTSC                       CHAR(40) NOT NULL,          
000017*       DTCREAZI                       CHAR(8) NOT NULL,           
000018*       DTULTVAR                       CHAR(8) NOT NULL,           
000019*       CODUTVAR                       CHAR(6) NOT NULL,           
000020*       CODTIPSC                       CHAR(2) NOT NULL,           
000021*       DTANNULL                       CHAR(8) NOT NULL,           
000022*       UTCONFAR                       CHAR(6) NOT NULL,           
000023*       DTCONFAR                       CHAR(8) NOT NULL,           
000024*       CODMACFA                       CHAR(2) NOT NULL,           
000025*       CODSOTFA                       CHAR(2) NOT NULL,           
000026*       CODUTCRE                       CHAR(6) NOT NULL,           
000027*       CATEARTI                       CHAR(1) NOT NULL,           
000028*       CODEAN13                       CHAR(13) NOT NULL,          
000029*       PESOARTS                       DECIMAL(5, 2) NOT NULL      
000030*     ) END-EXEC
                                                                        
000031******************************************************************
000032* COBOL DECLARATION FOR TABLE DSCORTE.TARTISCORN                 *
000033******************************************************************
000034 01  DCLTARTISCORN.                                               
000035*                       CODARTSC                                  
000036     10 S457-CODARTSC        PIC X(8).                            
000037*                       CODILING                                  
000038     10 S457-CODILING        PIC X(1).                            
000039*                       NUMPROG3                                  
000040     10 S457-NUMPROG3        PIC S9(3)V USAGE COMP-3.             
000041*                       CODFAMSC                                  
000042     10 S457-CODFAMSC        PIC X(6).                            
000043*                       DESARTSC                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000044     10 S457-DESARTSC        PIC X(40).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000045*                       DTCREAZI                                  
000046     10 S457-DTCREAZI        PIC X(8).                            
000047*                       DTULTVAR                                  
000048     10 S457-DTULTVAR        PIC X(8).                            
000049*                       CODUTVAR                                  
000050     10 S457-CODUTVAR        PIC X(6).                            
000051*                       CODTIPSC                                  
000052     10 S457-CODTIPSC        PIC X(2).                            
000053*                       DTANNULL                                  
000054     10 S457-DTANNULL        PIC X(8).                            
000055*                       UTCONFAR                                  
000056     10 S457-UTCONFAR        PIC X(6).                            
000057*                       DTCONFAR                                  
000058     10 S457-DTCONFAR        PIC X(8).                            
000059*                       CODMACFA                                  
000060     10 S457-CODMACFA        PIC X(2).                            
000061*                       CODSOTFA                                  
000062     10 S457-CODSOTFA        PIC X(2).                            
000063*                       CODUTCRE                                  
000064     10 S457-CODUTCRE        PIC X(6).                            
000065*                       CATEARTI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000066     10 S457-CATEARTI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000067*                       CODEAN13                                  
000068     10 S457-CODEAN13        PIC X(13).                           
000069*                       PESOARTS                                  
000070     10 S457-PESOARTS        PIC S9(3)V9(2) USAGE COMP-3.         
000071******************************************************************
000072* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 18      *
000073******************************************************************
      *<<((file: FDSCO457))
000172                                                                  
000173*------------------------------- DSCORTE.TMOVISCOR                
000174 01  FILLER                      PIC X(8)  VALUE 'FDSCO467'.      
000175*    EXEC SQL  INCLUDE FDSCO467   END-EXEC.                       
      *>>((file: FDSCO467))
000001******************************************************************
000002* DCLGEN TABLE(DSCORTE.TMOVISCOR)                                *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDSCO467))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(S467-)                                            *
000007*        APOST                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DSCORTE.TMOVISCOR TABLE                     
000012*     ( NRDISSCO                       CHAR(6) NOT NULL,           
000013*       CAUSAMOV                       CHAR(2) NOT NULL,           
000014*       CARISCAR                       CHAR(1) NOT NULL,           
000015*       AANUMMOV                       CHAR(10) NOT NULL,          
000016*       SOCIEMER                       CHAR(2) NOT NULL,           
000017*       DEPPROVE                       CHAR(2) NOT NULL,           
000018*       ICLIFOPR                       CHAR(1) NOT NULL,           
000019*       CLIFOPRO                       CHAR(5) NOT NULL,           
000020*       DEPDESTI                       CHAR(2) NOT NULL,           
000021*       ICLIFODE                       CHAR(1) NOT NULL,           
000022*       CLIFODES                       CHAR(5) NOT NULL,           
000023*       CODARTSC                       CHAR(8) NOT NULL,           
000024*       CENCOSTO                       CHAR(5) NOT NULL,           
000025*       CODMACCH                       CHAR(4) NOT NULL,           
000026*       CODFORNI                       CHAR(5) NOT NULL,           
000027*       AANUMORD                       CHAR(8) NOT NULL,           
000028*       NRRIGORD                       DECIMAL(3, 0) NOT NULL,     
000029*       NUMBOLLA                       CHAR(16) NOT NULL,          
000030*       DATBOLLA                       CHAR(8) NOT NULL,           
000031*       UNMISURA                       CHAR(2) NOT NULL,           
000032*       QTAMOVIM                       DECIMAL(9, 2) NOT NULL,     
000033*       CODDIVIS                       CHAR(2) NOT NULL,           
000034*       PREZZMER                       DECIMAL(15, 4) NOT NULL,    
000035*       PERCSCO1                       DECIMAL(3, 0) NOT NULL,     
000036*       PERCSCO2                       DECIMAL(3, 0) NOT NULL,     
000037*       PERCSCO3                       DECIMAL(3, 0) NOT NULL,     
000038*       FLBLOCPA                       CHAR(1) NOT NULL,           
000039*       DATAESTR                       CHAR(8) NOT NULL,           
000040*       NOMEPROG                       CHAR(8) NOT NULL,           
000041*       DTCREAZI                       CHAR(8) NOT NULL,           
000042*       DTULTVAR                       CHAR(8) NOT NULL,           
000043*       CODUTVAR                       CHAR(6) NOT NULL,           
000044*       DIVTRASP                       CHAR(2) NOT NULL,           
000045*       COSTOTRA                       DECIMAL(11, 4) NOT NULL,    
000046*       DIVDAZIO                       CHAR(2) NOT NULL,           
000047*       COSDAZIO                       DECIMAL(11, 4) NOT NULL,    
000048*       NRDOCTRA                       CHAR(16) NOT NULL,          
000049*       DTDOCTRA                       CHAR(8) NOT NULL,           
000050*       NRDOCDAZ                       CHAR(16) NOT NULL,          
000051*       DTDOCDAZ                       CHAR(8) NOT NULL,           
000052*       CDVALSCO                       CHAR(1) NOT NULL,           
000053*       AANUMRIC                       CHAR(8) NOT NULL,           
000054*       PERSCOIM                       DECIMAL(7, 4) NOT NULL,     
000055*       CATEARTI                       CHAR(1) NOT NULL,           
000056*       PERCONCO                       DECIMAL(5, 2) NOT NULL,     
000057*       COSAGGOR                       DECIMAL(11, 4) NOT NULL,    
000058*       CDDIVISI                       CHAR(1) NOT NULL            
000059*     ) END-EXEC
                                                                        
000060******************************************************************
000061* COBOL DECLARATION FOR TABLE DSCORTE.TMOVISCOR                  *
000062******************************************************************
000063 01  DCLTMOVISCOR.                                                
000064*                       NRDISSCO                                  
000065     10 S467-NRDISSCO        PIC X(6).                            
000066*                       CAUSAMOV                                  
000067     10 S467-CAUSAMOV        PIC X(2).                            
000068*                       CARISCAR                                  
000069     10 S467-CARISCAR        PIC X(1).                            
000070*                       AANUMMOV                                  
000071     10 S467-AANUMMOV        PIC X(10).                           
000072*                       SOCIEMER                                  
000073     10 S467-SOCIEMER        PIC X(2).                            
000074*                       DEPPROVE                                  
000075     10 S467-DEPPROVE        PIC X(2).                            
000076*                       ICLIFOPR                                  
000077     10 S467-ICLIFOPR        PIC X(1).                            
000078*                       CLIFOPRO                                  
000079     10 S467-CLIFOPRO        PIC X(5).                            
000080*                       DEPDESTI                                  
000081     10 S467-DEPDESTI        PIC X(2).                            
000082*                       ICLIFODE                                  
000083     10 S467-ICLIFODE        PIC X(1).                            
000084*                       CLIFODES                                  
000085     10 S467-CLIFODES        PIC X(5).                            
000086*                       CODARTSC                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000087     10 S467-CODARTSC        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000088*                       CENCOSTO                                  
000089     10 S467-CENCOSTO        PIC X(5).                            
000090*                       CODMACCH                                  
000091     10 S467-CODMACCH        PIC X(4).                            
000092*                       CODFORNI                                  
000093     10 S467-CODFORNI        PIC X(5).                            
000094*                       AANUMORD                                  
000095     10 S467-AANUMORD        PIC X(8).                            
000096*                       NRRIGORD                                  
000097     10 S467-NRRIGORD        PIC S9(3)V USAGE COMP-3.             
000098*                       NUMBOLLA                                  
000099     10 S467-NUMBOLLA        PIC X(16).                           
000100*                       DATBOLLA                                  
000101     10 S467-DATBOLLA        PIC X(8).                            
000102*                       UNMISURA                                  
000103     10 S467-UNMISURA        PIC X(2).                            
000104*                       QTAMOVIM                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000105     10 S467-QTAMOVIM        PIC S9(7)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000106*                       CODDIVIS                                  
000107     10 S467-CODDIVIS        PIC X(2).                            
000108*                       PREZZMER                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000109     10 S467-PREZZMER        PIC S9(11)V9(4) USAGE COMP-3.        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000110*                       PERCSCO1                                  
000111     10 S467-PERCSCO1        PIC S9(3)V USAGE COMP-3.             
000112*                       PERCSCO2                                  
000113     10 S467-PERCSCO2        PIC S9(3)V USAGE COMP-3.             
000114*                       PERCSCO3                                  
000115     10 S467-PERCSCO3        PIC S9(3)V USAGE COMP-3.             
000116*                       FLBLOCPA                                  
000117     10 S467-FLBLOCPA        PIC X(1).                            
000118*                       DATAESTR                                  
000119     10 S467-DATAESTR        PIC X(8).                            
000120*                       NOMEPROG                                  
000121     10 S467-NOMEPROG        PIC X(8).                            
000122*                       DTCREAZI                                  
000123     10 S467-DTCREAZI        PIC X(8).                            
000124*                       DTULTVAR                                  
000125     10 S467-DTULTVAR        PIC X(8).                            
000126*                       CODUTVAR                                  
000127     10 S467-CODUTVAR        PIC X(6).                            
000128*                       DIVTRASP                                  
000129     10 S467-DIVTRASP        PIC X(2).                            
000130*                       COSTOTRA                                  
000131     10 S467-COSTOTRA        PIC S9(7)V9(4) USAGE COMP-3.         
000132*                       DIVDAZIO                                  
000133     10 S467-DIVDAZIO        PIC X(2).                            
000134*                       COSDAZIO                                  
000135     10 S467-COSDAZIO        PIC S9(7)V9(4) USAGE COMP-3.         
000136*                       NRDOCTRA                                  
000137     10 S467-NRDOCTRA        PIC X(16).                           
000138*                       DTDOCTRA                                  
000139     10 S467-DTDOCTRA        PIC X(8).                            
000140*                       NRDOCDAZ                                  
000141     10 S467-NRDOCDAZ        PIC X(16).                           
000142*                       DTDOCDAZ                                  
000143     10 S467-DTDOCDAZ        PIC X(8).                            
000144*                       CDVALSCO                                  
000145     10 S467-CDVALSCO        PIC X(1).                            
000146*                       AANUMRIC                                  
000147     10 S467-AANUMRIC        PIC X(8).                            
000148*                       PERSCOIM                                  
000149     10 S467-PERSCOIM        PIC S9(3)V9(4) USAGE COMP-3.         
000150*                       CATEARTI                                  
000151     10 S467-CATEARTI        PIC X(1).                            
000152*                       PERCONCO                                  
000153     10 S467-PERCONCO        PIC S9(3)V9(2) USAGE COMP-3.         
000154*                       COSAGGOR                                  
000155     10 S467-COSAGGOR        PIC S9(7)V9(4) USAGE COMP-3.         
000156*                       CDDIVISI                                  
000157     10 S467-CDDIVISI        PIC X(1).                            
000158******************************************************************
000159* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 47      *
000160******************************************************************
      *<<((file: FDSCO467))
000176                                                                  
000177*------------------------------- DSCORTE.TORDISCORN               
000178 01  FILLER                      PIC X(8)  VALUE 'FDSCO478'.      
000179*    EXEC SQL  INCLUDE FDSCO478   END-EXEC.                       
      *>>((file: FDSCO478))
000001******************************************************************
000002* DCLGEN TABLE(DSCORTE.TORDISCORN)                               *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDSCO478))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(S478-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011******************************************************************
000012* COBOL DECLARATION FOR TABLE DSCORTE.TORDISCORN                 *
000013******************************************************************
000014 01  DCLTORDISCORN.                                               
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000015     10 S478-AANUMORD        PIC X(8).                            
000016     10 S478-CODSOCIE        PIC X(2).                            
000017     10 S478-CODFORNI        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000018     10 S478-LETTAGEN        PIC X(1).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000019     10 S478-DTCARORD        PIC X(8).                            
000020     10 S478-CENCOSTO        PIC X(5).                            
000021     10 S478-CONTODCE        PIC X(6).                            
000022     10 S478-NRCOMMES        PIC X(24).                           
000023     10 S478-CODDIVIS        PIC X(2).                            
000024     10 S478-DATASALD        PIC X(8).                            
000025     10 S478-DTANNULL        PIC X(8).                            
000026     10 S478-CODUTENT        PIC X(6).                            
000027     10 S478-DESCORDI        PIC X(16).                           
000028     10 S478-AANUMRIC        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000029     10 S478-NROFFORN        PIC X(5).                            
000030     10 S478-DTOFFORN        PIC X(8).                            
000031     10 S478-CONFERMA        PIC X(12).                           
000032     10 S478-DTCONFER        PIC X(8).                            
000033     10 S478-NOTEORDI        PIC X(40).                           
000034     10 S478-TIPOPAGA        PIC X(1).                            
000035     10 S478-SCADFORN        PIC X(12).                           
000036     10 S478-GGSCATRA        PIC X(2).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000037     10 S478-PERCSCON        PIC S9(3)V9(2) USAGE COMP-3.         
000038     10 S478-DEPDESTI        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000039     10 S478-TIPSPEDI        PIC X(2).                            
000040     10 S478-CODIRESA        PIC X(2).                            
000041     10 S478-CODIMBAL        PIC X(2).                            
000042     10 S478-FLAGSTAM        PIC X(1).                            
000043     10 S478-FLORDPZA        PIC X(1).                            
000044     10 S478-FLAGMAGA        PIC X(1).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000045     10 S478-DTCREAZI        PIC X(8).                            
000046     10 S478-DTULTVAR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000047     10 S478-CODUTVAR        PIC X(6).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000048     10 S478-CDEVARIC        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000049     10 S478-DATEMAIL        PIC X(8).                            
000050     10 S478-DTULTSOL        PIC X(8).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000051     10 S478-IMPSCONT        PIC S9(11)V9(4) USAGE COMP-3.        
000052     10 S478-PERSCOIM        PIC S9(3)V9(4) USAGE COMP-3.         
000053     10 S478-CATEARTI        PIC X(1).                            
000054     10 S478-TARGVETT        PIC X(9).                            
000055     10 S478-CDDIVISI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000056     10 S478-CODCLIEN        PIC X(5).                            
000057     10 S478-CENCOSTD        PIC X(5).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000058     10 S478-NUMAUTOR        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000059******************************************************************
000060* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 44      *
000061******************************************************************
      *<<((file: FDSCO478))
000180                                                                  
000181*------------------------------- DSCORTE.TRIGORDISCORN            
000182 01  FILLER                      PIC X(8)  VALUE 'FDSCO479'.      
000183*    EXEC SQL  INCLUDE FDSCO479   END-EXEC.                       
      *>>((file: FDSCO479))
000001******************************************************************
000002* DCLGEN TABLE(DSCORTE.TRIGORDISCORN)                            *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDSCO479))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(S479-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DSCORTE.TRIGORDISCORN TABLE                 
000012*     ( AANUMORD                       CHAR(8) NOT NULL,           
000013*       CODARTSC                       CHAR(8) NOT NULL,           
000014*       NRRIGORD                       DECIMAL(3, 0) NOT NULL,     
000015*       DATACONS                       CHAR(8) NOT NULL,           
000016*       PREZZORD                       DECIMAL(15, 4) NOT NULL,    
000017*       PERCSCO1                       DECIMAL(3, 0) NOT NULL,     
000018*       PERCSCO2                       DECIMAL(3, 0) NOT NULL,     
000019*       PERCSCO3                       DECIMAL(3, 0) NOT NULL,     
000020*       UNMISURA                       CHAR(2) NOT NULL,           
000021*       QTAORDIN                       DECIMAL(9, 2) NOT NULL,     
000022*       QTARICEV                       DECIMAL(9, 2) NOT NULL,     
000023*       IMPRICEV                       DECIMAL(15, 4) NOT NULL,    
000024*       DATASALD                       CHAR(8) NOT NULL,           
000025*       DTANNULL                       CHAR(8) NOT NULL,           
000026*       FLAGSTAM                       CHAR(1) NOT NULL,           
000027*       DTCREAZI                       CHAR(8) NOT NULL,           
000028*       DTULTVAR                       CHAR(8) NOT NULL,           
000029*       CODUTVAR                       CHAR(6) NOT NULL,           
000030*       CONSORIG                       CHAR(8) NOT NULL,           
000031*       PREZORIG                       DECIMAL(15, 4) NOT NULL     
000032*     ) END-EXEC
                                                                        
000033******************************************************************
000034* COBOL DECLARATION FOR TABLE DSCORTE.TRIGORDISCORN              *
000035******************************************************************
000036 01  DCLTRIGORDISCORN.                                            
000037*                       AANUMORD                                  
000038     10 S479-AANUMORD        PIC X(8).                            
000039*                       CODARTSC                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000040     10 S479-CODARTSC        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000041*                       NRRIGORD                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000042     10 S479-NRRIGORD        PIC S9(3)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000043*                       DATACONS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000044     10 S479-DATACONS        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000045*                       PREZZORD                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000046     10 S479-PREZZORD        PIC S9(11)V9(4) USAGE COMP-3.        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000047*                       PERCSCO1                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000048     10 S479-PERCSCO1        PIC S9(3)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000049*                       PERCSCO2                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000050     10 S479-PERCSCO2        PIC S9(3)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000051*                       PERCSCO3                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000052     10 S479-PERCSCO3        PIC S9(3)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000053*                       UNMISURA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000054     10 S479-UNMISURA        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000055*                       QTAORDIN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000056     10 S479-QTAORDIN        PIC S9(7)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000057*                       QTARICEV                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000058     10 S479-QTARICEV        PIC S9(7)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000059*                       IMPRICEV                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000060     10 S479-IMPRICEV        PIC S9(11)V9(4) USAGE COMP-3.        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000061*                       DATASALD                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000062     10 S479-DATASALD        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000063*                       DTANNULL                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000064     10 S479-DTANNULL        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000065*                       FLAGSTAM                                  
000066     10 S479-FLAGSTAM        PIC X(1).                            
000067*                       DTCREAZI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000068     10 S479-DTCREAZI        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000069*                       DTULTVAR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000070     10 S479-DTULTVAR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000071*                       CODUTVAR                                  
000072     10 S479-CODUTVAR        PIC X(6).                            
000073*                       CONSORIG                                  
000074     10 S479-CONSORIG        PIC X(8).                            
000075*                       PREZORIG                                  
000076     10 S479-PREZORIG        PIC S9(11)V9(4) USAGE COMP-3.        
000077******************************************************************
000078* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 20      *
000079******************************************************************
      *<<((file: FDSCO479))
000184                                                                  
000185*------------------------------- DSCORTE.TDETTORDISCORN           
000186 01  FILLER                      PIC X(8)  VALUE 'FDSCO480'.      
000187*    EXEC SQL  INCLUDE FDSCO480   END-EXEC.                       
      *>>((file: FDSCO480))
000001******************************************************************
000002* DCLGEN TABLE(DSCORTE.TDETTORDISCORN)                           *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDSCO480))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        QUOTE                                                   *
000007* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000008******************************************************************
000009     
      *EXEC SQL DECLARE DSCORTE.TDETTORDISCORN TABLE                
000010*     ( AANUMORD                       CHAR(8) NOT NULL,           
000011*       NRRIGORD                       DECIMAL(3, 0) NOT NULL,     
000012*       NUMPROG3                       DECIMAL(3, 0) NOT NULL,     
000013*       DESARTSC                       CHAR(40) NOT NULL,          
000014*       DTCREAZI                       CHAR(8) NOT NULL,           
000015*       DTULTVAR                       CHAR(8) NOT NULL,           
000016*       CODUTVAR                       CHAR(6) NOT NULL            
000017*     ) END-EXEC
                                                                        
000018******************************************************************
000019* COBOL DECLARATION FOR TABLE DSCORTE.TDETTORDISCORN             *
000020******************************************************************
000021 01  DCLTDETTORDISCORN.                                           
000022     10 S480-AANUMORD        PIC X(8).                            
000023     10 S480-NRRIGORD        PIC S9(3)V USAGE COMP-3.             
000024     10 S480-NUMPROG3        PIC S9(3)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000025     10 S480-DESARTSC        PIC X(40).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000026     10 S480-DTCREAZI        PIC X(8).                            
000027     10 S480-DTULTVAR        PIC X(8).                            
000028     10 S480-CODUTVAR        PIC X(6).                            
000029******************************************************************
000030* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 7       *
000031******************************************************************
      *<<((file: FDSCO480))
000188                                                                  
000189*------------------------------- DSIFO.TORDISIFO                  
000190 01  FILLER                      PIC X(8)  VALUE 'FDSIF700'.      
000191*    EXEC SQL  INCLUDE FDSIF700   END-EXEC.                       
      *>>((file: FDSIF700))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DSIFO.TORDISIFO                    *
000003******************************************************************
000004 01  DCLTORDISIFO.                                                
000005*                       AANUMORD                                  
000006     10 S700-AANUMORD        PIC X(8).                            
000007*                       CODFORNI                                  
000008     10 S700-CODFORNI        PIC X(5).                            
000009*                       FLAGOPZI                                  
000010     10 S700-FLAGOPZI        PIC X(1).                            
000011*                       ACQUILAV                                  
000012     10 S700-ACQUILAV        PIC X(1).                            
000013*                       FLAGADIS                                  
000014     10 S700-FLAGADIS        PIC X(1).                            
000015*                       CODSOCIE                                  
000016     10 S700-CODSOCIE        PIC X(2).                            
000017*                       PROLOMER                                  
000018     10 S700-PROLOMER        PIC X(2).                            
000019*                       MERCEMAG                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000020     10 S700-MERCEMAG        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000021*                       CODDIVIS                                  
000022     10 S700-CODDIVIS        PIC X(2).                            
000023*                       UNMISURA                                  
000024     10 S700-UNMISURA        PIC X(2).                            
000025*                       PARTLAVO                                  
000026     10 S700-PARTLAVO        PIC X(6).                            
000027*                       CENCOSTO                                  
000028     10 S700-CENCOSTO        PIC X(5).                            
000029*                       CONTODCE                                  
000030     10 S700-CONTODCE        PIC X(6).                            
000031*                       PERCSCON                                  
000032     10 S700-PERCSCON        PIC S9(3)V9(2) USAGE COMP-3.         
000033*                       COSAGGOR                                  
000034     10 S700-COSAGGOR        PIC S9(7)V9(2) USAGE COMP-3.         
000035*                       DIVAGGOR                                  
000036     10 S700-DIVAGGOR        PIC X(2).                            
000037*                       CODIRESA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000038     10 S700-CODIRESA        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000039*                       CLASDOGA                                  
000040     10 S700-CLASDOGA        PIC X(1).                            
000041*                       ORDIRAGG                                  
000042     10 S700-ORDIRAGG        PIC X(8).                            
000043*                       UFFCOMME                                  
000044     10 S700-UFFCOMME        PIC X(2).                            
000045*                       FLAGSOSP                                  
000046     10 S700-FLAGSOSP        PIC X(1).                            
000047*                       CONFERMA                                  
000048     10 S700-CONFERMA        PIC X(12).                           
000049*                       DTCONFER                                  
000050     10 S700-DTCONFER        PIC X(8).                            
000051*                       DATASALD                                  
000052     10 S700-DATASALD        PIC X(8).                            
000053*                       DTANNULL                                  
000054     10 S700-DTANNULL        PIC X(8).                            
000055*                       DTCARORD                                  
000056     10 S700-DTCARORD        PIC X(8).                            
000057*                       DTCREAZI                                  
000058     10 S700-DTCREAZI        PIC X(8).                            
000059*                       DTULTVAR                                  
000060     10 S700-DTULTVAR        PIC X(8).                            
000061*                       CODUTVAR                                  
000062     10 S700-CODUTVAR        PIC X(6).                            
000063*                       FLINTEST                                  
000064     10 S700-FLINTEST        PIC X(1).                            
000065*                       FLAGPARZ                                  
000066     10 S700-FLAGPARZ        PIC X(1).                            
000067*                       FLGRATIS                                  
000068     10 S700-FLGRATIS        PIC X(1).                            
000069*                       FORNFATT                                  
000070     10 S700-FORNFATT        PIC X(5).                            
000071*                       TIPOAPPA                                  
000072     10 S700-TIPOAPPA        PIC X(1).                            
000073*                       FLCONLAV                                  
000074     10 S700-FLCONLAV        PIC X(1).                            
000075*                       PROLORIC                                  
000076     10 S700-PROLORIC        PIC X(2).                            
000077*                       FLAGVEND                                  
000078     10 S700-FLAGVEND        PIC X(1).                            
000079*                       PAESORIG                                  
000080     10 S700-PAESORIG        PIC X(3).                            
000081*                       COSTOTRA                                  
000082     10 S700-COSTOTRA        PIC S9(7)V9(2) USAGE COMP-3.         
000083*                       COSDAZIO                                  
000084     10 S700-COSDAZIO        PIC S9(7)V9(2) USAGE COMP-3.         
000085*                       DTRISCHE                                  
000086     10 S700-DTRISCHE        PIC X(8).                            
000087*                       STATDISP                                  
000088     10 S700-STATDISP        PIC X(1).                            
000089*                       TIPSPEDI                                  
000090     10 S700-TIPSPEDI        PIC X(1).                            
000091*                       CONFERMX                                  
000092     10 S700-CONFERMX        PIC X(20).                           
000093*                       TIPOTINT                                  
000094     10 S700-TIPOTINT        PIC X(1).                            
000095*                       CODSPEDI                                  
000096     10 S700-CODSPEDI        PIC X(5).                            
000097*                       COSTINCI                                  
000098     10 S700-COSTINCI        PIC S9(11)V9(2) USAGE COMP-3.        
000099*                       CODUTCRE                                  
000100     10 S700-CODUTCRE        PIC X(6).                            
000101******************************************************************
000102* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 47      *
000103******************************************************************
      *<<((file: FDSIF700))
000192                                                                  
000193*------------------------------- DSIFO.TRIGORDISIFO               
000194 01  FILLER                      PIC X(8)  VALUE 'FDSIF701'.      
000195*    EXEC SQL  INCLUDE FDSIF701   END-EXEC.                       
      *>>((file: FDSIF701))
000001******************************************************************
000002* DCLGEN TABLE(DSIFO.TRIGORDISIFO)                               *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDSIF701))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(S701-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011******************************************************************
000012* COBOL DECLARATION FOR TABLE DSIFO.TRIGORDISIFO                 *
000013******************************************************************
000014 01  DCLTRIGORDISIFO.                                             
000015     10 S701-AANUMORD        PIC X(8).                            
000016     10 S701-NRRIGORD        PIC S9(3)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000017     10 S701-CODARTIC        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000018     10 S701-CODDISEG        PIC X(5).                            
000019     10 S701-CODVARIA        PIC X(3).                            
000020     10 S701-VARIABIL        PIC X(3).                            
000021     10 S701-CODIQUAL        PIC X(4).                            
000022     10 S701-TICONFEZ        PIC X(1).                            
000023     10 S701-DATACONS        PIC X(8).                            
000024     10 S701-PREZZORD        PIC S9(7)V9(2) USAGE COMP-3.         
000025     10 S701-SUPPREPR        PIC S9(7)V9(2) USAGE COMP-3.         
000026     10 S701-IMPFORLA        PIC S9(9)V USAGE COMP-3.             
000027     10 S701-QTAORDIN        PIC S9(7)V USAGE COMP-3.             
000028     10 S701-NRSUBORD        PIC S9(5)V USAGE COMP-3.             
000029     10 S701-LUNGSUBB        PIC S9(5)V USAGE COMP-3.             
000030     10 S701-FORNDEST        PIC X(5).                            
000031     10 S701-QTARICEV        PIC S9(7)V9(2) USAGE COMP-3.         
000032     10 S701-QTRICREG        PIC S9(7)V9(2) USAGE COMP-3.         
000033     10 S701-QTRICDI2        PIC S9(7)V9(2) USAGE COMP-3.         
000034     10 S701-QTRICDI3        PIC S9(7)V9(2) USAGE COMP-3.         
000035     10 S701-QTACASCA        PIC S9(7)V9(2) USAGE COMP-3.         
000036     10 S701-NRSUBRIC        PIC S9(5)V USAGE COMP-3.             
000037     10 S701-RIFORACQ        PIC X(15).                           
000038     10 S701-NRDISPOS        PIC X(6).                            
000039     10 S701-FLAGESTR        PIC X(1).                            
000040     10 S701-ALTZPETT        PIC S9(4)V9(1) USAGE COMP-3.         
000041     10 S701-LARGFLAN        PIC S9(5)V USAGE COMP-3.             
000042     10 S701-SIGLCICL        PIC X(2).                            
000043     10 S701-GRTELAIO        PIC X(2).                            
000044     10 S701-STAVORLA        PIC X(1).                            
000045     10 S701-DATASALD        PIC X(8).                            
000046     10 S701-DTANNULL        PIC X(8).                            
000047     10 S701-DTCREAZI        PIC X(8).                            
000048     10 S701-DTULTVAR        PIC X(8).                            
000049     10 S701-CODUTVAR        PIC X(6).                            
000050     10 S701-STABILIM        PIC X(2).                            
000051     10 S701-SIGLBOZZ        PIC X(1).                            
000052     10 S701-DTCONPRE        PIC X(8).                            
000053     10 S701-DTCONRIC        PIC X(8).                            
000054     10 S701-DTSPEFOR        PIC X(8).                            
000055     10 S701-PREZZOLD        PIC S9(7)V9(2) USAGE COMP-3.         
000056     10 S701-SUPPROLD        PIC S9(7)V9(2) USAGE COMP-3.         
000057     10 S701-DTVARPRZ        PIC X(8).                            
000058     10 S701-PREZZOR4        PIC S9(7)V9(4) USAGE COMP-3.         
000059     10 S701-PRIMAETD        PIC X(8).                            
000060     10 S701-CAUSAETD        PIC X(2).                            
000061     10 S701-SLCAUSUP        PIC X(2).                            
000062******************************************************************
000063* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 49      *
000064******************************************************************
      *<<((file: FDSIF701))
000196                                                                  
000197*------------------------------- DANAGRAF.TFILATI                 
000198 01  FILLER                      PIC X(8)  VALUE 'FDANA710'.      
000199*    EXEC SQL  INCLUDE FDANA710   END-EXEC.                       
      *>>((file: FDANA710))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TFILATI)                                 *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA710))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(A710-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DANAGRAF.TFILATI TABLE                      
000012*     ( CODARTFL                       CHAR(5) NOT NULL,           
000013*       DESARTFL                       CHAR(50) NOT NULL,          
000014*       FAMIGLIA                       CHAR(8) NOT NULL,           
000015*       TORSIONE                       CHAR(1) NOT NULL,           
000016*       SIGLTITO                       CHAR(1) NOT NULL,           
000017*       VALRTITO                       DECIMAL(5, 1) NOT NULL,     
000018*       FLASTOCK                       CHAR(1) NOT NULL,           
000019*       CATEFILO                       CHAR(1) NOT NULL,           
000020*       CODCOMP1                       CHAR(2) NOT NULL,           
000021*       PERCCOM1                       CHAR(3) NOT NULL,           
000022*       CODCOMP2                       CHAR(2) NOT NULL,           
000023*       PERCCOM2                       CHAR(3) NOT NULL,           
000024*       CODCOMP3                       CHAR(2) NOT NULL,           
000025*       PERCCOM3                       CHAR(3) NOT NULL,           
000026*       CODCOMP4                       CHAR(2) NOT NULL,           
000027*       PERCCOM4                       CHAR(3) NOT NULL,           
000028*       VOCEDOGA                       CHAR(11) NOT NULL,          
000029*       PERCRIPR                       DECIMAL(5, 2) NOT NULL,     
000030*       CLASDOGA                       CHAR(1) NOT NULL,           
000031*       FLESIMAG                       CHAR(1) NOT NULL,           
000032*       DTANNULL                       CHAR(8) NOT NULL,           
000033*       DTCREAZI                       CHAR(8) NOT NULL,           
000034*       DTULTVAR                       CHAR(8) NOT NULL,           
000035*       CODUTVAR                       CHAR(6) NOT NULL,           
000036*       FAFISCAL                       CHAR(8) NOT NULL,           
000037*       DTULTPRO                       CHAR(8) NOT NULL,           
000038*       GIRTORSI                       DECIMAL(5, 0) NOT NULL,     
000039*       CODFORNI                       CHAR(5) NOT NULL,           
000040*       LUNFIBRA                       DECIMAL(5, 1) NOT NULL,     
000041*       LOTTOFIL                       CHAR(12) NOT NULL,          
000042*       LIVEORIG                       DECIMAL(3, 0) NOT NULL,     
000043*       CODLINEA                       CHAR(2) NOT NULL,           
000044*       SLTIPFIL                       CHAR(2) NOT NULL,           
000045*       SUBLINEA                       CHAR(2) NOT NULL,           
000046*       STATUSFL                       CHAR(1) NOT NULL,           
000047*       PAESORIG                       CHAR(3) NOT NULL,           
000048*       FLAGPROT                       CHAR(1) NOT NULL,           
000049*       PERCQUA3                       DECIMAL(3, 1) NOT NULL,     
000050*       PERSUBPE                       DECIMAL(3, 1) NOT NULL,     
000051*       PERCAVAN                       DECIMAL(3, 1) NOT NULL,     
000052*       TIPOCOST                       CHAR(2) NOT NULL,           
000053*       PERCOLIO                       DECIMAL(3, 1) NOT NULL,     
000054*       DTVARCLA                       CHAR(8) NOT NULL,           
000055*       UTVARCLA                       CHAR(6) NOT NULL,           
000056*       RAGCOMP1                       CHAR(2) NOT NULL,           
000057*       RAGCOMP2                       CHAR(2) NOT NULL,           
000058*       CODRAGFL                       CHAR(1) NOT NULL,           
000059*       CODTPPOL                       CHAR(1) NOT NULL,           
000060*       CODPROFL                       CHAR(2) NOT NULL,           
000061*       CODLAVFL                       CHAR(3) NOT NULL,           
000062*       CODTPBOB                       CHAR(2) NOT NULL,           
000063*       SLUTILFI                       CHAR(2) NOT NULL,           
000064*       GIRTORTR                       DECIMAL(5, 0) NOT NULL,     
000065*       VALRTITR                       DECIMAL(5, 1) NOT NULL,     
000066*       NRBAVEFL                       DECIMAL(3, 0) NOT NULL,     
000067*       NRFORFIL                       DECIMAL(3, 0) NOT NULL,     
000068*       NUMCAPFL                       DECIMAL(5, 0) NOT NULL,     
000069*       CODSEZFL                       CHAR(2) NOT NULL,           
000070*       SLSKQUAL                       CHAR(2) NOT NULL,           
000071*       TPMISTIT                       CHAR(1) NOT NULL,           
000072*       FAFILATI                       CHAR(13) NOT NULL,          
000073*       CODTPPO2                       CHAR(1) NOT NULL,           
000074*       GREGTINT                       CHAR(1) NOT NULL,           
000075*       NETROCFI                       DECIMAL(7, 2) NOT NULL,     
000076*       CDVELRAC                       CHAR(1) NOT NULL,           
000077*       RAGCOMP3                       CHAR(2) NOT NULL,           
000078*       CODTPPO3                       CHAR(1) NOT NULL,           
000079*       RAGCOMP4                       CHAR(2) NOT NULL,           
000080*       CODTPPO4                       CHAR(1) NOT NULL,           
000081*       FAFISNEW                       CHAR(8) NOT NULL,           
000082*       CARTCOLO                       CHAR(4) NOT NULL,           
000083*       PROLORIC                       CHAR(2) NOT NULL,           
000084*       DTINSPRO                       CHAR(8) NOT NULL,           
000085*       SIGLCICL                       CHAR(2) NOT NULL,           
000086*       MADEINXX                       CHAR(3) NOT NULL,           
000087*       PERCRLAB                       DECIMAL(5, 2) NOT NULL      
000088*     ) END-EXEC
                                                                        
000089******************************************************************
000090* COBOL DECLARATION FOR TABLE DANAGRAF.TFILATI                   *
000091******************************************************************
000092 01  DCLTFILATI.                                                  
000093*                       CODARTFL                                  
000094     10 A710-CODARTFL        PIC X(5).                            
000095*                       DESARTFL                                  
000096     10 A710-DESARTFL        PIC X(50).                           
000097*                       FAMIGLIA                                  
000098     10 A710-FAMIGLIA        PIC X(8).                            
000099*                       TORSIONE                                  
000100     10 A710-TORSIONE        PIC X(1).                            
000101*                       SIGLTITO                                  
000102     10 A710-SIGLTITO        PIC X(1).                            
000103*                       VALRTITO                                  
000104     10 A710-VALRTITO        PIC S9(4)V9(1) USAGE COMP-3.         
000105*                       FLASTOCK                                  
000106     10 A710-FLASTOCK        PIC X(1).                            
000107*                       CATEFILO                                  
000108     10 A710-CATEFILO        PIC X(1).                            
000109*                       CODCOMP1                                  
000110     10 A710-CODCOMP1        PIC X(2).                            
000111*                       PERCCOM1                                  
000112     10 A710-PERCCOM1        PIC X(3).                            
000113*                       CODCOMP2                                  
000114     10 A710-CODCOMP2        PIC X(2).                            
000115*                       PERCCOM2                                  
000116     10 A710-PERCCOM2        PIC X(3).                            
000117*                       CODCOMP3                                  
000118     10 A710-CODCOMP3        PIC X(2).                            
000119*                       PERCCOM3                                  
000120     10 A710-PERCCOM3        PIC X(3).                            
000121*                       CODCOMP4                                  
000122     10 A710-CODCOMP4        PIC X(2).                            
000123*                       PERCCOM4                                  
000124     10 A710-PERCCOM4        PIC X(3).                            
000125*                       VOCEDOGA                                  
000126     10 A710-VOCEDOGA        PIC X(11).                           
000127*                       PERCRIPR                                  
000128     10 A710-PERCRIPR        PIC S9(3)V9(2) USAGE COMP-3.         
000129*                       CLASDOGA                                  
000130     10 A710-CLASDOGA        PIC X(1).                            
000131*                       FLESIMAG                                  
000132     10 A710-FLESIMAG        PIC X(1).                            
000133*                       DTANNULL                                  
000134     10 A710-DTANNULL        PIC X(8).                            
000135*                       DTCREAZI                                  
000136     10 A710-DTCREAZI        PIC X(8).                            
000137*                       DTULTVAR                                  
000138     10 A710-DTULTVAR        PIC X(8).                            
000139*                       CODUTVAR                                  
000140     10 A710-CODUTVAR        PIC X(6).                            
000141*                       FAFISCAL                                  
000142     10 A710-FAFISCAL        PIC X(8).                            
000143*                       DTULTPRO                                  
000144     10 A710-DTULTPRO        PIC X(8).                            
000145*                       GIRTORSI                                  
000146     10 A710-GIRTORSI        PIC S9(5)V USAGE COMP-3.             
000147*                       CODFORNI                                  
000148     10 A710-CODFORNI        PIC X(5).                            
000149*                       LUNFIBRA                                  
000150     10 A710-LUNFIBRA        PIC S9(4)V9(1) USAGE COMP-3.         
000151*                       LOTTOFIL                                  
000152     10 A710-LOTTOFIL        PIC X(12).                           
000153*                       LIVEORIG                                  
000154     10 A710-LIVEORIG        PIC S9(3)V USAGE COMP-3.             
000155*                       CODLINEA                                  
000156     10 A710-CODLINEA        PIC X(2).                            
000157*                       SLTIPFIL                                  
000158     10 A710-SLTIPFIL        PIC X(2).                            
000159*                       SUBLINEA                                  
000160     10 A710-SUBLINEA        PIC X(2).                            
000161*                       STATUSFL                                  
000162     10 A710-STATUSFL        PIC X(1).                            
000163*                       PAESORIG                                  
000164     10 A710-PAESORIG        PIC X(3).                            
000165*                       FLAGPROT                                  
000166     10 A710-FLAGPROT        PIC X(1).                            
000167*                       PERCQUA3                                  
000168     10 A710-PERCQUA3        PIC S9(2)V9(1) USAGE COMP-3.         
000169*                       PERSUBPE                                  
000170     10 A710-PERSUBPE        PIC S9(2)V9(1) USAGE COMP-3.         
000171*                       PERCAVAN                                  
000172     10 A710-PERCAVAN        PIC S9(2)V9(1) USAGE COMP-3.         
000173*                       TIPOCOST                                  
000174     10 A710-TIPOCOST        PIC X(2).                            
000175*                       PERCOLIO                                  
000176     10 A710-PERCOLIO        PIC S9(2)V9(1) USAGE COMP-3.         
000177*                       DTVARCLA                                  
000178     10 A710-DTVARCLA        PIC X(8).                            
000179*                       UTVARCLA                                  
000180     10 A710-UTVARCLA        PIC X(6).                            
000181*                       RAGCOMP1                                  
000182     10 A710-RAGCOMP1        PIC X(2).                            
000183*                       RAGCOMP2                                  
000184     10 A710-RAGCOMP2        PIC X(2).                            
000185*                       CODRAGFL                                  
000186     10 A710-CODRAGFL        PIC X(1).                            
000187*                       CODTPPOL                                  
000188     10 A710-CODTPPOL        PIC X(1).                            
000189*                       CODPROFL                                  
000190     10 A710-CODPROFL        PIC X(2).                            
000191*                       CODLAVFL                                  
000192     10 A710-CODLAVFL        PIC X(3).                            
000193*                       CODTPBOB                                  
000194     10 A710-CODTPBOB        PIC X(2).                            
000195*                       SLUTILFI                                  
000196     10 A710-SLUTILFI        PIC X(2).                            
000197*                       GIRTORTR                                  
000198     10 A710-GIRTORTR        PIC S9(5)V USAGE COMP-3.             
000199*                       VALRTITR                                  
000200     10 A710-VALRTITR        PIC S9(4)V9(1) USAGE COMP-3.         
000201*                       NRBAVEFL                                  
000202     10 A710-NRBAVEFL        PIC S9(3)V USAGE COMP-3.             
000203*                       NRFORFIL                                  
000204     10 A710-NRFORFIL        PIC S9(3)V USAGE COMP-3.             
000205*                       NUMCAPFL                                  
000206     10 A710-NUMCAPFL        PIC S9(5)V USAGE COMP-3.             
000207*                       CODSEZFL                                  
000208     10 A710-CODSEZFL        PIC X(2).                            
000209*                       SLSKQUAL                                  
000210     10 A710-SLSKQUAL        PIC X(2).                            
000211*                       TPMISTIT                                  
000212     10 A710-TPMISTIT        PIC X(1).                            
000213*                       FAFILATI                                  
000214     10 A710-FAFILATI        PIC X(13).                           
000215*                       CODTPPO2                                  
000216     10 A710-CODTPPO2        PIC X(1).                            
000217*                       GREGTINT                                  
000218     10 A710-GREGTINT        PIC X(1).                            
000219*                       NETROCFI                                  
000220     10 A710-NETROCFI        PIC S9(5)V9(2) USAGE COMP-3.         
000221*                       CDVELRAC                                  
000222     10 A710-CDVELRAC        PIC X(1).                            
000223*                       RAGCOMP3                                  
000224     10 A710-RAGCOMP3        PIC X(2).                            
000225*                       CODTPPO3                                  
000226     10 A710-CODTPPO3        PIC X(1).                            
000227*                       RAGCOMP4                                  
000228     10 A710-RAGCOMP4        PIC X(2).                            
000229*                       CODTPPO4                                  
000230     10 A710-CODTPPO4        PIC X(1).                            
000231*                       FAFISNEW                                  
000232     10 A710-FAFISNEW        PIC X(8).                            
000233*                       CARTCOLO                                  
000234     10 A710-CARTCOLO        PIC X(4).                            
000235*                       PROLORIC                                  
000236     10 A710-PROLORIC        PIC X(2).                            
000237*                       DTINSPRO                                  
000238     10 A710-DTINSPRO        PIC X(8).                            
000239*                       SIGLCICL                                  
000240     10 A710-SIGLCICL        PIC X(2).                            
000241*                       MADEINXX                                  
000242     10 A710-MADEINXX        PIC X(3).                            
000243*                       PERCRLAB                                  
000244     10 A710-PERCRLAB        PIC S9(3)V9(2) USAGE COMP-3.         
000245******************************************************************
000246* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 76      *
000247******************************************************************
      *<<((file: FDANA710))
000200                                                                  
000201*------------------------------- DANAGRAF.TARTIGREG               
000202 01  FILLER                      PIC X(8)  VALUE 'FDANA849'.      
000203*    EXEC SQL  INCLUDE FDANA849   END-EXEC.                       
      *>>((file: FDANA849))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TARTIGREG                 *
000003******************************************************************
000004 01  DCLTARTIGREG.                                                
000005     10 A849-CODARTGG        PIC X(5).                            
000006     10 A849-DESARTGG        PIC X(10).                           
000007     10 A849-ALTGREGG        PIC X(3).                            
000008     10 A849-STATUSGG        PIC X(1).                            
000009     10 A849-PESOGREG        PIC S9(5)V USAGE COMP-3.             
000010     10 A849-ARMATURA        PIC X(2).                            
000011     10 A849-CODDISGG        PIC X(5).                            
000012     10 A849-CODVARGG        PIC X(3).                            
000013     10 A849-CODVBLGG        PIC X(3).                            
000014     10 A849-CODISUBB        PIC X(6).                            
000015     10 A849-TIPOPROD        PIC X(1).                            
000016     10 A849-TIPOGREG        PIC X(1).                            
000017     10 A849-PERCIMBO        PIC S9(3)V USAGE COMP-3.             
000018     10 A849-PERCBOZZ        PIC S9(3)V USAGE COMP-3.             
000019     10 A849-SIGLBOZZ        PIC X(1).                            
000020     10 A849-CASCCATE        PIC S9(2)V9(1) USAGE COMP-3.         
000021     10 A849-CASCTRAM        PIC S9(2)V9(1) USAGE COMP-3.         
000022     10 A849-CODCOMP1        PIC X(2).                            
000023     10 A849-PERCCOM1        PIC X(3).                            
000024     10 A849-CODCOMP2        PIC X(2).                            
000025     10 A849-PERCCOM2        PIC X(3).                            
000026     10 A849-CODCOMP3        PIC X(2).                            
000027     10 A849-PERCCOM3        PIC X(3).                            
000028     10 A849-CODCOMP4        PIC X(2).                            
000029     10 A849-PERCCOM4        PIC X(3).                            
000030     10 A849-SIGTAPEZ        PIC X(2).                            
000031     10 A849-FAFISCAL        PIC X(4).                            
000032     10 A849-NRFILCAT        PIC S9(5)V USAGE COMP-3.             
000033     10 A849-ALTZPETT        PIC S9(4)V9(1) USAGE COMP-3.         
000034     10 A849-NRINSERZ        PIC S9(4)V9(1) USAGE COMP-3.         
000035     10 A849-LNMINGRE        PIC S9(3)V USAGE COMP-3.             
000036     10 A849-NRTAGGRE        PIC S9(1)V USAGE COMP-3.             
000037     10 A849-GREGORIG        PIC X(5).                            
000038     10 A849-SIMILGRE        PIC X(5).                            
000039     10 A849-VOCEDOGA        PIC X(11).                           
000040     10 A849-GRUPARTI        PIC X(1).                            
000041     10 A849-ANNULLAM        PIC X(1).                            
000042     10 A849-DTCREAZI        PIC X(8).                            
000043     10 A849-DTULTVAR        PIC X(8).                            
000044     10 A849-PERCACAL        PIC S9(3)V USAGE COMP-3.             
000045     10 A849-PERCASSO        PIC S9(5)V USAGE COMP-3.             
000046     10 A849-GREGMTUL        PIC X(5).                            
000047     10 A849-LUNGTAGR        PIC S9(5)V USAGE COMP-3.             
000048     10 A849-DTANNULL        PIC X(8).                            
000049     10 A849-LNMINTES        PIC S9(3)V USAGE COMP-3.             
000050     10 A849-PAESORIG        PIC X(3).                            
000051     10 A849-NRPZTIPO        PIC X(7).                            
000052     10 A849-PROLOMER        PIC X(2).                            
000053     10 A849-CODFORNI        PIC X(5).                            
000054     10 A849-SIGLATEL        PIC X(4).                            
000055     10 A849-TPTELAIO        PIC X(2).                            
000056     10 A849-DTORDITU        PIC X(8).                            
000057     10 A849-DTPREPAR        PIC X(8).                            
000058     10 A849-ALTARPPS        PIC X(3).                            
000059     10 A849-PESOXPPS        PIC S9(5)V USAGE COMP-3.             
000060     10 A849-RESAMAGL        PIC S9(3)V USAGE COMP-3.             
000061     10 A849-CARTCOLO        PIC X(4).                            
000062     10 A849-CODUTCRE        PIC X(6).                            
000063     10 A849-CODUTVAR        PIC X(6).                            
000064     10 A849-DTPROTES        PIC X(8).                            
000065     10 A849-DTPROPRE        PIC X(8).                            
000066     10 A849-PPSMTULM        PIC X(5).                            
000067     10 A849-CODLINEA        PIC X(2).                            
000068     10 A849-DTTESSIT        PIC X(8).                            
000069     10 A849-FLAGPROT        PIC X(1).                            
000070     10 A849-TIPOCOST        PIC X(2).                            
000071     10 A849-PERC2FIL        PIC S9(2)V9(1) USAGE COMP-3.         
000072     10 A849-PERC2TES        PIC S9(2)V9(1) USAGE COMP-3.         
000073     10 A849-TIPFINIS        PIC X(1).                            
000074     10 A849-STATRAMA        PIC S9(2)V9(1) USAGE COMP-3.         
000075     10 A849-STACATEN        PIC S9(2)V9(1) USAGE COMP-3.         
000076     10 A849-TIPOPROV        PIC X(2).                            
000077     10 A849-FLCOMNO1        PIC X(1).                            
000078     10 A849-FLCOMNO2        PIC X(1).                            
000079     10 A849-FLCOMNO3        PIC X(1).                            
000080     10 A849-FLCOMNO4        PIC X(1).                            
000081     10 A849-FAGREGGI        PIC X(13).                           
000082     10 A849-PERCPLAC        PIC S9(3)V USAGE COMP-3.             
000083     10 A849-INCLIFOR        PIC X.                               
000084     10 A849-SCALATES        PIC S9(3)V99 COMP-3.                 
000085     10 A849-SRCOLSTA        PIC X(2).                            
000086     10 A849-FLAGORIG        PIC X(1).                            
000087******************************************************************
000088* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 82      *
000089******************************************************************
      *<<((file: FDANA849))
000204                                                                  
000205*------------------------------- DANAGRAF.TARTICOLI               
000206 01  FILLER                      PIC X(8)  VALUE 'FDANA841'.      
000207*    EXEC SQL  INCLUDE FDANA841   END-EXEC.                       
      *>>((file: FDANA841))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TARTICOLI                 *
000003******************************************************************
000004 01  DCLTARTICOLI.                                                
000005     10 A841-CODARTFI        PIC X(5).                            
000006     10 A841-DESARTFI        PIC X(10).                           
000007     10 A841-TIPOARTI        PIC X(1).                            
000008     10 A841-TIPOCOST        PIC X(2).                            
000009     10 A841-ALTFINIT        PIC X(3).                            
000010     10 A841-PESOFINI        PIC S9(5)V USAGE COMP-3.             
000011     10 A841-CODCOMP1        PIC X(2).                            
000012     10 A841-PERCCOM1        PIC X(3).                            
000013     10 A841-CODCOMP2        PIC X(2).                            
000014     10 A841-PERCCOM2        PIC X(3).                            
000015     10 A841-CODCOMP3        PIC X(2).                            
000016     10 A841-PERCCOM3        PIC X(3).                            
000017     10 A841-CODCOMP4        PIC X(2).                            
000018     10 A841-PERCCOM4        PIC X(3).                            
000019     10 A841-CODARTGG        PIC X(5).                            
000020     10 A841-ACCALGRE        PIC S9(2)V9(1) USAGE COMP-3.         
000021     10 A841-TIPODIVI        PIC X(1).                            
000022     10 A841-TIPOMERC        PIC X(1).                            
000023     10 A841-TIPOPROD        PIC X(1).                            
000024     10 A841-ANNULLAM        PIC X(1).                            
000025     10 A841-PERCASSO        PIC S9(5)V USAGE COMP-3.             
000026     10 A841-DTCREAZI        PIC X(8).                            
000027     10 A841-DTULTVAR        PIC X(8).                            
000028     10 A841-SIGTAPEZ        PIC X(2).                            
000029     10 A841-SUBLINEA        PIC X(1).                            
000030     10 A841-STATUSGG        PIC X(1).                            
000031     10 A841-VOCEDOGA        PIC X(11).                           
000032     10 A841-CARTCOLO        PIC X(4).                            
000033     10 A841-PERCPREL        PIC S9(3)V USAGE COMP-3.             
000034     10 A841-PERCSCAM        PIC S9(2)V9(1) USAGE COMP-3.         
000035     10 A841-PERC2SCE        PIC S9(2)V9(1) USAGE COMP-3.         
000036     10 A841-RESAMAGL        PIC S9(3)V USAGE COMP-3.             
000037     10 A841-ACCALPPS        PIC S9(2)V9(1) USAGE COMP-3.         
000038     10 A841-PERPREGR        PIC S9(3)V USAGE COMP-3.             
000039     10 A841-CODLINEA        PIC X(2).                            
000040     10 A841-VOLFINIT        PIC S9(1)V9(3) USAGE COMP-3.         
000041     10 A841-TIPFINIS        PIC X(1).                            
000042     10 A841-STAGIONE        PIC X(3).                            
000043     10 A841-PERCTAGL        PIC S9(2)V9(1) USAGE COMP-3.         
000044     10 A841-PAESORIG        PIC X(3).                            
000045     10 A841-DTANNULL        PIC X(8).                            
000046     10 A841-DTULTPRO        PIC X(8).                            
000047     10 A841-CODUTCRE        PIC X(6).                            
000048     10 A841-CODUTVAR        PIC X(6).                            
000049     10 A841-DATACOST        PIC X(6).                            
000050     10 A841-CODLAVAG        PIC X(2).                            
000051     10 A841-PERC2FIL        PIC S9(2)V9(1) USAGE COMP-3.         
000052     10 A841-PERC2TES        PIC S9(2)V9(1) USAGE COMP-3.         
000053     10 A841-PERC2PRE        PIC S9(2)V9(1) USAGE COMP-3.         
000054     10 A841-PERC2FIN        PIC S9(2)V9(1) USAGE COMP-3.         
000055     10 A841-FINIORIG        PIC X(5).                            
000056     10 A841-PERC2PPT        PIC S9(2)V9(1) USAGE COMP-3.         
000057     10 A841-PERCSFRI        PIC S9(2)V9(1) USAGE COMP-3.         
000058     10 A841-DTULTCOM        PIC X(8).                            
000059     10 A841-DTCONFSK        PIC X(8).                            
000060     10 A841-UTCONFSK        PIC X(6).                            
000061     10 A841-FLAGPROT        PIC X(1).                            
000062     10 A841-CODIOEKO        PIC X(1).                            
000063     10 A841-NRPZTIPO        PIC X(7).                            
000064     10 A841-FLAGORIG        PIC X(1).                            
000065     10 A841-MADEINXX        PIC X(3).                            
000066     10 A841-FLCOMSI1        PIC X(1).                            
000067     10 A841-FLCOMSI2        PIC X(1).                            
000068     10 A841-FLCOMSI3        PIC X(1).                            
000069     10 A841-FLCOMSI4        PIC X(1).                            
000070     10 A841-FAFINITI        PIC X(13).                           
000071     10 A841-MADEINFF        PIC X(3).                            
000072     10 A841-MADEINGS        PIC X(3).                            
000073     10 A841-FLAGINKJ        PIC X(1).                            
000074     10 A841-FLSKFORN        PIC X(1).                            
000075     10 A841-TIPOCALI        PIC X(2).                            
000076     10 A841-SCALATES        PIC S9(3)V9(2) USAGE COMP-3.         
000077     10 A841-SRCOLSTA        PIC X(2).                            
000078     10 A841-CATEFINI        PIC X(1).                            
000079     10 A841-TECNOPRO        PIC X(2).                            
000080     10 A841-TPRANGLI        PIC X(2).                            
000081******************************************************************
000082* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 76      *
000083******************************************************************
      *<<((file: FDANA841))
000208                                                                  
000209*------------------------------- DANAGRAF.TUTENTI                 
000210 01  FILLER                      PIC X(8)  VALUE 'FDANA845'.      
000211*    EXEC SQL  INCLUDE FDANA845   END-EXEC.                       
      *>>((file: FDANA845))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TUTENTI)                                 *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA845))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(A845-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011******************************************************************
000012* COBOL DECLARATION FOR TABLE DANAGRAF.TUTENTI                   *
000013******************************************************************
000014 01  DCLTUTENTI.                                                  
000015*                       CODUTENT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000016     10 A845-CODUTENT        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000017*                       NOMUTENT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000018     10 A845-NOMUTENT        PIC X(20).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000019*                       CODILING                                  
000020     10 A845-CODILING        PIC X(1).                            
000021*                       SOCIECOM                                  
000022     10 A845-SOCIECOM        PIC X(2).                            
000023*                       SOCIEMER                                  
000024     10 A845-SOCIEMER        PIC X(2).                            
000025*                       CODIUFFI                                  
000026     10 A845-CODIUFFI        PIC X(2).                            
000027*                       STABILIM                                  
000028     10 A845-STABILIM        PIC X(2).                            
000029*                       PROLOMER                                  
000030     10 A845-PROLOMER        PIC X(2).                            
000031*                       CODDEPFF                                  
000032     10 A845-CODDEPFF        PIC X(2).                            
000033*                       CODDEPGG                                  
000034     10 A845-CODDEPGG        PIC X(2).                            
000035*                       CODDEPTT                                  
000036     10 A845-CODDEPTT        PIC X(2).                            
000037*                       CODCAPOS                                  
000038     10 A845-CODCAPOS        PIC X(3).                            
000039*                       CODSTATP                                  
000040     10 A845-CODSTATP        PIC X(4).                            
000041*                       CODSTALA                                  
000042     10 A845-CODSTALA        PIC X(4).                            
000043*                       CENCOSTO                                  
000044     10 A845-CENCOSTO        PIC X(5).                            
000045*                       FLAGRAPP                                  
000046     10 A845-FLAGRAPP        PIC X(1).                            
000047*                       FLAGXDSI                                  
000048     10 A845-FLAGXDSI        PIC X(1).                            
000049*                       INTNUTEN                                  
000050     10 A845-INTNUTEN        PIC X(50).                           
000051*                       CDUTRESP                                  
000052     10 A845-CDUTRESP        PIC X(6).                            
000053*                       TELUTENT                                  
000054     10 A845-TELUTENT        PIC X(20).                           
000055*                       FAXUTENT                                  
000056     10 A845-FAXUTENT        PIC X(20).                           
000057*                       CODDEPSC                                  
000058     10 A845-CODDEPSC        PIC X(2).                            
000059*                       LOTNUTEN                                  
000060     10 A845-LOTNUTEN        PIC X(50).                           
000061*                       FLXLOTUS                                  
000062     10 A845-FLXLOTUS        PIC X(1).                            
000063*                       CODDIPEN                                  
000064     10 A845-CODDIPEN        PIC X(7).                            
000065*                       FLAGLIMI                                  
000066     10 A845-FLAGLIMI        PIC X(1).                            
000067*                       DTCREAZI                                  
000068     10 A845-DTCREAZI        PIC X(8).                            
000069*                       CODUTCRE                                  
000070     10 A845-CODUTCRE        PIC X(6).                            
000071*                       DTULTVAR                                  
000072     10 A845-DTULTVAR        PIC X(8).                            
000073*                       CODUTVAR                                  
000074     10 A845-CODUTVAR        PIC X(6).                            
000075*                       CODSPECL                                  
000076     10 A845-CODSPECL        PIC X(1).                            
000077*                       CDQUALIF                                  
000078     10 A845-CDQUALIF        PIC X(1).                            
000079*                       CODDEPPR                                  
000080     10 A845-CODDEPPR        PIC X(2).                            
000081*                       CODBUYER                                  
000082     10 A845-CODBUYER        PIC X(2).                            
000083*                       CDEVARIC                                  
000084     10 A845-CDEVARIC        PIC X(2).                            
000085*                       UTCAMPIO                                  
000086     10 A845-UTCAMPIO        PIC X(2).                            
000087     10 A845-SIGLTEAM        PIC X(2).                            
000088     10 A845-CDVARNEO        PIC X(1).                            
000089******************************************************************
000090* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 37      *
000091******************************************************************
      *<<((file: FDANA845))
000212                                                                  
000213*------------------------------- DANAGRAF.TCENCOSTO               
000214 01  FILLER                      PIC X(8)  VALUE 'FDANA982'.      
000215*    EXEC SQL  INCLUDE FDANA982   END-EXEC.                       
      *>>((file: FDANA982))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TCENCOSTO)                               *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA982))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(A982-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DANAGRAF.TCENCOSTO TABLE                    
000012*     ( CODSOCIE                       CHAR(2) NOT NULL,           
000013*       CENCOSTO                       CHAR(5) NOT NULL,           
000014*       DESCENCO                       CHAR(30) NOT NULL,          
000015*       RAGCENCO                       CHAR(3) NOT NULL,           
000016*       ANNULLAM                       CHAR(1) NOT NULL,           
000017*       NEWCENCO                       CHAR(5) NOT NULL,           
000018*       CENCOLIS                       CHAR(5) NOT NULL,           
000019*       DTCREAZI                       CHAR(8) NOT NULL,           
000020*       DTULTVAR                       CHAR(8) NOT NULL,           
000021*       CODUTVAR                       CHAR(6) NOT NULL,           
000022*       CDMCAGTM                       CHAR(1) NOT NULL,           
000023*       CDAREGTM                       CHAR(2) NOT NULL,           
000024*       CDDIPGTM                       CHAR(1) NOT NULL,           
000025*       CDUBIGTM                       CHAR(2) NOT NULL,           
000026*       CDLINGTM                       CHAR(2) NOT NULL,           
000027*       SIGLCALE                       CHAR(3) NOT NULL,           
000028*       GRUPSIGE                       CHAR(1) NOT NULL,           
000029*       CDDIVISI                       CHAR(1) NOT NULL            
000030*     ) END-EXEC
                                                                        
000031******************************************************************
000032* COBOL DECLARATION FOR TABLE DANAGRAF.TCENCOSTO                 *
000033******************************************************************
000034 01  DCLTCENCOSTO.                                                
000035*                       CODSOCIE                                  
000036     10 A982-CODSOCIE        PIC X(2).                            
000037*                       CENCOSTO                                  
000038     10 A982-CENCOSTO        PIC X(5).                            
000039*                       DESCENCO                                  
000040     10 A982-DESCENCO        PIC X(30).                           
000041*                       RAGCENCO                                  
000042     10 A982-RAGCENCO        PIC X(3).                            
000043*                       ANNULLAM                                  
000044     10 A982-ANNULLAM        PIC X(1).                            
000045*                       NEWCENCO                                  
000046     10 A982-NEWCENCO        PIC X(5).                            
000047*                       CENCOLIS                                  
000048     10 A982-CENCOLIS        PIC X(5).                            
000049*                       DTCREAZI                                  
000050     10 A982-DTCREAZI        PIC X(8).                            
000051*                       DTULTVAR                                  
000052     10 A982-DTULTVAR        PIC X(8).                            
000053*                       CODUTVAR                                  
000054     10 A982-CODUTVAR        PIC X(6).                            
000055*                       CDMCAGTM                                  
000056     10 A982-CDMCAGTM        PIC X(1).                            
000057*                       CDAREGTM                                  
000058     10 A982-CDAREGTM        PIC X(2).                            
000059*                       CDDIPGTM                                  
000060     10 A982-CDDIPGTM        PIC X(1).                            
000061*                       CDUBIGTM                                  
000062     10 A982-CDUBIGTM        PIC X(2).                            
000063*                       CDLINGTM                                  
000064     10 A982-CDLINGTM        PIC X(2).                            
000065*                       SIGLCALE                                  
000066     10 A982-SIGLCALE        PIC X(3).                            
000067*                       GRUPSIGE                                  
000068     10 A982-GRUPSIGE        PIC X(1).                            
000069*                       CDDIVISI                                  
000070     10 A982-CDDIVISI        PIC X(1).                            
000071******************************************************************
000072* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 18      *
000073******************************************************************
      *<<((file: FDANA982))
000216                                                                  
000217*------------------------------- DMEST.TDISEGNI                   
000218 01  FILLER                      PIC X(8)  VALUE 'FDMES892'.      
000219*    EXEC SQL  INCLUDE FDMES892   END-EXEC.                       
      *>>((file: FDMES892))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DMEST.TDISEGNI                     *
000003******************************************************************
000004 01  DCLTDISEGNI.                                                 
000005     10 M892-CODDISFI        PIC X(5).                            
000006     10 M892-SOCIEMER        PIC X(2).                            
000007     10 M892-SLSTADIS        PIC X(1).                            
000008     10 M892-CODARTFI        PIC X(5).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000009     10 M892-CODLINEA        PIC X(2).                            
000010     10 M892-TIPSTALL        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000011     10 M892-STAGIONE        PIC X(2).                            
000012     10 M892-RICHBUDG        PIC X(3).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000013     10 M892-CODCLIEN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000014     10 M892-SLARCLAS        PIC X(5).                            
000015     10 M892-FORNILUC        PIC X(5).                            
000016     10 M892-FORNIFIN        PIC X(5).                            
000017     10 M892-NRLUCIDI        PIC S9(3)V USAGE COMP-3.             
000018     10 M892-DTCONRIC        PIC X(8).                            
000019     10 M892-SSCONRIC        PIC X(6).                            
000020     10 M892-DTCONLUC        PIC X(8).                            
000021     10 M892-SSCONLUC        PIC X(6).                            
000022     10 M892-DTCONCIL        PIC X(8).                            
000023     10 M892-SSCONCIL        PIC X(6).                            
000024     10 M892-DTCONEFF        PIC X(8).                            
000025     10 M892-DTEFFLUC        PIC X(8).                            
000026     10 M892-PRIORDIS        PIC X(2).                            
000027     10 M892-SLRAGLAV        PIC X(2).                            
000028     10 M892-FLFATTUR        PIC X(1).                            
000029     10 M892-SLTEMDIS        PIC X(5).                            
000030     10 M892-RAPPDISE        PIC X(3).                            
000031     10 M892-FLDIRFIL        PIC X(1).                            
000032     10 M892-UTCAMPIO        PIC X(6).                            
000033     10 M892-NOTEDISE        PIC X(70).                           
000034     10 M892-NOTECONP        PIC X(20).                           
000035     10 M892-FLAGGIOR        PIC X(1).                            
000036     10 M892-DTCREAZI        PIC X(8).                            
000037     10 M892-DTULTVAR        PIC X(8).                            
000038     10 M892-CODUTVAR        PIC X(6).                            
000039     10 M892-FLANUOVO        PIC X(1).                            
000040     10 M892-SLREGIST        PIC X(20).                           
000041     10 M892-CDCARDI1        PIC X(2).                            
000042     10 M892-CDCARDI2        PIC X(2).                            
000043     10 M892-CDCARDI3        PIC X(2).                            
000044     10 M892-CDCARDI4        PIC X(2).                            
000045     10 M892-CDCARDI5        PIC X(2).                            
000046     10 M892-FLAGXCAD        PIC X(1).                            
000047     10 M892-CODVARCA        PIC X(3).                            
000048     10 M892-ALTDISMM        PIC S9(5)V9(4) USAGE COMP-3.         
000049     10 M892-LARDISMM        PIC S9(5)V9(4) USAGE COMP-3.         
000050     10 M892-ALTDISPX        PIC S9(5)V9(4) USAGE COMP-3.         
000051     10 M892-LARDISPX        PIC S9(5)V9(4) USAGE COMP-3.         
000052     10 M892-SLALTDMM        PIC S9(5)V9(4) USAGE COMP-3.         
000053     10 M892-SLLARDMM        PIC S9(5)V9(4) USAGE COMP-3.         
000054     10 M892-SLALTDPX        PIC S9(5)V9(4) USAGE COMP-3.         
000055     10 M892-SLLARDPX        PIC S9(5)V9(4) USAGE COMP-3.         
000056     10 M892-FLCONDIV        PIC X(1).                            
000057     10 M892-DTCONDIV        PIC X(8).                            
000058     10 M892-NOMDIDIS        PIC X(9).                            
000059     10 M892-ALTINCIS        PIC X(3).                            
000060     10 M892-FLBUDALL        PIC X(1).                            
000061     10 M892-ESCLMOND        PIC X(1).                            
000062     10 M892-DTEXCMON        PIC X(8).                            
000063     10 M892-RIFEFORN        PIC X(20).                           
000064     10 M892-FLAGCINA        PIC X(1).                            
000065     10 M892-TIPORAPP        PIC X(1).                            
000066     10 M892-RAPPORT1        PIC S9(3)V USAGE COMP-3.             
000067     10 M892-RAPPORT2        PIC S9(3)V USAGE COMP-3.             
000068     10 M892-FLAGINKJ        PIC X(1).                            
000069     10 M892-CDDIFLAV        PIC X(1).                            
000070     10 M892-DTCOPYRI        PIC X(8).                            
000071     10 M892-CODUTCRE        PIC X(6).                            
000072     10 M892-DTSCADEN        PIC X(8).                            
000073     10 M892-FLRETINO        PIC X(1).                            
000074     10 M892-ROTA90SX        PIC X(1).                            
000075     10 M892-NOTEDIS2        PIC X(70).                           
000076     10 M892-DISEORIG        PIC X(05).                           
000077     10 M892-PESORESI        PIC S9(3)V USAGE COMP-3.             
000078     10 M892-SIGLTEAM        PIC X(02).                           
000079     10 M892-FLAGINCI        PIC X(01).                           
000080     10 M892-DTEXCSCA        PIC X(08).                           
000081     10 M892-FLAGECOM        PIC X(01).                           
000082     10 M892-STAGION3        PIC X(03).                           
000083     10 M892-DTSTGPRO        PIC X(08).                           
000084     10 M892-RIFEDISE        PIC X(20).                           
000085******************************************************************
000086* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 80      *
000087******************************************************************
      *<<((file: FDMES892))
000220                                                                  
000221*------------------------------- DMEST.TCOSTIMEST                 
000222 01  FILLER                      PIC X(8)  VALUE 'FDMES612'.      
000223*    EXEC SQL  INCLUDE FDMES612   END-EXEC.                       
      *>>((file: FDMES612))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DMEST.TCOSTIMEST                   *
000003******************************************************************
000004 01  DCLTCOSTIMEST.                                               
000005     10 M612-NRCOSMES        PIC X(8).                            
000006     10 M612-CODDISFI        PIC X(5).                            
000007     10 M612-SERIECIL        PIC X(2).                            
000008     10 M612-NUMCILIN        PIC X(2).                            
000009     10 M612-NUMEBOZT        PIC X(8).                            
000010     10 M612-SOCIEMER        PIC X(2).                            
000011     10 M612-SLLAVMES        PIC X(2).                            
000012     10 M612-CODFORNI        PIC X(5).                            
000013     10 M612-DTRIPPRE        PIC X(8).                            
000014     10 M612-DTRIPEFF        PIC X(8).                            
000015     10 M612-DTCONCOS        PIC X(8).                            
000016     10 M612-NRCILLAV        PIC S9(3)V USAGE COMP-3.             
000017     10 M612-CODDIVIS        PIC X(2).                            
000018     10 M612-COSTMEST        PIC S9(9)V9(2) USAGE COMP-3.         
000019     10 M612-CODDIVRI        PIC X(2).                            
000020     10 M612-CVLCOSME        PIC S9(9)V9(2) USAGE COMP-3.         
000021     10 M612-NUMFATTU        PIC X(6).                            
000022     10 M612-DTFATTUR        PIC X(8).                            
000023     10 M612-NUMBOLLA        PIC X(16).                           
000024     10 M612-DATBOLLA        PIC X(8).                            
000025     10 M612-NOTENOTE        PIC X(20).                           
000026     10 M612-DATAESTR        PIC X(8).                            
000027     10 M612-CENCOSTO        PIC X(5).                            
000028     10 M612-CONTODCE        PIC X(6).                            
000029     10 M612-DTCREAZI        PIC X(8).                            
000030     10 M612-DTULTVAR        PIC X(8).                            
000031     10 M612-CODUTVAR        PIC X(6).                            
000032     10 M612-NRCILNEW        PIC S9(3)V USAGE COMP-3.             
000033     10 M612-NRCILREC        PIC S9(3)V USAGE COMP-3.             
000034     10 M612-CVLCOSNW        PIC S9(9)V9(2) USAGE COMP-3.         
000035     10 M612-CVLCOSRC        PIC S9(9)V9(2) USAGE COMP-3.         
000036     10 M612-NRCILGAL        PIC S9(3)V USAGE COMP-3.             
000037     10 M612-CVLCOSGA        PIC S9(9)V9(2) USAGE COMP-3.         
000038     10 M612-CODLINEA        PIC X(2).                            
000039     10 M612-CODCLIEN        PIC X(5).                            
000040     10 M612-FLAGERRO        PIC X(1).                            
000041     10 M612-FLGRATIS        PIC X(1).                            
000042******************************************************************
000043* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 37      *
000044******************************************************************
      *<<((file: FDMES612))
000224                                                                  
000225*------------------------------- DMEST.TBOZZETTI                  
000226 01  FILLER                      PIC X(8)  VALUE 'FDMES660'.      
000227*    EXEC SQL  INCLUDE FDMES660   END-EXEC.                       
      *>>((file: FDMES660))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DMEST.TBOZZETTI                    *
000003******************************************************************
000004 01  DCLTBOZZETTI.                                                
000005     10 M660-NUMEBOZT        PIC X(8).                            
000006     10 M660-DESCBOZT        PIC X(30).                           
000007     10 M660-SIGLBOZT        PIC X(20).                           
000008     10 M660-SLTPBOZT        PIC X(2).                            
000009     10 M660-SOCIEMER        PIC X(2).                            
000010     10 M660-CODFORNI        PIC X(5).                            
000011     10 M660-UTCAMPIO        PIC X(6).                            
000012     10 M660-CODLINEA        PIC X(2).                            
000013     10 M660-DTCREAZI        PIC X(8).                            
000014     10 M660-DTULTVAR        PIC X(8).                            
000015     10 M660-CODUTVAR        PIC X(6).                            
000016     10 M660-SUBLINEA        PIC X(2).                            
000017     10 M660-INCLIFOR        PIC X(1).                            
000018     10 M660-CDCARDI1        PIC X(2).                            
000019     10 M660-CDCARDI2        PIC X(2).                            
000020     10 M660-CDCARDI3        PIC X(2).                            
000021     10 M660-CDCARDI4        PIC X(2).                            
000022     10 M660-CDCARDI5        PIC X(2).                            
000023     10 M660-SLTEMDIS        PIC X(5).                            
000024     10 M660-SLREGIST        PIC X(20).                           
000025     10 M660-DATABOZT        PIC X(8).                            
000026     10 M660-TIPSTALL        PIC X(1).                            
000027     10 M660-STAGIONE        PIC X(2).                            
000028     10 M660-UTCAMPI2        PIC X(6).                            
000029     10 M660-POSIBOZT        PIC X(6).                            
000030     10 M660-STAGION3        PIC X(3).                            
      *<<((file: FDMES660))
000228                                                                  
000229*------------------------------- DMEST.TSERIEDIS                  
000230 01  FILLER                      PIC X(8)  VALUE 'FDMES610'.      
000231*    EXEC SQL  INCLUDE FDMES610   END-EXEC.                       
      *>>((file: FDMES610))
000001******************************************************************
000002* DCLGEN TABLE(DMEST.TSERIEDIS)                                  *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDMES610))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        QUOTE                                                   *
000007* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000008******************************************************************
000009******************************************************************
000010* COBOL DECLARATION FOR TABLE DMEST.TSERIEDIS                    *
000011******************************************************************
000012 01  DCLTSERIEDIS.                                                
000013     10 M610-CODDISFI        PIC X(5).                            
000014     10 M610-SERIECIL        PIC X(2).                            
000015     10 M610-SOCIEMER        PIC X(2).                            
000016     10 M610-SLSTASER        PIC X(1).                            
000017     10 M610-CODARTFI        PIC X(5).                            
000018     10 M610-CODLINEA        PIC X(2).                            
000019     10 M610-TIPSTALL        PIC X(1).                            
000020     10 M610-STAGIONE        PIC X(2).                            
000021     10 M610-UTISERIE        PIC X(5).                            
000022     10 M610-FLAGPARZ        PIC X(1).                            
000023     10 M610-CODINCIS        PIC X(5).                            
000024     10 M610-DATINCIS        PIC X(8).                            
000025     10 M610-TOTCILIN        PIC S9(3)V USAGE COMP-3.             
000026     10 M610-DTANNULL        PIC X(8).                            
000027     10 M610-DTCREAZI        PIC X(8).                            
000028     10 M610-DTULTVAR        PIC X(8).                            
000029     10 M610-CODUTVAR        PIC X(6).                            
000030     10 M610-DTMANTDS        PIC X(8).                            
000031     10 M610-FLAGRICH        PIC X(1).                            
000032     10 M610-SOCIEOLD        PIC X(2).                            
000033******************************************************************
000034* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 20      *
000035******************************************************************
      *<<((file: FDMES610))
000232                                                                  
000233*------------------------------- DANAGRAF.TLINEAVEN               
000234 01  FILLER                      PIC X(8)  VALUE 'FDMES497'.      
000235*    EXEC SQL  INCLUDE FDANA497   END-EXEC.                       
      *>>((file: FDANA497))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TLINEAVEN                 *
000003******************************************************************
000004 01  DCLTLINEAVEN.                                                
000005*                       CODLINEA                                  
000006     10 A497-CODLINEA        PIC X(2).                            
000007*                       DESCLINE                                  
000008     10 A497-DESCLINE        PIC X(12).                           
000009*                       RAGLINEA                                  
000010     10 A497-RAGLINEA        PIC X(1).                            
000011*                       PROLOMER                                  
000012     10 A497-PROLOMER        PIC X(2).                            
000013*                       CODMARCH                                  
000014     10 A497-CODMARCH        PIC X(2).                            
000015*                       CENCOLIS                                  
000016     10 A497-CENCOLIS        PIC X(5).                            
000017*                       FLFAMFOR                                  
000018     10 A497-FLFAMFOR        PIC X(1).                            
000019*                       CATEARTI                                  
000020     10 A497-CATEARTI        PIC X(1).                            
000021*                       SLTIPLIN                                  
000022     10 A497-SLTIPLIN        PIC X(1).                            
000023*                       DTANNULL                                  
000024     10 A497-DTANNULL        PIC X(8).                            
000025*                       DTCREAZI                                  
000026     10 A497-DTCREAZI        PIC X(8).                            
000027*                       DTULTVAR                                  
000028     10 A497-DTULTVAR        PIC X(8).                            
000029*                       CODUTVAR                                  
000030     10 A497-CODUTVAR        PIC X(6).                            
000031*                       CODPAESE                                  
000032     10 A497-CODPAESE        PIC X(3).                            
000033*                       TIPOSTAG                                  
000034     10 A497-TIPOSTAG        PIC X(1).                            
000035*                       CODARTIC                                  
000036     10 A497-CODARTIC        PIC X(5).                            
000037*                       CENCOLI1                                  
000038     10 A497-CENCOLI1        PIC X(5).                            
000039*                       CENCOLI2                                  
000040     10 A497-CENCOLI2        PIC X(5).                            
000041*                       FLAGINKJ                                  
000042     10 A497-FLAGINKJ        PIC X(1).                            
000043     10 A497-CENCOLI3        PIC X(5).                            
000044     10 A497-CENCOLI4        PIC X(5).                            
000045     10 A497-CENCOLI5        PIC X(5).                            
000046******************************************************************
000047* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 22      *
000048******************************************************************
      *<<((file: FDANA497))
000236                                                                  
000237*------------------------------- DANAGRAF.TPROLOMER               
000238 01  FILLER                      PIC X(8)  VALUE 'FDMES496'.      
000239*    EXEC SQL  INCLUDE FDANA496   END-EXEC.                       
      *>>((file: FDANA496))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TPROLOMER                 *
000003******************************************************************
000004 01  DCLTPROLOMER.                                                
000005     10 A496-PROLOMER        PIC X(2).                            
000006     10 A496-DESPLOME        PIC X(20).                           
000007     10 A496-CODLINEA        PIC X(2).                            
000008     10 A496-CDDIVISI        PIC X(1).                            
000009     10 A496-CODDEPOS        PIC X(2).                            
000010     10 A496-RAGCENCO        PIC X(3).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000011     10 A496-CDDIRDIV        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000012     10 A496-GENERALM        PIC X(2).                            
000013     10 A496-NOMDIDIS        PIC X(9).                            
000014     10 A496-PROLODIR        PIC X(2).                            
000015     10 A496-FLAGRESO        PIC X(1).                            
000016     10 A496-SELASQUA        PIC S9(3)V USAGE COMP-3.             
000017     10 A496-DTANNULL        PIC X(8).                            
000018     10 A496-DTCREAZI        PIC X(8).                            
000019     10 A496-DTULTVAR        PIC X(8).                            
000020     10 A496-CODUTVAR        PIC X(6).                            
000021     10 A496-CENCOCON        PIC X(5).                            
000022     10 A496-FLAGARCH        PIC X(1).                            
000023     10 A496-CDUTRESP        PIC X(6).                            
000024     10 A496-PROLOPRE        PIC X(2).                            
000025     10 A496-CDMCAGTM        PIC X(1).                            
000026     10 A496-CDAREGTM        PIC X(2).                            
000027     10 A496-CODRESPO        PIC X(2).                            
000028     10 A496-CENCOSTO        PIC X(5).                            
000029     10 A496-CENCOALL        PIC X(5).                            
000030     10 A496-CENCOGEN        PIC X(5).                            
000031     10 A496-CODRESP2        PIC X(2).                            
000032******************************************************************
000033* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 27      *
000034******************************************************************
      *<<((file: FDANA496))
000240                                                                  
000241*------------------------------- DALLEST.TORDICAMPIO              
000242 01  FILLER                      PIC X(8)  VALUE 'FDALL828'.      
000243*    EXEC SQL  INCLUDE FDALL828   END-EXEC.                       
      *>>((file: FDALL828))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DALLEST.TORDICAMPIO                *
000003******************************************************************
000004 01  DCLTORDICAMPIO.                                              
000005     10 A828-AANUMORD        PIC X(8).                            
000006     10 A828-CODREPAR        PIC X(1).                            
000007     10 A828-SUBREPAR        PIC X(1).                            
000008     10 A828-CODARTFI        PIC X(5).                            
000009     10 A828-CODDISFI        PIC X(5).                            
000010     10 A828-CODARTGG        PIC X(5).                            
000011     10 A828-DTORDCAM        PIC X(8).                            
000012     10 A828-UTCAMPIO        PIC X(6).                            
000013     10 A828-PRIORCAM        PIC X(2).                            
000014     10 A828-SOCIEMER        PIC X(2).                            
000015     10 A828-CONPRCAM        PIC X(8).                            
000016     10 A828-PREZZORD        PIC S9(5)V9(2) USAGE COMP-3.         
000017     10 A828-STAGIONE        PIC X(2).                            
000018     10 A828-TIPSTALL        PIC X(1).                            
000019     10 A828-CLIECAMP        PIC X(5).                            
000020     10 A828-TPRICBUD        PIC X(1).                            
000021     10 A828-RICHBUDG        PIC X(3).                            
000022     10 A828-ESCLUSIV        PIC X(1).                            
000023     10 A828-NOTCAMPI        PIC X(70).                           
000024     10 A828-RIFIUCAM        PIC X(2).                            
000025     10 A828-CONEFCAM        PIC X(8).                            
000026     10 A828-CODMACCH        PIC X(4).                            
000027     10 A828-COLPICAM        PIC S9(5)V USAGE COMP-3.             
000028     10 A828-FLCARPRO        PIC X(1).                            
000029     10 A828-DTULTVAR        PIC X(8).                            
000030     10 A828-DTANNCAM        PIC X(8).                            
000031     10 A828-STORDCAM        PIC X(1).                            
000032     10 A828-SERIECIL        PIC X(2).                            
000033     10 A828-RICBUDSP        PIC X(3).                            
000034     10 A828-DTDISCAM        PIC X(8).                            
000035     10 A828-DATAESTR        PIC X(8).                            
000036     10 A828-TEMPESTR        PIC X(4).                            
000037     10 A828-CODDIVIS        PIC X(2).                            
000038     10 A828-DTANNRIF        PIC X(8).                            
000039     10 A828-DTSTAMOR        PIC X(8).                            
000040     10 A828-NRSTAMOR        PIC S9(3)V USAGE COMP-3.             
000041     10 A828-TMSTAMOR        PIC S9(3)V USAGE COMP-3.             
000042     10 A828-FLCUCINA        PIC X(1).                            
000043     10 A828-TIPORICE        PIC X(1).                            
000044     10 A828-QTMTPROD        PIC S9(4)V9(1) USAGE COMP-3.         
000045     10 A828-DEPDESTI        PIC X(2).                            
000046     10 A828-DIVSOCIE        PIC X(2).                            
000047     10 A828-IMPOFATT        PIC S9(11)V9(2) USAGE COMP-3.        
000048     10 A828-QTAFATTU        PIC S9(7)V9(2) USAGE COMP-3.         
000049     10 A828-TIRELFAT        PIC S9(3)V USAGE COMP-3.             
000050     10 A828-COLPIFAT        PIC S9(5)V USAGE COMP-3.             
000051     10 A828-CDACQORD        PIC X(1).                            
000052     10 A828-MTTAGLIO        PIC S9(5)V USAGE COMP-3.             
000053     10 A828-STABILIM        PIC X(2).                            
000054     10 A828-VPTEMCOL        PIC X(1).                            
000055     10 A828-CODFORNI        PIC X(5).                            
000056     10 A828-DIVIFORN        PIC X(2).                            
000057     10 A828-PREZFORN        PIC S9(7)V9(2) USAGE COMP-3.         
000058     10 A828-NUMPROG7        PIC S9(7)V USAGE COMP-3.             
000059     10 A828-CODFIERA        PIC X(1).                            
000060     10 A828-IMPOFINI        PIC S9(11)V9(2) USAGE COMP-3.        
000061     10 A828-DESCCALI        PIC X(40).                           
000062     10 A828-SCALATES        PIC S9(3)V9(2) USAGE COMP-3.         
000063     10 A828-PERCRIDU        PIC S9(3)V9(2) USAGE COMP-3.         
000064     10 A828-FLCENTRA        PIC X.                               
000065     10 A828-PARTSTAM        PIC S9(3)V9(2) USAGE COMP-3.         
000066     10 A828-SRCOLSTA        PIC X(2).                            
000067     10 A828-ALTARPPS        PIC X(3).                            
000068     10 A828-NUMCOPIE        PIC S9(3)V USAGE COMP-3.             
000069     10 A828-DESTIKOF        PIC X(1).                            
000070     10 A828-CMSTATIR        PIC S9(5)V9(2) USAGE COMP-3.         
000071     10 A828-DESTIKO2        PIC X(2).                            
000072     10 A828-DTSTAMET        PIC X(8).                            
000073     10 A828-ORDIORIG        PIC X(8).                            
000074******************************************************************
000075* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 68      *
000076******************************************************************
      *<<((file: FDALL828))
000244                                                                  
000245*------------------------------- DALLEST.TRIGORDCAMPIO            
000246 01  FILLER                      PIC X(8)  VALUE 'FDALL829'.      
000247*    EXEC SQL  INCLUDE FDALL829   END-EXEC.                       
      *>>((file: FDALL829))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DALLEST.TRIGORDCAMPIO              *
000003******************************************************************
000004 01  DCLTRIGORDCAMPIO.                                            
000005     10 A829-AANUMORD        PIC X(8).                            
000006*                       CODVARCA                                  
000007     10 A829-CODVARCA        PIC X(3).                            
000008*                       MTTAGORD                                  
000009     10 A829-MTTAGORD        PIC S9(3)V9(2) USAGE COMP-3.         
000010*                       DTCREAZI                                  
000011     10 A829-DTCREAZI        PIC X(8).                            
000012*                       DTULTVAR                                  
000013     10 A829-DTULTVAR        PIC X(8).                            
000014*                       NRCOLORI                                  
000015     10 A829-NRCOLORI        PIC X(3).                            
000016*                       DTPROCAM                                  
000017     10 A829-DTPROCAM        PIC X(8).                            
000018*                       TIPSTCAM                                  
000019     10 A829-TIPSTCAM        PIC X(1).                            
000020*                       DTANNULL                                  
000021     10 A829-DTANNULL        PIC X(8).                            
000022*                       PREZZLAV                                  
000023     10 A829-PREZZLAV        PIC S9(11)V9(4) USAGE COMP-3.        
000024*                       QTARICEV                                  
000025     10 A829-QTARICEV        PIC S9(7)V9(2) USAGE COMP-3.         
000026*                       MTPROVAR                                  
000027     10 A829-MTPROVAR        PIC S9(4)V9(1) USAGE COMP-3.         
000028*                       DATARICE                                  
000029     10 A829-DATARICE        PIC X(8).                            
000030*                       FLSTRIKE                                  
000031     10 A829-FLSTRIKE        PIC X(1).                            
000032     10 A829-NUMBOLLA        PIC X(16).                           
000033     10 A829-DATBOLLA        PIC X(8).                            
000034     10 A829-DATAESTR        PIC X(8).                            
000035     10 A829-DESCCALI        PIC X(40).                           
000036     10 A829-NRRIGORD        PIC S9(3)V     USAGE COMP-3.         
000037     10 A829-CODVARTX        PIC X(4).                            
000038******************************************************************
000039* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 18      *
000040******************************************************************
      *<<((file: FDALL829))
000248                                                                  
000249*------------------------------- DLOGISTI.TSERVIZI                
000250 01  FILLER                      PIC X(8)  VALUE 'FDLOG651'.      
000251*    EXEC SQL  INCLUDE FDLOG651   END-EXEC.                       
      *>>((file: FDLOG651))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TSERVIZI                  *
000003******************************************************************
000004 01  DCLTSERVIZI.                                                 
000005*                       CODSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006     10 L651-CODSERVI        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007*                       DESSERVI                                  
000008     10 L651-DESSERVI        PIC X(40).                           
000009*                       UNMISURA                                  
000010     10 L651-UNMISURA        PIC X(2).                            
000011*                       TIPSERVI                                  
000012     10 L651-TIPSERVI        PIC X(1).                            
000013*                       DTCREAZI                                  
000014     10 L651-DTCREAZI        PIC X(8).                            
000015*                       DTULTVAR                                  
000016     10 L651-DTULTVAR        PIC X(8).                            
000017*                       CODUTVAR                                  
000018     10 L651-CODUTVAR        PIC X(6).                            
000019*                       CONTODCD                                  
000020     10 L651-CONTODCD        PIC X(6).                            
000021*                       CONTODCA                                  
000022     10 L651-CONTODCA        PIC X(6).                            
000023*                       CENCOSTA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000024     10 L651-CENCOSTA        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025     10 L651-ESENTIVA        PIC X(1).                            
000026     10 L651-CONTPROV        PIC X(6).                            
000027******************************************************************
000028* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 12      *
000029******************************************************************
      *<<((file: FDLOG651))
000252                                                                  
000253*------------------------------- SAP_CCOS                         
000254 01  FILLER                      PIC X(8)  VALUE 'FDSAP001'.      
000255*    EXEC SQL  INCLUDE FDSAP001   END-EXEC.                       
      *>>((file: FDSAP001))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE MDHUB.SAP_CCOS                     *
000003******************************************************************
000004 01  DCLTSAP-CCOS.                                                
000005     10 S001-MANDANTE        PIC X(06).                           
000006     10 S001-CONTR-AREA      PIC X(08).                           
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000007     10 S001-CCOSSAP         PIC X(20).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000008     10 S001-NOME-GEN        PIC X(40).                           
000009     10 S001-DESCRIZIONE     PIC X(80).                           
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000010     10 S001-SOCI            PIC X(08).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000011     10 S001-VALIDO-DA       PIC X(10).                           
000012     10 S001-VALIDO-A        PIC X(10).                           
000013     10 S001-CREATO          PIC X(10).                           
000014     10 S001-CATEG-CCOS      PIC X(02).                           
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000015     10 S001-CCOSGTM         PIC X(40).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000016     10 S001-DVS             PIC X(10).                           
000017     10 S001-NOD-GER-STAND   PIC X(24).                           
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000018     10 S001-PROFIT-CENTER   PIC X(20).                           
000019     10 S001-DIPAR           PIC X(24).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000020     10 S001-CODICE-NEGOZIO  PIC X(08).                           
000021     10 S001-FUN-AREA        PIC X(32).                           
000022     10 S001-VECCHIO-NEGOZIO PIC X(20).                           
      *<<((file: FDSAP001))
000256                                                                  
000257*------------------------------- SAP_ORDACQ_HEADER                
000258 01  FILLER                      PIC X(8)  VALUE 'FDSAP005'.      
000259*    EXEC SQL  INCLUDE FDSAP005   END-EXEC.                       
      *>>((file: FDSAP005))
000001******************************************************************
000002*COBOL DECLARATION FOR TABLE DBGTM.SAP-ORDACQ-HEADER             *
000003******************************************************************
000004 01 DCLSAP-ORDACQ-HEADER.                                         
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005    10 S005-ODA-CICS             PIC X(10).                       
000006    10 S005-GEN-ODA              PIC X(3).                        
000007    10 S005-TIPO-ODA             PIC X(2).                        
000008    10 S005-SOURCE               PIC X(10).                       
000009    10 S005-COMP-CODE            PIC X(4).                        
000010    10 S005-VENDOR               PIC X(10).                       
000011    10 S005-PURCH-ORG            PIC X(4).                        
000012    10 S005-PUR-GROUP            PIC X(3).                        
000013    10 S005-CURRENCY             PIC X(5).                        
000014    10 S005-CREATED-BY           PIC X(12).                       
000015    10 S005-OUR-REF              PIC X(12).                       
000016    10 S005-INCOTERMS1           PIC X(3).                        
000017    10 S005-INCOTERMS2           PIC X(28).                       
000018    10 S005-HEADERTEXT           PIC X(132).                      
000019    10 S005-CRT                  PIC X(1).                        
000020    10 S005-CRT-ST               PIC X(2).                        
000021    10 S005-MOD                  PIC X(1).                        
000022    10 S005-MOD-ST               PIC X(2).                        
000023    10 S005-MOD-PROGR-NUM        PIC X(5).                        
000024    10 S005-MAIDEN               PIC X(3).                        
000025    10 S005-CATENA               PIC X(3).                        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000026    10 S005-LEGAME-ODA-SAP-CICS  PIC X(10).                       
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000027    10 S005-DATA-CTR             PIC X(6).                        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000028    10 S005-FLAG-CAN             PIC X(1).                        
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000029    10 S005-LINGUA               PIC X(2).                        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
      *<<((file: FDSAP005))
000260                                                                  
000261*------------------------------- SAP_ORDACQ_ITEM                  
000262 01  FILLER                      PIC X(8)  VALUE 'FDSAP006'.      
000263*    EXEC SQL  INCLUDE FDSAP006   END-EXEC.                       
      *>>((file: FDSAP006))
000001******************************************************************
000002*COBOL DECLARATION FOR TABLE DBGTM.SAP-ORDACQ-ITEM               *
000003******************************************************************
000004 01 DCLSAP-ORDACQ-ITEM.                                           
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005    10 S006-ODA-CICS-ITEMTABLE     PIC X(10).                     
000006    10 S006-CICS-PO-ITEM-ITEMTABLE PIC X(3).                      
000007    10 S006-PO-ITEM              PIC X(5).                        
000008    10 S006-COMP-CODE            PIC X(4).                        
000009    10 S006-PROD-TYPE            PIC X(2).                        
000010    10 S006-FLAG-CANC            PIC X(1).                        
000011    10 S006-ARTICOLO             PIC X(40).                       
000012    10 S006-GRUPPO-MERCI         PIC X(9).                        
000013    10 S006-SHORT-DESC           PIC X(40).                       
000014    10 S006-PLANT                PIC X(4).                        
000015    10 S006-STORAGE-LOC          PIC X(4).                        
000016    10 S006-QUANTITY             PIC S9(10)V9(3) USAGE COMP-3.    
000017    10 S006-UM-ODA               PIC X(3).                        
000018    10 S006-PREZZO-NETTO         PIC S9(9)V9(2) USAGE COMP-3.     
000019    10 S006-PREZZO-UNITARIO      PIC S9(5)V USAGE COMP-3.         
000020    10 S006-VALORE-NETTO-ODA     PIC S9(11)V9(2) USAGE COMP-3.    
000021    10 S006-TIPO-POS             PIC X(1).                        
000022    10 S006-TIPO-CONT            PIC X(1).                        
000023    10 S006-PESO-NETTO           PIC S9(10)V9(3) USAGE COMP-3.    
000024    10 S006-UM-PESO              PIC X(3).                        
000025    10 S006-PESO-LORDO           PIC S9(10)V9(3) USAGE COMP-3.    
000026    10 S006-VOLUME               PIC S9(10)V9(3) USAGE COMP-3.    
000027    10 S006-UM-VOLUME            PIC X(3).                        
000028    10 S006-COMM-CODE            PIC X(30).                       
000029    10 S006-SCHED-LINE           PIC S9(4)V USAGE COMP-3.         
000030    10 S006-DATA-CONS            PIC X(10).                       
000031    10 S006-QUANT-CONS           PIC S9(10)V9(3) USAGE COMP-3.    
000032    10 S006-POS-TEXT             PIC X(132).                      
000033    10 S006-ESERC-STAGIONALE     PIC X(4).                        
000034    10 S006-COLLEZIONE           PIC X(10).                       
000035    10 S006-STAGIONE             PIC X(10).                       
000036    10 S006-OVER-DLV-TOL         PIC S9(3)V9(1) USAGE COMP-3.     
000037    10 S006-UNLIMITED-DLV        PIC X(1).                        
000038    10 S006-UNDER-DLV-TOL        PIC S9(3)V9(1) USAGE COMP-3.     
000039    10 S006-QUAL-INSP            PIC X(1).                        
000040    10 S006-STK-SEG-LONG         PIC X(40).                       
000041    10 S006-FREE-ITEM            PIC X(1).                        
000042    10 S006-CONFIRMATION-CONTROL PIC X(4).                        
000043    10 S006-FLAG-RESO            PIC X(1).                        
000044    10 S006-DATA-CRT             PIC X(6).                        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000045    10 S006-DATA-MOD             PIC X(6).                        
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000046    10 S006-PROFIT-CENTER        PIC X(20).                       
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
      *<<((file: FDSAP006))
000264                                                                  
000265*------------------------------- SAP_ORDACQ_ACCOUNT               
000266 01  FILLER                      PIC X(8)  VALUE 'FDSAP007'.      
000267*    EXEC SQL  INCLUDE FDSAP007   END-EXEC.                       
      *>>((file: FDSAP007))
000001******************************************************************
000002*COBOL DECLARATION FOR TABLE DBGTM.SAP_ORDACQ_ACCOUNT            *
000003******************************************************************
000004 01 DCLSAP-ORDACQ-ACCOUNT.                                        
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005    10 S007-ODA-CICS-ACCTABLE     PIC X(10).                      
000006    10 S007-CICS-PO-ITEM-ACCTABLE PIC X(3).                       
000007    10 S007-PO-ITEM               PIC X(5).                       
000008    10 S007-COMP-CODE             PIC X(4).                       
000009    10 S007-CDC                   PIC X(10).                      
000010    10 S007-CONTO-COGE            PIC X(10).                      
000011    10 S007-WBS                   PIC X(24).                      
000012    10 S007-DATA-CRT              PIC X(6).                       
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000013    10 S007-DATA-MOD              PIC X(6).                       
      *<<((file: FDSAP007))
000268                                                                  
000269*------------------------------- SAP_ORDACQ_EM                    
000270 01  FILLER                      PIC X(8)  VALUE 'FDSAP008'.      
000271*    EXEC SQL  INCLUDE FDSAP008   END-EXEC.                       
      *>>((file: FDSAP008))
000001******************************************************************
000002*COBOL DECLARATION FOR TABLE DBGTM.SAP-ORDACQ-EM                 *
000003******************************************************************
000004 01 DCLSAP-ORDACQ-EM.                                             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005    10 S008-ODA-CICS             PIC X(10).                       
000006    10 S008-PO-ITEM              PIC X(5).                        
000007    10 S008-CICS-PO-ITEM         PIC X(3).                        
000008    10 S008-COMP-CODE            PIC X(4).                        
000009    10 S008-RICE-CICS            PIC X(10).                       
000010    10 S008-POST-DATE            PIC X(10).                       
000011    10 S008-ARTICOLO             PIC X(40).                       
000012    10 S008-PLANT                PIC X(4).                        
000013    10 S008-STORAGE-LOC          PIC X(4).                        
000014    10 S008-QUANTITY             PIC S9(10)V9(3) USAGE COMP-3.    
000015    10 S008-BOLLA-CONS           PIC X(16).                       
000016    10 S008-DATA-BOLLA           PIC X(10).                       
000017    10 S008-CDC                  PIC X(10).                       
000018    10 S008-WBS                  PIC X(24).                       
000019    10 S008-CRT-EM               PIC X(1).                        
000020    10 S008-CRT-EM-ST            PIC X(2).                        
000021    10 S008-CRT-PROGR-NUM        PIC X(5).                        
000022    10 S008-TIPO-MOV             PIC X(3).                        
000023    10 S008-DATA-CRT             PIC X(6).                        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
      *<<((file: FDSAP008))
000272                                                                  
000273*------------------------------- FORNITORI_GENERAL                
000274 01  FILLER                      PIC X(8)  VALUE 'FDSAP009'.      
000275*    EXEC SQL  INCLUDE FDSAP009   END-EXEC.                       
      *>>((file: FDSAP009))
000001******************************************************************
000002*COBOL DECLARATION FOR TABLE MDHUB.SAP-FORNITORI-GENERAL         *
000003******************************************************************
000004 01 DCLSAP-FORNITORI-GENERAL.                                     
000005    10 S009-SEQ-MSG              PIC X(16).                       
000006    10 S009-COD-MSG              PIC X(10).                       
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000007    10 S009-VEND-CODE            PIC X(10).                       
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000008    10 S009-PARTNERGROUP         PIC X(4).                        
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000009    10 S009-SEARCHTERM1          PIC X(10).                       
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000010    10 S009-LEGAL-ENTY           PIC X(2).                        
000011    10 S009-GEST-CODE            PIC X(3).                        
000012    10 S009-NAME1                PIC X(35).                       
000013    10 S009-NAME2                PIC X(35).                       
000014    10 S009-NAME3                PIC X(35).                       
000015    10 S009-NAME4                PIC X(35).                       
000016    10 S009-CITY                 PIC X(35).                       
000017    10 S009-DISTRICT             PIC X(35).                       
000018    10 S009-NEGOZIO-SAP          PIC X(4).                        
000019    10 S009-NEGOZIO-CICS         PIC X(20).                       
000020    10 S009-POSTL-COD1           PIC X(10).                       
000021    10 S009-STREET               PIC X(35).                       
000022    10 S009-STR-SUPPL1           PIC X(40).                       
000023    10 S009-STR-SUPPL2           PIC X(40).                       
000024    10 S009-STR-SUPPL3           PIC X(40).                       
000025    10 S009-HOUSE-NO             PIC X(10).                       
000026    10 S009-HOUSE-NO2            PIC X(10).                       
000027    10 S009-BUILDING             PIC X(20).                       
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000028    10 S009-COUNTRYISO           PIC X(2).                        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000029    10 S009-REGION               PIC X(3).                        
000030    10 S009-LANGU                PIC X(21).                       
000031    10 S009-E-MAIL               PIC X(241).                      
000032    10 S009-E-MAIL1              PIC X(241).                      
000033    10 S009-E-MAIL2              PIC X(241).                      
000034    10 S009-E-MAIL3              PIC X(241).                      
000035    10 S009-E-MAIL4              PIC X(241).                      
000036    10 S009-PEC-COMM-NOTES       PIC X(50).                       
000037    10 S009-SPERR-G              PIC X(1).                        
000038    10 S009-KTOKK                PIC X(4).                        
000039    10 S009-STCD1                PIC X(16).                       
000040    10 S009-STCD2                PIC X(11).                       
000041    10 S009-STCEG                PIC X(20).                       
000042    10 S009-TELFX                PIC X(31).                       
000043    10 S009-TELF1                PIC X(16).                       
000044    10 S009-STCD4                PIC X(60).                       
000045    10 S009-SEXKZ                PIC X(1).                        
000046    10 S009-GBDAT                PIC X(8).                        
000047    10 S009-GBORT                PIC X(20).                       
000048    10 S009-ZZFATTEL             PIC X(1).                        
000049    10 S009-ZZPAESEPAG           PIC X(20).                       
000050    10 S009-ZZFIRR               PIC X(1).                        
000051    10 S009-ZZPORTDOC            PIC X(1).                        
000052    10 S009-ZZSTATQUAL           PIC X(20).                       
000053    10 S009-ZZDESTFE             PIC X(50).                       
000054    10 S009-ZZFORN-AMM           PIC X(1).                        
000055    10 S009-ZCOD-IND-CLI         PIC X(1).                        
000056    10 S009-ZDTINRAPO            PIC X(10).                       
000057    10 S009-ZDTFIRAPO            PIC X(10).                       
000058    10 S009-ZMATR-ENAS           PIC X(10).                       
000059    10 S009-ZZICE-CODE           PIC X(15).                       
000060    10 S009-DTA-ORIGINE          PIC X(10).                       
000061    10 S009-ORA-ORIGINE          PIC X(06).                       
000062    10 S009-TIMESTAMP            PIC X(26).                       
000063    10 S009-DTA-INS              PIC X(10).                       
000064    10 S009-ORA-INS              PIC X(06).                       
000065    10 S009-DEL-FLAG             PIC X(1).                        
000066    10 S009-DTA-CREAZIONE        PIC X(10).                       
000067    10 S009-UTENTE-CREAZIONE     PIC X(12).                       
000068    10 S009-ID-RIGA              PIC S9(04)V COMP-3.              
      *<<((file: FDSAP009))
000276                                                                  
000277*------------------------------- SAP-COMMESSE                     
000278 01  FILLER                      PIC X(8)  VALUE 'FDSAP011'.      
000279*    EXEC SQL  INCLUDE FDSAP011   END-EXEC.                       
      *>>((file: FDSAP011))
000001******************************************************************
000002*COBOL DECLARATION FOR TABLE MDHUB.SAP-COMMESSE                  *
000003******************************************************************
000004 01 DCLSAP-COMMESSE.                                              
000005    10 S011-NUM-PROGETTO         PIC X(16).                       
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006    10 S011-ELEMENTO-WBS         PIC X(48).                       
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007    10 S011-NUMERO-OGGETTO       PIC X(44).                       
000008    10 S011-DESCRIZIONE          PIC X(80).                       
000009    10 S011-IDENTIFICAZIONE      PIC X(32).                       
000010    10 S011-AUTORE               PIC X(24).                       
000011    10 S011-DTCREAZ              PIC X(10).                       
000012    10 S011-AUTORE-MODIFICA      PIC X(24).                       
000013    10 S011-DTMODIF              PIC X(10).                       
000014    10 S011-COD-RESPONSABILE     PIC X(16).                       
000015    10 S011-NOME-RESPONSABILE    PIC X(50).                       
000016    10 S011-APPLICANT-NUMBER     PIC X(16).                       
000017    10 S011-APPLICANT            PIC X(50).                       
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000018    10 S011-SOCI                 PIC X(8).                        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000019    10 S011-AREA-CONTROLLO       PIC X(8).                        
000020    10 S011-PROFIT-CENTER        PIC X(20).                       
000021    10 S011-TIPO-PROGETTO        PIC X(4).                        
000022    10 S011-LIVELLO              PIC X(6).                        
000023    10 S011-FLGCONT              PIC X(2).                        
000024    10 S011-FLGFATT              PIC X(2).                        
000025    10 S011-APPL                 PIC X(4).                        
000026    10 S011-AREA-RICHIEDENTE     PIC X(8).                        
000027    10 S011-CCOS-RICHIEDENTE     PIC X(20).                       
000028    10 S011-AREA-ESECUTORE       PIC X(8).                        
000029    10 S011-CCOS-ESECUTORE       PIC X(20).                       
000030    10 S011-PRIORITA             PIC X(2).                        
000031    10 S011-DVS-PROGETTO         PIC X(10).                       
000032    10 S011-PLANT                PIC X(8).                        
000033    10 S011-LINGUA               PIC X(2).                        
000034    10 S011-PAROLA-CHIAVE        PIC X(14).                       
000035    10 S011-NOTE                 PIC X(40).                       
000036    10 S011-NOTE1                PIC X(40).                       
000037    10 S011-NOTE2                PIC X(20).                       
000038    10 S011-NOTE3                PIC X(20).                       
000039    10 S011-NOTE4                PIC X(26).                       
000040    10 S011-NOTE5                PIC X(6).                        
000041    10 S011-NOTE6                PIC X(26).                       
000042    10 S011-NOTE7                PIC X(6).                        
000043    10 S011-NOTE8                PIC X(26).                       
000044    10 S011-NOTE9                PIC X(6).                        
000045    10 S011-NOTE10               PIC X(26).                       
000046    10 S011-NOTE11               PIC X(10).                       
000047    10 S011-NOTE12               PIC X(16).                       
000048    10 S011-NOTE13               PIC X(16).                       
000049    10 S011-NOTE14               PIC X(2).                        
000050    10 S011-NOTE15               PIC X(2).                        
000051    10 S011-CCOS-OPEX            PIC X(20).                       
000052    10 S011-OGGETTO-COSTO        PIC X(24).                       
000053    10 S011-INTERNAL-NUMBER      PIC X(16).                       
000054    10 S011-CLASSE               PIC X(4).                        
000055    10 S011-FLGSTATIST           PIC X(2).                        
000056    10 S011-SOTTOPROGETTO        PIC X(24).                       
000057    10 S011-FLGCANC              PIC X(2).                        
000058    10 S011-DTFINE               PIC X(10).                       
000059    10 S011-RAGIONE-INVEST       PIC X(4).                        
000060    10 S011-VALORE1              PIC X(20).                       
000061    10 S011-VALORE2              PIC X(20).                       
000062    10 S011-VALORE3              PIC X(20).                       
000063    10 S011-DVS-TRN              PIC X(10).                       
000064    10 S011-BUDGET-INIZIALE        PIC S9(13)V9(2) USAGE COMP-3.  
000065    10 S011-IMPEGNATO              PIC S9(13)V9(2) USAGE COMP-3.  
000066    10 S011-BUDGET-RIVISTO-PIU     PIC S9(13)V9(2) USAGE COMP-3.  
000067    10 S011-BUDGET-RIVISTO-MENO    PIC S9(13)V9(2) USAGE COMP-3.  
000068    10 S011-BUDGET-INIZIALE-LEDGER PIC S9(13)V9(2) USAGE COMP-3.  
000069    10 S011-IMPEGNATO-LEDGER       PIC S9(13)V9(2) USAGE COMP-3.  
000070    10 S011-BUDGET-LEDGER-RIVISTO  PIC S9(13)V9(2) USAGE COMP-3.  
000071    10 S011-BUDGET-LEDGER-RIVISTO  PIC S9(13)V9(2) USAGE COMP-3.  
      *<<((file: FDSAP011))
000280                                                                  
000281*------------------------------- SAP_PIANO_CONTI                  
000282 01  FILLER                      PIC X(8)  VALUE 'FDSAP012'.      
000283*    EXEC SQL  INCLUDE FDSAP012   END-EXEC.                       
      *>>((file: FDSAP012))
000001******************************************************************
000002*COBOL DECLARATION FOR TABLE MDHUB.SAP-PIANO-CONTI               *
000003******************************************************************
000004 01 DCLSAP-PIANO-CONTI.                                           
000005    10 S012-PIANO-CONT           PIC X(8).                        
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006    10 S012-SOCI                 PIC X(8).                        
000007    10 S012-CONTO-COGE           PIC X(20).                       
000008    10 S012-CDCE-GTM             PIC X(20).                       
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000009    10 S012-CONTO-BIL-PATR       PIC X(2).                        
000010    10 S012-NUM-CONTO-GRU        PIC X(20).                       
000011    10 S012-TIPO-CONTO-EC        PIC X(4).                        
000012    10 S012-GRUPPO-CONTI         PIC X(8).                        
000013    10 S012-CONTO-CAMPIONE       PIC X(20).                       
000014    10 S012-SOCI-PARTNER         PIC X(12).                       
000015    10 S012-FLG-CANC             PIC X(2).                        
000016    10 S012-FLG-BLOC-INS         PIC X(2).                        
000017    10 S012-FLG-BLOC-PIAN        PIC X(2).                        
000018    10 S012-FUN-AREA             PIC X(32).                       
000019    10 S012-TIPO-CONTO-COGE      PIC X(2).                        
000020    10 S012-TESTO-BREVE          PIC X(40).                       
000021    10 S012-TESTO-ESTESO         PIC X(100).                      
000022    10 S012-CRIT-RICERCA         PIC X(50).                       
000023    10 S012-AUTORIZ              PIC X(8).                        
000024    10 S012-SIGLA-ADDETTO        PIC X(4).                        
000025    10 S012-DTCREAZ              PIC X(10).                       
000026    10 S012-DTULT-CALC-INTER     PIC X(10).                       
000027    10 S012-CREATO-DA            PIC X(24).                       
000028    10 S012-GRP-CASH-MAN         PIC X(20).                       
000029    10 S012-LIV-CASH-MAN         PIC X(4).                        
000030    10 S012-PIANO-FIN            PIC X(6).                        
000031    10 S012-GR-STATO-CAMPO       PIC X(8).                        
000032    10 S012-BANCA-INTERNA        PIC X(10).                       
000033    10 S012-ID-CONTO             PIC X(10).                       
000034    10 S012-CHIAVE-DCM           PIC X(8).                        
000035    10 S012-CODICE-MASTRO        PIC X(2).                        
000036    10 S012-CATEG-IMPOSTE        PIC X(4).                        
000037    10 S012-TESTO-COGE           PIC X(80).                       
000038    10 S012-COD-INTERESSI        PIC X(4).                        
000039    10 S012-DVS-CONTO            PIC X(10).                       
000040    10 S012-CONTO-ESTERNO        PIC X(4).                        
000041    10 S012-MOV-MON-RIL          PIC X(2).                        
000042    10 S012-GESTIONE-PA          PIC X(2).                        
000043    10 S012-BLOCCO-REG           PIC X(2).                        
000044    10 S012-DTULT-SCAD           PIC X(10).                       
000045    10 S012-PERIOD-CALC-INT      PIC X(4).                        
000046    10 S012-CHIAVE-CLAS          PIC X(6).                        
000047    10 S012-CONTO-ALTERNAT       PIC X(20).                       
000048    10 S012-EL-MASTRO            PIC X(2).                        
000049    10 S012-TIPO-COSTO           PIC X(8).                        
000050    10 S012-POS-FINANZ           PIC X(28).                       
000051    10 S012-CD-IVA-NON-OBBLIG    PIC X(2).                        
000052    10 S012-SALDI-IN-DI          PIC X(2).                        
000053    10 S012-GRP-VALUT            PIC X(20).                       
000054    10 S012-CHIAVE-INFL          PIC X(16).                       
000055    10 S012-GRP-TOLLER           PIC X(8).                        
000056    10 S012-PAR-SPEC-GRPLDG      PIC X(2).                        
000057    10 S012-CHIAVE-MCA           PIC X(10).                       
000058    10 S012-DATI-CONR-AREA       PIC X(2).                        
      *<<((file: FDSAP012))
000284                                                                  
000285*------------------------------- SAP_MATGRP_CONTI                 
000286 01  FILLER                      PIC X(8)  VALUE 'FDSAP013'.      
000287*    EXEC SQL  INCLUDE FDSAP013   END-EXEC.                       
      *>>((file: FDSAP013))
000001******************************************************************
000002*COBOL DECLARATION FOR TABLE DBGTM.SAP_MATGRP_CONTI              *
000003******************************************************************
000004 01 DCLSAP-MATGRP-CONTI.                                          
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005    10 S013-CDCE-GTM             PIC X(6).                        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000006    10 S013-CDCE-SAP             PIC X(10).                       
000007    10 S013-MATGRP               PIC X(9).                        
000008    10 S013-MATGRP-DESC          PIC X(50).                       
000009    10 S013-MATGRP-DESC2         PIC X(100).                      
000010    10 S013-CDCE-CT              PIC X(6).                        
000011    10 S013-CDCE-DQ              PIC X(6).                        
000012    10 S013-CDCE-0L              PIC X(6).                        
000013    10 S013-CDCE-0J              PIC X(6).                        
      *<<((file: FDSAP013))
000288                                                                  
000289*    ORDINI DA RICEVERE:                                          
000290*    - ORDINI MATERIALE (SCORTE)                                  
000291*    - ORDINI MATERIE PRIME (SIFO)                                
000292*    - MEZZI DI STAMPA DA ASSOCIARE A FATTURA                     
000293*    -                 DISEGNI/BOZZETTI/CILINDRI                  
000294*                                                                 
000295*--> DAL 2025 PER PARTENZA DI OPLA X SUBLITEX                     
000296*    NON SI GESTISCONO PIU LE SOC. 24,ME,SX,0T                    
000297                                                                  
000298     
      *EXEC SQL DECLARE POINTER2 CURSOR FOR                         
000299*              SELECT 'RI' AS MERCEMAG, A.CODSOCIE                 
000300*                    ,A.CODFORNI                                   
000301*                    ,A.AANUMORD, B.NRRIGORD                       
000302*                    ,A.DTCARORD, A.CODDIVIS                       
000303*                    ,A.CENCOSTO, A.NRCOMMES                       
000304*                    ,A.CONTODCE, A.DESCORDI                       
000305*                    ,A.PERCSCON                                   
000306*                    ,B.CODARTSC, ' ' AS CODARTIC                  
000307*                    ,B.DATACONS, B.QTAORDIN                       
000308*                    ,B.QTARICEV, B.IMPRICEV                       
000309*                    ,B.PREZZORD, B.PERCSCO1                       
000310*                    ,B.PERCSCO2, B.PERCSCO3                       
000311*                    ,A.PERSCOIM, A.IMPSCONT                       
000312*                    ,B.UNMISURA, C.DESARTSC                       
000313*                    ,A.AANUMRIC, A.CDDIVISI                       
000314*                    ,A.DEPDESTI, A.CATEARTI                       
000315*                    ,A.CDEVARIC, A.TARGVETT                       
000316*                    ,A.CODUTENT, A.NUMAUTOR                       
000317*                    ,'  '        AS CDDIRDIV                      
000318*                    ,' '         AS CODCLIEN                      
000319*                    ,' '         AS TIPSTALL                      
000320*                    ,' '         AS CODLINEA                      
000321*                    ,A.DTCREAZI  AS DTCREAZT                      
000322*                    ,A.DTULTVAR  AS DTULTVAT                      
000323*                    ,A.DTANNULL  AS DTANNULT                      
000324*                    ,A.DATASALD  AS DATASALT                      
000325*                    ,B.DTCREAZI  AS DTCREAZI                      
000326*                    ,B.DTULTVAR  AS DTULTVAR                      
000327*                    ,B.DTANNULL  AS DTANNULL                      
000328*                    ,B.DATASALD  AS DATASALD                      
000329*                    ,COALESCE(M.QTAMOVIM , 0) AS QTAMOVIM         
000330*                    ,COALESCE(M.PREZZMER , 0) AS PREZZMER         
000331*                    ,A.CODIRESA                                   
000332*                FROM DSCORTE.TORDISCORN     A                     
000333*                    ,DSCORTE.TRIGORDISCORN  B                     
000334*           LEFT JOIN (SELECT AANUMORD, NRRIGORD                   
000335*                            ,SUM(QTAMOVIM) AS QTAMOVIM            
000336*                            ,SUM(PREZZMER) AS PREZZMER            
000337*                        FROM DSCORTE.TMOVISCOR                    
000338*                       WHERE CAUSAMOV = '02'                      
000339*                         AND DTCREAZI < '20200101'                
000340*                      GROUP BY AANUMORD, NRRIGORD                 
000341*                      ) AS M                                      
000342*                  ON B.AANUMORD = M.AANUMORD                      
000343*                 AND B.NRRIGORD = M.NRRIGORD                      
000344*                    ,DSCORTE.TDETTORDISCORN C                     
000345*               WHERE A.AANUMORD = B.AANUMORD                      
000346*                 AND NOT A.CODSOCIE IN ('24','ME','SX','0T')      
000347*                 AND A.CONTODCE > ' '                             
000348*                 AND B.PREZZORD > 0                               
000349*                 AND NOT (SUBSTR(B.CODARTSC, 1, 5)='CLAUS'        
000350*                          AND B.PREZZORD < 1)                     
000351*                 AND NOT (EXISTS                                  
000352*                         (SELECT X.CODARTS1                       
000353*                            FROM DANAGRAF.VANAGRAF_B44 X          
000354*                           WHERE B.CODARTSC = X.CODARTS1)         
000355*                          AND B.PREZZORD < 1)                     
000356*                 AND (B.DTANNULL = ' ' OR                         
000357*                     (B.DTANNULL > '20200101' AND                 
000358*                      B.DTANNULL > B.DTCREAZI))                   
000359*******           AND (B.DATASALD = ' ' OR                         
000360*******                B.DATASALD > '20200101')                    
000361*                 AND C.AANUMORD = B.AANUMORD                      
000362*                 AND C.NRRIGORD = B.NRRIGORD                      
000363*                 AND C.NUMPROG3 =                                 
000364*                      (SELECT MIN(D.NUMPROG3)                     
000365*                         FROM DSCORTE.TDETTORDISCORN D            
000366*                        WHERE D.AANUMORD = B.AANUMORD             
000367*                          AND D.NRRIGORD = B.NRRIGORD)            
000368*                 AND     EXISTS                                   
000369*                     (SELECT S.CODSOCIE                           
000370*                        FROM DANAGRAF.TSOCIETA S                  
000371*                       WHERE A.CODSOCIE = S.CODSOCIE              
000372*                         AND S.FLCONTAB = 'S'                     
000373*                         AND S.FLSOCSAP = 'S')                    
000374*                 AND NOT EXISTS (SELECT E.CODSOCIE                
000375*                                   FROM DANAGRAF.TSOCIETA E       
000376*                                  WHERE E.CODFORNI = A.CODFORNI   
000377*                                    AND E.FLCONTAB = 'S')         
000378*                 AND EXISTS                                       
000379*                    (SELECT T.AANUMORD                            
000380*                       FROM DSCORTE.TORDISCORN    T               
000381*                           ,DSCORTE.TRIGORDISCORN R               
000382*                      WHERE T.AANUMORD = R.AANUMORD               
000383*                        AND A.AANUMORD = T.AANUMORD               
000384*                        AND (T.DTCREAZI > :WS-DATAELAB OR         
000385*                             T.DTULTVAR > :WS-DATAELAB OR         
000386*                             R.DTCREAZI > :WS-DATAELAB OR         
000387*                             R.DTULTVAR > :WS-DATAELAB OR         
000388*******                       R.DATASALD > :WS-DATAELAB OR         
000389*                             R.DTANNULL > :WS-DATAELAB)           
000390*                        AND NOT (SUBSTR(R.CODARTSC, 1, 5)='CLAUS' 
000391*                                 AND R.PREZZORD < 1)              
000392*                        AND NOT (EXISTS                           
000393*                                (SELECT Y.CODARTS1                
000394*                                   FROM DANAGRAF.VANAGRAF_B44 Y   
000395*                                  WHERE R.CODARTSC = Y.CODARTS1)  
000396*                                    AND R.PREZZORD < 1))          
000397*             UNION ALL                                            
000398*              SELECT T.MERCEMAG, T.CODSOCIE                       
000399*                    ,T.FORNFATT AS CODFORNI                       
000400*                    ,T.AANUMORD, R.NRRIGORD                       
000401*                    ,T.DTCARORD, T.CODDIVIS                       
000402*                    ,T.CENCOSTO, ' ' AS NRCOMMES                  
000403*                    ,T.CONTODCE, ' ' AS DESCORDI                  
000404*                    ,T.PERCSCON                                   
000405*                    ,' ' AS CODARTSC, R.CODARTIC                  
000406*                    ,R.DATACONS                                   
000407*                    , DEC(R.QTAORDIN, 9, 2) AS QTAORDIN           
000408*                    ,R.QTARICEV, 0  AS IMPRICEV                   
000409*                    ,(R.PREZZOR4 + R.SUPPREPR) AS PREZZORD        
000410*                    , 0  AS PERCSCO1                              
000411*                    , 0  AS PERCSCO2, 0  AS PERCSCO3              
000412*                    , 0  AS PERSCOIM, 0  AS IMPSCONT              
000413*                    ,T.UNMISURA, ' ' AS DESARTSC                  
000414*                    ,' ' AS AANUMRIC, 'T' AS CDDIVISI             
000415*                    ,' ' AS DEPDESTI, ' ' AS CATEARTI             
000416*                    ,' ' AS CDEVARIC, ' ' AS TARGVETT             
000417*                    ,T.CODUTVAR AS CODUTENT                       
000418*                    ,' '         AS NUMAUTOR                      
000419*                    ,'  '        AS CDDIRDIV                      
000420*                    ,' '         AS CODCLIEN                      
000421*                    ,' '         AS TIPSTALL                      
000422*                    ,' '         AS CODLINEA                      
000423*                    ,T.DTCREAZI  AS DTCREAZT                      
000424*                    ,T.DTULTVAR  AS DTULTVAT                      
000425*                    ,T.DTANNULL  AS DTANNULT                      
000426*                    ,T.DATASALD  AS DATASALT                      
000427*                    ,R.DTCREAZI  AS DTCREAZI                      
000428*                    ,R.DTULTVAR  AS DTULTVAR                      
000429*                    ,R.DTANNULL  AS DTANNULL                      
000430*                    ,R.DATASALD  AS DATASALD                      
000431*                    ,COALESCE(M.QTAMOVIM , 0) AS QTAMOVIM         
000432*                    ,COALESCE(M.PREZZMER , 0) AS PREZZMER         
000433*                    ,T.CODIRESA                                   
000434*                FROM DSIFO.TORDISIFO    T                         
000435*                    ,DSIFO.TRIGORDISIFO R                         
000436*           LEFT JOIN (SELECT AANUMORD, NRRIGORD                   
000437*                            ,SUM(QTARICEV) AS QTAMOVIM            
000438*                            , 0            AS PREZZMER            
000439*                        FROM DSIFO.TRICESIFO                      
000440*                       WHERE DATARICE < '20200101'                
000441*                      GROUP BY AANUMORD, NRRIGORD                 
000442*                      ) AS M                                      
000443*                  ON R.AANUMORD = M.AANUMORD                      
000444*                 AND R.NRRIGORD = M.NRRIGORD                      
000445*               WHERE     T.AANUMORD = R.AANUMORD                  
000446*                 AND NOT T.CODSOCIE IN ('24','ME','SX','0T')      
000447*                 AND     T.ACQUILAV = 'A'                         
000448*                 AND     T.FLAGOPZI = 'F'                         
000449*                 AND NOT T.FLGRATIS = 'S'                         
000450*                 AND NOT T.FLAGSOSP = 'S'                         
000451*                 AND (R.DTANNULL = ' ' OR                         
000452*                     (R.DTANNULL > '20200101' AND                 
000453*                      R.DTANNULL > R.DTCREAZI))                   
000454*******           AND (R.DATASALD = ' ' OR                         
000455*******                R.DATASALD > '20200101')                    
000456*                 AND     EXISTS                                   
000457*                     (SELECT S.CODSOCIE                           
000458*                        FROM DANAGRAF.TSOCIETA S                  
000459*                       WHERE T.CODSOCIE = S.CODSOCIE              
000460*                         AND S.FLCONTAB = 'S'                     
000461*                         AND S.FLSOCSAP = 'S')                    
000462*                 AND NOT EXISTS                                   
000463*                     (SELECT S.CODSOCIE                           
000464*                        FROM DANAGRAF.TSOCIETA S                  
000465*                       WHERE T.FORNFATT = S.CODFORNI)             
000466*                 AND EXISTS                                       
000467*                    (SELECT T1.AANUMORD                           
000468*                       FROM DSIFO.TORDISIFO    T1                 
000469*                           ,DSIFO.TRIGORDISIFO R1                 
000470*                      WHERE T.AANUMORD = T1.AANUMORD              
000471*                        AND T1.AANUMORD = R1.AANUMORD             
000472*                        AND (T1.DTCREAZI > :WS-DATAELAB OR        
000473*                             T1.DTULTVAR > :WS-DATAELAB OR        
000474*                             R1.DTCREAZI > :WS-DATAELAB OR        
000475*                             R1.DTULTVAR > :WS-DATAELAB OR        
000476*******                       R1.DATASALD > :WS-DATAELAB OR        
000477*                             R1.DTANNULL > :WS-DATAELAB))         
000478*             UNION ALL                                            
000479*              SELECT 'C '       AS MERCEMAG                       
000480*                    ,A.SOCIEMER AS CODSOCIE                       
000481*                    ,A.CODFORNI                                   
000482*                    ,'MS'||RIGHT(A.NRCOSMES, 6) AS AANUMORD       
000483*                    , 1         AS NRRIGORD                       
000484*                    ,A.DTRIPEFF AS DTCARORD                       
000485*                    ,CASE WHEN COSTMEST = 0                       
000486*                          THEN '75'                               
000487*                          ELSE CODDIVIS                           
000488*                      END       AS CODDIVIS                       
000489*                    ,A.CENCOSTO                                   
000490*                    , ' '       AS NRCOMMES                       
000491*                    ,CASE WHEN A.CONTODCE > ' '                   
000492*                          THEN A.CONTODCE                         
000493*                          ELSE 'INCLUC'                           
000494*                      END       AS CONTODCE                       
000495*                    ,'CILINDRI' AS DESCORDI                       
000496*                    ,  0        AS PERCSCON                       
000497*                    ,'C'||A.CODDISFI||A.SERIECIL||A.NUMCILIN      
000498*                                                 AS CODARTSC      
000499*                    , ' '       AS CODARTIC                       
000500*                    ,A.DTRIPEFF AS DATACONS                       
000501*                    ,CASE WHEN COSTMEST = 0                       
000502*                          THEN A.NRCILLAV                         
000503*                          ELSE 1                                  
000504*                      END AS QTAORDIN                             
000505*                    , 0         AS QTARICEV                       
000506*                    , 0         AS IMPRICEV                       
000507*                    ,CASE WHEN COSTMEST = 0                       
000508*                          THEN CASE WHEN A.SLLAVMES = '01'        
000509*                               THEN 90                            
000510*                               WHEN A.SLLAVMES = '02'             
000511*                               THEN 260                           
000512*                               WHEN A.SLLAVMES = '91'             
000513*                               THEN 180                           
000514*                               ELSE 110                           
000515*                                END                               
000516*                          ELSE COSTMEST                           
000517*                      END       AS PREZZORD                       
000518*                    , 0         AS PERCSCO1                       
000519*                    , 0         AS PERCSCO2                       
000520*                    , 0         AS PERCSCO3                       
000521*                    , 0         AS PERSCOIM                       
000522*                    , 0         AS IMPSCONT                       
000523*                    ,'N.'       AS UNMISURA                       
000524*                    ,'CILINDRI' AS DESARTSC                       
000525*                    ,' '        AS AANUMRIC                       
000526*                    , 'T'       AS CDDIVISI                       
000527*                    ,' '        AS DEPDESTI                       
000528*                    , ' '       AS CATEARTI                       
000529*                    ,' '        AS CDEVARIC                       
000530*                    , ' '       AS TARGVETT                       
000531*                    ,A.CODUTVAR AS CODUTENT                       
000532*                    ,' '        AS NUMAUTOR                       
000533*                    ,P.CDDIRDIV                                   
000534*                    ,D.CODCLIEN  AS CODCLIEN                      
000535*                    ,SC.TIPSTALL AS TIPSTALL                      
000536*                    ,SC.CODLINEA AS CODLINEA                      
000537*                    ,A.DTCREAZI  AS DTCREAZT                      
000538*                    ,A.DTULTVAR  AS DTULTVAT                      
000539*                    ,' '         AS DTANNULT                      
000540*                    ,A.DATAESTR  AS DATASALT                      
000541*                    ,' '         AS DTCREAZI                      
000542*                    ,' '         AS DTULTVAR                      
000543*                    ,' '         AS DTANNULL                      
000544*                    ,' '         AS DATASALD                      
000545*                    , 0  AS QTAMOVIM                              
000546*                    , 0  AS PREZZMER                              
000547*                    ,' ' AS CODIRESA                              
000548*               FROM DMEST.TCOSTIMEST   A                          
000549*                   ,DMEST.TDISEGNI     D                          
000550*                   ,DANAGRAF.TLINEAVEN C                          
000551*                   ,DANAGRAF.TPROLOMER P                          
000552*                   ,DMEST.TSERIEDIS    SC                         
000553*              WHERE A.DTRIPEFF > '20140000'                       
000554*                AND NOT A.SOCIEMER IN ('24','ME','SX','0T')       
000555*                AND A.CODFORNI > '00200'                          
000556*                AND A.SERIECIL > ' '                              
000557*                AND (A.DATAESTR = ' '         OR                  
000558*                     A.DATAESTR > '20200101')                     
000559*                AND (A.DATAESTR > :WS-DATAELAB OR                 
000560*                     A.DTCREAZI > :WS-DATAELAB OR                 
000561*                     A.DTULTVAR > :WS-DATAELAB   )                
000562*                AND A.CODDISFI = D.CODDISFI                       
000563*                AND D.CODLINEA = C.CODLINEA                       
000564*                AND C.PROLOMER = P.PROLOMER                       
000565*                AND A.CODDISFI = SC.CODDISFI                      
000566*                AND A.SERIECIL = SC.SERIECIL                      
000567*                AND EXISTS                                        
000568*                   (SELECT S.CODSOCIE                             
000569*                      FROM DANAGRAF.TSOCIETA S                    
000570*                     WHERE A.SOCIEMER = S.CODSOCIE                
000571*                       AND S.FLCONTAB = 'S'                       
000572*                       AND S.FLSOCSAP = 'S')                      
000573*                AND NOT EXISTS                                    
000574*                   (SELECT S.CODSOCIE                             
000575*                      FROM DANAGRAF.TSOCIETA S                    
000576*                     WHERE A.CODFORNI = S.CODFORNI)               
000577*            UNION ALL                                             
000578*              SELECT 'B '       AS MERCEMAG                       
000579*                    ,A.SOCIEMER AS CODSOCIE                       
000580*                    ,A.CODFORNI                                   
000581*                    ,'MS'||RIGHT(A.NRCOSMES, 6) AS AANUMORD       
000582*                    , 1  AS NRRIGORD                              
000583*                    ,A.DTRIPEFF AS DTCARORD                       
000584*                    ,CASE WHEN COSTMEST = 0                       
000585*                          THEN '75'                               
000586*                          ELSE CODDIVIS                           
000587*                      END       AS CODDIVIS                       
000588*                    ,A.CENCOSTO                                   
000589*                    , ' '       AS NRCOMMES                       
000590*                    ,CASE WHEN A.CONTODCE > ' '                   
000591*                          THEN A.CONTODCE                         
000592*                          ELSE 'ACQDIS'                           
000593*                      END       AS CONTODCE                       
000594*                    ,'BOZZETTI' AS DESCORDI                       
000595*                    ,  0        AS PERCSCON                       
000596*                    ,'B'||RIGHT(A.NUMEBOZT,7) AS CODARTSC         
000597*                    , ' '       AS CODARTIC                       
000598*                    ,A.DTRIPEFF AS DATACONS                       
000599*                    ,CASE WHEN COSTMEST = 0                       
000600*                          THEN A.NRCILLAV                         
000601*                          ELSE 1                                  
000602*                      END AS QTAORDIN                             
000603*                    , 0         AS QTARICEV                       
000604*                    , 0         AS IMPRICEV                       
000605*                    ,CASE WHEN COSTMEST = 0                       
000606*                          THEN 300                                
000607*                          ELSE COSTMEST                           
000608*                      END PREZZORD                                
000609*                    , 0         AS PERCSCO1                       
000610*                    , 0         AS PERCSCO2                       
000611*                    , 0         AS PERCSCO3                       
000612*                    , 0         AS PERSCOIM                       
000613*                    , 0         AS IMPSCONT                       
000614*                    ,'N.'       AS UNMISURA                       
000615*                    ,'BOZZETTI' AS DESARTSC                       
000616*                    ,' '        AS AANUMRIC                       
000617*                    , 'T'       AS CDDIVISI                       
000618*                    ,' '        AS DEPDESTI                       
000619*                    , ' '       AS CATEARTI                       
000620*                    ,' '        AS CDEVARIC                       
000621*                    , ' '       AS TARGVETT                       
000622*                    ,A.CODUTVAR AS CODUTENT                       
000623*                    ,' '        AS NUMAUTOR                       
000624*                    ,P.CDDIRDIV                                   
000625*                    ,' '         AS CODCLIEN                      
000626*                    ,B.TIPSTALL  AS TIPSTALL                      
000627*                    ,B.CODLINEA  AS CODLINEA                      
000628*                    ,A.DTCREAZI  AS DTCREAZT                      
000629*                    ,A.DTULTVAR  AS DTULTVAT                      
000630*                    ,' '         AS DTANNULT                      
000631*                    ,A.DATAESTR  AS DATASALT                      
000632*                    ,' '         AS DTCREAZI                      
000633*                    ,' '         AS DTULTVAR                      
000634*                    ,' '         AS DTANNULL                      
000635*                    ,' '         AS DATASALD                      
000636*                    , 0  AS QTAMOVIM                              
000637*                    , 0  AS PREZZMER                              
000638*                    ,' ' AS CODIRESA                              
000639*               FROM DMEST.TCOSTIMEST A                            
000640*                   ,DMEST.TBOZZETTI  B                            
000641*                   ,DANAGRAF.TLINEAVEN C                          
000642*                   ,DANAGRAF.TPROLOMER P                          
000643*              WHERE A.DTRIPEFF > '20140000'                       
000644*                AND NOT A.SOCIEMER IN ('24','ME','SX','0T')       
000645*                AND A.CODFORNI > '00200'                          
000646*                AND A.NUMEBOZT > ' '                              
000647*                AND A.CODDISFI = ' '                              
000648*                AND (A.DATAESTR = ' '         OR                  
000649*                     A.DATAESTR > '20200101')                     
000650*                AND (A.DATAESTR > :WS-DATAELAB OR                 
000651*                     A.DTCREAZI > :WS-DATAELAB OR                 
000652*                     A.DTULTVAR > :WS-DATAELAB   )                
000653*                AND A.NUMEBOZT = B.NUMEBOZT                       
000654*                AND B.CODLINEA = C.CODLINEA                       
000655*                AND C.PROLOMER = P.PROLOMER                       
000656*                AND EXISTS                                        
000657*                       (SELECT S.CODSOCIE                         
000658*                          FROM DANAGRAF.TSOCIETA S                
000659*                         WHERE A.SOCIEMER = S.CODSOCIE            
000660*                           AND S.FLCONTAB = 'S'                   
000661*                           AND S.FLSOCSAP = 'S')                  
000662*                 AND NOT EXISTS                                   
000663*                       (SELECT S.CODSOCIE                         
000664*                          FROM DANAGRAF.TSOCIETA S                
000665*                         WHERE A.CODFORNI = S.CODFORNI)           
000666*             UNION ALL                                            
000667*              SELECT 'D '       AS MERCEMAG                       
000668*                    ,A.SOCIEMER AS CODSOCIE                       
000669*                    ,A.CODFORNI                                   
000670*                    ,'MS'||RIGHT(A.NRCOSMES, 6) AS AANUMORD       
000671*                    , 1  AS NRRIGORD                              
000672*                    ,A.DTRIPEFF AS DTCARORD                       
000673*                    ,CASE WHEN COSTMEST = 0                       
000674*                          THEN '75'                               
000675*                          ELSE CODDIVIS                           
000676*                      END AS CODDIVIS                             
000677*                    ,A.CENCOSTO                                   
000678*                    , ' '       AS NRCOMMES                       
000679*                    ,CASE WHEN A.CONTODCE > ' '                   
000680*                          THEN A.CONTODCE                         
000681*                          ELSE 'INCLUC'                           
000682*                      END       AS CONTODCE                       
000683*                    ,'DISEGNI'  AS DESCORDI                       
000684*                    ,  0        AS PERCSCON                       
000685*                    ,'D'||A.CODDISFI||'00' AS CODARTSC            
000686*                    , ' '       AS CODARTIC                       
000687*                    ,A.DTRIPEFF AS DATACONS                       
000688*                    ,CASE WHEN COSTMEST = 0                       
000689*                          THEN A.NRCILLAV                         
000690*                          ELSE 1                                  
000691*                      END AS QTAORDIN                             
000692*                    , 0         AS QTARICEV                       
000693*                    , 0         AS IMPRICEV                       
000694*                    ,CASE WHEN COSTMEST = 0                       
000695*                          THEN CASE WHEN A.SLLAVMES = 'XD'        
000696*                               THEN 100                           
000697*                               ELSE 40                            
000698*                                END                               
000699*                           ELSE COSTMEST                          
000700*                      END       AS PREZZORD                       
000701*                    , 0         AS PERCSCO1                       
000702*                    , 0         AS PERCSCO2                       
000703*                    , 0         AS PERCSCO3                       
000704*                    , 0         AS PERSCOIM                       
000705*                    , 0         AS IMPSCONT                       
000706*                    ,'N.'       AS UNMISURA                       
000707*                    ,'DISEGNI'  AS DESARTSC                       
000708*                    ,' '        AS AANUMRIC                       
000709*                    , 'T'       AS CDDIVISI                       
000710*                    ,' '        AS DEPDESTI                       
000711*                    , ' '       AS CATEARTI                       
000712*                    ,' '        AS CDEVARIC                       
000713*                    , ' '       AS TARGVETT                       
000714*                    ,A.CODUTVAR AS CODUTENT                       
000715*                    ,' '        AS NUMAUTOR                       
000716*                    ,P.CDDIRDIV                                   
000717*                    ,B.CODCLIEN  AS CODCLIEN                      
000718*                    ,B.TIPSTALL  AS TIPSTALL                      
000719*                    ,B.CODLINEA  AS CODLINEA                      
000720*                    ,A.DTCREAZI  AS DTCREAZT                      
000721*                    ,A.DTULTVAR  AS DTULTVAT                      
000722*                    ,' '         AS DTANNULT                      
000723*                    ,A.DATAESTR  AS DATASALT                      
000724*                    ,' '         AS DTCREAZI                      
000725*                    ,' '         AS DTULTVAR                      
000726*                    ,' '         AS DTANNULL                      
000727*                    ,' '         AS DATASALD                      
000728*                    , 0  AS QTAMOVIM                              
000729*                    , 0  AS PREZZMER                              
000730*                    ,' ' AS CODIRESA                              
000731*               FROM DMEST.TCOSTIMEST A                            
000732*                   ,DMEST.TDISEGNI  B                             
000733*                   ,DANAGRAF.TLINEAVEN C                          
000734*                   ,DANAGRAF.TPROLOMER P                          
000735*              WHERE A.NUMEBOZT = ' '                              
000736*                AND A.SERIECIL = ' '                              
000737*                AND NOT A.SOCIEMER IN ('24','ME','SX','0T')       
000738*                AND A.DTRIPEFF > '20140000'                       
000739*                AND A.CODFORNI > '00200'                          
000740*                AND A.NRCILLAV > 0                                
000741*                AND (A.DATAESTR = ' '         OR                  
000742*                     A.DATAESTR > '20200101')                     
000743*                AND (A.DATAESTR > :WS-DATAELAB OR                 
000744*                     A.DTCREAZI > :WS-DATAELAB OR                 
000745*                     A.DTULTVAR > :WS-DATAELAB   )                
000746*                AND A.CODDISFI = B.CODDISFI                       
000747*                AND B.CODLINEA = C.CODLINEA                       
000748*                AND C.PROLOMER = P.PROLOMER                       
000749*                AND EXISTS                                        
000750*                       (SELECT S.CODSOCIE                         
000751*                          FROM DANAGRAF.TSOCIETA S                
000752*                         WHERE A.SOCIEMER = S.CODSOCIE            
000753*                           AND S.FLCONTAB = 'S'                   
000754*                           AND S.FLSOCSAP = 'S')                  
000755*                 AND NOT EXISTS                                   
000756*                       (SELECT S.CODSOCIE                         
000757*                          FROM DANAGRAF.TSOCIETA S                
000758*                         WHERE A.CODFORNI = S.CODFORNI)           
000759*             UNION ALL                                            
000760*              SELECT 'TT'       AS MERCEMAG                       
000761*                    ,A.SOCIEMER AS CODSOCIE                       
000762*                    ,A.CODFORNI                                   
000763*                    ,'A'||RIGHT(A.AANUMORD, 7) AS AANUMORD        
000764*                    , ROW_NUMBER() OVER(PARTITION BY A.AANUMORD)  
000765*                                                AS NRRIGORD       
000766*                    ,A.DTORDCAM AS DTCARORD                       
000767*                    ,A.DIVIFORN AS CODDIVIS                       
000768*                    ,' '        AS CENCOSTO                       
000769*                    , ' '       AS NRCOMMES                       
000770*                    ,'LAVSTA'   AS CONTODCE                       
000771*                    ,'ALCA   '  AS DESCORDI                       
000772*                    ,  0        AS PERCSCON                       
000773*                    , ' '       AS CODARTSC                       
000774*                    ,A.CODARTFI AS CODARTIC                       
000775*                    ,A.CONPRCAM AS DATACONS                       
000776*                    ,CASE WHEN B.QTARICEV > 0                     
000777*                          THEN B.QTARICEV                         
000778*                          ELSE B.MTTAGORD                         
000779*                      END       AS QTAORDIN                       
000780*                    ,B.QTARICEV AS QTARICEV                       
000781*                    , 0         AS IMPRICEV                       
000782*                    ,A.PREZFORN AS PREZZORD                       
000783*                    , 0         AS PERCSCO1                       
000784*                    , 0         AS PERCSCO2                       
000785*                    , 0         AS PERCSCO3                       
000786*                    , 0         AS PERSCOIM                       
000787*                    , 0         AS IMPSCONT                       
000788*                    ,'MT'       AS UNMISURA                       
000789*                    ,' '        AS DESARTSC                       
000790*                    ,' '        AS AANUMRIC                       
000791*                    , 'T'       AS CDDIVISI                       
000792*                    ,' '        AS DEPDESTI                       
000793*                    , ' '       AS CATEARTI                       
000794*                    ,' '        AS CDEVARIC                       
000795*                    , ' '       AS TARGVETT                       
000796*                    ,A.UTCAMPIO AS CODUTENT                       
000797*                    ,' '        AS NUMAUTOR                       
000798*                    ,'  '       AS CDDIRDIV                       
000799*                    ,A.CLIECAMP AS CODCLIEN                       
000800*                    ,A.TIPSTALL AS TIPSTALL                       
000801*                    ,D.CODLINEA AS CODLINEA                       
000802*                    ,A.DTORDCAM  AS DTCREAZT                      
000803*                    ,A.DTULTVAR  AS DTULTVAT                      
000804*                    ,A.DTANNCAM  AS DTANNULT                      
000805*                    ,A.CONEFCAM  AS DATASALT                      
000806*                    ,B.DTCREAZI  AS DTCREAZI                      
000807*                    ,B.DTULTVAR  AS DTULTVAR                      
000808*                    ,B.DTANNULL  AS DTANNULL                      
000809*                    ,' '         AS DATASALD                      
000810*                    , 0  AS QTAMOVIM                              
000811*                    , 0  AS PREZZMER                              
000812*                    ,' ' AS CODIRESA                              
000813*               FROM DALLEST.TORDICAMPIO A                         
000814*                   ,DALLEST.TRIGORDCAMPIO B                       
000815*                   ,DANAGRAF.TARTICOLI  D                         
000816*                   ,DANAGRAF.TLINEAVEN C                          
000817*                   ,DANAGRAF.TPROLOMER P                          
000818*              WHERE A.AANUMORD = B.AANUMORD                       
000819*                AND NOT A.SOCIEMER IN ('24','ME','SX','0T')       
000820*                AND A.CODREPAR = 'X'                              
000821*                AND A.PREZFORN > 0                                
000822*                AND B.QTARICEV > 0                                
000823*                AND A.CODFORNI > ' '                              
000824*                AND (A.CONEFCAM = ' '         OR                  
000825*                     A.CONEFCAM > '20200101')                     
000826*                AND (A.DTANNCAM = ' '         OR                  
000827*                     A.DTANNCAM > '20200101')                     
000828*                AND (B.DTANNULL = ' '         OR                  
000829*                    (B.DTANNULL > '20200101' AND                  
000830*                     B.DTANNULL > B.DTCREAZI))                    
000831*                AND A.CODARTFI = D.CODARTFI                       
000832*                AND D.CODLINEA = C.CODLINEA                       
000833*                AND C.PROLOMER = P.PROLOMER                       
000834*                AND EXISTS                                        
000835*                       (SELECT S.CODSOCIE                         
000836*                          FROM DANAGRAF.TSOCIETA S                
000837*                         WHERE A.SOCIEMER = S.CODSOCIE            
000838*                           AND S.FLCONTAB = 'S'                   
000839*                           AND S.FLSOCSAP = 'S')                  
000840*                 AND NOT EXISTS                                   
000841*                       (SELECT S.CODSOCIE                         
000842*                          FROM DANAGRAF.TSOCIETA S                
000843*                         WHERE A.CODFORNI = S.CODFORNI)           
000844*                 AND EXISTS                                       
000845*                    (SELECT T.AANUMORD                            
000846*                       FROM DALLEST.TORDICAMPIO   T               
000847*                           ,DALLEST.TRIGORDCAMPIO R               
000848*                      WHERE A.AANUMORD = T.AANUMORD               
000849*                        AND T.AANUMORD = R.AANUMORD               
000850*                        AND (T.DTORDCAM > :WS-DATAELAB OR         
000851*                             T.DTULTVAR > :WS-DATAELAB OR         
000852*                             T.DTANNCAM > :WS-DATAELAB OR         
000853*                             T.CONEFCAM > :WS-DATAELAB OR         
000854*                             R.DTCREAZI > :WS-DATAELAB OR         
000855*                             R.DTULTVAR > :WS-DATAELAB OR         
000856*                             R.DTANNULL > :WS-DATAELAB ))         
000857**** ORDER MERCEMAG,CODSOCIE,CODFORNI,AANUMORD,NRRIGORD            
000858*           ORDER BY 1, 2, 3, 4, 5                                 
000859*     END-EXEC
                                                                        
000860                                                                  
000863*    EXEC SQL                                                     
      *        INCLUDE SQLCA                                            
      *    END-EXEC.                                                    
      *>>((file: SQLCA))
000001****************************************************************<*
000002* Copyright (c) 2016-2023 NTT DATA, Inc. All rights reserved.  *<*
000003* Users of NTT DATA Enterprise COBOL may freely                *<*
000004* redistribute this copybook.                                  *<*
000005****************************************************************<*
000006                                                                  
000007 01  SQLCA GLOBAL.                                                
000008     05  SQLCAID                PIC X(8).                         
000009     05  SQLCABC                PIC S9(9) COMP-5.                 
000010     05  SQLCODE                PIC S9(9) COMP-5.                 
000011     05  SQLERRM.                                                 
000012         49  SQLERRML           PIC S9(4) COMP-5.                 
000013         49  SQLERRMC           PIC X(254).                       
000014     05  SQLERRP                PIC X(8).                         
000015     05  SQLERRD OCCURS 6 TIMES PIC S9(9) COMP-5.                 
000016     05  SQLWARN.                                                 
000017         10 SQLWARN0            PIC X(1).                         
000018         10 SQLWARN1            PIC X(1).                         
000019         10 SQLWARN2            PIC X(1).                         
000020         10 SQLWARN3            PIC X(1).                         
000021         10 SQLWARN4            PIC X(1).                         
000022         10 SQLWARN5            PIC X(1).                         
000023         10 SQLWARN6            PIC X(1).                         
000024         10 SQLWARN7            PIC X(1).                         
000025     05  SQLSTATE               PIC X(5).                         
000026     05  SQLEXT                 PIC S9(5) COMP-3 VALUE 1.         
      *<<((file: SQLCA))
000864                                                                  
000865*----------------------------------------------------------------*
000866 PROCEDURE DIVISION.                                              
000867*----------------------------------------------------------------*
000866 VCOBOL-DUMMY-PROCEDURE.
000868                                                                  
000869     
      *EXEC SQL WHENEVER SQLERROR    GO TO Z00-ERRORE  END-EXEC
                                                                        
000870                                                                  
000871     MOVE 'AAASA15'              TO PPNAME                        
000872                                    WCOM-PROGNAME.                
000873                                                                  
000874                                                                  
000875     PERFORM A00-RICERCA-DATE                                     
000876        THRU A00-EX.                                              
000877                                                                  
000878     PERFORM A10-LETTURA-SKPAR                                    
000879        THRU A10-EX.                                              
000880                                                                  
000881     IF SK-TIPOELAB = 'ORDINI'                                    
000882        OPEN OUTPUT ORDISCO                                       
000883        PERFORM L20-SELECT-SCARDATE                               
000884           THRU L20-EX                                            
000885        PERFORM C00-ELABORA-DA-RICEVERE                           
000886           THRU C00-EX                                            
000887        CLOSE ORDISCO.                                            
000888                                                                  
000889     IF SK-TIPOELAB = 'RICEVUTI'                                  
000890        OPEN INPUT  RICEVUT                                       
000891        OPEN OUTPUT OUTRICE                                       
000892        PERFORM D00-ELABORA-RICEVUTI                              
000893           THRU D00-EX                                            
000894        CLOSE RICEVUT OUTRICE.                                    
000895                                                                  
000896     IF SK-TIPOELAB = 'NETMOVER' OR                               
000897        SK-TIPOELAB = 'LAVORAZI'                                  
000898        OPEN INPUT NETMOVER                                       
000899        OPEN OUTPUT OUTNETM                                       
000900        PERFORM E00-ELABORA-NETMOVER                              
000901           THRU E00-EX                                            
000902        CLOSE NETMOVER OUTNETM.                                   
000903                                                                  
000904     MOVE 'P'                   TO PPROUTIN.                      
000905     PERFORM Z90-READPRIN                                         
000906        THRU Z90-EX.                                              
000907     MOVE ZERO                  TO RETURN-CODE.                   
000908     CALL "CCF_SET_RETCODE" USING RETURN-CODE                     
000909     STOP RUN.                                                    
000910                                                                  
000911*---------------------------------------------------------------* 
000912 A00-RICERCA-DATE.                                                
000913*---------------------------------------------------------------* 
000914                                                                  
000915     MOVE SPACES                 TO DCWDTEL.                      
000916     MOVE 'R'                    TO DTEL-TIPORICH.                
000917     MOVE 'AAASA15'              TO DTEL-SIGLDATA.                
000918     MOVE 'G'                    TO DTEL-DATATIPO.                
000919                                                                  
000920     MOVE 'SCADTEL'              TO PPCALL.                       
000921     CALL PPCALL                 USING DCPARM  DCWDTEL.           
000922                                                                  
000923     IF DTEL-RETCOD NOT = ZEROES                                  
000924        MOVE 'CHIAMATA'          TO WCOM-FILEFUNZ                 
000925        MOVE 'SCADTEL'           TO WCOM-FILENOME                 
000926        MOVE 'A00-'              TO WCOM-CODABEND                 
000927        MOVE 'AAASA15'           TO WCOM-FILECTRL                 
000928        MOVE 'RENATO - DATA NON CORRETTA '                        
000929                                 TO WCOM-MESSAGES                 
000930        PERFORM Z00-ERRORE                                        
000931           THRU Z00-EX.                                           
000932                                                                  
000933 A00-EX. EXIT.                                                    
000934*---------------------------------------------------------------* 
000935 A10-LETTURA-SKPAR.                                               
000936*---------------------------------------------------------------* 
000937                                                                  
000938     MOVE 'S'                    TO PPROUTIN.                     
000939     PERFORM Z90-READPRIN                                         
000940        THRU Z90-EX.                                              
000941     MOVE PPSK1                  TO SK-PARAM.                     
000942                                                                  
000943     IF SK-TIPOELAB NOT EQUAL 'ORDINI' AND 'RICEVUTI'             
000944                          AND 'NETMOVER' AND 'LAVORAZI'           
000945        MOVE 'A10-'              TO WCOM-CODABEND                 
000946        MOVE 'LETTURA'           TO WCOM-FILEFUNZ                 
000947        MOVE 'SKEDA-P'           TO WCOM-FILENOME                 
000948        MOVE SK-PARAM            TO WCOM-FILECTRL                 
000949        MOVE 'SKEDA PARAMETRO ERRATA'                             
000950                                 TO WCOM-MESSAGES                 
000951        PERFORM Z00-ERRORE                                        
000952           THRU Z00-EX.                                           
000953                                                                  
000954 A10-EX. EXIT.                                                    
000955*----------------------------------------------------------------*
000956 C00-ELABORA-DA-RICEVERE.                                         
000957*----------------------------------------------------------------*
000958                                                                  
000959     MOVE 'C00-'                 TO WCOM-CODABEND.                
000960     MOVE 'OPEN'                 TO WCOM-FILEFUNZ.                
000961     MOVE 'POINTER2'             TO WCOM-FILENOME.                
000963     
      *EXEC SQL 
      *OPEN POINTER2                                           
000964*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 1 TO SQL-STMT-ID 
           MOVE 26 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DATAELAB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DATAELAB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DATAELAB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DATAELAB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DATAELAB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DATAELAB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DATAELAB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DATAELAB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DATAELAB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DATAELAB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DATAELAB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DATAELAB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DATAELAB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DATAELAB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DATAELAB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DATAELAB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DATAELAB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 17 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DATAELAB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 18 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DATAELAB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 19 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DATAELAB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 20 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DATAELAB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 21 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DATAELAB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 22 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DATAELAB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 23 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DATAELAB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 24 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DATAELAB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 25 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DATAELAB
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000965                                                                  
000966     PERFORM L00-FETCH-POINTER2                                   
000967        THRU L00-EX.                                              
000968     PERFORM C10-ELABORA-POINTER2                                 
000969        THRU C10-EX                                               
000970             UNTIL SQLCODE = +100.                                
000971                                                                  
000972     MOVE 'C00 '                 TO WCOM-CODABEND.                
000973     MOVE 'CLOSE'                TO WCOM-FILEFUNZ.                
000974     MOVE 'POINTER2'             TO WCOM-FILENOME.                
000976     
      *EXEC SQL 
      *CLOSE POINTER2                                          
000977*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000978                                                                  
000979 C00-EX. EXIT.                                                    
000980*----------------------------------------------------------------*
000981 C10-ELABORA-POINTER2.                                            
000982*----------------------------------------------------------------*
000983*    IL TEST 'S700-MERCEMAG = 'RI'                GIRO X SCORTE   
000984*    IL TEST 'S700-MERCEMAG = 'B' OR 'C' OR 'D'   GIRO X MEST     
000985*       ALTRIMENTI                                GIRO X SIFO     
000986***  QTAMOVIM CONTIENE IL RICEVUTO PRIMA DEL 01-01-2020           
000987***  (PARTENZA SAP) ED E' VALORIZZATO PER SCORTE/SIFO             
000988                                                                  
000989     IF S467-QTAMOVIM > 0                                         
000990        COMPUTE S479-QTAORDIN = S479-QTAORDIN - S467-QTAMOVIM     
000991        IF S479-QTAORDIN NOT > ZEROES                             
000992           GO TO C10-LEGGI                                        
000993        END-IF                                                    
000994     ELSE                                                         
000995       IF S467-PREZZMER > 0                                       
000996          COMPUTE S479-PREZZORD = S479-PREZZORD - S467-PREZZMER   
000997          IF S479-PREZZORD NOT > ZEROES                           
000998             GO TO C10-LEGGI.                                     
000999                                                                  
001000     IF S478-CENCOSTO NOT > ' '                                   
001001        PERFORM C15-CERCA-CCOS                                    
001002           THRU C15-EX.                                           
001003                                                                  
001004     MOVE SPACES                 TO WS-NOSAPXXX.                  
001005                                                                  
001006     MOVE SPACES                 TO FSGTMO                        
001007     INITIALIZE                     FSGTMO.                       
001008                                                                  
001009     IF S478-CODSOCIE NOT = A531-CODSOCIE                         
001010        MOVE S478-CODSOCIE       TO A531-CODSOCIE                 
001011        PERFORM L10-SELECT-TSOCIETA                               
001012           THRU L10-EX.                                           
001013                                                                  
001014     MOVE A531-SOCIEGTM          TO FSGT-SOCIETAN.                
001015     MOVE A531-SOCIEGTM(2:1)     TO FSGT-SOCIETAX.                
001016     IF A531-CODSOCIE = '0Q'                                      
001017        MOVE 'U'                 TO FSGT-SOCIETAX.                
001018     MOVE S478-CDDIVISI          TO FSGT-DIVISION.                
001019                                                                  
001020     MOVE S478-AANUMORD          TO FSGT-AANUMORD.                
001021     MOVE S479-NRRIGORD          TO FSGT-NRRIGORD.                
001022     IF S478-CODUTENT NOT = A845-CODUTENT                         
001023        MOVE S478-CODUTENT       TO A845-CODUTENT                 
001024        PERFORM L80-SELECT-TUTENTI                                
001025           THRU L80-EX.                                           
001026     MOVE A845-NOMUTENT          TO FSGT-NOMUTENT.                
001027                                                                  
001028**** DISPLAY 'MERCEMAG ' S700-MERCEMAG ' ' S478-AANUMORD          
001029     IF S700-MERCEMAG = 'RI'                                      
001030        MOVE S478-AANUMORD(7:2)  TO FSGT-NUMORDIN(1:2)            
001031        MOVE S478-AANUMORD(4:3)  TO FSGT-NUMORDIN(3:3)            
001032     ELSE                                                         
001033        MOVE S478-AANUMORD(4:5)  TO FSGT-NUMORDIN.                
001034                                                                  
001035     MOVE S478-CODFORNI          TO FSGT-FORNITOR.                
001036     MOVE S478-DESCORDI          TO FSGT-DESCORDI.                
001037     MOVE 'F'                    TO FSGT-F-R-S-XX.                
001038     MOVE S478-AANUMRIC(4:5)     TO FSGT-NUMRICIN.                
001039                                                                  
001040     IF S478-CDEVARIC NOT = AD99-CODBUYER(1:2)                    
001041        MOVE S478-CDEVARIC       TO AD99-CODBUYER                 
001042        PERFORM L90-SELECT-BUYER                                  
001043           THRU L90-EX.                                           
001044     IF AD99-BUYERGTM > SPACES                                    
001045        MOVE AD99-BUYERGTM       TO FSGT-SERVIZIO                 
001046     ELSE                                                         
001047        MOVE S478-CDEVARIC       TO FSGT-SERVIZIO.                
001048                                                                  
001049     IF S700-MERCEMAG = 'RI'                                      
001050        MOVE S478-CONTODCE       TO FSGT-CONTDCEN                 
001051        MOVE S478-NUMAUTOR       TO FSGT-NUMAUTOR                 
001052     ELSE                                                         
001053        MOVE S478-CODSOCIE       TO A531-CODSOCIE                 
001054        MOVE S478-CONTODCE       TO C861-CONTPROV                 
001055        PERFORM L60-SELECT-CONTPROV                               
001056           THRU L60-EX                                            
001057        MOVE C861-CONTODCE       TO FSGT-CONTDCEN.                
001058                                                                  
001059     MOVE SPACES                 TO AD22-CDVALSCO.                
001060                                                                  
001061     IF S700-MERCEMAG = 'RI'                                      
001062        MOVE S478-CONTODCE       TO C861-CONTODCE                 
001063        PERFORM L40-SELECT-CONTIDCE                               
001064           THRU L40-EX                                            
001065        IF C861-CONTGRUP > ' '                                    
001066           MOVE C861-CONTGRUP    TO AD22-CONTGRUP                 
001067           PERFORM L45-SELECT-SCORTDCE                            
001068              THRU L45-EX.                                        
001069                                                                  
001070     MOVE S478-DEPDESTI          TO FSGT-CODDEPOS.                
001071                                                                  
001072     IF S700-MERCEMAG NOT = 'RI'                                  
001073        MOVE S478-CENCOSTO       TO FSGT-CENCOSTO                 
001074     ELSE                                                         
001075        IF S478-CATEARTI = 'C'                                    
001076           MOVE S478-CENCOSTO    TO FSGT-CENCOSTO                 
001077        ELSE                                                      
001078           MOVE S478-DEPDESTI    TO A838-STABILIM                 
001079           PERFORM L50-SELECT-STABILIMENTI                        
001080              THRU L50-EX                                         
001081           IF A838-CENCOSCO > SPACES        AND                   
001082              A838-CODSOCIE = S478-CODSOCIE AND                   
001083              AD22-CDVALSCO = 'A'                                 
001084              MOVE A838-CENCOSCO TO FSGT-CENCOSTO                 
001085           ELSE                                                   
001086              MOVE S478-CENCOSTO TO FSGT-CENCOSTO.                
001087                                                                  
001088     IF S700-MERCEMAG = 'C'  AND                                  
001089        S478-CODSOCIE = '25'                                      
001090        MOVE '25TL05'            TO L651-CODSERVI                 
001091        PERFORM L15-SELECT-SERVIZI                                
001092           THRU L15-EX                                            
001093        IF L651-CENCOSTA > ' '                                    
001094           MOVE L651-CENCOSTA    TO FSGT-CENCOSTO.                
001095                                                                  
001096     IF S479-DATACONS(1:4) < DTEL-DTINELAB(1:4)                   
001097        MOVE DTEL-DTINELAB       TO S479-DATACONS.                
001098                                                                  
001099     IF S700-MERCEMAG NOT = 'RI' AND                              
001100        S700-MERCEMAG NOT = 'B' AND 'C' AND 'D'                   
001101        MOVE S701-CODARTIC       TO FSGT-ARTICOLI                 
001102     ELSE                                                         
001103        IF S479-CODARTSC NOT > SPACES                             
001104           MOVE S479-DATACONS(5:2) TO FSGT-ARTICOLI(7:2)          
001105        ELSE                                                      
001106           MOVE S479-CODARTSC      TO FSGT-ARTICOLI.              
001107                                                                  
001108     IF S478-CATEARTI EQUAL 'C' OR                                
001109        (S700-MERCEMAG NOT = 'RI' AND                             
001110         S700-MERCEMAG NOT = 'B'  AND 'C' AND 'D' )               
001111        MOVE '000'               TO FSGT-VARIANTE.                
001112                                                                  
001113     MOVE S478-DTCARORD(7:2)     TO FSGT-GGORDINE                 
001114     MOVE S478-DTCARORD(5:2)     TO FSGT-MMORDINE                 
001115     MOVE S478-DTCARORD(3:2)     TO FSGT-AAORDINE                 
001116                                                                  
001117     MOVE S479-DATACONS(7:2)     TO FSGT-GGCONSEG                 
001118     MOVE S479-DATACONS(5:2)     TO FSGT-MMCONSEG                 
001119     MOVE S479-DATACONS(3:2)     TO FSGT-AACONSEG                 
001120                                                                  
001121     IF S478-CODDIVIS NOT EQUAL A963-CODDIVIS                     
001122        MOVE S478-CODDIVIS       TO A963-CODDIVIS                 
001123        PERFORM L30-SELECT-TDIVISE                                
001124           THRU L30-EX.                                           
001125     MOVE A963-CODDIGTM          TO FSGT-DIVISAXX.                
001126                                                                  
001127     MOVE S479-PREZZORD          TO WS-PREZZMER                   
001128     IF S700-MERCEMAG = 'RI'                                      
001129        PERFORM C12-RICALCOLA-PREZZMER                            
001130           THRU C12-EX.                                           
001131                                                                  
001132     COMPUTE FSGT-PREZZOXX = WS-PREZZMER * 100                    
001133     MOVE '4'                    TO FSGT-EDIPRICE                 
001134     MOVE S479-QTAORDIN          TO FSGT-QTARICEV                 
001135                                                                  
001136     MOVE S479-UNMISURA          TO FSGT-UNMISURA.                
001137                                                                  
001138     MOVE SPACES                 TO FSGT-ACCOSALD.                
001139                                                                  
001140     MOVE SPACES                 TO WS-DESARTIC                   
001141                                    WS-VOCEDOGA.                  
001142     MOVE ZEROES                 TO WS-PESOGRMT                   
001143                                    WS-VOLUMEXX.                  
001144                                                                  
001145     IF S700-MERCEMAG = 'RI'   OR                                 
001146       (S700-MERCEMAG = 'B' OR 'D' OR 'C')                        
001147        MOVE S480-DESARTSC       TO FSGT-DESCARTI                 
001148     ELSE                                                         
001149        PERFORM C20-CERCA-DESARTIC                                
001150           THRU C20-EX                                            
001151        MOVE WS-DESARTIC         TO FSGT-DESCARTI.                
001152                                                                  
001153     IF FSGT-SOCIETAN EQUAL '15' AND                              
001154        FSGT-AACONSEG LESS   09                                   
001155        MOVE '02'                TO FSGT-GGCONSEG                 
001156        MOVE '01'                TO FSGT-MMCONSEG                 
001157        MOVE '09'                TO FSGT-AACONSEG.                
001158                                                                  
001159     MOVE S478-TARGVETT          TO FSGT-TARGVETT.                
001160     MOVE FSGT-AANUMORD          TO FSGT-AANUMMOV(1:8).           
001161     MOVE FSGT-NRRIGORX(2:2)     TO FSGT-AANUMMOV(9:2).           
001162                                                                  
001163     PERFORM W00-WRITE-ORDINI                                     
001164        THRU W00-EX.                                              
001165                                                                  
001166     IF S700-MERCEMAG = 'RI'                                      
001167        IF S478-NRCOMMES > SPACES                                 
001168           IF S007-WBS > SPACES AND                               
001169              S007-WBS NOT = S478-NRCOMMES                        
001170              MOVE S007-WBS    TO S478-NRCOMMES                   
001171              PERFORM S20-WRITE-ORDISCORN                         
001172                 THRU S20-EX.                                     
001173                                                                  
001174 C10-LEGGI.                                                       
001175     PERFORM L00-FETCH-POINTER2                                   
001176        THRU L00-EX.                                              
001177                                                                  
001178 C10-EX. EXIT.                                                    
001179*----------------------------------------------------------------*
001180 C12-RICALCOLA-PREZZMER.                                          
001181*----------------------------------------------------------------*
001182                                                                  
001183     IF S479-PERCSCO1 > ZEROES                                    
001184        COMPUTE WS-PREZZMER =                                     
001185           WS-PREZZMER - (WS-PREZZMER * S479-PERCSCO1) / 100.     
001186                                                                  
001187     IF S479-PERCSCO2 > ZEROES                                    
001188        COMPUTE WS-PREZZMER =                                     
001189           WS-PREZZMER - (WS-PREZZMER * S479-PERCSCO2) / 100.     
001190                                                                  
001191     IF S479-PERCSCO3 > ZEROES                                    
001192        COMPUTE WS-PREZZMER =                                     
001193           WS-PREZZMER - (WS-PREZZMER * S479-PERCSCO3) / 100.     
001194                                                                  
001195     IF S478-PERSCOIM > ZEROES                                    
001196        COMPUTE WS-PREZZMER =                                     
001197           WS-PREZZMER - (WS-PREZZMER * S478-PERSCOIM) / 100.     
001198                                                                  
001199     IF S478-PERCSCON > ZEROES                                    
001200        COMPUTE WS-PREZZMER =                                     
001201           WS-PREZZMER - (WS-PREZZMER * S478-PERCSCON) / 100.     
001202                                                                  
001203 C12-EX. EXIT.                                                    
001204*----------------------------------------------------------------*
001205 C15-CERCA-CCOS.                                                  
001206*----------------------------------------------------------------*
001207                                                                  
001208     INITIALIZE                     DCWCCOS                       
001209     MOVE M892-CODCLIEN          TO CCOS-CODCLIEN                 
001210     MOVE M892-CODLINEA          TO CCOS-CODLINEA                 
001211                                                                  
001212     MOVE M892-TIPSTALL          TO CCOS-TIPOSTAG.                
001213                                                                  
001214     MOVE 'SCBCCOS'              TO PPCALL                        
001215     CALL PPCALL USING DCPARM DCWCCOS.                            
001216     MOVE 'AAASA15'              TO PPNAME                        
001217                                    WCOM-PROGNAME.                
001218                                                                  
001219     IF CCOS-SQLCODE = +100                                       
001220         STRING 'RENATO: MANCA C/COSTO X CHIAVE CCOS : '          
001221                 DCWCCOS                                          
001222            DELIMITED BY SIZE INTO PPMESSAG                       
001223         MOVE 'M'                TO PPROUTIN                      
001224         PERFORM Z90-READPRIN                                     
001225            THRU Z90-EX.                                          
001226                                                                  
001227     MOVE CCOS-CENCOALL          TO S478-CENCOSTO.                
001228     IF M892-CODLINEA = 'RD' OR 'R7'                              
001229        MOVE CCOS-CENCOPRO          TO S478-CENCOSTO.             
001230                                                                  
001231 C15-EX. EXIT.                                                    
001232*--------------------------------------------------------------*  
001233 C20-CERCA-DESARTIC.                                              
001234*--------------------------------------------------------------*  
001235                                                                  
001236     MOVE S701-CODARTIC          TO WS-CODARTIC.                  
001237     MOVE SPACES                 TO WS-DESARTIC.                  
001238                                                                  
001239     IF S700-MERCEMAG = 'FF'                                      
001240        PERFORM L65-SELECT-TFILATI                                
001241           THRU L65-EX.                                           
001242                                                                  
001243     IF S700-MERCEMAG = 'GS' OR                                   
001244        S700-MERCEMAG = 'PS'                                      
001245        PERFORM L70-SELECT-TARTIGREG                              
001246           THRU L70-EX.                                           
001247                                                                  
001248     IF S700-MERCEMAG = 'TT'                                      
001249        PERFORM L75-SELECT-TARTICOLI                              
001250           THRU L75-EX.                                           
001251                                                                  
001252 C20-EX. EXIT.                                                    
001253*--------------------------------------------------------------*  
001254 D00-ELABORA-RICEVUTI.                                            
001255*--------------------------------------------------------------*  
001256                                                                  
001257     PERFORM L05-LEGGI-RICEVUT                                    
001258        THRU L05-EX.                                              
001259                                                                  
001260     PERFORM D10-ELABORA                                          
001261        THRU D10-EX                                               
001262             UNTIL FSGTMO = HIGH-VALUE.                           
001263                                                                  
001264 D00-EX. EXIT.                                                    
001265*--------------------------------------------------------------*  
001266 D10-ELABORA.                                                     
001267*--------------------------------------------------------------*  
001268                                                                  
001269     MOVE SPACES                 TO WS-NOSAPXXX.                  
001270                                                                  
001271     IF FSGT-DTCONSEG = ZEROES                                    
001272        MOVE DTEL-DTINELAB(7:2)  TO FSGT-GGCONSEG                 
001273        MOVE DTEL-DTINELAB(5:2)  TO FSGT-MMCONSEG                 
001274        MOVE DTEL-DTINELAB(3:2)  TO FSGT-AACONSEG.                
001275                                                                  
001276     MOVE SPACES                 TO S700-MERCEMAG.                
001277     IF FSGT-AANUMMOV(1:1) = 'R'                                  
001278        MOVE 'RI'                TO S700-MERCEMAG.                
001279                                                                  
001280     IF FSGT-F-R-S-XX     = 'R' AND                               
001281        FSGT-MERCEMAG NOT > SPACES                                
001282        MOVE 'RI'                TO S700-MERCEMAG.                
001283                                                                  
001284     MOVE SPACES                 TO S700-CODIRESA.                
001285     MOVE SPACES                 TO S479-DTANNULL.                
001286                                                                  
001287     MOVE SPACES                 TO WS-DESARTIC                   
001288                                    WS-VOCEDOGA.                  
001289     MOVE ZEROES                 TO WS-PESOGRMT                   
001290                                    WS-VOLUMEXX.                  
001291                                                                  
001292     MOVE SPACES                 TO DCLSAP-ORDACQ-HEADER          
001293     INITIALIZE                     DCLSAP-ORDACQ-HEADER          
001294                                                                  
001295     IF FSGT-F-R-S-XX = 'R'                                       
001296        IF FSGT-FORNITOR NOT = A972-CODFORNI                      
001297           MOVE FSGT-FORNITOR    TO A972-CODFORNI                 
001298           PERFORM L25-SELECT-TFORNITORI                          
001299              THRU L25-EX.                                        
001300                                                                  
001301     MOVE SPACES                 TO S478-NRCOMMES.                
001302     IF S700-MERCEMAG = 'RI'                                      
001303        MOVE FSGT-AANUMORD       TO S478-AANUMORD                 
001304        PERFORM L94-SELECT-TORDISCORN-COMMESSA                    
001305           THRU L94-EX.                                           
001306                                                                  
001307     MOVE FSGT-AANUMORD          TO S006-ODA-CICS-ITEMTABLE       
001308     IF FSGT-NOTEXXXX = 'VEND A FORN'                             
001309        MOVE SPACES              TO S006-ODA-CICS-ITEMTABLE       
001310        MOVE FSGT-AANUMORD       TO S006-ODA-CICS-ITEMTABLE(1:8)  
001311        MOVE 'V'                 TO S006-ODA-CICS-ITEMTABLE(9:1). 
001312                                                                  
001313     MOVE FSGT-NRRIGORD          TO S006-CICS-PO-ITEM-ITEMTABLE   
001314     PERFORM L170-SELECT-ITEM                                     
001315        THRU L170-EX                                              
001316     IF SQLCODE = 100                                             
001317        PERFORM L171-SELECT-MAX-ITEM                              
001318           THRU L171-EX                                           
001319        MOVE S006-ODA-CICS-ITEMTABLE TO S005-ODA-CICS             
001320        PERFORM W20-INSERT-MODIFICA-TESTATA                       
001321           THRU W20-EX                                            
001322        PERFORM W40-PREPARA-ITEM                                  
001323           THRU W40-EX                                            
001324        PERFORM W60-PREPARA-ACCOUNT                               
001325           THRU W60-EX.                                           
001326                                                                  
001327     IF (FSGT-F-R-S-XX     = 'R'  AND                             
001328         A972-CODPAESE NOT = '000'   )  OR                        
001329        FSGT-NOTEXXXX = 'VEND A FORN'                             
001330        CONTINUE                                                  
001331     ELSE                                                         
001332        PERFORM W80-PREPARA-EM                                    
001333           THRU W80-EX.                                           
001334                                                                  
001335     IF WS-NOSAPXXX = '--'                                        
001336        MOVE FSGT-AANUMORD       TO S005-ODA-CICS                 
001337        PERFORM W99-UPDATE-HEADER                                 
001338           THRU W99-EX.                                           
001339                                                                  
001340     PERFORM L05-LEGGI-RICEVUT                                    
001341        THRU L05-EX.                                              
001342                                                                  
001343 D10-EX. EXIT.                                                    
001344*--------------------------------------------------------------*  
001345 E00-ELABORA-NETMOVER.                                            
001346*--------------------------------------------------------------*  
001347                                                                  
001348     PERFORM L06-LEGGI-NETMOVER                                   
001349        THRU L06-EX.                                              
001350                                                                  
001351     PERFORM E10-ELABORA                                          
001352        THRU E10-EX                                               
001353             UNTIL FSNET09 = HIGH-VALUE.                          
001354                                                                  
001355 E00-EX. EXIT.                                                    
001356*--------------------------------------------------------------*  
001357 E10-ELABORA.                                                     
001358*--------------------------------------------------------------*  
001359                                                                  
001360     MOVE SPACES                 TO WS-NOSAPXXX.                  
001361                                                                  
001362     MOVE SPACES                 TO S700-CODIRESA.                
001363     MOVE SPACES                 TO S479-DTANNULL.                
001364     MOVE SPACES                 TO S478-NRCOMMES.                
001365                                                                  
001366     MOVE SPACES                 TO WS-DESARTIC                   
001367                                    WS-VOCEDOGA.                  
001368     MOVE ZEROES                 TO WS-PESOGRMT                   
001369                                    WS-VOLUMEXX.                  
001370                                                                  
001371     MOVE SPACES                 TO FSGTMO                        
001372     INITIALIZE                     FSGTMO.                       
001373                                                                  
001374     MOVE 'TR'                   TO S700-MERCEMAG                 
001375     IF SK-TIPOELAB = 'LAVORAZI'                                  
001376        MOVE 'LA'                TO S700-MERCEMAG.                
001377     MOVE N09-CODSOCIE           TO FSGT-SOCIETAN                 
001378                                                                  
001379     MOVE N09-CODFORNI           TO FSGT-FORNITOR                 
001380     MOVE N09-CODDIVIS           TO FSGT-DIVISAXX                 
001381                                                                  
001382     MOVE SK-TIPOELAB            TO FSGT-NOMUTENT.                
001383                                                                  
001384     MOVE SPACES                 TO FSGT-UNMISURA                 
001385     MOVE ZEROES                 TO FSGT-QTARICEV                 
001386     COMPUTE FSGT-PREZZOXX = N09-IMPORTOX  * 100                  
001387                                                                  
001388     MOVE N09-DATAELAB(7:2)      TO FSGT-GGCONSEG                 
001389     MOVE N09-DATAELAB(5:2)      TO FSGT-MMCONSEG                 
001390     MOVE N09-DATAELAB(3:2)      TO FSGT-AACONSEG                 
001391     IF N09-DATAELAB NOT > ' '                                    
001392        MOVE DTEL-DTINELAB(7:2)  TO FSGT-GGCONSEG                 
001393        MOVE DTEL-DTINELAB(5:2)  TO FSGT-MMCONSEG                 
001394        MOVE DTEL-DTINELAB(3:2)  TO FSGT-AACONSEG.                
001395                                                                  
001396     MOVE N09-NUMBOLLA           TO FSGT-NUMBOLLA                 
001397     MOVE N09-DATBOLLA(7:2)      TO FSGT-GGBOLLAX                 
001398     MOVE N09-DATBOLLA(5:2)      TO FSGT-MMBOLLAX                 
001399     MOVE N09-DATBOLLA(3:2)      TO FSGT-AABOLLAX                 
001400                                                                  
001401     MOVE N09-CENCOSTO           TO FSGT-CENCOSTO                 
001402     MOVE N09-DIVISION           TO FSGT-DIVISION                 
001403     MOVE N09-CONTODCE           TO FSGT-CONTDCEN                 
001404                                                                  
001405     MOVE SPACES                 TO DCLSAP-ORDACQ-HEADER          
001406     INITIALIZE                     DCLSAP-ORDACQ-HEADER          
001407                                                                  
001408     MOVE N09-NRPREFAT           TO S005-ODA-CICS                 
001409     PERFORM W20-INSERT-MODIFICA-TESTATA                          
001410        THRU W20-EX                                               
001411                                                                  
001412     MOVE N09-NRPREFAT           TO S006-ODA-CICS-ITEMTABLE       
001413     PERFORM L171-SELECT-MAX-ITEM                                 
001414        THRU L171-EX                                              
001415     ADD 1                       TO WS-NRRIGORD                   
001416     MOVE WS-NRRIGORD            TO FSGT-NRRIGORD                 
001417                                                                  
001418     PERFORM W40-PREPARA-ITEM                                     
001419        THRU W40-EX                                               
001420     PERFORM W60-PREPARA-ACCOUNT                                  
001421        THRU W60-EX.                                              
001422                                                                  
001423     PERFORM W80-PREPARA-EM                                       
001424        THRU W80-EX.                                              
001425                                                                  
001426     IF WS-NOSAPXXX = '--'                                        
001427        MOVE N09-NRPREFAT        TO S005-ODA-CICS                 
001428        PERFORM W99-UPDATE-HEADER                                 
001429           THRU W99-EX.                                           
001430                                                                  
001431     PERFORM L06-LEGGI-NETMOVER                                   
001432        THRU L06-EX.                                              
001433                                                                  
001434 E10-EX. EXIT.                                                    
001435*--------------------------------------------------------------*  
001436 L00-FETCH-POINTER2.                                              
001437*--------------------------------------------------------------*  
001438                                                                  
001439     MOVE 'L00-'                 TO WCOM-CODABEND.                
001440     MOVE 'FETCH'                TO WCOM-FILEFUNZ.                
001441     MOVE 'POINTER2'             TO WCOM-FILENOME.                
001442     MOVE SPACES                 TO WCOM-FILECTRL.                
001443                                                                  
001445     
      *EXEC SQL 
      *FETCH POINTER2                                          
001446*            INTO :S700-MERCEMAG                                   
001447*                ,:S478-CODSOCIE, :S478-CODFORNI                   
001448*                ,:S478-AANUMORD, :S479-NRRIGORD                   
001449*                ,:S478-DTCARORD, :S478-CODDIVIS                   
001450*                ,:S478-CENCOSTO, :S478-NRCOMMES                   
001451*                ,:S478-CONTODCE, :S478-DESCORDI                   
001452*                ,:S478-PERCSCON                                   
001453*                ,:S479-CODARTSC, :S701-CODARTIC                   
001454*                ,:S479-DATACONS, :S479-QTAORDIN                   
001455*                ,:S479-QTARICEV, :S479-IMPRICEV                   
001456*                ,:S479-PREZZORD, :S479-PERCSCO1                   
001457*                ,:S479-PERCSCO2, :S479-PERCSCO3                   
001458*                ,:S478-PERSCOIM, :S478-IMPSCONT                   
001459*                ,:S479-UNMISURA, :S480-DESARTSC                   
001460*                ,:S478-AANUMRIC, :S478-CDDIVISI                   
001461*                ,:S478-DEPDESTI, :S478-CATEARTI                   
001462*                ,:S478-CDEVARIC, :S478-TARGVETT                   
001463*                ,:S478-CODUTENT, :S478-NUMAUTOR                   
001464*                ,:A496-CDDIRDIV                                   
001465*                ,:M892-CODCLIEN                                   
001466*                ,:M892-TIPSTALL                                   
001467*                ,:M892-CODLINEA                                   
001468*                ,:S478-DTCREAZI                                   
001469*                ,:S478-DTULTVAR                                   
001470*                ,:S478-DTANNULL                                   
001471*                ,:S478-DATASALD                                   
001472*                ,:S479-DTCREAZI                                   
001473*                ,:S479-DTULTVAR                                   
001474*                ,:S479-DTANNULL                                   
001475*                ,:S479-DATASALD                                   
001476*                ,:S467-QTAMOVIM                                   
001477*                ,:S467-PREZZMER                                   
001478*                ,:S700-CODIRESA                                   
001479*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 2 TO SQL-STMT-ID 
           MOVE 49 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S700-MERCEMAG
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-CODSOCIE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-CODFORNI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-AANUMORD
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S479-NRRIGORD
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-DTCARORD
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-CODDIVIS
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-CENCOSTO
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-NRCOMMES
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-CONTODCE
            BY VALUE 0
                     0

           MOVE 16 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-DESCORDI
            BY VALUE 0
                     0

           MOVE 517 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-PERCSCON
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S479-CODARTSC
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S701-CODARTIC
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S479-DATACONS
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S479-QTAORDIN
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S479-QTARICEV
            BY VALUE 0
                     0

           MOVE 1039 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 17 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S479-IMPRICEV
            BY VALUE 0
                     0

           MOVE 1039 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 18 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S479-PREZZORD
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 19 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S479-PERCSCO1
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 20 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S479-PERCSCO2
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 21 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S479-PERCSCO3
            BY VALUE 0
                     0

           MOVE 1031 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 22 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-PERSCOIM
            BY VALUE 0
                     0

           MOVE 1039 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 23 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-IMPSCONT
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 24 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S479-UNMISURA
            BY VALUE 0
                     0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 25 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S480-DESARTSC
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 26 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-AANUMRIC
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 27 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-CDDIVISI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 28 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-DEPDESTI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 29 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-CATEARTI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 30 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-CDEVARIC
            BY VALUE 0
                     0

           MOVE 9 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 31 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-TARGVETT
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 32 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-CODUTENT
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 33 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-NUMAUTOR
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 34 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A496-CDDIRDIV
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 35 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE M892-CODCLIEN
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 36 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE M892-TIPSTALL
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 37 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE M892-CODLINEA
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 38 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-DTCREAZI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 39 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-DTULTVAR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 40 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-DTANNULL
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 41 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-DATASALD
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 42 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S479-DTCREAZI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 43 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S479-DTULTVAR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 44 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S479-DTANNULL
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 45 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S479-DATASALD
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 46 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S467-QTAMOVIM
            BY VALUE 0
                     0

           MOVE 1039 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 47 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S467-PREZZMER
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 48 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S700-CODIRESA
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001480                                                                  
001481     IF SQLCODE = ZERO                                            
001482        MOVE 'U'                 TO PPROUTIN                      
001483        MOVE 'D'                 TO PPTPFILE                      
001484        MOVE 'R'                 TO PPTPOPER                      
001485        MOVE 'POINT2'            TO PPNMFILE                      
001486        PERFORM Z90-READPRIN                                      
001487           THRU Z90-EX.                                           
001488        IF S478-CODSOCIE = '22'                                   
001489           MOVE '16'             TO S478-CODSOCIE                 
001490           MOVE 'V'              TO S478-CDDIVISI.                
001491                                                                  
001492 L00-EX. EXIT.                                                    
001493*----------------------------------------------------------*      
001494 L05-LEGGI-RICEVUT.                                               
001495*----------------------------------------------------------*      
001496                                                                  
001497     READ  RICEVUT  INTO  FSGTMO                                  
001498        AT END MOVE HIGH-VALUE  TO FSGTMO.                        
001499                                                                  
001500     IF FSGTMO  = HIGH-VALUE                                      
001501        GO TO L05-EX.                                             
001502                                                                  
001503     MOVE 'U'                   TO PPROUTIN                       
001504     MOVE 'RICEVUT'             TO PPNMFILE                       
001505     MOVE 'S'                   TO PPTPFILE                       
001506     MOVE 'R'                   TO PPTPOPER                       
001507     PERFORM Z90-READPRIN                                         
001508        THRU Z90-EX.                                              
001509                                                                  
001510*--> DAL 2025 PER PARTENZA DI OPLA X SUBLITEX                     
001511*    NON SI GESTISCONO PIU LE SOC. 24,ME,SX,0T                    
001512                                                                  
001513     IF FSGT-SOCIETAN = '24' OR                                   
001514        FSGT-SOCIETAN = 'ME' OR                                   
001515        FSGT-SOCIETAN = 'SX' OR                                   
001516        FSGT-SOCIETAN = '0T'                                      
001517        GO TO L05-LEGGI-RICEVUT.                                  
001518                                                                  
001519     IF FSGT-SOCIETAN = '22'                                      
001520        MOVE '16'               TO FSGT-SOCIETAN                  
001521        MOVE 'V'                TO FSGT-DIVISION.                 
001522                                                                  
001523     IF FSGT-SOCIETAN NOT = A531-SOCIEGTM                         
001524        MOVE FSGT-SOCIETAN      TO A531-SOCIEGTM                  
001525        PERFORM L11-SELECT-TSOCIETA                               
001526           THRU L11-EX.                                           
001527     IF A531-FLSOCSAP NOT = 'S'                                   
001528        PERFORM S00-WRITE-OUTRICE                                 
001529           THRU S00-EX                                            
001530        GO TO L05-LEGGI-RICEVUT                                   
001531     ELSE                                                         
001532        IF FSGT-PREZZOXX < 1,01                                   
001533           IF FSGT-ARTICOLI(1:5) = 'CLAUS'                        
001534              GO TO L05-LEGGI-RICEVUT                             
001535           ELSE                                                   
001536              MOVE FSGT-ARTICOLI  TO AB44-CODARTS1                
001537              PERFORM L35-CTR-CLAUSOLA                            
001538                 THRU L35-EX                                      
001539              IF SQLCODE = ZERO                                   
001540                 GO TO L05-LEGGI-RICEVUT.                         
001541                                                                  
001542     MOVE 'U'                   TO PPROUTIN                       
001543     MOVE 'RICEVOK'             TO PPNMFILE                       
001544     MOVE 'S'                   TO PPTPFILE                       
001545     MOVE 'R'                   TO PPTPOPER                       
001546     PERFORM Z90-READPRIN                                         
001547        THRU Z90-EX.                                              
001548                                                                  
001549 L05-EX. EXIT.                                                    
001550*----------------------------------------------------------*      
001551 L06-LEGGI-NETMOVER.                                              
001552*----------------------------------------------------------*      
001553*--> DAL 2025 PER PARTENZA DI OPLA X SUBLITEX                     
001554*    NON SI SCARTANO LE SOC. 24,ME,SX,0T , PERCHE:                
001555*    - LE PREF.PASSIVE (ACGRD206) DEVONO PASSARE PER TUTTI.       
001556*    - I DAZI ARRIVANO SOLO PER LA 09 E NON 24.                   
001557                                                                  
001558                                                                  
001559     READ NETMOVER  INTO  FSNET09                                 
001560        AT END MOVE HIGH-VALUE  TO FSNET09.                       
001561                                                                  
001562     IF FSNET09 = HIGH-VALUE                                      
001563        GO TO L06-EX.                                             
001564                                                                  
001565     MOVE 'U'                  TO PPROUTIN                        
001566     MOVE 'NETMOVER'           TO PPNMFILE                        
001567     MOVE 'S'                  TO PPTPFILE                        
001568     MOVE 'R'                  TO PPTPOPER                        
001569     PERFORM Z90-READPRIN                                         
001570        THRU Z90-EX.                                              
001571                                                                  
001572     IF SK-TIPOELAB = 'LAVORAZI'                                  
001573        MOVE 'LAV'             TO N09-NRPREFAT(1:3)               
001574        MOVE N09-DATBOLLA(3:2) TO N09-NRPREFAT(4:2)               
001575        MOVE N09-NUMBOLLA      TO N09-NRPREFAT(6:5).              
001576                                                                  
001577     IF N09-CODSOCIE = '22'                                       
001578        MOVE '16'              TO N09-CODSOCIE                    
001579        MOVE 'V'               TO N09-DIVISION.                   
001580                                                                  
001581     IF N09-CODSOCIE NOT = A531-SOCIEGTM                          
001582        MOVE N09-CODSOCIE       TO A531-SOCIEGTM                  
001583        PERFORM L11-SELECT-TSOCIETA                               
001584           THRU L11-EX.                                           
001585     IF A531-FLSOCSAP NOT = 'S'                                   
001586        PERFORM S10-WRITE-OUTNETM                                 
001587           THRU S10-EX                                            
001588        GO TO L06-LEGGI-NETMOVER.                                 
001589                                                                  
001590     MOVE 'U'                  TO PPROUTIN                        
001591     MOVE 'NETMOVOK'           TO PPNMFILE                        
001592     MOVE 'S'                  TO PPTPFILE                        
001593     MOVE 'R'                  TO PPTPOPER                        
001594     PERFORM Z90-READPRIN                                         
001595        THRU Z90-EX.                                              
001596                                                                  
001597 L06-EX. EXIT.                                                    
001598*---------------------------------------------------------------- 
001599 L10-SELECT-TSOCIETA.                                             
001600*---------------------------------------------------------------- 
001601                                                                  
001602     MOVE 'L10-'                 TO WCOM-CODABEND.                
001603     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001604     MOVE 'TSOCIETA'             TO WCOM-FILENOME.                
001605     MOVE A531-CODSOCIE          TO WCOM-FILECTRL.                
001606                                                                  
001608     
      *EXEC SQL 
      *SELECT SOCIEGTM, CODDIVRI                                 
001609*          INTO :A531-SOCIEGTM, :A531-CODDIVRI                     
001610*          FROM DANAGRAF.TSOCIETA                                  
001611*         WHERE CODSOCIE = :A531-CODSOCIE                          
001612*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 3 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 4 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-SOCIEGTM
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODDIVRI
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001613                                                                  
001614     IF SQLCODE = ZERO                                            
001615        MOVE 'U'                 TO PPROUTIN                      
001616        MOVE 'D'                 TO PPTPFILE                      
001617        MOVE 'R'                 TO PPTPOPER                      
001618        MOVE 'SOCIETA'           TO PPNMFILE                      
001619        PERFORM Z90-READPRIN                                      
001620           THRU Z90-EX                                            
001621     ELSE                                                         
001622        PERFORM Z00-ERRORE                                        
001623           THRU Z00-EX.                                           
001624                                                                  
001625 L10-EX. EXIT.                                                    
001626*---------------------------------------------------------------- 
001627 L11-SELECT-TSOCIETA.                                             
001628*---------------------------------------------------------------- 
001629                                                                  
001630     MOVE 'L11-'                 TO WCOM-CODABEND.                
001631     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001632     MOVE 'TSOCIETA'             TO WCOM-FILENOME.                
001633     MOVE A531-SOCIEGTM          TO WCOM-FILECTRL.                
001634                                                                  
001636     
      *EXEC SQL 
      *SELECT FLSOCSAP                                           
001637*          INTO :A531-FLSOCSAP                                     
001638*          FROM DANAGRAF.TSOCIETA                                  
001639*         WHERE SOCIEGTM = :A531-SOCIEGTM                          
001640*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 5 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-SOCIEGTM
            BY VALUE 0
                     0

           MOVE 6 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-FLSOCSAP
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001641                                                                  
001642     IF SQLCODE = ZERO                                            
001643        MOVE 'U'                 TO PPROUTIN                      
001644        MOVE 'D'                 TO PPTPFILE                      
001645        MOVE 'R'                 TO PPTPOPER                      
001646        MOVE 'SOCIEGTM'          TO PPNMFILE                      
001647        PERFORM Z90-READPRIN                                      
001648           THRU Z90-EX                                            
001649     ELSE                                                         
001650        PERFORM Z00-ERRORE                                        
001651           THRU Z00-EX.                                           
001652                                                                  
001653 L11-EX. EXIT.                                                    
001654*---------------------------------------------------------------- 
001655 L15-SELECT-SERVIZI.                                              
001656*---------------------------------------------------------------- 
001657                                                                  
001658     MOVE 'L15-'            TO WCOM-CODABEND.                     
001659     MOVE 'SELECT'          TO WCOM-FILEFUNZ.                     
001660     MOVE 'TSERVIZI'        TO WCOM-FILENOME.                     
001661     MOVE L651-CODSERVI     TO WCOM-FILECTRL.                     
001662     MOVE SPACES            TO L651-CENCOSTA.                     
001663                                                                  
001665     
      *EXEC SQL 
      *SELECT CENCOSTA                                           
001666*          INTO :L651-CENCOSTA                                     
001667*          FROM DLOGISTI.TSERVIZI                                  
001668*         WHERE CODSERVI = :L651-CODSERVI                          
001669*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 7 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CODSERVI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CENCOSTA
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 4 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001670                                                                  
001671     IF SQLCODE = ZERO                                            
001672        MOVE 'U'           TO PPROUTIN                            
001673        MOVE 'D'           TO PPTPFILE                            
001674        MOVE 'R'           TO PPTPOPER                            
001675        MOVE 'SERVIZI'     TO PPNMFILE                            
001676        PERFORM Z90-READPRIN                                      
001677           THRU Z90-EX.                                           
001678                                                                  
001679 L15-EX. EXIT.                                                    
001680*---------------------------------------------------------------- 
001681 L20-SELECT-SCARDATE.                                             
001682*---------------------------------------------------------------- 
001683                                                                  
001684     MOVE 'L20-'                 TO WCOM-CODABEND.                
001685     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001686     MOVE 'SCARDATE'             TO WCOM-FILENOME.                
001687     MOVE 'AAASA15'              TO WCOM-FILECTRL.                
001688                                                                  
001690     
      *EXEC SQL 
      *SELECT DTINELAB                                        
001691*             INTO :AC64-DTINELAB                                  
001692*             FROM DANAGRAF.VANAGRAF_C64                           
001693*            WHERE SIGLDATA = 'AAASA15'                            
001694*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 9 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 20 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE AC64-DTINELAB
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 5 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001695                                                                  
001696     IF SQLCODE NOT = ZERO                                        
001697        PERFORM Z00-ERRORE                                        
001698           THRU Z00-EX                                            
001699     ELSE                                                         
001700        MOVE 'U'                 TO PPROUTIN                      
001701        MOVE 'D'                 TO PPTPFILE                      
001702        MOVE 'R'                 TO PPTPOPER                      
001703        MOVE 'SCARDATE'          TO PPNMFILE                      
001704        PERFORM Z90-READPRIN                                      
001705           THRU Z90-EX.                                           
001706                                                                  
001707     MOVE AC64-DTINELAB           TO WS-DATAELAB.                 
001708                                                                  
001709 L20-EX. EXIT.                                                    
001710*---------------------------------------------------------------- 
001711 L25-SELECT-TFORNITORI.                                           
001712*---------------------------------------------------------------- 
001713                                                                  
001714     MOVE 'L25-'                 TO WCOM-CODABEND.                
001715     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001716     MOVE 'TFORNITORI'           TO WCOM-FILENOME.                
001717     MOVE A972-CODFORNI          TO WCOM-FILECTRL.                
001718                                                                  
001720     
      *EXEC SQL 
      *SELECT CODPAESE                                        
001721*             INTO :A972-CODPAESE                                  
001722*             FROM DANAGRAF.TFORNITORI                             
001723*            WHERE CODFORNI = :A972-CODFORNI                       
001724*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 10 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A972-CODFORNI
            BY VALUE 0
                     0

           MOVE 11 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A972-CODPAESE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 6 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001725                                                                  
001726     IF SQLCODE NOT = ZERO                                        
001727        PERFORM Z00-ERRORE                                        
001728           THRU Z00-EX                                            
001729     ELSE                                                         
001730        MOVE 'U'                 TO PPROUTIN                      
001731        MOVE 'D'                 TO PPTPFILE                      
001732        MOVE 'R'                 TO PPTPOPER                      
001733        MOVE WCOM-FILENOME       TO PPNMFILE                      
001734        PERFORM Z90-READPRIN                                      
001735           THRU Z90-EX.                                           
001736                                                                  
001737 L25-EX. EXIT.                                                    
001738*---------------------------------------------------------------* 
001739 L30-SELECT-TDIVISE.                                              
001740*---------------------------------------------------------------* 
001741                                                                  
001742     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001743     MOVE 'DIVISE'               TO WCOM-FILENOME.                
001744     MOVE 'L30-'                 TO WCOM-CODABEND.                
001745     MOVE A963-CODDIVIS          TO WCOM-FILECTRL.                
001746                                                                  
001748     
      *EXEC SQL 
      *SELECT DISTINCT CODDIGTM                                
001749*            INTO :A963-CODDIGTM                                   
001750*            FROM DANAGRAF.TDIVISE                                 
001751*           WHERE CODDIVIS = :A963-CODDIVIS                        
001752*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 12 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A963-CODDIVIS
            BY VALUE 0
                     0

           MOVE 13 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A963-CODDIGTM
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 7 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001753                                                                  
001754     IF SQLCODE = ZERO                                            
001755        MOVE 'U'                 TO PPROUTIN                      
001756        MOVE 'D'                 TO PPTPFILE                      
001757        MOVE 'R'                 TO PPTPOPER                      
001758        MOVE 'DIVISE'            TO PPNMFILE                      
001759        PERFORM Z90-READPRIN                                      
001760           THRU Z90-EX                                            
001761     ELSE                                                         
001762        PERFORM Z00-ERRORE                                        
001763           THRU Z00-EX.                                           
001764                                                                  
001765 L30-EX. EXIT.                                                    
001766*---------------------------------------------------------------- 
001767 L35-CTR-CLAUSOLA.                                                
001768*---------------------------------------------------------------- 
001769                                                                  
001770     MOVE 'L35-'                 TO WCOM-CODABEND.                
001771     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001772     MOVE 'SCORCLAU'             TO WCOM-FILENOME.                
001773     MOVE AB44-CODARTS1          TO WCOM-FILECTRL.                
001774                                                                  
001776     
      *EXEC SQL 
      *SELECT CODARTS1                                        
001777*             INTO :AB44-CODARTS1                                  
001778*             FROM DANAGRAF.VANAGRAF_B44                           
001779*            WHERE CODARTS1 = :AB44-CODARTS1                       
001780*           FETCH FIRST ROW ONLY                                   
001781*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 14 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 20 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE AB44-CODARTS1
            BY VALUE 0
                     0

           MOVE 15 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 20 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE AB44-CODARTS1
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 8 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001782                                                                  
001783     IF SQLCODE = ZERO                                            
001784        MOVE 'U'                 TO PPROUTIN                      
001785        MOVE 'D'                 TO PPTPFILE                      
001786        MOVE 'R'                 TO PPTPOPER                      
001787        MOVE WCOM-FILENOME       TO PPNMFILE                      
001788        PERFORM Z90-READPRIN                                      
001789           THRU Z90-EX.                                           
001790                                                                  
001791 L35-EX. EXIT.                                                    
001792*----------------------------------------------------------------*
001793 L40-SELECT-CONTIDCE.                                             
001794*----------------------------------------------------------------*
001795                                                                  
001796     MOVE 'SELECT'         TO WCOM-FILEFUNZ.                      
001797     MOVE 'CONTIDCE'       TO WCOM-FILENOME.                      
001798     MOVE 'L40-'           TO WCOM-CODABEND.                      
001799     STRING A531-CODSOCIE ' ' C861-CONTODCE                       
001800     DELIMITED BY SIZE   INTO WCOM-FILECTRL.                      
001801                                                                  
001802     MOVE SPACES           TO C861-CONTGRUP                       
001803                              C861-TIPCONTO.                      
001805     
      *EXEC SQL 
      *SELECT T.CONTGRUP, T.TIPCONTO                           
001806*            INTO :C861-CONTGRUP, :C861-TIPCONTO                   
001807*            FROM DCONTCLI.TCONTIDCE    T                          
001808*                ,DANAGRAF.TSOCIETA     S                          
001809*           WHERE S.CODSOCIE = :A531-CODSOCIE                      
001810*             AND T.CODPIANO = S.CODPIANO                          
001811*             AND T.CONTODCE = :C861-CONTODCE                      
001812*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 16 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTODCE
            BY VALUE 0
                     0

           MOVE 17 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTGRUP
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-TIPCONTO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 9 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001813     IF SQLCODE = ZERO                                            
001814        MOVE 'U'                 TO PPROUTIN                      
001815        MOVE 'D'                 TO PPTPFILE                      
001816        MOVE 'R'                 TO PPTPOPER                      
001817        MOVE 'DCE'               TO PPNMFILE                      
001818        PERFORM Z90-READPRIN                                      
001819           THRU Z90-EX.                                           
001820                                                                  
001821 L40-EX. EXIT.                                                    
001822*----------------------------------------------------------------*
001823 L45-SELECT-SCORTDCE.                                             
001824*----------------------------------------------------------------*
001825                                                                  
001826     MOVE 'L45-'                 TO WCOM-CODABEND.                
001827     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001828     MOVE 'SCORTDCE'             TO WCOM-FILENOME.                
001829     MOVE AD22-CONTGRUP          TO WCOM-FILECTRL.                
001830                                                                  
001831     MOVE SPACES                 TO AD22-CDVALSCO.                
001832                                                                  
001834     
      *EXEC SQL 
      *SELECT CDVALSCO                                         
001835*            INTO :AD22-CDVALSCO                                   
001836*            FROM DANAGRAF.VANAGRAF_D22                            
001837*           WHERE CONTGRUP = :AD22-CONTGRUP                        
001838*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 18 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE AD22-CONTGRUP
            BY VALUE 0
                     0

           MOVE 19 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 20 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE AD22-CDVALSCO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 10 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001839                                                                  
001840     IF SQLCODE NOT = 0 AND +100                                  
001841        PERFORM Z00-ERRORE                                        
001842           THRU Z00-EX.                                           
001843                                                                  
001844     IF SQLCODE = ZERO                                            
001845        MOVE 'U'                 TO PPROUTIN                      
001846        MOVE 'D'                 TO PPTPFILE                      
001847        MOVE 'R'                 TO PPTPOPER                      
001848        MOVE 'D22'               TO PPNMFILE                      
001849        PERFORM Z90-READPRIN                                      
001850           THRU Z90-EX.                                           
001851                                                                  
001852 L45-EX. EXIT.                                                    
001853*---------------------------------------------------------------* 
001854 L50-SELECT-STABILIMENTI.                                         
001855*---------------------------------------------------------------* 
001856                                                                  
001857     MOVE 'L50-'                 TO WCOM-CODABEND.                
001858     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001859     MOVE 'STABILIMENTI'         TO WCOM-FILENOME.                
001860     MOVE  A838-STABILIM         TO WCOM-FILECTRL.                
001861                                                                  
001862     MOVE SPACES                 TO A838-CENCOSCO.                
001864     
      *EXEC SQL 
      *SELECT CENCOSCO, CODSOCIE                               
001865*            INTO :A838-CENCOSCO, :A838-CODSOCIE                   
001866*            FROM DANAGRAF.TSTABILIMENTI                           
001867*           WHERE STABILIM = :A838-STABILIM                        
001868*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 20 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A838-STABILIM
            BY VALUE 0
                     0

           MOVE 21 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A838-CENCOSCO
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A838-CODSOCIE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 11 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001869                                                                  
001870     IF SQLCODE NOT = 0 AND +100                                  
001871        PERFORM Z00-ERRORE                                        
001872           THRU Z00-EX.                                           
001873                                                                  
001874     IF SQLCODE = ZERO                                            
001875        MOVE 'U'                 TO PPROUTIN                      
001876        MOVE 'D'                 TO PPTPFILE                      
001877        MOVE 'R'                 TO PPTPOPER                      
001878        MOVE 'STABILIMENTI'      TO PPNMFILE                      
001879        PERFORM Z90-READPRIN                                      
001880           THRU Z90-EX.                                           
001881                                                                  
001882 L50-EX. EXIT.                                                    
001883*----------------------------------------------------------------*
001884 L60-SELECT-CONTPROV.                                             
001885*----------------------------------------------------------------*
001886                                                                  
001887     PERFORM S40-SRDCEP1                                          
001888        THRU S40-EX                                               
001889                                                                  
001890     IF SQLCODE EQUAL +100                                        
001891        STRING  'RENATO : NON TROVATO CONTO DCE  '                
001892                C861-CONTPROV                                     
001893             DELIMITED BY SIZE INTO WCOM-MESSAGES                 
001894        MOVE 'M'                 TO PPROUTIN                      
001895        PERFORM Z90-READPRIN                                      
001896           THRU Z90-EX                                            
001897        MOVE C861-CONTPROV       TO C861-CONTODCE                 
001898     ELSE                                                         
001899        MOVE 'U'                 TO PPROUTIN                      
001900        MOVE 'D'                 TO PPTPFILE                      
001901        MOVE 'R'                 TO PPTPOPER                      
001902        MOVE 'SRDCEP1'           TO PPNMFILE                      
001903        PERFORM Z90-READPRIN                                      
001904           THRU Z90-EX.                                           
001905                                                                  
001906 L60-EX. EXIT.                                                    
001907*----------------------------------------------------------------*
001908 L65-SELECT-TFILATI.                                              
001909*----------------------------------------------------------------*
001910                                                                  
001911     MOVE 'L65-'                 TO WCOM-CODABEND.                
001912     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001913     MOVE 'TFILATI'              TO WCOM-FILENOME.                
001914     MOVE WS-CODARTIC            TO WCOM-FILECTRL.                
001915                                                                  
001916     MOVE SPACES                 TO WS-DESARTIC                   
001917                                    WS-VOCEDOGA.                  
001918     MOVE ZEROES                 TO WS-PESOGRMT                   
001919                                    WS-VOLUMEXX.                  
001921     
      *EXEC SQL 
      *SELECT DESARTFL                                         
001922*                ,CASE WHEN VOCEDOGA > ' '                         
001923*                      THEN LEFT(VOCEDOGA,4)||'-'||                
001924*                           SUBSTR(VOCEDOGA,5,4)||'-00'            
001925*                      ELSE ' '                                    
001926*                  END AS VOCEDOGA                                 
001927*            INTO :WS-DESARTIC, :WS-VOCEDOGA                       
001928*            FROM DANAGRAF.TFILATI                                 
001929*           WHERE CODARTFL = :WS-CODARTIC                          
001930*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 22 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CODARTIC
            BY VALUE 0
                     0

           MOVE 23 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 50 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DESARTIC
            BY VALUE 0
                     0

           MOVE 12 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-VOCEDOGA
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 12 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001931                                                                  
001932     IF SQLCODE NOT = 0 AND +100                                  
001933        PERFORM Z00-ERRORE                                        
001934           THRU Z00-EX.                                           
001935                                                                  
001936     IF SQLCODE = ZERO                                            
001937        MOVE 'U'                 TO PPROUTIN                      
001938        MOVE 'D'                 TO PPTPFILE                      
001939        MOVE 'R'                 TO PPTPOPER                      
001940        MOVE 'TFILATI'           TO PPNMFILE                      
001941        PERFORM Z90-READPRIN                                      
001942           THRU Z90-EX.                                           
001943                                                                  
001944 L65-EX. EXIT.                                                    
001945*----------------------------------------------------------------*
001946 L70-SELECT-TARTIGREG.                                            
001947*----------------------------------------------------------------*
001948                                                                  
001949     MOVE 'L70-'                 TO WCOM-CODABEND.                
001950     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001951     MOVE 'TARTIGREG'            TO WCOM-FILENOME.                
001952     MOVE WS-CODARTIC            TO WCOM-FILECTRL.                
001953                                                                  
001954     MOVE SPACES                 TO WS-DESARTIC                   
001955                                    WS-VOCEDOGA.                  
001956     MOVE ZEROES                 TO WS-PESOGRMT                   
001957                                    WS-VOLUMEXX.                  
001959     
      *EXEC SQL 
      *SELECT DESARTGG                                         
001960*                ,CASE WHEN VOCEDOGA > ' '                         
001961*                      THEN LEFT(VOCEDOGA,4)||'-'||                
001962*                           SUBSTR(VOCEDOGA,5,4)||'-00'            
001963*                      ELSE ' '                                    
001964*                  END AS VOCEDOGA                                 
001965*                ,CASE WHEN :S700-MERCEMAG = 'GS' OR               
001966*                           PESOXPPS = 0                           
001967*                      THEN PESOGREG                               
001968*                      ELSE PESOXPPS                               
001969*                  END AS PESOGRMT                                 
001970*            INTO :WS-DESARTIC, :WS-VOCEDOGA                       
001971*                ,:WS-PESOGRMT                                     
001972*            FROM DANAGRAF.TARTIGREG                               
001973*           WHERE CODARTGG = :WS-CODARTIC                          
001974*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 24 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S700-MERCEMAG
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CODARTIC
            BY VALUE 0
                     0

           MOVE 25 TO SQL-STMT-ID 
           MOVE 3 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 50 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DESARTIC
            BY VALUE 0
                     0

           MOVE 12 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-VOCEDOGA
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-PESOGRMT
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 13 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001975                                                                  
001976     IF SQLCODE NOT = 0 AND +100                                  
001977        PERFORM Z00-ERRORE                                        
001978           THRU Z00-EX.                                           
001979                                                                  
001980     IF SQLCODE = ZERO                                            
001981        MOVE 'U'                 TO PPROUTIN                      
001982        MOVE 'D'                 TO PPTPFILE                      
001983        MOVE 'R'                 TO PPTPOPER                      
001984        MOVE 'TARTIGREG'         TO PPNMFILE                      
001985        PERFORM Z90-READPRIN                                      
001986           THRU Z90-EX.                                           
001987                                                                  
001988 L70-EX. EXIT.                                                    
001989*----------------------------------------------------------------*
001990 L75-SELECT-TARTICOLI.                                            
001991*----------------------------------------------------------------*
001992                                                                  
001993     MOVE 'L75-'                 TO WCOM-CODABEND.                
001994     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001995     MOVE 'TARTICOLI'            TO WCOM-FILENOME.                
001996     MOVE WS-CODARTIC            TO WCOM-FILECTRL.                
001997                                                                  
001998     MOVE SPACES                 TO WS-DESARTIC                   
001999                                    WS-VOCEDOGA.                  
002000     MOVE ZEROES                 TO WS-PESOGRMT                   
002001                                    WS-VOLUMEXX.                  
002003     
      *EXEC SQL 
      *SELECT DESARTFI                                         
002004*                ,CASE WHEN VOCEDOGA > ' '                         
002005*                      THEN LEFT(VOCEDOGA,4)||'-'||                
002006*                           SUBSTR(VOCEDOGA,5,4)||'-00'            
002007*                      ELSE ' '                                    
002008*                  END AS VOCEDOGA                                 
002009*                ,PESOFINI, VOLFINIT                               
002010*            INTO :WS-DESARTIC, :WS-VOCEDOGA                       
002011*                ,:WS-PESOGRMT, :WS-VOLUMEXX                       
002012*            FROM DANAGRAF.TARTICOLI                               
002013*           WHERE CODARTFI = :WS-CODARTIC                          
002014*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 26 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CODARTIC
            BY VALUE 0
                     0

           MOVE 27 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 50 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DESARTIC
            BY VALUE 0
                     0

           MOVE 12 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-VOCEDOGA
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-PESOGRMT
            BY VALUE 0
                     0

           MOVE 772 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-VOLUMEXX
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 14 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002015                                                                  
002016     IF SQLCODE NOT = 0 AND +100                                  
002017        PERFORM Z00-ERRORE                                        
002018           THRU Z00-EX.                                           
002019                                                                  
002020     IF SQLCODE = ZERO                                            
002021        MOVE 'U'                 TO PPROUTIN                      
002022        MOVE 'D'                 TO PPTPFILE                      
002023        MOVE 'R'                 TO PPTPOPER                      
002024        MOVE 'TARTICOLI'         TO PPNMFILE                      
002025        PERFORM Z90-READPRIN                                      
002026           THRU Z90-EX.                                           
002027                                                                  
002028 L75-EX. EXIT.                                                    
002029*----------------------------------------------------------------*
002030 L80-SELECT-TUTENTI.                                              
002031*----------------------------------------------------------------*
002032                                                                  
002033     MOVE 'L80-'                 TO WCOM-CODABEND.                
002034     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002035     MOVE 'TUTENTI'              TO WCOM-FILENOME.                
002036     MOVE A845-CODUTENT          TO WCOM-FILECTRL.                
002037                                                                  
002038     MOVE SPACES                 TO A845-NOMUTENT.                
002039                                                                  
002041     
      *EXEC SQL 
      *SELECT NOMUTENT                                         
002042*            INTO :A845-NOMUTENT                                   
002043*            FROM DANAGRAF.TUTENTI                                 
002044*           WHERE CODUTENT = :A845-CODUTENT                        
002045*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 28 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A845-CODUTENT
            BY VALUE 0
                     0

           MOVE 29 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 20 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A845-NOMUTENT
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 15 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002046                                                                  
002047     IF SQLCODE NOT = 0 AND +100                                  
002048        PERFORM Z00-ERRORE                                        
002049           THRU Z00-EX.                                           
002050                                                                  
002051     IF SQLCODE = ZERO                                            
002052        MOVE 'U'                 TO PPROUTIN                      
002053        MOVE 'D'                 TO PPTPFILE                      
002054        MOVE 'R'                 TO PPTPOPER                      
002055        MOVE 'TUTENTI'           TO PPNMFILE                      
002056        PERFORM Z90-READPRIN                                      
002057           THRU Z90-EX.                                           
002058                                                                  
002059 L80-EX. EXIT.                                                    
002060*----------------------------------------------------------------*
002061 L90-SELECT-BUYER.                                                
002062*----------------------------------------------------------------*
002063                                                                  
002064     MOVE 'L90-'                 TO WCOM-CODABEND.                
002065     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002066     MOVE 'BUYER'                TO WCOM-FILENOME.                
002067     MOVE AD99-CODBUYER          TO WCOM-FILECTRL.                
002068                                                                  
002069     MOVE SPACES                 TO AD99-BUYERGTM                 
002071     
      *EXEC SQL 
      *SELECT BUYERGTM                                         
002072*            INTO :AD99-BUYERGTM                                   
002073*            FROM DANAGRAF.VANAGRAF_D99                            
002074*           WHERE CODBUYER = :AD99-CODBUYER                        
002075*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 30 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE AD99-CODBUYER
            BY VALUE 0
                     0

           MOVE 31 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 20 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE AD99-BUYERGTM
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 16 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002076                                                                  
002077     IF SQLCODE NOT = 0 AND +100                                  
002078        PERFORM Z00-ERRORE                                        
002079           THRU Z00-EX.                                           
002080                                                                  
002081     IF SQLCODE = ZERO                                            
002082        MOVE 'U'                 TO PPROUTIN                      
002083        MOVE 'D'                 TO PPTPFILE                      
002084        MOVE 'R'                 TO PPTPOPER                      
002085        MOVE 'BUYER'             TO PPNMFILE                      
002086        PERFORM Z90-READPRIN                                      
002087           THRU Z90-EX.                                           
002088                                                                  
002089 L90-EX. EXIT.                                                    
002090*----------------------------------------------------------------*
002091 L94-SELECT-TORDISCORN-COMMESSA.                                  
002092*----------------------------------------------------------------*
002093                                                                  
002094     MOVE 'L94-'                 TO WCOM-CODABEND.                
002095     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002096     MOVE 'ORDISCORN'            TO WCOM-FILENOME.                
002097     MOVE S478-AANUMORD          TO WCOM-FILECTRL.                
002098                                                                  
002099     MOVE SPACES                 TO S478-NRCOMMES                 
002101     
      *EXEC SQL 
      *SELECT NRCOMMES                                         
002102*            INTO :S478-NRCOMMES                                   
002103*            FROM DSCORTE.TORDISCORN                               
002104*           WHERE AANUMORD = :S478-AANUMORD                        
002105*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 32 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-AANUMORD
            BY VALUE 0
                     0

           MOVE 33 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-NRCOMMES
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 17 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002106                                                                  
002107     IF SQLCODE NOT = 0 AND +100                                  
002108        PERFORM Z00-ERRORE                                        
002109           THRU Z00-EX.                                           
002110                                                                  
002111     IF SQLCODE = ZERO                                            
002112        MOVE 'U'                 TO PPROUTIN                      
002113        MOVE 'D'                 TO PPTPFILE                      
002114        MOVE 'R'                 TO PPTPOPER                      
002115        MOVE WCOM-FILENOME       TO PPNMFILE                      
002116        PERFORM Z90-READPRIN                                      
002117           THRU Z90-EX.                                           
002118                                                                  
002119 L94-EX. EXIT.                                                    
002120*----------------------------------------------------------------*
002121 L95-SELECT-TESTATA.                                              
002122*----------------------------------------------------------------*
002123                                                                  
002124     MOVE 'L95-'                 TO WCOM-CODABEND.                
002125     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002126     MOVE 'HEADER'               TO WCOM-FILENOME.                
002127     MOVE S005-ODA-CICS          TO WCOM-FILECTRL.                
002128                                                                  
002129**** IL CAMPO CONTIENE '00000' SE NON TROVATO TESTATA             
002130****                   '     ' SE TROVATO TESTATA                 
002131****       ELSE <> DA ' ' E '00000' VUOL DIRE CHE ESISTONO RIGHE  
002132****                                DI MODIFICA                   
002133                                                                  
002134     MOVE ZEROES                 TO S005-MOD-PROGR-NUM            
002136     
      *EXEC SQL 
      *SELECT VALUE(MAX(MOD_PROGR_NUM) ,'00000')               
002137*            INTO :S005-MOD-PROGR-NUM                              
002138*            FROM DBGTM.SAP_ORDACQ_HEADER                          
002139*           WHERE ODA_CICS = :S005-ODA-CICS                        
002140*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 34 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-ODA-CICS
            BY VALUE 0
                     0

           MOVE 35 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-MOD-PROGR-NUM
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 18 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002141                                                                  
002142     IF SQLCODE NOT = 0 AND +100                                  
002143        PERFORM Z00-ERRORE                                        
002144           THRU Z00-EX.                                           
002145                                                                  
002146     IF SQLCODE = ZERO                                            
002147        MOVE 'U'                 TO PPROUTIN                      
002148        MOVE 'D'                 TO PPTPFILE                      
002149        MOVE 'R'                 TO PPTPOPER                      
002150        MOVE WCOM-FILENOME       TO PPNMFILE                      
002151        PERFORM Z90-READPRIN                                      
002152           THRU Z90-EX.                                           
002153                                                                  
002154 L95-EX. EXIT.                                                    
002155*----------------------------------------------------------------*
002156 L96-SELECT-TESTATA.                                              
002157*----------------------------------------------------------------*
002158                                                                  
002159     MOVE 'L96-'                 TO WCOM-CODABEND.                
002160     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002161     MOVE 'HEADER'               TO WCOM-FILENOME.                
002162     MOVE S005-ODA-CICS          TO WCOM-FILECTRL.                
002163                                                                  
002165     
      *EXEC SQL 
      *SELECT CRT_ST                                           
002166*            INTO :S005-CRT-ST                                     
002167*            FROM DBGTM.SAP_ORDACQ_HEADER                          
002168*           WHERE ODA_CICS = :S005-ODA-CICS                        
002169*             AND CRT_ST  IN ('IN','--')                           
002170*           FETCH FIRST ROW ONLY                                   
002171*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 36 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-ODA-CICS
            BY VALUE 0
                     0

           MOVE 37 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-CRT-ST
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 19 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002172                                                                  
002173     IF SQLCODE = ZERO                                            
002174        MOVE 'U'                 TO PPROUTIN                      
002175        MOVE 'D'                 TO PPTPFILE                      
002176        MOVE 'R'                 TO PPTPOPER                      
002177        MOVE WCOM-FILENOME       TO PPNMFILE                      
002178        PERFORM Z90-READPRIN                                      
002179           THRU Z90-EX.                                           
002180                                                                  
002181 L96-EX. EXIT.                                                    
002182*----------------------------------------------------------------*
002183 L97-SELECT-TESTATA.                                              
002184*----------------------------------------------------------------*
002185                                                                  
002186     MOVE 'L97-'                 TO WCOM-CODABEND.                
002187     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002188     MOVE 'HEADER'               TO WCOM-FILENOME.                
002189     MOVE S005-ODA-CICS          TO WCOM-FILECTRL.                
002190                                                                  
002192     
      *EXEC SQL 
      *SELECT CRT_ST                                           
002193*            INTO :S005-CRT-ST                                     
002194*            FROM DBGTM.SAP_ORDACQ_HEADER                          
002195*           WHERE ODA_CICS = :S005-ODA-CICS                        
002196*             AND CRT_ST   = '--'                                  
002197*           FETCH FIRST ROW ONLY                                   
002198*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 38 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-ODA-CICS
            BY VALUE 0
                     0

           MOVE 39 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-CRT-ST
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 20 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002199                                                                  
002200     IF SQLCODE = ZERO                                            
002201        MOVE 'U'                 TO PPROUTIN                      
002202        MOVE 'D'                 TO PPTPFILE                      
002203        MOVE 'R'                 TO PPTPOPER                      
002204        MOVE WCOM-FILENOME       TO PPNMFILE                      
002205        PERFORM Z90-READPRIN                                      
002206           THRU Z90-EX.                                           
002207                                                                  
002208 L97-EX. EXIT.                                                    
002209*----------------------------------------------------------------*
002210 L110-SELECT-FORNITORI.                                           
002211*----------------------------------------------------------------*
002212                                                                  
002213     MOVE 'L110'                 TO WCOM-CODABEND.                
002214     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002215     MOVE 'FORNITORI'            TO WCOM-FILENOME.                
002216     MOVE S009-SEARCHTERM1       TO WCOM-FILECTRL.                
002217                                                                  
002218     MOVE SPACES                 TO S009-VEND-CODE                
002219                                    S009-COUNTRYISO.              
002220                                                                  
002222     
      *EXEC SQL 
      *SELECT X.VEND_CODE,X.COUNTRYISO                         
002223*            INTO :S009-VEND-CODE,:S009-COUNTRYISO                 
002224*          FROM                                                    
002225*          (                                                       
002226*          SELECT '1',VEND_CODE,COUNTRYISO,DTA_INS                 
002227*            FROM MDHUB.SAP_FORNITORI_GENERAL                      
002228*           WHERE SEARCHTERM1 = :S009-SEARCHTERM1                  
002229*           UNION                                                  
002230*           SELECT '2',A.VEND_CODE,A.COUNTRYISO,A.DTA_INS          
002231*           FROM MDHUB.SAP_FORNITORI_GENERAL A,                    
002232*                MDHUB.SAP_FORNITORI_COMPANY B                     
002233*           WHERE B.ALTKN = :S009-SEARCHTERM1                      
002234*             AND B.BUKRS = :S005-COMP-CODE                        
002235*             AND A.VEND_CODE = B.VEND_CODE                        
002236*           ORDER BY 1,4 DESC                                      
002237*             ) AS X                                               
002238*             FETCH FIRST 1 ROW ONLY                               
002239*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 40 TO SQL-STMT-ID 
           MOVE 3 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S009-SEARCHTERM1
            BY VALUE 0
                     0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S009-SEARCHTERM1
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-COMP-CODE
            BY VALUE 0
                     0

           MOVE 41 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S009-VEND-CODE
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S009-COUNTRYISO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 21 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002240                                                                  
002241     IF SQLCODE = 100                                             
002242        MOVE SPACES              TO S009-VEND-CODE                
002243        STRING '--' S009-SEARCHTERM1                              
002244           DELIMITED BY SIZE  INTO S009-VEND-CODE                 
002245        MOVE '--'                TO WS-NOSAPXXX                   
002246        STRING 'RENATO : FORNITORE NON TROVATO : '                
002247               S009-SEARCHTERM1                                   
002248           DELIMITED BY SIZE INTO PPMESSAG                        
002249        MOVE 'M'                TO PPROUTIN                       
002250        PERFORM Z90-READPRIN                                      
002251           THRU Z90-EX                                            
002252     ELSE                                                         
002253        MOVE 'U'                 TO PPROUTIN                      
002254        MOVE 'D'                 TO PPTPFILE                      
002255        MOVE 'R'                 TO PPTPOPER                      
002256        MOVE WCOM-FILENOME       TO PPNMFILE                      
002257        PERFORM Z90-READPRIN                                      
002258           THRU Z90-EX.                                           
002259                                                                  
002260 L110-EX. EXIT.                                                   
002261*----------------------------------------------------------------*
002262 L120-SELECT-DIVISE.                                              
002263*----------------------------------------------------------------*
002264                                                                  
002265     MOVE 'L120-'                TO WCOM-CODABEND.                
002266     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002267     MOVE 'DIVISE'               TO WCOM-FILENOME.                
002268     MOVE A963-CODDIGTM          TO WCOM-FILECTRL.                
002269                                                                  
002271     
      *EXEC SQL 
      *SELECT SLDIVBAN                                         
002272*            INTO :A963-SLDIVBAN                                   
002273*            FROM DANAGRAF.TDIVISE                                 
002274*           WHERE CODDIGTM = :A963-CODDIGTM                        
002275*             AND CODDIVRI = '75'                                  
002276*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 42 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A963-CODDIGTM
            BY VALUE 0
                     0

           MOVE 43 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A963-SLDIVBAN
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 22 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002277                                                                  
002278     IF SQLCODE = +0                                              
002279        MOVE 'U'                 TO PPROUTIN                      
002280        MOVE 'D'                 TO PPTPFILE                      
002281        MOVE 'R'                 TO PPTPOPER                      
002282        MOVE WCOM-FILENOME       TO PPNMFILE                      
002283        PERFORM Z90-READPRIN                                      
002284           THRU Z90-EX                                            
002285     ELSE                                                         
002286        PERFORM Z00-ERRORE                                        
002287           THRU Z00-EX.                                           
002288                                                                  
002289 L120-EX. EXIT.                                                   
002290*---------------------------------------------------------------- 
002291 L130-SELECT-CODIRESA.                                            
002292*---------------------------------------------------------------- 
002293                                                                  
002294     MOVE 'L30-'                 TO WCOM-CODABEND.                
002295     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002296     MOVE 'RESAMERC'             TO WCOM-FILENOME.                
002297     MOVE  A113-CODIRESA         TO WCOM-FILECTRL.                
002298                                                                  
002300     
      *EXEC SQL 
      *SELECT CONDRESA                                         
002301*            INTO :A113-CONDRESA                                   
002302*            FROM DANAGRAF.VANAGRAF_113                            
002303*           WHERE CODIRESA = :A113-CODIRESA                        
002304*             AND CODILING = 'I'                                   
002305*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 44 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A113-CODIRESA
            BY VALUE 0
                     0

           MOVE 45 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 20 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A113-CONDRESA
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 23 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002306                                                                  
002307     IF SQLCODE = ZERO                                            
002308        MOVE 'U'                 TO PPROUTIN                      
002309        MOVE 'D'                 TO PPTPFILE                      
002310        MOVE 'R'                 TO PPTPOPER                      
002311        MOVE WCOM-FILENOME       TO PPNMFILE                      
002312        PERFORM Z90-READPRIN                                      
002313           THRU Z90-EX                                            
002314     ELSE                                                         
002315        PERFORM Z00-ERRORE                                        
002316           THRU Z00-EX.                                           
002317                                                                  
002318 L130-EX. EXIT.                                                   
002319*---------------------------------------------------------------- 
002320 L140-SELECT-SAPCCOS.                                             
002321*---------------------------------------------------------------- 
002322                                                                  
002323     MOVE 'L140'                 TO WCOM-CODABEND.                
002324     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002325     MOVE 'SAP_CCOS'             TO WCOM-FILENOME.                
002326     MOVE SPACES                 TO WCOM-FILECTRL.                
002327     STRING S001-SOCI ' ' S001-CCOSGTM                            
002328            DELIMITED BY SIZE  INTO WCOM-FILECTRL.                
002329                                                                  
002330     MOVE SPACES                 TO S001-CCOSSAP                  
002331                                    S001-PROFIT-CENTER.           
002332                                                                  
002334     
      *EXEC SQL 
      *SELECT CCOSSAP, PROFIT_CENTER                           
002335*            INTO :S001-CCOSSAP, :S001-PROFIT-CENTER               
002336*            FROM (SELECT '1', CCOSSAP, PROFIT_CENTER              
002337*                    FROM MDHUB.SAP_CCOS                           
002338*                   WHERE SOCI    = :S001-SOCI                     
002339*                     AND DIPAR   = :S001-DIPAR                    
002340*                     AND CCOSGTM = :S001-CCOSGTM                  
002341*                     AND SUBSTR(CCOSSAP , 8 , 2) = 'ZZ'           
002342*                 UNION ALL                                        
002343*                  SELECT '2', CCOSSAP,PROFIT_CENTER               
002344*                    FROM MDHUB.SAP_CCOS                           
002345*                   WHERE SOCI    = :S001-SOCI                     
002346*                     AND DIPAR   = :S001-DIPAR                    
002347*                     AND CCOSGTM = :S001-CCOSGTM                  
002348*                     AND SUBSTR(CCOSSAP , 8 , 2) <> 'ZZ'          
002349*                  ORDER BY 1 , 2) AS X                            
002350*             FETCH FIRST 1 ROW ONLY                               
002351*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 46 TO SQL-STMT-ID 
           MOVE 6 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S001-SOCI
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S001-DIPAR
            BY VALUE 0
                     0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S001-CCOSGTM
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S001-SOCI
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S001-DIPAR
            BY VALUE 0
                     0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S001-CCOSGTM
            BY VALUE 0
                     0

           MOVE 47 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 20 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S001-CCOSSAP
            BY VALUE 0
                     0

           MOVE 20 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S001-PROFIT-CENTER
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 24 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002352                                                                  
002353     IF SQLCODE = +0                                              
002354        MOVE 'U'                 TO PPROUTIN                      
002355        MOVE 'D'                 TO PPTPFILE                      
002356        MOVE 'R'                 TO PPTPOPER                      
002357        MOVE WCOM-FILENOME       TO PPNMFILE                      
002358        PERFORM Z90-READPRIN                                      
002359           THRU Z90-EX                                            
002360     ELSE                                                         
002361        IF SQLCODE = +100                                         
002362           MOVE SPACES             TO S001-CCOSSAP                
002363           STRING  '--' S001-CCOSGTM                              
002364              DELIMITED BY SIZE  INTO S001-CCOSSAP                
002365           MOVE '--'               TO WS-NOSAPXXX                 
002366           MOVE SPACES             TO PPMESSAG                    
002367           STRING 'RENATO: C.COSTO NON TROVATO: '                 
002368                   S001-CCOSGTM ' 'S001-SOCI ' ' S001-DIPAR       
002369              DELIMITED BY SIZE  INTO PPMESSAG                    
002370           MOVE 'M'                TO PPROUTIN                    
002371           PERFORM Z90-READPRIN                                   
002372              THRU Z90-EX.                                        
002373                                                                  
002374 L140-EX. EXIT.                                                   
002375*----------------------------------------------------------------*
002376 L142-SELECT-CONTIDCE.                                            
002377*----------------------------------------------------------------*
002378                                                                  
002379     MOVE 'SELECT'         TO WCOM-FILEFUNZ.                      
002380     MOVE 'CONTIDCE'       TO WCOM-FILENOME.                      
002381     MOVE 'L142'           TO WCOM-CODABEND.                      
002382     STRING A531-SOCIEGTM ' ' C861-CONTODCE                       
002383     DELIMITED BY SIZE   INTO WCOM-FILECTRL.                      
002384                                                                  
002385     MOVE SPACES           TO C861-CONTGRUP                       
002386                              C861-TIPCONTO.                      
002388     
      *EXEC SQL 
      *SELECT T.CONTGRUP, T.TIPCONTO                           
002389*            INTO :C861-CONTGRUP, :C861-TIPCONTO                   
002390*            FROM DCONTCLI.TCONTIDCE    T                          
002391*                ,DANAGRAF.TSOCIETA     S                          
002392*           WHERE S.SOCIEGTM = :A531-SOCIEGTM                      
002393*             AND T.CODPIANO = S.CODPIANO                          
002394*             AND T.CONTODCE = :C861-CONTODCE                      
002395*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 48 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-SOCIEGTM
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTODCE
            BY VALUE 0
                     0

           MOVE 49 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTGRUP
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-TIPCONTO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 25 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002396     IF SQLCODE = ZERO                                            
002397        MOVE 'U'                 TO PPROUTIN                      
002398        MOVE 'D'                 TO PPTPFILE                      
002399        MOVE 'R'                 TO PPTPOPER                      
002400        MOVE 'DCE'               TO PPNMFILE                      
002401        PERFORM Z90-READPRIN                                      
002402           THRU Z90-EX.                                           
002403                                                                  
002404 L142-EX. EXIT.                                                   
002405*---------------------------------------------------------------- 
002406 L145-SELECT-MATGRPCONTI.                                         
002407*---------------------------------------------------------------- 
002408                                                                  
002409     MOVE 'L145'                 TO WCOM-CODABEND.                
002410     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002411     MOVE 'PIANOCONTI'           TO WCOM-FILENOME.                
002412     MOVE S013-CDCE-GTM          TO WCOM-FILECTRL.                
002413                                                                  
002414     MOVE SPACES                 TO S012-CONTO-COGE               
002415                                                                  
002416     MOVE SPACES                 TO WS-SOCIEGTM                   
002417     IF FSGT-SOCIETAN = 'CT'                                      
002418        MOVE 'CT'                TO WS-SOCIEGTM.                  
002419     IF FSGT-SOCIETAN = 'DQ'                                      
002420        MOVE 'DQ'                TO WS-SOCIEGTM.                  
002421     IF FSGT-SOCIETAN = '0L'                                      
002422        MOVE '0L'                TO WS-SOCIEGTM.                  
002423     IF FSGT-SOCIETAN = '0J'                                      
002424        MOVE '0J'                TO WS-SOCIEGTM.                  
002425                                                                  
002427     
      *EXEC SQL 
      *SELECT DISTINCT CDCE_SAP                                
002428*            INTO :S012-CONTO-COGE                                 
002429*            FROM DBGTM.SAP_MATGRP_CONTI                           
002430*           WHERE (CDCE_GTM = :S013-CDCE-GTM AND                   
002431*                  :WS-SOCIEGTM = ' '            )                 
002432*              OR (CDCE_CT  = :S013-CDCE-GTM AND                   
002433*                  :WS-SOCIEGTM = 'CT'           )                 
002434*              OR (CDCE_DQ  = :S013-CDCE-GTM AND                   
002435*                  :WS-SOCIEGTM = 'DQ'           )                 
002436*              OR (CDCE_0L  = :S013-CDCE-GTM AND                   
002437*                  :WS-SOCIEGTM = '0L'           )                 
002438*              OR (CDCE_0J  = :S013-CDCE-GTM AND                   
002439*                  :WS-SOCIEGTM = '0J'           )                 
002440*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 50 TO SQL-STMT-ID 
           MOVE 10 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S013-CDCE-GTM
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-SOCIEGTM
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S013-CDCE-GTM
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-SOCIEGTM
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S013-CDCE-GTM
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-SOCIEGTM
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S013-CDCE-GTM
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-SOCIEGTM
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S013-CDCE-GTM
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-SOCIEGTM
            BY VALUE 0
                     0

           MOVE 51 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 20 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S012-CONTO-COGE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 26 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002441                                                                  
002442     IF SQLCODE = +0                                              
002443        MOVE 'U'                 TO PPROUTIN                      
002444        MOVE 'D'                 TO PPTPFILE                      
002445        MOVE 'R'                 TO PPTPOPER                      
002446        MOVE WCOM-FILENOME       TO PPNMFILE                      
002447        PERFORM Z90-READPRIN                                      
002448           THRU Z90-EX                                            
002449     ELSE                                                         
002450        IF SQLCODE = +100                                         
002451           MOVE SPACES            TO S012-CONTO-COGE              
002452           STRING '--' S013-CDCE-GTM                              
002453              DELIMITED BY SIZE INTO S012-CONTO-COGE              
002454           MOVE '--'              TO WS-NOSAPXXX                  
002455           MOVE SPACES            TO PPMESSAG                     
002456           STRING 'RENATO: CONTO DCE NON TROVATO: '               
002457                   S013-CDCE-GTM ' ' C861-TIPCONTO                
002458              DELIMITED BY SIZE INTO PPMESSAG                     
002459           MOVE 'M'               TO PPROUTIN                     
002460           PERFORM Z90-READPRIN                                   
002461              THRU Z90-EX.                                        
002462                                                                  
002463 L145-EX. EXIT.                                                   
002464*---------------------------------------------------------------- 
002465 L150-SELECT-PIANOCONTI.                                          
002466*---------------------------------------------------------------- 
002467                                                                  
002468     MOVE 'L150'                 TO WCOM-CODABEND.                
002469     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002470     MOVE 'PIANOCONTI'           TO WCOM-FILENOME.                
002471     MOVE SPACES                 TO WCOM-FILECTRL.                
002472     STRING S012-CDCE-GTM ' ' S012-SOCI ' ' C861-TIPCONTO         
002473            DELIMITED BY SIZE  INTO WCOM-FILECTRL.                
002474                                                                  
002475     MOVE SPACES                 TO S012-CONTO-COGE               
002476                                                                  
002478     
      *EXEC SQL 
      *SELECT CONTO_COGE                                       
002479*            INTO :S012-CONTO-COGE                                 
002480*            FROM MDHUB.SAP_PIANO_CONTI                            
002481*           WHERE SOCI    = :S012-SOCI                             
002482*             AND CDCE_GTM= :S012-CDCE-GTM                         
002483*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 52 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S012-SOCI
            BY VALUE 0
                     0

           MOVE 20 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S012-CDCE-GTM
            BY VALUE 0
                     0

           MOVE 53 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 20 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S012-CONTO-COGE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 27 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002484                                                                  
002485     IF SQLCODE = +0                                              
002486        MOVE 'U'                 TO PPROUTIN                      
002487        MOVE 'D'                 TO PPTPFILE                      
002488        MOVE 'R'                 TO PPTPOPER                      
002489        MOVE WCOM-FILENOME       TO PPNMFILE                      
002490        PERFORM Z90-READPRIN                                      
002491           THRU Z90-EX                                            
002492     ELSE                                                         
002493        IF SQLCODE = +100                                         
002494           MOVE SPACES            TO S012-CONTO-COGE              
002495           STRING '--' S012-CDCE-GTM                              
002496              DELIMITED BY SIZE INTO S012-CONTO-COGE              
002497           MOVE '--'              TO WS-NOSAPXXX                  
002498           MOVE SPACES            TO PPMESSAG                     
002499           STRING 'RENATO: CONTO DCE NON TROVATO: '               
002500                   S012-CDCE-GTM ' ' S012-SOCI ' ' C861-TIPCONTO  
002501              DELIMITED BY SIZE INTO PPMESSAG                     
002502           MOVE 'M'               TO PPROUTIN                     
002503           PERFORM Z90-READPRIN                                   
002504              THRU Z90-EX.                                        
002505                                                                  
002506 L150-EX. EXIT.                                                   
002507*---------------------------------------------------------------- 
002508 L160-SELECT-COMMESSE.                                            
002509*---------------------------------------------------------------- 
002510                                                                  
002511     MOVE FSGT-SOCIETAN          TO S011-SOCI                     
002512     MOVE SPACES                 TO S011-ELEMENTO-WBS             
002513     IF S478-NRCOMMES(1:2) = 'C_' OR 'O_'                         
002514        MOVE S478-NRCOMMES       TO S011-ELEMENTO-WBS             
002515     ELSE                                                         
002516        IF C861-TIPCONTO = '54'                                   
002517           STRING 'C_' S478-NRCOMMES                              
002518              DELIMITED BY SIZE  INTO S011-ELEMENTO-WBS           
002519        ELSE                                                      
002520           STRING 'O_' S478-NRCOMMES                              
002521              DELIMITED BY SIZE  INTO S011-ELEMENTO-WBS.          
002522                                                                  
002523     INSPECT S011-ELEMENTO-WBS REPLACING ALL SPACES BY '%'        
002524     INSPECT S011-ELEMENTO-WBS REPLACING ALL LOW-VALUE BY '%'     
002525                                                                  
002526     MOVE 'L160-'                TO WCOM-CODABEND.                
002527     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002528     MOVE 'COMMESSE'             TO WCOM-FILENOME.                
002529     MOVE SPACES                 TO WCOM-FILECTRL.                
002530     STRING S011-SOCI  ' ' S011-ELEMENTO-WBS                      
002531            DELIMITED BY SIZE  INTO WCOM-FILECTRL.                
002532                                                                  
002533     MOVE SPACES                 TO WS-ELEMENTO-WBS               
002534                                                                  
002536     
      *EXEC SQL 
      *SELECT ELEMENTO_WBS                                     
002537*            INTO :WS-ELEMENTO-WBS                                 
002538*            FROM MDHUB.SAP_COMMESSE                               
002539*           WHERE SOCI    = :S011-SOCI                             
002540*             AND LIVELLO = '002'                                  
002541*             AND ELEMENTO_WBS LIKE :S011-ELEMENTO-WBS             
002542*             FETCH FIRST 1 ROW ONLY                               
002543*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 54 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S011-SOCI
            BY VALUE 0
                     0

           MOVE 48 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S011-ELEMENTO-WBS
            BY VALUE 0
                     0

           MOVE 55 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 50 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-ELEMENTO-WBS
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 28 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002544                                                                  
002545     IF SQLCODE = +0                                              
002546        MOVE 'U'                 TO PPROUTIN                      
002547        MOVE 'D'                 TO PPTPFILE                      
002548        MOVE 'R'                 TO PPTPOPER                      
002549        MOVE WCOM-FILENOME       TO PPNMFILE                      
002550        PERFORM Z90-READPRIN                                      
002551           THRU Z90-EX                                            
002552     ELSE                                                         
002553        IF SQLCODE = +100                                         
002554           MOVE SPACES           TO WS-ELEMENTO-WBS               
002555           IF C861-TIPCONTO = '54'                                
002556              STRING '--' S011-ELEMENTO-WBS                       
002557                 DELIMITED BY SIZE  INTO WS-ELEMENTO-WBS          
002558              MOVE '--'               TO WS-NOSAPXXX              
002559              MOVE SPACES             TO PPMESSAG                 
002560              STRING 'RENATO: COMMESSA NON TROVATA: '             
002561                      S011-ELEMENTO-WBS                           
002562                 DELIMITED BY SIZE  INTO PPMESSAG                 
002563           ELSE                                                   
002564              MOVE SPACES             TO PPMESSAG                 
002565              STRING 'RENATO: FORZATO SPACES COMMESSA : '         
002566                      S011-ELEMENTO-WBS ' '                       
002567                      ' ORDINE : ' WS-ODACICS                     
002568                 DELIMITED BY SIZE  INTO PPMESSAG                 
002569           END-IF                                                 
002570           MOVE 'M'                   TO PPROUTIN                 
002571           PERFORM Z90-READPRIN                                   
002572              THRU Z90-EX.                                        
002573                                                                  
002574 L160-EX. EXIT.                                                   
002575*---------------------------------------------------------------- 
002576 L170-SELECT-ITEM.                                                
002577*---------------------------------------------------------------- 
002578                                                                  
002579     MOVE 'L170'                 TO WCOM-CODABEND.                
002580     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002581     MOVE 'ITEM'                 TO WCOM-FILENOME.                
002582     MOVE SPACES                 TO WCOM-FILECTRL.                
002583     STRING S006-ODA-CICS-ITEMTABLE ' '                           
002584            S006-CICS-PO-ITEM-ITEMTABLE                           
002585            DELIMITED BY SIZE  INTO WCOM-FILECTRL.                
002586                                                                  
002587     MOVE SPACES                 TO S006-PO-ITEM                  
002588                                    S006-PLANT.                   
002589                                                                  
002591     
      *EXEC SQL 
      *SELECT PO_ITEM, PLANT                                   
002592*            INTO :S006-PO-ITEM, :S006-PLANT                       
002593*            FROM DBGTM.SAP_ORDACQ_ITEM                            
002594*           WHERE ODA_CICS_ITEMTABLE= :S006-ODA-CICS-ITEMTABLE     
002595*             AND CICS_PO_ITEM_ITEMTABLE =                         
002596*                      :S006-CICS-PO-ITEM-ITEMTABLE                
002597*                                                                  
002598*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 56 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-ODA-CICS-ITEMTABLE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-CICS-PO-ITEM-ITEMTABLE
            BY VALUE 0
                     0

           MOVE 57 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-PO-ITEM
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-PLANT
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 29 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002599                                                                  
002600     IF SQLCODE = +0                                              
002601        MOVE 'U'                 TO PPROUTIN                      
002602        MOVE 'D'                 TO PPTPFILE                      
002603        MOVE 'R'                 TO PPTPOPER                      
002604        MOVE WCOM-FILENOME       TO PPNMFILE                      
002605        PERFORM Z90-READPRIN                                      
002606           THRU Z90-EX.                                           
002607                                                                  
002608 L170-EX. EXIT.                                                   
002609*---------------------------------------------------------------- 
002610 L171-SELECT-MAX-ITEM.                                            
002611*---------------------------------------------------------------- 
002612                                                                  
002613     MOVE 'L171'                 TO WCOM-CODABEND.                
002614     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002615     MOVE 'ITEM'                 TO WCOM-FILENOME.                
002616     MOVE SPACES                 TO WCOM-FILECTRL.                
002617     STRING S006-ODA-CICS-ITEMTABLE ' '                           
002618            S006-CICS-PO-ITEM-ITEMTABLE                           
002619            DELIMITED BY SIZE  INTO WCOM-FILECTRL.                
002620                                                                  
002621     MOVE ZEROES                 TO WS-PO-ITEMX                   
002623     
      *EXEC SQL 
      *SELECT VALUE(MAX(PO_ITEM) ,'00000')                     
002624*                ,VALUE(MAX(CICS_PO_ITEM_ITEMTABLE) ,'000')        
002625*            INTO :WS-PO-ITEMX                                     
002626*                ,:WS-NRRIGORDX                                    
002627*            FROM DBGTM.SAP_ORDACQ_ITEM                            
002628*           WHERE ODA_CICS_ITEMTABLE= :S006-ODA-CICS-ITEMTABLE     
002629*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 58 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-ODA-CICS-ITEMTABLE
            BY VALUE 0
                     0

           MOVE 59 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-PO-ITEMX
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-NRRIGORDX
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 30 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002630                                                                  
002631     IF SQLCODE = +0                                              
002632        MOVE 'U'                 TO PPROUTIN                      
002633        MOVE 'D'                 TO PPTPFILE                      
002634        MOVE 'R'                 TO PPTPOPER                      
002635        MOVE WCOM-FILENOME       TO PPNMFILE                      
002636        PERFORM Z90-READPRIN                                      
002637           THRU Z90-EX.                                           
002638                                                                  
002639 L171-EX. EXIT.                                                   
002640*----------------------------------------------------------------*
002641 L180-SELECT-EM.                                                  
002642*----------------------------------------------------------------*
002643                                                                  
002644     MOVE 'L180'                 TO WCOM-CODABEND.                
002645     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002646     MOVE 'EM'                   TO WCOM-FILENOME.                
002647     MOVE SPACES                 TO WCOM-FILECTRL.                
002648     STRING S008-ODA-CICS ' ' S008-CICS-PO-ITEM                   
002649        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
002650                                                                  
002651     MOVE ZEROES                 TO S008-CRT-PROGR-NUM            
002653     
      *EXEC SQL 
      *SELECT VALUE(MAX(CRT_PROGR_NUM) ,'00000')               
002654*            INTO :S008-CRT-PROGR-NUM                              
002655*            FROM DBGTM.SAP_ORDACQ_EM                              
002656*           WHERE ODA_CICS = :S008-ODA-CICS                        
002657*             AND CICS_PO_ITEM = :S008-CICS-PO-ITEM                
002658*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 60 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S008-ODA-CICS
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S008-CICS-PO-ITEM
            BY VALUE 0
                     0

           MOVE 61 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S008-CRT-PROGR-NUM
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 31 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002659                                                                  
002660     IF SQLCODE NOT = 0 AND +100                                  
002661        PERFORM Z00-ERRORE                                        
002662           THRU Z00-EX.                                           
002663                                                                  
002664     IF SQLCODE = ZERO                                            
002665        MOVE 'U'                 TO PPROUTIN                      
002666        MOVE 'D'                 TO PPTPFILE                      
002667        MOVE 'R'                 TO PPTPOPER                      
002668        MOVE WCOM-FILENOME       TO PPNMFILE                      
002669        PERFORM Z90-READPRIN                                      
002670           THRU Z90-EX.                                           
002671                                                                  
002672 L180-EX. EXIT.                                                   
002673*----------------------------------------------------------------*
002674 L185-DESCRIZIONE-ARTICOLO.                                       
002675*----------------------------------------------------------------*
002676                                                                  
002677     MOVE 'L185-'                 TO WCOM-CODABEND.               
002678     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002679     MOVE 'TARTISCORN'           TO WCOM-FILENOME.                
002680     MOVE S467-CODARTSC          TO WCOM-FILECTRL.                
002681                                                                  
002682     MOVE SPACES                 TO S457-DESARTSC                 
002683                                    S457-CATEARTI                 
002684                                    WS-PRODTYPE.                  
002686     
      *EXEC SQL 
      *SELECT X.POS, X.CATEARTI, X.DESARTSC                    
002687*            INTO :WS-FLAGFLAG, :S457-CATEARTI                     
002688*                ,:S457-DESARTSC                                   
002689*            FROM (                                                
002690*          SELECT '1' AS POS, A.CATEARTI, A.DESARTSC               
002691*            FROM DSCORTE.TARTISCORN A                             
002692*           WHERE A.CODARTSC = :S467-CODARTSC                      
002693*             AND A.CODILING = 'I'                                 
002694*             AND A.NUMPROG3 = (SELECT MIN(NUMPROG3)               
002695*                                 FROM DSCORTE.TARTISCORN X        
002696*                                WHERE A.CODARTSC = X.CODARTSC     
002697*                                  AND A.CODILING = X.CODILING)    
002698*          UNION                                                   
002699*          SELECT '2' AS POS, A.CATEARTI, A.DESARTSC               
002700*            FROM DSCORTE.TARTISCORN A                             
002701*           WHERE A.CODARTSC = :S467-CODARTSC                      
002702*             AND A.CODILING<> 'I'                                 
002703*             AND A.NUMPROG3 = (SELECT MIN(NUMPROG3)               
002704*                                 FROM DSCORTE.TARTISCORN X        
002705*                                WHERE A.CODARTSC = X.CODARTSC     
002706*                                  AND A.CODILING = X.CODILING)    
002707*                 ) AS X                                           
002708*           ORDER BY 1                                             
002709*           FETCH FIRST ROW ONLY                                   
002710*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 62 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S467-CODARTSC
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S467-CODARTSC
            BY VALUE 0
                     0

           MOVE 63 TO SQL-STMT-ID 
           MOVE 3 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-FLAGFLAG
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S457-CATEARTI
            BY VALUE 0
                     0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S457-DESARTSC
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 32 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002711                                                                  
002712     IF SQLCODE = 100                                             
002713        GO TO L185-EX.                                            
002714                                                                  
002715     MOVE 'U'                    TO PPROUTIN                      
002716     MOVE 'D'                    TO PPTPFILE                      
002717     MOVE 'R'                    TO PPTPOPER                      
002718     MOVE WCOM-FILENOME          TO PPNMFILE                      
002719     PERFORM Z90-READPRIN                                         
002720        THRU Z90-EX.                                              
002721                                                                  
002722     MOVE '03'                   TO WS-PRODTYPE                   
002723     IF S457-CATEARTI = 'C'                                       
002724        MOVE '01'                TO WS-PRODTYPE                   
002725     ELSE                                                         
002727        
      *EXEC SQL 
      *SELECT CATEARTI                                      
002728*               INTO :S457-CATEARTI                                
002729*               FROM DSCORTE.TARTISCORN                            
002730*              WHERE CODARTSC = :S467-CODARTSC                     
002731*                AND CODILING = 'I'                                
002732*                AND DESARTSC LIKE '%IMBALLAGG%'                   
002733*              FETCH FIRST ROW ONLY                                
002734*        END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 64 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S467-CODARTSC
            BY VALUE 0
                     0

           MOVE 65 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S457-CATEARTI
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 33 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
002735        IF SQLCODE = ZERO                                         
002736           MOVE '02'            TO WS-PRODTYPE.                   
002737                                                                  
002738 L185-EX. EXIT.                                                   
002739*----------------------------------------------------------------*
002740 S00-WRITE-OUTRICE.                                               
002741*----------------------------------------------------------------*
002742                                                                  
002743     WRITE REC-OUTRICE           FROM FSGTMO.                     
002744                                                                  
002745     MOVE 'U'                    TO PPROUTIN.                     
002746     MOVE 'OUTRICE'              TO PPNMFILE.                     
002747     MOVE 'S'                    TO PPTPFILE.                     
002748     MOVE 'A'                    TO PPTPOPER.                     
002749     PERFORM Z90-READPRIN                                         
002750        THRU Z90-EX.                                              
002751                                                                  
002752 S00-EX. EXIT.                                                    
002753*----------------------------------------------------------------*
002754 S10-WRITE-OUTNETM.                                               
002755*----------------------------------------------------------------*
002756                                                                  
002757     WRITE REC-OUTNETM           FROM FSNET09.                    
002758                                                                  
002759     MOVE 'U'                    TO PPROUTIN.                     
002760     MOVE 'OUTNETM'              TO PPNMFILE.                     
002761     MOVE 'S'                    TO PPTPFILE.                     
002762     MOVE 'A'                    TO PPTPOPER.                     
002763     PERFORM Z90-READPRIN                                         
002764        THRU Z90-EX.                                              
002765                                                                  
002766 S10-EX. EXIT.                                                    
002767*----------------------------------------------------------------*
002768 S20-WRITE-ORDISCORN.                                             
002769*----------------------------------------------------------------*
002770                                                                  
002771     MOVE SPACES                 TO WOUT-ORDISCO                  
002772     MOVE FSGT-AANUMORD          TO WOUT-AANUMORD                 
002773     MOVE S478-NRCOMMES          TO WOUT-NRCOMMES                 
002774                                                                  
002775     WRITE REC-ORDISCO           FROM WOUT-ORDISCO.               
002776                                                                  
002777     MOVE 'U'                    TO PPROUTIN.                     
002778     MOVE 'ORDISCO'              TO PPNMFILE.                     
002779     MOVE 'S'                    TO PPTPFILE.                     
002780     MOVE 'A'                    TO PPTPOPER.                     
002781     PERFORM Z90-READPRIN                                         
002782        THRU Z90-EX.                                              
002783                                                                  
002784 S20-EX. EXIT.                                                    
002785*----------------------------------------------------------------*
002786 S40-SRDCEP1.                                                     
002787*----------------------------------------------------------------*
002788                                                                  
002789*    EXEC SQL INCLUDE SRDCEP1 END-EXEC.                           
      *>>((file: SRDCEP1))
000001                                                                  
000002*------------------------------------------------- SRDCEP1 START *
000003*    CONTROLLO CONTO -DCE-                                       *
000004*                                                                *
000005*    N.B.  INSERIRE IN WORKING-STORAGE :                         *
000006*            EXEC SQL INCLUDE FDCLI861 END-EXEC.                 *
000007*            EXEC SQL INCLUDE FDANA531 END-EXEC.                 *
000008*                                                                *
000009*    N.B.  IMPOSTARE I DATI IN :  A531-CODSOCIE                  *
000010*                                 C861-CONTPROV                  *
000011*                                                                *
000012*----------------------------------------------------------------*
000013                                                                  
000014     MOVE 'SELECT'         TO WCOM-FILEFUNZ.                      
000015     MOVE 'SRDCEP1'        TO WCOM-FILENOME.                      
000016     MOVE 'SRDC'           TO WCOM-CODABEND.                      
000017     STRING A531-CODSOCIE ' ' C861-CONTPROV                       
000018     DELIMITED BY SIZE   INTO WCOM-FILECTRL.                      
000019                                                                  
000021     
      *EXEC SQL 
      *SELECT T.CONTODCE, T.CODPIANO,                          
000022*                 T.CONTPROV, T.DESCRDCE,                          
000023*                 T.ANNULLAM, T.TIPCONTO,                          
000024*                 T.CONTGRUP, T.NOTECON1,                          
000025*                 T.NOTECON2, T.INDBILQU                           
000026*          INTO   :C861-CONTODCE, :C861-CODPIANO,                  
000027*                 :C861-CONTPROV, :C861-DESCRDCE,                  
000028*                 :C861-ANNULLAM, :C861-TIPCONTO,                  
000029*                 :C861-CONTGRUP, :C861-NOTECON1,                  
000030*                 :C861-NOTECON2, :C861-INDBILQU                   
000031*          FROM   DCONTCLI.TCONTIDCE    T,                         
000032*                 DANAGRAF.TSOCIETA     S                          
000033*          WHERE  S.CODSOCIE = :A531-CODSOCIE                      
000034*            AND  T.CODPIANO = S.CODPIANO                          
000035*            AND  T.CONTPROV = :C861-CONTPROV                      
000036*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 66 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTPROV
            BY VALUE 0
                     0

           MOVE 67 TO SQL-STMT-ID 
           MOVE 10 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTODCE
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CODPIANO
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTPROV
            BY VALUE 0
                     0

           MOVE 25 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-DESCRDCE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-ANNULLAM
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-TIPCONTO
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTGRUP
            BY VALUE 0
                     0

           MOVE 33 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-NOTECON1
            BY VALUE 0
                     0

           MOVE 33 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-NOTECON2
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-INDBILQU
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 34 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000037     IF SQLCODE NOT EQUAL ZERO                                    
000038        IF SQLCODE = +100                                         
000039           MOVE '*'        TO WSWERROR                            
000040           MOVE '00213'    TO MESS-CODERROR                       
000041        ELSE                                                      
000042           PERFORM Z00-ERRORE                                     
000043              THRU Z00-EX.                                        
000044                                                                  
000045*-------------------------------------------------- SRDCEP1 END  *
      *<<((file: SRDCEP1))
002790                                                                  
002791 S40-EX. EXIT.                                                    
002792*----------------------------------------------------------------*
002793 V00-SCBCB10.                                                     
002794*----------------------------------------------------------------*
002795                                                                  
002796     MOVE 'V00-'                 TO WCOM-CODABEND.                
002797     MOVE 'SCBCB10'              TO WCOM-FILENOME.                
002798     MOVE 'CALL   '              TO WCOM-FILEFUNZ.                
002799     STRING CAMB-CODDIVIS ' ' CAMB-DTCAMBIO ' '                   
002800            CAMB-CODCAMBI ' ' CAMB-CODDRIFE                       
002801            DELIMITED BY SIZE  INTO WCOM-FILECTRL.                
002802                                                                  
002803     MOVE 'SCBCB10'              TO PPCALL.                       
002804     CALL PPCALL USING DCPARM DCWCAMB.                            
002805     MOVE 'AAASA15'              TO PPNAME                        
002806                                    WCOM-PROGNAME.                
002807                                                                  
002808     IF CAMB-RETCOD NOT = '****'                                  
002809        PERFORM Z00-ERRORE                                        
002810           THRU Z00-EX.                                           
002811                                                                  
002812 V00-EX. EXIT.                                                    
002813*----------------------------------------------------------------*
002814 W00-WRITE-ORDINI.                                                
002815*----------------------------------------------------------------*
002816                                                                  
002817     IF WS-AANUMORD NOT = FSGT-AANUMORD                           
002818        MOVE FSGT-AANUMORD       TO WS-AANUMORD                   
002819        MOVE SPACES              TO DCLSAP-ORDACQ-HEADER          
002820        INITIALIZE                  DCLSAP-ORDACQ-HEADER          
002821                                                                  
002822        MOVE ZEROES              TO WS-PO-ITEM                    
002823        MOVE FSGT-AANUMORD       TO S005-ODA-CICS                 
002824        PERFORM L95-SELECT-TESTATA                                
002825           THRU L95-EX                                            
002826        PERFORM W10-PREPARA-HEADER                                
002827           THRU W10-EX                                            
002828        MOVE FSGT-AANUMORD       TO S006-ODA-CICS-ITEMTABLE       
002829        PERFORM W30-DELETE-ITEM                                   
002830           THRU W30-EX                                            
002831        MOVE FSGT-AANUMORD       TO S007-ODA-CICS-ACCTABLE        
002832        PERFORM W35-DELETE-ACCOUNT                                
002833           THRU W35-EX.                                           
002834                                                                  
002835     PERFORM W40-PREPARA-ITEM                                     
002836        THRU W40-EX.                                              
002837                                                                  
002838     PERFORM W60-PREPARA-ACCOUNT                                  
002839        THRU W60-EX.                                              
002840                                                                  
002841     IF WS-NOSAPXXX = '--'                                        
002842        MOVE FSGT-AANUMORD       TO S005-ODA-CICS                 
002843        PERFORM W99-UPDATE-HEADER                                 
002844           THRU W99-EX.                                           
002845                                                                  
002846 W00-EX. EXIT.                                                    
002847*----------------------------------------------------------------*
002848 W10-PREPARA-HEADER.                                              
002849*----------------------------------------------------------------*
002850                                                                  
002851     IF S700-MERCEMAG NOT = 'RI'                                  
002852        MOVE 'DIR'               TO S005-GEN-ODA                  
002853     ELSE                                                         
002854        MOVE 'IND'               TO S005-GEN-ODA.                 
002855                                                                  
002856     MOVE '2'                    TO S005-SOURCE.                  
002857     MOVE '02'                   TO S005-TIPO-ODA                 
002858     IF FSGT-F-R-S-XX = 'R'                                       
002859        MOVE '08'                TO S005-TIPO-ODA                 
002860        IF A972-CODPAESE = '000'                                  
002861           MOVE '07'             TO S005-TIPO-ODA.                
002862                                                                  
002863     IF FSGT-NOTEXXXX = 'VEND A FORN'                             
002864        MOVE '13'                TO S005-TIPO-ODA                 
002865        MOVE 'DIR'               TO S005-GEN-ODA.                 
002866                                                                  
002867     IF S700-MERCEMAG = 'TR'                                      
002868        MOVE '12'                TO S005-TIPO-ODA                 
002869        MOVE '5'                 TO S005-SOURCE.                  
002870                                                                  
002871     IF S700-MERCEMAG = 'LA'                                      
002872        MOVE '10'                TO S005-TIPO-ODA                 
002873        MOVE '2'                 TO S005-SOURCE.                  
002874                                                                  
002875     MOVE FSGT-SOCIETAN          TO S005-COMP-CODE                
002876                                                                  
002877     MOVE FSGT-FORNITOR          TO S009-SEARCHTERM1              
002878     PERFORM L110-SELECT-FORNITORI                                
002879        THRU L110-EX.                                             
002880     MOVE S009-VEND-CODE         TO S005-VENDOR                   
002881                                                                  
002882     MOVE SPACES                 TO S005-PURCH-ORG                
002883     MOVE SPACES                 TO S005-PUR-GROUP                
002884     MOVE FSGT-DIVISAXX          TO A963-CODDIGTM                 
002885     PERFORM L120-SELECT-DIVISE                                   
002886        THRU L120-EX.                                             
002887     MOVE A963-SLDIVBAN          TO S005-CURRENCY.                
002888                                                                  
002889     MOVE FSGT-NOMUTENT          TO S005-CREATED-BY               
002890     MOVE SPACES                 TO S005-OUR-REF                  
002891                                                                  
002892***  PER GLI ORDINI DELLE SCORTE CODIRESA  QUELLO                
002893***  GTM (2 CARATTERI) VEDERE SE AGGIUNGERE                       
002894***  CONRESA SU TABELLA GTMRESAM                                  
002895***                                                               
002896     IF S700-MERCEMAG NOT = 'RI' AND                              
002897        S700-CODIRESA > ' '                                       
002898        MOVE S700-CODIRESA       TO A113-CODIRESA                 
002899        PERFORM L130-SELECT-CODIRESA                              
002900           THRU L130-EX                                           
002901        MOVE A113-CONDRESA       TO S005-INCOTERMS1               
002902        IF A113-CONDRESA = 'DAP'                                  
002903           MOVE 'DDP'            TO S005-INCOTERMS1.              
002904                                                                  
002905     MOVE SPACES                 TO S005-INCOTERMS2               
002906     IF S005-INCOTERMS1 > SPACES                                  
002907        MOVE '.'                 TO S005-INCOTERMS2.              
002908                                                                  
002909     MOVE SPACES                 TO S005-HEADERTEXT               
002910     IF S005-MOD-PROGR-NUM = '00000'                              
002911        MOVE 'X'                 TO S005-CRT                      
002912        MOVE 'IN'                TO S005-CRT-ST                   
002913        MOVE SPACES              TO S005-MOD-PROGR-NUM            
002914     ELSE                                                         
002915        MOVE 'X'                 TO S005-CRT                      
002916        MOVE 'IN'                TO S005-CRT-ST                   
002917        MOVE 'X'                 TO S005-MOD                      
002918        MOVE 'IN'                TO S005-MOD-ST                   
002919        MOVE S005-MOD-PROGR-NUM  TO WS-NUMPROGR-X                 
002920        ADD 1                    TO WS-NUMPROGR-9                 
002921        MOVE WS-NUMPROGR-X       TO S005-MOD-PROGR-NUM.           
002922                                                                  
002923     MOVE SPACES                 TO S005-LINGUA.                  
002924     IF FSGT-NOTEXXXX = 'VEND A FORN' OR                          
002925        (FSGT-F-R-S-XX     = 'R'  AND                             
002926         A972-CODPAESE NOT = '000'   )                            
002927        MOVE 'EN'                TO S005-LINGUA                   
002928        IF S009-COUNTRYISO = 'IT' OR                              
002929           S009-COUNTRYISO = 'FR' OR                              
002930           S009-COUNTRYISO = 'DE'                                 
002931           MOVE S009-COUNTRYISO  TO S005-LINGUA.                  
002932                                                                  
002933     IF (FSGT-NOTEXXXX = 'VEND A FORN' AND                        
002934         FSGT-SOCIETAN = '25'             ) OR                    
002935        (FSGT-F-R-S-XX     = 'R'  AND                             
002936         A972-CODPAESE NOT = '000'   )                            
002937        MOVE 'WW'                TO S005-CRT-ST.                  
002938                                                                  
002939     MOVE SPACES                 TO S005-MAIDEN.                  
002940     MOVE SPACES                 TO S005-CATENA.                  
002941                                                                  
002942     MOVE DTEL-DTINELAB(3:6)     TO S005-DATA-CTR                 
002943                                                                  
002944     PERFORM W15-INSERT-HEADER                                    
002945        THRU W15-EX.                                              
002946                                                                  
002947 W10-EX. EXIT.                                                    
002948*----------------------------------------------------------------*
002949 W15-INSERT-HEADER.                                               
002950*----------------------------------------------------------------*
002951                                                                  
002952     MOVE 'W15-'                 TO WCOM-CODABEND.                
002953     MOVE 'INSERT'               TO WCOM-FILEFUNZ.                
002954     MOVE 'HEADER'               TO WCOM-FILENOME.                
002955     MOVE S005-ODA-CICS          TO WCOM-FILECTRL.                
002956                                                                  
002958     
      *EXEC SQL 
      *INSERT INTO DBGTM.SAP_ORDACQ_HEADER                     
002959*                 (ODA_CICS                                        
002960*                 ,GEN_ODA                                         
002961*                 ,TIPO_ODA                                        
002962*                 ,SOURCE                                          
002963*                 ,COMP_CODE                                       
002964*                 ,VENDOR                                          
002965*                 ,PURCH_ORG                                       
002966*                 ,PUR_GROUP                                       
002967*                 ,CURRENCY                                        
002968*                 ,CREATED_BY                                      
002969*                 ,OUR_REF                                         
002970*                 ,INCOTERMS1                                      
002971*                 ,INCOTERMS2                                      
002972*                 ,HEADERTEXT                                      
002973*                 ,CRT                                             
002974*                 ,CRT_ST                                          
002975*                 ,MOD                                             
002976*                 ,MOD_ST                                          
002977*                 ,MOD_PROGR_NUM                                   
002978*                 ,MAIDEN                                          
002979*                 ,CATENA                                          
002980*                 ,DATA_CTR                                        
002981*                 ,LINGUA)                                         
002982*          VALUES (:S005-ODA-CICS                                  
002983*                 ,:S005-GEN-ODA                                   
002984*                 ,:S005-TIPO-ODA                                  
002985*                 ,:S005-SOURCE                                    
002986*                 ,:S005-COMP-CODE                                 
002987*                 ,:S005-VENDOR                                    
002988*                 ,:S005-PURCH-ORG                                 
002989*                 ,:S005-PUR-GROUP                                 
002990*                 ,:S005-CURRENCY                                  
002991*                 ,:S005-CREATED-BY                                
002992*                 ,:S005-OUR-REF                                   
002993*                 ,:S005-INCOTERMS1                                
002994*                 ,:S005-INCOTERMS2                                
002995*                 ,:S005-HEADERTEXT                                
002996*                 ,:S005-CRT                                       
002997*                 ,:S005-CRT-ST                                    
002998*                 ,:S005-MOD                                       
002999*                 ,:S005-MOD-ST                                    
003000*                 ,:S005-MOD-PROGR-NUM                             
003001*                 ,:S005-MAIDEN                                    
003002*                 ,:S005-CATENA                                    
003003*                 ,:S005-DATA-CTR                                  
003004*                 ,:S005-LINGUA)                                   
003005*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 68 TO SQL-STMT-ID 
           MOVE 23 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-ODA-CICS
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-GEN-ODA
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-TIPO-ODA
            BY VALUE 0
                     0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-SOURCE
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-COMP-CODE
            BY VALUE 0
                     0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-VENDOR
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-PURCH-ORG
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-PUR-GROUP
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-CURRENCY
            BY VALUE 0
                     0

           MOVE 12 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-CREATED-BY
            BY VALUE 0
                     0

           MOVE 12 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-OUR-REF
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-INCOTERMS1
            BY VALUE 0
                     0

           MOVE 28 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-INCOTERMS2
            BY VALUE 0
                     0

           MOVE 132 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-HEADERTEXT
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-CRT
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-CRT-ST
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-MOD
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 17 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-MOD-ST
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 18 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-MOD-PROGR-NUM
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 19 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-MAIDEN
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 20 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-CATENA
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 21 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-DATA-CTR
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 22 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-LINGUA
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 35 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003006                                                                  
003007     IF SQLCODE NOT EQUAL ZERO                                    
003008        PERFORM Z00-ERRORE                                        
003009           THRU Z00-EX                                            
003010     ELSE                                                         
003011        MOVE 'U'                 TO PPROUTIN                      
003012        MOVE 'D'                 TO PPTPFILE                      
003013        MOVE 'A'                 TO PPTPOPER                      
003014        MOVE WCOM-FILENOME       TO PPNMFILE                      
003015        PERFORM Z90-READPRIN                                      
003016           THRU Z90-EX.                                           
003017                                                                  
003018 W15-EX. EXIT.                                                    
003019*--------------------------------------------------------------*  
003020 W20-INSERT-MODIFICA-TESTATA.                                     
003021*--------------------------------------------------------------*  
003022                                                                  
003023     PERFORM L96-SELECT-TESTATA                                   
003024        THRU L96-EX                                               
003025     IF SQLCODE = 100                                             
003026        PERFORM L95-SELECT-TESTATA                                
003027           THRU L95-EX                                            
003028        PERFORM W10-PREPARA-HEADER                                
003029           THRU W10-EX.                                           
003030                                                                  
003031 W20-EX. EXIT.                                                    
003032*----------------------------------------------------------------*
003033 W30-DELETE-ITEM.                                                 
003034*----------------------------------------------------------------*
003035                                                                  
003036     MOVE 'W30-'                 TO WCOM-CODABEND.                
003037     MOVE 'DELETE'               TO WCOM-FILEFUNZ.                
003038     MOVE 'ORDACQ_ITEM'          TO WCOM-FILENOME.                
003039     MOVE S006-ODA-CICS-ITEMTABLE                                 
003040                                 TO WCOM-FILECTRL.                
003041                                                                  
003043     
      *EXEC SQL 
      *DELETE FROM DBGTM.SAP_ORDACQ_ITEM                       
003044*            WHERE ODA_CICS_ITEMTABLE = :S006-ODA-CICS-ITEMTABLE   
003045*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 69 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-ODA-CICS-ITEMTABLE
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 36 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003046                                                                  
003047     IF SQLCODE NOT EQUAL ZERO AND +100                           
003048        PERFORM Z00-ERRORE                                        
003049           THRU Z00-EX                                            
003050     ELSE                                                         
003051        IF SQLCODE EQUAL ZERO                                     
003052           MOVE 'U'              TO PPROUTIN                      
003053           MOVE 'D'              TO PPTPFILE                      
003054           MOVE 'D'              TO PPTPOPER                      
003055           MOVE WCOM-FILENOME    TO PPNMFILE                      
003056           PERFORM Z90-READPRIN                                   
003057              THRU Z90-EX.                                        
003058                                                                  
003059 W30-EX. EXIT.                                                    
003060*----------------------------------------------------------------*
003061 W35-DELETE-ACCOUNT.                                              
003062*----------------------------------------------------------------*
003063                                                                  
003064     MOVE 'W35-'                 TO WCOM-CODABEND.                
003065     MOVE 'DELETE'               TO WCOM-FILEFUNZ.                
003066     MOVE 'ORDACQ_ACCOUNT'       TO WCOM-FILENOME.                
003067     MOVE S007-ODA-CICS-ACCTABLE TO WCOM-FILECTRL.                
003068                                                                  
003070     
      *EXEC SQL 
      *DELETE FROM DBGTM.SAP_ORDACQ_ACCOUNT                    
003071*            WHERE ODA_CICS_ACCTABLE = :S007-ODA-CICS-ACCTABLE     
003072*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 70 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S007-ODA-CICS-ACCTABLE
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 37 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003073                                                                  
003074     IF SQLCODE NOT EQUAL ZERO AND +100                           
003075        PERFORM Z00-ERRORE                                        
003076           THRU Z00-EX                                            
003077     ELSE                                                         
003078        IF SQLCODE EQUAL ZERO                                     
003079           MOVE 'U'              TO PPROUTIN                      
003080           MOVE 'D'              TO PPTPFILE                      
003081           MOVE 'D'              TO PPTPOPER                      
003082           MOVE WCOM-FILENOME    TO PPNMFILE                      
003083           PERFORM Z90-READPRIN                                   
003084              THRU Z90-EX.                                        
003085                                                                  
003086 W35-EX. EXIT.                                                    
003087*----------------------------------------------------------------*
003088 W40-PREPARA-ITEM.                                                
003089*----------------------------------------------------------------*
003090                                                                  
003091     MOVE SPACES                 TO DCLSAP-ORDACQ-ITEM.           
003092     INITIALIZE                     DCLSAP-ORDACQ-ITEM.           
003093                                                                  
003094     MOVE '1'                    TO S006-PROD-TYPE                
003095                                                                  
003096     MOVE FSGT-AANUMORD          TO S006-ODA-CICS-ITEMTABLE       
003097     IF FSGT-NOTEXXXX = 'VEND A FORN'                             
003098        MOVE SPACES              TO S006-ODA-CICS-ITEMTABLE       
003099        MOVE FSGT-AANUMORD       TO S006-ODA-CICS-ITEMTABLE(1:8)  
003100        MOVE 'V'                 TO S006-ODA-CICS-ITEMTABLE(9:1). 
003101                                                                  
003102     MOVE FSGT-NRRIGORD          TO S006-CICS-PO-ITEM-ITEMTABLE   
003103                                                                  
003104     ADD 10                      TO WS-PO-ITEM                    
003105     MOVE WS-PO-ITEM             TO S006-PO-ITEM                  
003106                                                                  
003107     STRING FSGT-ARTICOLI ' ' FSGT-DESCARTI                       
003108        DELIMITED BY SIZE      INTO S006-SHORT-DESC               
003109                                                                  
003110     IF S700-MERCEMAG = 'TR' OR 'LA'                              
003111        COMPUTE WS-PO-ITEM3 = WS-PO-ITEM / 10                     
003112        MOVE '2'                 TO S006-PROD-TYPE                
003113        MOVE N09-NRPREFAT        TO S006-ODA-CICS-ITEMTABLE       
003114        MOVE WS-PO-ITEM3X        TO S006-CICS-PO-ITEM-ITEMTABLE   
003115        MOVE N09-DESCRXXX        TO S006-SHORT-DESC.              
003116                                                                  
003117     INSPECT S006-SHORT-DESC   REPLACING ALL '&' BY '-'           
003118     INSPECT S006-SHORT-DESC   REPLACING ALL '#' BY SPACES        
003119                                                                  
003120     MOVE FSGT-SOCIETAN          TO S006-COMP-CODE                
003121     IF S479-DTANNULL > SPACES                                    
003122        MOVE 'X'                 TO S006-FLAG-CANC.               
003123                                                                  
003124     MOVE SPACES                 TO S006-ARTICOLO                 
003125**** DISPLAY 'NOTE :' FSGT-NOTEXXXX                               
003126**** DISPLAY 'ARTICOLO: ' FSGT-ARTICOLI                           
003127     IF FSGT-NOTEXXXX      = 'VEND A FORN' OR                     
003128        (FSGT-F-R-S-XX     = 'R'  AND                             
003129         A972-CODPAESE NOT = '000'   )                            
003130        IF FSGT-MERCEMAG     > SPACES AND                         
003131           FSGT-MERCEMAG NOT = 'RI'                               
003132           MOVE FSGT-DESCARTI    TO S006-ARTICOLO                 
003133           MOVE SPACES           TO S006-PROD-TYPE                
003134        ELSE                                                      
003135           MOVE FSGT-ARTICOLI    TO S467-CODARTSC                 
003136           IF FSGT-VARIANTE = '000'                               
003137              MOVE FSGT-ARTICOLI(1:5) TO S467-CODARTSC            
003138           END-IF                                                 
003139*******    DISPLAY 'CODARTSC ' S467-CODARTSC                      
003140           PERFORM L185-DESCRIZIONE-ARTICOLO                      
003141              THRU L185-EX                                        
003142           MOVE S457-DESARTSC    TO S006-ARTICOLO                 
003143           MOVE WS-PRODTYPE      TO S006-PROD-TYPE.               
003144                                                                  
003145     MOVE SPACES                 TO S006-GRUPPO-MERCI             
003146     IF FSGT-ARTICOLI = 'TAGLIO99'                                
003147        MOVE SPACES              TO S006-GRUPPO-MERCI.            
003148                                                                  
003149     MOVE 'IT01'                 TO S006-PLANT                    
003150     IF S006-COMP-CODE = '16'                                     
003151        IF (FSGT-CODDEPOS > SPACES AND                            
003152            FSGT-CODDEPOS NOT = 'MP') OR                          
003153           SK-TIPOELAB = 'NETMOVER'                               
003154           MOVE 'IT16'           TO S006-PLANT.                   
003155     IF S006-COMP-CODE = '15'                                     
003156        MOVE 'IT17'              TO S006-PLANT.                   
003157     IF S006-COMP-CODE = '22'                                     
003158        MOVE 'IT16'              TO S006-PLANT.                   
003159     IF S006-COMP-CODE = '08'                                     
003160        MOVE 'IT11'              TO S006-PLANT.                   
003161     IF S006-COMP-CODE = '24'                                     
003162        MOVE 'IT14'              TO S006-PLANT.                   
003163     IF S006-COMP-CODE = '25'                                     
003164        MOVE 'IT15'              TO S006-PLANT.                   
003165     IF S006-COMP-CODE = 'CT'                                     
003166        MOVE 'CH01'              TO S006-PLANT.                   
003167     IF S006-COMP-CODE = 'DQ'                                     
003168        MOVE 'DE01'              TO S006-PLANT.                   
003169     IF S006-COMP-CODE = '0L'                                     
003170        MOVE 'FR01'              TO S006-PLANT.                   
003171     IF S006-COMP-CODE = '0J'                                     
003172        MOVE 'GB01'              TO S006-PLANT.                   
003173                                                                  
003174     MOVE SPACES                 TO S006-STORAGE-LOC              
003175                                                                  
003176     MOVE FSGT-UNMISURA          TO S006-UM-ODA                   
003177     IF FSGT-UNMISURA = 'N.' OR 'NR'                              
003178        MOVE 'ST'                TO S006-UM-ODA.                  
003179     IF FSGT-UNMISURA = 'MT'                                      
003180        MOVE 'M'                 TO S006-UM-ODA.                  
003181     IF FSGT-UNMISURA = 'LT'                                      
003182        MOVE 'L'                 TO S006-UM-ODA.                  
003183     IF FSGT-UNMISURA = 'MQ'                                      
003184        MOVE 'M2'                TO S006-UM-ODA.                  
003185                                                                  
003186     MOVE FSGT-QTARICEV          TO S006-QUANTITY                 
003187     MOVE FSGT-PREZZOXX          TO S006-PREZZO-NETTO             
003188     MOVE 100                    TO S006-PREZZO-UNITARIO          
003189     IF S006-QUANTITY = ZEROES                                    
003190        MOVE '2'                 TO S006-PROD-TYPE                
003191        MOVE 'VAL'               TO S006-UM-ODA                   
003192        MOVE FSGT-PREZZOXX       TO S006-QUANTITY                 
003193        MOVE 1                   TO S006-PREZZO-NETTO.            
003194                                                                  
003195     COMPUTE S006-VALORE-NETTO-ODA =                              
003196             S006-PREZZO-NETTO * S006-QUANTITY                    
003197                                                                  
003198     MOVE SPACES                 TO S006-TIPO-POS                 
003199     MOVE SPACES                 TO S006-TIPO-CONT                
003200     MOVE ZEROES                 TO S006-PESO-NETTO               
003201     MOVE SPACES                 TO S006-UM-PESO                  
003202     IF WS-PESOGRMT > 0                                           
003203        MOVE WS-PESOGRMT         TO S006-PESO-NETTO               
003204        MOVE 'G'                 TO S006-UM-PESO.                 
003205     MOVE ZEROES                 TO S006-PESO-LORDO               
003206     MOVE ZEROES                 TO S006-VOLUME                   
003207     MOVE SPACES                 TO S006-UM-VOLUME                
003208     IF WS-VOLUMEXX > 0                                           
003209        MOVE WS-VOLUMEXX         TO S006-VOLUME                   
003210        MOVE 'M3'                TO S006-UM-VOLUME.               
003211     MOVE WS-VOCEDOGA            TO S006-COMM-CODE                
003212     MOVE ZEROES                 TO S006-SCHED-LINE               
003213     STRING FSGT-GGCONSEG '.'                                     
003214            FSGT-MMCONSEG '.'                                     
003215            DTEL-DTINELAB(1:2)                                    
003216            FSGT-AACONSEG                                         
003217         DELIMITED BY SIZE     INTO S006-DATA-CONS                
003218     MOVE S006-QUANTITY          TO S006-QUANT-CONS               
003219     MOVE SPACES                 TO S006-POS-TEXT                 
003220     MOVE SPACES                 TO S006-ESERC-STAGIONALE         
003221     MOVE SPACES                 TO S006-COLLEZIONE               
003222     MOVE SPACES                 TO S006-STAGIONE                 
003223     MOVE SPACES                 TO S006-OVER-DLV-TOL             
003224     MOVE SPACES                 TO S006-UNLIMITED-DLV            
003225     MOVE '70'                   TO S006-UNDER-DLV-TOL            
003226     MOVE SPACES                 TO S006-QUAL-INSP                
003227     MOVE SPACES                 TO S006-STK-SEG-LONG             
003228     MOVE SPACES                 TO S006-FREE-ITEM                
003229     MOVE SPACES                 TO S006-CONFIRMATION-CONTROL     
003230                                                                  
003231     IF FSGT-NOTEXXXX = 'VEND A FORN'  OR                         
003232        (FSGT-F-R-S-XX     = 'R'  AND                             
003233         A972-CODPAESE NOT = '000'   )                            
003234        MOVE SPACES              TO S006-POS-TEXT                 
003235        IF FSGT-NUMBOLLA > SPACES                                 
003236           MOVE FSGT-NUMBOLLA    TO WS-COMODOXX                   
003237           MOVE ZEROES           TO IND2                          
003238           MOVE SPACES           TO WS-COMODOX2                   
003239           PERFORM VARYING IND1 FROM 1 BY 1                       
003240                     UNTIL IND1 > 5                               
003241              IF WS-BYTEBYTE(IND1) > SPACE                        
003242                 ADD 1           TO IND2                          
003243                 MOVE WS-BYTEBYTE(IND1) TO WS-BYTEBYT2(IND2)      
003244              END-IF                                              
003245           END-PERFORM                                            
003246           MOVE WS-COMODOX2      TO FSGT-NUMBOLLA                 
003247           MOVE FSGT-NUMBOLLA    TO S006-POS-TEXT                 
003248           STRING FSGT-GGBOLLAX '.'                               
003249                  FSGT-MMBOLLAX '.'                               
003250                  DTEL-DTINELAB (1:2)                             
003251                  FSGT-AABOLLAX                                   
003252              DELIMITED BY SIZE INTO S006-DATA-CONS.              
003253                                                                  
003254     IF FSGT-NOTEXXXX = 'VEND A FORN'                             
003255        IF S006-PROD-TYPE = '01'                                  
003256           MOVE SPACES           TO S006-SHORT-DESC               
003257           STRING 'DDT: ' S006-POS-TEXT (1:7)                     
003258                  'DEL '  S006-DATA-CONS                          
003259              DELIMITED BY SIZE INTO S006-SHORT-DESC              
003260        END-IF                                                    
003261        IF S006-PROD-TYPE = '02' OR '03'                          
003262           MOVE SPACES           TO S006-SHORT-DESC               
003263           STRING FSGT-DESCARTI (1:12)                            
003264                  'DDT: ' S006-POS-TEXT (1:7)                     
003265                  'DEL '  S006-DATA-CONS                          
003266              DELIMITED BY SIZE INTO S006-SHORT-DESC              
003267        END-IF                                                    
003268     END-IF                                                       
003269                                                                  
003270     MOVE SPACES                 TO S006-PROFIT-CENTER            
003271     IF FSGT-NOTEXXXX = 'VEND A FORN'  OR                         
003272        (FSGT-F-R-S-XX     = 'R'  AND                             
003273          A972-CODPAESE NOT = '000'  )                            
003274        MOVE FSGT-CENCOSTO       TO S001-CCOSGTM                  
003275        MOVE FSGT-SOCIETAN       TO S001-SOCI                     
003276        MOVE FSGT-DIVISION       TO S001-DIPAR                    
003277        PERFORM L140-SELECT-SAPCCOS                               
003278           THRU L140-EX                                           
003279        MOVE S001-PROFIT-CENTER  TO S006-PROFIT-CENTER.           
003280                                                                  
003281     MOVE SPACES                 TO S006-FLAG-RESO.               
003282     IF FSGT-F-R-S-XX = 'R'                                       
003283****    IF A972-CODPAESE = '000'                                  
003284           MOVE 'X'              TO S006-FLAG-RESO.               
003285                                                                  
003286     MOVE DTEL-DTINELAB(3:6)     TO S006-DATA-CRT                 
003287                                                                  
003288     PERFORM W45-INSERT-ITEM                                      
003289        THRU W45-EX.                                              
003290                                                                  
003291 W40-EX. EXIT.                                                    
003292*----------------------------------------------------------------*
003293 W45-INSERT-ITEM.                                                 
003294*----------------------------------------------------------------*
003295                                                                  
003296     MOVE 'W45-'                 TO WCOM-CODABEND.                
003297     MOVE 'INSERT'               TO WCOM-FILEFUNZ.                
003298     MOVE 'ITEM'                 TO WCOM-FILENOME.                
003299     MOVE SPACES                 TO WCOM-FILECTRL.                
003300     STRING S006-ODA-CICS-ITEMTABLE ' '                           
003301            S006-CICS-PO-ITEM-ITEMTABLE                           
003302        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
003303                                                                  
003305     
      *EXEC SQL 
      *INSERT INTO DBGTM.SAP_ORDACQ_ITEM                       
003306*                 (ODA_CICS_ITEMTABLE                              
003307*                 ,CICS_PO_ITEM_ITEMTABLE                          
003308*                 ,PO_ITEM                                         
003309*                 ,COMP_CODE                                       
003310*                 ,PROD_TYPE                                       
003311*                 ,FLAG_CANC                                       
003312*                 ,ARTICOLO                                        
003313*                 ,GRUPPO_MERCI                                    
003314*                 ,SHORT_DESC                                      
003315*                 ,PLANT                                           
003316*                 ,STORAGE_LOC                                     
003317*                 ,QUANTITY                                        
003318*                 ,UM_ODA                                          
003319*                 ,PREZZO_NETTO                                    
003320*                 ,PREZZO_UNITARIO                                 
003321*                 ,VALORE_NETTO_ODA                                
003322*                 ,TIPO_POS                                        
003323*                 ,TIPO_CONT                                       
003324*                 ,PESO_NETTO                                      
003325*                 ,UM_PESO                                         
003326*                 ,PESO_LORDO                                      
003327*                 ,VOLUME                                          
003328*                 ,UM_VOLUME                                       
003329*                 ,COMM_CODE                                       
003330*                 ,SCHED_LINE                                      
003331*                 ,DATA_CONS                                       
003332*                 ,QUANT_CONS                                      
003333*                 ,POS_TEXT                                        
003334*                 ,ESERC_STAGIONALE                                
003335*                 ,COLLEZIONE                                      
003336*                 ,STAGIONE                                        
003337*                 ,OVER_DLV_TOL                                    
003338*                 ,UNLIMITED_DLV                                   
003339*                 ,UNDER_DLV_TOL                                   
003340*                 ,QUAL_INSP                                       
003341*                 ,STK_SEG_LONG                                    
003342*                 ,FREE_ITEM                                       
003343*                 ,CONFIRMATION_CONTROL                            
003344*                 ,FLAG_RESO                                       
003345*                 ,DATA_CRT                                        
003346*                 ,PROFIT_CENTER)                                  
003347*          VALUES (:S006-ODA-CICS-ITEMTABLE                        
003348*                 ,:S006-CICS-PO-ITEM-ITEMTABLE                    
003349*                 ,:S006-PO-ITEM                                   
003350*                 ,:S006-COMP-CODE                                 
003351*                 ,:S006-PROD-TYPE                                 
003352*                 ,:S006-FLAG-CANC                                 
003353*                 ,:S006-ARTICOLO                                  
003354*                 ,:S006-GRUPPO-MERCI                              
003355*                 ,:S006-SHORT-DESC                                
003356*                 ,:S006-PLANT                                     
003357*                 ,:S006-STORAGE-LOC                               
003358*                 ,:S006-QUANTITY                                  
003359*                 ,:S006-UM-ODA                                    
003360*                 ,:S006-PREZZO-NETTO                              
003361*                 ,:S006-PREZZO-UNITARIO                           
003362*                 ,:S006-VALORE-NETTO-ODA                          
003363*                 ,:S006-TIPO-POS                                  
003364*                 ,:S006-TIPO-CONT                                 
003365*                 ,:S006-PESO-NETTO                                
003366*                 ,:S006-UM-PESO                                   
003367*                 ,:S006-PESO-LORDO                                
003368*                 ,:S006-VOLUME                                    
003369*                 ,:S006-UM-VOLUME                                 
003370*                 ,:S006-COMM-CODE                                 
003371*                 ,:S006-SCHED-LINE                                
003372*                 ,:S006-DATA-CONS                                 
003373*                 ,:S006-QUANT-CONS                                
003374*                 ,:S006-POS-TEXT                                  
003375*                 ,:S006-ESERC-STAGIONALE                          
003376*                 ,:S006-COLLEZIONE                                
003377*                 ,:S006-STAGIONE                                  
003378*                 ,:S006-OVER-DLV-TOL                              
003379*                 ,:S006-UNLIMITED-DLV                             
003380*                 ,:S006-UNDER-DLV-TOL                             
003381*                 ,:S006-QUAL-INSP                                 
003382*                 ,:S006-STK-SEG-LONG                              
003383*                 ,:S006-FREE-ITEM                                 
003384*                 ,:S006-CONFIRMATION-CONTROL                      
003385*                 ,:S006-FLAG-RESO                                 
003386*                 ,:S006-DATA-CRT                                  
003387*                 ,:S006-PROFIT-CENTER)                            
003388*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 71 TO SQL-STMT-ID 
           MOVE 41 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-ODA-CICS-ITEMTABLE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-CICS-PO-ITEM-ITEMTABLE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-PO-ITEM
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-COMP-CODE
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-PROD-TYPE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-FLAG-CANC
            BY VALUE 0
                     0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-ARTICOLO
            BY VALUE 0
                     0

           MOVE 9 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-GRUPPO-MERCI
            BY VALUE 0
                     0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-SHORT-DESC
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-PLANT
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-STORAGE-LOC
            BY VALUE 0
                     0

           MOVE 781 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-QUANTITY
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-UM-ODA
            BY VALUE 0
                     0

           MOVE 523 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-PREZZO-NETTO
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-PREZZO-UNITARIO
            BY VALUE 0
                     0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-VALORE-NETTO-ODA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-TIPO-POS
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 17 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-TIPO-CONT
            BY VALUE 0
                     0

           MOVE 781 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 18 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-PESO-NETTO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 19 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-UM-PESO
            BY VALUE 0
                     0

           MOVE 781 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 20 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-PESO-LORDO
            BY VALUE 0
                     0

           MOVE 781 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 21 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-VOLUME
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 22 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-UM-VOLUME
            BY VALUE 0
                     0

           MOVE 30 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 23 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-COMM-CODE
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 24 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-SCHED-LINE
            BY VALUE 0
                     0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 25 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-DATA-CONS
            BY VALUE 0
                     0

           MOVE 781 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 26 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-QUANT-CONS
            BY VALUE 0
                     0

           MOVE 132 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 27 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-POS-TEXT
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 28 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-ESERC-STAGIONALE
            BY VALUE 0
                     0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 29 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-COLLEZIONE
            BY VALUE 0
                     0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 30 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-STAGIONE
            BY VALUE 0
                     0

           MOVE 260 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 31 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-OVER-DLV-TOL
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 32 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-UNLIMITED-DLV
            BY VALUE 0
                     0

           MOVE 260 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 33 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-UNDER-DLV-TOL
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 34 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-QUAL-INSP
            BY VALUE 0
                     0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 35 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-STK-SEG-LONG
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 36 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-FREE-ITEM
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 37 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-CONFIRMATION-CONTROL
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 38 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-FLAG-RESO
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 39 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-DATA-CRT
            BY VALUE 0
                     0

           MOVE 20 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 40 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S006-PROFIT-CENTER
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 38 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003389                                                                  
003390     IF SQLCODE NOT EQUAL ZERO                                    
003391        PERFORM Z00-ERRORE                                        
003392           THRU Z00-EX                                            
003393     ELSE                                                         
003394        MOVE 'U'                 TO PPROUTIN                      
003395        MOVE 'D'                 TO PPTPFILE                      
003396        MOVE 'A'                 TO PPTPOPER                      
003397        MOVE WCOM-FILENOME       TO PPNMFILE                      
003398        PERFORM Z90-READPRIN                                      
003399           THRU Z90-EX.                                           
003400                                                                  
003401 W45-EX. EXIT.                                                    
003402*----------------------------------------------------------------*
003403 W60-PREPARA-ACCOUNT.                                             
003404*----------------------------------------------------------------*
003405                                                                  
003406     MOVE SPACES                 TO DCLSAP-ORDACQ-ACCOUNT         
003407     INITIALIZE                     DCLSAP-ORDACQ-ACCOUNT.        
003408                                                                  
003409     MOVE FSGT-AANUMORD          TO S007-ODA-CICS-ACCTABLE        
003410     IF FSGT-NOTEXXXX = 'VEND A FORN'                             
003411        MOVE SPACES              TO S007-ODA-CICS-ACCTABLE        
003412        MOVE FSGT-AANUMORD       TO S007-ODA-CICS-ACCTABLE(1:8)   
003413        MOVE 'V'                 TO S007-ODA-CICS-ACCTABLE(9:1).  
003414                                                                  
003415     MOVE FSGT-NRRIGORD          TO S007-CICS-PO-ITEM-ACCTABLE    
003416     MOVE S006-PO-ITEM           TO S007-PO-ITEM                  
003417     MOVE FSGT-SOCIETAN          TO S007-COMP-CODE                
003418                                                                  
003419     IF S700-MERCEMAG = 'TR' OR 'LA'                              
003420        MOVE N09-NRPREFAT        TO S007-ODA-CICS-ACCTABLE        
003421        MOVE WS-PO-ITEM3X        TO S007-CICS-PO-ITEM-ACCTABLE.   
003422                                                                  
003423     MOVE FSGT-CENCOSTO          TO S001-CCOSGTM.                 
003424     MOVE FSGT-SOCIETAN          TO S001-SOCI.                    
003425     MOVE FSGT-DIVISION          TO S001-DIPAR.                   
003426     PERFORM L140-SELECT-SAPCCOS                                  
003427        THRU L140-EX.                                             
003428     MOVE S001-CCOSSAP           TO S007-CDC                      
003429                                                                  
003430     MOVE FSGT-CONTDCEN          TO C861-CONTODCE                 
003431     MOVE FSGT-SOCIETAN          TO A531-SOCIEGTM                 
003432     PERFORM L142-SELECT-CONTIDCE                                 
003433        THRU L142-EX.                                             
003434     IF C861-TIPCONTO = '54'                                      
003435        MOVE FSGT-CONTDCEN          TO S013-CDCE-GTM              
003436        PERFORM L145-SELECT-MATGRPCONTI                           
003437           THRU L145-EX                                           
003438     ELSE                                                         
003439        MOVE FSGT-CONTDCEN       TO S012-CDCE-GTM                 
003440        MOVE FSGT-SOCIETAN       TO S012-SOCI                     
003441        PERFORM L150-SELECT-PIANOCONTI                            
003442           THRU L150-EX.                                          
003443                                                                  
003444     MOVE S012-CONTO-COGE        TO S007-CONTO-COGE               
003445                                                                  
003446     IF S478-NRCOMMES > SPACES                                    
003447        MOVE S007-ODA-CICS-ACCTABLE TO WS-ODACICS                 
003448        PERFORM L160-SELECT-COMMESSE                              
003449           THRU L160-EX                                           
003450        MOVE WS-ELEMENTO-WBS     TO S007-WBS                      
003451        INSPECT S007-WBS     REPLACING ALL '#' BY SPACES          
003452        INSPECT S007-WBS     REPLACING ALL '&' BY '-'.            
003453                                                                  
003454     MOVE DTEL-DTINELAB(3:6)     TO S007-DATA-CRT                 
003455                                                                  
003456     PERFORM W65-INSERT-ACCOUNT                                   
003457        THRU W65-EX.                                              
003458                                                                  
003459 W60-EX. EXIT.                                                    
003460*----------------------------------------------------------------*
003461 W65-INSERT-ACCOUNT.                                              
003462*----------------------------------------------------------------*
003463                                                                  
003464     MOVE 'W65-'                 TO WCOM-CODABEND.                
003465     MOVE 'INSERT'               TO WCOM-FILEFUNZ.                
003466     MOVE 'ACCOUNT'              TO WCOM-FILENOME.                
003467     MOVE SPACES                 TO WCOM-FILECTRL.                
003468     STRING S007-ODA-CICS-ACCTABLE ' ' S007-CICS-PO-ITEM-ACCTABLE 
003469        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
003470                                                                  
003472     
      *EXEC SQL 
      *INSERT INTO DBGTM.SAP_ORDACQ_ACCOUNT                    
003473*                 (ODA_CICS_ACCTABLE                               
003474*                 ,CICS_PO_ITEM_ACCTABLE                           
003475*                 ,PO_ITEM                                         
003476*                 ,COMP_CODE                                       
003477*                 ,CDC                                             
003478*                 ,CONTO_COGE                                      
003479*                 ,WBS                                             
003480*                 ,DATA_CRT)                                       
003481*          VALUES (:S007-ODA-CICS-ACCTABLE                         
003482*                 ,:S007-CICS-PO-ITEM-ACCTABLE                     
003483*                 ,:S007-PO-ITEM                                   
003484*                 ,:S007-COMP-CODE                                 
003485*                 ,:S007-CDC                                       
003486*                 ,:S007-CONTO-COGE                                
003487*                 ,:S007-WBS                                       
003488*                 ,:S007-DATA-CRT)                                 
003489*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 72 TO SQL-STMT-ID 
           MOVE 8 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S007-ODA-CICS-ACCTABLE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S007-CICS-PO-ITEM-ACCTABLE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S007-PO-ITEM
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S007-COMP-CODE
            BY VALUE 0
                     0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S007-CDC
            BY VALUE 0
                     0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S007-CONTO-COGE
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S007-WBS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S007-DATA-CRT
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 39 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003490                                                                  
003491     IF SQLCODE NOT EQUAL ZERO                                    
003492        PERFORM Z00-ERRORE                                        
003493           THRU Z00-EX                                            
003494     ELSE                                                         
003495        MOVE 'U'                 TO PPROUTIN                      
003496        MOVE 'D'                 TO PPTPFILE                      
003497        MOVE 'A'                 TO PPTPOPER                      
003498        MOVE WCOM-FILENOME       TO PPNMFILE                      
003499        PERFORM Z90-READPRIN                                      
003500           THRU Z90-EX.                                           
003501                                                                  
003502 W65-EX. EXIT.                                                    
003503*----------------------------------------------------------------*
003504 W80-PREPARA-EM.                                                  
003505*----------------------------------------------------------------*
003506                                                                  
003507     MOVE SPACES                 TO DCLSAP-ORDACQ-EM              
003508     INITIALIZE                     DCLSAP-ORDACQ-EM.             
003509                                                                  
003510     MOVE FSGT-AANUMORD          TO S006-ODA-CICS-ITEMTABLE       
003511     IF FSGT-NOTEXXXX = 'VEND A FORN'                             
003512        MOVE SPACES              TO S006-ODA-CICS-ITEMTABLE       
003513        MOVE FSGT-AANUMORD       TO S006-ODA-CICS-ITEMTABLE(1:8)  
003514        MOVE 'V'                 TO S006-ODA-CICS-ITEMTABLE(9:1). 
003515                                                                  
003516     MOVE S006-ODA-CICS-ITEMTABLE TO S008-ODA-CICS.               
003517                                                                  
003518     MOVE FSGT-NRRIGORD          TO S008-CICS-PO-ITEM             
003519                                    S006-CICS-PO-ITEM-ITEMTABLE   
003520     MOVE FSGT-AANUMMOV          TO S008-RICE-CICS                
003521                                                                  
003522     IF S700-MERCEMAG = 'TR' OR 'LA'                              
003523        MOVE N09-NRPREFAT        TO S008-ODA-CICS                 
003524                                    S006-ODA-CICS-ITEMTABLE       
003525                                    S008-RICE-CICS                
003526        MOVE WS-PO-ITEM3X        TO S008-CICS-PO-ITEM             
003527                                    S006-CICS-PO-ITEM-ITEMTABLE.  
003528                                                                  
003529     PERFORM L170-SELECT-ITEM                                     
003530        THRU L170-EX                                              
003531     IF SQLCODE NOT = ZEROES                                      
003532        PERFORM Z00-ERRORE                                        
003533           THRU Z00-EX.                                           
003534                                                                  
003535     MOVE S006-PO-ITEM           TO S008-PO-ITEM                  
003536     MOVE FSGT-SOCIETAN          TO S008-COMP-CODE                
003537     MOVE DTEL-DTINELAB          TO S008-POST-DATE                
003538     STRING DTEL-DTINELAB(7:2) '.'                                
003539            DTEL-DTINELAB(5:2) '.'                                
003540            DTEL-DTINELAB(1:4)                                    
003541        DELIMITED BY SIZE      INTO S008-POST-DATE.               
003542     MOVE SPACES                 TO S008-ARTICOLO                 
003543     MOVE S006-PLANT             TO S008-PLANT                    
003544                                                                  
003545     MOVE SPACES                 TO S008-STORAGE-LOC              
003546     MOVE FSGT-QTARICEV          TO S008-QUANTITY                 
003547     IF S008-QUANTITY = ZEROES                                    
003548        MOVE FSGT-PREZZOXX       TO S008-QUANTITY.                
003549                                                                  
003550     MOVE SPACES                 TO S008-BOLLA-CONS               
003551     IF FSGT-NUMBOLLA > SPACES                                    
003552        MOVE FSGT-NUMBOLLA       TO WS-COMODOXX                   
003553        MOVE SPACES              TO WS-COMODOX2                   
003554        MOVE ZEROES              TO IND2                          
003555        PERFORM VARYING IND1 FROM 1 BY 1                          
003556                  UNTIL IND1 > 5                                  
003557           IF WS-BYTEBYTE(IND1) > SPACE                           
003558              ADD 1              TO IND2                          
003559              MOVE WS-BYTEBYTE(IND1) TO WS-BYTEBYT2(IND2)         
003560           END-IF                                                 
003561        END-PERFORM                                               
003562        MOVE WS-COMODOX2         TO FSGT-NUMBOLLA                 
003563        MOVE FSGT-NUMBOLLA       TO S008-BOLLA-CONS               
003564        STRING FSGT-GGBOLLAX '.'                                  
003565               FSGT-MMBOLLAX '.'                                  
003566               DTEL-DTINELAB (1:2)                                
003567               FSGT-AABOLLAX                                      
003568           DELIMITED BY SIZE   INTO S008-DATA-BOLLA.              
003569                                                                  
003570     MOVE FSGT-CENCOSTO          TO S001-CCOSGTM.                 
003571     MOVE FSGT-SOCIETAN          TO S001-SOCI.                    
003572     MOVE FSGT-DIVISION          TO S001-DIPAR.                   
003573     PERFORM L140-SELECT-SAPCCOS                                  
003574        THRU L140-EX.                                             
003575     MOVE S001-CCOSSAP           TO S008-CDC                      
003576                                                                  
003577     MOVE FSGT-CONTDCEN          TO C861-CONTODCE                 
003578     MOVE FSGT-SOCIETAN          TO A531-SOCIEGTM                 
003579     PERFORM L142-SELECT-CONTIDCE                                 
003580        THRU L142-EX.                                             
003581                                                                  
003582     IF S478-NRCOMMES > SPACES                                    
003583        MOVE S008-ODA-CICS       TO WS-ODACICS                    
003584        PERFORM L160-SELECT-COMMESSE                              
003585           THRU L160-EX                                           
003586        MOVE WS-ELEMENTO-WBS     TO S008-WBS                      
003587        INSPECT S008-WBS     REPLACING ALL '#' BY SPACES          
003588        INSPECT S008-WBS     REPLACING ALL '&' BY '-'.            
003589                                                                  
003590     MOVE S008-ODA-CICS          TO S005-ODA-CICS                 
003591     PERFORM L97-SELECT-TESTATA                                   
003592        THRU L97-EX                                               
003593     IF SQLCODE = ZERO                                            
003594        MOVE '--'                TO WS-NOSAPXXX.                  
003595                                                                  
003596     MOVE 'X'                    TO S008-CRT-EM                   
003597     MOVE 'IN'                   TO S008-CRT-EM-ST                
003598     IF WS-NOSAPXXX = '--'                                        
003599        MOVE '--'                TO S008-CRT-EM-ST.               
003600                                                                  
003601     IF (FSGT-NOTEXXXX = 'VEND A FORN' AND                        
003602         FSGT-SOCIETAN = '25'             ) OR                    
003603        (FSGT-F-R-S-XX     = 'R'  AND                             
003604         A972-CODPAESE NOT = '000'   )                            
003605        MOVE 'WW'                TO S008-CRT-EM-ST.               
003606                                                                  
003607     PERFORM L180-SELECT-EM                                       
003608        THRU L180-EX.                                             
003609     MOVE S008-CRT-PROGR-NUM     TO WS-NUMPROGR-X                 
003610     ADD 1                       TO WS-NUMPROGR-9                 
003611     MOVE WS-NUMPROGR-X          TO S008-CRT-PROGR-NUM            
003612                                                                  
003613     MOVE '101'                  TO S008-TIPO-MOV                 
003614                                                                  
003615     MOVE DTEL-DTINELAB(3:6)     TO S008-DATA-CRT                 
003616                                                                  
003617     PERFORM W85-INSERT-EM                                        
003618        THRU W85-EX.                                              
003619                                                                  
003620 W80-EX. EXIT.                                                    
003621*----------------------------------------------------------------*
003622 W85-INSERT-EM.                                                   
003623*----------------------------------------------------------------*
003624                                                                  
003625     MOVE 'W85-'                 TO WCOM-CODABEND.                
003626     MOVE 'INSERT'               TO WCOM-FILEFUNZ.                
003627     MOVE 'EM'                   TO WCOM-FILENOME.                
003628     MOVE SPACES                 TO WCOM-FILECTRL.                
003629     STRING S008-ODA-CICS ' ' S008-CICS-PO-ITEM                   
003630        DELIMITED BY SIZE      INTO WCOM-FILECTRL                 
003631                                                                  
003633     
      *EXEC SQL 
      *INSERT INTO DBGTM.SAP_ORDACQ_EM                         
003634*                 (ODA_CICS                                        
003635*                 ,PO_ITEM                                         
003636*                 ,CICS_PO_ITEM                                    
003637*                 ,COMP_CODE                                       
003638*                 ,RICE_CICS                                       
003639*                 ,POST_DATE                                       
003640*                 ,ARTICOLO                                        
003641*                 ,PLANT                                           
003642*                 ,STORAGE_LOC                                     
003643*                 ,QUANTITY                                        
003644*                 ,BOLLA_CONS                                      
003645*                 ,DATA_BOLLA                                      
003646*                 ,CDC                                             
003647*                 ,WBS                                             
003648*                 ,CRT_EM                                          
003649*                 ,CRT_EM_ST                                       
003650*                 ,CRT_PROGR_NUM                                   
003651*                 ,TIPO_MOV                                        
003652*                 ,DATA_CRT)                                       
003653*          VALUES (:S008-ODA-CICS                                  
003654*                 ,:S008-PO-ITEM                                   
003655*                 ,:S008-CICS-PO-ITEM                              
003656*                 ,:S008-COMP-CODE                                 
003657*                 ,:S008-RICE-CICS                                 
003658*                 ,:S008-POST-DATE                                 
003659*                 ,:S008-ARTICOLO                                  
003660*                 ,:S008-PLANT                                     
003661*                 ,:S008-STORAGE-LOC                               
003662*                 ,:S008-QUANTITY                                  
003663*                 ,:S008-BOLLA-CONS                                
003664*                 ,:S008-DATA-BOLLA                                
003665*                 ,:S008-CDC                                       
003666*                 ,:S008-WBS                                       
003667*                 ,:S008-CRT-EM                                    
003668*                 ,:S008-CRT-EM-ST                                 
003669*                 ,:S008-CRT-PROGR-NUM                             
003670*                 ,:S008-TIPO-MOV                                  
003671*                 ,:S008-DATA-CRT)                                 
003672*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 73 TO SQL-STMT-ID 
           MOVE 19 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S008-ODA-CICS
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S008-PO-ITEM
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S008-CICS-PO-ITEM
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S008-COMP-CODE
            BY VALUE 0
                     0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S008-RICE-CICS
            BY VALUE 0
                     0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S008-POST-DATE
            BY VALUE 0
                     0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S008-ARTICOLO
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S008-PLANT
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S008-STORAGE-LOC
            BY VALUE 0
                     0

           MOVE 781 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S008-QUANTITY
            BY VALUE 0
                     0

           MOVE 16 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S008-BOLLA-CONS
            BY VALUE 0
                     0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S008-DATA-BOLLA
            BY VALUE 0
                     0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S008-CDC
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S008-WBS
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S008-CRT-EM
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S008-CRT-EM-ST
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S008-CRT-PROGR-NUM
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 17 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S008-TIPO-MOV
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 18 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S008-DATA-CRT
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 40 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003673                                                                  
003674     IF SQLCODE NOT EQUAL ZERO                                    
003675        PERFORM Z00-ERRORE                                        
003676           THRU Z00-EX                                            
003677     ELSE                                                         
003678        MOVE 'U'                 TO PPROUTIN                      
003679        MOVE 'D'                 TO PPTPFILE                      
003680        MOVE 'A'                 TO PPTPOPER                      
003681        MOVE WCOM-FILENOME       TO PPNMFILE                      
003682        PERFORM Z90-READPRIN                                      
003683           THRU Z90-EX.                                           
003684                                                                  
003685 W85-EX. EXIT.                                                    
003686*----------------------------------------------------------------*
003687 W99-UPDATE-HEADER.                                               
003688*----------------------------------------------------------------*
003689                                                                  
003690     MOVE 'W99-'                 TO WCOM-CODABEND.                
003691     MOVE 'UPDATE'               TO WCOM-FILEFUNZ.                
003692     MOVE 'HEADER'               TO WCOM-FILENOME.                
003693     MOVE S005-ODA-CICS          TO WCOM-FILECTRL.                
003694                                                                  
003696     
      *EXEC SQL 
      *UPDATE DBGTM.SAP_ORDACQ_HEADER                          
003697*             SET CRT_ST = '--'                                    
003698*           WHERE ODA_CICS = :S005-ODA-CICS                        
003699*             AND   CRT_ST = 'IN'                                  
003700*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 74 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S005-ODA-CICS
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 41 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003701                                                                  
003702     IF SQLCODE EQUAL ZERO                                        
003703        MOVE 'U'                 TO PPROUTIN                      
003704        MOVE 'D'                 TO PPTPFILE                      
003705        MOVE 'U'                 TO PPTPOPER                      
003706        MOVE WCOM-FILENOME       TO PPNMFILE                      
003707        PERFORM Z90-READPRIN                                      
003708           THRU Z90-EX.                                           
003709                                                                  
003710 W99-EX. EXIT.                                                    
003711*----------------------------------------------------------------*
003712 Z00-ERRORE.                                                      
003713*----------------------------------------------------------------*
003714                                                                  
003715     MOVE 'SCDB2ER'              TO PPCALL.                       
003716     CALL  PPCALL USING DCPARM DCDB2ER SQLCA.                     
003717                                                                  
003718 Z00-EX. EXIT.                                                   
003719*----------------------------------------------------------------*
003720 Z90-READPRIN.                                                    
003721*----------------------------------------------------------------*
003722                                                                  
003723     MOVE 'READPRIN'             TO PPCALL.                       
003724     CALL  PPCALL USING DCPARM.                                   
003725                                                                  
003726 Z90-EX. EXIT.                                                    
