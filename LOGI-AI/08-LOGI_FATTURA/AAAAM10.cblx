      *((program: AAAAM10.cblx))
000001*-------------* PROGRAMMA  BATCH  MVS COBOL2  *------------------*
000002 ID  DIVISION.                                                    
000003*-------------*                                                   
000004 PROGRAM-ID. AAAAM10.                  
000005                                                                  
000006******************************************************************
000007*                                                                *
000008*   IL PROGRAMMA INSERISCE SULLE TABELLE CONTABILI I MOVIMENTI   *
000009*   PROVENIENTI DALLA FATTURAZIONE AUTOMATICA                    *
000010*   (FATTURE E RESI DI CONTO VENDITA) DOPO AVER                  *
000011*   SUDDIVISO GLI IMPORTI A LIVELLO DI CONTO-DCE E SCADENZA.     *
000012*                                                                *
000013******************************************************************
000014                                                                  
000015 ENVIRONMENT DIVISION.                                            
000016*---------------------*                                           
000017 CONFIGURATION SECTION.                                           
000018 SPECIAL-NAMES.                                                   
000019      DECIMAL-POINT IS COMMA.                                     
000020 INPUT-OUTPUT SECTION.                                            
000021 FILE-CONTROL.                                                    
000022     SELECT FILEINP       ASSIGN TO UT-S-FILEINP.                 
000023                                                                  
000024 DATA DIVISION.                                                   
000025*--------------*                                                  
000026 FILE SECTION.                                                    
000027 FD  FILEINP                                                      
000028     RECORDING MODE IS F                                          
000029     BLOCK CONTAINS 0 RECORDS.                                    
000030 01  REC-FILEINP                 PIC X(550).                      
000031                                                                  
000032 WORKING-STORAGE SECTION.

       01  SQLDA-ID pic 9(4) comp-5.
       01  SQLDSIZE pic 9(4) comp-5.
       01  SQL-STMT-ID pic 9(4) comp-5.
       01  SQLVAR-INDEX pic 9(4) comp-5.
       01  SQL-DATA-TYPE pic 9(4) comp-5.
       01  SQL-HOST-VAR-LENGTH pic 9(9) comp-5.
       01  SQL-S-HOST-VAR-LENGTH pic 9(9) comp-5.
       01  SQL-S-LITERAL pic X(258).
       01  SQL-LITERAL1 pic X(130).
       01  SQL-LITERAL2 pic X(130).
       01  SQL-LITERAL3 pic X(130).
       01  SQL-LITERAL4 pic X(130).
       01  SQL-LITERAL5 pic X(130).
       01  SQL-LITERAL6 pic X(130).
       01  SQL-LITERAL7 pic X(130).
       01  SQL-LITERAL8 pic X(130).
       01  SQL-LITERAL9 pic X(130).
       01  SQL-LITERAL10 pic X(130).
       01  SQL-IS-LITERAL pic 9(4) comp-5 value 1.
       01  SQL-IS-INPUT-HVAR pic 9(4) comp-5 value 2.
       01  SQL-CALL-TYPE pic 9(4) comp-5.
       01  SQL-SECTIONUMBER pic 9(4) comp-5.
       01  SQL-INPUT-SQLDA-ID pic 9(4) comp-5.
       01  SQL-OUTPUT-SQLDA-ID pic 9(4) comp-5.
       01  SQLA-PROGRAM-ID.
           05 SQL-PART1 pic 9(4) COMP-5 value 172.
           05 SQL-PART2 pic X(6) value "AEAQAI".
           05 SQL-PART3 pic X(24) value "LBjdHBGn01111 2         ".
           05 SQL-PART4 pic 9(4) COMP-5 value 8.
           05 SQL-PART5 pic X(8) value "DB2XMT  ".
           05 SQL-PART6 pic X(120) value LOW-VALUES.
           05 SQL-PART7 pic 9(4) COMP-5 value 8.
           05 SQL-PART8 pic X(8) value "AAAAM10 ".
           05 SQL-PART9 pic X(120) value LOW-VALUES.
                                                                        
000033 01  FILLER                      PIC X(8) VALUE '*DCPARM*'.       
000034*    COPY DCPARM.                                                 
      *>>((file: DCPARM))
000001***************************************************************** 
000002*******                                                         * 
000003*******       A R E A   P A R A M E T R I C A       *COBOL*     * 
000004*******                                                         * 
000005***************************************************************** 
000006 01  DCPARM.                                                      
000007*******  PPNAME   = NOME PROGRAMMA                                
000008     02  PPNAME           PIC X(8)    VALUE SPACES.               
000009*******  PPROUTIN = ROUTINE DA ESEGUIRE                           
000010     02  PPROUTIN         PIC X       VALUE SPACES.               
000011     02  PPSTAT           PIC X(4)    VALUE SPACES.               
000012*******  PPNUSK   = NUMERO DI SCHEDE X LA FUNZIONE -N-            
000013     02  PPNUSK           PIC X(2)    VALUE SPACES.               
000014     02  PPFIRST          PIC X       VALUE SPACES.               
000015*******                                                           
000016*********************** SKEDE PARAMETRO - MAX 10 **************** 
000017*******                                                           
000018     02  SK-PARM.                                                 
000019         05  PPSK1            PIC X(80)   VALUE SPACES.           
000020         05  PPSK2            PIC X(80)   VALUE SPACES.           
000021         05  PPSK3            PIC X(80)   VALUE SPACES.           
000022         05  PPSK4            PIC X(80)   VALUE SPACES.           
000023         05  PPSK5            PIC X(80)   VALUE SPACES.           
000024         05  PPSK6            PIC X(80)   VALUE SPACES.           
000025         05  PPSK7            PIC X(80)   VALUE SPACES.           
000026         05  PPSK8            PIC X(80)   VALUE SPACES.           
000027         05  PPSK9            PIC X(80)   VALUE SPACES.           
000028         05  PPSK10           PIC X(80)   VALUE SPACES.           
000029         05  PPSK11           PIC X(80)   VALUE SPACES.           
000030     02  TAB-SK-PARM REDEFINES SK-PARM.                           
000031         05  EL-SK-PARM OCCURS 11 TIMES.                          
000032             10  NAME-SK-PARM     PIC XX.                         
000033             10  FILLER           PIC X.                          
000034             10  DATA-SK-PARM     PIC X(77).                      
000035*******                                                           
000036*********************** ELEMENTO DI RICERCA ********************* 
000037*******                                                           
000038*******  PPNMFILE  = NOME FILE                                    
000039     02  PPNMFILE         PIC X(7)    VALUE SPACES.               
000040*******  PPTPFILE  = TIPO FILE                                    
000041     02  PPTPFILE         PIC X(1)    VALUE SPACES.               
000042*******  PPTPOPER  = TIPO OPERAZIONE                              
000043     02  PPTPOPER         PIC X(1)    VALUE SPACES.               
000044     02  FILLER           PIC X(7)    VALUE SPACES.               
000045*******                                                           
000046*********************** TABELLA DI 30 ELEMENTI ****************** 
000047*******                                                           
000048     02  TAB-CONTATORI.                                           
000049         05  EL-CONTATORI OCCURS 30 TIMES.                        
000050             10  EL-PPNMFILE      PIC X(7)        VALUE SPACES.   
000051             10  EL-PPTPFILE      PIC X           VALUE SPACES.   
000052             10  EL-PPTPOPER      PIC X           VALUE SPACES.   
000053             10  EL-CONTATOR      PIC 9(9) COMP-3 VALUE ZEROES.   
000054             10  EL-FILLER        PIC XX          VALUE SPACES.   
000055*    02  FILLER           PIC X(7)     VALUE SPACES.              
000056*******              TIPO FILE                                    
000057*    02  FILLER           PIC X(1)     VALUE SPACES.              
000058*******              TIPO OPERAZIONE                              
000059*    02  FILLER           PIC X(1)     VALUE SPACES.              
000060*******              NUMERO OPERAZIONI                            
000061*    02  FILLER           PIC 9(9)     COMP-3    VALUE ZERO.      
000062*    02  FILLER           PIC X(2)     VALUE SPACES.              
000063*******  29 CAMPI DA 16 BYTES, IN TOTALE 464 BYTES                
000064*    02  FILLER           PIC X(464)   VALUE SPACES.              
000065*******                                                           
000066*********************** STAMPA MESSAGGI ************************* 
000067*******                                                           
000068*******  PPMESSAG  = MESSAGGIO DA STAMPARE                        
000069     02  PPMESSAG         PIC X(132)  VALUE SPACES.               
000070     02  FILLER           PIC X(4)    VALUE SPACES.               
000071*******                                                           
000072*********************** DATE DA TABE TABPRODA ******************* 
000073*******                                                           
000074*******  DATA-PROG = NOME ELEMENTO DI TABE TABPRODA               
000075     02  DATA-PROG        PIC X(7)    VALUE SPACES.               
000076*******  DATA-TIPO = TIPO DI DATA  DI TABE TABPRODA               
000077     02  DATA-TIPO        PIC X       VALUE SPACES.               
000078*******  DATA-INIZ = DATA INIZIO PERIODO                          
000079     02  DATA-INIZ.                                               
000080         05  GG-INIZ.                                             
000081             10  SS-CORSO PIC XX      VALUE SPACES.               
000082         05  MM-INIZ      PIC XX      VALUE SPACES.               
000083         05  AA-INIZ      PIC XX      VALUE SPACES.               
000084*******  DATA-FINE = DATA FINE PERIODO                            
000085     02  DATA-FINE.                                               
000086         05  GG-FINE      PIC XX      VALUE SPACES.               
000087         05  MM-FINE      PIC XX      VALUE SPACES.               
000088         05  AA-FINE      PIC XX      VALUE SPACES.               
000089     02  FILLER           PIC X(4)    VALUE SPACES.               
000090*******                                                           
000091*********************** CALL GENERALIZZATA ********************** 
000092*******                                                           
000093*******  PPCALL    = NOME MODULO X CALLER                         
000094     02  PPCALL           PIC X(8)    VALUE SPACES.               
000095*******                                                           
000096***************************************************************** 
000097*  EJECT                                                          
      *<<((file: DCPARM))
000035 01  FILLER                      PIC X(8) VALUE 'DCDB2ER*'.       
000036*    COPY DCDB2ER.                                                
      *>>((file: DCDB2ER))
000001******************************************************************
000002*****               AREA PER MODULO SCDB2ER                  *****
000003******************************************************************
000004 01  DCDB2ER.                                                     
000005     02 WCOM-LUNGHEZZ         PIC S9(3) COMP-3 VALUE +171.        
000006     02 WCOM-FILEFUNZ         PIC X(10).                          
000007     02 WCOM-FILENOME         PIC X(30).                          
000008     02 WCOM-FILECTRL         PIC X(30).                          
000009     02 WCOM-MESSAGES         PIC X(80).                          
000010     02 WCOM-CODABEND         PIC X(4).                           
000011     02 MESS-CODERROR         PIC X(6).                           
000012     02 WSWERROR              PIC X.                              
000013        88 ERRORE             VALUE '*'.                          
000014     02 WCOM-PROGNAME         PIC X(8).                           
      *<<((file: DCDB2ER))
000037 01  FILLER                      PIC X(8) VALUE '*DCARR0*'.       
000038*    COPY DCARR0.                                                 
      *>>((file: DCARR0))
000001******************************************************************
000002******              AREA PER SUBROUTINE SRARR0              ******
000003******************************************************************
000004 01  DCARR0.                                                      
000005     05  ARR0-INPUT.                                              
000006         10  ARR0-DECIDIVI            PIC X.                      
000007     05  ARR0-INPUT-OUTPUT.                                       
000008         10  ARR0-IMPORTOX            PIC S9(11)V9(4) COMP-3.     
000009     05  ARR0-COMODI.                                             
000010         10  ARR0-INTEROXX            PIC S9(11)    COMP-3.       
000011         10  ARR0-DECIMA1X            PIC S9(11)V9  COMP-3.       
000012         10  ARR0-DECIMA2X            PIC S9(11)V99 COMP-3.       
      *<<((file: DCARR0))
000039 01  FILLER                      PIC X(8) VALUE '*DCARR1*'.       
000040*    COPY DCARR1.                                                 
      *>>((file: DCARR1))
000001******************************************************************
000002******              AREA PER SUBROUTINE SRARR1              ******
000003******************************************************************
000004 01  DCARR1.                                                      
000005     05  ARR1-INPUT.                                              
000006         10  ARR1-CODDIVIS            PIC XX.                     
000007         10  ARR1-DECIDIVI            PIC X.                      
000008         10  ARR1-CODPAESE            PIC X(3).                   
000009     05  ARR1-INPUT-OUTPUT.                                       
000010         10  ARR1-IMPORTOX            PIC S9(11)V9(4) COMP-3.     
000011     05  ARR1-COMODI.                                             
000012         10  ARR1-ARROTIVA            PIC S9(3)V9(4)  COMP-3.     
000013         10  ARR1-INTEROXX            PIC S9(11)      COMP-3.     
000014         10  ARR1-DECIMA2X            PIC S9(11)V99   COMP-3.     
      *<<((file: DCARR1))
000041 01  FILLER                      PIC X(8) VALUE '*DCNMFA*'.       
000042*    COPY DCNMFA.                                                 
      *>>((file: DCNMFA))
000001*===============================================================* 
000002*  COPY PER CHIAMATE AI MODULI SCBNMFA / SCTNMFA                * 
000003*===============================================================* 
000004******************************************************************
000005*                                                                *
000006*                    ***   DCNMFA   ***                          *
000007*                                                                *
000008*         STATUS RISPOSTA :  '****' SE TUTTO OK.                 *
000009*                            'NTRO' SE COMBINAZIONE NON TROVATA  *
000010*                                   SU MULTITABLE 'NORMEFAT'.    *
000011*                            'DATI' SE MANCANO DATI IN INPUT     *
000012*                                                                *
000013*         DATI IN  INPUT  :  CODICE PAESE SOCIETA'               *
000014*                            CODICE PAESE FATTURA                *
000015*                            CODICE PAESE MERCE                  *
000016*                            CODICE SOCIETA'                     *
000017*                            NUMERO FATTURA PROFORMA             *
000018*                                                                *
000019*         DATI IN OUTPUT  :  INDICATORE SI/NO I.V.A.             *
000020*                            CODICE ESENZIONE I.V.A.             *
000021*                            TIPO PART.IVA DA USARE              *
000022*                            INDICATORE SI/NO INTRASTAT          *
000023*                            INDICATORE SI/NO TRANSAZIONE        *
000024*                                       TRIANGOLARE              *
000025*   LUNGHEZZA = 100                                              *
000026******************************************************************
000027                                                                  
000028 01  DCNMFA.                                                      
000029     05  NMFA-RISPOSTA           PIC X(4)   VALUE SPACES.         
000030     05  NMFA-PAESOCIE           PIC X(3)   VALUE SPACES.         
000031     05  NMFA-PAEFATTU           PIC X(3)   VALUE SPACES.         
000032     05  NMFA-PAEMERCE           PIC X(3)   VALUE SPACES.         
000033     05  NMFA-CODSOCIE           PIC XX     VALUE SPACES.         
000034     05  NMFA-FLAGGIVA           PIC X      VALUE SPACES.         
000035     05  NMFA-ESENTIVA           PIC X      VALUE SPACES.         
000036     05  NMFA-FLPARIVA           PIC X      VALUE SPACES.         
000037     05  NMFA-FLAGINTR           PIC X      VALUE SPACES.         
000038     05  NMFA-FLDESFAT           PIC X      VALUE SPACES.         
000039     05  NMFA-CDIVACEE           PIC X(14)  VALUE SPACES.         
000040     05  NMFA-NRFATPRO           PIC X(6)   VALUE SPACES.         
000041     05  NMFA-COMBINAZ           PIC X(7)   VALUE SPACES.         
000042     05  NMFA-CTRLXIVA           PIC X      VALUE SPACES.         
000043     05  NMFA-CODCLIEN           PIC X(5)   VALUE SPACES.         
000044     05  NMFA-FILLER             PIC X(47)  VALUE SPACES.         
000045                                                                  
000046******************************************************************
000047 EJECT                                                            
      *<<((file: DCNMFA))
000043 01  FILLER                      PIC X(8) VALUE 'FSINFR00'.       
000044*    COPY FSINFR00.                                               
      *>>((file: FSINFR00))
000001******************************************************************
000002*                                                                *
000003*                         -- FSINFR00 --                         *
000004*                                                                *
000005*  DSECT RELATIVA AL FILE SEQUENZIALE CONTENENTE I DATI          *
000006*  CHE SERVONO PER IL CALCOLO DELLE REGISTRAZIONI CONTABILI      *
000007*  DA ESEGUIRE A FRONTE DI FATTURE E RESI EMESSI NEL GIORNO.     *
000008*                                                                *
000009*                   -- LUNGHEZZA  550 BYTES --                   *
000010*                                                                *
000011******************************************************************
000012 01  FSINFR00.                                                    
000013     05 FR00-CODSOCIE            PIC X(02).                       
000014     05 FR00-CODCLIEN            PIC X(05).                       
000015     05 FR00-CDMOVCON            PIC X(01).                       
000016     05 FR00-NRMOVCON            PIC X(06).                       
000017     05 FR00-DTREGMOV            PIC X(08).                       
000018     05 FR00-DTDECORR            PIC X(08).                       
000019     05 FR00-CAUSACON            PIC X(01).                       
000020     05 FR00-TIPOPAGA            PIC X(01).                       
000021     05 FR00-CONDPAGA            PIC X(03).                       
000022     05 FR00-CODDIVIS            PIC X(02).                       
000023     05 FR00-CODAGENT            PIC X(02).                       
000024     05 FR00-CDSELMOV            PIC X(01).                       
000025     05 FR00-CDSELTIP            PIC X(01).                       
000026     05 FR00-INDSEGNO            PIC X(01).                       
000027     05 FR00-NRMOVRIF            PIC X(06).                       
000028     05 FR00-IMPMOVIM            PIC S9(11)V99 COMP-3.            
000029     05 FR00-CVLMOVIM            PIC S9(11)V99 COMP-3.            
000030     05 FR00-IMPROFAT            PIC S9(09)V99 COMP-3.            
000031     05 FR00-SCONTDED            PIC S9(09)V99 COMP-3.            
000032     05 FR00-CVLSCDED            PIC S9(09)V99 COMP-3.            
000033     05 FR00-ADDFATTU            PIC S9(03)V99 COMP-3.            
000034     05 FR00-IMPADIVA            PIC S9(09)V99 COMP-3.            
000035     05 FR00-CVLADIVA            PIC S9(09)V99 COMP-3.            
000036     05 FR00-TIPOMOVI            PIC X(01).                       
000037     05 FR00-CENCOSTO            PIC X(05).                       
000038     05 FR00-BANDIVAL            PIC X(03).                       
000039     05 FR00-NRDICVAL            PIC X(06).                       
000040     05 FR00-VOCEDOPR            PIC X(08).                       
000041     05 FR00-IMPDOGPR            PIC S9(11)V99 COMP-3.            
000042     05 FR00-CDCEACQU            PIC X(06).                       
000043     05 FR00-CODUTVAR            PIC X(06).                       
000044     05 FR00-GENEFATT            PIC X.                           
000045     05 FR00-DATISCAD OCCURS 4.                                   
000046        10 FR00-DTSCADEN         PIC X(08).                       
000047        10 FR00-IMPSCADE         PIC S9(11)V99 COMP-3.            
000048        10 FR00-CVLSCADE         PIC S9(11)V99 COMP-3.            
000049        10 FR00-PRCSCADE         PIC S9(3)V99  COMP-3.            
000050     05 FR00-DATIXDCE OCCURS 5.                                   
000051        10 FR00-CONTODCE         PIC X(06).                       
000052        10 FR00-IMPORDCE         PIC S9(11)V99 COMP-3.            
000053        10 FR00-CVLXXDCE         PIC S9(11)V99 COMP-3.            
000054        10 FR00-ESENTIVA         PIC X(01).                       
000055        10 FR00-PERCEIVA         PIC S9(03)V99 COMP-3.            
000056        10 FR00-IMPORIVA         PIC S9(09)V99 COMP-3.            
000057        10 FR00-CVLXXIVA         PIC S9(09)V99 COMP-3.            
000058     05 FR00-NOTENOTE            PIC X(26).                       
000059     05 FR00-NRFATPRO            PIC X(06).                       
000060     05 FR00-SLTIPLIN            PIC X(01).                       
000061     05 FR00-CLIEMERC            PIC X(05).                       
000062     05 FR00-DATESIVA            PIC X(08).                       
000063     05 FR00-UFFICIVA            PIC X(18).                       
000064     05 FR00-NUMESIVA            PIC X(05).                       
000065     05 FR00-CDMOVRIF            PIC X(01).                       
000066     05 FR00-DATAMRIF            PIC X(08).                       
000067     05 FR00-CONDXASS            PIC X(01).                       
000068     05 FR00-FLEXECON            PIC X(01).                       
000069     05 FR00-FLAGXJDE            PIC X(01).                       
000070     05 FR00-VALTRASP            PIC S9(09)V99 COMP-3.            
000071     05 FR00-CVLTRASP            PIC S9(09)V99 COMP-3.            
000072     05 FR00-FILLERXX            PIC X(39).                       
      *<<((file: FSINFR00))
000045                                                                  
000046 01  EOF                         PIC X(2) VALUE 'NO'.             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000047 01  W-DECIDISO                  PIC X    VALUE SPACES.           
000048 01  W-DECIDIVI                  PIC X    VALUE SPACES.           
000049 01  W-CODDIVSO                  PIC X(2) VALUE SPACES.           
000050 01  W-CODDIVIS                  PIC X(2) VALUE SPACES.           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000051 01  FILLER                      PIC X(8) VALUE 'SK-PARAM'.       
000052 01  SK-PARAM.                                                    
000053     05 FILLER                   PIC X(12).                       
000054     05 SK-AGGIORNA              PIC XX.                          
000055     05 FILLER                   PIC X(66).                       
000056 01  FILLER                      PIC X(8) VALUE 'COMODIII'.       
000057 01  COMODI.                                                      
000058     05 W-NUMPROG3               PIC 9(3).                        
000059     05 W-CENCOSTO               PIC X(5).                        
000060     05 WS-CONTODCE              PIC 9(6).                        
000061     05 W-PAESOCIE               PIC X(3).                        
000062     05 W-CONTODCE               PIC X(6).                        
000063     05 W-INDDCE                 PIC 99.                          
000064     05 W-INDSCA                 PIC 99.                          
000065     05 W-INDTAB                 PIC 99.                          
000066     05 W-INDSAV                 PIC 99.                          
000067     05 W-INDTDCE                PIC 99.                          
000068     05 W-INDQUAD                PIC 99.                          
000069     05 W-SAVINDCE               PIC 99.                          
000070     05 W-TOTCVLDC               PIC S9(11)V99 COMP-3.            
000071     05 W-TOTCVTRA               PIC S9(11)V99 COMP-3.            
000072     05 W-TOTTRASP               PIC S9(11)V99 COMP-3.            
000073     05 W-TOTCVLSC               PIC S9(11)V99 COMP-3.            
000074     05 W-SAVEIMPO               PIC S9(11)V99 COMP-3.            
000075     05 W-SAVECVAL               PIC S9(11)V99 COMP-3.            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000076     05 W-MONTFAT1               PIC S9(11)V99 COMP-3.            
000077     05 W-MONTRES1               PIC S9(11)V99 COMP-3.            
000078     05 W-MONSCOF1               PIC S9(11)V99 COMP-3.            
000079     05 W-IMPNOIVA               PIC S9(11)    COMP-3.            
000080     05 W-IMPSCOPE               PIC S9(11)V99 COMP-3.            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000081     05 W-TOTSCONT               PIC S9(11)V99 COMP-3.            
000082     05 W-COMODIFF               PIC S9(11)V99 COMP-3.            
000083     05 W-DCEIMPOR               PIC S9(11)V99 COMP-3.            
000084     05 W-DCECVALO               PIC S9(11)V99 COMP-3.            
000085     05 W-DCEIMIVA               PIC S9(9)V99  COMP-3.            
000086     05 W-DCECVIVA               PIC S9(9)V99  COMP-3.            
000087     05 W-DCEIADZI               PIC S9(9)V99  COMP-3.            
000088     05 W-DCECADZI               PIC S9(9)V99  COMP-3.            
000089     05 W-TABSCADCE OCCURS 20.                                    
000090        10 W-DCE-DTSCA           PIC X(8).                        
000091        10 W-DCE-CODCE           PIC X(6).                        
000092        10 W-DCE-ESENT           PIC X.                           
000093        10 W-DCE-IMPOR           PIC S9(11)V99 COMP-3.            
000094        10 W-DCE-CVLOR           PIC S9(11)V99 COMP-3.            
000095        10 W-DCE-PERIV           PIC S9(3)V99  COMP-3.            
000096        10 W-DCE-IMIVA           PIC S9(9)V99  COMP-3.            
000097        10 W-DCE-CVIVA           PIC S9(9)V99  COMP-3.            
000098        10 W-DCE-IMCAL           PIC S9(11)V9999 COMP-3.          
000099        10 W-DCE-CVCAL           PIC S9(11)V9999 COMP-3.          
000100        10 W-DCE-IIVAC           PIC S9(9)V9999  COMP-3.          
000101        10 W-DCE-CIVAC           PIC S9(9)V9999  COMP-3.          
000102        10 W-DCE-IADZC           PIC S9(9)V9999  COMP-3.          
000103        10 W-DCE-CADZC           PIC S9(9)V9999  COMP-3.          
000104        10 W-DCE-PRCAL           PIC S9(3)V9999  COMP-3.          
000105                                                                  
000106     05 W-TABTOTDCE.                                              
000107        10 W-TABTOTELE OCCURS 5.                                  
000108           15 W-TDC-CODCE        PIC X(6).                        
000109           15 W-TDC-IMCAL        PIC S9(11)V99 COMP-3.            
000110           15 W-TDC-CVCAL        PIC S9(11)V99 COMP-3.            
000111           15 W-TDC-IIVAC        PIC S9(9)V99  COMP-3.            
000112           15 W-TDC-CIVAC        PIC S9(9)V99  COMP-3.            
000113           15 W-TDC-IADZC        PIC S9(9)V99  COMP-3.            
000114           15 W-TDC-CADZC        PIC S9(9)V99  COMP-3.            
000115                                                                  
000116     05 W-TABSCADEN OCCURS 4.                                     
000117        10 W-SCA-DTSCA           PIC X(8).                        
000118        10 W-SCA-IMPQU           PIC S9(11)V99 COMP-3.            
000119        10 W-SCA-CVLQU           PIC S9(11)V99 COMP-3.            
000120        10 W-SCA-IMPOR           PIC S9(11)V99 COMP-3.            
000121        10 W-SCA-CVLOR           PIC S9(11)V99 COMP-3.            
000122        10 W-SCA-IMIVA           PIC S9(9)V99  COMP-3.            
000123        10 W-SCA-CVIVA           PIC S9(9)V99  COMP-3.            
000124        10 W-SCA-SCDED           PIC S9(11)V99 COMP-3.            
000125        10 W-SCA-PRCAL           PIC S9(3)V99  COMP-3.            
000126        10 W-SCA-TRASP           PIC S9(11)V99 COMP-3.            
000127        10 W-SCA-CVTRA           PIC S9(11)V99 COMP-3.            
000128                                                                  
000129*--------------------------------DANAGRAF.TMULTITABLE (VBVENCON)  
000130 01  FILLER                      PIC X(12) VALUE '**FDANAC60**'.  
000133*    EXEC SQL                                                     
      *        INCLUDE FDANAC60                                         
      *    END-EXEC.                                                    
      *>>((file: FDANAC60))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.VANAGRAF_C60)                            *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANAC60))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        QUOTE                                                   *
000007* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000008******************************************************************
000009     
      *EXEC SQL DECLARE DANAGRAF.VANAGRAF_C60 TABLE                 
000010*     ( SOCIEVEN                       CHAR(10) NOT NULL,          
000011*       SOCIEACQ                       CHAR(20) NOT NULL,          
000012*       CLIFOCON                       CHAR(20) NOT NULL,          
000013*       CENCOSTO                       CHAR(20) NOT NULL,          
000014*       CODDIVRI                       CHAR(20) NOT NULL,          
000015*       CODDIVIS                       CHAR(20) NOT NULL,          
000016*       CODPAESE                       CHAR(40) NOT NULL,          
000017*       CONTODCE                       DECIMAL(13, 3) NOT NULL     
000018*     ) END-EXEC
                                                                        
000019******************************************************************
000020* COBOL DECLARATION FOR TABLE DANAGRAF.VANAGRAF_C60              *
000021******************************************************************
000022 01  DCLVANAGRAF-C60.                                             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000023     10 AC60-SOCIEVEN        PIC X(10).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000024     10 AC60-SOCIEACQ        PIC X(20).                           
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000025     10 AC60-CLIFOCON        PIC X(20).                           
000026     10 AC60-CENCOSTO        PIC X(20).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000027     10 AC60-CODDIVRI        PIC X(20).                           
000028     10 AC60-CODDIVIS        PIC X(20).                           
000029     10 AC60-CODPAESE        PIC X(40).                           
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000030     10 AC60-CONTODCE        PIC S9(10)V9(3) USAGE COMP-3.        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000031******************************************************************
000032* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 8       *
000033******************************************************************
      *<<((file: FDANAC60))
000134*--------------------------------DANAGRAF.TMULTITABLE (ASSIMIN)   
000135 01  FILLER                      PIC X(12) VALUE '**FDANAB53**'.  
000138*    EXEC SQL                                                     
      *        INCLUDE FDANAB53                                         
      *    END-EXEC.                                                    
      *>>((file: FDANAB53))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.VANAGRAF_B53)                            *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANAB53))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(AB53-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DANAGRAF.VANAGRAF_B53 TABLE                 
000012*     ( CODSOCIE                       CHAR(10) NOT NULL,          
000013*       CODDIVIS                       CHAR(20) NOT NULL,          
000014*       IMPFATTU                       DECIMAL(13, 3) NOT NULL,    
000015*       NOTENOTE                       CHAR(40) NOT NULL           
000016*     ) END-EXEC
                                                                        
000017******************************************************************
000018* COBOL DECLARATION FOR TABLE DANAGRAF.VANAGRAF_B53              *
000019******************************************************************
000020 01  DCLVANAGRAF-B53.                                             
000021*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000022     10 AB53-CODSOCIE        PIC X(10).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000023*                       CODDIVIS                                  
000024     10 AB53-CODDIVIS        PIC X(20).                           
000025*                       IMPFATTU                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000026     10 AB53-IMPFATTU        PIC S9(10)V9(3) USAGE COMP-3.        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000027*                       NOTENOTE                                  
000028     10 AB53-NOTENOTE        PIC X(40).                           
000029******************************************************************
000030* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 4       *
000031******************************************************************
      *<<((file: FDANAB53))
000139*--------------------------------DANAGRAF.TSOCIETA'               
000140 01  FILLER                      PIC X(12) VALUE '**FDANA531**'.  
000143*    EXEC SQL                                                     
      *        INCLUDE FDANA531                                         
      *    END-EXEC.                                                    
      *>>((file: FDANA531))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TSOCIETA                  *
000003******************************************************************
000004 01  DCLTSOCIETA.                                                 
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 A531-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000006     10 A531-NOMSOCIE        PIC X(23).                           
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000007     10 A531-CODFORNI        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000008     10 A531-TASSINTE        PIC S9(3)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000009     10 A531-CODPAESE        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000010     10 A531-NRGGRISC        PIC S9(3)V USAGE COMP-3.             
000011     10 A531-CODPIANO        PIC X(2).                            
000012     10 A531-CITTASOC        PIC X(18).                           
000013     10 A531-FLPAGIVA        PIC X(1).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000014     10 A531-FLFATACQ        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000015     10 A531-CODAZIEN        PIC X(5).                            
000016     10 A531-FLIVATRA        PIC X(1).                            
000017     10 A531-CODDIVIS        PIC X(2).                            
000018     10 A531-COSTINTE        PIC S9(3)V9(2) USAGE COMP-3.         
000019     10 A531-FLCONTAB        PIC X(1).                            
000020     10 A531-FLAGMAGA        PIC X(1).                            
000021     10 A531-RAGSOCIE        PIC X(50).                           
000022     10 A531-SOCIECON        PIC X(2).                            
000023     10 A531-DTCREAZI        PIC X(8).                            
000024     10 A531-DTULTVAR        PIC X(8).                            
000025     10 A531-CODUTVAR        PIC X(6).                            
000026     10 A531-INDLEGAL        PIC X(35).                           
000027     10 A531-CAPLEGAL        PIC X(5).                            
000028     10 A531-CITLEGAL        PIC X(18).                           
000029     10 A531-CODFISCA        PIC X(16).                           
000030     10 A531-CODDIVRI        PIC X(2).                            
000031     10 A531-SOCIEGTM        PIC X(2).                            
000032     10 A531-GENEFATT        PIC X(1).                            
000033     10 A531-FLAGATTI        PIC X(1).                            
000034     10 A531-DIVISOLD        PIC X(2).                            
000035     10 A531-DTFINOLD        PIC X(8).                            
000036     10 A531-DIVRIOLD        PIC X(2).                            
000037     10 A531-DIVIRIFA        PIC X(2).                            
000038     10 A531-FLEURUSA        PIC X(1).                            
000039     10 A531-FLAGLIMI        PIC X(1).                            
000040     10 A531-FLFILIAL        PIC X(1).                            
000041     10 A531-FLPRESEN        PIC X(1).                            
000042     10 A531-CODSOCPA        PIC X(1).                            
000043     10 A531-FLBOLGVB        PIC X(1).                            
000044     10 A531-FLSTCART        PIC X(1).                            
000045     10 A531-FLDIPEST        PIC X(1).                            
000046     10 A531-CODFIRMA        PIC X(8).                            
000047     10 A531-DESFIRMA        PIC X(24).                           
000048     10 A531-CDSOCJDE        PIC X(5).                            
000049     10 A531-CODFORNV        PIC X(5).                            
000050     10 A531-CODFORNA        PIC X(5).                            
000051     10 A531-IMPCCASO        PIC S9(13) COMP-3.                   
000052     10 A531-TRIBCCIA        PIC X(10).                           
000053     10 A531-PROLEGAL        PIC X(2).                            
000054     10 A531-FLSOCSAP        PIC X(1).                            
000055     10 A531-DIVIXLAV        PIC X(2).                            
000056******************************************************************
000057* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 51      *
000058******************************************************************
      *<<((file: FDANA531))
000144*--------------------------------DANAGRAF.TCLIENTI                
000145 01  FILLER                      PIC X(12) VALUE '**FDANA901**'.  
000148*    EXEC SQL                                                     
      *        INCLUDE FDANA901                                         
      *    END-EXEC.                                                    
      *>>((file: FDANA901))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TCLIENTI                  *
000003******************************************************************
000004 01  DCLTCLIENTI.                                                 
000005*                       CODCLIEN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006     10 A901-CODCLIEN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007*                       STATCLIE                                  
000008     10 A901-STATCLIE        PIC X(1).                            
000009*                       GENECLIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000010     10 A901-GENECLIE        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000011*                       TIPOCLIE                                  
000012     10 A901-TIPOCLIE        PIC X(1).                            
000013*                       TIPOCONS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000014     10 A901-TIPOCONS        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000015*                       CLIFOCON                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000016     10 A901-CLIFOCON        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000017*                       CODSOCIE                                  
000018     10 A901-CODSOCIE        PIC X(2).                            
000019*                       CAPOCONT                                  
000020     10 A901-CAPOCONT        PIC X(5).                            
000021*                       CODFISCA                                  
000022     10 A901-CODFISCA        PIC X(16).                           
000023*                       ESENTIVA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000024     10 A901-ESENTIVA        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025*                       NUMESIVA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000026     10 A901-NUMESIVA        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000027*                       DATESIVA                                  
000028     10 A901-DATESIVA        PIC X(8).                            
000029*                       UFFICIVA                                  
000030     10 A901-UFFICIVA        PIC X(18).                           
000031*                       IMPESIVA                                  
000032     10 A901-IMPESIVA        PIC S9(4)V USAGE COMP-3.             
000033*                       BANCAPPO                                  
000034     10 A901-BANCAPPO        PIC X(3).                            
000035*                       NOMBANCL                                  
000036     10 A901-NOMBANCL        PIC X(114).                          
000037*                       CONTOCOR                                  
000038     10 A901-CONTOCOR        PIC X(13).                           
000039*                       ASSOBANC                                  
000040     10 A901-ASSOBANC        PIC X(5).                            
000041*                       AVVIBANC                                  
000042     10 A901-AVVIBANC        PIC X(5).                            
000043*                       CLIEFATT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000044     10 A901-CLIEFATT        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000045*                       PAESFATT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000046     10 A901-PAESFATT        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000047*                       RAGFATTU                                  
000048     10 A901-RAGFATTU        PIC X(24).                           
000049*                       ESRAGFAT                                  
000050     10 A901-ESRAGFAT        PIC X(24).                           
000051*                       INDFATTU                                  
000052     10 A901-INDFATTU        PIC X(24).                           
000053*                       ESINDFAT                                  
000054     10 A901-ESINDFAT        PIC X(24).                           
000055*                       CITFATTU                                  
000056     10 A901-CITFATTU        PIC X(18).                           
000057*                       ESCITFAT                                  
000058     10 A901-ESCITFAT        PIC X(18).                           
000059*                       CAPFATTU                                  
000060     10 A901-CAPFATTU        PIC X(5).                            
000061*                       PAESMERC                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000062     10 A901-PAESMERC        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000063*                       RAGMERCE                                  
000064     10 A901-RAGMERCE        PIC X(24).                           
000065*                       ESRAGMER                                  
000066     10 A901-ESRAGMER        PIC X(24).                           
000067*                       INDMERCE                                  
000068     10 A901-INDMERCE        PIC X(24).                           
000069*                       ESINDMER                                  
000070     10 A901-ESINDMER        PIC X(24).                           
000071*                       CITMERCE                                  
000072     10 A901-CITMERCE        PIC X(18).                           
000073*                       ESCITMER                                  
000074     10 A901-ESCITMER        PIC X(18).                           
000075*                       CAPMERCE                                  
000076     10 A901-CAPMERCE        PIC X(5).                            
000077*                       ZONAMERC                                  
000078     10 A901-ZONAMERC        PIC X(2).                            
000079*                       TELCLIEN                                  
000080     10 A901-TELCLIEN        PIC X(20).                           
000081*                       TLXCLIEN                                  
000082     10 A901-TLXCLIEN        PIC X(20).                           
000083*                       FAXCLIEN                                  
000084     10 A901-FAXCLIEN        PIC X(20).                           
000085*                       RIFEMIRO                                  
000086     10 A901-RIFEMIRO        PIC X(11).                           
000087*                       PAESORDI                                  
000088     10 A901-PAESORDI        PIC X(3).                            
000089*                       ZONAORDI                                  
000090     10 A901-ZONAORDI        PIC X(2).                            
000091*                       DATVASTA                                  
000092     10 A901-DATVASTA        PIC X(8).                            
000093*                       ATTENZDI                                  
000094     10 A901-ATTENZDI        PIC X(24).                           
000095*                       CONDPAGA                                  
000096     10 A901-CONDPAGA        PIC X(3).                            
000097*                       MMESCLU1                                  
000098     10 A901-MMESCLU1        PIC S9(2)V USAGE COMP-3.             
000099*                       MMESCLU2                                  
000100     10 A901-MMESCLU2        PIC S9(2)V USAGE COMP-3.             
000101*                       GGSCATRA                                  
000102     10 A901-GGSCATRA        PIC S9(2)V USAGE COMP-3.             
000103*                       NUMGGVIA                                  
000104     10 A901-NUMGGVIA        PIC S9(2)V USAGE COMP-3.             
000105*                       TIPOTRAT                                  
000106     10 A901-TIPOTRAT        PIC X(1).                            
000107*                       ALTERSPE                                  
000108     10 A901-ALTERSPE        PIC X(1).                            
000109*                       CODILING                                  
000110     10 A901-CODILING        PIC X(1).                            
000111*                       DTULTVAR                                  
000112     10 A901-DTULTVAR        PIC X(8).                            
000113*                       TIPCLCAR                                  
000114     10 A901-TIPCLCAR        PIC X(1).                            
000115*                       SPETRASP                                  
000116     10 A901-SPETRASP        PIC X(1).                            
000117*                       DTCREAZI                                  
000118     10 A901-DTCREAZI        PIC X(8).                            
000119*                       CODDIVIS                                  
000120     10 A901-CODDIVIS        PIC X(2).                            
000121*                       CDIVACEE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000122     10 A901-CDIVACEE        PIC X(14).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000123*                       ZONAFATT                                  
000124     10 A901-ZONAFATT        PIC X(2).                            
000125*                       CLASDOGA                                  
000126     10 A901-CLASDOGA        PIC X(1).                            
000127*                       INTNCLIE                                  
000128     10 A901-INTNCLIE        PIC X(50).                           
000129*                       CAPOCOMM                                  
000130     10 A901-CAPOCOMM        PIC X(5).                            
000131*                       PRIORITA                                  
000132     10 A901-PRIORITA        PIC X(1).                            
000133*                       BULSTATX                                  
000134     10 A901-BULSTATX        PIC X(13).                           
000135*                       CODUTVAR                                  
000136     10 A901-CODUTVAR        PIC X(6).                            
000137*                       CODUTCRE                                  
000138     10 A901-CODUTCRE        PIC X(6).                            
000139*                       CDRESCON                                  
000140     10 A901-CDRESCON        PIC X(2).                            
000141*                       CENCOACQ                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000142     10 A901-CENCOACQ        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000143*                       CAPOSOCI                                  
000144     10 A901-CAPOSOCI        PIC X(5).                            
000145*                       CDFISCAL                                  
000146     10 A901-CDFISCAL        PIC X(16).                           
000147*                       CONDPACA                                  
000148     10 A901-CONDPACA        PIC X(3).                            
000149*                       CODXIBAN                                  
000150     10 A901-CODXIBAN        PIC X(4).                            
000151*                       CODXXCIN                                  
000152     10 A901-CODXXCIN        PIC X(2).                            
000153*                       ZIPFATTU                                  
000154     10 A901-ZIPFATTU        PIC X(15).                           
000155*                       ZIPMERCE                                  
000156     10 A901-ZIPMERCE        PIC X(15).                           
000157*                       TIPOLIST                                  
000158     10 A901-TIPOLIST        PIC X(1).                            
000159*                       SWIFTCOD                                  
000160     10 A901-SWIFTCOD        PIC X(11).                           
000161*                       PERCEIVA                                  
000162     10 A901-PERCEIVA        PIC S9(3)V9(2) USAGE COMP-3.         
000163*                       DTVALIVA                                  
000164     10 A901-DTVALIVA        PIC X(8).                            
000165*                       CLASSCLI                                  
000166     10 A901-CLASSCLI        PIC X(1).                            
000167*                       RATINGCO                                  
000168     10 A901-RATINGCO        PIC X(3).                            
000169*                       RISCHCLI                                  
000170     10 A901-RISCHCLI        PIC X(1).                            
000171*                                                                 
000172     10 A901-NRPROIVA        PIC X(30).                           
000173*                                                                 
000174     10 A901-IMPESNEW        PIC S9(9)V9(2) USAGE COMP-3.         
000175     10 A901-TIPOSTAG        PIC X(1).                            
000176     10 A901-FLFATELE        PIC X(1).                            
000177     10 A901-CDDESTFE        PIC X(7).                            
000178     10 A901-INPECCLI        PIC X(50).                           
000179******************************************************************
000180* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 88      *
000181******************************************************************
      *<<((file: FDANA901))
000149*--------------------------------DANAGRAF.TDIVISE                 
000150 01  FILLER                      PIC X(12) VALUE '**FDANA963**'.  
000153*    EXEC SQL                                                     
      *        INCLUDE FDANA963                                         
      *    END-EXEC.                                                    
      *>>((file: FDANA963))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TDIVISE                   *
000003******************************************************************
000004 01  DCLTDIVISE.                                                  
000005*                       SIGLADIV                                  
000006     10 A963-SIGLADIV        PIC X(3).                            
000007*                       CAMBIODV                                  
000008     10 A963-CAMBIODV        PIC S9(5)V9(6) USAGE COMP-3.         
000009*                       DESCDIVI                                  
000010     10 A963-DESCDIVI        PIC X(20).                           
000011*                       CODDIVIS                                  
000012     10 A963-CODDIVIS        PIC X(2).                            
000013*                       DECIDIVI                                  
000014     10 A963-DECIDIVI        PIC X(1).                            
000015*                       DIVIBANC                                  
000016     10 A963-DIVIBANC        PIC X(3).                            
000017*                       DIVIPREZ                                  
000018     10 A963-DIVIPREZ        PIC X(1).                            
000019*                       CODDIVRI                                  
000020     10 A963-CODDIVRI        PIC X(2).                            
000021*                       RAPPCAMB                                  
000022     10 A963-RAPPCAMB        PIC S9(5)V USAGE COMP-3.             
000023*                       CODDIGTM                                  
000024     10 A963-CODDIGTM        PIC X(2).                            
000025*                       FLAGEURO                                  
000026     10 A963-FLAGEURO        PIC X(1).                            
000027*                       SLDIVBAN                                  
000028     10 A963-SLDIVBAN        PIC X(3).                            
000029*                       CDDIVSCA                                  
000030     10 A963-CDDIVSCA        PIC X(2).                            
000031*                       FLDIVINT                                  
000032     10 A963-FLDIVINT        PIC X(1).                            
000033     10 A963-VBDIVSCA        PIC X(2).                            
000034******************************************************************
000035* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 15      *
000036******************************************************************
      *<<((file: FDANA963))
000154*--------------------------------DANAGRAF.TFORNITORI              
000155 01  FILLER                      PIC X(12) VALUE '**FDANA972**'.  
000158*    EXEC SQL                                                     
      *        INCLUDE FDANA972                                         
      *    END-EXEC.                                                    
      *>>((file: FDANA972))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TFORNITORI)                              *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA972))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(A972-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DANAGRAF.TFORNITORI TABLE                   
000012*     ( CODFORNI                       CHAR(5) NOT NULL,           
000013*       TIPOFORN                       CHAR(1) NOT NULL,           
000014*       RAGFORNI                       CHAR(24) NOT NULL,          
000015*       INDFORNI                       CHAR(24) NOT NULL,          
000016*       CAPFORNI                       CHAR(5) NOT NULL,           
000017*       CITFORNI                       CHAR(18) NOT NULL,          
000018*       CDIVACEE                       CHAR(14) NOT NULL,          
000019*       PERCSCON                       DECIMAL(5, 2) NOT NULL,     
000020*       TIPOPAGA                       CHAR(1) NOT NULL,           
000021*       SCADFORN                       CHAR(12) NOT NULL,          
000022*       GGSCATRA                       CHAR(2) NOT NULL,           
000023*       CODFISCA                       CHAR(16) NOT NULL,          
000024*       SIGLAPRO                       CHAR(2) NOT NULL,           
000025*       TELFORNI                       CHAR(20) NOT NULL,          
000026*       TLXFORNI                       CHAR(20) NOT NULL,          
000027*       FAXFORNI                       CHAR(20) NOT NULL,          
000028*       CATEFORN                       CHAR(2) NOT NULL,           
000029*       ESRAGFOR                       CHAR(11) NOT NULL,          
000030*       ESINDFOR                       CHAR(11) NOT NULL,          
000031*       ESCITFOR                       CHAR(17) NOT NULL,          
000032*       ESINDFO1                       CHAR(35) NOT NULL,          
000033*       INCAPFOR                       CHAR(1) NOT NULL,           
000034*       CAPOFATT                       CHAR(5) NOT NULL,           
000035*       INBLOCOR                       CHAR(1) NOT NULL,           
000036*       CENCOSTO                       CHAR(5) NOT NULL,           
000037*       CODPAESE                       CHAR(3) NOT NULL,           
000038*       INTNFORN                       CHAR(50) NOT NULL,          
000039*       RAGFCOMP                       CHAR(35) NOT NULL,          
000040*       INTNCOMM                       CHAR(50) NOT NULL,          
000041*       INTNALTR                       CHAR(50) NOT NULL,          
000042*       CDFISCAL                       CHAR(16) NOT NULL,          
000043*       FAXCOMME                       CHAR(20) NOT NULL,          
000044*       FAXALTRO                       CHAR(20) NOT NULL,          
000045*       CDALBOTR                       CHAR(11) NOT NULL           
000046*     ) END-EXEC
                                                                        
000047******************************************************************
000048* COBOL DECLARATION FOR TABLE DANAGRAF.TFORNITORI                *
000049******************************************************************
000050 01  DCLTFORNITORI.                                               
000051*                       CODFORNI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000052     10 A972-CODFORNI        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000053*                       TIPOFORN                                  
000054     10 A972-TIPOFORN        PIC X(1).                            
000055*                       RAGFORNI                                  
000056     10 A972-RAGFORNI        PIC X(24).                           
000057*                       INDFORNI                                  
000058     10 A972-INDFORNI        PIC X(24).                           
000059*                       CAPFORNI                                  
000060     10 A972-CAPFORNI        PIC X(5).                            
000061*                       CITFORNI                                  
000062     10 A972-CITFORNI        PIC X(18).                           
000063*                       CDIVACEE                                  
000064     10 A972-CDIVACEE        PIC X(14).                           
000065*                       PERCSCON                                  
000066     10 A972-PERCSCON        PIC S9(3)V9(2) USAGE COMP-3.         
000067*                       TIPOPAGA                                  
000068     10 A972-TIPOPAGA        PIC X(1).                            
000069*                       SCADFORN                                  
000070     10 A972-SCADFORN        PIC X(12).                           
000071*                       GGSCATRA                                  
000072     10 A972-GGSCATRA        PIC X(2).                            
000073*                       CODFISCA                                  
000074     10 A972-CODFISCA        PIC X(16).                           
000075*                       SIGLAPRO                                  
000076     10 A972-SIGLAPRO        PIC X(2).                            
000077*                       TELFORNI                                  
000078     10 A972-TELFORNI        PIC X(20).                           
000079*                       TLXFORNI                                  
000080     10 A972-TLXFORNI        PIC X(20).                           
000081*                       FAXFORNI                                  
000082     10 A972-FAXFORNI        PIC X(20).                           
000083*                       CATEFORN                                  
000084     10 A972-CATEFORN        PIC X(2).                            
000085*                       ESRAGFOR                                  
000086     10 A972-ESRAGFOR        PIC X(11).                           
000087*                       ESINDFOR                                  
000088     10 A972-ESINDFOR        PIC X(11).                           
000089*                       ESCITFOR                                  
000090     10 A972-ESCITFOR        PIC X(17).                           
000091*                       ESINDFO1                                  
000092     10 A972-ESINDFO1        PIC X(35).                           
000093*                       INCAPFOR                                  
000094     10 A972-INCAPFOR        PIC X(1).                            
000095*                       CAPOFATT                                  
000096     10 A972-CAPOFATT        PIC X(5).                            
000097*                       INBLOCOR                                  
000098     10 A972-INBLOCOR        PIC X(1).                            
000099*                       CENCOSTO                                  
000100     10 A972-CENCOSTO        PIC X(5).                            
000101*                       CODPAESE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000102     10 A972-CODPAESE        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000103*                       INTNFORN                                  
000104     10 A972-INTNFORN        PIC X(50).                           
000105*                       RAGFCOMP                                  
000106     10 A972-RAGFCOMP        PIC X(35).                           
000107*                       INTNCOMM                                  
000108     10 A972-INTNCOMM        PIC X(50).                           
000109*                       INTNALTR                                  
000110     10 A972-INTNALTR        PIC X(50).                           
000111*                       CDFISCAL                                  
000112     10 A972-CDFISCAL        PIC X(16).                           
000113*                       FAXCOMME                                  
000114     10 A972-FAXCOMME        PIC X(20).                           
000115*                       FAXALTRO                                  
000116     10 A972-FAXALTRO        PIC X(20).                           
000117*                       CDALBOTR                                  
000118     10 A972-CDALBOTR        PIC X(11).                           
000119******************************************************************
000120* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 34      *
000121******************************************************************
      *<<((file: FDANA972))
000159*--------------------------------DCONTCLI.TMOVIMENTI              
000160 01  FILLER                      PIC X(12) VALUE '**FDCLI852**'.  
000163*    EXEC SQL                                                     
      *        INCLUDE FDCLI852                                         
      *    END-EXEC.                                                    
      *>>((file: FDCLI852))
000001******************************************************************
000002* DCLGEN TABLE(DCONTCLI.TMOVIMENTI)                              *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDCLI852))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(C852-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DCONTCLI.TMOVIMENTI TABLE                   
000012*     ( CODSOCIE                       CHAR(2) NOT NULL,           
000013*       CODCLIEN                       CHAR(5) NOT NULL,           
000014*       CDMOVCON                       CHAR(1) NOT NULL,           
000015*       NRMOVCON                       CHAR(6) NOT NULL,           
000016*       DTREGMOV                       CHAR(8) NOT NULL,           
000017*       DATAVALU                       CHAR(8) NOT NULL,           
000018*       CENCOSTO                       CHAR(5) NOT NULL,           
000019*       TIPOAGEN                       CHAR(1) NOT NULL,           
000020*       CODAGENT                       CHAR(2) NOT NULL,           
000021*       FLPROVPA                       CHAR(1) NOT NULL,           
000022*       CAUSACON                       CHAR(1) NOT NULL,           
000023*       NRMOVRIF                       CHAR(6) NOT NULL,           
000024*       FLGRATEO                       CHAR(1) NOT NULL,           
000025*       FLEXECON                       CHAR(1) NOT NULL,           
000026*       BANDIVAL                       CHAR(3) NOT NULL,           
000027*       NRDICVAL                       CHAR(6) NOT NULL,           
000028*       DTULTVAR                       CHAR(8) NOT NULL,           
000029*       NRMOVRI2                       CHAR(6) NOT NULL,           
000030*       IMPROFAT                       DECIMAL(11, 2) NOT NULL,    
000031*       FLGSTORN                       CHAR(1) NOT NULL,           
000032*       DTCONTAB                       CHAR(8) NOT NULL,           
000033*       TIPOMOVI                       CHAR(1) NOT NULL,           
000034*       VOCEDOPR                       CHAR(8) NOT NULL,           
000035*       IMPDOGPR                       DECIMAL(11, 2) NOT NULL,    
000036*       CODUTVAR                       CHAR(6) NOT NULL,           
000037*       ITAESTER                       CHAR(1) NOT NULL,           
000038*       SLTIPLIN                       CHAR(1) NOT NULL,           
000039*       CODUTCRE                       CHAR(6) NOT NULL,           
000040*       NRASSEGN                       CHAR(10) NOT NULL,          
000041*       DTEMIASS                       CHAR(8) NOT NULL,           
000042*       BANCAASS                       CHAR(40) NOT NULL,          
000043*       FLAGASSI                       CHAR(1) NOT NULL,           
000044*       FLBONAUT                       CHAR(1) NOT NULL,           
000045*       CLIEMERC                       CHAR(5) NOT NULL,           
000046*       DATESIVA                       CHAR(8) NOT NULL,           
000047*       UFFICIVA                       CHAR(18) NOT NULL,          
000048*       NUMESIVA                       CHAR(5) NOT NULL,           
000049*       CDMOVRIF                       CHAR(1) NOT NULL,           
000050*       DATAMRIF                       CHAR(8) NOT NULL,           
000051*       CONDXASS                       CHAR(1) NOT NULL,           
000052*       FLAGXJDE                       CHAR(1) NOT NULL,           
000053*       FLAGASS2                       CHAR(1) NOT NULL,           
000054*       CLIERIFE                       CHAR(5) NOT NULL            
000055*     ) END-EXEC
                                                                        
000056******************************************************************
000057* COBOL DECLARATION FOR TABLE DCONTCLI.TMOVIMENTI                *
000058******************************************************************
000059 01  DCLTMOVIMENTI.                                               
000060*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000061     10 C852-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000062*                       CODCLIEN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000063     10 C852-CODCLIEN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000064*                       CDMOVCON                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000065     10 C852-CDMOVCON        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000066*                       NRMOVCON                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000067     10 C852-NRMOVCON        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000068*                       DTREGMOV                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000069     10 C852-DTREGMOV        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000070*                       DATAVALU                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000071     10 C852-DATAVALU        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000072*                       CENCOSTO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000073     10 C852-CENCOSTO        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000074*                       TIPOAGEN                                  
000075     10 C852-TIPOAGEN        PIC X(1).                            
000076*                       CODAGENT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000077     10 C852-CODAGENT        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000078*                       FLPROVPA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000079     10 C852-FLPROVPA        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000080*                       CAUSACON                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000081     10 C852-CAUSACON        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000082*                       NRMOVRIF                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000083     10 C852-NRMOVRIF        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000084*                       FLGRATEO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000085     10 C852-FLGRATEO        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000086*                       FLEXECON                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000087     10 C852-FLEXECON        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000088*                       BANDIVAL                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000089     10 C852-BANDIVAL        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000090*                       NRDICVAL                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000091     10 C852-NRDICVAL        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000092*                       DTULTVAR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000093     10 C852-DTULTVAR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000094*                       NRMOVRI2                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000095     10 C852-NRMOVRI2        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000096*                       IMPROFAT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000097     10 C852-IMPROFAT        PIC S9(9)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000098*                       FLGSTORN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000099     10 C852-FLGSTORN        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000100*                       DTCONTAB                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000101     10 C852-DTCONTAB        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000102*                       TIPOMOVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000103     10 C852-TIPOMOVI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000104*                       VOCEDOPR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000105     10 C852-VOCEDOPR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000106*                       IMPDOGPR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000107     10 C852-IMPDOGPR        PIC S9(9)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000108*                       CODUTVAR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000109     10 C852-CODUTVAR        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000110*                       ITAESTER                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000111     10 C852-ITAESTER        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000112*                       SLTIPLIN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000113     10 C852-SLTIPLIN        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000114*                       CODUTCRE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000115     10 C852-CODUTCRE        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000116*                       NRASSEGN                                  
000117     10 C852-NRASSEGN        PIC X(10).                           
000118*                       DTEMIASS                                  
000119     10 C852-DTEMIASS        PIC X(8).                            
000120*                       BANCAASS                                  
000121     10 C852-BANCAASS        PIC X(40).                           
000122*                       FLAGASSI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000123     10 C852-FLAGASSI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000124*                       FLBONAUT                                  
000125     10 C852-FLBONAUT        PIC X(1).                            
000126*                       CLIEMERC                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000127     10 C852-CLIEMERC        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000128*                       DATESIVA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000129     10 C852-DATESIVA        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000130*                       UFFICIVA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000131     10 C852-UFFICIVA        PIC X(18).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000132*                       NUMESIVA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000133     10 C852-NUMESIVA        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000134*                       CDMOVRIF                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000135     10 C852-CDMOVRIF        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000136*                       DATAMRIF                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000137     10 C852-DATAMRIF        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000138*                       CONDXASS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000139     10 C852-CONDXASS        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000140*                       FLAGXJDE                                  
000141     10 C852-FLAGXJDE        PIC X(1).                            
000142*                       FLAGASS2                                  
000143     10 C852-FLAGASS2        PIC X(1).                            
000144*                       CLIERIFE                                  
000145     10 C852-CLIERIFE        PIC X(5).                            
000146******************************************************************
000147* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 43      *
000148******************************************************************
      *<<((file: FDCLI852))
000164*--------------------------------DCONTCLI.TMOVISCAD               
000165 01  FILLER                      PIC X(12) VALUE '**FDCLI855**'.  
000168*    EXEC SQL                                                     
      *        INCLUDE FDCLI855                                         
      *    END-EXEC.                                                    
      *>>((file: FDCLI855))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DCONTCLI.TMOVISCAD                 *
000003******************************************************************
000004 01  DCLTMOVISCAD.                                                
000005*                       FLAGSTOR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006     10 C855-FLAGSTOR        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000008     10 C855-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000009*                       CODCLIEN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000010     10 C855-CODCLIEN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000011*                       CDMOVCON                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000012     10 C855-CDMOVCON        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000013*                       NRMOVCON                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000014     10 C855-NRMOVCON        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000015*                       DTREGMOV                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000016     10 C855-DTREGMOV        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000017*                       DTSCADEN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000018     10 C855-DTSCADEN        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000019*                       TIPOPAGA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000020     10 C855-TIPOPAGA        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000021*                       DTDECORR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000022     10 C855-DTDECORR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000023*                       IMPMOVIM                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000024     10 C855-IMPMOVIM        PIC S9(11)V9(2) USAGE COMP-3.        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025*                       INDSEGNO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000026     10 C855-INDSEGNO        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000027*                       CVLMOVIM                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000028     10 C855-CVLMOVIM        PIC S9(11)V9(2) USAGE COMP-3.        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000029*                       IMPORIVA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000030     10 C855-IMPORIVA        PIC S9(9)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000031*                       SCONTDED                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000032     10 C855-SCONTDED        PIC S9(9)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000033*                       PARTCONT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000034     10 C855-PARTCONT        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000035*                       BANCAPPO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000036     10 C855-BANCAPPO        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000037*                       DISTICON                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000038     10 C855-DISTICON        PIC X(4).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000039*                       BANCACON                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000040     10 C855-BANCACON        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000041*                       AACONTAB                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000042     10 C855-AACONTAB        PIC X(4).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000043*                       NRCONTAB                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000044     10 C855-NRCONTAB        PIC X(7).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000045*                       NOTENOTE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000046     10 C855-NOTENOTE        PIC X(26).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000047*                       FLAGSALD                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000048     10 C855-FLAGSALD        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000049*                       NETTSCON                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000050     10 C855-NETTSCON        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000051*                       PLUSSCAD                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000052     10 C855-PLUSSCAD        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000053*                       SIMPROVV                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000054     10 C855-SIMPROVV        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000055*                       CDSELTIP                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000056     10 C855-CDSELTIP        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000057*                       CDSELMOV                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000058     10 C855-CDSELMOV        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000059*                       DTULTVAR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000060     10 C855-DTULTVAR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000061*                       FLEXECON                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000062     10 C855-FLEXECON        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000063*                       OLDSCADE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000064     10 C855-OLDSCADE        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000065*                       IMPROFAT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000066     10 C855-IMPROFAT        PIC S9(9)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000067*                       DATADIST                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000068     10 C855-DATADIST        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000069*                       DTINCASS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000070     10 C855-DTINCASS        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000071*                       FLAGTRAT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000072     10 C855-FLAGTRAT        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000073*                       TIPOSOLL                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000074     10 C855-TIPOSOLL        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000075*                       CAUSBANC                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000076     10 C855-CAUSBANC        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000077*                       CODDIVIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000078     10 C855-CODDIVIS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000079*                       CVLXXIVA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000080     10 C855-CVLXXIVA        PIC S9(9)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000081*                       SCADORIG                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000082     10 C855-SCADORIG        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000083*                       NUMGGMED                                  
000084     10 C855-NUMGGMED        PIC S9(5)V USAGE COMP-3.             
000085*                       CODUTVAR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000086     10 C855-CODUTVAR        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000087*                       NRPARRIF                                  
000088     10 C855-NRPARRIF        PIC X(6).                            
000089*                       CDSOCRIF                                  
000090     10 C855-CDSOCRIF        PIC X(2).                            
000091*                       CDCLIRIF                                  
000092     10 C855-CDCLIRIF        PIC X(5).                            
000093*                       DTREGRIF                                  
000094     10 C855-DTREGRIF        PIC X(8).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000095     10 C855-VALTRASP        PIC S9(9)V9(2) USAGE COMP-3.         
000096     10 C855-CVLTRASP        PIC S9(9)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000097******************************************************************
000098* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 47      *
000099******************************************************************
      *<<((file: FDCLI855))
000169*--------------------------------DCONTCLI.TMOVINOTE               
000170 01  FILLER                      PIC X(12) VALUE '**FDCLI857**'.  
000173*    EXEC SQL                                                     
      *        INCLUDE FDCLI857                                         
      *    END-EXEC.                                                    
      *>>((file: FDCLI857))
000001******************************************************************
000002* DCLGEN TABLE(DCONTCLI.TMOVINOTE)                               *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDCLI857))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        QUOTE                                                   *
000007* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000008******************************************************************
000009     
      *EXEC SQL DECLARE DCONTCLI.TMOVINOTE TABLE                    
000010*     ( CODSOCIE                       CHAR(2) NOT NULL,           
000011*       CDMOVCON                       CHAR(1) NOT NULL,           
000012*       NRMOVCON                       CHAR(6) NOT NULL,           
000013*       NOTESTA1                       CHAR(60) NOT NULL,          
000014*       NOTESTA2                       CHAR(60) NOT NULL,          
000015*       NOTESTA3                       CHAR(60) NOT NULL,          
000016*       IMPCALIN                       DECIMAL(13, 2) NOT NULL,    
000017*       TASSINTE                       DECIMAL(5, 2) NOT NULL,     
000018*       NUMGGINT                       DECIMAL(5, 0) NOT NULL,     
000019*       IMPSPESE                       DECIMAL(9, 2) NOT NULL,     
000020*       DTCREAZI                       CHAR(8) NOT NULL,           
000021*       NOTESTA4                       CHAR(60) NOT NULL,          
000022*       NOTESTA5                       CHAR(60) NOT NULL,          
000023*       CONTODCE                       CHAR(6) NOT NULL,           
000024*       CENCOSTO                       CHAR(5) NOT NULL,           
000025*       FLAGINTR                       CHAR(1) NOT NULL,           
000026*       NUMPROG3                       DECIMAL(3, 0) NOT NULL,     
000027*       DTREGMOV                       CHAR(8) NOT NULL,           
000028*       CODCLIEN                       CHAR(5) NOT NULL            
000029*     ) END-EXEC
                                                                        
000030******************************************************************
000031* COBOL DECLARATION FOR TABLE DCONTCLI.TMOVINOTE                 *
000032******************************************************************
000033 01  DCLTMOVINOTE.                                                
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000034     10 C857-CODSOCIE        PIC X(2).                            
000035     10 C857-CDMOVCON        PIC X(1).                            
000036     10 C857-NRMOVCON        PIC X(6).                            
000037     10 C857-NOTESTA1        PIC X(60).                           
000038     10 C857-NOTESTA2        PIC X(60).                           
000039     10 C857-NOTESTA3        PIC X(60).                           
000040     10 C857-IMPCALIN        PIC S9(11)V9(2) USAGE COMP-3.        
000041     10 C857-TASSINTE        PIC S9(3)V9(2) USAGE COMP-3.         
000042     10 C857-NUMGGINT        PIC S9(5)V USAGE COMP-3.             
000043     10 C857-IMPSPESE        PIC S9(7)V9(2) USAGE COMP-3.         
000044     10 C857-DTCREAZI        PIC X(8).                            
000045     10 C857-NOTESTA4        PIC X(60).                           
000046     10 C857-NOTESTA5        PIC X(60).                           
000047     10 C857-CONTODCE        PIC X(6).                            
000048     10 C857-CENCOSTO        PIC X(5).                            
000049     10 C857-FLAGINTR        PIC X(1).                            
000050     10 C857-NUMPROG3        PIC S9(3)V USAGE COMP-3.             
000051     10 C857-DTREGMOV        PIC X(8).                            
000052     10 C857-CODCLIEN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000053******************************************************************
000054* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 19      *
000055******************************************************************
      *<<((file: FDCLI857))
000174*--------------------------------DCONTCLI.TMOVIDCE                
000175 01  FILLER                      PIC X(12) VALUE '**FDCLI858**'.  
000178*    EXEC SQL                                                     
      *        INCLUDE FDCLI858                                         
      *    END-EXEC.                                                    
      *>>((file: FDCLI858))
000001******************************************************************
000002* DCLGEN TABLE(DCONTCLI.TMOVIDCE)                                *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDCLI858))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        QUOTE                                                   *
000007* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000008******************************************************************
000009     
      *EXEC SQL DECLARE DCONTCLI.TMOVIDCE TABLE                     
000010*     ( CODSOCIE                       CHAR(2) NOT NULL,           
000011*       CODCLIEN                       CHAR(5) NOT NULL,           
000012*       CDMOVCON                       CHAR(1) NOT NULL,           
000013*       NRMOVCON                       CHAR(6) NOT NULL,           
000014*       DTREGMOV                       CHAR(8) NOT NULL,           
000015*       DTSCADEN                       CHAR(8) NOT NULL,           
000016*       CONTODCE                       CHAR(6) NOT NULL,           
000017*       IMPARMOV                       DECIMAL(13, 2) NOT NULL,    
000018*       INDSEGNO                       CHAR(1) NOT NULL,           
000019*       CVLMOVIM                       DECIMAL(13, 2) NOT NULL,    
000020*       IMPORIVA                       DECIMAL(11, 2) NOT NULL,    
000021*       PERCEIVA                       DECIMAL(5, 2) NOT NULL,     
000022*       ESENTIVA                       CHAR(1) NOT NULL,           
000023*       IMPADIVA                       DECIMAL(11, 2) NOT NULL,    
000024*       ADDFATTU                       DECIMAL(5, 2) NOT NULL,     
000025*       FLEXECON                       CHAR(1) NOT NULL,           
000026*       DTULTVAR                       CHAR(8) NOT NULL,           
000027*       OLDSCADE                       CHAR(8) NOT NULL,           
000028*       CVLXXIVA                       DECIMAL(11, 2) NOT NULL,    
000029*       CVLADIVA                       DECIMAL(11, 2) NOT NULL,    
000030*       CODUTVAR                       CHAR(6) NOT NULL            
000031*     ) END-EXEC
                                                                        
000032******************************************************************
000033* COBOL DECLARATION FOR TABLE DCONTCLI.TMOVIDCE                  *
000034******************************************************************
000035 01  DCLTMOVIDCE.                                                 
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000036     10 C858-CODSOCIE        PIC X(2).                            
000037     10 C858-CODCLIEN        PIC X(5).                            
000038     10 C858-CDMOVCON        PIC X(1).                            
000039     10 C858-NRMOVCON        PIC X(6).                            
000040     10 C858-DTREGMOV        PIC X(8).                            
000041     10 C858-DTSCADEN        PIC X(8).                            
000042     10 C858-CONTODCE        PIC X(6).                            
000043     10 C858-IMPARMOV        PIC S9(11)V9(2) USAGE COMP-3.        
000044     10 C858-INDSEGNO        PIC X(1).                            
000045     10 C858-CVLMOVIM        PIC S9(11)V9(2) USAGE COMP-3.        
000046     10 C858-IMPORIVA        PIC S9(9)V9(2) USAGE COMP-3.         
000047     10 C858-PERCEIVA        PIC S9(3)V9(2) USAGE COMP-3.         
000048     10 C858-ESENTIVA        PIC X(1).                            
000049     10 C858-IMPADIVA        PIC S9(9)V9(2) USAGE COMP-3.         
000050     10 C858-ADDFATTU        PIC S9(3)V9(2) USAGE COMP-3.         
000051     10 C858-FLEXECON        PIC X(1).                            
000052     10 C858-DTULTVAR        PIC X(8).                            
000053     10 C858-OLDSCADE        PIC X(8).                            
000054     10 C858-CVLXXIVA        PIC S9(9)V9(2) USAGE COMP-3.         
000055     10 C858-CVLADIVA        PIC S9(9)V9(2) USAGE COMP-3.         
000056     10 C858-CODUTVAR        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000057******************************************************************
000058* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 21      *
000059******************************************************************
      *<<((file: FDCLI858))
000179*--------------------------------DCONTCLI.TCONTIDCE               
000180 01  FILLER                      PIC X(12) VALUE '**FDCLI861**'.  
000183*    EXEC SQL                                                     
      *        INCLUDE FDCLI861                                         
      *    END-EXEC.                                                    
      *>>((file: FDCLI861))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DCONTCLI.TCONTIDCE                 *
000003******************************************************************
000004 01  DCLTCONTIDCE.                                                
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 C861-CONTODCE        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000006     10 C861-CODPIANO        PIC X(2).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000007     10 C861-CONTPROV        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000008     10 C861-DESCRDCE        PIC X(25).                           
000009     10 C861-ANNULLAM        PIC X(1).                            
000010     10 C861-TIPCONTO        PIC X(2).                            
000011     10 C861-CONTGRUP        PIC X(6).                            
000012     10 C861-NOTECON1        PIC X(33).                           
000013     10 C861-NOTECON2        PIC X(33).                           
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000014     10 C861-INDBILQU        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000015     10 C861-FLCOMMES        PIC X(1).                            
000016******************************************************************
000017* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 11 C861- 
000018******************************************************************
      *<<((file: FDCLI861))
000184*--------------------------------DCONTCLI.TSICO                   
000185 01  FILLER                      PIC X(12) VALUE '**FDCLI902**'.  
000188*    EXEC SQL                                                     
      *        INCLUDE FDCLI902                                         
      *    END-EXEC.                                                    
      *>>((file: FDCLI902))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DCONTCLI.TSICO                     *
000003******************************************************************
000004 01  DCLTSICO.                                                    
000005*                       CODSOCIE                                  
000006     10 C902-CODSOCIE        PIC X(2).                            
000007*                       CODCLIEN                                  
000008     10 C902-CODCLIEN        PIC X(5).                            
000009*                       IMPOFIDO                                  
000010     10 C902-IMPOFIDO        PIC S9(11)V USAGE COMP-3.            
000011*                       DATAFIDO                                  
000012     10 C902-DATAFIDO        PIC X(8).                            
000013*                       NOTECONT                                  
000014     10 C902-NOTECONT        PIC X(5).                            
000015*                       NOTECOMM                                  
000016     10 C902-NOTECOMM        PIC X(5).                            
000017*                       NOTEVARI                                  
000018     10 C902-NOTEVARI        PIC X(38).                           
000019*                       DTULTSPE                                  
000020     10 C902-DTULTSPE        PIC X(8).                            
000021*                       IMPSCOPE                                  
000022     10 C902-IMPSCOPE        PIC S9(11)V9(2) USAGE COMP-3.        
000023*                       IMPRISCH                                  
000024     10 C902-IMPRISCH        PIC S9(11)V9(2) USAGE COMP-3.        
000025*                       IMPTRA01                                  
000026     10 C902-IMPTRA01        PIC S9(11)V9(2) USAGE COMP-3.        
000027*                       IMPTRA02                                  
000028     10 C902-IMPTRA02        PIC S9(11)V9(2) USAGE COMP-3.        
000029*                       IMPTRA03                                  
000030     10 C902-IMPTRA03        PIC S9(11)V9(2) USAGE COMP-3.        
000031*                       IMPTRA04                                  
000032     10 C902-IMPTRA04        PIC S9(11)V9(2) USAGE COMP-3.        
000033*                       IMPTRA05                                  
000034     10 C902-IMPTRA05        PIC S9(11)V9(2) USAGE COMP-3.        
000035*                       IMPTRA06                                  
000036     10 C902-IMPTRA06        PIC S9(11)V9(2) USAGE COMP-3.        
000037*                       IMPTRA07                                  
000038     10 C902-IMPTRA07        PIC S9(11)V9(2) USAGE COMP-3.        
000039*                       IMPTRA08                                  
000040     10 C902-IMPTRA08        PIC S9(11)V9(2) USAGE COMP-3.        
000041*                       IMPTRA09                                  
000042     10 C902-IMPTRA09        PIC S9(11)V9(2) USAGE COMP-3.        
000043*                       IMPTRA10                                  
000044     10 C902-IMPTRA10        PIC S9(11)V9(2) USAGE COMP-3.        
000045*                       IMPTRA11                                  
000046     10 C902-IMPTRA11        PIC S9(11)V9(2) USAGE COMP-3.        
000047*                       IMPTRA12                                  
000048     10 C902-IMPTRA12        PIC S9(11)V9(2) USAGE COMP-3.        
000049*                       IMPTRA13                                  
000050     10 C902-IMPTRA13        PIC S9(11)V9(2) USAGE COMP-3.        
000051*                       IMPRIM01                                  
000052     10 C902-IMPRIM01        PIC S9(11)V9(2) USAGE COMP-3.        
000053*                       IMPRIM02                                  
000054     10 C902-IMPRIM02        PIC S9(11)V9(2) USAGE COMP-3.        
000055*                       IMPRIM03                                  
000056     10 C902-IMPRIM03        PIC S9(11)V9(2) USAGE COMP-3.        
000057*                       IMPRIM04                                  
000058     10 C902-IMPRIM04        PIC S9(11)V9(2) USAGE COMP-3.        
000059*                       IMPRIM05                                  
000060     10 C902-IMPRIM05        PIC S9(11)V9(2) USAGE COMP-3.        
000061*                       IMPRIM06                                  
000062     10 C902-IMPRIM06        PIC S9(11)V9(2) USAGE COMP-3.        
000063*                       IMPRIM07                                  
000064     10 C902-IMPRIM07        PIC S9(11)V9(2) USAGE COMP-3.        
000065*                       IMPRIM08                                  
000066     10 C902-IMPRIM08        PIC S9(11)V9(2) USAGE COMP-3.        
000067*                       IMPRIM09                                  
000068     10 C902-IMPRIM09        PIC S9(11)V9(2) USAGE COMP-3.        
000069*                       IMPRIM10                                  
000070     10 C902-IMPRIM10        PIC S9(11)V9(2) USAGE COMP-3.        
000071*                       IMPRIM11                                  
000072     10 C902-IMPRIM11        PIC S9(11)V9(2) USAGE COMP-3.        
000073*                       IMPRIM12                                  
000074     10 C902-IMPRIM12        PIC S9(11)V9(2) USAGE COMP-3.        
000075*                       IMPRIM13                                  
000076     10 C902-IMPRIM13        PIC S9(11)V9(2) USAGE COMP-3.        
000077*                       IMPORD01                                  
000078     10 C902-IMPORD01        PIC S9(11)V9(2) USAGE COMP-3.        
000079*                       IMPORD02                                  
000080     10 C902-IMPORD02        PIC S9(11)V9(2) USAGE COMP-3.        
000081*                       IMPORD03                                  
000082     10 C902-IMPORD03        PIC S9(11)V9(2) USAGE COMP-3.        
000083*                       IMPORD04                                  
000084     10 C902-IMPORD04        PIC S9(11)V9(2) USAGE COMP-3.        
000085*                       IMPORD05                                  
000086     10 C902-IMPORD05        PIC S9(11)V9(2) USAGE COMP-3.        
000087*                       IMPORD06                                  
000088     10 C902-IMPORD06        PIC S9(11)V9(2) USAGE COMP-3.        
000089*                       IMPORD07                                  
000090     10 C902-IMPORD07        PIC S9(11)V9(2) USAGE COMP-3.        
000091*                       IMPORD08                                  
000092     10 C902-IMPORD08        PIC S9(11)V9(2) USAGE COMP-3.        
000093*                       IMPORD09                                  
000094     10 C902-IMPORD09        PIC S9(11)V9(2) USAGE COMP-3.        
000095*                       IMPORD10                                  
000096     10 C902-IMPORD10        PIC S9(11)V9(2) USAGE COMP-3.        
000097*                       IMPORD11                                  
000098     10 C902-IMPORD11        PIC S9(11)V9(2) USAGE COMP-3.        
000099*                       IMPORD12                                  
000100     10 C902-IMPORD12        PIC S9(11)V9(2) USAGE COMP-3.        
000101*                       IMPORD13                                  
000102     10 C902-IMPORD13        PIC S9(11)V9(2) USAGE COMP-3.        
000103*                       IMPSCO01                                  
000104     10 C902-IMPSCO01        PIC S9(11)V9(2) USAGE COMP-3.        
000105*                       IMPSCO02                                  
000106     10 C902-IMPSCO02        PIC S9(11)V9(2) USAGE COMP-3.        
000107*                       IMPSCO03                                  
000108     10 C902-IMPSCO03        PIC S9(11)V9(2) USAGE COMP-3.        
000109*                       IMPSCO04                                  
000110     10 C902-IMPSCO04        PIC S9(11)V9(2) USAGE COMP-3.        
000111*                       IMPSCO05                                  
000112     10 C902-IMPSCO05        PIC S9(11)V9(2) USAGE COMP-3.        
000113*                       IMPSCO06                                  
000114     10 C902-IMPSCO06        PIC S9(11)V9(2) USAGE COMP-3.        
000115*                       IMPSCO07                                  
000116     10 C902-IMPSCO07        PIC S9(11)V9(2) USAGE COMP-3.        
000117*                       IMPSCO08                                  
000118     10 C902-IMPSCO08        PIC S9(11)V9(2) USAGE COMP-3.        
000119*                       IMPSCO09                                  
000120     10 C902-IMPSCO09        PIC S9(11)V9(2) USAGE COMP-3.        
000121*                       IMPSCO10                                  
000122     10 C902-IMPSCO10        PIC S9(11)V9(2) USAGE COMP-3.        
000123*                       IMPSCO11                                  
000124     10 C902-IMPSCO11        PIC S9(11)V9(2) USAGE COMP-3.        
000125*                       IMPSCO12                                  
000126     10 C902-IMPSCO12        PIC S9(11)V9(2) USAGE COMP-3.        
000127*                       IMPSCO13                                  
000128     10 C902-IMPSCO13        PIC S9(11)V9(2) USAGE COMP-3.        
000129*                       AARIFER1                                  
000130     10 C902-AARIFER1        PIC X(4).                            
000131*                       AARIFER2                                  
000132     10 C902-AARIFER2        PIC X(4).                            
000133*                       AARIFER3                                  
000134     10 C902-AARIFER3        PIC X(4).                            
000135*                       MONTFAT1                                  
000136     10 C902-MONTFAT1        PIC S9(11)V9(2) USAGE COMP-3.        
000137*                       MONTFAT2                                  
000138     10 C902-MONTFAT2        PIC S9(11)V9(2) USAGE COMP-3.        
000139*                       MONTFAT3                                  
000140     10 C902-MONTFAT3        PIC S9(11)V9(2) USAGE COMP-3.        
000141*                       MONTINC1                                  
000142     10 C902-MONTINC1        PIC S9(11)V9(2) USAGE COMP-3.        
000143*                       MONTINC2                                  
000144     10 C902-MONTINC2        PIC S9(11)V9(2) USAGE COMP-3.        
000145*                       MONTINC3                                  
000146     10 C902-MONTINC3        PIC S9(11)V9(2) USAGE COMP-3.        
000147*                       NUMEINS1                                  
000148     10 C902-NUMEINS1        PIC S9(5)V USAGE COMP-3.             
000149*                       NUMEINS2                                  
000150     10 C902-NUMEINS2        PIC S9(5)V USAGE COMP-3.             
000151*                       NUMEINS3                                  
000152     10 C902-NUMEINS3        PIC S9(5)V USAGE COMP-3.             
000153*                       MONTINS1                                  
000154     10 C902-MONTINS1        PIC S9(11)V9(2) USAGE COMP-3.        
000155*                       MONTINS2                                  
000156     10 C902-MONTINS2        PIC S9(11)V9(2) USAGE COMP-3.        
000157*                       MONTINS3                                  
000158     10 C902-MONTINS3        PIC S9(11)V9(2) USAGE COMP-3.        
000159*                       MONTRES1                                  
000160     10 C902-MONTRES1        PIC S9(11)V9(2) USAGE COMP-3.        
000161*                       MONTRES2                                  
000162     10 C902-MONTRES2        PIC S9(11)V9(2) USAGE COMP-3.        
000163*                       MONTRES3                                  
000164     10 C902-MONTRES3        PIC S9(11)V9(2) USAGE COMP-3.        
000165*                       MONBON11                                  
000166     10 C902-MONBON11        PIC S9(11)V9(2) USAGE COMP-3.        
000167*                       MONBON12                                  
000168     10 C902-MONBON12        PIC S9(11)V9(2) USAGE COMP-3.        
000169*                       MONBON13                                  
000170     10 C902-MONBON13        PIC S9(11)V9(2) USAGE COMP-3.        
000171*                       MONBON21                                  
000172     10 C902-MONBON21        PIC S9(11)V9(2) USAGE COMP-3.        
000173*                       MONBON22                                  
000174     10 C902-MONBON22        PIC S9(11)V9(2) USAGE COMP-3.        
000175*                       MONBON23                                  
000176     10 C902-MONBON23        PIC S9(11)V9(2) USAGE COMP-3.        
000177*                       MONSCOF1                                  
000178     10 C902-MONSCOF1        PIC S9(11)V9(2) USAGE COMP-3.        
000179*                       MONSCOF2                                  
000180     10 C902-MONSCOF2        PIC S9(11)V9(2) USAGE COMP-3.        
000181*                       MONSCOF3                                  
000182     10 C902-MONSCOF3        PIC S9(11)V9(2) USAGE COMP-3.        
000183*                       MONSCOP1                                  
000184     10 C902-MONSCOP1        PIC S9(11)V9(2) USAGE COMP-3.        
000185*                       MONSCOP2                                  
000186     10 C902-MONSCOP2        PIC S9(11)V9(2) USAGE COMP-3.        
000187*                       MONSCOP3                                  
000188     10 C902-MONSCOP3        PIC S9(11)V9(2) USAGE COMP-3.        
000189*                       MONTINT1                                  
000190     10 C902-MONTINT1        PIC S9(11)V9(2) USAGE COMP-3.        
000191*                       MONTINT2                                  
000192     10 C902-MONTINT2        PIC S9(11)V9(2) USAGE COMP-3.        
000193*                       MONTINT3                                  
000194     10 C902-MONTINT3        PIC S9(11)V9(2) USAGE COMP-3.        
000195*                       DTULTVAR                                  
000196     10 C902-DTULTVAR        PIC X(8).                            
000197*                       SOMINGG1                                  
000198     10 C902-SOMINGG1        PIC S9(13)V9(2) USAGE COMP-3.        
000199*                       SOMINGG2                                  
000200     10 C902-SOMINGG2        PIC S9(13)V9(2) USAGE COMP-3.        
000201*                       SOMINGG3                                  
000202     10 C902-SOMINGG3        PIC S9(13)V9(2) USAGE COMP-3.        
000203*                       SOMINCA1                                  
000204     10 C902-SOMINCA1        PIC S9(13)V9(2) USAGE COMP-3.        
000205*                       SOMINCA2                                  
000206     10 C902-SOMINCA2        PIC S9(13)V9(2) USAGE COMP-3.        
000207*                       SOMINCA3                                  
000208     10 C902-SOMINCA3        PIC S9(13)V9(2) USAGE COMP-3.        
000209*                       DTULTSOL                                  
000210     10 C902-DTULTSOL        PIC X(8).                            
000211*                       CODASSIC                                  
000212     10 C902-CODASSIC        PIC X(5).                            
000213*                       IMPFIDAS                                  
000214     10 C902-IMPFIDAS        PIC S9(11)V USAGE COMP-3.            
000215*                       CLIEASSI                                  
000216     10 C902-CLIEASSI        PIC X(12).                           
000217*                       DIVFIDAS                                  
000218     10 C902-DIVFIDAS        PIC X(2).                            
000219*                       DATFIDAS                                  
000220     10 C902-DATFIDAS        PIC X(8).                            
000221*                       IMPNOIVA                                  
000222     10 C902-IMPNOIVA        PIC S9(11)V USAGE COMP-3.            
000223*                       CODDIVIS                                  
000224     10 C902-CODDIVIS        PIC X(2).                            
000225*                       DTCREAZI                                  
000226     10 C902-DTCREAZI        PIC X(8).                            
000227*                       CODUTVAR                                  
000228     10 C902-CODUTVAR        PIC X(6).                            
000229*                       FLAGMOV1                                  
000230     10 C902-FLAGMOV1        PIC X(1).                            
000231*                       FLAGMOV2                                  
000232     10 C902-FLAGMOV2        PIC X(1).                            
000233*                       FLAGMOV3                                  
000234     10 C902-FLAGMOV3        PIC X(1).                            
000235*                       DTRICFID                                  
000236     10 C902-DTRICFID        PIC X(8).                            
000237*                       IMPFIRAS                                  
000238     10 C902-IMPFIRAS        PIC S9(11)V USAGE COMP-3.            
000239*                       NUMGGASS                                  
000240     10 C902-NUMGGASS        PIC S9(3)V USAGE COMP-3.             
000241*                       IMPMERCV                                  
000242     10 C902-IMPMERCV        PIC S9(11)V9(2) USAGE COMP-3.        
000243*                       DTAZFIAS                                  
000244     10 C902-DTAZFIAS        PIC X(8).                            
000245*                       GRADECOD                                  
000246     10 C902-GRADECOD        PIC X(2).                            
000247*                       IMPSCOP1                                  
000248     10 C902-IMPSCOP1        PIC S9(11)V9(2) USAGE COMP-3.        
000249     10 C902-FLAGSEPA        PIC X(1).                            
000250     10 C902-GRADECO2        PIC X(2).                            
000251     10 C902-IMPOAPPA        PIC S9(11)V9(2) USAGE COMP-3.        
000252******************************************************************
000253* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 125     *
000254******************************************************************
      *<<((file: FDCLI902))
000189                                                                  
000192*    EXEC SQL                                                     
      *        INCLUDE SQLCA                                            
      *    END-EXEC.                                                    
      *>>((file: SQLCA))
000001****************************************************************<*
000002* Copyright (c) 2016-2023 NTT DATA, Inc. All rights reserved.  *<*
000003* Users of NTT DATA Enterprise COBOL may freely                *<*
000004* redistribute this copybook.                                  *<*
000005****************************************************************<*
000006                                                                  
000007 01  SQLCA GLOBAL.                                                
000008     05  SQLCAID                PIC X(8).                         
000009     05  SQLCABC                PIC S9(9) COMP-5.                 
000010     05  SQLCODE                PIC S9(9) COMP-5.                 
000011     05  SQLERRM.                                                 
000012         49  SQLERRML           PIC S9(4) COMP-5.                 
000013         49  SQLERRMC           PIC X(254).                       
000014     05  SQLERRP                PIC X(8).                         
000015     05  SQLERRD OCCURS 6 TIMES PIC S9(9) COMP-5.                 
000016     05  SQLWARN.                                                 
000017         10 SQLWARN0            PIC X(1).                         
000018         10 SQLWARN1            PIC X(1).                         
000019         10 SQLWARN2            PIC X(1).                         
000020         10 SQLWARN3            PIC X(1).                         
000021         10 SQLWARN4            PIC X(1).                         
000022         10 SQLWARN5            PIC X(1).                         
000023         10 SQLWARN6            PIC X(1).                         
000024         10 SQLWARN7            PIC X(1).                         
000025     05  SQLSTATE               PIC X(5).                         
000026     05  SQLEXT                 PIC S9(5) COMP-3 VALUE 1.         
      *<<((file: SQLCA))
000193                                                                  
000194*----------------------------------------------------------------*
000195 PROCEDURE DIVISION.                                              
000196*----------------------------------------------------------------*
000195 VCOBOL-DUMMY-PROCEDURE.
000197                                                                  
000199     
      *EXEC SQL 
      *WHENEVER SQLERROR GOTO Z00-ERRORE                       
000200*     END-EXEC
                                                                        
000201                                                                  
000202     MOVE 'AAAAM10'              TO PPNAME                        
000203                                    WCOM-PROGNAME.                
000204     OPEN INPUT FILEINP.                                          
000205                                                                  
000206     PERFORM A00-LEGGO-SKEDA                                      
000207        THRU A00-EX.                                              
000208                                                                  
000209     PERFORM L00-LETTURA-FILEINP                                  
000210        THRU L00-EX.                                              
000211     PERFORM A05-ELABORAZIONE                                     
000212        THRU A05-EX                                               
000213       UNTIL EOF = 'SI'.                                          
000214                                                                  
000215     CLOSE FILEINP.                                               
000216                                                                  
000217     MOVE 'P'                    TO PPROUTIN.                     
000218     PERFORM Z90-READPRIN                                         
000219        THRU Z90-EX.                                              
000220     MOVE ZEROS                  TO RETURN-CODE.                  
000221     CALL "CCF_SET_RETCODE" USING RETURN-CODE                     
000222     STOP RUN.                                                    
000223                                                                  
000224*----------------------------------------------------------------*
000225 A00-LEGGO-SKEDA.                                                 
000226*----------------------------------------------------------------*
000227                                                                  
000228     MOVE 'S'                    TO PPROUTIN.                     
000229     PERFORM Z90-READPRIN                                         
000230        THRU Z90-EX.                                              
000231     MOVE PPSK1                  TO SK-PARAM.                     
000232                                                                  
000233     IF SK-AGGIORNA NOT = 'SI' AND 'NO'                           
000234        MOVE 'SK PARAM. ERRATA'  TO PPMESSAG                      
000235        MOVE 'M'                 TO PPROUTIN                      
000236        PERFORM Z90-READPRIN                                      
000237           THRU Z90-EX                                            
000238        MOVE 'ERSK'              TO WCOM-CODABEND                 
000239        PERFORM Z00-ERRORE                                        
000240           THRU Z00-EX.                                           
000241                                                                  
000242 A00-EX. EXIT.                                                    
000243*----------------------------------------------------------------*
000244 A05-ELABORAZIONE.                                                
000245*----------------------------------------------------------------*
000246                                                                  
000247     INITIALIZE COMODI.                                           
000248                                                                  
000249     MOVE FR00-CODSOCIE          TO A531-CODSOCIE.                
000250     PERFORM L05-LEGGI-SOCIETA                                    
000251        THRU L05-EX.                                              
000252                                                                  
000253     IF FR00-CODDIVIS NOT = W-CODDIVIS                            
000254        MOVE FR00-CODDIVIS       TO W-CODDIVIS                    
000255        PERFORM L10-LEGGI-DIVMOVI                                 
000256           THRU L10-EX.                                           
000257                                                                  
000258     MOVE FR00-CODCLIEN          TO A901-CODCLIEN                 
000259     PERFORM L15-LEGGI-CLIENTE                                    
000260        THRU L15-EX                                               
000261                                                                  
000262     MOVE 1                      TO W-INDTAB.                     
000263                                                                  
000264     PERFORM VARYING W-INDSCA FROM 1 BY 1                         
000265       UNTIL W-INDSCA > 4 OR                                      
000266             FR00-DTSCADEN (W-INDSCA) = SPACES                    
000267             MOVE FR00-DTSCADEN (W-INDSCA) TO                     
000268                    W-SCA-DTSCA (W-INDSCA)                        
000269             MOVE FR00-IMPSCADE (W-INDSCA) TO                     
000270                    W-SCA-IMPQU (W-INDSCA)                        
000271             MOVE FR00-CVLSCADE (W-INDSCA) TO                     
000272                    W-SCA-CVLQU (W-INDSCA)                        
000273             MOVE FR00-PRCSCADE (W-INDSCA) TO                     
000274                    W-SCA-PRCAL (W-INDSCA)                        
000275             PERFORM B00-CARITABE                                 
000276                THRU B00-EX                                       
000277             VARYING W-INDDCE FROM 1 BY 1                         
000278               UNTIL W-INDDCE > 5                                 
000279                  OR FR00-CONTODCE (W-INDDCE) = SPACES            
000280     END-PERFORM.                                                 
000281                                                                  
000282     PERFORM B05-CALCOLAR                                         
000283        THRU B05-EX.                                              
000284                                                                  
000285     PERFORM B10-SCARITAB                                         
000286        THRU B10-EX.                                              
000287                                                                  
000288     PERFORM L00-LETTURA-FILEINP                                  
000289        THRU L00-EX.                                              
000290                                                                  
000291 A05-EX. EXIT.                                                    
000292*----------------------------------------------------------------*
000293 B00-CARITABE.                                                    
000294*----------------------------------------------------------------*
000295                                                                  
000296     MOVE FR00-DTSCADEN (W-INDSCA) TO W-DCE-DTSCA (W-INDTAB).     
000297     MOVE FR00-PRCSCADE (W-INDSCA) TO W-DCE-PRCAL (W-INDTAB).     
000298     MOVE FR00-CONTODCE (W-INDDCE) TO W-DCE-CODCE (W-INDTAB).     
000299     MOVE FR00-CVLXXDCE (W-INDDCE) TO W-DCE-CVLOR (W-INDTAB).     
000300     MOVE FR00-IMPORDCE (W-INDDCE) TO W-DCE-IMPOR (W-INDTAB).     
000301     MOVE FR00-PERCEIVA (W-INDDCE) TO W-DCE-PERIV (W-INDTAB).     
000302     MOVE FR00-ESENTIVA (W-INDDCE) TO W-DCE-ESENT (W-INDTAB).     
000303     MOVE FR00-IMPORIVA (W-INDDCE) TO W-DCE-IMIVA (W-INDTAB).     
000304     MOVE FR00-CVLXXIVA (W-INDDCE) TO W-DCE-CVIVA (W-INDTAB).     
000305                                                                  
000306     COMPUTE W-INDTAB = W-INDTAB + 1.                             
000307                                                                  
000308 B00-EX. EXIT.                                                    
000309                                                                  
000310*------------*                                                    
000311 B05-CALCOLAR.                                                    
000312*------------*                                                    
000313                                                                  
000314     MOVE W-DCE-CODCE (1) TO W-CONTODCE.                          
000315     MOVE 1               TO W-SAVINDCE.                          
000316                                                                  
000317     PERFORM C00-CALCOLI                                          
000318        THRU C00-EX                                               
000319     VARYING W-INDTAB FROM 1 BY 1                                 
000320       UNTIL W-INDTAB > 20 OR                                     
000321             W-DCE-CODCE (W-INDTAB) = SPACES.                     
000322                                                                  
000323     PERFORM D00-QUADRA-DCE                                       
000324        THRU D00-EX.                                              
000325                                                                  
000326 B05-EX. EXIT.                                                    
000327                                                                  
000328*------------*                                                    
000329 B10-SCARITAB.                                                    
000330*------------*                                                    
000331                                                                  
000332     MOVE 1 TO W-INDSAV.                                          
000333     MOVE 0 TO W-DCEIMPOR                                         
000334               W-DCECVALO.                                        
000335                                                                  
000336     PERFORM C05-QUADRA-SCADENZA                                  
000337        THRU C05-EX                                               
000338     VARYING W-INDTAB FROM 1 BY 1                                 
000339       UNTIL W-INDTAB > 4 OR                                      
000340             W-SCA-DTSCA (W-INDTAB) = SPACES.                     
000341                                                                  
000342     MOVE ZEROES TO W-TOTCVLDC.                                   
000343                                                                  
000344     PERFORM VARYING W-INDTAB FROM 1 BY 1                         
000345       UNTIL W-INDTAB > 20 OR                                     
000346             W-DCE-CODCE (W-INDTAB) = SPACES                      
000347             COMPUTE W-TOTCVLDC = W-TOTCVLDC             +        
000348                                  W-DCE-CVCAL (W-INDTAB) +        
000349                                  W-DCE-CIVAC (W-INDTAB) +        
000350                                  W-DCE-CADZC (W-INDTAB)          
000351     END-PERFORM.                                                 
000352                                                                  
000353     MOVE ZEROES TO W-TOTCVLDC.                                   
000354                                                                  
000355     PERFORM C10-CREA-MOVIDCE                                     
000356        THRU C10-EX                                               
000357     VARYING W-INDTAB FROM 1 BY 1                                 
000358       UNTIL W-INDTAB > 20 OR                                     
000359             W-DCE-CODCE (W-INDTAB) = SPACES.                     
000360                                                                  
000361     MOVE ZEROES TO W-TOTCVLSC.                                   
000362     MOVE ZEROES TO W-TOTTRASP.                                   
000363     MOVE ZEROES TO W-TOTCVTRA.                                   
000364                                                                  
000365     PERFORM VARYING W-INDSCA FROM 1 BY 1                         
000366       UNTIL W-INDSCA > 4 OR                                      
000367             W-SCA-DTSCA (W-INDSCA) = SPACES                      
000368             COMPUTE W-SCA-SCDED (W-INDSCA) =                     
000369                     (FR00-SCONTDED / 100) *                      
000370                      W-SCA-PRCAL (W-INDSCA)                      
000371             MOVE W-DECIDIVI TO ARR0-DECIDIVI                     
000372             MOVE W-SCA-SCDED (W-INDSCA) TO ARR0-IMPORTOX         
000373             PERFORM C15-SRARR0                                   
000374                THRU C15-EX                                       
000375             MOVE ARR0-IMPORTOX TO W-SCA-SCDED (W-INDSCA)         
000376             COMPUTE W-TOTSCONT = W-TOTSCONT +                    
000377                     W-SCA-SCDED (W-INDSCA)                       
000378             COMPUTE W-TOTCVLSC = W-TOTCVLSC +                    
000379                     W-SCA-CVLOR (W-INDSCA)                       
000380                                                                  
000381             COMPUTE ARR0-IMPORTOX =                              
000382                     (FR00-VALTRASP / 100) *                      
000383                      W-SCA-PRCAL (W-INDSCA)                      
000384             MOVE W-DECIDIVI TO ARR0-DECIDIVI                     
000385             PERFORM C15-SRARR0                                   
000386                THRU C15-EX                                       
000387             MOVE ARR0-IMPORTOX TO W-SCA-TRASP (W-INDSCA)         
000388             COMPUTE W-TOTTRASP = W-TOTTRASP +                    
000389                     W-SCA-TRASP (W-INDSCA)                       
000390                                                                  
000391             COMPUTE ARR0-IMPORTOX =                              
000392                     (FR00-CVLTRASP / 100) *                      
000393                      W-SCA-PRCAL (W-INDSCA)                      
000394             MOVE W-DECIDIVI TO ARR0-DECIDIVI                     
000395             PERFORM C15-SRARR0                                   
000396                THRU C15-EX                                       
000397             MOVE ARR0-IMPORTOX TO W-SCA-CVTRA (W-INDSCA)         
000398             COMPUTE W-TOTCVTRA = W-TOTCVTRA +                    
000399                     W-SCA-CVTRA (W-INDSCA)                       
000400     END-PERFORM.                                                 
000401                                                                  
000402     COMPUTE W-COMODIFF = FR00-SCONTDED - W-TOTSCONT.             
000403     COMPUTE W-SCA-SCDED (1) =                                    
000404             W-SCA-SCDED (1) + W-COMODIFF.                        
000405                                                                  
000406     COMPUTE W-COMODIFF = W-TOTCVLSC - W-TOTCVLDC.                
000407     COMPUTE W-SCA-CVLOR (1) =                                    
000408             W-SCA-CVLOR (1) + W-COMODIFF.                        
000409                                                                  
000410     COMPUTE W-COMODIFF = FR00-VALTRASP - W-TOTTRASP.             
000411     COMPUTE W-SCA-TRASP (1) =                                    
000412             W-SCA-TRASP (1) + W-COMODIFF.                        
000413                                                                  
000414     COMPUTE W-COMODIFF = FR00-CVLTRASP - W-TOTCVTRA.             
000415     COMPUTE W-SCA-CVTRA (1) =                                    
000416             W-SCA-CVTRA (1) + W-COMODIFF.                        
000417                                                                  
000418     PERFORM C20-CREA-MOVISCAD                                    
000419        THRU C20-EX                                               
000420     VARYING W-INDSCA FROM 1 BY 1                                 
000421       UNTIL W-INDSCA > 4 OR                                      
000422             W-SCA-DTSCA (W-INDSCA) = SPACES.                     
000423                                                                  
000424     PERFORM C25-CREA-MOVIMENTI                                   
000425        THRU C25-EX.                                              
000426                                                                  
000427     PERFORM C30-CREA-MOVINOTE                                    
000428        THRU C30-EX.                                              
000429                                                                  
000430     MOVE FR00-CVLSCDED TO W-MONSCOF1.                            
000431                                                                  
000432     IF FR00-CDMOVCON = 'R'                                       
000433        COMPUTE W-MONSCOF1 = W-MONSCOF1 * -1.                     
000434                                                                  
000435     IF SK-AGGIORNA = 'SI'                                        
000436        PERFORM C35-AGGIORNA-SICO                                 
000437           THRU C35-EX.                                           
000438                                                                  
000439 B10-EX. EXIT.                                                    
000440                                                                  
000441*-----------*                                                     
000442 C00-CALCOLI.                                                     
000443*-----------*                                                     
000444                                                                  
000445     COMPUTE  W-DCE-IMCAL(W-INDTAB)  =                            
000446             (W-DCE-IMPOR (W-INDTAB) / 100) *                     
000447              W-DCE-PRCAL (W-INDTAB).                             
000448     MOVE W-DECIDIVI             TO ARR0-DECIDIVI.                
000449     MOVE W-DCE-IMCAL (W-INDTAB) TO ARR0-IMPORTOX.                
000450     PERFORM C15-SRARR0                                           
000451        THRU C15-EX.                                              
000452     MOVE ARR0-IMPORTOX TO W-DCE-IMCAL (W-INDTAB).                
000453     COMPUTE  W-DCEIMPOR = W-DCEIMPOR + W-DCE-IMCAL (W-INDTAB).   
000454                                                                  
000455     COMPUTE  W-DCE-CVCAL(W-INDTAB)  =                            
000456             (W-DCE-CVLOR (W-INDTAB) / 100) *                     
000457              W-DCE-PRCAL (W-INDTAB).                             
000458     MOVE W-DECIDISO             TO ARR0-DECIDIVI.                
000459     MOVE W-DCE-CVCAL (W-INDTAB) TO ARR0-IMPORTOX.                
000460     PERFORM C15-SRARR0                                           
000461        THRU C15-EX.                                              
000462     MOVE ARR0-IMPORTOX TO W-DCE-CVCAL (W-INDTAB).                
000463     COMPUTE  W-DCECVALO = W-DCECVALO + W-DCE-CVCAL (W-INDTAB).   
000464                                                                  
000465     COMPUTE  W-DCE-IIVAC (W-INDTAB)  =                           
000466             (W-DCE-IMIVA (W-INDTAB) / 100) *                     
000467              W-DCE-PRCAL (W-INDTAB).                             
000468     MOVE W-DECIDIVI             TO ARR0-DECIDIVI.                
000469     MOVE W-DCE-IIVAC (W-INDTAB) TO ARR0-IMPORTOX.                
000470     PERFORM C15-SRARR0                                           
000471        THRU C15-EX.                                              
000472     MOVE ARR0-IMPORTOX TO W-DCE-IIVAC (W-INDTAB).                
000473     COMPUTE  W-DCEIMIVA = W-DCEIMIVA + W-DCE-IIVAC (W-INDTAB).   
000474                                                                  
000475     COMPUTE  W-DCE-CIVAC (W-INDTAB)  =                           
000476             (W-DCE-CVIVA (W-INDTAB) / 100) *                     
000477              W-DCE-PRCAL (W-INDTAB).                             
000478     MOVE W-DECIDISO             TO ARR0-DECIDIVI.                
000479     MOVE W-DCE-CIVAC (W-INDTAB) TO ARR0-IMPORTOX.                
000480     PERFORM C15-SRARR0                                           
000481        THRU C15-EX.                                              
000482     MOVE ARR0-IMPORTOX TO W-DCE-CIVAC (W-INDTAB).                
000483     COMPUTE  W-DCECVIVA = W-DCECVIVA + W-DCE-CIVAC (W-INDTAB).   
000484                                                                  
000485     IF FR00-ADDFATTU > 0                                         
000486        PERFORM  D05-CALCOLA-ADDIZIONALE                          
000487           THRU  D05-EX.                                          
000488                                                                  
000489 C00-EX. EXIT.                                                    
000490                                                                  
000491*-------------------*                                             
000492 C05-QUADRA-SCADENZA.                                             
000493*-------------------*                                             
000494                                                                  
000495     PERFORM VARYING W-INDDCE FROM W-INDSAV BY 1                  
000496       UNTIL W-INDDCE > 20 OR                                     
000497             W-DCE-DTSCA (W-INDDCE) NOT EQUAL                     
000498             W-SCA-DTSCA (W-INDTAB)                               
000499             MOVE W-SCA-IMPQU (W-INDTAB) TO W-SAVEIMPO            
000500             MOVE W-SCA-CVLQU (W-INDTAB) TO W-SAVECVAL            
000501             COMPUTE W-DCEIMPOR = W-DCEIMPOR             +        
000502                                  W-DCE-IMCAL (W-INDDCE) +        
000503                                  W-DCE-IIVAC (W-INDDCE) +        
000504                                  W-DCE-IADZC (W-INDDCE)          
000505             COMPUTE W-DCECVALO = W-DCECVALO             +        
000506                                  W-DCE-CVCAL (W-INDDCE) +        
000507                                  W-DCE-CIVAC (W-INDDCE) +        
000508                                  W-DCE-CADZC (W-INDDCE)          
000509     END-PERFORM.                                                 
000510                                                                  
000511     COMPUTE W-COMODIFF = W-SAVEIMPO - W-DCEIMPOR.                
000512     COMPUTE W-DCE-IMCAL (W-INDSAV)  = W-DCE-IMCAL (W-INDSAV) +   
000513                                       W-COMODIFF.                
000514     COMPUTE W-COMODIFF = W-SAVECVAL - W-DCECVALO.                
000515     COMPUTE W-DCE-CVCAL (W-INDSAV)  = W-DCE-CVCAL (W-INDSAV) +   
000516                                       W-COMODIFF.                
000517                                                                  
000518     MOVE W-INDDCE TO W-INDSAV.                                   
000519     MOVE 0 TO W-DCEIMPOR                                         
000520               W-DCECVALO.                                        
000521                                                                  
000522 C05-EX. EXIT.                                                    
000523                                                                  
000524*----------------*                                                
000525 C10-CREA-MOVIDCE.                                                
000526*----------------*                                                
000527                                                                  
000528     INITIALIZE DCLTMOVIDCE.                                      
000529     MOVE FR00-CODSOCIE          TO C858-CODSOCIE.                
000530     MOVE FR00-CODCLIEN          TO C858-CODCLIEN.                
000531     MOVE FR00-CDMOVCON          TO C858-CDMOVCON.                
000532     MOVE FR00-NRMOVCON          TO C858-NRMOVCON.                
000533     MOVE FR00-DTREGMOV          TO C858-DTREGMOV.                
000534     MOVE W-DCE-DTSCA (W-INDTAB) TO C858-DTSCADEN.                
000535     MOVE W-DCE-CODCE (W-INDTAB) TO C858-CONTODCE.                
000536     MOVE W-DCE-IMCAL (W-INDTAB) TO C858-IMPARMOV.                
000537     MOVE FR00-INDSEGNO          TO C858-INDSEGNO.                
000538     MOVE W-DCE-CVCAL (W-INDTAB) TO C858-CVLMOVIM.                
000539     MOVE W-DCE-IIVAC (W-INDTAB) TO C858-IMPORIVA.                
000540     MOVE W-DCE-PERIV (W-INDTAB) TO C858-PERCEIVA.                
000541     MOVE W-DCE-ESENT (W-INDTAB) TO C858-ESENTIVA.                
000542     MOVE W-DCE-IADZC (W-INDTAB) TO C858-IMPADIVA.                
000543     MOVE FR00-ADDFATTU          TO C858-ADDFATTU.                
000544     MOVE FR00-CODUTVAR          TO C858-CODUTVAR.                
000545     MOVE FR00-DTREGMOV          TO C858-DTULTVAR.                
000546     MOVE W-DCE-CIVAC (W-INDTAB) TO C858-CVLXXIVA.                
000547     MOVE W-DCE-CADZC (W-INDTAB) TO C858-CVLADIVA.                
000548                                                                  
000549     IF SK-AGGIORNA = 'SI'                                        
000550        PERFORM I00-INSERT-MOVIDCE                                
000551           THRU I00-EX.                                           
000552                                                                  
000553     MOVE C858-CONTODCE TO C861-CONTODCE.                         
000554     MOVE C858-CODSOCIE TO A531-CODSOCIE.                         
000555     PERFORM L16-SELECT-CONTIDCE                                  
000556        THRU L16-EX.                                              
000557                                                                  
000558     IF FR00-INDSEGNO = '+'                                       
000559        COMPUTE W-IMPSCOPE = W-IMPSCOPE    +                      
000560                             C858-CVLMOVIM +                      
000561                             C858-CVLXXIVA +                      
000562                             C858-CVLADIVA                        
000563     ELSE                                                         
000564        COMPUTE W-IMPSCOPE = W-IMPSCOPE -                         
000565                            (C858-CVLMOVIM +                      
000566                             C858-CVLXXIVA +                      
000567                             C858-CVLADIVA).                      
000568                                                                  
000569     IF C861-INDBILQU = 'V' OR C861-CONTPROV = 'FACON'            
000570        IF C858-CDMOVCON = 'R'                                    
000571           COMPUTE W-MONTRES1 = W-MONTRES1 + C858-CVLMOVIM        
000572        ELSE                                                      
000573           COMPUTE W-MONTFAT1 = W-MONTFAT1 + C858-CVLMOVIM        
000574           IF C858-ESENTIVA = 'L'                                 
000575              COMPUTE W-IMPNOIVA = W-IMPNOIVA + C858-CVLMOVIM.    
000576                                                                  
000577     PERFORM VARYING W-INDSCA FROM 1 BY 1                         
000578       UNTIL W-SCA-DTSCA (W-INDSCA) = C858-DTSCADEN               
000579     END-PERFORM.                                                 
000580                                                                  
000581     COMPUTE W-TOTCVLDC = W-TOTCVLDC    +                         
000582                          C858-CVLMOVIM +                         
000583                          C858-CVLXXIVA +                         
000584                          C858-CVLADIVA.                          
000585                                                                  
000586     COMPUTE W-SCA-IMIVA (W-INDSCA) = W-SCA-IMIVA (W-INDSCA) +    
000587                                      C858-IMPORIVA          +    
000588                                      C858-IMPADIVA.              
000589                                                                  
000590     COMPUTE W-SCA-CVIVA (W-INDSCA) = W-SCA-CVIVA (W-INDSCA) +    
000591                                      C858-CVLXXIVA          +    
000592                                      C858-CVLADIVA.              
000593                                                                  
000594     COMPUTE W-SCA-IMPOR (W-INDSCA) = W-SCA-IMPOR (W-INDSCA) +    
000595                                      C858-IMPARMOV          +    
000596                                      C858-IMPORIVA          +    
000597                                      C858-IMPADIVA.              
000598                                                                  
000599     COMPUTE W-SCA-CVLOR (W-INDSCA) = W-SCA-CVLOR (W-INDSCA) +    
000600                                      C858-CVLMOVIM          +    
000601                                      C858-CVLXXIVA          +    
000602                                      C858-CVLADIVA.              
000603                                                                  
000604 C10-EX. EXIT.                                                    
000605                                                                  
000606*-----------*                                                     
000607 C15-SRARR0.                                                      
000608*-----------*                                                     
000609                                                                  
000610*    EXEC SQL INCLUDE SRARR0 END-EXEC.                            
      *>>((file: SRARR0))
000001*----------------------------------------------------------------*
000002*                                                                *
000003*    GESTIONE RIGHE DI FATTURA.                                  *
000004*                                                                *
000005*    CALCOLA IMPORTO ARROTONDATO IN BASE AL NUMERO DI DECIMALI   *
000006*    DELLA DIVISA.                                               *
000007*                                                                *
000008*    N.B.  INSERIRE IN WORKING STORAGE :                         *
000009*                                                                *
000010*    COPY DCARR0.                                                *
000011*                                                                *
000012*----------------------------------------------------------------*
000013                                                                  
000014     MOVE ZERO                   TO ARR0-INTEROXX                 
000015                                    ARR0-DECIMA1X                 
000016                                    ARR0-DECIMA2X.                
000017                                                                  
000018     IF  ARR0-DECIDIVI = '0'                                      
000019         COMPUTE ARR0-IMPORTOX = ARR0-IMPORTOX + 0,5000           
000020         MOVE ARR0-IMPORTOX      TO ARR0-INTEROXX                 
000021         MOVE ARR0-INTEROXX      TO ARR0-IMPORTOX                 
000022     ELSE                                                         
000023         IF  ARR0-DECIDIVI = '1'                                  
000024             COMPUTE ARR0-IMPORTOX = ARR0-IMPORTOX + 0,0500       
000025             MOVE ARR0-IMPORTOX  TO ARR0-DECIMA1X                 
000026             MOVE ARR0-DECIMA1X  TO ARR0-IMPORTOX                 
000027         ELSE                                                     
000028             COMPUTE ARR0-IMPORTOX = ARR0-IMPORTOX + 0,0050       
000029             MOVE ARR0-IMPORTOX  TO ARR0-DECIMA2X                 
000030             MOVE ARR0-DECIMA2X  TO ARR0-IMPORTOX.                
000031                                                                  
      *<<((file: SRARR0))
000611                                                                  
000612 C15-EX.                                                          
000613     EXIT.                                                        
000614                                                                  
000615*-----------------*                                               
000616 C20-CREA-MOVISCAD.                                               
000617*-----------------*                                               
000618                                                                  
000619     INITIALIZE DCLTMOVISCAD.                                     
000620     MOVE FR00-CODSOCIE           TO C855-CODSOCIE.               
000621     MOVE FR00-CODCLIEN           TO C855-CODCLIEN.               
000622     MOVE FR00-CDMOVCON           TO C855-CDMOVCON.               
000623     MOVE FR00-NRMOVCON           TO C855-NRMOVCON.               
000624     MOVE FR00-DTREGMOV           TO C855-DTREGMOV.               
000625     MOVE W-SCA-DTSCA  (W-INDSCA) TO C855-DTSCADEN                
000626                                     C855-SCADORIG.               
000627     MOVE FR00-TIPOPAGA           TO C855-TIPOPAGA.               
000628     IF FR00-DTDECORR GREATER FR00-DTREGMOV                       
000629        MOVE FR00-DTDECORR        TO C855-DTDECORR.               
000630     MOVE W-SCA-IMPOR  (W-INDSCA) TO C855-IMPMOVIM.               
000631     MOVE FR00-INDSEGNO           TO C855-INDSEGNO.               
000632     MOVE W-SCA-CVLOR  (W-INDSCA) TO C855-CVLMOVIM.               
000633     MOVE W-SCA-IMIVA  (W-INDSCA) TO C855-IMPORIVA.               
000634     MOVE W-SCA-SCDED  (W-INDSCA) TO C855-SCONTDED.               
000635     MOVE FR00-CDSELTIP           TO C855-CDSELTIP.               
000636     MOVE FR00-CDSELMOV           TO C855-CDSELMOV.               
000637     MOVE C855-DTREGMOV           TO C855-DTULTVAR.               
000638     MOVE FR00-CODUTVAR           TO C855-CODUTVAR.               
000639     MOVE FR00-CODDIVIS           TO C855-CODDIVIS.               
000640     MOVE FR00-NOTENOTE           TO C855-NOTENOTE.               
000641     MOVE W-SCA-CVIVA  (W-INDSCA) TO C855-CVLXXIVA.               
000642     MOVE W-SCA-TRASP  (W-INDSCA) TO C855-VALTRASP.               
000643     MOVE W-SCA-CVTRA  (W-INDSCA) TO C855-CVLTRASP.               
000644                                                                  
000645     IF C855-SCONTDED GREATER ZEROES                              
000646        MOVE 'N'                  TO C855-NETTSCON.               
000647                                                                  
000648     IF W-SCA-DTSCA (2) GREATER SPACES                            
000649        MOVE 'S'                  TO C855-PLUSSCAD.               
000650                                                                  
000651     IF SK-AGGIORNA = 'SI'                                        
000652        PERFORM I05-INSERT-MOVISCAD                               
000653           THRU I05-EX.                                           
000654                                                                  
000655 C20-EX. EXIT.                                                    
000656                                                                  
000657*----------------------------------------------------------------*
000658 C25-CREA-MOVIMENTI.                                              
000659*----------------------------------------------------------------*
000660                                                                  
000661     MOVE SPACES                 TO DCLTMOVIMENTI.                
000662     INITIALIZE                     DCLTMOVIMENTI.                
000663     MOVE FR00-CODSOCIE          TO C852-CODSOCIE.                
000664     MOVE FR00-CODCLIEN          TO C852-CODCLIEN.                
000665     MOVE FR00-CDMOVCON          TO C852-CDMOVCON.                
000666     MOVE FR00-NRMOVCON          TO C852-NRMOVCON.                
000667     MOVE FR00-DTREGMOV          TO C852-DTREGMOV.                
000668     MOVE FR00-CENCOSTO          TO C852-CENCOSTO.                
000669     MOVE FR00-CODAGENT          TO C852-CODAGENT.                
000670     MOVE FR00-CAUSACON          TO C852-CAUSACON.                
000671     MOVE FR00-NRMOVRIF          TO C852-NRMOVRIF.                
000672     MOVE FR00-CODUTVAR          TO C852-CODUTVAR                 
000673                                    C852-CODUTCRE.                
000674     MOVE FR00-BANDIVAL          TO C852-BANDIVAL.                
000675     MOVE FR00-NRDICVAL          TO C852-NRDICVAL.                
000676     MOVE FR00-DTREGMOV          TO C852-DTULTVAR.                
000677     MOVE FR00-IMPROFAT          TO C852-IMPROFAT.                
000678     MOVE FR00-TIPOMOVI          TO C852-TIPOMOVI.                
000679     MOVE FR00-VOCEDOPR          TO C852-VOCEDOPR.                
000680     MOVE FR00-IMPDOGPR          TO C852-IMPDOGPR.                
000681     MOVE FR00-SLTIPLIN          TO C852-SLTIPLIN.                
000682     MOVE FR00-CLIEMERC          TO C852-CLIEMERC.                
000683     MOVE FR00-NUMESIVA          TO C852-NUMESIVA.                
000684     MOVE FR00-DATESIVA          TO C852-DATESIVA.                
000685     MOVE FR00-UFFICIVA          TO C852-UFFICIVA.                
000686     MOVE FR00-CDMOVRIF          TO C852-CDMOVRIF.                
000687     MOVE FR00-DATAMRIF          TO C852-DATAMRIF.                
000688     MOVE FR00-CONDXASS          TO C852-CONDXASS.                
000689                                                                  
000690     IF FR00-CDMOVCON = 'F' AND                                   
000691        FR00-NRFATPRO(1:1) NUMERIC                                
000692        MOVE FR00-CODSOCIE       TO AB53-CODSOCIE                 
000693        PERFORM L30-SELECT-ASSIMIN                                
000694           THRU L30-EX                                            
000695        IF SQLCODE = ZEROES AND                                   
000696           FR00-CVLMOVIM < AB53-IMPFATTU                          
000697           MOVE 'C'              TO C852-FLAGASSI.                
000698                                                                  
000699     IF SK-AGGIORNA = 'SI'                                        
000700        PERFORM I10-INSERT-MOVIMENTI                              
000701           THRU I10-EX.                                           
000702                                                                  
000703 C25-EX. EXIT.                                                    
000704                                                                  
000705*-----------------*                                               
000706 C30-CREA-MOVINOTE.                                               
000707*-----------------*                                               
000708                                                                  
000709     IF FR00-CDCEACQU GREATER SPACES                              
000710        PERFORM D10-COMPLETA-NOTE-ACQUI                           
000711           THRU D10-EX                                            
000712     ELSE                                                         
000713        IF FR00-CDMOVCON = 'F'      AND                           
000714           FR00-GENEFATT EQUAL 'F'  AND                           
000715           A901-GENECLIE =  'S'                                   
000716           PERFORM D15-COMPLETA-NOTE                              
000717              THRU D15-EX                                         
000718        ELSE                                                      
000719           IF FR00-CDMOVCON = 'R'                                 
000720              PERFORM D20-CLIEFATT                                
000721                 THRU D20-EX                                      
000722              IF A901-GENECLIE = 'S'                              
000723                 PERFORM D15-COMPLETA-NOTE                        
000724                    THRU D15-EX.                                  
000725                                                                  
000726 C30-EX. EXIT.                                                    
000727                                                                  
000728*-----------------*                                               
000729 C35-AGGIORNA-SICO.                                               
000730*-----------------*                                               
000731                                                                  
000732     MOVE 'C35-'                 TO WCOM-CODABEND.                
000733     MOVE 'UPDATE'               TO WCOM-FILEFUNZ.                
000734     MOVE 'TSICO'                TO WCOM-FILENOME.                
000735     STRING C855-CODSOCIE ' ' C855-CODCLIEN                       
000736            DELIMITED BY SIZE  INTO WCOM-FILECTRL.                
000737                                                                  
000739     
      *EXEC SQL 
      *UPDATE DCONTCLI.TSICO                                   
000740*          SET    MONTFAT1 = MONTFAT1 + :W-MONTFAT1                
000741*                ,MONTRES1 = MONTRES1 + :W-MONTRES1                
000742*                ,IMPNOIVA = IMPNOIVA + :W-IMPNOIVA                
000743*                ,MONSCOF1 = MONSCOF1 + :W-MONSCOF1                
000744*                ,IMPSCOPE = IMPSCOPE + :W-IMPSCOPE                
000745*          WHERE CODSOCIE = :C855-CODSOCIE                         
000746*            AND CODCLIEN = :C855-CODCLIEN                         
000747*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 1 TO SQL-STMT-ID 
           MOVE 7 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE W-MONTFAT1
            BY VALUE 0
                     0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE W-MONTRES1
            BY VALUE 0
                     0

           MOVE 11 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE W-IMPNOIVA
            BY VALUE 0
                     0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE W-MONSCOF1
            BY VALUE 0
                     0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE W-IMPSCOPE
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-CODSOCIE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-CODCLIEN
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000748                                                                  
000749     IF  SQLCODE = ZERO                                           
000750         MOVE 'U'                TO PPROUTIN                      
000751         MOVE 'D'                TO PPTPFILE                      
000752         MOVE 'U'                TO PPTPOPER                      
000753         MOVE 'SICO   '          TO PPNMFILE                      
000754         PERFORM Z90-READPRIN                                     
000755            THRU Z90-EX                                           
000756     ELSE                                                         
000757         PERFORM Z00-ERRORE                                       
000758            THRU Z00-EX.                                          
000759                                                                  
000760 C35-EX. EXIT.                                                    
000761                                                                  
000762*---------------*                                                 
000763 D00-QUADRA-DCE.                                                  
000764*---------------*                                                 
000765                                                                  
000766     INITIALIZE W-TABTOTDCE.                                      
000767                                                                  
000768     PERFORM VARYING W-INDQUAD FROM 1 BY 1                        
000769       UNTIL W-INDQUAD > 20 OR                                    
000770             W-DCE-DTSCA (W-INDQUAD) = SPACES                     
000771             PERFORM VARYING W-INDTDCE FROM 1 BY 1                
000772               UNTIL W-INDTDCE > 5              OR                
000773               W-TDC-CODCE (W-INDTDCE) = SPACES OR                
000774               W-TDC-CODCE (W-INDTDCE) = W-DCE-CODCE (W-INDQUAD)  
000775             END-PERFORM                                          
000776             IF W-TDC-CODCE (W-INDTDCE) = SPACES OR               
000777                W-TDC-CODCE (W-INDTDCE) = W-DCE-CODCE (W-INDQUAD) 
000778                MOVE W-DCE-CODCE (W-INDQUAD) TO                   
000779                     W-TDC-CODCE (W-INDTDCE)                      
000780                COMPUTE W-TDC-IMCAL (W-INDTDCE) =                 
000781                        W-TDC-IMCAL (W-INDTDCE) +                 
000782                        W-DCE-IMCAL (W-INDQUAD)                   
000783                COMPUTE W-TDC-CVCAL (W-INDTDCE) =                 
000784                        W-TDC-CVCAL (W-INDTDCE) +                 
000785                        W-DCE-CVCAL (W-INDQUAD)                   
000786                COMPUTE W-TDC-IIVAC (W-INDTDCE) =                 
000787                        W-TDC-IIVAC (W-INDTDCE) +                 
000788                        W-DCE-IIVAC (W-INDQUAD)                   
000789                COMPUTE W-TDC-CIVAC (W-INDTDCE) =                 
000790                        W-TDC-CIVAC (W-INDTDCE) +                 
000791                        W-DCE-CIVAC (W-INDQUAD)                   
000792                COMPUTE W-TDC-IADZC (W-INDTDCE) =                 
000793                        W-TDC-IADZC (W-INDTDCE) +                 
000794                        W-DCE-IADZC (W-INDQUAD)                   
000795                COMPUTE W-TDC-CADZC (W-INDTDCE) =                 
000796                        W-TDC-CADZC (W-INDTDCE) +                 
000797                        W-DCE-CADZC (W-INDQUAD)                   
000798             ELSE                                                 
000799                STRING 'TABELLA QUADRATURA DCE INSUFFICIENTE '    
000800                       FR00-CODSOCIE ' ' FR00-CODCLIEN ' '        
000801                       FR00-NRMOVCON ' ' FR00-DTREGMOV            
000802                       DELIMITED BY SIZE INTO PPMESSAG            
000803                       MOVE 'M' TO PPROUTIN                       
000804                       PERFORM Z90-READPRIN                       
000805                          THRU Z90-EX                             
000806                       MOVE 'TINS' TO WCOM-CODABEND               
000807                       PERFORM Z00-ERRORE                         
000808                          THRU Z00-EX                             
000809             END-IF                                               
000810     END-PERFORM.                                                 
000811                                                                  
000812     PERFORM VARYING W-INDTDCE FROM 1 BY 1                        
000813       UNTIL W-INDTDCE > 5 OR                                     
000814             W-TDC-CODCE (W-INDTDCE) = SPACES                     
000815             PERFORM VARYING W-INDQUAD FROM 1 BY 1                
000816               UNTIL W-DCE-CODCE (W-INDQUAD) =                    
000817                     W-TDC-CODCE (W-INDTDCE)                      
000818             END-PERFORM                                          
000819             COMPUTE W-COMODIFF = W-DCE-IMPOR (W-INDQUAD) -       
000820                                  W-TDC-IMCAL (W-INDTDCE)         
000821             COMPUTE W-DCE-IMCAL (W-INDQUAD) =                    
000822                     W-DCE-IMCAL (W-INDQUAD) + W-COMODIFF         
000823             COMPUTE W-COMODIFF = W-DCE-CVLOR (W-INDQUAD) -       
000824                                  W-TDC-CVCAL (W-INDTDCE)         
000825             COMPUTE W-DCE-CVCAL (W-INDQUAD) =                    
000826                     W-DCE-CVCAL (W-INDQUAD) + W-COMODIFF         
000827             COMPUTE W-COMODIFF = W-DCE-IMIVA (W-INDQUAD) -       
000828                                  W-TDC-IIVAC (W-INDTDCE)         
000829             COMPUTE W-DCE-IIVAC (W-INDQUAD) =                    
000830                     W-DCE-IIVAC (W-INDQUAD) + W-COMODIFF         
000831             COMPUTE W-COMODIFF = W-DCE-CVIVA (W-INDQUAD) -       
000832                                  W-TDC-CIVAC (W-INDTDCE)         
000833             COMPUTE W-DCE-CIVAC (W-INDQUAD) =                    
000834                     W-DCE-CIVAC (W-INDQUAD) + W-COMODIFF         
000835             COMPUTE W-COMODIFF = W-DCE-IADZC (W-INDQUAD) -       
000836                                  W-TDC-IADZC (W-INDTDCE)         
000837             COMPUTE W-DCE-IADZC (W-INDQUAD) =                    
000838                     W-DCE-IADZC (W-INDQUAD) + W-COMODIFF         
000839             COMPUTE W-COMODIFF = W-DCE-CADZC (W-INDQUAD) -       
000840                                  W-TDC-CADZC (W-INDTDCE)         
000841             COMPUTE W-DCE-CADZC (W-INDQUAD) =                    
000842                     W-DCE-CADZC (W-INDQUAD) + W-COMODIFF         
000843     END-PERFORM.                                                 
000844                                                                  
000845 D00-EX. EXIT.                                                    
000846                                                                  
000847*-----------------------*                                         
000848 D05-CALCOLA-ADDIZIONALE.                                         
000849*-----------------------*                                         
000850                                                                  
000851     COMPUTE  W-DCE-IADZC (W-INDTAB)  =                           
000852             (W-DCE-IMPOR(W-INDTAB) / 100) * FR00-ADDFATTU.       
000853     COMPUTE  W-DCE-CADZC (W-INDTAB)  =                           
000854             (W-DCE-CVLOR(W-INDTAB) / 100) * FR00-ADDFATTU.       
000855     MOVE W-CODDIVSO             TO ARR1-CODDIVIS.                
000856     MOVE W-DECIDISO             TO ARR1-DECIDIVI.                
000857     MOVE W-DCE-IADZC (W-INDTAB) TO ARR1-IMPORTOX.                
000858     MOVE A531-CODPAESE          TO ARR1-CODPAESE.                
000859     PERFORM E00-SRARR1                                           
000860        THRU E00-EX.                                              
000861     MOVE ARR1-IMPORTOX  TO         W-DCE-IADZC (W-INDTAB).       
000862     MOVE W-DCE-CADZC (W-INDTAB) TO ARR1-IMPORTOX.                
000863     PERFORM E00-SRARR1                                           
000864        THRU E00-EX.                                              
000865     MOVE ARR1-IMPORTOX  TO         W-DCE-CADZC (W-INDTAB).       
000866     COMPUTE  W-DCEIADZI = W-DCEIADZI + W-DCE-IADZC (W-INDTAB).   
000867     COMPUTE  W-DCECADZI = W-DCECADZI + W-DCE-CADZC (W-INDTAB).   
000868                                                                  
000869 D05-EX. EXIT.                                                    
000870                                                                  
000871*-----------------------*                                         
000872 D10-COMPLETA-NOTE-ACQUI.                                         
000873*-----------------------*                                         
000874                                                                  
000875     INITIALIZE DCLTMOVINOTE.                                     
000876                                                                  
000877     MOVE FR00-CODSOCIE         TO  C857-CODSOCIE.                
000878     MOVE FR00-CODCLIEN         TO  C857-CODCLIEN.                
000879     MOVE FR00-CDMOVCON         TO  C857-CDMOVCON.                
000880     MOVE FR00-NRMOVCON         TO  C857-NRMOVCON.                
000881     MOVE FR00-DTREGMOV         TO  C857-DTCREAZI                 
000882                                    C857-DTREGMOV.                
000883     STRING 'DCE X ACQUISTO ===> ' FR00-CDCEACQU                  
000884            DELIMITED BY SIZE INTO C857-NOTESTA5.                 
000885                                                                  
000886     IF SK-AGGIORNA = 'SI'                                        
000887        PERFORM I15-INSERT-MOVINOTE                               
000888           THRU I15-EX.                                           
000889                                                                  
000890 D10-EX. EXIT.                                                    
000891                                                                  
000892*-----------------*                                               
000893 D15-COMPLETA-NOTE.                                               
000894*-----------------*                                               
000895                                                                  
000896     INITIALIZE DCLTMOVINOTE.                                     
000897                                                                  
000898     IF A901-TIPOCONS = 'V' OR 'A'                                
000899        INITIALIZE DCLVANAGRAF-C60                                
000900        MOVE FR00-CODSOCIE       TO AC60-SOCIEVEN                 
000901        MOVE A901-CLIFOCON       TO AC60-CLIFOCON                 
000902        PERFORM L20-SELECT-VBVENCON                               
000903           THRU L20-EX                                            
000904        MOVE AC60-CENCOSTO       TO W-CENCOSTO                    
000905        MOVE AC60-CONTODCE       TO WS-CONTODCE                   
000906        MOVE   WS-CONTODCE       TO W-CONTODCE                    
000907        MOVE   A901-CLIFOCON     TO A972-CODFORNI                 
000908        PERFORM L25-SELECT-FORNITORI                              
000909           THRU L25-EX                                            
000910        MOVE A972-CODPAESE       TO W-PAESOCIE                    
000911     ELSE                                                         
000912        PERFORM E05-SOCIMIRO                                      
000913           THRU E05-EX                                            
000914        MOVE A531-CODPAESE       TO W-PAESOCIE.                   
000915                                                                  
000916     IF A531-FLFATACQ = 'S'                                       
000917        PERFORM E10-SCBNMFA                                       
000918           THRU E10-EX                                            
000919        IF NMFA-FLAGINTR = 'S'                                    
000920           MOVE 'S'              TO C857-FLAGINTR                 
000921        END-IF                                                    
000922        MOVE W-CONTODCE          TO C857-CONTODCE                 
000923        MOVE W-CENCOSTO          TO C857-CENCOSTO                 
000924        MOVE C852-CODSOCIE       TO C857-CODSOCIE                 
000925        MOVE C852-CODCLIEN       TO C857-CODCLIEN                 
000926        MOVE C852-CDMOVCON       TO C857-CDMOVCON                 
000927        MOVE C852-NRMOVCON       TO C857-NRMOVCON                 
000928        MOVE ZERO                TO C857-NUMPROG3                 
000929                                    W-NUMPROG3                    
000930        MOVE C852-DTREGMOV       TO C857-DTCREAZI                 
000931                                    C857-DTREGMOV                 
000932        IF SK-AGGIORNA = 'SI'                                     
000933           PERFORM I15-INSERT-MOVINOTE                            
000934              THRU I15-EX.                                        
000935                                                                  
000936 D15-EX. EXIT.                                                    
000937                                                                  
000938*----------*                                                      
000939 D20-CLIEFATT.                                                    
000940*----------*                                                      
000941                                                                  
000942     IF A901-CLIEFATT GREATER SPACES                              
000943        MOVE A901-CLIEFATT TO A901-CODCLIEN                       
000944        PERFORM L15-LEGGI-CLIENTE                                 
000945           THRU L15-EX.                                           
000946                                                                  
000947 D20-EX. EXIT.                                                    
000948                                                                  
000949*-----------*                                                     
000950 E00-SRARR1.                                                      
000951*-----------*                                                     
000952                                                                  
000953*    EXEC SQL INCLUDE SRARR1 END-EXEC.                            
      *>>((file: SRARR1))
000001*----------------------------------------------------------------*
000002*                                                                *
000003*    GESTIONE RIGHE DI FATTURA.                                  *
000004*                                                                *
000005*    CALCOLA IMPORTO IVA ARROTONDATO IN BASE AL CODICE DIVISA    *
000006*    OPPURE IN BASE AL NUMERO DI DECIMALI DELLA DIVISA.          *
000007*                                                                *
000008*    N.B.  INSERIRE IN WORKING STORAGE :                         *
000009*                                                                *
000010*    COPY DCARR1.                                                *
000011*                                                                *
000012*----------------------------------------------------------------*
000013                                                                  
000014     MOVE ZERO                   TO ARR1-ARROTIVA                 
000015                                    ARR1-INTEROXX                 
000016                                    ARR1-DECIMA2X.                
000017                                                                  
000018     IF ARR1-CODDIVIS = '75'                                      
000019        MOVE 0,005               TO ARR1-ARROTIVA                 
000020     ELSE                                                         
000021        IF ARR1-DECIDIVI = '0'                                    
000022           MOVE 0,4999           TO ARR1-ARROTIVA                 
000023           IF ARR1-CODPAESE = '000' OR '005'                      
000024              MOVE 0,9999        TO ARR1-ARROTIVA                 
000025           ELSE                                                   
000026              IF ARR1-CODPAESE = '004'                            
000027                 MOVE 0,5999     TO ARR1-ARROTIVA                 
000028              ELSE                                                
000029                 IF ARR1-CODPAESE = '068'                         
000030                    MOVE 0,5000  TO ARR1-ARROTIVA                 
000031                 END-IF                                           
000032        ELSE                                                      
000033           MOVE 0,0049           TO ARR1-ARROTIVA                 
000034           IF ARR1-CODPAESE = '000' OR '005'                      
000035              MOVE 0,0099        TO ARR1-ARROTIVA                 
000036           ELSE                                                   
000037              IF ARR1-CODPAESE = '004'                            
000038                 MOVE 0,0059     TO ARR1-ARROTIVA                 
000039              ELSE                                                
000040                 IF ARR1-CODPAESE = '068'                         
000041                    MOVE 0,0050  TO ARR1-ARROTIVA.                
000042                                                                  
000043     COMPUTE ARR1-IMPORTOX = ARR1-IMPORTOX + ARR1-ARROTIVA        
000044                                                                  
000045     IF ARR1-DECIDIVI = '0'                                       
000046        MOVE ARR1-IMPORTOX       TO ARR1-INTEROXX                 
000047        MOVE ARR1-INTEROXX       TO ARR1-IMPORTOX                 
000048     ELSE                                                         
000049        MOVE ARR1-IMPORTOX       TO ARR1-DECIMA2X                 
000050        MOVE ARR1-DECIMA2X       TO ARR1-IMPORTOX.                
      *<<((file: SRARR1))
000954                                                                  
000955 E00-EX.                                                          
000956     EXIT.                                                        
000957                                                                  
000958*------------------*                                              
000959 E05-SOCIMIRO.                                                    
000960*------------------*                                              
000961                                                                  
000962     MOVE A901-CLIFOCON       TO A531-CODFORNI.                   
000963     MOVE 'E05-'              TO WCOM-CODABEND.                   
000964     MOVE 'SOCIETA'           TO WCOM-FILENOME.                   
000965     MOVE 'SELECT '           TO WCOM-FILEFUNZ.                   
000966     MOVE A531-CODFORNI       TO WCOM-FILECTRL.                   
000967                                                                  
000969     
      *EXEC SQL 
      *SELECT  CODSOCIE, FLFATACQ                              
000970*            INTO  :A531-CODSOCIE, :A531-FLFATACQ                  
000971*            FROM  DANAGRAF.TSOCIETA                               
000972*           WHERE  CODFORNI = :A531-CODFORNI                       
000973*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 2 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODFORNI
            BY VALUE 0
                     0

           MOVE 3 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-FLFATACQ
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000974                                                                  
000975     IF SQLCODE NOT = +0                                          
000976        PERFORM Z00-ERRORE                                        
000977           THRU Z00-EX.                                           
000978                                                                  
000979     MOVE 'SOCIMIR'              TO PPNMFILE.                     
000980     MOVE 'D'                    TO PPTPFILE.                     
000981     MOVE 'R'                    TO PPTPOPER.                     
000982     MOVE 'U'                    TO PPROUTIN.                     
000983     PERFORM Z90-READPRIN                                         
000984        THRU Z90-EX.                                              
000985                                                                  
000986 E05-EX. EXIT.                                                    
000987                                                                  
000988*------------------*                                              
000989 E10-SCBNMFA.                                                     
000990*------------------*                                              
000991                                                                  
000992     MOVE W-PAESOCIE             TO NMFA-PAESOCIE.                
000993     MOVE FR00-NRFATPRO          TO NMFA-NRFATPRO.                
000994     MOVE A901-PAESMERC          TO NMFA-PAEMERCE.                
000995     MOVE C852-CODSOCIE          TO NMFA-CODSOCIE.                
000996     MOVE A901-PAESFATT          TO NMFA-PAEFATTU.                
000997     MOVE A901-CDIVACEE          TO NMFA-CDIVACEE.                
000998     MOVE FR00-CODCLIEN          TO NMFA-CODCLIEN.                
000999     MOVE 'SCBNMFA'     TO PPCALL.                                
001000     CALL  PPCALL     USING      DCPARM                           
001001                                 DCNMFA.                          
001002     IF NMFA-RISPOSTA NOT = '****'                                
001003        MOVE 'SCBNMF'      TO WCOM-FILEFUNZ                       
001004        MOVE 'NORMEFAT '   TO WCOM-FILENOME                       
001005        MOVE NMFA-RISPOSTA TO WCOM-CODABEND                       
001006        STRING NMFA-PAESOCIE NMFA-PAEMERCE NMFA-CODSOCIE          
001007               NMFA-PAEFATTU                                      
001008        DELIMITED BY SIZE INTO WCOM-FILECTRL                      
001009        PERFORM Z00-ERRORE                                        
001010           THRU Z00-EX.                                           
001011                                                                  
001012 E10-EX. EXIT.                                                    
001013                                                                  
001014*------------------*                                              
001015 I00-INSERT-MOVIDCE.                                              
001016*------------------*                                              
001017                                                                  
001018     MOVE 'INSERT'           TO WCOM-FILEFUNZ.                    
001019     MOVE 'MOVIDCE'          TO WCOM-FILENOME.                    
001020     MOVE 'I00-'             TO WCOM-CODABEND.                    
001021     STRING C858-CODCLIEN ' ' C858-CODSOCIE ' ' C858-CDMOVCON     
001022            C858-NRMOVCON                                         
001023            DELIMITED BY SIZE                                     
001024            INTO WCOM-FILECTRL.                                   
001025     IF C858-CODSOCIE = 'SX' OR                                   
001026        C858-CODSOCIE = 'ME'                                      
001027        MOVE 'S' TO C858-FLEXECON.                                
001028                                                                  
001030     
      *EXEC SQL 
      *INSERT INTO DCONTCLI.TMOVIDCE                            
001031*          (CODSOCIE, CODCLIEN,  CDMOVCON, NRMOVCON, DTREGMOV,     
001032*           DTSCADEN, CONTODCE,  IMPARMOV, INDSEGNO, CVLMOVIM,     
001033*           IMPORIVA, PERCEIVA,  ESENTIVA, IMPADIVA, ADDFATTU,     
001034*           CODUTVAR, FLEXECON,  DTULTVAR, OLDSCADE, CVLXXIVA,     
001035*           CVLADIVA)                                              
001036*       VALUES                                                     
001037*         (:C858-CODSOCIE,:C858-CODCLIEN,:C858-CDMOVCON,           
001038*          :C858-NRMOVCON,:C858-DTREGMOV,:C858-DTSCADEN,           
001039*          :C858-CONTODCE,:C858-IMPARMOV,:C858-INDSEGNO,           
001040*          :C858-CVLMOVIM,:C858-IMPORIVA,:C858-PERCEIVA,           
001041*          :C858-ESENTIVA,:C858-IMPADIVA,:C858-ADDFATTU,           
001042*          :C858-CODUTVAR,:C858-FLEXECON,:C858-DTULTVAR,           
001043*          :C858-OLDSCADE,:C858-CVLXXIVA,:C858-CVLADIVA)           
001044*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 4 TO SQL-STMT-ID 
           MOVE 21 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C858-CODSOCIE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C858-CODCLIEN
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C858-CDMOVCON
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C858-NRMOVCON
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C858-DTREGMOV
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C858-DTSCADEN
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C858-CONTODCE
            BY VALUE 0
                     0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C858-IMPARMOV
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C858-INDSEGNO
            BY VALUE 0
                     0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C858-CVLMOVIM
            BY VALUE 0
                     0

           MOVE 523 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C858-IMPORIVA
            BY VALUE 0
                     0

           MOVE 517 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C858-PERCEIVA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C858-ESENTIVA
            BY VALUE 0
                     0

           MOVE 523 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C858-IMPADIVA
            BY VALUE 0
                     0

           MOVE 517 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C858-ADDFATTU
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C858-CODUTVAR
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C858-FLEXECON
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 17 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C858-DTULTVAR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 18 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C858-OLDSCADE
            BY VALUE 0
                     0

           MOVE 523 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 19 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C858-CVLXXIVA
            BY VALUE 0
                     0

           MOVE 523 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 20 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C858-CVLADIVA
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001045                                                                  
001046     IF SQLCODE = 0                                               
001047         MOVE 'MOVIDCE'    TO PPNMFILE                            
001048         MOVE 'D'          TO PPTPFILE                            
001049         MOVE 'A'          TO PPTPOPER                            
001050         MOVE 'U'          TO PPROUTIN                            
001051         PERFORM Z90-READPRIN                                     
001052            THRU Z90-EX                                           
001053     ELSE                                                         
001054         PERFORM Z00-ERRORE                                       
001055            THRU Z00-EX.                                          
001056                                                                  
001057 I00-EX. EXIT.                                                    
001058                                                                  
001059*-------------------*                                             
001060 I05-INSERT-MOVISCAD.                                             
001061*-------------------*                                             
001062                                                                  
001063     MOVE 'INSERT'           TO WCOM-FILEFUNZ.                    
001064     MOVE 'MOVISCA'          TO WCOM-FILENOME.                    
001065     MOVE 'I05-'             TO WCOM-CODABEND.                    
001066     STRING C855-CODCLIEN ' ' C855-CODSOCIE ' ' C855-CDMOVCON     
001067            C855-NRMOVCON ' ' C855-DTSCADEN ' '                   
001068            DELIMITED BY SIZE                                     
001069            INTO WCOM-FILECTRL.                                   
001070     IF C855-CODSOCIE = 'SX' OR                                   
001071        C855-CODSOCIE = 'ME'                                      
001072        MOVE 'S' TO C855-FLEXECON.                                
001073                                                                  
001075     
      *EXEC SQL 
      *INSERT INTO DCONTCLI.TMOVISCAD                           
001076*          (FLAGSTOR,                                              
001077*           CODSOCIE, CODCLIEN, CDMOVCON, NRMOVCON, DTREGMOV,      
001078*           DTSCADEN, TIPOPAGA, DTDECORR, IMPMOVIM,                
001079*           INDSEGNO, CVLMOVIM, IMPORIVA, SCONTDED, PARTCONT,      
001080*           BANCAPPO, DISTICON, BANCACON, AACONTAB, NRCONTAB,      
001081*           NOTENOTE, FLAGSALD, NETTSCON, PLUSSCAD, SIMPROVV,      
001082*           CDSELTIP, CDSELMOV, DTULTVAR, FLEXECON, CODUTVAR,      
001083*           OLDSCADE, IMPROFAT, DATADIST, DTINCASS, FLAGTRAT,      
001084*           TIPOSOLL, CAUSBANC, CODDIVIS, CVLXXIVA, SCADORIG,      
001085*           VALTRASP, CVLTRASP)                                    
001086*       VALUES                                                     
001087*         (:C855-FLAGSTOR,:C855-CODSOCIE,:C855-CODCLIEN,           
001088*          :C855-CDMOVCON,:C855-NRMOVCON,:C855-DTREGMOV,           
001089*          :C855-DTSCADEN,:C855-TIPOPAGA,:C855-DTDECORR,           
001090*          :C855-IMPMOVIM,:C855-INDSEGNO,:C855-CVLMOVIM,           
001091*          :C855-IMPORIVA,:C855-SCONTDED,:C855-PARTCONT,           
001092*          :C855-BANCAPPO,:C855-DISTICON,:C855-BANCACON,           
001093*          :C855-AACONTAB,:C855-NRCONTAB,:C855-NOTENOTE,           
001094*          :C855-FLAGSALD,:C855-NETTSCON,:C855-PLUSSCAD,           
001095*          :C855-SIMPROVV,:C855-CDSELTIP,:C855-CDSELMOV,           
001096*          :C855-DTULTVAR,:C855-FLEXECON,:C855-CODUTVAR,           
001097*          :C855-OLDSCADE,:C855-IMPROFAT,:C855-DATADIST,           
001098*          :C855-DTINCASS,:C855-FLAGTRAT,:C855-TIPOSOLL,           
001099*          :C855-CAUSBANC,:C855-CODDIVIS,:C855-CVLXXIVA,           
001100*          :C855-SCADORIG,                                         
001101*          :C855-VALTRASP, :C855-CVLTRASP)                         
001102*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 5 TO SQL-STMT-ID 
           MOVE 42 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-FLAGSTOR
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-CODSOCIE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-CODCLIEN
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-CDMOVCON
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-NRMOVCON
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-DTREGMOV
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-DTSCADEN
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-TIPOPAGA
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-DTDECORR
            BY VALUE 0
                     0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-IMPMOVIM
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-INDSEGNO
            BY VALUE 0
                     0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-CVLMOVIM
            BY VALUE 0
                     0

           MOVE 523 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-IMPORIVA
            BY VALUE 0
                     0

           MOVE 523 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-SCONTDED
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-PARTCONT
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-BANCAPPO
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-DISTICON
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 17 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-BANCACON
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 18 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-AACONTAB
            BY VALUE 0
                     0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 19 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-NRCONTAB
            BY VALUE 0
                     0

           MOVE 26 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 20 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-NOTENOTE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 21 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-FLAGSALD
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 22 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-NETTSCON
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 23 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-PLUSSCAD
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 24 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-SIMPROVV
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 25 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-CDSELTIP
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 26 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-CDSELMOV
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 27 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-DTULTVAR
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 28 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-FLEXECON
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 29 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-CODUTVAR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 30 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-OLDSCADE
            BY VALUE 0
                     0

           MOVE 523 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 31 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-IMPROFAT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 32 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-DATADIST
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 33 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-DTINCASS
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 34 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-FLAGTRAT
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 35 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-TIPOSOLL
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 36 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-CAUSBANC
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 37 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-CODDIVIS
            BY VALUE 0
                     0

           MOVE 523 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 38 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-CVLXXIVA
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 39 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-SCADORIG
            BY VALUE 0
                     0

           MOVE 523 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 40 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-VALTRASP
            BY VALUE 0
                     0

           MOVE 523 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 41 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C855-CVLTRASP
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 4 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001103                                                                  
001104     IF SQLCODE = 0                                               
001105         MOVE 'MOVISCA'    TO PPNMFILE                            
001106         MOVE 'D'          TO PPTPFILE                            
001107         MOVE 'A'          TO PPTPOPER                            
001108         MOVE 'U'          TO PPROUTIN                            
001109         PERFORM Z90-READPRIN                                     
001110            THRU Z90-EX                                           
001111     ELSE                                                         
001112         PERFORM Z00-ERRORE                                       
001113            THRU Z00-EX.                                          
001114                                                                  
001115 I05-EX. EXIT.                                                    
001116                                                                  
001117*----------------------------------------------------------------*
001118 I10-INSERT-MOVIMENTI.                                            
001119*----------------------------------------------------------------*
001120                                                                  
001121     MOVE 'I10-'                 TO WCOM-CODABEND.                
001122     MOVE 'INSERT'               TO WCOM-FILEFUNZ.                
001123     MOVE 'MOVIMEN'              TO WCOM-FILENOME.                
001124     MOVE SPACES                 TO WCOM-FILECTRL.                
001125     STRING C852-CODCLIEN ' ' C852-CODSOCIE ' '                   
001126            C852-CDMOVCON ' ' C852-NRMOVCON                       
001127            DELIMITED BY SIZE  INTO WCOM-FILECTRL.                
001128     IF C852-CODSOCIE = 'SX' OR                                   
001129        C852-CODSOCIE = 'ME'                                      
001130        MOVE 'S' TO C852-FLEXECON.                                
001131                                                                  
001132     
      *EXEC SQL INSERT                                              
001133*                INTO DCONTCLI.TMOVIMENTI                          
001134*                    (CODSOCIE, CODCLIEN, CDMOVCON                 
001135*                    ,NRMOVCON, DTREGMOV, DATAVALU                 
001136*                    ,CENCOSTO, ITAESTER, CODAGENT                 
001137*                    ,FLPROVPA, CAUSACON, NRMOVRIF                 
001138*                    ,FLGRATEO, FLEXECON, CODUTVAR                 
001139*                    ,BANDIVAL, NRDICVAL, DTULTVAR                 
001140*                    ,NRMOVRI2, IMPROFAT, FLGSTORN                 
001141*                    ,DTCONTAB, TIPOMOVI, VOCEDOPR                 
001142*                    ,IMPDOGPR, SLTIPLIN, CODUTCRE                 
001143*                    ,FLAGASSI, CLIEMERC, DATESIVA                 
001144*                    ,UFFICIVA, NUMESIVA, CDMOVRIF                 
001145*                    ,DATAMRIF, CONDXASS)                          
001146*              VALUES                                              
001147*                    (:C852-CODSOCIE,:C852-CODCLIEN,:C852-CDMOVCON 
001148*                    ,:C852-NRMOVCON,:C852-DTREGMOV,:C852-DATAVALU 
001149*                    ,:C852-CENCOSTO,:C852-ITAESTER,:C852-CODAGENT 
001150*                    ,:C852-FLPROVPA,:C852-CAUSACON,:C852-NRMOVRIF 
001151*                    ,:C852-FLGRATEO,:C852-FLEXECON,:C852-CODUTVAR 
001152*                    ,:C852-BANDIVAL,:C852-NRDICVAL,:C852-DTULTVAR 
001153*                    ,:C852-NRMOVRI2,:C852-IMPROFAT,:C852-FLGSTORN 
001154*                    ,:C852-DTCONTAB,:C852-TIPOMOVI,:C852-VOCEDOPR 
001155*                    ,:C852-IMPDOGPR,:C852-SLTIPLIN,:C852-CODUTCRE 
001156*                    ,:C852-FLAGASSI,:C852-CLIEMERC,:C852-DATESIVA 
001157*                    ,:C852-UFFICIVA,:C852-NUMESIVA,:C852-CDMOVRIF 
001158*                    ,:C852-DATAMRIF,:C852-CONDXASS)               
001159*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 6 TO SQL-STMT-ID 
           MOVE 35 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-CODSOCIE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-CODCLIEN
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-CDMOVCON
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-NRMOVCON
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-DTREGMOV
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-DATAVALU
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-CENCOSTO
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-ITAESTER
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-CODAGENT
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-FLPROVPA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-CAUSACON
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-NRMOVRIF
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-FLGRATEO
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-FLEXECON
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-CODUTVAR
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-BANDIVAL
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-NRDICVAL
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 17 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 18 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-NRMOVRI2
            BY VALUE 0
                     0

           MOVE 523 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 19 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-IMPROFAT
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 20 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-FLGSTORN
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 21 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-DTCONTAB
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 22 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-TIPOMOVI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 23 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-VOCEDOPR
            BY VALUE 0
                     0

           MOVE 523 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 24 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-IMPDOGPR
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 25 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-SLTIPLIN
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 26 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-CODUTCRE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 27 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-FLAGASSI
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 28 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-CLIEMERC
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 29 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-DATESIVA
            BY VALUE 0
                     0

           MOVE 18 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 30 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-UFFICIVA
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 31 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-NUMESIVA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 32 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-CDMOVRIF
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 33 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-DATAMRIF
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 34 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C852-CONDXASS
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 5 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001160     IF SQLCODE EQUAL ZEROS                                       
001161         MOVE 'U'                TO PPROUTIN                      
001162         MOVE 'D'                TO PPTPFILE                      
001163         MOVE 'A'                TO PPTPOPER                      
001164         MOVE 'MOVIMEN'          TO PPNMFILE                      
001165         PERFORM Z90-READPRIN                                     
001166            THRU Z90-EX                                           
001167     ELSE                                                         
001168         PERFORM Z00-ERRORE                                       
001169            THRU Z00-EX.                                          
001170                                                                  
001171 I10-EX. EXIT.                                                    
001172*--------------------*                                            
001173 I15-INSERT-MOVINOTE.                                             
001174*--------------------*                                            
001175                                                                  
001176     MOVE 'I15-'                 TO WCOM-CODABEND.                
001177     MOVE 'INSERT'               TO WCOM-FILEFUNZ.                
001178     MOVE 'MOVINOTE'             TO WCOM-FILENOME.                
001179     MOVE SPACES                 TO WCOM-FILECTRL.                
001180     STRING C857-CODSOCIE ' ' C857-CODCLIEN ' ' C857-NRMOVCON ' ' 
001181            C857-DTREGMOV ' ' C857-CDMOVCON ' ' W-NUMPROG3        
001182            DELIMITED BY SIZE  INTO WCOM-FILECTRL.                
001183                                                                  
001185     
      *EXEC SQL 
      *INSERT INTO DCONTCLI.TMOVINOTE                           
001186*          (CODSOCIE,CDMOVCON,NRMOVCON,NOTESTA1,NOTESTA2,          
001187*           NOTESTA3,IMPCALIN,TASSINTE,NUMGGINT,IMPSPESE,          
001188*           DTCREAZI,NOTESTA4,NOTESTA5,CONTODCE,CENCOSTO,          
001189*           FLAGINTR,NUMPROG3,DTREGMOV,CODCLIEN)                   
001190*       VALUES                                                     
001191*         (:C857-CODSOCIE,:C857-CDMOVCON,:C857-NRMOVCON,           
001192*          :C857-NOTESTA1,:C857-NOTESTA2,:C857-NOTESTA3,           
001193*          :C857-IMPCALIN,:C857-TASSINTE,:C857-NUMGGINT,           
001194*          :C857-IMPSPESE,:C857-DTCREAZI,:C857-NOTESTA4,           
001195*          :C857-NOTESTA5,:C857-CONTODCE,:C857-CENCOSTO,           
001196*          :C857-FLAGINTR,:C857-NUMPROG3,:C857-DTREGMOV,           
001197*          :C857-CODCLIEN)                                         
001198*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 7 TO SQL-STMT-ID 
           MOVE 19 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C857-CODSOCIE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C857-CDMOVCON
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C857-NRMOVCON
            BY VALUE 0
                     0

           MOVE 60 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C857-NOTESTA1
            BY VALUE 0
                     0

           MOVE 60 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C857-NOTESTA2
            BY VALUE 0
                     0

           MOVE 60 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C857-NOTESTA3
            BY VALUE 0
                     0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C857-IMPCALIN
            BY VALUE 0
                     0

           MOVE 517 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C857-TASSINTE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C857-NUMGGINT
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C857-IMPSPESE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C857-DTCREAZI
            BY VALUE 0
                     0

           MOVE 60 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C857-NOTESTA4
            BY VALUE 0
                     0

           MOVE 60 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C857-NOTESTA5
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C857-CONTODCE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C857-CENCOSTO
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C857-FLAGINTR
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C857-NUMPROG3
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 17 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C857-DTREGMOV
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 18 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C857-CODCLIEN
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 6 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001199                                                                  
001200     IF SQLCODE = 0                                               
001201         MOVE 'MOVINOT'    TO PPNMFILE                            
001202         MOVE 'D'          TO PPTPFILE                            
001203         MOVE 'A'          TO PPTPOPER                            
001204         MOVE 'U'          TO PPROUTIN                            
001205         PERFORM Z90-READPRIN                                     
001206            THRU Z90-EX                                           
001207     ELSE                                                         
001208         PERFORM Z00-ERRORE                                       
001209            THRU Z00-EX.                                          
001210                                                                  
001211 I15-EX. EXIT.                                                    
001212                                                                  
001213*----------------------------------------------------------------*
001214 L00-LETTURA-FILEINP.                                             
001215*----------------------------------------------------------------*
001216                                                                  
001217     READ FILEINP INTO FSINFR00                                   
001218          AT END MOVE 'SI' TO EOF.                                
001219                                                                  
001220     IF EOF NOT = 'SI'                                            
001221        MOVE 'U'                 TO PPROUTIN                      
001222        MOVE 'S'                 TO PPTPFILE                      
001223        MOVE 'R'                 TO PPTPOPER                      
001224        MOVE 'FILEINP'           TO PPNMFILE                      
001225        PERFORM Z90-READPRIN                                      
001226           THRU Z90-EX                                            
001227        IF FR00-CODUTVAR NOT GREATER SPACES                       
001228           MOVE 'AAAM10'         TO FR00-CODUTVAR.                
001229                                                                  
001230 L00-EX. EXIT.                                                    
001231                                                                  
001232*-------------------*                                             
001233 L05-LEGGI-SOCIETA.                                               
001234*-------------------*                                             
001235                                                                  
001236     MOVE 'L05-'                 TO WCOM-CODABEND.                
001237     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001238     MOVE 'SOCIETA'              TO WCOM-FILENOME.                
001239     MOVE  A531-CODSOCIE         TO WCOM-FILECTRL.                
001240                                                                  
001242     
      *EXEC SQL 
      *SELECT S.FLFATACQ, S.CODPAESE, D.DECIDIVI,              
001243*                 D.CODDIVIS                                       
001244*            INTO :A531-FLFATACQ, :A531-CODPAESE, :W-DECIDISO,     
001245*                 :W-CODDIVSO                                      
001246*            FROM DANAGRAF.TSOCIETA S,                             
001247*                 DANAGRAF.TDIVISE  D                              
001248*           WHERE S.CODSOCIE = :A531-CODSOCIE                      
001249*             AND S.CODDIVRI = D.CODDIVRI                          
001250*             AND S.CODDIVIS = D.CODDIVIS                          
001251*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 8 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 9 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-FLFATACQ
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODPAESE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE W-DECIDISO
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE W-CODDIVSO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 7 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001252                                                                  
001253     IF SQLCODE NOT = +0                                          
001254        PERFORM Z00-ERRORE                                        
001255           THRU Z00-EX.                                           
001256                                                                  
001257     MOVE 'SOCIETA'    TO PPNMFILE.                               
001258     MOVE 'D'          TO PPTPFILE.                               
001259     MOVE 'R'          TO PPTPOPER.                               
001260     MOVE 'U'          TO PPROUTIN.                               
001261     PERFORM Z90-READPRIN                                         
001262        THRU Z90-EX.                                              
001263                                                                  
001264 L05-EX. EXIT.                                                    
001265                                                                  
001266*-----------------*                                               
001267 L10-LEGGI-DIVMOVI.                                               
001268*-----------------*                                               
001269                                                                  
001270     MOVE 'L10-'                 TO WCOM-CODABEND.                
001271     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001272     MOVE 'DIVMOVI'              TO WCOM-FILENOME.                
001273     STRING A531-CODSOCIE ' ' W-CODDIVIS                          
001274            DELIMITED BY SIZE INTO WCOM-FILECTRL.                 
001275                                                                  
001277     
      *EXEC SQL 
      *SELECT D.DECIDIVI                                       
001278*            INTO :W-DECIDIVI                                      
001279*            FROM DANAGRAF.TSOCIETA S,                             
001280*                 DANAGRAF.TDIVISE  D                              
001281*           WHERE S.CODSOCIE = :A531-CODSOCIE                      
001282*             AND S.CODDIVRI = D.CODDIVRI                          
001283*             AND D.CODDIVIS = :W-CODDIVIS                         
001284*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 10 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE W-CODDIVIS
            BY VALUE 0
                     0

           MOVE 11 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE W-DECIDIVI
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 8 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001285                                                                  
001286     IF SQLCODE NOT = +0                                          
001287        PERFORM Z00-ERRORE                                        
001288           THRU Z00-EX.                                           
001289                                                                  
001290     MOVE 'DIVMOVI'    TO PPNMFILE.                               
001291     MOVE 'D'          TO PPTPFILE.                               
001292     MOVE 'R'          TO PPTPOPER.                               
001293     MOVE 'U'          TO PPROUTIN.                               
001294     PERFORM Z90-READPRIN                                         
001295        THRU Z90-EX.                                              
001296                                                                  
001297 L10-EX. EXIT.                                                    
001298                                                                  
001299*-----------------*                                               
001300 L15-LEGGI-CLIENTE.                                               
001301*-----------------*                                               
001302                                                                  
001303     MOVE 'L15-' TO WCOM-CODABEND.                                
001304     MOVE 'SELECT' TO WCOM-FILEFUNZ.                              
001305     MOVE 'CLIENTI' TO WCOM-FILENOME.                             
001306     MOVE A901-CODCLIEN TO WCOM-FILECTRL.                         
001307                                                                  
001309     
      *EXEC SQL 
      *SELECT GENECLIE,TIPOCONS,CLIFOCON,                      
001310*                 CLIEFATT,PAESFATT,PAESMERC,                      
001311*                 ESENTIVA,NUMESIVA,CDIVACEE,                      
001312*                 CENCOACQ                                         
001313*            INTO :A901-GENECLIE,:A901-TIPOCONS,:A901-CLIFOCON,    
001314*                 :A901-CLIEFATT,:A901-PAESFATT,:A901-PAESMERC,    
001315*                 :A901-ESENTIVA,:A901-NUMESIVA,:A901-CDIVACEE,    
001316*                 :A901-CENCOACQ                                   
001317*            FROM DANAGRAF.TCLIENTI                                
001318*           WHERE CODCLIEN = :A901-CODCLIEN                        
001319*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 12 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODCLIEN
            BY VALUE 0
                     0

           MOVE 13 TO SQL-STMT-ID 
           MOVE 10 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-GENECLIE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-TIPOCONS
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CLIFOCON
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CLIEFATT
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-PAESFATT
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-PAESMERC
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-ESENTIVA
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-NUMESIVA
            BY VALUE 0
                     0

           MOVE 14 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CDIVACEE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CENCOACQ
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 9 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001320                                                                  
001321     IF SQLCODE NOT = +0                                          
001322        PERFORM Z00-ERRORE                                        
001323           THRU Z00-EX.                                           
001324                                                                  
001325     MOVE 'CLIENTI'    TO PPNMFILE.                               
001326     MOVE 'D'          TO PPTPFILE.                               
001327     MOVE 'R'          TO PPTPOPER.                               
001328     MOVE 'U'          TO PPROUTIN.                               
001329     PERFORM Z90-READPRIN                                         
001330        THRU Z90-EX.                                              
001331                                                                  
001332 L15-EX. EXIT.                                                    
001333                                                                  
001334*----------------------------------------------------------------*
001335 L16-SELECT-CONTIDCE.                                             
001336*----------------------------------------------------------------*
001337                                                                  
001338     MOVE 'L16-' TO WCOM-CODABEND.                                
001339     MOVE 'SELECT' TO WCOM-FILEFUNZ.                              
001340     MOVE 'CONTDCE' TO WCOM-FILENOME.                             
001341     STRING C861-CONTODCE ' ' A531-CODSOCIE                       
001342            DELIMITED BY SIZE INTO WCOM-FILECTRL.                 
001343                                                                  
001345     
      *EXEC SQL 
      *SELECT C.INDBILQU,C.CONTPROV                            
001346*            INTO :C861-INDBILQU,:C861-CONTPROV                    
001347*            FROM DANAGRAF.TSOCIETA  S,                            
001348*                 DCONTCLI.TCONTIDCE C                             
001349*           WHERE S.CODSOCIE = :A531-CODSOCIE                      
001350*             AND S.CODPIANO = C.CODPIANO                          
001351*             AND C.CONTODCE = :C861-CONTODCE                      
001352*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 14 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTODCE
            BY VALUE 0
                     0

           MOVE 15 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-INDBILQU
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTPROV
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 10 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001353                                                                  
001354     IF SQLCODE NOT = +0                                          
001355        PERFORM Z00-ERRORE                                        
001356           THRU Z00-EX.                                           
001357                                                                  
001358     MOVE 'CONTDCE'    TO PPNMFILE.                               
001359     MOVE 'D'          TO PPTPFILE.                               
001360     MOVE 'R'          TO PPTPOPER.                               
001361     MOVE 'U'          TO PPROUTIN.                               
001362     PERFORM Z90-READPRIN                                         
001363        THRU Z90-EX.                                              
001364                                                                  
001365 L16-EX. EXIT.                                                    
001366                                                                  
001367*----------------------------------------------------------------*
001368 L20-SELECT-VBVENCON.                                             
001369*----------------------------------------------------------------*
001370                                                                  
001371     MOVE 'L20-'                 TO WCOM-CODABEND.                
001372     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001373     MOVE 'VBVENCON'             TO WCOM-FILENOME.                
001374     MOVE SPACES                 TO WCOM-FILECTRL.                
001375     STRING AC60-SOCIEVEN ' ' AC60-CLIFOCON                       
001376          DELIMITED BY SIZE    INTO WCOM-FILECTRL.                
001377                                                                  
001378     
      *EXEC SQL SELECT CONTODCE                                     
001379*                    ,CENCOSTO                                     
001380*                INTO :AC60-CONTODCE                               
001381*                    ,:AC60-CENCOSTO                               
001382*                FROM DANAGRAF.VANAGRAF_C60                        
001383*               WHERE SOCIEVEN = :AC60-SOCIEVEN                    
001384*                 AND CLIFOCON = :AC60-CLIFOCON                    
001385*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 16 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE AC60-SOCIEVEN
            BY VALUE 0
                     0

           MOVE 20 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE AC60-CLIFOCON
            BY VALUE 0
                     0

           MOVE 17 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 781 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE AC60-CONTODCE
            BY VALUE 0
                     0

           MOVE 20 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE AC60-CENCOSTO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 11 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001386     IF SQLCODE = +0                                              
001387        MOVE 'S'          TO A531-FLFATACQ                        
001388        MOVE 'VBVENCON'   TO PPNMFILE                             
001389        MOVE 'D'          TO PPTPFILE                             
001390        MOVE 'R'          TO PPTPOPER                             
001391        MOVE 'U'          TO PPROUTIN                             
001392        PERFORM Z90-READPRIN                                      
001393           THRU Z90-EX                                            
001394        IF A901-CENCOACQ > SPACES                                 
001395           MOVE A901-CENCOACQ    TO AC60-CENCOSTO                 
001396        END-IF                                                    
001397     ELSE                                                         
001398        IF SQLCODE = +100                                         
001399           MOVE 'N'          TO A531-FLFATACQ                     
001400        ELSE                                                      
001401           PERFORM Z00-ERRORE                                     
001402              THRU Z00-EX.                                        
001403                                                                  
001404 L20-EX.                                                          
001405     EXIT.                                                        
001406*----------------------------------------------------------------*
001407 L25-SELECT-FORNITORI.                                            
001408*----------------------------------------------------------------*
001409                                                                  
001410     MOVE 'L25-'                 TO WCOM-CODABEND.                
001411     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001412     MOVE 'FORNITO'              TO WCOM-FILENOME.                
001413     MOVE A972-CODFORNI          TO WCOM-FILECTRL.                
001414                                                                  
001415     
      *EXEC SQL SELECT CODPAESE                                     
001416*                INTO :A972-CODPAESE                               
001417*                FROM DANAGRAF.TFORNITORI                          
001418*               WHERE CODFORNI = :A972-CODFORNI                    
001419*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 18 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A972-CODFORNI
            BY VALUE 0
                     0

           MOVE 19 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A972-CODPAESE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 12 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001420     IF SQLCODE NOT = +0                                          
001421        PERFORM Z00-ERRORE                                        
001422           THRU Z00-EX.                                           
001423                                                                  
001424     MOVE 'U'                    TO PPROUTIN                      
001425     MOVE 'D'                    TO PPTPFILE                      
001426     MOVE 'R'                    TO PPTPOPER                      
001427     MOVE 'FORNITO'              TO PPNMFILE                      
001428     PERFORM Z90-READPRIN                                         
001429        THRU Z90-EX.                                              
001430                                                                  
001431 L25-EX.                                                          
001432     EXIT.                                                        
001433*----------------------------------------------------------------*
001434 L30-SELECT-ASSIMIN.                                              
001435*----------------------------------------------------------------*
001436                                                                  
001437     MOVE 'L30-'                 TO WCOM-CODABEND.                
001438     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001439     MOVE 'ASSIMIN'              TO WCOM-FILENOME.                
001440     MOVE AB53-CODSOCIE          TO WCOM-FILECTRL.                
001441                                                                  
001442     
      *EXEC SQL SELECT IMPFATTU                                     
001443*                INTO :AB53-IMPFATTU                               
001444*                FROM DANAGRAF.VANAGRAF_B53                        
001445*               WHERE CODSOCIE = :AB53-CODSOCIE                    
001446*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 20 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE AB53-CODSOCIE
            BY VALUE 0
                     0

           MOVE 21 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 781 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE AB53-IMPFATTU
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 13 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001447     IF SQLCODE NOT EQUAL ZEROS AND +100                          
001448        PERFORM Z00-ERRORE                                        
001449           THRU Z00-EX.                                           
001450                                                                  
001451     IF SQLCODE EQUAL ZEROS                                       
001452        MOVE 'ASSIMIN'           TO PPNMFILE                      
001453        MOVE 'D'                 TO PPTPFILE                      
001454        MOVE 'R'                 TO PPTPOPER                      
001455        MOVE 'U'                 TO PPROUTIN                      
001456        PERFORM Z90-READPRIN                                      
001457           THRU Z90-EX.                                           
001458                                                                  
001459 L30-EX.                                                          
001460     EXIT.                                                        
001461*----------------------------------------------------------------*
001462 Z00-ERRORE.                                                      
001463*----------------------------------------------------------------*
001464                                                                  
001465     MOVE 'SCDB2ER'              TO PPCALL.                       
001466     CALL PPCALL USING DCPARM DCDB2ER SQLCA.                      
001467                                                                  
001468 Z00-EX. EXIT.                                                    
001469*----------------------------------------------------------------*
001470 Z90-READPRIN.                                                    
001471*----------------------------------------------------------------*
001472                                                                  
001473     MOVE 'READPRIN '            TO PPCALL.                       
001474     CALL PPCALL USING DCPARM.                                    
001475                                                                  
001476 Z90-EX. EXIT.                                                    
