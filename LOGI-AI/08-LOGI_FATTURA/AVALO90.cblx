      *((program: AVALO90.cblx))
000001*---------------* PROGRAMMA BATCH DB2 COBOL2 *-------------------*
000002 ID DIVISION.                                                     
000003*---------------*                                                 
000004 PROGRAM-ID. AVALO90.                  
000005                                                                  
000006******************************************************************
000007**                                                              **
000008**    ESTRAZIONE ORDINI DA FATTURARE. CREA LA FATTURA, IL       **
000009**    PACKING LIST E IL FILE PER LA CONTABILITA'                **
000010**                                                              **
000011******************************************************************
000012                                                                  
000013 ENVIRONMENT DIVISION.                                            
000014*---------------------*                                           
000015 CONFIGURATION SECTION.                                           
000016 SPECIAL-NAMES.                                                   
000017     DECIMAL-POINT IS COMMA.                                      
000018                                                                  
000019 INPUT-OUTPUT SECTION.                                            
000020 FILE-CONTROL.                                                    
000021     SELECT INPCONT ASSIGN TO UT-S-INPCONT.                       
000022     SELECT OUTFATT ASSIGN TO UT-S-OUTFATT.                       
000023     SELECT OUTCON2 ASSIGN TO UT-S-OUTCON2.                       
000024                                                                  
000025 DATA DIVISION.                                                   
000026 FILE SECTION.                                                    
000027                                                                  
000028 FD  INPCONT                                                      
000029     RECORDING MODE IS F                                          
000030     BLOCK 0 RECORDS.                                             
000031 01  REC-INPCONT                  PIC X(550).                     
000032                                                                  
000033 FD  OUTFATT                                                      
000034     RECORDING MODE IS F                                          
000035     BLOCK 0 RECORDS.                                             
000036 01  REC-OUTFATT                  PIC X(50).                      
000037                                                                  
000038 FD  OUTCON2                                                      
000039     RECORDING MODE IS F                                          
000040     BLOCK 0 RECORDS.                                             
000041 01  REC-OUTCON2                  PIC X(50).                      
000042                                                                  
000043 WORKING-STORAGE SECTION.

       01  SQLDA-ID pic 9(4) comp-5.
       01  SQLDSIZE pic 9(4) comp-5.
       01  SQL-STMT-ID pic 9(4) comp-5.
       01  SQLVAR-INDEX pic 9(4) comp-5.
       01  SQL-DATA-TYPE pic 9(4) comp-5.
       01  SQL-HOST-VAR-LENGTH pic 9(9) comp-5.
       01  SQL-S-HOST-VAR-LENGTH pic 9(9) comp-5.
       01  SQL-S-LITERAL pic X(258).
       01  SQL-LITERAL1 pic X(130).
       01  SQL-LITERAL2 pic X(130).
       01  SQL-LITERAL3 pic X(130).
       01  SQL-LITERAL4 pic X(130).
       01  SQL-LITERAL5 pic X(130).
       01  SQL-LITERAL6 pic X(130).
       01  SQL-LITERAL7 pic X(130).
       01  SQL-LITERAL8 pic X(130).
       01  SQL-LITERAL9 pic X(130).
       01  SQL-LITERAL10 pic X(130).
       01  SQL-IS-LITERAL pic 9(4) comp-5 value 1.
       01  SQL-IS-INPUT-HVAR pic 9(4) comp-5 value 2.
       01  SQL-CALL-TYPE pic 9(4) comp-5.
       01  SQL-SECTIONUMBER pic 9(4) comp-5.
       01  SQL-INPUT-SQLDA-ID pic 9(4) comp-5.
       01  SQL-OUTPUT-SQLDA-ID pic 9(4) comp-5.
       01  SQLA-PROGRAM-ID.
           05 SQL-PART1 pic 9(4) COMP-5 value 172.
           05 SQL-PART2 pic X(6) value "AEAQAI".
           05 SQL-PART3 pic X(24) value "tA1TLaGo01111 2         ".
           05 SQL-PART4 pic 9(4) COMP-5 value 8.
           05 SQL-PART5 pic X(8) value "DB2XMT  ".
           05 SQL-PART6 pic X(120) value LOW-VALUES.
           05 SQL-PART7 pic 9(4) COMP-5 value 8.
           05 SQL-PART8 pic X(8) value "AVALO90 ".
           05 SQL-PART9 pic X(120) value LOW-VALUES.
                                                                        
000044 01  FILLER                       PIC X(08) VALUE 'DCPARM**'.     
000045*    COPY DCPARM.                                                 
      *>>((file: DCPARM))
000001***************************************************************** 
000002*******                                                         * 
000003*******       A R E A   P A R A M E T R I C A       *COBOL*     * 
000004*******                                                         * 
000005***************************************************************** 
000006 01  DCPARM.                                                      
000007*******  PPNAME   = NOME PROGRAMMA                                
000008     02  PPNAME           PIC X(8)    VALUE SPACES.               
000009*******  PPROUTIN = ROUTINE DA ESEGUIRE                           
000010     02  PPROUTIN         PIC X       VALUE SPACES.               
000011     02  PPSTAT           PIC X(4)    VALUE SPACES.               
000012*******  PPNUSK   = NUMERO DI SCHEDE X LA FUNZIONE -N-            
000013     02  PPNUSK           PIC X(2)    VALUE SPACES.               
000014     02  PPFIRST          PIC X       VALUE SPACES.               
000015*******                                                           
000016*********************** SKEDE PARAMETRO - MAX 10 **************** 
000017*******                                                           
000018     02  SK-PARM.                                                 
000019         05  PPSK1            PIC X(80)   VALUE SPACES.           
000020         05  PPSK2            PIC X(80)   VALUE SPACES.           
000021         05  PPSK3            PIC X(80)   VALUE SPACES.           
000022         05  PPSK4            PIC X(80)   VALUE SPACES.           
000023         05  PPSK5            PIC X(80)   VALUE SPACES.           
000024         05  PPSK6            PIC X(80)   VALUE SPACES.           
000025         05  PPSK7            PIC X(80)   VALUE SPACES.           
000026         05  PPSK8            PIC X(80)   VALUE SPACES.           
000027         05  PPSK9            PIC X(80)   VALUE SPACES.           
000028         05  PPSK10           PIC X(80)   VALUE SPACES.           
000029         05  PPSK11           PIC X(80)   VALUE SPACES.           
000030     02  TAB-SK-PARM REDEFINES SK-PARM.                           
000031         05  EL-SK-PARM OCCURS 11 TIMES.                          
000032             10  NAME-SK-PARM     PIC XX.                         
000033             10  FILLER           PIC X.                          
000034             10  DATA-SK-PARM     PIC X(77).                      
000035*******                                                           
000036*********************** ELEMENTO DI RICERCA ********************* 
000037*******                                                           
000038*******  PPNMFILE  = NOME FILE                                    
000039     02  PPNMFILE         PIC X(7)    VALUE SPACES.               
000040*******  PPTPFILE  = TIPO FILE                                    
000041     02  PPTPFILE         PIC X(1)    VALUE SPACES.               
000042*******  PPTPOPER  = TIPO OPERAZIONE                              
000043     02  PPTPOPER         PIC X(1)    VALUE SPACES.               
000044     02  FILLER           PIC X(7)    VALUE SPACES.               
000045*******                                                           
000046*********************** TABELLA DI 30 ELEMENTI ****************** 
000047*******                                                           
000048     02  TAB-CONTATORI.                                           
000049         05  EL-CONTATORI OCCURS 30 TIMES.                        
000050             10  EL-PPNMFILE      PIC X(7)        VALUE SPACES.   
000051             10  EL-PPTPFILE      PIC X           VALUE SPACES.   
000052             10  EL-PPTPOPER      PIC X           VALUE SPACES.   
000053             10  EL-CONTATOR      PIC 9(9) COMP-3 VALUE ZEROES.   
000054             10  EL-FILLER        PIC XX          VALUE SPACES.   
000055*    02  FILLER           PIC X(7)     VALUE SPACES.              
000056*******              TIPO FILE                                    
000057*    02  FILLER           PIC X(1)     VALUE SPACES.              
000058*******              TIPO OPERAZIONE                              
000059*    02  FILLER           PIC X(1)     VALUE SPACES.              
000060*******              NUMERO OPERAZIONI                            
000061*    02  FILLER           PIC 9(9)     COMP-3    VALUE ZERO.      
000062*    02  FILLER           PIC X(2)     VALUE SPACES.              
000063*******  29 CAMPI DA 16 BYTES, IN TOTALE 464 BYTES                
000064*    02  FILLER           PIC X(464)   VALUE SPACES.              
000065*******                                                           
000066*********************** STAMPA MESSAGGI ************************* 
000067*******                                                           
000068*******  PPMESSAG  = MESSAGGIO DA STAMPARE                        
000069     02  PPMESSAG         PIC X(132)  VALUE SPACES.               
000070     02  FILLER           PIC X(4)    VALUE SPACES.               
000071*******                                                           
000072*********************** DATE DA TABE TABPRODA ******************* 
000073*******                                                           
000074*******  DATA-PROG = NOME ELEMENTO DI TABE TABPRODA               
000075     02  DATA-PROG        PIC X(7)    VALUE SPACES.               
000076*******  DATA-TIPO = TIPO DI DATA  DI TABE TABPRODA               
000077     02  DATA-TIPO        PIC X       VALUE SPACES.               
000078*******  DATA-INIZ = DATA INIZIO PERIODO                          
000079     02  DATA-INIZ.                                               
000080         05  GG-INIZ.                                             
000081             10  SS-CORSO PIC XX      VALUE SPACES.               
000082         05  MM-INIZ      PIC XX      VALUE SPACES.               
000083         05  AA-INIZ      PIC XX      VALUE SPACES.               
000084*******  DATA-FINE = DATA FINE PERIODO                            
000085     02  DATA-FINE.                                               
000086         05  GG-FINE      PIC XX      VALUE SPACES.               
000087         05  MM-FINE      PIC XX      VALUE SPACES.               
000088         05  AA-FINE      PIC XX      VALUE SPACES.               
000089     02  FILLER           PIC X(4)    VALUE SPACES.               
000090*******                                                           
000091*********************** CALL GENERALIZZATA ********************** 
000092*******                                                           
000093*******  PPCALL    = NOME MODULO X CALLER                         
000094     02  PPCALL           PIC X(8)    VALUE SPACES.               
000095*******                                                           
000096***************************************************************** 
000097*  EJECT                                                          
      *<<((file: DCPARM))
000046 01  FILLER                       PIC X(08) VALUE 'DCDB2ER*'.     
000047*    COPY DCDB2ER.                                                
      *>>((file: DCDB2ER))
000001******************************************************************
000002*****               AREA PER MODULO SCDB2ER                  *****
000003******************************************************************
000004 01  DCDB2ER.                                                     
000005     02 WCOM-LUNGHEZZ         PIC S9(3) COMP-3 VALUE +171.        
000006     02 WCOM-FILEFUNZ         PIC X(10).                          
000007     02 WCOM-FILENOME         PIC X(30).                          
000008     02 WCOM-FILECTRL         PIC X(30).                          
000009     02 WCOM-MESSAGES         PIC X(80).                          
000010     02 WCOM-CODABEND         PIC X(4).                           
000011     02 MESS-CODERROR         PIC X(6).                           
000012     02 WSWERROR              PIC X.                              
000013        88 ERRORE             VALUE '*'.                          
000014     02 WCOM-PROGNAME         PIC X(8).                           
      *<<((file: DCDB2ER))
000048 01  FILLER                       PIC X(08) VALUE 'DCWDTEL*'.     
000049*    COPY DCWDTEL.                                                
      *>>((file: DCWDTEL))
000001***************************************************************** 
000002******         AREA PASSAGGIO CHIAMATA                     ****** 
000003******             MODULO  SCTDTEL (LENGTH 100)            ****** 
000004***************************************************************** 
000005 01  DCWDTEL.                                                     
000006*                         ZEROES SE OK  ALTRIMENTI SQLCODE        
000007     05 DTEL-RETCOD              PIC S9(3).                       
000008*                         R = LETTURA   U = AGGIORNAMENTO         
000009     05 DTEL-TIPORICH            PIC X.                           
000010     05 DTEL-SIGLDATA            PIC X(8).                        
000011*         G=AAAAAAA   S=SETTIMA   M=MENSILE   A=ANNUALE   W=WEEK  
000012     05 DTEL-DATATIPO            PIC X(1).                        
000013*                                                                 
000014     05 DTEL-DTINELAB            PIC X(8).                        
000015     05 DTEL-TMINELAB            PIC X(6).                        
000016     05 DTEL-DTFIELAB            PIC X(8).                        
000017     05 DTEL-TMFIELAB            PIC X(6).                        
000018     05 FILLER                   PIC X(59).                       
      *<<((file: DCWDTEL))
000050 01  FILLER                       PIC X(08) VALUE 'FSINFR00'.     
000051*    COPY FSINFR00.                                               
      *>>((file: FSINFR00))
000001******************************************************************
000002*                                                                *
000003*                         -- FSINFR00 --                         *
000004*                                                                *
000005*  DSECT RELATIVA AL FILE SEQUENZIALE CONTENENTE I DATI          *
000006*  CHE SERVONO PER IL CALCOLO DELLE REGISTRAZIONI CONTABILI      *
000007*  DA ESEGUIRE A FRONTE DI FATTURE E RESI EMESSI NEL GIORNO.     *
000008*                                                                *
000009*                   -- LUNGHEZZA  550 BYTES --                   *
000010*                                                                *
000011******************************************************************
000012 01  FSINFR00.                                                    
000013     05 FR00-CODSOCIE            PIC X(02).                       
000014     05 FR00-CODCLIEN            PIC X(05).                       
000015     05 FR00-CDMOVCON            PIC X(01).                       
000016     05 FR00-NRMOVCON            PIC X(06).                       
000017     05 FR00-DTREGMOV            PIC X(08).                       
000018     05 FR00-DTDECORR            PIC X(08).                       
000019     05 FR00-CAUSACON            PIC X(01).                       
000020     05 FR00-TIPOPAGA            PIC X(01).                       
000021     05 FR00-CONDPAGA            PIC X(03).                       
000022     05 FR00-CODDIVIS            PIC X(02).                       
000023     05 FR00-CODAGENT            PIC X(02).                       
000024     05 FR00-CDSELMOV            PIC X(01).                       
000025     05 FR00-CDSELTIP            PIC X(01).                       
000026     05 FR00-INDSEGNO            PIC X(01).                       
000027     05 FR00-NRMOVRIF            PIC X(06).                       
000028     05 FR00-IMPMOVIM            PIC S9(11)V99 COMP-3.            
000029     05 FR00-CVLMOVIM            PIC S9(11)V99 COMP-3.            
000030     05 FR00-IMPROFAT            PIC S9(09)V99 COMP-3.            
000031     05 FR00-SCONTDED            PIC S9(09)V99 COMP-3.            
000032     05 FR00-CVLSCDED            PIC S9(09)V99 COMP-3.            
000033     05 FR00-ADDFATTU            PIC S9(03)V99 COMP-3.            
000034     05 FR00-IMPADIVA            PIC S9(09)V99 COMP-3.            
000035     05 FR00-CVLADIVA            PIC S9(09)V99 COMP-3.            
000036     05 FR00-TIPOMOVI            PIC X(01).                       
000037     05 FR00-CENCOSTO            PIC X(05).                       
000038     05 FR00-BANDIVAL            PIC X(03).                       
000039     05 FR00-NRDICVAL            PIC X(06).                       
000040     05 FR00-VOCEDOPR            PIC X(08).                       
000041     05 FR00-IMPDOGPR            PIC S9(11)V99 COMP-3.            
000042     05 FR00-CDCEACQU            PIC X(06).                       
000043     05 FR00-CODUTVAR            PIC X(06).                       
000044     05 FR00-GENEFATT            PIC X.                           
000045     05 FR00-DATISCAD OCCURS 4.                                   
000046        10 FR00-DTSCADEN         PIC X(08).                       
000047        10 FR00-IMPSCADE         PIC S9(11)V99 COMP-3.            
000048        10 FR00-CVLSCADE         PIC S9(11)V99 COMP-3.            
000049        10 FR00-PRCSCADE         PIC S9(3)V99  COMP-3.            
000050     05 FR00-DATIXDCE OCCURS 5.                                   
000051        10 FR00-CONTODCE         PIC X(06).                       
000052        10 FR00-IMPORDCE         PIC S9(11)V99 COMP-3.            
000053        10 FR00-CVLXXDCE         PIC S9(11)V99 COMP-3.            
000054        10 FR00-ESENTIVA         PIC X(01).                       
000055        10 FR00-PERCEIVA         PIC S9(03)V99 COMP-3.            
000056        10 FR00-IMPORIVA         PIC S9(09)V99 COMP-3.            
000057        10 FR00-CVLXXIVA         PIC S9(09)V99 COMP-3.            
000058     05 FR00-NOTENOTE            PIC X(26).                       
000059     05 FR00-NRFATPRO            PIC X(06).                       
000060     05 FR00-SLTIPLIN            PIC X(01).                       
000061     05 FR00-CLIEMERC            PIC X(05).                       
000062     05 FR00-DATESIVA            PIC X(08).                       
000063     05 FR00-UFFICIVA            PIC X(18).                       
000064     05 FR00-NUMESIVA            PIC X(05).                       
000065     05 FR00-CDMOVRIF            PIC X(01).                       
000066     05 FR00-DATAMRIF            PIC X(08).                       
000067     05 FR00-CONDXASS            PIC X(01).                       
000068     05 FR00-FLEXECON            PIC X(01).                       
000069     05 FR00-FLAGXJDE            PIC X(01).                       
000070     05 FR00-VALTRASP            PIC S9(09)V99 COMP-3.            
000071     05 FR00-CVLTRASP            PIC S9(09)V99 COMP-3.            
000072     05 FR00-FILLERXX            PIC X(39).                       
      *<<((file: FSINFR00))
000052 01  FILLER                       PIC X(08) VALUE 'DCARR1  '.     
000053*    COPY DCARR1.                                                 
      *>>((file: DCARR1))
000001******************************************************************
000002******              AREA PER SUBROUTINE SRARR1              ******
000003******************************************************************
000004 01  DCARR1.                                                      
000005     05  ARR1-INPUT.                                              
000006         10  ARR1-CODDIVIS            PIC XX.                     
000007         10  ARR1-DECIDIVI            PIC X.                      
000008         10  ARR1-CODPAESE            PIC X(3).                   
000009     05  ARR1-INPUT-OUTPUT.                                       
000010         10  ARR1-IMPORTOX            PIC S9(11)V9(4) COMP-3.     
000011     05  ARR1-COMODI.                                             
000012         10  ARR1-ARROTIVA            PIC S9(3)V9(4)  COMP-3.     
000013         10  ARR1-INTEROXX            PIC S9(11)      COMP-3.     
000014         10  ARR1-DECIMA2X            PIC S9(11)V99   COMP-3.     
      *<<((file: DCARR1))
000054 01  FILLER                       PIC X(08) VALUE 'DCNUME**'.     
000055*    COPY DCNUME.                                                 
      *>>((file: DCNUME))
000001******************************************************************
000002*                       ***  DCNUME  ***                         *
000003*   PARAMETRI PER LA LETTURA E L'AGGIORNAMENTO DELLA TABELLA     *
000004*   DB2   'TNUMEAUTO'.                                           *
000005*   LUNGHEZZA = 100                                              *
000006******************************************************************
000007*                                                                *
000008 01  DCNUME.                                                      
000009     05  DCNU-RISPOSTA                    PIC X(04).              
000010     05  DCNU-FLAGOPER                    PIC X(01).              
000011*                                                                *
000012     05  DCNU-SIGLNUME                    PIC X(08).              
000013     05  DCNU-NUMEAUTO                    PIC X(09).              
000014     05  DCNU-NUMERIPR                    PIC X(09).              
000015     05  DCNU-DESCNUME                    PIC X(21).              
000016     05  DCNU-NUMERIP1                    PIC X(09).              
000017     05  DCNU-FILLER39                    PIC X(39).              
000018                                                                  
000019******************************************************************
000020                                                                  
      *<<((file: DCNUME))
000056 01  FILLER                       PIC X(08) VALUE 'DCWCAMB*'.     
000057*    COPY DCWCAMB.                                                
      *>>((file: DCWCAMB))
000001******************************************************************
000002******              AREA PASSAGGIO CHIAMATA                 ******
000003******         MODULI SCTCB05, SCBCB05, SCTCB10 E SCBCB10   ******
000004******         LENGTH -250-                                 ******
000005******                                                      ******
000006******   DATI-INPUT                                         ******
000007******         DA : CAMB-SIGLADIV                           ******
000008******          A   CAMB-SIGLACAM                           ******
000009******        OPPURE                                        ******
000010******         DA : CAMB-CODDIVIS                           ******
000011******          A   CAMB-CODCAMBI                           ******
000012******        OPPURE                                        ******
000013******         DA : CAMB-CODDIVIS                           ******
000014******          A   CAMB-SIGLACAM                           ******
000015******        OPPURE                                        ******
000016******         DA : CAMB-SIGLADIV                           ******
000017******          A   CAMB-CODCAMBI                           ******
000018******************************************************************
000019 01  DCWCAMB.                                                     
000020   02  CAMB-DATI-INPUT.                                           
000021     03  CAMB-DATI-COMUNI.                                        
000022       05  CAMB-SIGLACAM            PIC X(3).                     
000023       05  CAMB-SIGLADIV            PIC X(3).                     
000024       05  CAMB-CODCAMBI            PIC X(2).                     
000025       05  CAMB-CODDIVIS            PIC X(2).                     
000026       05  CAMB-IMPORTOO OCCURS 5   PIC S9(11)V99.                
000027       05  CAMB-DTCAMBIO            PIC X(8).                     
000028       05  CAMB-SOCIRIFE            PIC X(2).                     
000029       05  CAMB-CODDRIFE            PIC X(2).                     
000030       05  CAMB-SIGLRIFE            PIC X(3).                     
000031       05  FILLER                   PIC X(23).                    
000032   02  CAMB-DATI-OUTPUT.                                          
000033     03  CAMB-DATI-SIGLACAM.                                      
000034       05  CAMB-CAMBCAMB            PIC S9(9)V9999 COMP-3.        
000035       05  CAMB-DESCCAMB            PIC X(20).                    
000036       05  CAMB-DECICAMB            PIC X.                        
000037       05  CAMB-CAMBBANC            PIC X(3).                     
000038       05  CAMB-CAMBPREZ            PIC X.                        
000039     03  CAMB-DATI-SIGLADIV.                                      
000040       05  FILLER                   PIC X(7).                     
000041       05  CAMB-DESCDIVI            PIC X(20).                    
000042       05  CAMB-DECIDIVI            PIC X.                        
000043       05  CAMB-DIVIBANC            PIC X(3).                     
000044       05  CAMB-DIVIPREZ            PIC X.                        
000045     03  CAMB-CONTROVA OCCURS 5     PIC S9(11)V99  COMP-3.        
000046     03  CAMB-RAPPCAMB              PIC S9(5)      COMP-3.        
000047     03  CAMB-RAPPDIVI              PIC S9(5)      COMP-3.        
000048     03  CAMB-CAMBIODV              PIC S9(7)V9(6) COMP-3.        
000049     03  CAMB-CAMBDV10              PIC S9(5)V9(10) COMP-3.       
000050     03  FILLER                     PIC X(13).                    
000051     03  CAMB-RETCOD                PIC X(4).                     
      *<<((file: DCWCAMB))
000058 01  FILLER                       PIC X(08) VALUE 'DCNMFA**'.     
000059*    COPY DCNMFA.                                                 
      *>>((file: DCNMFA))
000001*===============================================================* 
000002*  COPY PER CHIAMATE AI MODULI SCBNMFA / SCTNMFA                * 
000003*===============================================================* 
000004******************************************************************
000005*                                                                *
000006*                    ***   DCNMFA   ***                          *
000007*                                                                *
000008*         STATUS RISPOSTA :  '****' SE TUTTO OK.                 *
000009*                            'NTRO' SE COMBINAZIONE NON TROVATA  *
000010*                                   SU MULTITABLE 'NORMEFAT'.    *
000011*                            'DATI' SE MANCANO DATI IN INPUT     *
000012*                                                                *
000013*         DATI IN  INPUT  :  CODICE PAESE SOCIETA'               *
000014*                            CODICE PAESE FATTURA                *
000015*                            CODICE PAESE MERCE                  *
000016*                            CODICE SOCIETA'                     *
000017*                            NUMERO FATTURA PROFORMA             *
000018*                                                                *
000019*         DATI IN OUTPUT  :  INDICATORE SI/NO I.V.A.             *
000020*                            CODICE ESENZIONE I.V.A.             *
000021*                            TIPO PART.IVA DA USARE              *
000022*                            INDICATORE SI/NO INTRASTAT          *
000023*                            INDICATORE SI/NO TRANSAZIONE        *
000024*                                       TRIANGOLARE              *
000025*   LUNGHEZZA = 100                                              *
000026******************************************************************
000027                                                                  
000028 01  DCNMFA.                                                      
000029     05  NMFA-RISPOSTA           PIC X(4)   VALUE SPACES.         
000030     05  NMFA-PAESOCIE           PIC X(3)   VALUE SPACES.         
000031     05  NMFA-PAEFATTU           PIC X(3)   VALUE SPACES.         
000032     05  NMFA-PAEMERCE           PIC X(3)   VALUE SPACES.         
000033     05  NMFA-CODSOCIE           PIC XX     VALUE SPACES.         
000034     05  NMFA-FLAGGIVA           PIC X      VALUE SPACES.         
000035     05  NMFA-ESENTIVA           PIC X      VALUE SPACES.         
000036     05  NMFA-FLPARIVA           PIC X      VALUE SPACES.         
000037     05  NMFA-FLAGINTR           PIC X      VALUE SPACES.         
000038     05  NMFA-FLDESFAT           PIC X      VALUE SPACES.         
000039     05  NMFA-CDIVACEE           PIC X(14)  VALUE SPACES.         
000040     05  NMFA-NRFATPRO           PIC X(6)   VALUE SPACES.         
000041     05  NMFA-COMBINAZ           PIC X(7)   VALUE SPACES.         
000042     05  NMFA-CTRLXIVA           PIC X      VALUE SPACES.         
000043     05  NMFA-CODCLIEN           PIC X(5)   VALUE SPACES.         
000044     05  NMFA-FILLER             PIC X(47)  VALUE SPACES.         
000045                                                                  
000046******************************************************************
000047 EJECT                                                            
      *<<((file: DCNMFA))
000060 01  FILLER                       PIC X(08) VALUE 'DCSCADEN'.     
000061*    COPY DCSCADEN.                                               
      *>>((file: DCSCADEN))
000001********************     DCSCADEN         ************************
000002*********  PARAMETRI PER LA CALL DEL MODULO DI             *******
000003*********  CALCOLO DELLE SCADENZE E DEGLI IMPORTI FATTURE  *******
000004*********      LUNGHEZZA AREA   - 184 - BYTES              *******
000005******************************************************************
000006                                                                  
000007 01  DCSCADEN.                                                    
000008   03  CAMPI-INPUT.                                               
000009     05  IN-CONDPAGA          PIC X(3)       VALUE SPACES.        
000010     05  IN-SCACLIEN          PIC X(5)       VALUE ZEROS.         
000011     05  IN-CODCLIEN REDEFINES IN-SCACLIEN PIC X(5).              
000012     05  IN-DECIMALI          PIC X          VALUE SPACES.        
000013     05  IN-DATAINIZ.                                             
000014         10  IN-SECOANNO.                                         
000015             15  IN-SECOINIZ  PIC 99               VALUE ZEROS.   
000016             15  IN-ANNOINIZ  PIC 99               VALUE ZEROS.   
000017         10  IN-MESEINIZ      PIC 99               VALUE ZEROS.   
000018         10  IN-GIORINIZ      PIC 99               VALUE ZEROS.   
000019     05  IN-DATADECO REDEFINES IN-DATAINIZ.                       
000020         10  IN-ANNODECO.                                         
000021             15  IN-SECOSECO  PIC 99.                             
000022             15  IN-AAAADECO  PIC 99.                             
000023         10  IN-MESEDECO      PIC 99.                             
000024         10  IN-GIORDECO      PIC 99.                             
000025     05  IN-IMPOFATT          PIC S9(11)V99 COMP-3 VALUE ZEROES.  
000026     05  IN-TIPOFATT          PIC X    VALUE SPACES.              
000027                                                                  
000028   03  CAMPI-OUTPUX.                                              
000029     05  OUT-SCADENZE.                                            
000030         10  OUT-ELESCADE OCCURS 4 TIMES.                         
000031             15  OUT-DATASCAD.                                    
000032                 20  OUT-AAAASCAD.                                
000033                     25  OUT-SECOINIZ     PIC 99.                 
000034                     25  OUT-ANNOINIZ     PIC 99.                 
000035                 20  OUT-MMMMSCAD         PIC 99.                 
000036                 20  OUT-GGGGSCAD         PIC 99.                 
000037             15  OUT-IMPOSCAD             PIC S9(11)V99  COMP-3.  
000038             15  OUT-PERCSCAD             PIC S9(3).              
000039   03  FILLER                             PIC X(83).              
000040   03  DCSC-RISPOSTA                      PIC X(4).               
000041                                                                  
000042******************************************************************
      *<<((file: DCSCADEN))
000062 01  FILLER                       PIC X(08) VALUE '*DCKYNUM'.     
000063*    COPY DCKYNUM.                                                
      *>>((file: DCKYNUM))
000001******************************************************************
000002*                                                                *
000003*                    ***   DCKYNUM  ***                          *
000004*                                                                *
000005*   PARAMETRI PER LA CALL DEL MODULO -SCTKYNUM                   *
000006*                      I     SOCIETA                             *
000007*                      I     CODICE CLIENTE                      *
000008*                      I     CODICE MOVIMENTO                    *
000009*                      I     TIPO MOVIMENTO                      *
000010*                      I     CODICE TIPO MERCE   (TIPO TESSUTO)  *
000011*                      I     TIPO PROCEDURA      (C=CONTABILITA) *
000012*                      I     CODICE BANCA                        *
000013*                      I     STATUS DOCUMENTO    (FATT. INTERNE) *
000014*                      I     MOV. SOLA IVA ESTERO (SOLO BONIFICI)*
000015*                        O   ELEMENTO DI NUME                    *
000016*                        O   NUMERO PROGRESSIVO DA NUME          *
000017*                        O   RISPOSTA                            *
000018*   LUNGHEZZA = 50                                               *
000019*                                                                *
000020******************************************************************
000021                                                                  
000022 01  DCKYNUM.                                                     
000023     05  DCKY-RISPOSTA           PIC X(4)   VALUE SPACES.         
000024     05  DCKY-CODSOCIE           PIC X(2)   VALUE SPACES.         
000025     05  DCKY-CODCLIEN           PIC X(5)   VALUE SPACES.         
000026     05  DCKY-CODIMOVI           PIC X      VALUE SPACES.         
000027     05  DCKY-TIPOMOVI           PIC X      VALUE SPACES.         
000028     05  DCKY-TIPOMERC           PIC X      VALUE SPACES.         
000029     05  DCKY-ELEMNUME           PIC X(8)   VALUE SPACES.         
000030     05  DCKY-NUMEAUTO           PIC X(9)   VALUE SPACES.         
000031     05  DCKY-TIPOPROC           PIC X      VALUE SPACES.         
000032     05  DCKY-CODBANCA           PIC X(3)   VALUE SPACES.         
000033     05  DCKY-STATFATT           PIC X      VALUE SPACES.         
000034     05  DCKY-FLSOLIVA           PIC X(1)   VALUE SPACES.         
000035     05  DCKY-GENECLIE           PIC X      VALUE SPACES.         
000036     05  DCKY-ESENTIVA           PIC X      VALUE SPACES.         
000037     05  DCKY-BONIFICO           PIC X      VALUE SPACES.         
000038     05  DCKY-FILLER             PIC X(10)  VALUE SPACES.         
000039                                                                  
000040                                                                  
000041******************************************************************
000042 EJECT                                                            
      *<<((file: DCKYNUM))
000064 01  FILLER                       PIC X(08) VALUE '*FSEC90*'.     
000065*    COPY FSEC90.                                                 
      *>>((file: FSEC90))
000001******************************************************************
000002*                                                                *
000003*                     ---  FSEC90  ---                           *
000004*                   GESTIONE E-COMMERCE                          *
000005*  DSECT UTILIZZATA DAL PGM CHE CREA LA FATTURA MENSILE PER      *
000006*  ZEROGREY. IL FILE VA IN INPUT ALLA PROCEDURA DELLA CONTABILI- *
000007*  TA' CHE MANDA I DATI IN GTM.                                  *
000008*  LUNGHEZZA 50                                                  *
000009*               .                                                *
000010******************************************************************
000011 01  FSEC90.                                                      
000012     05 EC90-CODSOCIE            PIC X(02).                       
000013     05 EC90-CODCLIEN            PIC X(05).                       
000014     05 EC90-NUMFATTU            PIC X(06).                       
000015     05 EC90-CDMOVCON            PIC X(01).                       
000016     05 EC90-DTFATTUR            PIC X(08).                       
000017     05 EC90-CENCOSTO            PIC X(05).                       
000018     05 EC90-PERCENTU            PIC S9(3)V9(5) COMP-3.           
000019     05 EC90-CENCOSTD            PIC X(05).                       
000020     05 EC90-ACQUVEND            PIC X(01).                       
000021     05 EC90-CONTARIG            PIC 9(05).                       
000022     05 FILLER                   PIC X(06).                       
      *<<((file: FSEC90))
000066                                                                  
000067 01  FILLER                       PIC X(8)   VALUE 'COMODI'.      
000068 01  COMODI.                                                      
000069     05  WS-DICITURE.                                             
000070         10  WS-LINGDELL          PIC X(5).                       
000071         10  WS-LINGIMPO          PIC X(9).                       
000072         10  WS-LINGIVAA          PIC X(12).                      
000073         10  WS-LINGTOTA          PIC X(11).                      
000074         10  WS-LINGQUAN          PIC X(8).                       
000075         10  WS-LINGPREZ          PIC X(6).                       
000076         10  WS-LINGORDI          PIC X(9).                       
000077         10  WS-LINGSERV          PIC X(8).                       
000078         10  WS-LINGUNMI          PIC X(2).                       
000079         10  WS-LINGARTI          PIC X(5).                       
000080         10  WS-LINGDESC          PIC X(10).                      
000081         10  WS-LINGTMER          PIC X(2).                       
000082         10  WS-LINGCICL          PIC X(2).                       
000083     05  WS-CODFISCA.                                             
000084         10  WS-CODFISCA-11       PIC X(11)   VALUE SPACES.       
000085         10  WS-CODFISCA-05       PIC X(05)   VALUE SPACES.       
000086                                                                  
000087     05  WS-CONTAFAT              PIC S9(5)   COMP-3.             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000088     05  WS-NUMRIGHE              PIC S9(5)   COMP-3.             
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000089     05  WS-DTGIORNO              PIC X(8).                       
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000090     05  COMO-CODARTIC            PIC X(6).                       
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000091     05  WS-SIGPAFAT              PIC X(3).                       
000092     05  WS-SIGPAMER              PIC X(3).                       
000093     05  WS-MESEELAB              PIC X(6)  VALUE SPACES.         
000094     05  WS-CODSERVI              PIC X(6)  VALUE SPACES.         
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000095     05  WS-CODPIANO              PIC X(02).                      
000096     05  WS-MERCEMAG              PIC X(02).                      
000097     05  WS-CODARTIC              PIC X(05).                      
000098     05  WS-DESARTIC              PIC X(10).                      
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000099     05  WS-CARATASA              PIC X     VALUE SPACES.         
000100     05  WS-TIRIGFAT              PIC XX    VALUE SPACES.         
000101     05  WS-RIGAPAC1              PIC X(77) VALUE SPACES.         
000102     05  WS-RIGAPAC2              PIC X(77) VALUE SPACES.         
000103     05  WS-RIGAPAC3              PIC X(77) VALUE SPACES.         
000104     05  WS-RIGAPAC4              PIC X(77) VALUE SPACES.         
000105     05  WS-RIGAPAC5              PIC X(77) VALUE SPACES.         
000106     05  WS-RIGAPAC6              PIC X(77) VALUE SPACES.         
000107     05  WS-RIGAPAC7              PIC X(77) VALUE SPACES.         
000108     05  WS-PRIMA-VOLTA           PIC X(02) VALUE SPACES.         
000109     05  IND-R                    PIC S9(5)     COMP-3 VALUE +0.  
000110     05  IND-E                    PIC S9(5)     COMP-3 VALUE +0.  
000111     05  IND-R-SAVE               PIC S9(5)     COMP-3 VALUE +0.  
000112     05  IND-E-SAVE               PIC S9(5)     COMP-3 VALUE +0.  
000113     05  IND-N                    PIC S9(5)     COMP-3 VALUE +0.  
000114     05  IND-I                    PIC S9(5)     COMP-3 VALUE +0.  
000115     05  IND                      PIC S9(5)     COMP-3 VALUE +0.  
000116     05  INDC                     PIC S9(5)     COMP-3 VALUE +0.  
000117     05  INDN                     PIC S9(5)     COMP-3 VALUE +0.  
000118     05  MAXIND                   PIC S9(5)     COMP-3 VALUE 1000.
000119     05  MAXIND-N                 PIC S9(5)     COMP-3 VALUE 5.   
000120     05  MAXIND-R                 PIC S9(5)     COMP-3 VALUE 5.   
000121     05  MAXIND-E                 PIC S9(5)     COMP-3 VALUE 6.   
000122     05  MAXIND-I                 PIC S9(5)     COMP-3 VALUE 5.   
000123     05  MAX-INDC                 PIC S9(5)     COMP-3 VALUE 1000.
000124     05  WS-NRTIRIFA              PIC S9(5)     COMP-3 VALUE +0.  
000125     05  WS-IMPORDIN              PIC S9(11)V9999 COMP-3 VALUE +0.
000126     05  WS-TOTMOVIM              PIC S9(11)V9999 COMP-3 VALUE +0.
000127     05  WS-TOTFATTU              PIC S9(11)V9999 COMP-3 VALUE +0.
000128     05  WS-IMPORIVA              PIC S9(11)V9999 COMP-3 VALUE +0.
000129     05  WS-TOTIVAXX              PIC S9(11)V9999 COMP-3 VALUE +0.
000130     05  WS-PERCEIVA              PIC S9(3)V99  COMP-3 VALUE +0.  
000131     05  WS-TOTCVSCA              PIC S9(11)V9999 COMP-3 VALUE +0.
000132     05  WS-TOTCVFAT              PIC S9(11)V9999 COMP-3 VALUE +0.
000133     05  WS-IMPORTON              PIC S9(11)V9999 COMP-3 VALUE +0.
000134     05  WS-SQLCODE               PIC S9(9) COMP-5 VALUE ZEROES.  
000135     05  WS-DESCMOVI              PIC X(21) VALUE SPACES.         
000136     05  WS-CODSOCIE              PIC X(2)  VALUE SPACES.         
000137     05  WS-CODCLIEN              PIC X(5)  VALUE SPACES.         
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000138     05  WS-CENCOSTA              PIC X(5)  VALUE SPACES.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000139     05  WS-TIPSERVI              PIC X(1)  VALUE SPACES.         
000140     05  WS-CODDIVIS              PIC X(2)  VALUE SPACES.         
000141     05  WS-FLAGGIVA              PIC X(1)  VALUE SPACES.         
000142     05  WS-ESENTIVA              PIC X(1)  VALUE SPACES.         
000143     05  WS-CONTODCE              PIC X(06) VALUE SPACES.         
000144     05  WS-AAMMCOMP              PIC X(06) VALUE SPACES.         
000145     05  WS-CONTPROV              PIC X(06) VALUE SPACES.         
000146     05  WS-NUMEAUTO              PIC X(06) VALUE SPACES.         
000147     05  WS-NUMEXXXX REDEFINES WS-NUMEAUTO.                       
000148         10  FILLER               PIC X(1).                       
000149         10  WS-NUMEAUT9          PIC 9(5).                       
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000150     05  WS-AANUMORD              PIC X(08) VALUE SPACES.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000151     05  WS-AANUMORD-X            PIC X(08) VALUE SPACES.         
000152     05  WS-PROVADEF              PIC X(01) VALUE SPACES.         
000153     05  WS-ELEMENTO              PIC X(500) VALUE SPACES.        
000154     05  WS-TOTPERCE              PIC S9(5)V9(5) COMP-3 VALUE +0. 
000155     05  WS-CONTARIG              PIC  9(5) VALUE ZEROES.         
000156                                                                  
000157     05  SK-PARAM.                                                
000158          10 SK-TIPOSKED           PIC X(04).                     
000159          10 SK-FILLER             PIC X(01).                     
000160          10 SK-CODSOCIE           PIC X(02).                     
000161          10 SK-FILLER             PIC X(01).                     
000162          10 SK-CODCLIEN           PIC X(05).                     
000163          10 SK-FILLER             PIC X(01).                     
000164          10 SK-PROVADEF           PIC X(01).                     
000165                                                                  
000166     05  WS-RIGAST01.                                             
000167       10  WS-CAMPRASO.                                           
000168         15  WS-CAMPORAS          PIC X(24).                      
000169         15  FILLER               PIC X(20).                      
000170       10  WS-CAMPCAPC REDEFINES WS-CAMPRASO.                     
000171         15  WS-CAMPXCAP          PIC X(33).                      
000172         15  FILLER               PIC X(11).                      
000173       10  WS-CAMPO033            PIC X(33).                      
000174       10  WS-CAMPO033-R REDEFINES WS-CAMPO033.                   
000175         15  WS-CAMPO024          PIC X(24).                      
000176         15  FILLER               PIC X(09).                      
000177       10  FILLER                 PIC X(16).                      
000178     05  WS-RIGAST03 REDEFINES WS-RIGAST01.                       
000179       10  FILLER                 PIC X(38).                      
000180       10  WS-DESIMPO3            PIC X(9).                       
000181       10  FILLER                 PIC X(5).                       
000182       10  WS-SIGLADI3            PIC X(3).                       
000183       10  FILLER                 PIC X.                          
000184       10  WS-RI03DATI.                                           
000185         15  WS-IMPORTO3          PIC Z.ZZZ.ZZ9,99.               
000186         15  WS-IMPORT30 REDEFINES WS-IMPORTO3 PIC ZZZZ.ZZZ.ZZZ.  
000187         15  FILLER               PIC X(25).                      
000188     05  WS-RIGAST04 REDEFINES WS-RIGAST01.                       
000189       10  FILLER                 PIC X(38).                      
000190       10  WS-DESCIVA4            PIC X(12).                      
000191       10  WS-IVADATII.                                           
000192         15  WS-PERCIVA4          PIC Z9,99.                      
000193         15  WS-SEGNOPE4          PIC X.                          
000194         15  WS-IMPOIVA4          PIC Z.ZZZ.ZZ9,99.               
000195         15  WS-IMPOIV40 REDEFINES WS-IMPOIVA4 PIC ZZZZ.ZZZ.ZZZ.  
000196       10  FILLER                 PIC X(25).                      
000197     05  WS-RIGAST05 REDEFINES WS-RIGAST01.                       
000198       10  WS-DESCRIG5            PIC X(50).                      
000199       10  WS-FILLER05 REDEFINES WS-DESCRIG5.                     
000200         15  FILLER               PIC X(38).                      
000201         15  WS-DESCTOT5          PIC X(12).                      
000202       10  FILLER                 PIC X(2).                       
000203       10  WS-SIGLADI5            PIC X(3).                       
000204       10  FILLER                 PIC X.                          
000205       10  WS-RI05DATI.                                           
000206         15  WS-IMPOTRA5          PIC Z.ZZZ.ZZ9,99.               
000207         15  WS-IMPOTR50 REDEFINES WS-IMPOTRA5 PIC ZZZZ.ZZZ.ZZZ.  
000208         15  WS-ASTERIX5          PIC XXX.                        
000209         15  FILLER               PIC X(22).                      
000210     05  WS-RIGAST06 REDEFINES WS-RIGAST01.                       
000211       10  WS-DESCRIG6            PIC X(36).                      
000212       10  FILLER                 PIC X(35).                      
000213       10  WS-CODCLIE6            PIC X(5).                       
000214       10  FILLER                 PIC X.                          
000215       10  WS-SIGLPAE6            PIC X(3).                       
000216       10  FILLER                 PIC X(13).                      
000217     05  WS-RIGAST07 REDEFINES WS-RIGAST01.                       
000218       10  WS-SCADENZE OCCURS 4 TIMES.                            
000219          15  WS-DATASCAD.                                        
000220              20  WS-GGGGSCAD     PIC X(2).                       
000221              20  WS-BARRAXX1     PIC X.                          
000222              20  WS-MMMMSCAD     PIC X(2).                       
000223              20  WS-BARRAXX2     PIC X.                          
000224              20  WS-AAAASCAD     PIC X(2).                       
000225          15  FILLER              PIC X.                          
000226          15  WS-IMPSCADI         PIC ZZZZZZZZZZ.                 
000227          15  WS-IMPSCADD REDEFINES WS-IMPSCADI                   
000228                                  PIC ZZZZZZ9,99.                 
000229          15  WS-IMPSCADX REDEFINES WS-IMPSCADI                   
000230                                  PIC X(10).                      
000231          15  FILLER              PIC X.                          
000232       10  FILLER                 PIC X(13).                      
000233                                                                  
000234     05  PK-RIGAPAC1.                                             
000235       10  PK-TESTORDI            PIC X(09).                      
000236       10  FILLER                 PIC X(02).                      
000237       10  PK-TESTSERV            PIC X(08).                      
000238       10  FILLER                 PIC X(06).                      
000239       10  PK-TESTQUAN            PIC X(08).                      
000240       10  FILLER                 PIC X(02).                      
000241       10  PK-TESTUNMI            PIC X(02).                      
000242       10  FILLER                 PIC X(07).                      
000243       10  PK-TESTPREZ            PIC X(06).                      
000244       10  FILLER                 PIC X(10).                      
000245       10  PK-TESTIMPO            PIC X(09).                      
000246       10  FILLER                 PIC X(08).                      
000247                                                                  
000248     05  PK-RIGAPAC2.                                             
000249       10  PK-TRATTIN1            PIC X(09).                      
000250       10  FILLER                 PIC X(02).                      
000251       10  PK-TRATTIN2            PIC X(08).                      
000252       10  FILLER                 PIC X(02).                      
000253       10  PK-TRATTIN3            PIC X(12).                      
000254       10  FILLER                 PIC X(02).                      
000255       10  PK-TRATTIN4            PIC X(02).                      
000256       10  FILLER                 PIC X(02).                      
000257       10  PK-TRATTIN5            PIC X(11).                      
000258       10  FILLER                 PIC X(02).                      
000259       10  PK-TRATTIN6            PIC X(17).                      
000260       10  FILLER                 PIC X(08).                      
000261                                                                  
000262     05  PK-RIGAPAC3.                                             
000263       10  PK-AANUMORD            PIC X(08).                      
000264       10  FILLER                 PIC X(03).                      
000265       10  PK-CODSERVI            PIC X(06).                      
000266       10  FILLER                 PIC X(04).                      
000267       10  PK-QTAORDIN            PIC Z.ZZZ.ZZZ,ZZ.               
000268       10  FILLER                 PIC X(02).                      
000269       10  PK-UNMISURA            PIC X(02).                      
000270       10  FILLER                 PIC X(02).                      
000271       10  PK-PREZZORD            PIC ZZ.ZZZ,ZZZZ.                
000272       10  FILLER                 PIC X(02).                      
000273       10  PK-IMPORDIN            PIC ZZ.ZZZ.ZZZ.ZZZ,ZZ.          
000274       10  FILLER                 PIC X(08).                      
000275                                                                  
000276     05  PK-RIGAPAC4.                                             
000277       10  PK-DESSERVI            PIC X(40).                      
000278       10  FILLER                 PIC X(01).                      
000279       10  PK-NOTENOTE            PIC X(36).                      
000280                                                                  
000281     05  PK-RIGAPAC5.                                             
000282         10 PK5-FILLER           PIC X(6)       VALUE SPACE.      
000283         10 FILLER               PIC X(1)       VALUE SPACE.      
000284         10 PK5-MERCEMAG         PIC X(2)       VALUE SPACE.      
000285         10 FILLER               PIC X(1)       VALUE SPACE.      
000286         10 PK5-CODARTIC         PIC X(6)       VALUE SPACE.      
000287         10 FILLER               PIC X(1)       VALUE SPACE.      
000288         10 PK5-DESARTIC         PIC X(10)      VALUE SPACE.      
000289         10 FILLER               PIC X(2)       VALUE SPACE.      
000290         10 PK5-SIGLCICL         PIC X(02)      VALUE SPACE.      
000291         10 FILLER               PIC X(1)       VALUE SPACE.      
000292         10 PK5-QTAORDIN         PIC Z.ZZZ.ZZZ,ZZ.                
000293         10 PK5-QTAORDIN-X REDEFINES PK5-QTAORDIN  PIC X(12)      
000294                                                JUST RIGHT.       
000295         10 FILLER               PIC X(02)      VALUE SPACE.      
000296         10 PK5-UNMISURA         PIC XX.                          
000297         10 FILLER               PIC X(02)      VALUE SPACE.      
000298         10 PK5-PREZZORD         PIC ZZ.ZZZ,ZZZZ.                 
000299         10 PK5-PREZZORD-X REDEFINES PK5-PREZZORD  PIC X(11)      
000300                                                JUST RIGHT.       
000301         10 FILLER               PIC X(02)      VALUE SPACE.      
000302         10 PK5-IMPORDIN         PIC ZZ.ZZZ.ZZZ,ZZ.               
000303         10 PK5-IMPORDIN-X REDEFINES PK5-IMPORDIN  PIC X(13)      
000304                                                JUST RIGHT.       
000305                                                                  
000306     05 PK-RIGAPAC6.                                              
000307        10 PK6-CODSERVI            PIC X(6)       VALUE SPACE.    
000308        10 FILLER                  PIC X(1)       VALUE SPACE.    
000309        10 PK6-DESSERVI            PIC X(70)      VALUE SPACE.    
000310                                                                  
000311 01  TABELLA.                                                     
000312     05 PKL-TABELLA OCCURS  1000 TIMES.                           
000313        10 PKL-AANUMORD           PIC X(8).                       
000314        10 PKL-CODSERVI           PIC X(6).                       
000315        10 PKL-PREZZORD           PIC S9(5)V9(4) COMP-3.          
000316        10 PKL-UNMISURA           PIC X(8).                       
000317        10 PKL-QTAORDIN           PIC S9(7)V9(2) COMP-3.          
000318        10 PKL-IMPORDIN           PIC S9(11)V9(4) COMP-3.         
000319        10 PKL-DESSERVI           PIC X(40).                      
000320        10 PKL-NOTENOTE           PIC X(40).                      
000321        10 PKL-MERCEMAG           PIC X(02).                      
000322        10 PKL-CODARTIC           PIC X(06).                      
000323        10 PKL-SIGLCICL           PIC X(02).                      
000324                                                                  
000325 01  TAB-ORDINI.                                                  
000326     05 ORD-TABELLA OCCURS  1000 TIMES.                           
000327        10 ORD-AANUMORD           PIC X(8).                       
000328                                                                  
000329 01 TABELLA1.                                                     
000330     05 T1-ELEMENTO OCCURS 1000 TIMES.                            
000331        10 T1-CENCOSTA            PIC X(05).                      
000332        10 T1-CENCOSTD            PIC X(05).                      
000333        10 T1-IMPORTO             PIC S9(7)V99 COMP-3.            
000334        10 T1-PERCENTU            PIC S9(3)V9(5) COMP-3.          
000335        10 T1-CONTARIG            PIC 9(5).                       
000336                                                                  
000337 01 TABELLA2.                                                     
000338     05 NOTE-ELEMENTO OCCURS 5    TIMES.                          
000339        10 NOTE-NOTEORDI          PIC X(78).                      
000340                                                                  
000341 01 TABELLA3.                                                     
000342     05 IVA-ELEMENTO OCCURS 5   TIMES.                            
000343        10 IVA-NUMESIVA           PIC X(05).                      
000344        10 IVA-DATESIVA           PIC X(08).                      
000345        10 IVA-UFFICIVA           PIC X(18).                      
000346                                                                  
000347 01 TABELLA4.                                                     
000348     05 RIFE-ELEMENTO OCCURS 5    TIMES.                          
000349        10 RIFE-TESTOXXX          PIC X(12).                      
000350        10 RIFE-ELEMRIGA OCCURS 6.                                
000351           15 RIFE-RIFORDIN       PIC X(10).                      
000352           15 RIFE-VIRGOLAX       PIC X(01).                      
000353                                                                  
000354 01  WS-OUTFATT.                                                  
000355     05  OUT-CODSOCIE             PIC XX.                         
000356     05  OUT-CDMOVCON             PIC X.                          
000357     05  OUT-NRMOVCON             PIC X(6).                       
000358     05  OUT-DTREGMOV             PIC X(8).                       
000359     05  OUT-CODILING             PIC X(1).                       
000360     05  OUT-CODCLIEN             PIC X(5).                       
000361     05  OUT-CONTPROV             PIC X(6).                       
000362     05  FILLER                   PIC X(21).                      
000363                                                                  
000364*------------------------------> DANAGRAF.VANAGRAF_019            
000365 01  FILLER                      PIC X(8) VALUE 'FDANA019'.       
000368*    EXEC SQL                                                     
      *         INCLUDE FDANA019                                        
      *    END-EXEC.                                                    
      *>>((file: FDANA019))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.VANAGRAF_019)                            *
000003*        LIBRARY(TESTPO.LIB.DSECT(FDANA019))                     *
000004*        QUOTE                                                   *
000005* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000006******************************************************************
000007     
      *EXEC SQL DECLARE DANAGRAF.VANAGRAF_019 TABLE                 
000008*     ( CDMOVCON                       CHAR(10) NOT NULL,          
000009*       INDSEGNO                       CHAR(20) NOT NULL,          
000010*       CODILING                       CHAR(20) NOT NULL,          
000011*       DESCMOVI                       CHAR(20) NOT NULL,          
000012*       ABBRMOVI                       CHAR(20) NOT NULL,          
000013*       CDSELMOV                       CHAR(20) NOT NULL           
000014*     ) END-EXEC
                                                                        
000015******************************************************************
000016* COBOL DECLARATION FOR TABLE DANAGRAF.VANAGRAF_019              *
000017******************************************************************
000018 01  DCLVANAGRAF-019.                                             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000019     10 A019-CDMOVCON        PIC X(10).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000020     10 A019-INDSEGNO        PIC X(20).                           
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000021     10 A019-CODILING        PIC X(20).                           
000022     10 A019-DESCMOVI        PIC X(20).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000023     10 A019-ABBRMOVI        PIC X(20).                           
000024     10 A019-CDSELMOV        PIC X(20).                           
000025******************************************************************
000026* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 6       *
000027******************************************************************
      *<<((file: FDANA019))
000369*    --------------------------> DANAGRAF.VANAGRAF_082            
000370 01  FILLER                      PIC X(8) VALUE 'FDANA082'.       
000373*    EXEC SQL                                                     
      *         INCLUDE FDANA082                                        
      *    END-EXEC.                                                    
      *>>((file: FDANA082))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.VANAGRAF_082)                            *
000003*        LIBRARY(PROG169.MTCSV440.DCLGEN(FDANA082))              *
000004*        LANGUAGE(COBOL)                                         *
000005*        QUOTE                                                   *
000006* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000007******************************************************************
000008     
      *EXEC SQL DECLARE DANAGRAF.VANAGRAF_082 TABLE                 
000009*     ( DATEDATE                       CHAR(10) NOT NULL           
000010*     ) END-EXEC
                                                                        
000011******************************************************************
000012* COBOL DECLARATION FOR TABLE DANAGRAF.VANAGRAF_082              *
000013******************************************************************
000014 01  DCLVANAGRAF-082.                                             
000015  10 A082-DATEDATE             PIC X(10).                         
000016******************************************************************
000017* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 1       *
000018******************************************************************
      *<<((file: FDANA082))
000374*------------------------------> DANAGRAF.VANAGRAF_112            
000375 01  FILLER                      PIC X(8) VALUE 'FDANA112'.       
000378*    EXEC SQL                                                     
      *         INCLUDE FDANA112                                        
      *    END-EXEC.                                                    
      *>>((file: FDANA112))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.VANAGRAF_112)                            *
000003*        LIBRARY(TESTPO.LIB.DSECT(FDANA112))                     *
000004*        QUOTE                                                   *
000005* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000006******************************************************************
000007     
      *EXEC SQL DECLARE DANAGRAF.VANAGRAF_112 TABLE                 
000008*     ( TIPOPAG1                       CHAR(10) NOT NULL,          
000009*       DETIPOP1                       CHAR(20) NOT NULL,          
000010*       TIPOPAG2                       CHAR(20) NOT NULL,          
000011*       DETIPOP2                       CHAR(20) NOT NULL           
000012*     ) END-EXEC
                                                                        
000013******************************************************************
000014* COBOL DECLARATION FOR TABLE DANAGRAF.VANAGRAF_112              *
000015******************************************************************
000016 01  DCLVANAGRAF-112.                                             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000017     10 A112-TIPOPAG1        PIC X(10).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000018     10 A112-DETIPOP1        PIC X(20).                           
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000019     10 A112-TIPOPAG2        PIC X(20).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000020     10 A112-DETIPOP2        PIC X(20).                           
000021******************************************************************
000022* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 4       *
000023******************************************************************
      *<<((file: FDANA112))
000379*------------------------------> DANAGRAF.VANAGRAF_122            
000380 01  FILLER                      PIC X(8) VALUE 'FDANA122'.       
000383*    EXEC SQL                                                     
      *         INCLUDE FDANA122                                        
      *    END-EXEC.                                                    
      *>>((file: FDANA122))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.VANAGRAF_122)                            *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA122))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(A122-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DANAGRAF.VANAGRAF_122 TABLE                 
000012*     ( CODSOCIE                       CHAR(10) NOT NULL,          
000013*       CODPAESE                       CHAR(20) NOT NULL,          
000014*       INDICIVA                       CHAR(20) NOT NULL,          
000015*       PERIVAFA                       DECIMAL(13, 3) NOT NULL,    
000016*       ADDFATTU                       DECIMAL(13, 3) NOT NULL,    
000017*       DTINIALQ                       CHAR(20) NOT NULL,          
000018*       ZONAFATT                       CHAR(20) NOT NULL           
000019*     ) END-EXEC
                                                                        
000020******************************************************************
000021* COBOL DECLARATION FOR TABLE DANAGRAF.VANAGRAF_122              *
000022******************************************************************
000023 01  DCLVANAGRAF-122.                                             
000024*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000025     10 A122-CODSOCIE        PIC X(10).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000026*                       CODPAESE                                  
000027     10 A122-CODPAESE        PIC X(20).                           
000028*                       INDICIVA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000029     10 A122-INDICIVA        PIC X(20).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000030*                       PERIVAFA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000031     10 A122-PERIVAFA        PIC S9(10)V9(3) USAGE COMP-3.        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000032*                       ADDFATTU                                  
000033     10 A122-ADDFATTU        PIC S9(10)V9(3) USAGE COMP-3.        
000034*                       DTINIALQ                                  
000035     10 A122-DTINIALQ        PIC X(20).                           
000036*                       ZONAFATT                                  
000037     10 A122-ZONAFATT        PIC X(20).                           
000038******************************************************************
000039* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 7       *
000040******************************************************************
      *<<((file: FDANA122))
000384*------------------------------> DANAGRAF.TSOCIETA                
000385 01  FILLER                      PIC X(8) VALUE 'FDANA531'.       
000388*    EXEC SQL                                                     
      *         INCLUDE FDANA531                                        
      *    END-EXEC.                                                    
      *>>((file: FDANA531))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TSOCIETA                  *
000003******************************************************************
000004 01  DCLTSOCIETA.                                                 
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 A531-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000006     10 A531-NOMSOCIE        PIC X(23).                           
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000007     10 A531-CODFORNI        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000008     10 A531-TASSINTE        PIC S9(3)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000009     10 A531-CODPAESE        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000010     10 A531-NRGGRISC        PIC S9(3)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000011     10 A531-CODPIANO        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000012     10 A531-CITTASOC        PIC X(18).                           
000013     10 A531-FLPAGIVA        PIC X(1).                            
000014     10 A531-FLFATACQ        PIC X(1).                            
000015     10 A531-CODAZIEN        PIC X(5).                            
000016     10 A531-FLIVATRA        PIC X(1).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000017     10 A531-CODDIVIS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000018     10 A531-COSTINTE        PIC S9(3)V9(2) USAGE COMP-3.         
000019     10 A531-FLCONTAB        PIC X(1).                            
000020     10 A531-FLAGMAGA        PIC X(1).                            
000021     10 A531-RAGSOCIE        PIC X(50).                           
000022     10 A531-SOCIECON        PIC X(2).                            
000023     10 A531-DTCREAZI        PIC X(8).                            
000024     10 A531-DTULTVAR        PIC X(8).                            
000025     10 A531-CODUTVAR        PIC X(6).                            
000026     10 A531-INDLEGAL        PIC X(35).                           
000027     10 A531-CAPLEGAL        PIC X(5).                            
000028     10 A531-CITLEGAL        PIC X(18).                           
000029     10 A531-CODFISCA        PIC X(16).                           
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000030     10 A531-CODDIVRI        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000031     10 A531-SOCIEGTM        PIC X(2).                            
000032     10 A531-GENEFATT        PIC X(1).                            
000033     10 A531-FLAGATTI        PIC X(1).                            
000034     10 A531-DIVISOLD        PIC X(2).                            
000035     10 A531-DTFINOLD        PIC X(8).                            
000036     10 A531-DIVRIOLD        PIC X(2).                            
000037     10 A531-DIVIRIFA        PIC X(2).                            
000038     10 A531-FLEURUSA        PIC X(1).                            
000039     10 A531-FLAGLIMI        PIC X(1).                            
000040     10 A531-FLFILIAL        PIC X(1).                            
000041     10 A531-FLPRESEN        PIC X(1).                            
000042     10 A531-CODSOCPA        PIC X(1).                            
000043     10 A531-FLBOLGVB        PIC X(1).                            
000044     10 A531-FLSTCART        PIC X(1).                            
000045     10 A531-FLDIPEST        PIC X(1).                            
000046     10 A531-CODFIRMA        PIC X(8).                            
000047     10 A531-DESFIRMA        PIC X(24).                           
000048     10 A531-CDSOCJDE        PIC X(5).                            
000049     10 A531-CODFORNV        PIC X(5).                            
000050     10 A531-CODFORNA        PIC X(5).                            
000051     10 A531-IMPCCASO        PIC S9(13) COMP-3.                   
000052     10 A531-TRIBCCIA        PIC X(10).                           
000053     10 A531-PROLEGAL        PIC X(2).                            
000054     10 A531-FLSOCSAP        PIC X(1).                            
000055     10 A531-DIVIXLAV        PIC X(2).                            
000056******************************************************************
000057* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 51      *
000058******************************************************************
      *<<((file: FDANA531))
000389*------------------------------> DANAGRAF.TPAESI                  
000390 01  FILLER                      PIC X(8) VALUE 'FDANA528'.       
000393*    EXEC SQL                                                     
      *         INCLUDE FDANA528                                        
      *    END-EXEC.                                                    
      *>>((file: FDANA528))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TPAESI                    *
000003******************************************************************
000004 01  DCLTPAESI.                                                   
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 A528-CODPAESE        PIC X(3).                            
000006     10 A528-CODILING        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007     10 A528-PAESBANC        PIC X(3).                            
000008     10 A528-PAESEISO        PIC X(2).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000009     10 A528-FLPAECEE        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000010     10 A528-FLPAEORI        PIC X(1).                            
000011     10 A528-DTCREAZI        PIC X(8).                            
000012     10 A528-DTULTVAR        PIC X(8).                            
000013     10 A528-CODUTVAR        PIC X(6).                            
000014     10 A528-SLPAEGTM        PIC X(3).                            
000015     10 A528-PRFINTER        PIC X(5).                            
000016     10 A528-GRUPPAES        PIC X(2).                            
000017     10 A528-CDMCAREG        PIC X(2).                            
000018     10 A528-CDAREREG        PIC X(2).                            
000019     10 A528-CDRAGCEN        PIC X(2).                            
000020     10 A528-CDRAGTRA        PIC X(2).                            
000021     10 A528-CDRAGFOC        PIC X(2).                            
000022     10 A528-CODPAGVB        PIC X(3).                            
000023     10 A528-SIGPAGVB        PIC X(2).                            
000024     10 A528-CODPARUS        PIC X(3).                            
000025     10 A528-CDRAGLIS        PIC X(2).                            
000026     10 A528-CDRAGSTA        PIC X(2).                            
000027     10 A528-CDRAGLIC        PIC X(2).                            
000028     10 A528-CDRAGLIF        PIC X(2).                            
000029******************************************************************
000030* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 24      *
000031******************************************************************
      *<<((file: FDANA528))
000394*------------------------------> DANAGRAF.TPAESLING               
000395 01  FILLER                      PIC X(8) VALUE 'FDANA529'.       
000398*    EXEC SQL                                                     
      *         INCLUDE FDANA529                                        
      *    END-EXEC.                                                    
      *>>((file: FDANA529))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TPAESLING)                               *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA529))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        QUOTE                                                   *
000007* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000008******************************************************************
000009     
      *EXEC SQL DECLARE DANAGRAF.TPAESLING TABLE                    
000010*     ( CODPAESE                       CHAR(3) NOT NULL,           
000011*       CODILING                       CHAR(1) NOT NULL,           
000012*       NOMPAESE                       CHAR(19) NOT NULL,          
000013*       SIGLAPAE                       CHAR(3) NOT NULL,           
000014*       DTCREAZI                       CHAR(8) NOT NULL,           
000015*       DTULTVAR                       CHAR(8) NOT NULL,           
000016*       CODUTVAR                       CHAR(6) NOT NULL            
000017*     ) END-EXEC
                                                                        
000018******************************************************************
000019* COBOL DECLARATION FOR TABLE DANAGRAF.TPAESLING                 *
000020******************************************************************
000021 01  DCLTPAESLING.                                                
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000022     10 A529-CODPAESE        PIC X(3).                            
000023     10 A529-CODILING        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000024     10 A529-NOMPAESE        PIC X(19).                           
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000025     10 A529-SIGLAPAE        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000026     10 A529-DTCREAZI        PIC X(8).                            
000027     10 A529-DTULTVAR        PIC X(8).                            
000028     10 A529-CODUTVAR        PIC X(6).                            
000029******************************************************************
000030* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 7       *
000031******************************************************************
      *<<((file: FDANA529))
000399*------------------------------> DANAGRAF.TSCAMBICEE              
000400 01  FILLER                      PIC X(8) VALUE 'FDANA497'.       
000403*    EXEC SQL                                                     
      *         INCLUDE FDANA497                                        
      *    END-EXEC.                                                    
      *>>((file: FDANA497))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TLINEAVEN                 *
000003******************************************************************
000004 01  DCLTLINEAVEN.                                                
000005*                       CODLINEA                                  
000006     10 A497-CODLINEA        PIC X(2).                            
000007*                       DESCLINE                                  
000008     10 A497-DESCLINE        PIC X(12).                           
000009*                       RAGLINEA                                  
000010     10 A497-RAGLINEA        PIC X(1).                            
000011*                       PROLOMER                                  
000012     10 A497-PROLOMER        PIC X(2).                            
000013*                       CODMARCH                                  
000014     10 A497-CODMARCH        PIC X(2).                            
000015*                       CENCOLIS                                  
000016     10 A497-CENCOLIS        PIC X(5).                            
000017*                       FLFAMFOR                                  
000018     10 A497-FLFAMFOR        PIC X(1).                            
000019*                       CATEARTI                                  
000020     10 A497-CATEARTI        PIC X(1).                            
000021*                       SLTIPLIN                                  
000022     10 A497-SLTIPLIN        PIC X(1).                            
000023*                       DTANNULL                                  
000024     10 A497-DTANNULL        PIC X(8).                            
000025*                       DTCREAZI                                  
000026     10 A497-DTCREAZI        PIC X(8).                            
000027*                       DTULTVAR                                  
000028     10 A497-DTULTVAR        PIC X(8).                            
000029*                       CODUTVAR                                  
000030     10 A497-CODUTVAR        PIC X(6).                            
000031*                       CODPAESE                                  
000032     10 A497-CODPAESE        PIC X(3).                            
000033*                       TIPOSTAG                                  
000034     10 A497-TIPOSTAG        PIC X(1).                            
000035*                       CODARTIC                                  
000036     10 A497-CODARTIC        PIC X(5).                            
000037*                       CENCOLI1                                  
000038     10 A497-CENCOLI1        PIC X(5).                            
000039*                       CENCOLI2                                  
000040     10 A497-CENCOLI2        PIC X(5).                            
000041*                       FLAGINKJ                                  
000042     10 A497-FLAGINKJ        PIC X(1).                            
000043     10 A497-CENCOLI3        PIC X(5).                            
000044     10 A497-CENCOLI4        PIC X(5).                            
000045     10 A497-CENCOLI5        PIC X(5).                            
000046******************************************************************
000047* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 22      *
000048******************************************************************
      *<<((file: FDANA497))
000404*------------------------------> DANAGRAF.TCONDIPAGADESC          
000405 01  FILLER                      PIC X(8) VALUE 'FDANA355'.       
000408*    EXEC SQL                                                     
      *         INCLUDE FDANA355                                        
      *    END-EXEC.                                                    
      *>>((file: FDANA355))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TCONDIPAGADESC)                          *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA355))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(A355-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DANAGRAF.TCONDIPAGADESC TABLE               
000012*     ( CONDPAGA                       CHAR(3) NOT NULL,           
000013*       CODILING                       CHAR(1) NOT NULL,           
000014*       DESCPAGA                       CHAR(60) NOT NULL,          
000015*       DTCREAZI                       CHAR(8) NOT NULL,           
000016*       DTULTVAR                       CHAR(8) NOT NULL,           
000017*       CODUTVAR                       CHAR(6) NOT NULL            
000018*     ) END-EXEC
                                                                        
000019******************************************************************
000020* COBOL DECLARATION FOR TABLE DANAGRAF.TCONDIPAGADESC            *
000021******************************************************************
000022 01  DCLTCONDIPAGADESC.                                           
000023*                       CONDPAGA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000024     10 A355-CONDPAGA        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025*                       CODILING                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000026     10 A355-CODILING        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000027*                       DESCPAGA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000028     10 A355-DESCPAGA        PIC X(60).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000029*                       DTCREAZI                                  
000030     10 A355-DTCREAZI        PIC X(8).                            
000031*                       DTULTVAR                                  
000032     10 A355-DTULTVAR        PIC X(8).                            
000033*                       CODUTVAR                                  
000034     10 A355-CODUTVAR        PIC X(6).                            
000035******************************************************************
000036* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 6       *
000037******************************************************************
      *<<((file: FDANA355))
000409*------------------------------> DANAGRAF.TCONDIPAGA              
000410 01  FILLER                      PIC X(8) VALUE 'FDANA840'.       
000413*    EXEC SQL                                                     
      *         INCLUDE FDANA840                                        
      *    END-EXEC.                                                    
      *>>((file: FDANA840))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TCONDIPAGA                *
000003******************************************************************
000004 01  DCLTCONDIPAGA.                                               
000005*                       CONDPAGA                                  
000006     10 A840-CONDPAGA        PIC X(3).                            
000007*                       ANNULLAM                                  
000008     10 A840-ANNULLAM        PIC X(1).                            
000009*                       TIPOPAGA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000010     10 A840-TIPOPAGA        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000011*                       NRGGSCA1                                  
000012     10 A840-NRGGSCA1        PIC S9(3)V USAGE COMP-3.             
000013*                       NRGGSCA2                                  
000014     10 A840-NRGGSCA2        PIC S9(3)V USAGE COMP-3.             
000015*                       NRGGSCA3                                  
000016     10 A840-NRGGSCA3        PIC S9(3)V USAGE COMP-3.             
000017*                       NRGGSCA4                                  
000018     10 A840-NRGGSCA4        PIC S9(3)V USAGE COMP-3.             
000019*                       PERCIMP1                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000020     10 A840-PERCIMP1        PIC S9(3)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000021*                       PERCIMP2                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000022     10 A840-PERCIMP2        PIC S9(3)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000023*                       PERCIMP3                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000024     10 A840-PERCIMP3        PIC S9(3)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025*                       PERCIMP4                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000026     10 A840-PERCIMP4        PIC S9(3)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000027*                       INICASCA                                  
000028     10 A840-INICASCA        PIC X(1).                            
000029*                       GGSCATR1                                  
000030     10 A840-GGSCATR1        PIC S9(2)V USAGE COMP-3.             
000031*                       GGSCATR2                                  
000032     10 A840-GGSCATR2        PIC S9(2)V USAGE COMP-3.             
000033*                       PERCSCON                                  
000034     10 A840-PERCSCON        PIC S9(3)V9(2) USAGE COMP-3.         
000035*                       SCONDEDO                                  
000036     10 A840-SCONDEDO        PIC X(1).                            
000037*                       DESCPAGI                                  
000038     10 A840-DESCPAGI        PIC X(60).                           
000039*                       DESCPAGJ                                  
000040     10 A840-DESCPAGJ        PIC X(60).                           
000041*                       DESCPAGF                                  
000042     10 A840-DESCPAGF        PIC X(60).                           
000043*                       DESCPAGD                                  
000044     10 A840-DESCPAGD        PIC X(60).                           
000045*                       DESCPAGE                                  
000046     10 A840-DESCPAGE        PIC X(60).                           
000047*                       NUMVOLTE                                  
000048     10 A840-NUMVOLTE        PIC S9(7)V USAGE COMP-3.             
000049*                       DTCREAZI                                  
000050     10 A840-DTCREAZI        PIC X(8).                            
000051*                       DTULTVAR                                  
000052     10 A840-DTULTVAR        PIC X(8).                            
000053*                       CODUTVAR                                  
000054     10 A840-CODUTVAR        PIC X(6).                            
000055*                       DESCPAGB                                  
000056     10 A840-DESCPAGB        PIC X(60).                           
000057*                       TIPODOCU                                  
000058     10 A840-TIPODOCU        PIC X(1).                            
000059*                       CDCPASCA                                  
000060     10 A840-CDCPASCA        PIC X(2).                            
000061*                       NRGGSCO1                                  
000062     10 A840-NRGGSCO1        PIC S9(3)V USAGE COMP-3.             
000063*                       PERCSCO1                                  
000064     10 A840-PERCSCO1        PIC S9(3)V9(2) USAGE COMP-3.         
000065*                       NRGGSCO2                                  
000066     10 A840-NRGGSCO2        PIC S9(3)V USAGE COMP-3.             
000067*                       PERCSCO2                                  
000068     10 A840-PERCSCO2        PIC S9(3)V9(2) USAGE COMP-3.         
000069*                       NRGGSCO3                                  
000070     10 A840-NRGGSCO3        PIC S9(3)V USAGE COMP-3.             
000071*                       PERCSCO3                                  
000072     10 A840-PERCSCO3        PIC S9(3)V9(2) USAGE COMP-3.         
000073*                       PERCBONU                                  
000074     10 A840-PERCBONU        PIC S9(3)V9(2) USAGE COMP-3.         
000075*                       CONDXASS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000076     10 A840-CONDXASS        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000077*                       CONDPGVB                                  
000078     10 A840-CONDPGVB        PIC X(2).                            
000079     10 A840-CDMODPA1        PIC X(4).                            
000080     10 A840-CDMODPA2        PIC X(4).                            
000081     10 A840-CDMODPA3        PIC X(4).                            
000082     10 A840-CDMODPA4        PIC X(4).                            
000083     10 A840-ACCONTO1        PIC X(1).                            
000084     10 A840-ACCONTO2        PIC X(1).                            
000085     10 A840-ACCONTO3        PIC X(1).                            
000086     10 A840-ACCONTO4        PIC X(1).                            
000087******************************************************************
000088* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 45      *
000089******************************************************************
      *<<((file: FDANA840))
000414*------------------------------> DANAGRAF.TCOMPLEDOC              
000415 01  FILLER                      PIC X(8) VALUE 'FDANA842'.       
000418*    EXEC SQL                                                     
      *         INCLUDE FDANA842                                        
      *    END-EXEC.                                                    
      *>>((file: FDANA842))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TCOMPLEDOC)                              *
000003*        LIBRARY(TEST.SOURCE.LIBTEST(FDANA842))                  *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        QUOTE                                                   *
000007* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000008******************************************************************
000009     
      *EXEC SQL DECLARE DANAGRAF.TCOMPLEDOC TABLE                   
000010*     ( CODSOCIE                       CHAR(2) NOT NULL,           
000011*       CODPAESE                       CHAR(3) NOT NULL,           
000012*       TIPODOCU                       CHAR(2) NOT NULL,           
000013*       TIPOMERC                       CHAR(1) NOT NULL,           
000014*       CODIRESA                       CHAR(1) NOT NULL,           
000015*       TIPSPEDI                       CHAR(1) NOT NULL,           
000016*       NUMPROG5                       DECIMAL(5, 0) NOT NULL,     
000017*       RIGADOCU                       CHAR(80) NOT NULL,          
000018*       FLFATMER                       CHAR(1) NOT NULL            
000019*     ) END-EXEC
                                                                        
000020******************************************************************
000021* COBOL DECLARATION FOR TABLE DANAGRAF.TCOMPLEDOC                *
000022******************************************************************
000023 01  DCLTCOMPLEDOC.                                               
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000024     10 A842-CODSOCIE        PIC X(2).                            
000025     10 A842-CODPAESE        PIC X(3).                            
000026     10 A842-TIPODOCU        PIC X(2).                            
000027     10 A842-TIPOMERC        PIC X(1).                            
000028     10 A842-CODIRESA        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000029     10 A842-TIPSPEDI        PIC X(1).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000030     10 A842-NUMPROG5        PIC S9(5)V USAGE COMP-3.             
000031     10 A842-RIGADOCU        PIC X(80).                           
000032     10 A842-FLFATMER        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000033******************************************************************
000034* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 9       *
000035******************************************************************
      *<<((file: FDANA842))
000419*------------------------------> DANAGRAF.TSCAMBICEE              
000420 01  FILLER                      PIC X(8) VALUE 'FDANA967'.       
000423*    EXEC SQL                                                     
      *         INCLUDE FDANA967                                        
      *    END-EXEC.                                                    
      *>>((file: FDANA967))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TSCAMBICEE)                              *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA967))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(A967-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DANAGRAF.TSCAMBICEE TABLE                   
000012*     ( FLACQVEN                       CHAR(1) NOT NULL,           
000013*       CODSOCIE                       CHAR(2) NOT NULL,           
000014*       CDMOVCON                       CHAR(1) NOT NULL,           
000015*       NRMOVCON                       CHAR(6) NOT NULL,           
000016*       DTREGMOV                       CHAR(8) NOT NULL,           
000017*       VOCEDOGA                       CHAR(8) NOT NULL,           
000018*       TRANSCEE                       CHAR(2) NOT NULL,           
000019*       CDIVACEE                       CHAR(14) NOT NULL,          
000020*       PAESMERC                       CHAR(3) NOT NULL,           
000021*       PAESPROV                       CHAR(3) NOT NULL,           
000022*       PAESORIG                       CHAR(3) NOT NULL,           
000023*       SIGLAPRO                       CHAR(2) NOT NULL,           
000024*       PROVORIG                       CHAR(2) NOT NULL,           
000025*       REGMSTAT                       CHAR(5) NOT NULL,           
000026*       TIPSPEDI                       CHAR(1) NOT NULL,           
000027*       KGVOCEDO                       DECIMAL(9, 2) NOT NULL,     
000028*       VLVOCEDO                       DECIMAL(11, 2) NOT NULL,    
000029*       CODDIVIS                       CHAR(2) NOT NULL,           
000030*       CODIRESA                       CHAR(1) NOT NULL,           
000031*       INCLIFOR                       CHAR(1) NOT NULL,           
000032*       CLIEFORN                       CHAR(5) NOT NULL,           
000033*       FLAGESTR                       CHAR(1) NOT NULL,           
000034*       DTCREAZI                       CHAR(8) NOT NULL,           
000035*       DTULTVAR                       CHAR(8) NOT NULL,           
000036*       CODUTVAR                       CHAR(6) NOT NULL,           
000037*       DESMECEE                       CHAR(30) NOT NULL,          
000038*       UNISUPPL                       DECIMAL(9, 2) NOT NULL,     
000039*       FLINTEST                       CHAR(1) NOT NULL,           
000040*       CVVOCEDO                       DECIMAL(11, 2) NOT NULL,    
000041*       CDENTDOG                       CHAR(4) NOT NULL,           
000042*       FLSERMER                       CHAR(1) NOT NULL,           
000043*       CDSERVIZ                       CHAR(6) NOT NULL            
000044*     ) END-EXEC
                                                                        
000045******************************************************************
000046* COBOL DECLARATION FOR TABLE DANAGRAF.TSCAMBICEE                *
000047******************************************************************
000048 01  DCLTSCAMBICEE.                                               
000049*                       FLACQVEN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000050     10 A967-FLACQVEN        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000051*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000052     10 A967-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000053*                       CDMOVCON                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000054     10 A967-CDMOVCON        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000055*                       NRMOVCON                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000056     10 A967-NRMOVCON        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000057*                       DTREGMOV                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000058     10 A967-DTREGMOV        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000059*                       VOCEDOGA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000060     10 A967-VOCEDOGA        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000061*                       TRANSCEE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000062     10 A967-TRANSCEE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000063*                       CDIVACEE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000064     10 A967-CDIVACEE        PIC X(14).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000065*                       PAESMERC                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000066     10 A967-PAESMERC        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000067*                       PAESPROV                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000068     10 A967-PAESPROV        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000069*                       PAESORIG                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000070     10 A967-PAESORIG        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000071*                       SIGLAPRO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000072     10 A967-SIGLAPRO        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000073*                       PROVORIG                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000074     10 A967-PROVORIG        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000075*                       REGMSTAT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000076     10 A967-REGMSTAT        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000077*                       TIPSPEDI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000078     10 A967-TIPSPEDI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000079*                       KGVOCEDO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000080     10 A967-KGVOCEDO        PIC S9(7)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000081*                       VLVOCEDO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000082     10 A967-VLVOCEDO        PIC S9(9)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000083*                       CODDIVIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000084     10 A967-CODDIVIS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000085*                       CODIRESA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000086     10 A967-CODIRESA        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000087*                       INCLIFOR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000088     10 A967-INCLIFOR        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000089*                       CLIEFORN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000090     10 A967-CLIEFORN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000091*                       FLAGESTR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000092     10 A967-FLAGESTR        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000093*                       DTCREAZI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000094     10 A967-DTCREAZI        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000095*                       DTULTVAR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000096     10 A967-DTULTVAR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000097*                       CODUTVAR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000098     10 A967-CODUTVAR        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000099*                       DESMECEE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000100     10 A967-DESMECEE        PIC X(30).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000101*                       UNISUPPL                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000102     10 A967-UNISUPPL        PIC S9(7)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000103*                       FLINTEST                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000104     10 A967-FLINTEST        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000105*                       CVVOCEDO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000106     10 A967-CVVOCEDO        PIC S9(9)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000107*                       CDENTDOG                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000108     10 A967-CDENTDOG        PIC X(4).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000109*                       FLSERMER                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000110     10 A967-FLSERMER        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000111*                       CDSERVIZ                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000112     10 A967-CDSERVIZ        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000113******************************************************************
000114* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 32      *
000115******************************************************************
      *<<((file: FDANA967))
000424                                                                  
000425*------------------------------> DANAGRAF.TEMPITRANS              
000426 01  FILLER                      PIC X(8) VALUE 'FDANA839'.       
000429*    EXEC SQL                                                     
      *         INCLUDE FDANA839                                        
      *    END-EXEC.                                                    
      *>>((file: FDANA839))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TTEMPITRANS)                             *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA839))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(A839-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DANAGRAF.TTEMPITRANS TABLE                  
000012*     ( CODUTENT                       CHAR(6) NOT NULL,           
000013*       CODITRAN                       CHAR(4) NOT NULL,           
000014*       CODIFUNZ                       CHAR(2) NOT NULL,           
000015*       INILAVOR                       CHAR(4) NOT NULL,           
000016*       CODSOCIE                       CHAR(2) NOT NULL,           
000017*       CODDEPOS                       CHAR(2) NOT NULL,           
000018*       NOTENOTE                       CHAR(60) NOT NULL,          
000019*       NOTENOT1                       CHAR(200) NOT NULL,         
000020*       FILLA200                       CHAR(200) NOT NULL,         
000021*       FILLB200                       CHAR(200) NOT NULL,         
000022*       FILLC200                       CHAR(200) NOT NULL,         
000023*       FILLD200                       CHAR(200) NOT NULL,         
000024*       FILLE200                       CHAR(200) NOT NULL,         
000025*       FILLF200                       CHAR(200) NOT NULL,         
000026*       FILLG200                       CHAR(200) NOT NULL,         
000027*       FILLH200                       CHAR(200) NOT NULL,         
000028*       FILLI200                       CHAR(200) NOT NULL,         
000029*       FILLJ200                       CHAR(200) NOT NULL,         
000030*       FILLK200                       CHAR(200) NOT NULL,         
000031*       FILLL200                       CHAR(200) NOT NULL,         
000032*       FILLM200                       CHAR(200) NOT NULL,         
000033*       FILLN200                       CHAR(200) NOT NULL,         
000034*       FILLO200                       CHAR(200) NOT NULL,         
000035*       DTCREAZI                       CHAR(8) NOT NULL            
000036*     ) END-EXEC
                                                                        
000037******************************************************************
000038* COBOL DECLARATION FOR TABLE DANAGRAF.TTEMPITRANS               *
000039******************************************************************
000040 01  DCLTTEMPITRANS.                                              
000041*                       CODUTENT                                  
000042     10 A839-CODUTENT        PIC X(6).                            
000043*                       CODITRAN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000044     10 A839-CODITRAN        PIC X(4).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000045*                       CODIFUNZ                                  
000046     10 A839-CODIFUNZ        PIC X(2).                            
000047*                       INILAVOR                                  
000048     10 A839-INILAVOR        PIC X(4).                            
000049*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000050     10 A839-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000051*                       CODDEPOS                                  
000052     10 A839-CODDEPOS        PIC X(2).                            
000053*                       NOTENOTE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000054     10 A839-NOTENOTE        PIC X(60).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000055*                       NOTENOT1                                  
000056     10 A839-NOTENOT1        PIC X(200).                          
000057*                       FILLA200                                  
000058     10 A839-FILLA200        PIC X(200).                          
000059*                       FILLB200                                  
000060     10 A839-FILLB200        PIC X(200).                          
000061*                       FILLC200                                  
000062     10 A839-FILLC200        PIC X(200).                          
000063*                       FILLD200                                  
000064     10 A839-FILLD200        PIC X(200).                          
000065*                       FILLE200                                  
000066     10 A839-FILLE200        PIC X(200).                          
000067*                       FILLF200                                  
000068     10 A839-FILLF200        PIC X(200).                          
000069*                       FILLG200                                  
000070     10 A839-FILLG200        PIC X(200).                          
000071*                       FILLH200                                  
000072     10 A839-FILLH200        PIC X(200).                          
000073*                       FILLI200                                  
000074     10 A839-FILLI200        PIC X(200).                          
000075*                       FILLJ200                                  
000076     10 A839-FILLJ200        PIC X(200).                          
000077*                       FILLK200                                  
000078     10 A839-FILLK200        PIC X(200).                          
000079*                       FILLL200                                  
000080     10 A839-FILLL200        PIC X(200).                          
000081*                       FILLM200                                  
000082     10 A839-FILLM200        PIC X(200).                          
000083*                       FILLN200                                  
000084     10 A839-FILLN200        PIC X(200).                          
000085*                       FILLO200                                  
000086     10 A839-FILLO200        PIC X(200).                          
000087*                       DTCREAZI                                  
000088     10 A839-DTCREAZI        PIC X(8).                            
000089******************************************************************
000090* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 24      *
000091******************************************************************
      *<<((file: FDANA839))
000430*------------------------------> DANAGRAF.TCLIENTI                
000431 01  FILLER                      PIC X(8) VALUE 'FDANA901'.       
000434*    EXEC SQL                                                     
      *         INCLUDE FDANA901                                        
      *    END-EXEC.                                                    
      *>>((file: FDANA901))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TCLIENTI                  *
000003******************************************************************
000004 01  DCLTCLIENTI.                                                 
000005*                       CODCLIEN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006     10 A901-CODCLIEN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007*                       STATCLIE                                  
000008     10 A901-STATCLIE        PIC X(1).                            
000009*                       GENECLIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000010     10 A901-GENECLIE        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000011*                       TIPOCLIE                                  
000012     10 A901-TIPOCLIE        PIC X(1).                            
000013*                       TIPOCONS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000014     10 A901-TIPOCONS        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000015*                       CLIFOCON                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000016     10 A901-CLIFOCON        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000017*                       CODSOCIE                                  
000018     10 A901-CODSOCIE        PIC X(2).                            
000019*                       CAPOCONT                                  
000020     10 A901-CAPOCONT        PIC X(5).                            
000021*                       CODFISCA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000022     10 A901-CODFISCA        PIC X(16).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000023*                       ESENTIVA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000024     10 A901-ESENTIVA        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025*                       NUMESIVA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000026     10 A901-NUMESIVA        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000027*                       DATESIVA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000028     10 A901-DATESIVA        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000029*                       UFFICIVA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000030     10 A901-UFFICIVA        PIC X(18).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000031*                       IMPESIVA                                  
000032     10 A901-IMPESIVA        PIC S9(4)V USAGE COMP-3.             
000033*                       BANCAPPO                                  
000034     10 A901-BANCAPPO        PIC X(3).                            
000035*                       NOMBANCL                                  
000036     10 A901-NOMBANCL        PIC X(114).                          
000037*                       CONTOCOR                                  
000038     10 A901-CONTOCOR        PIC X(13).                           
000039*                       ASSOBANC                                  
000040     10 A901-ASSOBANC        PIC X(5).                            
000041*                       AVVIBANC                                  
000042     10 A901-AVVIBANC        PIC X(5).                            
000043*                       CLIEFATT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000044     10 A901-CLIEFATT        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000045*                       PAESFATT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000046     10 A901-PAESFATT        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000047*                       RAGFATTU                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000048     10 A901-RAGFATTU        PIC X(24).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000049*                       ESRAGFAT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000050     10 A901-ESRAGFAT        PIC X(24).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000051*                       INDFATTU                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000052     10 A901-INDFATTU        PIC X(24).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000053*                       ESINDFAT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000054     10 A901-ESINDFAT        PIC X(24).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000055*                       CITFATTU                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000056     10 A901-CITFATTU        PIC X(18).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000057*                       ESCITFAT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000058     10 A901-ESCITFAT        PIC X(18).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000059*                       CAPFATTU                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000060     10 A901-CAPFATTU        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000061*                       PAESMERC                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000062     10 A901-PAESMERC        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000063*                       RAGMERCE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000064     10 A901-RAGMERCE        PIC X(24).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000065*                       ESRAGMER                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000066     10 A901-ESRAGMER        PIC X(24).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000067*                       INDMERCE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000068     10 A901-INDMERCE        PIC X(24).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000069*                       ESINDMER                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000070     10 A901-ESINDMER        PIC X(24).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000071*                       CITMERCE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000072     10 A901-CITMERCE        PIC X(18).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000073*                       ESCITMER                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000074     10 A901-ESCITMER        PIC X(18).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000075*                       CAPMERCE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000076     10 A901-CAPMERCE        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000077*                       ZONAMERC                                  
000078     10 A901-ZONAMERC        PIC X(2).                            
000079*                       TELCLIEN                                  
000080     10 A901-TELCLIEN        PIC X(20).                           
000081*                       TLXCLIEN                                  
000082     10 A901-TLXCLIEN        PIC X(20).                           
000083*                       FAXCLIEN                                  
000084     10 A901-FAXCLIEN        PIC X(20).                           
000085*                       RIFEMIRO                                  
000086     10 A901-RIFEMIRO        PIC X(11).                           
000087*                       PAESORDI                                  
000088     10 A901-PAESORDI        PIC X(3).                            
000089*                       ZONAORDI                                  
000090     10 A901-ZONAORDI        PIC X(2).                            
000091*                       DATVASTA                                  
000092     10 A901-DATVASTA        PIC X(8).                            
000093*                       ATTENZDI                                  
000094     10 A901-ATTENZDI        PIC X(24).                           
000095*                       CONDPAGA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000096     10 A901-CONDPAGA        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000097*                       MMESCLU1                                  
000098     10 A901-MMESCLU1        PIC S9(2)V USAGE COMP-3.             
000099*                       MMESCLU2                                  
000100     10 A901-MMESCLU2        PIC S9(2)V USAGE COMP-3.             
000101*                       GGSCATRA                                  
000102     10 A901-GGSCATRA        PIC S9(2)V USAGE COMP-3.             
000103*                       NUMGGVIA                                  
000104     10 A901-NUMGGVIA        PIC S9(2)V USAGE COMP-3.             
000105*                       TIPOTRAT                                  
000106     10 A901-TIPOTRAT        PIC X(1).                            
000107*                       ALTERSPE                                  
000108     10 A901-ALTERSPE        PIC X(1).                            
000109*                       CODILING                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000110     10 A901-CODILING        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000111*                       DTULTVAR                                  
000112     10 A901-DTULTVAR        PIC X(8).                            
000113*                       TIPCLCAR                                  
000114     10 A901-TIPCLCAR        PIC X(1).                            
000115*                       SPETRASP                                  
000116     10 A901-SPETRASP        PIC X(1).                            
000117*                       DTCREAZI                                  
000118     10 A901-DTCREAZI        PIC X(8).                            
000119*                       CODDIVIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000120     10 A901-CODDIVIS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000121*                       CDIVACEE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000122     10 A901-CDIVACEE        PIC X(14).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000123*                       ZONAFATT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000124     10 A901-ZONAFATT        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000125*                       CLASDOGA                                  
000126     10 A901-CLASDOGA        PIC X(1).                            
000127*                       INTNCLIE                                  
000128     10 A901-INTNCLIE        PIC X(50).                           
000129*                       CAPOCOMM                                  
000130     10 A901-CAPOCOMM        PIC X(5).                            
000131*                       PRIORITA                                  
000132     10 A901-PRIORITA        PIC X(1).                            
000133*                       BULSTATX                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000134     10 A901-BULSTATX        PIC X(13).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000135*                       CODUTVAR                                  
000136     10 A901-CODUTVAR        PIC X(6).                            
000137*                       CODUTCRE                                  
000138     10 A901-CODUTCRE        PIC X(6).                            
000139*                       CDRESCON                                  
000140     10 A901-CDRESCON        PIC X(2).                            
000141*                       CENCOACQ                                  
000142     10 A901-CENCOACQ        PIC X(5).                            
000143*                       CAPOSOCI                                  
000144     10 A901-CAPOSOCI        PIC X(5).                            
000145*                       CDFISCAL                                  
000146     10 A901-CDFISCAL        PIC X(16).                           
000147*                       CONDPACA                                  
000148     10 A901-CONDPACA        PIC X(3).                            
000149*                       CODXIBAN                                  
000150     10 A901-CODXIBAN        PIC X(4).                            
000151*                       CODXXCIN                                  
000152     10 A901-CODXXCIN        PIC X(2).                            
000153*                       ZIPFATTU                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000154     10 A901-ZIPFATTU        PIC X(15).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000155*                       ZIPMERCE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000156     10 A901-ZIPMERCE        PIC X(15).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000157*                       TIPOLIST                                  
000158     10 A901-TIPOLIST        PIC X(1).                            
000159*                       SWIFTCOD                                  
000160     10 A901-SWIFTCOD        PIC X(11).                           
000161*                       PERCEIVA                                  
000162     10 A901-PERCEIVA        PIC S9(3)V9(2) USAGE COMP-3.         
000163*                       DTVALIVA                                  
000164     10 A901-DTVALIVA        PIC X(8).                            
000165*                       CLASSCLI                                  
000166     10 A901-CLASSCLI        PIC X(1).                            
000167*                       RATINGCO                                  
000168     10 A901-RATINGCO        PIC X(3).                            
000169*                       RISCHCLI                                  
000170     10 A901-RISCHCLI        PIC X(1).                            
000171*                                                                 
000172     10 A901-NRPROIVA        PIC X(30).                           
000173*                                                                 
000174     10 A901-IMPESNEW        PIC S9(9)V9(2) USAGE COMP-3.         
000175     10 A901-TIPOSTAG        PIC X(1).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000176     10 A901-FLFATELE        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000177     10 A901-CDDESTFE        PIC X(7).                            
000178     10 A901-INPECCLI        PIC X(50).                           
000179******************************************************************
000180* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 88      *
000181******************************************************************
      *<<((file: FDANA901))
000435*------------------------------> DANAGRAF.TDIVISE                 
000436 01  FILLER                      PIC X(8) VALUE 'FDANA963'.       
000439*    EXEC SQL                                                     
      *         INCLUDE FDANA963                                        
      *    END-EXEC.                                                    
      *>>((file: FDANA963))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TDIVISE                   *
000003******************************************************************
000004 01  DCLTDIVISE.                                                  
000005*                       SIGLADIV                                  
000006     10 A963-SIGLADIV        PIC X(3).                            
000007*                       CAMBIODV                                  
000008     10 A963-CAMBIODV        PIC S9(5)V9(6) USAGE COMP-3.         
000009*                       DESCDIVI                                  
000010     10 A963-DESCDIVI        PIC X(20).                           
000011*                       CODDIVIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000012     10 A963-CODDIVIS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000013*                       DECIDIVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000014     10 A963-DECIDIVI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000015*                       DIVIBANC                                  
000016     10 A963-DIVIBANC        PIC X(3).                            
000017*                       DIVIPREZ                                  
000018     10 A963-DIVIPREZ        PIC X(1).                            
000019*                       CODDIVRI                                  
000020     10 A963-CODDIVRI        PIC X(2).                            
000021*                       RAPPCAMB                                  
000022     10 A963-RAPPCAMB        PIC S9(5)V USAGE COMP-3.             
000023*                       CODDIGTM                                  
000024     10 A963-CODDIGTM        PIC X(2).                            
000025*                       FLAGEURO                                  
000026     10 A963-FLAGEURO        PIC X(1).                            
000027*                       SLDIVBAN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000028     10 A963-SLDIVBAN        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000029*                       CDDIVSCA                                  
000030     10 A963-CDDIVSCA        PIC X(2).                            
000031*                       FLDIVINT                                  
000032     10 A963-FLDIVINT        PIC X(1).                            
000033     10 A963-VBDIVSCA        PIC X(2).                            
000034******************************************************************
000035* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 15      *
000036******************************************************************
      *<<((file: FDANA963))
000440*------------------------------> DCONTCLI.TRIGHEDOCU              
000441 01  FILLER                      PIC X(8) VALUE 'FDCLI805'.       
000444*    EXEC SQL                                                     
      *         INCLUDE FDCLI805                                        
      *    END-EXEC.                                                    
      *>>((file: FDCLI805))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DCONTCLI.TRIGHEDOCU                *
000003******************************************************************
000004 01  DCLTRIGHEDOCU.                                               
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 C805-CODSOCIE        PIC X(2).                            
000006     10 C805-CDMOVCON        PIC X(1).                            
000007     10 C805-NRMOVCON        PIC X(6).                            
000008     10 C805-DTREGMOV        PIC X(8).                            
000009     10 C805-TIRIGFAT        PIC X(2).                            
000010     10 C805-NRTIRIFA        PIC X(5).                            
000011     10 C805-RIGAFATT        PIC X(91).                           
000012     10 C805-DTCREAZI        PIC X(8).                            
000013     10 C805-DTULTVAR        PIC X(8).                            
000014     10 C805-CODUTVAR        PIC X(6).                            
000015     10 C805-TIPORIGA        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000016******************************************************************
000017* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 11      *
000018******************************************************************
      *<<((file: FDCLI805))
000445*------------------------------> DCONTCLI.TCONTIDCE               
000446 01  FILLER                      PIC X(8) VALUE 'FDCLI861'.       
000449*    EXEC SQL                                                     
      *         INCLUDE FDCLI861                                        
      *    END-EXEC.                                                    
      *>>((file: FDCLI861))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DCONTCLI.TCONTIDCE                 *
000003******************************************************************
000004 01  DCLTCONTIDCE.                                                
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 C861-CONTODCE        PIC X(6).                            
000006     10 C861-CODPIANO        PIC X(2).                            
000007     10 C861-CONTPROV        PIC X(6).                            
000008     10 C861-DESCRDCE        PIC X(25).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000009     10 C861-ANNULLAM        PIC X(1).                            
000010     10 C861-TIPCONTO        PIC X(2).                            
000011     10 C861-CONTGRUP        PIC X(6).                            
000012     10 C861-NOTECON1        PIC X(33).                           
000013     10 C861-NOTECON2        PIC X(33).                           
000014     10 C861-INDBILQU        PIC X(1).                            
000015     10 C861-FLCOMMES        PIC X(1).                            
000016******************************************************************
000017* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 11 C861- 
000018******************************************************************
      *<<((file: FDCLI861))
000450*------------------------------> DLOGISTI.TSERVIZI                
000451 01  FILLER                      PIC X(8) VALUE 'FDLOG651'.       
000454*    EXEC SQL                                                     
      *         INCLUDE FDLOG651                                        
      *    END-EXEC.                                                    
      *>>((file: FDLOG651))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TSERVIZI                  *
000003******************************************************************
000004 01  DCLTSERVIZI.                                                 
000005*                       CODSERVI                                  
000006     10 L651-CODSERVI        PIC X(6).                            
000007*                       DESSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000008     10 L651-DESSERVI        PIC X(40).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000009*                       UNMISURA                                  
000010     10 L651-UNMISURA        PIC X(2).                            
000011*                       TIPSERVI                                  
000012     10 L651-TIPSERVI        PIC X(1).                            
000013*                       DTCREAZI                                  
000014     10 L651-DTCREAZI        PIC X(8).                            
000015*                       DTULTVAR                                  
000016     10 L651-DTULTVAR        PIC X(8).                            
000017*                       CODUTVAR                                  
000018     10 L651-CODUTVAR        PIC X(6).                            
000019*                       CONTODCD                                  
000020     10 L651-CONTODCD        PIC X(6).                            
000021*                       CONTODCA                                  
000022     10 L651-CONTODCA        PIC X(6).                            
000023*                       CENCOSTA                                  
000024     10 L651-CENCOSTA        PIC X(5).                            
000025     10 L651-ESENTIVA        PIC X(1).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000026     10 L651-CONTPROV        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000027******************************************************************
000028* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 12      *
000029******************************************************************
      *<<((file: FDLOG651))
000455*------------------------------> DLOGISTI.TORDILOGI               
000456 01  FILLER                      PIC X(8) VALUE 'FDLOG652'.       
000459*    EXEC SQL                                                     
      *         INCLUDE FDLOG652                                        
      *    END-EXEC.                                                    
      *>>((file: FDLOG652))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TORDILOGI                 *
000003******************************************************************
000004 01  DCLTORDILOGI.                                                
000005*                       AANUMORD                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006     10 L652-AANUMORD        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007*                       CODCLIEN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000008     10 L652-CODCLIEN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000009*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000010     10 L652-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000011*                       CDDIVISI                                  
000012     10 L652-CDDIVISI        PIC X(1).                            
000013*                       DTCARORD                                  
000014     10 L652-DTCARORD        PIC X(8).                            
000015*                       CODDIVIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000016     10 L652-CODDIVIS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000017*                       TIPSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000018     10 L652-TIPSERVI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000019*                       FLAGAUTO                                  
000020     10 L652-FLAGAUTO        PIC X(1).                            
000021*                       FLAGGIVA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000022     10 L652-FLAGGIVA        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000023*                       CONTODCE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000024     10 L652-CONTODCE        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025*                       DTEVAORD                                  
000026     10 L652-DTEVAORD        PIC X(8).                            
000027*                       AANUMFAT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000028     10 L652-AANUMFAT        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000029*                       DTFATTUR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000030     10 L652-DTFATTUR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000031*                       NRPREATT                                  
000032     10 L652-NRPREATT        PIC X(10).                           
000033*                       DTPREATT                                  
000034     10 L652-DTPREATT        PIC X(8).                            
000035*                       DTCREAZI                                  
000036     10 L652-DTCREAZI        PIC X(8).                            
000037*                       DTULTVAR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000038     10 L652-DTULTVAR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000039*                       CODUTVAR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000040     10 L652-CODUTVAR        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000041*                       DTANNULL                                  
000042     10 L652-DTANNULL        PIC X(8).                            
000043*                       SOCIEMER                                  
000044     10 L652-SOCIEMER        PIC X(2).                            
000045*                       DATAESTR                                  
000046     10 L652-DATAESTR        PIC X(8).                            
000047*                       AAMMCOMP                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000048     10 L652-AAMMCOMP        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000049*                       FLAGSOSP                                  
000050     10 L652-FLAGSOSP        PIC X(1).                            
000051*                       CODUTEVB                                  
000052     10 L652-CODUTEVB        PIC X(6).                            
000053*                       ESENTIVA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000054     10 L652-ESENTIVA        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000055*                       FLORDIVB                                  
000056     10 L652-FLORDIVB        PIC X(1).                            
000057******************************************************************
000058* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 26      *
000059******************************************************************
      *<<((file: FDLOG652))
000460*------------------------------> DLOGISTI.TRIGORDILOGI            
000461 01  FILLER                      PIC X(8) VALUE 'FDLOG653'.       
000464*    EXEC SQL                                                     
      *         INCLUDE FDLOG653                                        
      *    END-EXEC.                                                    
      *>>((file: FDLOG653))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TRIGORDILOGI              *
000003******************************************************************
000004 01  DCLTRIGORDILOGI.                                             
000005     10 L653-AANUMORD        PIC X(8).                            
000006     10 L653-NRRIGORD        PIC S9(5)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000007     10 L653-CODSERVI        PIC X(6).                            
000008     10 L653-UNMISURA        PIC X(2).                            
000009     10 L653-QTAORDIN        PIC S9(7)V9(2) USAGE COMP-3.         
000010     10 L653-PREZZORD        PIC S9(7)V9(4) USAGE COMP-3.         
000011     10 L653-IMPORDIN        PIC S9(11)V9(2) USAGE COMP-3.        
000012     10 L653-NOTENOTE        PIC X(40).                           
000013     10 L653-CENCOSTD        PIC X(5).                            
000014     10 L653-CENCOSTA        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000015     10 L653-RIFECLIE        PIC X(15).                           
000016     10 L653-DTCREAZI        PIC X(8).                            
000017     10 L653-DTULTVAR        PIC X(8).                            
000018     10 L653-CODUTVAR        PIC X(6).                            
000019     10 L653-DTANNULL        PIC X(8).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000020     10 L653-IMPORIVA        PIC S9(11)V9(2) USAGE COMP-3.        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000021******************************************************************
000022* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 16      *
000023******************************************************************
      *<<((file: FDLOG653))
000465*------------------------------> DLOGISTI.TDETTORDILOGI           
000466 01  FILLER                      PIC X(8) VALUE 'FDLOG655'.       
000469*    EXEC SQL                                                     
      *         INCLUDE FDLOG655                                        
      *    END-EXEC.                                                    
      *>>((file: FDLOG655))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TDETTORDILOGI             *
000003******************************************************************
000004 01  DCLTDETTORDILOGI.                                            
000005     10 L655-AANUMORD        PIC X(8).                            
000006     10 L655-NRRIGORD        PIC S9(5)V USAGE COMP-3.             
000007     10 L655-NUMPROG7        PIC S9(7)V USAGE COMP-3.             
000008     10 L655-CDMCAGTM        PIC X(1).                            
000009     10 L655-CDAREGTM        PIC X(2).                            
000010     10 L655-CDDIPGTM        PIC X(1).                            
000011     10 L655-TIPOADDE        PIC X(2).                            
000012     10 L655-KEYADDE1        PIC X(5).                            
000013     10 L655-KEYADDE2        PIC X(3).                            
000014     10 L655-KEYADDE3        PIC X(3).                            
000015     10 L655-KEYADDE4        PIC X(5).                            
000016     10 L655-CODSOCID        PIC X(2).                            
000017     10 L655-CDDIVISD        PIC X(1).                            
000018     10 L655-CENCOSTD        PIC X(5).                            
000019     10 L655-CONTODCD        PIC X(6).                            
000020     10 L655-CODSOCIA        PIC X(2).                            
000021     10 L655-CDDIVISA        PIC X(1).                            
000022     10 L655-CENCOSTA        PIC X(5).                            
000023     10 L655-CONTODCA        PIC X(6).                            
000024     10 L655-UNMISURA        PIC X(2).                            
000025     10 L655-QTAORDIN        PIC S9(7)V9(2) USAGE COMP-3.         
000026     10 L655-IMPORDIN        PIC S9(11)V9(2) USAGE COMP-3.        
000027     10 L655-CODSOCIE        PIC X(2).                            
000028     10 L655-AANUMFAT        PIC X(8).                            
000029     10 L655-CENCOSTO        PIC X(5).                            
000030     10 L655-SOCIEMER        PIC X(2).                            
000031     10 L655-PROLOMER        PIC X(2).                            
000032     10 L655-CODLINEA        PIC X(2).                            
000033     10 L655-TIPOARTI        PIC X(1).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000034     10 L655-MERCEMAG        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000035     10 L655-CODARTIC        PIC X(5).                            
000036     10 L655-CODDISEG        PIC X(5).                            
000037     10 L655-CODVARIA        PIC X(3).                            
000038     10 L655-STAGIONE        PIC X(2).                            
000039     10 L655-CAUSAMOV        PIC X(2).                            
000040     10 L655-CLIEFORN        PIC X(5).                            
000041     10 L655-INCLIFOR        PIC X(1).                            
000042     10 L655-STABILIM        PIC X(2).                            
000043     10 L655-NRDISPOS        PIC X(6).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000044     10 L655-SIGLCICL        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000045     10 L655-TIPOAPPA        PIC X(1).                            
000046     10 L655-AANRRECL        PIC X(8).                            
000047     10 L655-NUMERIFE        PIC X(5).                            
000048     10 L655-FLTAGSCA        PIC X(1).                            
000049     10 L655-CAUSACON        PIC X(1).                            
000050     10 L655-QUALIFIN        PIC X(4).                            
000051     10 L655-QTAMTMOV        PIC S9(7)V9(2) USAGE COMP-3.         
000052     10 L655-QTAKGMOV        PIC S9(7)V9(2) USAGE COMP-3.         
000053     10 L655-DTCREAZI        PIC X(8).                            
000054     10 L655-DTULTVAR        PIC X(8).                            
000055     10 L655-CODUTVAR        PIC X(6).                            
000056     10 L655-IMPTRPAG        PIC S9(7)V9(2) USAGE COMP-3.         
000057     10 L655-PAESMERC        PIC X(3).                            
000058     10 L655-TIPORECO        PIC X(4).                            
000059     10 L655-DTFATTUR        PIC X(8).                            
000060     10 L655-TIPOSTAG        PIC X(1).                            
000061     10 L655-MTDISPOS        PIC S9(7)       COMP-3.              
000062     10 L655-PERC2SCE        PIC S9(2)V9     COMP-3.              
000063     10 L655-MTDIFMAX        PIC S9(7)V99    COMP-3.              
000064     10 L655-MTDIFTOT        PIC S9(7)V99    COMP-3.              
000065     10 L655-MTDIFMES        PIC S9(7)V99    COMP-3.              
000066     10 L655-PARTLAVO        PIC X(6).                            
000067     10 L655-MTDISPAR        PIC S9(7)       COMP-3.              
000068     10 L655-SERIECIL        PIC X(2).                            
000069     10 L655-TPLAVMES        PIC X(1).                            
000070     10 L655-FLAGRICH        PIC X(1).                            
000071     10 L655-NRCILLAV        PIC S9(3)       COMP-3.              
000072     10 L655-SLLAVMES        PIC X(2).                            
000073     10 L655-MTMATEFF        PIC S9(7)V99    COMP-3.              
000074     10 L655-MTCONSUM        PIC S9(7)V99    COMP-3.              
000075     10 L655-QTORDPRE        PIC S9(7)V99    COMP-3.              
000076     10 L655-PREZZORD        PIC S9(7)V9(4)  COMP-3.              
000077     10 L655-CODFORVI        PIC X(5).                            
000078     10 L655-CODIMBAL        PIC X(2).                            
000079     10 L655-CODCOLLO        PIC X(5).                            
000080     10 L655-MTRAGDIS        PIC S9(7) COMP-3.                    
000081     10 L655-NUMDISTI        PIC X(6).                            
000082******************************************************************
000083* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 77      *
000084******************************************************************
      *<<((file: FDLOG655))
000470*------------------------------> DLOGISTI.TNOTEORDILOGI           
000471 01  FILLER                      PIC X(8) VALUE 'FDLOG656'.       
000474*    EXEC SQL                                                     
      *         INCLUDE FDLOG656                                        
      *    END-EXEC.                                                    
      *>>((file: FDLOG656))
000001******************************************************************
000002* DCLGEN TABLE(DLOGISTI.TNOTEORDILOGI)                           *
000003******************************************************************
000004 01  DCLTNOTEORDILOGI.                                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 L656-AANUMORD        PIC X(08).                           
000006     10 L656-TINOTORD        PIC X(1).                            
000007     10 L656-NUMPROG3        PIC S9(3)V USAGE COMP-3.             
000008     10 L656-NOTEORDI        PIC X(78).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000009     10 L656-DTCREAZI        PIC X(8).                            
000010     10 L656-DTULTVAR        PIC X(8).                            
000011     10 L656-CODUTVAR        PIC X(6).                            
000012******************************************************************
000013* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 7       *
000014******************************************************************
      *<<((file: FDLOG656))
000475*------------------------------> DLOGISTI.TRIFORDILOGI            
000476 01  FILLER                      PIC X(8) VALUE 'FDLOG430'.       
000479*    EXEC SQL                                                     
      *         INCLUDE FDLOG430                                        
      *    END-EXEC.                                                    
      *>>((file: FDLOG430))
000001******************************************************************
000002* DCLGEN TABLE(DLOGISTI.TRIFORDILOGI)                            *
000003******************************************************************
000004 01  DCLTRIFORDILOGI.                                             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 L430-AANUMORD        PIC X(08).                           
000006     10 L430-NUMPROG3        PIC S9(3)V USAGE COMP-3.             
000007     10 L430-RIFORDIN        PIC X(10).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000008     10 L430-DTCREAZI        PIC X(8).                            
000009     10 L430-DTULTVAR        PIC X(8).                            
000010     10 L430-CODUTVAR        PIC X(6).                            
000011******************************************************************
      *<<((file: FDLOG430))
000480*------------------------------> DFATTURE.TRIGHEPACARKI           
000481 01  FILLER                      PIC X(8) VALUE 'FDFAT760'.       
000484*    EXEC SQL                                                     
      *         INCLUDE FDFAT760                                        
      *    END-EXEC.                                                    
      *>>((file: FDFAT760))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DFATTURE.TRIGHEPACARKI             *
000003******************************************************************
000004 01  DCLTRIGHEPACARKI.                                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 F760-CODSOCIE        PIC X(2).                            
000006     10 F760-AANUMFAT        PIC X(8).                            
000007     10 F760-TIRIGPAK        PIC X(2).                            
000008     10 F760-NRTIRIPA        PIC X(5).                            
000009     10 F760-RIGAPACK        PIC X(77).                           
000010     10 F760-TIPOFATT        PIC X(1).                            
000011     10 F760-QUALIFIN        PIC X(4).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000012     10 F760-NRPZGREG        PIC X(10).                           
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000013     10 F760-DTFATTUR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000014******************************************************************
000015* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 9       *
000016******************************************************************
      *<<((file: FDFAT760))
000485*------------------------------> DCONTCLI.TSOLLECITI('SRESEN0')   
000486 01  FILLER                      PIC X(8) VALUE 'FDCLI865'.       
000489*    EXEC SQL                                                     
      *        INCLUDE FDCLI865                                         
      *    END-EXEC.                                                    
      *>>((file: FDCLI865))
000001******************************************************************
000002* DCLGEN TABLE(DCONTCLI.TSOLLECITI)                              *
000003*        LIBRARY(TESTPO.LIB.DSECT(FDCLI865))                     *
000004*        QUOTE                                                   *
000005* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000006******************************************************************
000007     
      *EXEC SQL DECLARE DCONTCLI.TSOLLECITI TABLE                   
000008*     ( CODSOCIE                       CHAR(2) NOT NULL,           
000009*       GRUPSOLL                       CHAR(1) NOT NULL,           
000010*       TIPOSOLL                       CHAR(1) NOT NULL,           
000011*       CODILING                       CHAR(1) NOT NULL,           
000012*       NUMPROG5                       DECIMAL(5, 0) NOT NULL,     
000013*       RIGASOLL                       CHAR(80) NOT NULL           
000014*     ) END-EXEC
                                                                        
000015******************************************************************
000016* COBOL DECLARATION FOR TABLE DCONTCLI.TSOLLECITI                *
000017******************************************************************
000018 01  DCLTSOLLECITI.                                               
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000019     10 C865-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000020     10 C865-GRUPSOLL        PIC X(1).                            
000021     10 C865-TIPOSOLL        PIC X(1).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000022     10 C865-CODILING        PIC X(1).                            
000023     10 C865-NUMPROG5        PIC S99999V USAGE COMP-3.            
000024     10 C865-RIGASOLL        PIC X(80).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025******************************************************************
000026* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 6       *
000027******************************************************************
      *<<((file: FDCLI865))
000490*------------------------------> DANAGRAF.TESENCLIE               
000491 01  FILLER                      PIC X(8) VALUE 'FDANAT66'.       
000494*    EXEC SQL                                                     
      *        INCLUDE FDANAT66                                         
      *    END-EXEC.                                                    
      *>>((file: FDANAT66))
000001******************************************************************
000002*COBOL DECLARATION FOR TABLE DANAGRAF.TESENCLIE                  *
000003******************************************************************
000004 01 DCLTESENCLIE.                                                 
000005    10 AT66-AANUMMOV             PIC X(8).                        
000006    10 AT66-CODCLIEN             PIC X(5).                        
000007    10 AT66-ESENTIVA             PIC X(1).                        
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000008    10 AT66-NUMESIVA             PIC X(5).                        
000009    10 AT66-DATESIVA             PIC X(8).                        
000010    10 AT66-UFFICIVA             PIC X(18).                       
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000011    10 AT66-NRPROIVA             PIC X(30).                       
000012    10 AT66-CODDIVIS             PIC X(02).                       
000013    10 AT66-IMPESNEW             PIC S9(9)V9(2) USAGE COMP-3.     
000014    10 AT66-IMPOFATT             PIC S9(9)V9(2) USAGE COMP-3.     
000015    10 AT66-DATASALD             PIC X(8).                        
000016    10 AT66-DTCREAZI             PIC X(8).                        
000017    10 AT66-DTULTVAR             PIC X(8).                        
000018    10 AT66-CODUTVAR             PIC X(6).                        
      *<<((file: FDANAT66))
000495*------------------------------> DANAGRAF.TRIGESENCLIE            
000496 01  FILLER                      PIC X(8) VALUE 'FDANAT67'.       
000499*    EXEC SQL                                                     
      *        INCLUDE FDANAT67                                         
      *    END-EXEC.                                                    
      *>>((file: FDANAT67))
000001******************************************************************
000002*COBOL DECLARATION FOR TABLE DANAGRAF.TRIGESENCLIE               *
000003******************************************************************
000004 01 DCLTRIGESENCLIE.                                              
000005    10 AT67-AANUMMOV             PIC X(8).                        
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006    10 AT67-CODSOCIE             PIC X(2).                        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007    10 AT67-CDMOVCON             PIC X(1).                        
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000008    10 AT67-AANUMFAT             PIC X(8).                        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000009    10 AT67-DTFATTUR             PIC X(8).                        
000010    10 AT67-CODDIVIS             PIC X(2).                        
000011    10 AT67-INDSEGNO             PIC X(1).                        
000012    10 AT67-VALRFATT             PIC S9(9)V9(2) USAGE COMP-3.     
000013    10 AT67-DTCREAZI             PIC X(8).                        
000014    10 AT67-DTULTVAR             PIC X(8).                        
000015    10 AT67-CODUTVAR             PIC X(6).                        
      *<<((file: FDANAT67))
000500*------------------------------- DSKCOSTO.TCONTROLSKCOS           
000501 01  FILLER                      PIC X(8) VALUE 'FDSKC426'.       
000502*    EXEC SQL INCLUDE FDSKC426 END-EXEC.                          
      *>>((file: FDSKC426))
000001******************************************************************
000002* DCLGEN TABLE(DSKCOSTO.TCONTROLSKCOS)                           *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDSKC426))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        QUOTE                                                   *
000007* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000008******************************************************************
000009     
      *EXEC SQL DECLARE DSKCOSTO.TCONTROLSKCOS TABLE                
000010*     ( CODSOCIE                       CHAR(2) NOT NULL,           
000011*       DATACOST                       CHAR(6) NOT NULL,           
000012*       DTINIPER                       CHAR(8) NOT NULL,           
000013*       DTFINPER                       CHAR(8) NOT NULL,           
000014*       FLAGESTR                       CHAR(1) NOT NULL,           
000015*       DATAESTR                       CHAR(8) NOT NULL,           
000016*       TIMEESTR                       CHAR(6) NOT NULL,           
000017*       FLAGCALC                       CHAR(1) NOT NULL,           
000018*       DATACALC                       CHAR(8) NOT NULL,           
000019*       TIMECALC                       CHAR(6) NOT NULL,           
000020*       FLAGCONS                       CHAR(1) NOT NULL,           
000021*       DATACONS                       CHAR(8) NOT NULL,           
000022*       TIMECONS                       CHAR(6) NOT NULL,           
000023*       FLAGVALO                       CHAR(1) NOT NULL,           
000024*       DATAVALO                       CHAR(8) NOT NULL,           
000025*       TIMEVALO                       CHAR(6) NOT NULL,           
000026*       DTCREAZI                       CHAR(8) NOT NULL,           
000027*       DTULTVAR                       CHAR(8) NOT NULL,           
000028*       CODUTVAR                       CHAR(6) NOT NULL            
000029*     ) END-EXEC
                                                                        
000030******************************************************************
000031* COBOL DECLARATION FOR TABLE DSKCOSTO.TCONTROLSKCOS             *
000032******************************************************************
000033 01  DCLTCONTROLSKCOS.                                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000034     10 S426-CODSOCIE        PIC X(2).                            
000035     10 S426-DATACOST        PIC X(6).                            
000036     10 S426-DTINIPER        PIC X(8).                            
000037     10 S426-DTFINPER        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000038     10 S426-FLAGESTR        PIC X(1).                            
000039     10 S426-DATAESTR        PIC X(8).                            
000040     10 S426-TIMEESTR        PIC X(6).                            
000041     10 S426-FLAGCALC        PIC X(1).                            
000042     10 S426-DATACALC        PIC X(8).                            
000043     10 S426-TIMECALC        PIC X(6).                            
000044     10 S426-FLAGCONS        PIC X(1).                            
000045     10 S426-DATACONS        PIC X(8).                            
000046     10 S426-TIMECONS        PIC X(6).                            
000047     10 S426-FLAGVALO        PIC X(1).                            
000048     10 S426-DATAVALO        PIC X(8).                            
000049     10 S426-TIMEVALO        PIC X(6).                            
000050     10 S426-DTCREAZI        PIC X(8).                            
000051     10 S426-DTULTVAR        PIC X(8).                            
000052     10 S426-CODUTVAR        PIC X(6).                            
000053******************************************************************
000054* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 19      *
000055******************************************************************
      *<<((file: FDSKC426))
000503*------------------------------> COPY + DECLARE PER 'SRESEN0'     
000504 01  FILLER                      PIC X(8)  VALUE '**DCESE0'.      
000507*    EXEC SQL                                                     
      *        INCLUDE DCESE0                                           
      *    END-EXEC.                                                    
      *>>((file: DCESE0))
000001*----------------------------------------------------------------*
000002*----             AREA PER SUBROUTINE SRESEN0                ----*
000003*----------------------------------------------------------------*
000004 01  DCESE0.                                                      
000005     05  ESE0-CODERROR           PIC X(5)   VALUE SPACES.         
000006     05  ESE0-CODSOCIE           PIC X(2)   VALUE SPACES.         
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000007     05  ESE0-ESENTIVA           PIC X(1)   VALUE SPACES.         
000008     05  ESE0-FLDESFAT           PIC X(1)   VALUE SPACES.         
000009     05  ESE0-ORDER-BY           PIC X(1)   VALUE SPACES.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000010     05  ESE0-TABESEN.                                            
000011         10  ESE0-RIGASOLL  OCCURS 100 TIMES                      
000012                                 PIC X(80).                       
000013 01  ESE0-MAX-IND                PIC S9(3)  COMP-3 VALUE +100.    
000014 01  ESE0-INDICE                 PIC S9(3)  COMP-3 VALUE +0.      
000015                                                                  
000016     
      *EXEC SQL DECLARE POINT-ESE0 CURSOR FOR                       
000017*         SELECT '1',                                              
000018*                NUMPROG5,                                         
000019*                RIGASOLL                                          
000020*         FROM DCONTCLI.TSOLLECITI                                 
000021*         WHERE CODSOCIE = :C865-CODSOCIE                          
000022*           AND GRUPSOLL = 'S'                                     
000023*           AND CODILING = :C865-CODILING                          
000024*           AND TIPOSOLL = :ESE0-ESENTIVA                          
000025*     UNION  ALL                                                   
000026*         SELECT '2',                                              
000027*                NUMPROG5,                                         
000028*                RIGASOLL                                          
000029*         FROM DCONTCLI.TSOLLECITI                                 
000030*         WHERE CODSOCIE = :C865-CODSOCIE                          
000031*           AND GRUPSOLL = 'S'                                     
000032*           AND CODILING = :C865-CODILING                          
000033*           AND TIPOSOLL = :ESE0-FLDESFAT                          
000034*     ORDER BY 1, 2                                                
000035*     END-EXEC
                                                                        
000036                                                                  
000037*----------------------------------------------------------------*
      *<<((file: DCESE0))
000508*------------------------------> COPY + DECLARE PER 'SRDESC1'     
000509 01  FILLER                      PIC X(8)  VALUE '**DCDES1'.      
000512*    EXEC SQL                                                     
      *        INCLUDE DCDES1                                           
      *    END-EXEC.                                                    
      *>>((file: DCDES1))
000001*----------------------------------------------------------------*
000002*----             AREA PER SUBROUTINE SRDESC1                ----*
000003*----------------------------------------------------------------*
000004 01  DCDES1.                                                      
000005     05  DES1-CODERROR           PIC X(5)   VALUE SPACES.         
000006     05  DES1-TIPODOCU.                                           
000007         10  DES1-TIPODOC1       PIC X.                           
000008         10  DES1-TIPODOC2       PIC X.                           
000009     05  DES1-TABDOCU.                                            
000010         10  DES1-RIGADOCU  OCCURS 100 TIMES                      
000011                                 PIC X(80).                       
000012                                                                  
000013 01  DES1-MAX-IND                PIC S9(3)  COMP-3 VALUE +100.    
000014 01  DES1-INDICE                 PIC S9(3)  COMP-3 VALUE +0.      
000015                                                                  
000016     
      *EXEC SQL DECLARE POINTDES1 CURSOR FOR                        
000017*         SELECT NUMPROG5,                                         
000018*                RIGADOCU                                          
000019*         FROM DANAGRAF.TCOMPLEDOC                                 
000020*         WHERE CODSOCIE = :A842-CODSOCIE                          
000021*           AND CODPAESE = :A842-CODPAESE                          
000022*           AND FLFATMER = :A842-FLFATMER                          
000023*           AND TIPODOCU = :A842-TIPODOCU                          
000024*           AND CODIRESA = :A842-CODIRESA                          
000025*           AND TIPOMERC = ' '                                     
000026*         ORDER BY NUMPROG5                                        
000027*     END-EXEC
                                                                        
000028*----------------------------------------------------------------*
      *<<((file: DCDES1))
000513                                                                  
000514*------------------------------> COPY + DECLARE PER 'SRDESC0'     
000515 01  FILLER                      PIC X(8)  VALUE '**DCDES0'.      
000518*    EXEC SQL                                                     
      *        INCLUDE DCDES0                                           
      *    END-EXEC.                                                    
      *>>((file: DCDES0))
000001*----------------------------------------------------------------*
000002*----               AREA PER SUBROUTINE SRDESC0              ----*
000003*----------------------------------------------------------------*
000004 01  DCDES0.                                                      
000005     05  DES0-CODERROR           PIC X(5)   VALUE SPACES.         
000006     05  DES0-TIPODOCU.                                           
000007         10  DES0-TIPODOC1       PIC X.                           
000008         10  DES0-TIPODOC2       PIC X.                           
000009     05  DES0-TABDOCU.                                            
000010         10  DES0-RIGADOCU    OCCURS 100 TIMES                    
000011                                 PIC X(80).                       
000012                                                                  
000013 01  DES0-MAX-IND                PIC S9(3)  COMP-3 VALUE +100.    
000014 01  DES0-INDICE                 PIC S9(3)  COMP-3 VALUE +0.      
000015                                                                  
000016     
      *EXEC SQL DECLARE POINTDES0 CURSOR FOR                        
000017*         SELECT NUMPROG5,                                         
000018*                RIGADOCU                                          
000019*         FROM DANAGRAF.TCOMPLEDOC                                 
000020*         WHERE CODSOCIE = :A842-CODSOCIE                          
000021*           AND CODPAESE = :A842-CODPAESE                          
000022*           AND FLFATMER = :A842-FLFATMER                          
000023*           AND TIPODOCU = :A842-TIPODOCU                          
000024*           AND TIPOMERC = :A842-TIPOMERC                          
000025*           AND CODIRESA = ' '                                     
000026*         ORDER BY NUMPROG5                                        
000027*     END-EXEC
                                                                        
000028*----------------------------------------------------------------*
      *<<((file: DCDES0))
000519                                                                  
000522*    EXEC SQL                                                     
      *         INCLUDE SQLCA                                           
      *    END-EXEC.                                                    
      *>>((file: SQLCA))
000001****************************************************************<*
000002* Copyright (c) 2016-2023 NTT DATA, Inc. All rights reserved.  *<*
000003* Users of NTT DATA Enterprise COBOL may freely                *<*
000004* redistribute this copybook.                                  *<*
000005****************************************************************<*
000006                                                                  
000007 01  SQLCA GLOBAL.                                                
000008     05  SQLCAID                PIC X(8).                         
000009     05  SQLCABC                PIC S9(9) COMP-5.                 
000010     05  SQLCODE                PIC S9(9) COMP-5.                 
000011     05  SQLERRM.                                                 
000012         49  SQLERRML           PIC S9(4) COMP-5.                 
000013         49  SQLERRMC           PIC X(254).                       
000014     05  SQLERRP                PIC X(8).                         
000015     05  SQLERRD OCCURS 6 TIMES PIC S9(9) COMP-5.                 
000016     05  SQLWARN.                                                 
000017         10 SQLWARN0            PIC X(1).                         
000018         10 SQLWARN1            PIC X(1).                         
000019         10 SQLWARN2            PIC X(1).                         
000020         10 SQLWARN3            PIC X(1).                         
000021         10 SQLWARN4            PIC X(1).                         
000022         10 SQLWARN5            PIC X(1).                         
000023         10 SQLWARN6            PIC X(1).                         
000024         10 SQLWARN7            PIC X(1).                         
000025     05  SQLSTATE               PIC X(5).                         
000026     05  SQLEXT                 PIC S9(5) COMP-3 VALUE 1.         
      *<<((file: SQLCA))
000523                                                                  
000525     
      *EXEC SQL 
      *DECLARE POINTER1 CURSOR FOR                              
000526*          SELECT X.CODCLIEN, X.CODSOCIE                           
000527*                ,X.AANUMORD, X.TIPSERVI                           
000528*                ,X.FLAGGIVA, X.ESENTIVA                           
000529*                ,X.CODDIVIS, X.CONTODCE                           
000530*                ,X.CODSERVI, X.UNMISURA                           
000531*                ,X.PREZZORD, X.NOTENOTE                           
000532*                ,X.CENCOSTD, X.CENCOSTA                           
000533*                ,X.AAMMCOMP                                       
000534*                ,X.CONTPROV                                       
000535*                ,X.QTAORDIN                                       
000536*                ,X.IMPORDIN                                       
000537*                ,X.IMPORIVA                                       
000538*                ,X.MERCEMAG                                       
000539*                ,X.CODARTIC                                       
000540*                ,X.DESSERVI                                       
000541*                ,X.SIGLCICL                                       
000542*            FROM                                                  
000543*         (                                                        
000544*          SELECT A.CODCLIEN, A.CODSOCIE                           
000545*                ,A.AANUMORD, A.TIPSERVI                           
000546*                ,A.FLAGGIVA, A.ESENTIVA                           
000547*                ,A.CODDIVIS, A.CONTODCE                           
000548*                ,B.CODSERVI, B.UNMISURA                           
000549*                ,B.PREZZORD, B.NOTENOTE                           
000550*                ,B.CENCOSTD, B.CENCOSTA                           
000551*                ,CASE WHEN A.CONTODCE = '622760'                  
000552*                      THEN A.AAMMCOMP                             
000553*                      ELSE ' '                                    
000554*                 END AS AAMMCOMP                                  
000555*                ,CASE WHEN C.CODSERVI = '24AL10'                  
000556*                      THEN 'RICCOL'                               
000557*                      ELSE C.CONTPROV                             
000558*                  END CONTPROV                                    
000559*                ,SUM(B.QTAORDIN) QTAORDIN                         
000560*                ,SUM(B.IMPORDIN) IMPORDIN                         
000561*                ,SUM(B.IMPORIVA) IMPORIVA                         
000562*                ,' ' MERCEMAG                                     
000563*                ,' ' CODARTIC                                     
000564*                ,C.DESSERVI                                       
000565*                ,' ' SIGLCICL                                     
000566*            FROM DLOGISTI.TORDILOGI     A                         
000567*                ,DLOGISTI.TRIGORDILOGI  B                         
000568*                ,DLOGISTI.TSERVIZI      C                         
000569*           WHERE A.AANUMORD = B.AANUMORD                          
000570*             AND A.DTEVAORD > ' '                                 
000571*             AND A.AANUMFAT <= ' '                                
000572*             AND A.DTANNULL <= ' '                                
000573*             AND B.DTANNULL <= ' '                                
000574*             AND A.CODSOCIE = :L652-CODSOCIE                      
000575*             AND A.CODCLIEN = :L652-CODCLIEN                      
000576*             AND B.CODSERVI = C.CODSERVI                          
000577*             AND(A.TIPSERVI <> 'L'                                
000578*              OR(A.TIPSERVI = 'L'                                 
000579*             AND NOT EXISTS (SELECT D.AANUMORD                    
000580*                               FROM DLOGISTI.TDETTORDILOGI D      
000581*                              WHERE B.AANUMORD = D.AANUMORD       
000582*                                AND B.NRRIGORD = D.NRRIGORD)))    
000583*        GROUP BY A.CODCLIEN, A.CODSOCIE                           
000584*                ,A.AANUMORD, A.TIPSERVI                           
000585*                ,A.FLAGGIVA, A.ESENTIVA                           
000586*                ,A.CODDIVIS, B.CODSERVI                           
000587*                ,B.UNMISURA, B.PREZZORD                           
000588*                ,A.CONTODCE, B.NOTENOTE                           
000589*                ,B.CENCOSTD, B.CENCOSTA                           
000590*                ,CASE WHEN A.CONTODCE = '622760'                  
000591*                      THEN A.AAMMCOMP                             
000592*                      ELSE ' '                                    
000593*                 END                                              
000594*                ,CASE WHEN C.CODSERVI = '24AL10'                  
000595*                      THEN 'RICCOL'                               
000596*                      ELSE C.CONTPROV                             
000597*                  END                                             
000598*                ,C.DESSERVI                                       
000599*       UNION ALL                                                  
000600*          SELECT A.CODCLIEN, A.CODSOCIE                           
000601*                ,A.AANUMORD, A.TIPSERVI                           
000602*                ,A.FLAGGIVA, A.ESENTIVA                           
000603*                ,A.CODDIVIS, A.CONTODCE                           
000604*                ,B.CODSERVI, B.UNMISURA                           
000605*                ,B.PREZZORD                                       
000606*                ,B.NOTENOTE                                       
000607*                ,B.CENCOSTD, B.CENCOSTA                           
000608*                ,CASE WHEN A.CONTODCE = '622760'                  
000609*                      THEN A.AAMMCOMP                             
000610*                      ELSE ' '                                    
000611*                 END AS AAMMCOMP                                  
000612*                ,CASE WHEN C.CODSERVI = '24AL10'                  
000613*                      THEN 'RICCOL'                               
000614*                      ELSE C.CONTPROV                             
000615*                  END CONTPROV                                    
000616*                ,SUM(D.QTAORDIN) QTAORDIN                         
000617*                ,SUM(D.IMPORDIN) IMPORDIN                         
000618*                , 0              IMPORIVA                         
000619*                ,D.MERCEMAG                                       
000620*                ,CASE WHEN LEFT(B.CODSERVI, 4) = '25PZ'           
000621*                      THEN D.PROLOMER||                           
000622*                           SUBSTR(' ', 1, 1)||                    
000623*                           D.CAUSAMOV                             
000624*                      WHEN D.CODARTIC <=' '                       
000625*                      THEN SUBSTR('D', 1, 1)||D.CODDISEG          
000626*                      ELSE D.CODARTIC END CODARTIC                
000627*                ,C.DESSERVI                                       
000628*                ,D.SIGLCICL                                       
000629*            FROM DLOGISTI.TORDILOGI     A                         
000630*                ,DLOGISTI.TRIGORDILOGI  B                         
000631*                ,DLOGISTI.TSERVIZI      C                         
000632*                ,DLOGISTI.TDETTORDILOGI D                         
000633*           WHERE A.AANUMORD = B.AANUMORD                          
000634*             AND A.DTEVAORD > ' '                                 
000635*             AND A.AANUMFAT <= ' '                                
000636*             AND A.DTANNULL <= ' '                                
000637*             AND B.DTANNULL <= ' '                                
000638*             AND A.CODSOCIE = :L652-CODSOCIE                      
000639*             AND A.CODCLIEN = :L652-CODCLIEN                      
000640*             AND B.CODSERVI = C.CODSERVI                          
000641*             AND B.AANUMORD = D.AANUMORD                          
000642*             AND B.NRRIGORD = D.NRRIGORD                          
000643*             AND A.TIPSERVI = 'L'                                 
000644*        GROUP BY A.CODCLIEN, A.CODSOCIE                           
000645*                ,A.AANUMORD, A.TIPSERVI                           
000646*                ,A.FLAGGIVA, A.ESENTIVA                           
000647*                ,A.CODDIVIS, B.CODSERVI                           
000648*                ,B.UNMISURA                                       
000649*                ,B.PREZZORD                                       
000650*                ,A.CONTODCE, B.NOTENOTE                           
000651*                ,B.CENCOSTD, B.CENCOSTA                           
000652*                ,CASE WHEN A.CONTODCE = '622760'                  
000653*                      THEN A.AAMMCOMP                             
000654*                      ELSE ' '                                    
000655*                 END                                              
000656*                ,CASE WHEN C.CODSERVI = '24AL10'                  
000657*                      THEN 'RICCOL'                               
000658*                      ELSE C.CONTPROV                             
000659*                  END                                             
000660*                ,D.MERCEMAG                                       
000661*                ,CASE WHEN LEFT(B.CODSERVI, 4) = '25PZ'           
000662*                      THEN D.PROLOMER||                           
000663*                           SUBSTR(' ', 1, 1)||                    
000664*                           D.CAUSAMOV                             
000665*                      WHEN D.CODARTIC <=' '                       
000666*                      THEN SUBSTR('D', 1, 1)||D.CODDISEG          
000667*                      ELSE D.CODARTIC END                         
000668*                ,C.DESSERVI                                       
000669*                ,D.SIGLCICL                                       
000670*       ) AS X                                                     
000671*        ORDER BY  X.CODSOCIE, X.CODCLIEN                          
000672*                , X.TIPSERVI, X.FLAGGIVA                          
000673*                , X.ESENTIVA, X.CODDIVIS                          
000674*                , X.CONTODCE, X.CONTPROV, X.AAMMCOMP              
000675*                , X.AANUMORD                                      
000676*                , X.CODSERVI                                      
000677*                , X.MERCEMAG, X.CODARTIC                          
000678*                , X.SIGLCICL                                      
000679*                , X.PREZZORD                                      
000680*                , X.NOTENOTE                                      
000681*                , X.CENCOSTD, X.CENCOSTA                          
000682*                , X.DESSERVI                                      
000683*     END-EXEC
                                                                        
000684                                                                  
000685     
      *EXEC SQL DECLARE POINTER2 CURSOR FOR                         
000686*          SELECT NOTEORDI, NUMPROG3                               
000687*            FROM DLOGISTI.TNOTEORDILOGI                           
000688*           WHERE AANUMORD = :L656-AANUMORD                        
000689*             AND TINOTORD = :L656-TINOTORD                        
000690*             AND NOTEORDI > ' '                                   
000691*        ORDER BY NUMPROG3                                         
000692*     END-EXEC
                                                                        
000693                                                                  
000694     
      *EXEC SQL DECLARE POINT-RIF CURSOR FOR                        
000695*          SELECT RIFORDIN, NUMPROG3                               
000696*            FROM DLOGISTI.TRIFORDILOGI                            
000697*           WHERE AANUMORD = :L430-AANUMORD                        
000698*             AND RIFORDIN > ' '                                   
000699*        ORDER BY NUMPROG3                                         
000700*     END-EXEC
                                                                        
000701                                                                  
000703     
      *EXEC SQL 
      *DECLARE POINTIVA CURSOR FOR                             
000704*          SELECT DISTINCT B.NUMESIVA, B.DATESIVA                  
000705*                         ,B.UFFICIVA                              
000706*            FROM DANAGRAF.TRIGESENCLIE  A                         
000707*                ,DANAGRAF.TESENCLIE     B                         
000708*           WHERE A.CODSOCIE = :AT67-CODSOCIE                      
000709*             AND A.AANUMFAT = :AT67-AANUMFAT                      
000710*             AND A.CDMOVCON = 'O'                                 
000711*             AND A.AANUMMOV = B.AANUMMOV                          
000712*          ORDER BY B.DATESIVA                                     
000713*     END-EXEC
                                                                        
000714                                                                  
000715*----------------------------------------------------------------*
000716 PROCEDURE DIVISION.                                              
000717*----------------------------------------------------------------*
000716 VCOBOL-DUMMY-PROCEDURE.
000718                                                                  
000719     
      *EXEC SQL WHENEVER SQLERROR GO TO Z00-ERRORE END-EXEC
                                                                        
000720     MOVE 'AVALO90 '             TO PPNAME                        
000721                                    WCOM-PROGNAME.                
000722                                                                  
000723     OPEN OUTPUT INPCONT                                          
000724                 OUTFATT                                          
000725                 OUTCON2                                          
000726                                                                  
000727     PERFORM A00-OPERAZIONI-INIZIALI                              
000728        THRU A00-EX.                                              
000729                                                                  
000730     PERFORM B00-ELABORAZIONE                                     
000731        THRU B00-EX.                                              
000732                                                                  
000733     CLOSE INPCONT                                                
000734           OUTFATT                                                
000735           OUTCON2.                                               
000736                                                                  
000737     MOVE 'P'                    TO PPROUTIN.                     
000738     PERFORM Z90-READPRIN                                         
000739        THRU Z90-EX.                                              
000740     MOVE ZERO                   TO RETURN-CODE.                  
000741     CALL "CCF_SET_RETCODE" USING RETURN-CODE                     
000742     STOP RUN.                                                    
000743                                                                  
000744*----------------------------------------------------------------*
000745 A00-OPERAZIONI-INIZIALI.                                         
000746*----------------------------------------------------------------*
000747                                                                  
000748     PERFORM A05-LETTURA-SKPAR                                    
000749        THRU A05-EX.                                              
000750                                                                  
000751     IF SK-TIPOSKED = 'AUTO'                                      
000752        MOVE SK-CODSOCIE         TO L652-CODSOCIE                 
000753        MOVE SK-CODCLIEN         TO L652-CODCLIEN                 
000754        MOVE SK-PROVADEF         TO WS-PROVADEF                   
000755     ELSE                                                         
000756        MOVE 'LOGI'              TO A839-CODITRAN                 
000757        PERFORM L00-SELECT-TEMPITRANS                             
000758           THRU L00-EX                                            
000759        MOVE A839-CODSOCIE       TO L652-CODSOCIE                 
000760        MOVE A839-NOTENOTE(3:5)  TO L652-CODCLIEN                 
000761        MOVE A839-NOTENOTE(1:1)  TO WS-PROVADEF.                  
000762                                                                  
000763     PERFORM A10-RICERCA-DATA                                     
000764        THRU A10-EX.                                              
000765                                                                  
000766 A00-EX. EXIT.                                                    
000767*---------------------------------------------------------------* 
000768 A05-LETTURA-SKPAR.                                               
000769*---------------------------------------------------------------* 
000770                                                                  
000771     MOVE 'S'                    TO PPROUTIN.                     
000772     PERFORM Z90-READPRIN                                         
000773        THRU Z90-EX.                                              
000774     MOVE PPSK1                  TO SK-PARAM.                     
000775                                                                  
000776     MOVE 'A05-'                 TO WCOM-CODABEND                 
000777     MOVE 'LETTURA'              TO WCOM-FILEFUNZ                 
000778     MOVE 'SKEDA-P'              TO WCOM-FILENOME                 
000779     MOVE SK-PARAM               TO WCOM-FILECTRL                 
000780     IF SK-TIPOSKED NOT EQUAL 'MANU' AND 'AUTO'                   
000781        MOVE 'SKEDA PARAMETRO ERRATA'                             
000782                                 TO WCOM-MESSAGES                 
000783        PERFORM Z00-ERRORE                                        
000784           THRU Z00-EX.                                           
000785                                                                  
000786     IF SK-TIPOSKED = 'AUTO'                                      
000787        IF SK-CODCLIEN NOT > SPACES OR                            
000788           SK-CODSOCIE NOT > SPACES OR                            
000789           SK-PROVADEF NOT > SPACES                               
000790           MOVE 'SKEDA PARAMETRO ERRATA'                          
000791                                    TO WCOM-MESSAGES              
000792           PERFORM Z00-ERRORE                                     
000793              THRU Z00-EX.                                        
000794                                                                  
000795 A05-EX. EXIT.                                                    
000796*----------------------------------------------------------------*
000797 A10-RICERCA-DATA.                                                
000798*----------------------------------------------------------------*
000799                                                                  
000800*--- DATA MESE                                                    
000801     MOVE SPACES                 TO DCWDTEL.                      
000802     MOVE 'M'                    TO DTEL-DATATIPO.                
000803     MOVE 'AVALO90'              TO DTEL-SIGLDATA                 
000804     PERFORM A11-SCADTEL                                          
000805        THRU A11-EX.                                              
000806                                                                  
000807     MOVE DTEL-DTINELAB(1:6)     TO WS-MESEELAB                   
000808                                                                  
000809     MOVE SPACES                 TO S426-DTINIPER                 
000810     MOVE SPACES                 TO S426-DTFINPER                 
000811     MOVE SPACES                 TO S426-DATACOST                 
000812     IF L652-CODSOCIE = '22'                                      
000813        PERFORM L105-SELECT-CONTROLSKCOS                          
000814           THRU L105-EX.                                          
000815                                                                  
000816*--- DATA GIORNO                                                  
000817     MOVE SPACES                 TO DCWDTEL.                      
000818     MOVE 'G'                    TO DTEL-DATATIPO.                
000819     MOVE 'AVALO90'              TO DTEL-SIGLDATA                 
000820     PERFORM A11-SCADTEL                                          
000821        THRU A11-EX.                                              
000822                                                                  
000823     MOVE DTEL-DTINELAB          TO WS-DTGIORNO.                  
000824                                                                  
000825 A10-EX. EXIT.                                                    
000826*----------------------------------------------------------------*
000827 A11-SCADTEL.                                                     
000828*----------------------------------------------------------------*
000829                                                                  
000830     MOVE 'R'                    TO DTEL-TIPORICH.                
000831     MOVE 'SCADTEL'              TO PPCALL.                       
000832     CALL PPCALL USING DCPARM DCWDTEL.                            
000833                                                                  
000834     IF DTEL-RETCOD  NOT = ZEROES                                 
000835        MOVE 'A10-'              TO WCOM-CODABEND                 
000836        MOVE 'LETTURA'           TO WCOM-FILEFUNZ                 
000837        MOVE 'SCADTEL'           TO WCOM-FILENOME                 
000838        PERFORM Z00-ERRORE                                        
000839           THRU Z00-EX.                                           
000840                                                                  
000841 A11-EX. EXIT.                                                    
000842*----------------------------------------------------------------*
000843 B00-ELABORAZIONE.                                                
000844*----------------------------------------------------------------*
000845                                                                  
000846     MOVE 'OPEN'                 TO WCOM-FILEFUNZ.                
000847     MOVE 'POINTER1'             TO WCOM-FILENOME.                
000848     MOVE 'B00'                  TO WCOM-CODABEND.                
000849     MOVE L652-CODSOCIE          TO WCOM-FILECTRL.                
000850                                                                  
000852     
      *EXEC SQL 
      *OPEN POINTER1                                            
000853*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 1 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODSOCIE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODCLIEN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODSOCIE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODCLIEN
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 4 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000854                                                                  
000855     MOVE SPACES                 TO WS-AANUMORD-X.                
000856     PERFORM L05-FETCH-POINTER1                                   
000857        THRU L05-EX.                                              
000858                                                                  
000859     PERFORM B10-ELABORA-POINTER1                                 
000860        THRU B10-EX                                               
000861             UNTIL WS-SQLCODE EQUAL +100                          
000862                                                                  
000863     MOVE 'CLOSE'                TO WCOM-FILEFUNZ.                
000864     MOVE 'POINTER1'             TO WCOM-FILENOME.                
000865     MOVE 'B00'                  TO WCOM-CODABEND.                
000866     MOVE SPACES                 TO WCOM-FILECTRL.                
000867                                                                  
000869     
      *EXEC SQL 
      *CLOSE POINTER1                                           
000870*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 4 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000871                                                                  
000872 B00-EX. EXIT.                                                    
000873*----------------------------------------------------------------*
000874 B10-ELABORA-POINTER1.                                            
000875*----------------------------------------------------------------*
000876                                                                  
000877     MOVE L652-CODSOCIE          TO WS-CODSOCIE.                  
000878     MOVE L652-CODCLIEN          TO WS-CODCLIEN.                  
000879     MOVE L652-TIPSERVI          TO WS-TIPSERVI.                  
000880     MOVE L652-CODDIVIS          TO WS-CODDIVIS.                  
000881     MOVE L652-FLAGGIVA          TO WS-FLAGGIVA.                  
000882     MOVE L652-ESENTIVA          TO WS-ESENTIVA.                  
000883     MOVE L652-CONTODCE          TO WS-CONTODCE.                  
000884     MOVE L652-AAMMCOMP          TO WS-AAMMCOMP.                  
000885     MOVE L651-CONTPROV          TO WS-CONTPROV                   
000886                                                                  
000887     IF A531-CODSOCIE NOT = L652-CODSOCIE                         
000888        MOVE L652-CODSOCIE       TO A531-CODSOCIE                 
000889        PERFORM L10-SELECT-TSOCIETA                               
000890           THRU L10-EX.                                           
000891                                                                  
000892     IF A901-CODCLIEN NOT = L652-CODCLIEN                         
000893        MOVE L652-CODCLIEN       TO A901-CODCLIEN                 
000894        PERFORM L15-SELECT-TCLIENTI                               
000895           THRU L15-EX                                            
000896        IF A901-GENECLIE = 'M'                                    
000897           MOVE A901-CLIEFATT   TO A901-CODCLIEN                  
000898           PERFORM L17-SELECT-CLIEFATT                            
000899              THRU L17-EX                                         
000900        END-IF                                                    
000901        IF A901-CLIFOCON > SPACES AND                             
000902           A901-TIPOCONS > SPACES                                 
000903           MOVE A901-CLIFOCON    TO A531-CODFORNI                 
000904           PERFORM L11-SELECT-TSOCIETA                            
000905              THRU L11-EX                                         
000906        ELSE                                                      
000907           MOVE A531-CODPIANO    TO WS-CODPIANO                   
000908        END-IF                                                    
000909        PERFORM D00-PREPARA-DICITURE                              
000910           THRU D00-EX                                            
000911        MOVE A901-CODILING       TO A019-CODILING                 
000912        MOVE 'F'                 TO A019-CDMOVCON                 
000913        PERFORM L20-SELECT-MOVICONT                               
000914           THRU L20-EX                                            
000915        MOVE A901-PAESFATT       TO A529-CODPAESE                 
000916        MOVE A901-CODILING       TO A529-CODILING                 
000917        PERFORM L50-SELECT-PAESLING                               
000918           THRU L50-EX                                            
000919        MOVE A529-SIGLAPAE       TO WS-SIGPAFAT                   
000920        MOVE A901-PAESMERC       TO A529-CODPAESE                 
000921        PERFORM L50-SELECT-PAESLING                               
000922           THRU L50-EX                                            
000923        MOVE SPACES              TO WS-SIGPAMER                   
000924        IF A901-RAGMERCE GREATER SPACES                           
000925           MOVE A529-SIGLAPAE    TO WS-SIGPAMER.                  
000926                                                                  
000927     IF A963-CODDIVIS NOT = L652-CODDIVIS                         
000928        MOVE L652-CODDIVIS       TO A963-CODDIVIS                 
000929        PERFORM L60-SELECT-DIVISE                                 
000930           THRU L60-EX.                                           
000931                                                                  
000932     PERFORM L65-SELECT-RIGORDILOGI                               
000933        THRU L65-EX.                                              
000934                                                                  
000935     MOVE ZEROES                 TO WS-TOTMOVIM                   
000936     MOVE ZEROES                 TO WS-TOTFATTU                   
000937     MOVE ZEROES                 TO WS-TOTIVAXX                   
000938     MOVE ZEROES                 TO WS-IMPORIVA                   
000939     MOVE ZEROES                 TO WS-PERCEIVA                   
000940     MOVE ZEROES                 TO WS-CONTARIG                   
000941     MOVE 1                      TO IND-N.                        
000942     MOVE 1                      TO IND-I.                        
000943                                                                  
000944     MOVE SPACES                 TO TABELLA.                      
000945     INITIALIZE                     TABELLA.                      
000946     MOVE SPACES                 TO TAB-ORDINI                    
000947     INITIALIZE                     TAB-ORDINI                    
000948     MOVE SPACES                 TO TABELLA1.                     
000949     INITIALIZE                     TABELLA1.                     
000950     MOVE SPACES                 TO TABELLA2.                     
000951     INITIALIZE                     TABELLA2.                     
000952     MOVE SPACES                 TO TABELLA3.                     
000953     INITIALIZE                     TABELLA3.                     
000954                                                                  
000955     MOVE 'SI'                   TO WS-PRIMA-VOLTA.               
000956     MOVE 1                      TO IND-R.                        
000957     MOVE 1                      TO IND-E.                        
000958     MOVE SPACES                 TO TABELLA4.                     
000959     INITIALIZE                     TABELLA4.                     
000960                                                                  
000961     MOVE WS-NUMRIGHE            TO WS-CONTAFAT                   
000962     PERFORM B20-ELABORA-ROTTURA                                  
000963        THRU B20-EX                                               
000964            UNTIL WS-SQLCODE = +100                               
000965               OR WS-CODSOCIE NOT = L652-CODSOCIE                 
000966               OR WS-CODCLIEN NOT = L652-CODCLIEN                 
000967               OR WS-TIPSERVI NOT = L652-TIPSERVI                 
000968               OR WS-CODDIVIS NOT = L652-CODDIVIS                 
000969               OR WS-FLAGGIVA NOT = L652-FLAGGIVA                 
000970               OR WS-ESENTIVA NOT = L652-ESENTIVA                 
000971               OR WS-CONTODCE NOT = L652-CONTODCE                 
000972               OR WS-AAMMCOMP NOT = L652-AAMMCOMP                 
000973               OR WS-CONTPROV NOT = L651-CONTPROV                 
000974               OR WS-CONTAFAT     > 800.                          
000975                                                                  
000976     IF WS-TOTMOVIM > ZEROES                                      
000977        MOVE SPACES              TO WS-NUMEAUTO                   
000978        IF WS-PROVADEF = 'D'                                      
000979           PERFORM C00-NUMERO-FATTURA                             
000980              THRU C00-EX                                         
000981        ELSE                                                      
000982           PERFORM C10-NUMERO-PROFORMA                            
000983              THRU C10-EX                                         
000984        END-IF                                                    
000985        IF WS-NUMEAUTO(1:1) NOT = 'V'                             
000986           PERFORM D10-STAMPA-FATTURA                             
000987              THRU D10-EX                                         
000988           IF WS-CONTPROV NOT = 'FATWEB'                          
000989              PERFORM E00-STAMPA-PACKING                          
000990                 THRU E00-EX                                      
000991           END-IF                                                 
000992           PERFORM W00-WRITE-OUTFATT                              
000993              THRU W00-EX                                         
000994           PERFORM F00-PREPARA-INPCONT                            
000995              THRU F00-EX.                                        
000996                                                                  
000997     IF WS-PROVADEF = 'D'                                         
000998        PERFORM VARYING IND FROM 1 BY 1                           
000999           UNTIL IND > MAXIND                                     
001000              OR ORD-AANUMORD(IND) NOT > SPACES                   
001001           IF ORD-AANUMORD(IND) NOT = WS-AANUMORD                 
001002              MOVE ORD-AANUMORD(IND) TO WS-AANUMORD               
001003              PERFORM G00-UPDATE-ORDILOGI                         
001004                 THRU G00-EX                                      
001005           END-IF                                                 
001006        END-PERFORM.                                              
001007                                                                  
001008 B10-EX. EXIT.                                                   
001009*----------------------------------------------------------------*
001010 B20-ELABORA-ROTTURA.                                             
001011*----------------------------------------------------------------*
001012                                                                  
001013     MOVE L653-IMPORDIN          TO WS-IMPORDIN                   
001014     ADD WS-IMPORDIN             TO WS-TOTMOVIM                   
001015                                                                  
001016     ADD L653-IMPORIVA           TO WS-TOTIVAXX                   
001017                                                                  
001018     IF WS-TIPSERVI   = 'L' AND                                   
001019        A901-TIPOCONS > ' '                                       
001020        PERFORM VARYING IND FROM 1 BY 1                           
001021          UNTIL IND > MAXIND                                      
001022            OR PKL-CODSERVI(IND) NOT > SPACES                     
001023            OR (PKL-CODSERVI(IND) = L653-CODSERVI AND             
001024                PKL-PREZZORD(IND) = L653-PREZZORD AND             
001025                PKL-MERCEMAG(IND) = L655-MERCEMAG AND             
001026                PKL-CODARTIC(IND) = COMO-CODARTIC AND             
001027                PKL-SIGLCICL(IND) = L655-SIGLCICL)                
001028        END-PERFORM                                               
001029     ELSE                                                         
001030        PERFORM VARYING IND FROM 1 BY 1                           
001031          UNTIL IND > MAXIND                                      
001032            OR PKL-CODSERVI(IND) NOT > SPACES                     
001033            OR (PKL-AANUMORD(IND) = L652-AANUMORD AND             
001034                PKL-CODSERVI(IND) = L653-CODSERVI AND             
001035                PKL-PREZZORD(IND) = L653-PREZZORD AND             
001036                PKL-UNMISURA(IND) = L653-UNMISURA AND             
001037                PKL-NOTENOTE(IND) = L653-NOTENOTE)                
001038        END-PERFORM                                               
001039     END-IF                                                       
001040     IF IND > MAXIND                                              
001041        MOVE 'TABELLA'           TO WCOM-FILEFUNZ                 
001042        MOVE 'PICCOLA'           TO WCOM-FILENOME                 
001043        MOVE 'B20-'              TO WCOM-CODABEND                 
001044        MOVE SPACES              TO WCOM-FILECTRL                 
001045        STRING WS-CODSOCIE ' ' WS-CODCLIEN ' '                    
001046               WS-TIPSERVI ' ' WS-CODDIVIS ' '                    
001047               WS-FLAGGIVA ' ' WS-ESENTIVA ' '                    
001048               WS-CONTODCE                                        
001049           DELIMITED BY SIZE   INTO WCOM-FILECTRL                 
001050        PERFORM Z00-ERRORE                                        
001051           THRU Z00-EX.                                           
001052                                                                  
001053     IF PKL-CODSERVI(IND) > SPACES                                
001054        ADD L653-QTAORDIN        TO PKL-QTAORDIN(IND)             
001055        ADD WS-IMPORDIN          TO PKL-IMPORDIN(IND)             
001056     ELSE                                                         
001057        MOVE L652-AANUMORD       TO PKL-AANUMORD(IND)             
001058        MOVE L653-CODSERVI       TO PKL-CODSERVI(IND)             
001059        MOVE L653-PREZZORD       TO PKL-PREZZORD(IND)             
001060        MOVE L653-UNMISURA       TO PKL-UNMISURA(IND)             
001061        MOVE L653-QTAORDIN       TO PKL-QTAORDIN(IND)             
001062        MOVE WS-IMPORDIN         TO PKL-IMPORDIN(IND)             
001063        MOVE L653-NOTENOTE       TO PKL-NOTENOTE(IND)             
001064        MOVE L651-DESSERVI       TO PKL-DESSERVI(IND)             
001065        MOVE L655-MERCEMAG       TO PKL-MERCEMAG(IND)             
001066        MOVE COMO-CODARTIC       TO PKL-CODARTIC(IND)             
001067        MOVE L655-SIGLCICL       TO PKL-SIGLCICL(IND)             
001068     END-IF                                                       
001069                                                                  
001070**** CENTRO DI COSTO AVERE/DARE                                   
001071     PERFORM VARYING INDC FROM 1 BY 1                             
001072       UNTIL INDC                  > MAX-INDC                     
001073          OR (T1-CENCOSTA(INDC) NOT > ' ' AND                     
001074              T1-CENCOSTD(INDC) NOT > ' ')                        
001075          OR (T1-CENCOSTA(INDC) = L653-CENCOSTA AND               
001076              T1-CENCOSTD(INDC) = L653-CENCOSTD)                  
001077     END-PERFORM                                                  
001078     IF INDC > MAX-INDC                                           
001079        MOVE 'B20-'                TO WCOM-CODABEND               
001080        MOVE 'CARICA'              TO WCOM-FILEFUNZ               
001081        MOVE 'TABELLA1'            TO WCOM-FILENOME               
001082        MOVE L653-CENCOSTA         TO WCOM-FILECTRL               
001083        PERFORM Z00-ERRORE                                        
001084           THRU Z00-EX.                                           
001085                                                                  
001086     IF T1-CENCOSTA(INDC) NOT > ' ' AND                           
001087        T1-CENCOSTD(INDC) NOT > ' '                               
001088        ADD 1                      TO WS-CONTARIG                 
001089        MOVE L653-CENCOSTA         TO T1-CENCOSTA(INDC)           
001090        MOVE L653-CENCOSTD         TO T1-CENCOSTD(INDC)           
001091        MOVE WS-IMPORDIN           TO T1-IMPORTO (INDC)           
001092        MOVE WS-CONTARIG           TO T1-CONTARIG(INDC)           
001093     ELSE                                                         
001094        ADD  WS-IMPORDIN           TO T1-IMPORTO (INDC).          
001095                                                                  
001096**** TABELLA ORDINI                                               
001097     PERFORM VARYING IND FROM 1 BY 1                              
001098       UNTIL IND > MAXIND                                         
001099         OR ORD-AANUMORD(IND) NOT > SPACES                        
001100         OR ORD-AANUMORD(IND)     = L652-AANUMORD                 
001101     END-PERFORM                                                  
001102                                                                  
001103     IF IND > MAXIND                                              
001104        MOVE 'TAB-ORDINI'        TO WCOM-FILEFUNZ                 
001105        MOVE 'PICCOLA'           TO WCOM-FILENOME                 
001106        MOVE 'B20-'              TO WCOM-CODABEND                 
001107        MOVE SPACES              TO WCOM-FILECTRL                 
001108        STRING WS-CODSOCIE ' ' WS-CODCLIEN ' '                    
001109               WS-TIPSERVI ' ' WS-CODDIVIS ' '                    
001110               WS-FLAGGIVA ' ' WS-ESENTIVA ' '                    
001111               WS-CONTODCE                                        
001112           DELIMITED BY SIZE   INTO WCOM-FILECTRL                 
001113        PERFORM Z00-ERRORE                                        
001114           THRU Z00-EX.                                           
001115                                                                  
001116*    STAMPA NOTE + ESENZIONI                                      
001117     IF ORD-AANUMORD(IND) NOT > ' '                               
001118        MOVE L652-AANUMORD       TO ORD-AANUMORD(IND)             
001119        PERFORM B30-ELABORA-NOTE                                  
001120           THRU B30-EX                                            
001121        PERFORM B45-ELABORA-RIFORDIN                              
001122           THRU B45-EX                                            
001123        IF A901-PAESFATT = A531-CODPAESE AND                      
001124           A901-PAESFATT = '000'         AND                      
001125           WS-ESENTIVA = '1'                                      
001126           PERFORM B50-CARICA-ESENZIONE                           
001127              THRU B50-EX.                                        
001128                                                                  
001129     PERFORM L05-FETCH-POINTER1                                   
001130        THRU L05-EX.                                              
001131                                                                  
001132 B20-EX. EXIT.                                                   
001133*----------------------------------------------------------------*
001134 B30-ELABORA-NOTE.                                                
001135*----------------------------------------------------------------*
001136                                                                  
001137     MOVE L652-AANUMORD          TO L656-AANUMORD.                
001138     MOVE 'F'                    TO L656-TINOTORD.                
001139                                                                  
001140     MOVE 'OPEN'                 TO WCOM-FILEFUNZ.                
001141     MOVE 'POINTER2'             TO WCOM-FILENOME.                
001142     MOVE 'B30'                  TO WCOM-CODABEND.                
001143     MOVE L656-AANUMORD          TO WCOM-FILECTRL.                
001144                                                                  
001146     
      *EXEC SQL 
      *OPEN POINTER2                                            
001147*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 2 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L656-AANUMORD
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L656-TINOTORD
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 5 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001148                                                                  
001149     PERFORM L06-FETCH-POINTER2                                   
001150        THRU L06-EX.                                              
001151                                                                  
001152     PERFORM B301-ELABORA-POINTER2                                
001153        THRU B301-EX                                              
001154             UNTIL SQLCODE EQUAL +100                             
001155                OR IND-N > MAXIND-N.                              
001156                                                                  
001157     MOVE 'CLOSE'                TO WCOM-FILEFUNZ.                
001158     MOVE 'POINTER2'             TO WCOM-FILENOME.                
001159     MOVE 'B30'                  TO WCOM-CODABEND.                
001160     MOVE SPACES                 TO WCOM-FILECTRL.                
001161                                                                  
001163     
      *EXEC SQL 
      *CLOSE POINTER2                                           
001164*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 5 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001165                                                                  
001166 B30-EX. EXIT.                                                   
001167*----------------------------------------------------------------*
001168 B301-ELABORA-POINTER2.                                           
001169*----------------------------------------------------------------*
001170                                                                  
001171     MOVE L656-NOTEORDI          TO NOTE-NOTEORDI(IND-N)          
001172                                                                  
001173     PERFORM L06-FETCH-POINTER2                                   
001174        THRU L06-EX.                                              
001175                                                                  
001176     ADD 1                       TO IND-N.                        
001177                                                                  
001178 B301-EX. EXIT.                                                  
001179*----------------------------------------------------------------*
001180 B45-ELABORA-RIFORDIN.                                            
001181*----------------------------------------------------------------*
001182                                                                  
001183     MOVE L652-AANUMORD          TO L430-AANUMORD.                
001184                                                                  
001185     MOVE 'OPEN'                 TO WCOM-FILEFUNZ.                
001186     MOVE 'POINT-RIF'            TO WCOM-FILENOME.                
001187     MOVE 'B45'                  TO WCOM-CODABEND.                
001188     MOVE L430-AANUMORD          TO WCOM-FILECTRL.                
001189                                                                  
001191     
      *EXEC SQL 
      *OPEN POINT-RIF                                           
001192*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 3 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L430-AANUMORD
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 6 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001193                                                                  
001194     PERFORM L08-FETCH-POINT-RIF                                  
001195        THRU L08-EX.                                              
001196                                                                  
001197***  MAXIND-R = 5 XC MASSIMO 5 RIGHE DI CORPO FATTURA             
001198***               SU CUI SCRIVERE I RIFERIMENTI                   
001199                                                                  
001200     PERFORM B451-ELABORA-POINT-RIF                               
001201        THRU B451-EX                                              
001202               UNTIL IND-R > MAXIND-R                             
001203                  OR SQLCODE EQUAL +100.                          
001204                                                                  
001205     MOVE 'CLOSE'                TO WCOM-FILEFUNZ.                
001206     MOVE 'POINT-RIF'            TO WCOM-FILENOME.                
001207     MOVE 'B45'                  TO WCOM-CODABEND.                
001208     MOVE SPACES                 TO WCOM-FILECTRL.                
001209                                                                  
001211     
      *EXEC SQL 
      *CLOSE POINT-RIF                                          
001212*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 6 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001213                                                                  
001214 B45-EX. EXIT.                                                   
001215*----------------------------------------------------------------*
001216 B451-ELABORA-POINT-RIF.                                          
001217*----------------------------------------------------------------*
001218                                                                  
001219     IF WS-PRIMA-VOLTA = 'SI'                                     
001220        MOVE 'RIF.ORDINE: '      TO RIFE-TESTOXXX(IND-R)          
001221        MOVE 'NO'                TO WS-PRIMA-VOLTA                
001222     ELSE                                                         
001223        MOVE '            '      TO RIFE-TESTOXXX(IND-R).         
001224                                                                  
001225***  MAXIND-E = 6  XC MASSIMO 6 OCCORRENZE DI RIFERIMENTO ORDINE  
001226***                SULLA STESSA RIGA.                             
001227                                                                  
001228     PERFORM B452-ELABORA-ELEMENTO                                
001229        THRU B452-EX                                              
001230               UNTIL IND-E > MAXIND-E                             
001231                  OR SQLCODE EQUAL +100.                          
001232                                                                  
001233     IF IND-E > MAXIND-E                                          
001234        MOVE 1                   TO IND-E                         
001235        ADD 1                    TO IND-R.                        
001236                                                                  
001237 B451-EX. EXIT.                                                  
001238*----------------------------------------------------------------*
001239 B452-ELABORA-ELEMENTO.                                           
001240*----------------------------------------------------------------*
001241                                                                  
001242     MOVE L430-RIFORDIN          TO RIFE-RIFORDIN(IND-R, IND-E)   
001243     MOVE ','                    TO RIFE-VIRGOLAX(IND-R, IND-E).  
001244                                                                  
001245     MOVE IND-R                  TO IND-R-SAVE.                   
001246     MOVE IND-E                  TO IND-E-SAVE.                   
001247                                                                  
001248     PERFORM L08-FETCH-POINT-RIF                                  
001249        THRU L08-EX.                                              
001250                                                                  
001251     ADD 1                       TO IND-E.                        
001252                                                                  
001253 B452-EX. EXIT.                                                  
001254*----------------------------------------------------------------*
001255 B50-CARICA-ESENZIONE.                                            
001256*----------------------------------------------------------------*
001257                                                                  
001258     MOVE L652-AANUMORD          TO AT67-AANUMFAT                 
001259     MOVE WS-CODSOCIE            TO AT67-CODSOCIE                 
001260                                                                  
001261     MOVE 'OPEN'                  TO WCOM-FILEFUNZ.               
001262     MOVE 'POINTIVA'              TO WCOM-FILENOME.               
001263     MOVE 'B50-'                  TO WCOM-CODABEND.               
001264     MOVE SPACES                  TO WCOM-FILECTRL.               
001265     STRING AT67-CODSOCIE ' ' AT67-AANUMFAT                       
001266        DELIMITED BY SIZE       INTO WCOM-FILECTRL.               
001267                                                                  
001269     
      *EXEC SQL 
      *OPEN POINTIVA                                           
001270*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 4 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE AT67-CODSOCIE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE AT67-AANUMFAT
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 7 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001271                                                                  
001272     PERFORM L07-FETCH-POINTIVA                                   
001273        THRU L07-EX.                                              
001274     PERFORM B60-ELABORA-POINTIVA                                 
001275        THRU B60-EX                                               
001276          UNTIL SQLCODE EQUAL +100.                               
001277                                                                  
001278     MOVE 'CLOSE'                TO WCOM-FILEFUNZ.                
001279     MOVE 'POINTIVA'             TO WCOM-FILENOME.                
001280     MOVE 'B50-'                 TO WCOM-CODABEND.                
001281     MOVE SPACES                 TO WCOM-FILECTRL.                
001282                                                                  
001284     
      *EXEC SQL 
      *CLOSE POINTIVA                                          
001285*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 7 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001286                                                                  
001287 B50-EX. EXIT.                                                   
001288*----------------------------------------------------------------*
001289 B60-ELABORA-POINTIVA.                                            
001290*----------------------------------------------------------------*
001291                                                                  
001292     PERFORM VARYING IND-I FROM 1 BY 1                            
001293       UNTIL IND-I > MAXIND-I                                     
001294          OR  IVA-NUMESIVA(IND-I) NOT > SPACES                    
001295          OR (IVA-NUMESIVA(IND-I)= AT66-NUMESIVA AND              
001296              IVA-DATESIVA(IND-I)= AT66-DATESIVA)                 
001297     END-PERFORM                                                  
001298     IF IND-I > MAXIND-I                                          
001299        MOVE 'TABELLA'           TO WCOM-FILEFUNZ                 
001300        MOVE 'IVA'               TO WCOM-FILENOME                 
001301        MOVE 'B60-'              TO WCOM-CODABEND                 
001302        MOVE 'TABELLA PICCOLA'   TO WCOM-FILECTRL                 
001303        PERFORM Z00-ERRORE                                        
001304           THRU Z00-EX.                                           
001305                                                                  
001306     IF IVA-NUMESIVA(IND-I) NOT > SPACES                          
001307        MOVE AT66-NUMESIVA       TO IVA-NUMESIVA(IND-I)           
001308        MOVE AT66-DATESIVA       TO IVA-DATESIVA(IND-I)           
001309        MOVE AT66-UFFICIVA       TO IVA-UFFICIVA(IND-I).          
001310                                                                  
001311     PERFORM L07-FETCH-POINTIVA                                   
001312        THRU L07-EX.                                              
001313                                                                  
001314 B60-EX. EXIT.                                                   
001315*----------------------------------------------------------------*
001316 C00-NUMERO-FATTURA.                                              
001317*----------------------------------------------------------------*
001318                                                                  
001319     MOVE SPACES                 TO DCKYNUM.                      
001320                                                                  
001321     MOVE A901-CODCLIEN          TO DCKY-CODCLIEN.                
001322                                                                  
001323     MOVE WS-CODSOCIE            TO DCKY-CODSOCIE.                
001324     MOVE '7'                    TO DCKY-CODIMOVI.                
001325     IF WS-CONTPROV = 'FATWEB'                                    
001326        MOVE '9'                 TO DCKY-CODIMOVI.                
001327     MOVE 'F'                    TO DCKY-TIPOPROC.                
001328     MOVE ' '                    TO DCKY-TIPOMOVI.                
001329     MOVE 'SCBNUM5'              TO PPCALL.                       
001330     CALL PPCALL              USING DCPARM  DCKYNUM.              
001331                                                                  
001332     IF  DCKY-RISPOSTA NOT = '****'                               
001333         MOVE 'C00-'             TO WCOM-CODABEND                 
001334         MOVE 'MODULO'           TO WCOM-FILEFUNZ                 
001335         MOVE 'SCBNUM5'          TO WCOM-FILENOME                 
001336         MOVE DCKY-RISPOSTA      TO WCOM-FILECTRL                 
001337         PERFORM Z00-ERRORE                                       
001338            THRU Z00-EX.                                          
001339                                                                  
001340     MOVE DCKY-NUMEAUTO(4:6)     TO WS-NUMEAUTO.                  
001341                                                                  
001342 C00-EX. EXIT.                                                    
001343*----------------------------------------------------------------*
001344 C10-NUMERO-PROFORMA.                                             
001345*----------------------------------------------------------------*
001346                                                                  
001347     MOVE SPACES                 TO DCNUME.                       
001348                                                                  
001349     MOVE 'PROFORML'             TO DCNU-SIGLNUME.                
001350     MOVE 'R'                    TO DCNU-FLAGOPER.                
001351     PERFORM C20-SCANUME                                          
001352        THRU C20-EX.                                              
001353                                                                  
001354     MOVE 'U'                    TO DCNU-FLAGOPER.                
001355     MOVE DCNU-NUMEAUTO (4:6)    TO WS-NUMEAUTO.                  
001356     ADD  1                      TO WS-NUMEAUT9.                  
001357     MOVE WS-NUMEAUTO            TO DCNU-NUMEAUTO (4:6).          
001358     PERFORM C20-SCANUME                                          
001359        THRU C20-EX.                                              
001360                                                                  
001361 C10-EX. EXIT.                                                    
001362*----------------------------------------------------------------*
001363 C20-SCANUME.                                                     
001364*----------------------------------------------------------------*
001365                                                                  
001366     MOVE 'C20-'                    TO WCOM-CODABEND.             
001367     MOVE 'LETTURA'                 TO WCOM-FILEFUNZ.             
001368     MOVE 'SCANUME'                 TO WCOM-FILENOME.             
001369     MOVE DCNUME                    TO WCOM-FILECTRL.             
001370                                                                  
001371     MOVE 'SCANUME'                 TO  PPCALL.                   
001372     CALL PPCALL  USING  DCPARM  DCNUME.                          
001373     IF DCNU-RISPOSTA NOT = '****'                                
001374        PERFORM Z00-ERRORE                                        
001375           THRU Z00-EX.                                           
001376                                                                  
001377 C20-EX. EXIT.                                                    
001378*----------------------------------------------------------------*
001379 D00-PREPARA-DICITURE.                                            
001380*----------------------------------------------------------------*
001381                                                                  
001382     MOVE 'DATE'                 TO WS-LINGDELL.                  
001383     MOVE '   AMOUNT'            TO WS-LINGIMPO.                  
001384     MOVE 'VAT'                  TO WS-LINGIVAA.                  
001385     MOVE 'TOTAL '               TO WS-LINGTOTA.                  
001386     MOVE 'QUANTITY'             TO WS-LINGQUAN.                  
001387     MOVE ' PRICE'               TO WS-LINGPREZ.                  
001388     MOVE 'DESCRIPT.'            TO WS-LINGDESC.                  
001389     MOVE 'QUAL.'                TO WS-LINGARTI.                  
001390     MOVE 'TM'                   TO WS-LINGTMER.                  
001391     MOVE 'CI'                   TO WS-LINGCICL.                  
001392                                                                  
001393     MOVE 'ORDER NR'             TO WS-LINGORDI.                  
001394     MOVE 'SERVICE'              TO WS-LINGSERV.                  
001395     MOVE 'UM'                   TO WS-LINGUNMI.                  
001396                                                                  
001397     IF A901-CODILING = 'F'                                       
001398        MOVE 'DATE'              TO WS-LINGDELL                   
001399        MOVE '  MONTANT'         TO WS-LINGIMPO                   
001400        MOVE 'T.V.A.'            TO WS-LINGIVAA                   
001401        MOVE 'TOTAL '            TO WS-LINGTOTA                   
001402        MOVE 'QUANTITE'          TO WS-LINGQUAN                   
001403        MOVE '  PRIX'            TO WS-LINGPREZ                   
001404        MOVE 'ORDRES'            TO WS-LINGORDI                   
001405        MOVE 'SERVICE'           TO WS-LINGSERV                   
001406        MOVE 'UM'                TO WS-LINGUNMI                   
001407        MOVE 'DESCRIPT.'         TO WS-LINGDESC                   
001408        MOVE 'ARTIC'             TO WS-LINGARTI                   
001409        MOVE 'TM'                TO WS-LINGTMER                   
001410        MOVE 'CI'                TO WS-LINGCICL                   
001411     END-IF                                                       
001412                                                                  
001413     IF A901-CODILING = 'D'                                       
001414        MOVE 'DATUM'             TO WS-LINGDELL                   
001415        MOVE '   BETRAG'         TO WS-LINGIMPO                   
001416        MOVE 'MWST'              TO WS-LINGIVAA                   
001417        MOVE 'TOTAL '            TO WS-LINGTOTA                   
001418        MOVE '   MENGE'          TO WS-LINGQUAN                   
001419        MOVE ' PREIS'            TO WS-LINGPREZ                   
001420        MOVE 'AUFTRAEGE'         TO WS-LINGORDI                   
001421        MOVE 'SERVICE'           TO WS-LINGSERV                   
001422        MOVE 'UM'                TO WS-LINGUNMI                   
001423        MOVE 'BESCHREIB.'        TO WS-LINGDESC                   
001424        MOVE 'ARTIK'             TO WS-LINGARTI                   
001425        MOVE 'TM'                TO WS-LINGTMER                   
001426        MOVE 'CI'                TO WS-LINGCICL                   
001427     END-IF                                                       
001428                                                                  
001429     IF A901-CODILING = 'E'                                       
001430        MOVE 'FECHA'             TO WS-LINGDELL                   
001431        MOVE '  IMPORTO'         TO WS-LINGIMPO                   
001432        MOVE 'I.V.A.'            TO WS-LINGIVAA                   
001433        MOVE 'TOTAL '            TO WS-LINGTOTA                   
001434        MOVE 'CANTIDAD'          TO WS-LINGQUAN                   
001435        MOVE 'PRECIO'            TO WS-LINGPREZ                   
001436        MOVE 'ORDEN'             TO WS-LINGORDI                   
001437        MOVE 'SERVICIO'          TO WS-LINGSERV                   
001438        MOVE 'UM'                TO WS-LINGUNMI                   
001439        MOVE 'DESCRIPT.'         TO WS-LINGDESC                   
001440        MOVE 'ARTIC'             TO WS-LINGARTI                   
001441        MOVE 'TM'                TO WS-LINGTMER                   
001442        MOVE 'CI'                TO WS-LINGCICL                   
001443     END-IF                                                       
001444                                                                  
001445     IF A901-CODILING = 'I'                                       
001446        MOVE 'DEL'               TO WS-LINGDELL                   
001447        MOVE '  IMPORTO'         TO WS-LINGIMPO                   
001448        MOVE 'I.V.A.'            TO WS-LINGIVAA                   
001449        MOVE 'TOTALE'            TO WS-LINGTOTA                   
001450        MOVE 'QUANTITA'          TO WS-LINGQUAN                   
001451        MOVE 'PREZZO'            TO WS-LINGPREZ                   
001452        MOVE 'N. ORDINE'         TO WS-LINGORDI                   
001453        MOVE 'SERVIZIO'          TO WS-LINGSERV                   
001454        MOVE 'UM'                TO WS-LINGUNMI                   
001455        MOVE 'DESCRIZ.'          TO WS-LINGDESC                   
001456        MOVE 'ARTIC'             TO WS-LINGARTI                   
001457        MOVE 'TM'                TO WS-LINGTMER                   
001458        MOVE 'CI'                TO WS-LINGCICL                   
001459     END-IF.                                                      
001460                                                                  
001461 D00-EX. EXIT.                                                   
001462*----------------------------------------------------------------*
001463 D10-STAMPA-FATTURA.                                              
001464*----------------------------------------------------------------*
001465                                                                  
001466     MOVE ZEROES                 TO WS-NRTIRIFA.                  
001467     PERFORM D20-RIGHE-TESTATA                                    
001468        THRU D20-EX.                                              
001469                                                                  
001470     PERFORM D50-RIGHE-FATTURE                                    
001471        THRU D50-EX.                                              
001472                                                                  
001473     IF WS-FLAGGIVA NOT = 'S'                                     
001474        PERFORM D70-CREA-RIGHE-ESENTIVA                           
001475           THRU D70-EX.                                           
001476                                                                  
001477     IF WS-TIPSERVI = 'M' AND                                     
001478        A901-PAESMERC = '000'                                     
001479        MOVE '1'                 TO A842-TIPOMERC                 
001480        MOVE WS-CODSOCIE         TO A842-CODSOCIE                 
001481        MOVE A901-PAESMERC       TO A842-CODPAESE                 
001482        MOVE 'M'                 TO A842-FLFATMER                 
001483        MOVE 'FD'                TO A842-TIPODOCU                 
001484        PERFORM D105-DICITURE                                     
001485           THRU D105-EX.                                          
001486                                                                  
001487     IF WS-CONTPROV NOT = 'FATWEB'                                
001488        MOVE '1'                 TO A842-TIPOMERC                 
001489        MOVE WS-CODSOCIE         TO A842-CODSOCIE                 
001490        MOVE A901-PAESFATT       TO A842-CODPAESE                 
001491        MOVE 'F'                 TO A842-FLFATMER                 
001492        MOVE 'FD'                TO A842-TIPODOCU                 
001493        PERFORM D105-DICITURE                                     
001494           THRU D105-EX.                                          
001495                                                                  
001496     IF NOTE-NOTEORDI(1) > SPACES                                 
001497        MOVE SPACES              TO C805-RIGAFATT                 
001498        PERFORM I00-INSERT-RIGHEDOCU                              
001499           THRU I00-EX 2 TIMES.                                   
001500                                                                  
001501     PERFORM D130-STAMPA-NOTE                                     
001502        THRU D130-EX                                              
001503            VARYING IND-N FROM 1 BY 1                             
001504              UNTIL IND-N > MAXIND-N                              
001505                 OR NOTE-NOTEORDI(IND-N) NOT > SPACES.            
001506                                                                  
001507     IF RIFE-RIFORDIN(1, 1) > SPACES                              
001508        MOVE SPACES              TO C805-RIGAFATT                 
001509        PERFORM I00-INSERT-RIGHEDOCU                              
001510           THRU I00-EX.                                           
001511                                                                  
001512     IF RIFE-RIFORDIN(1, 1) > SPACES                              
001513        MOVE SPACES TO RIFE-VIRGOLAX(IND-R-SAVE,IND-E-SAVE)       
001514        PERFORM D140-STAMPA-RIFORDIN                              
001515           THRU D140-EX                                           
001516                VARYING IND-R FROM 1 BY 1                         
001517                  UNTIL IND-R > MAXIND-R                          
001518                     OR RIFE-ELEMENTO(IND-R) NOT > SPACES.        
001519                                                                  
001520     MOVE '30'                   TO C805-TIRIGFAT.                
001521                                                                  
001522     PERFORM D110-CALL-SCBSCA5                                    
001523        THRU D110-EX.                                             
001524                                                                  
001525     PERFORM D120-ELABORA-SCADENZE                                
001526        THRU D120-EX                                              
001527          VARYING IND FROM 1 BY 1                                 
001528           UNTIL  IND GREATER     4 OR                            
001529                   OUT-DATASCAD (IND) = ZEROES.                   
001530                                                                  
001531     MOVE WS-RIGAST01           TO C805-RIGAFATT.                 
001532                                                                  
001533     PERFORM I00-INSERT-RIGHEDOCU                                 
001534        THRU I00-EX.                                              
001535                                                                  
001536 D10-EX. EXIT.                                                   
001537*----------------------------------------------------------------*
001538 D20-RIGHE-TESTATA.                                               
001539*----------------------------------------------------------------*
001540                                                                  
001541     MOVE SPACES                 TO DCLTRIGHEDOCU.                
001542     INITIALIZE                     DCLTRIGHEDOCU.                
001543                                                                  
001544     MOVE '05'                   TO C805-TIRIGFAT.                
001545                                                                  
001546     MOVE A019-DESCMOVI          TO WS-DESCMOVI.                  
001547     IF WS-PROVADEF NOT = 'D'                                     
001548        MOVE 'PROFORMA '         TO WS-DESCMOVI.                  
001549                                                                  
001550     IF A531-CODPAESE = '068'                                     
001551        STRING WS-DESCMOVI 'N. ' '0000' WS-NUMEAUTO ' '           
001552               DELIMITED BY SIZE INTO C805-RIGAFATT               
001553     ELSE                                                         
001554        STRING WS-DESCMOVI ' N. ' WS-NUMEAUTO ' '                 
001555               DELIMITED BY SIZE INTO C805-RIGAFATT.              
001556                                                                  
001557     IF A901-PAESFATT     = '000'         AND                     
001558        A531-CODPAESE     = '000'         AND                     
001559        A901-FLFATELE     = 'S'                                   
001560        MOVE 'COPIA DI CORTESIA'   TO C805-RIGAFATT(45:)          
001561     END-IF                                                       
001562                                                                  
001563     PERFORM I00-INSERT-RIGHEDOCU                                 
001564        THRU I00-EX.                                              
001565                                                                  
001566     STRING WS-LINGDELL ' '                                       
001567            WS-DTGIORNO(7:2) '/' WS-DTGIORNO(5:2) '/'             
001568            WS-DTGIORNO(1:4)                                      
001569            DELIMITED BY SIZE INTO C805-RIGAFATT.                 
001570     PERFORM I00-INSERT-RIGHEDOCU                                 
001571        THRU I00-EX.                                              
001572                                                                  
001573     MOVE SPACES                 TO WS-CAMPORAS(1:15).            
001574     MOVE WS-RIGAST01            TO C805-RIGAFATT.                
001575     PERFORM I00-INSERT-RIGHEDOCU                                 
001576        THRU I00-EX.                                              
001577                                                                  
001578     MOVE A901-RAGMERCE          TO WS-CAMPORAS.                  
001579     MOVE A901-RAGFATTU          TO WS-CAMPO024.                  
001580     MOVE WS-RIGAST01            TO C805-RIGAFATT                 
001581                                    WS-RIGAPAC1.                  
001582     MOVE '10'                   TO C805-TIRIGFAT.                
001583     PERFORM I00-INSERT-RIGHEDOCU                                 
001584        THRU I00-EX.                                              
001585                                                                  
001586     MOVE A901-ESRAGMER          TO WS-CAMPORAS.                  
001587     MOVE A901-ESRAGFAT          TO WS-CAMPO024.                  
001588     MOVE WS-RIGAST01            TO C805-RIGAFATT                 
001589                                    WS-RIGAPAC2.                  
001590     PERFORM I00-INSERT-RIGHEDOCU                                 
001591        THRU I00-EX.                                              
001592                                                                  
001593     MOVE A901-INDMERCE          TO WS-CAMPORAS.                  
001594     MOVE A901-INDFATTU          TO WS-CAMPO024.                  
001595     MOVE WS-RIGAST01            TO C805-RIGAFATT                 
001596                                    WS-RIGAPAC3.                  
001597     PERFORM I00-INSERT-RIGHEDOCU                                 
001598        THRU I00-EX.                                              
001599                                                                  
001600     MOVE A901-ESINDMER          TO WS-CAMPORAS.                  
001601     MOVE A901-ESINDFAT          TO WS-CAMPO024.                  
001602     MOVE WS-RIGAST01            TO C805-RIGAFATT                 
001603                                    WS-RIGAPAC4.                  
001604     PERFORM I00-INSERT-RIGHEDOCU                                 
001605        THRU I00-EX.                                              
001606                                                                  
001607     MOVE SPACES                 TO WS-RIGAPAC5.                  
001608     IF (A901-ZIPMERCE > SPACES      AND                          
001609         A901-CAPMERCE NOT > SPACES) OR                           
001610        (A901-ZIPFATTU > SPACES      AND                          
001611         A901-CAPFATTU NOT > SPACES)                              
001612         PERFORM D21-STAMPA-ZIP                                   
001613            THRU D21-EX                                           
001614     ELSE                                                         
001615         PERFORM D22-STAMPA-CAP                                   
001616            THRU D22-EX.                                          
001617                                                                  
001618     STRING '          ' A901-ESCITMER                            
001619            DELIMITED BY SIZE  INTO WS-CAMPRASO.                  
001620     STRING '          ' A901-ESCITFAT                            
001621            DELIMITED BY SIZE  INTO WS-CAMPO033.                  
001622     MOVE WS-RIGAST01            TO C805-RIGAFATT                 
001623                                    WS-RIGAPAC7.                  
001624     PERFORM I00-INSERT-RIGHEDOCU                                 
001625        THRU I00-EX.                                              
001626                                                                  
001627     PERFORM D30-CODICE-FISCALE                                   
001628        THRU D30-EX.                                              
001629                                                                  
001630     MOVE '15'                   TO C805-TIRIGFAT.                
001631     PERFORM I00-INSERT-RIGHEDOCU                                 
001632        THRU I00-EX.                                              
001633                                                                  
001634     MOVE A901-CONDPAGA          TO A355-CONDPAGA.                
001635     IF A901-CODILING = 'B'                                       
001636        MOVE 'J'                 TO A355-CODILING                 
001637     ELSE                                                         
001638        MOVE A901-CODILING       TO A355-CODILING.                
001639                                                                  
001640     PERFORM L30-SELECT-CONDIPAGADESC                             
001641        THRU L30-EX.                                              
001642     IF SQLCODE = +100                                            
001643        MOVE A901-CONDPAGA       TO A355-CONDPAGA                 
001644        MOVE 'I'                 TO A355-CODILING                 
001645        PERFORM L30-SELECT-CONDIPAGADESC                          
001646           THRU L30-EX                                            
001647        IF SQLCODE NOT = ZEROES                                   
001648           PERFORM Z00-ERRORE                                     
001649              THRU Z00-EX.                                        
001650                                                                  
001651     MOVE A355-DESCPAGA          TO C805-RIGAFATT.                
001652                                                                  
001653     PERFORM I00-INSERT-RIGHEDOCU                                 
001654        THRU I00-EX 4 TIMES.                                      
001655                                                                  
001656     MOVE A901-CODCLIEN          TO WS-CODCLIE6.                  
001657     MOVE A529-SIGLAPAE          TO WS-SIGLPAE6.                  
001658     MOVE WS-RIGAST06            TO C805-RIGAFATT.                
001659     MOVE '20'                   TO C805-TIRIGFAT.                
001660     PERFORM I00-INSERT-RIGHEDOCU                                 
001661        THRU I00-EX.                                              
001662                                                                  
001663 D20-EX. EXIT.                                                   
001664*----------------------------------------------------------------*
001665 D21-STAMPA-ZIP.                                                  
001666*----------------------------------------------------------------*
001667                                                                  
001668     IF WS-SIGPAMER GREATER SPACES                                
001669        MOVE A901-ZIPMERCE       TO WS-CAMPXCAP.                  
001670                                                                  
001671     MOVE A901-ZIPFATTU          TO WS-CAMPO033.                  
001672     MOVE WS-RIGAST01            TO C805-RIGAFATT                 
001673                                    WS-RIGAPAC5.                  
001674     PERFORM I00-INSERT-RIGHEDOCU                                 
001675        THRU I00-EX.                                              
001676                                                                  
001677     IF WS-SIGPAMER GREATER SPACES                                
001678        STRING WS-SIGPAMER ' '                                    
001679               A901-CITMERCE                                      
001680           DELIMITED BY SIZE   INTO WS-CAMPXCAP.                  
001681                                                                  
001682     STRING WS-SIGPAFAT ' '                                       
001683            A901-CITFATTU ' ' A901-ZONAFATT                       
001684            DELIMITED BY SIZE  INTO WS-CAMPO033.                  
001685     MOVE WS-RIGAST01            TO C805-RIGAFATT                 
001686                                    WS-RIGAPAC6.                  
001687     PERFORM I00-INSERT-RIGHEDOCU                                 
001688        THRU I00-EX.                                              
001689                                                                  
001690 D21-EX. EXIT.                                                   
001691*----------------------------------------------------------------*
001692 D22-STAMPA-CAP.                                                  
001693*----------------------------------------------------------------*
001694                                                                  
001695     IF WS-SIGPAMER GREATER SPACES                                
001696        STRING WS-SIGPAMER '-' A901-CAPMERCE ' '                  
001697               A901-CITMERCE                                      
001698           DELIMITED BY SIZE   INTO WS-CAMPXCAP.                  
001699                                                                  
001700     STRING WS-SIGPAFAT '-' A901-CAPFATTU ' '                     
001701            A901-CITFATTU ' ' A901-ZONAFATT                       
001702            DELIMITED BY SIZE  INTO WS-CAMPO033.                  
001703     MOVE WS-RIGAST01            TO C805-RIGAFATT                 
001704                                    WS-RIGAPAC6.                  
001705     PERFORM I00-INSERT-RIGHEDOCU                                 
001706        THRU I00-EX.                                              
001707                                                                  
001708 D22-EX. EXIT.                                                   
001709*----------------------------------------------------------------*
001710 D30-CODICE-FISCALE.                                              
001711*----------------------------------------------------------------*
001712                                                                  
001713     INITIALIZE                     DCNMFA.                       
001714     MOVE A531-CODPAESE          TO NMFA-PAESOCIE.                
001715     MOVE A531-CODSOCIE          TO NMFA-CODSOCIE.                
001716     MOVE A901-PAESMERC          TO NMFA-PAEMERCE.                
001717     MOVE A901-PAESFATT          TO NMFA-PAEFATTU.                
001718     MOVE A901-CDIVACEE          TO NMFA-CDIVACEE.                
001719     MOVE WS-CODCLIEN            TO NMFA-CODCLIEN.                
001720     PERFORM L40-SCBNMFA                                          
001721        THRU L40-EX.                                              
001722                                                                  
001723     IF A901-PAESFATT EQUAL '068'                                 
001724        IF A901-BULSTATX GREATER SPACES                           
001725           STRING 'BULSTAT : ' A901-BULSTATX                      
001726                  DELIMITED BY SIZE INTO C805-RIGAFATT            
001727           IF A531-CODPAESE = '068' AND                           
001728              A901-CODILING EQUAL 'B'                             
001729              STRING ' : ' A901-BULSTATX                   
001730              DELIMITED BY SIZE INTO C805-RIGAFATT.               
001731                                                                  
001732     IF NMFA-FLPARIVA = 'I'                                       
001733        PERFORM D40-CFISC-INTERNO                                 
001734           THRU D40-EX                                            
001735     ELSE                                                         
001736        IF NMFA-FLPARIVA = 'C'                                    
001737           STRING 'VAT REG.NO: '     A901-CDIVACEE                
001738                  DELIMITED BY SIZE INTO C805-RIGAFATT            
001739        ELSE                                                      
001740           IF A901-CODFISCA >  SPACES                             
001741              IF A901-PAESFATT = '400'                            
001742                 STRING 'TAX ID: ' A901-CODFISCA                  
001743                    DELIMITED BY SIZE INTO C805-RIGAFATT          
001744              ELSE                                                
001745                 MOVE A901-CODFISCA     TO C805-RIGAFATT.         
001746                                                                  
001747 D30-EX. EXIT.                                                   
001748*----------------------------------------------------------------*
001749 D40-CFISC-INTERNO.                                               
001750*----------------------------------------------------------------*
001751                                                                  
001752     IF A901-CODFISCA GREATER SPACES                              
001753        IF WS-CODSOCIE = '09' OR '22' OR '24'                     
001754           IF A901-PAESFATT EQUAL '000' OR '005'                  
001755              MOVE A901-CODFISCA        TO WS-CODFISCA            
001756              IF WS-CODFISCA-11 IS NUMERIC                        
001757                 STRING 'PARTITA I.V.A. ' A901-CODFISCA           
001758                        DELIMITED BY SIZE INTO C805-RIGAFATT      
001759              ELSE                                                
001760                 STRING 'CODICE FISCALE ' A901-CODFISCA           
001761                        DELIMITED BY SIZE INTO C805-RIGAFATT      
001762              END-IF                                              
001763           END-IF                                                 
001764        ELSE                                                      
001765           IF A901-PAESFATT = '011' AND                           
001766              A531-CODPAESE = '011'                               
001767              MOVE A901-CODFISCA TO C805-RIGAFATT                 
001768           ELSE                                                   
001769              IF A901-PAESFATT = '068'                            
001770                 STRING '         V.A.T : ' A901-BULSTATX         
001771                        DELIMITED BY SIZE INTO C805-RIGAFATT      
001772                 IF A531-CODPAESE = '068' AND                     
001773                    A901-CODILING EQUAL 'B'                       
001774                    STRING '.     : ' A901-BULSTATX       
001775                           DELIMITED BY SIZE INTO C805-RIGAFATT.  
001776                                                                  
001777 D40-EX. EXIT.                                                   
001778*----------------------------------------------------------------*
001779 D50-RIGHE-FATTURE.                                               
001780*----------------------------------------------------------------*
001781                                                                  
001782     MOVE WS-CODPIANO            TO C861-CODPIANO.                
001783     MOVE WS-CONTODCE            TO C861-CONTODCE.                
001784     PERFORM L95-SELECT-CONTIDCE                                  
001785        THRU L95-EX.                                              
001786                                                                  
001787     MOVE '25'                   TO C805-TIRIGFAT.                
001788     MOVE '1'                    TO C805-TIPORIGA.                
001789     MOVE ' '                    TO C805-RIGAFATT.                
001790     IF WS-CONTPROV = 'LOGGUA'                                    
001791        STRING 'SERVIZIO DI RECEPTION, PORTIERATO, CUSTODIA '     
001792               'E GUARDIANIA - '                                  
001793                'DAL ' S426-DTINIPER(7:2) '-'                     
001794                       S426-DTINIPER(5:2) '-'                     
001795                       S426-DTINIPER(3:2)                         
001796                ' AL ' S426-DTFINPER(7:2) '-'                     
001797                       S426-DTFINPER(5:2) '-'                     
001798                       S426-DTFINPER(3:2)                         
001799           DELIMITED BY SIZE   INTO C805-RIGAFATT                 
001800     ELSE                                                         
001801      IF WS-CONTPROV = 'LOGSTA'                                   
001802         STRING 'SERVIZIO DI PRODUZIONE CARTELLE COLORI E VARIE'  
001803                ' - '                                             
001804                'DAL ' S426-DTINIPER(7:2) '-'                     
001805                       S426-DTINIPER(5:2) '-'                     
001806                       S426-DTINIPER(3:2)                         
001807                ' AL ' S426-DTFINPER(7:2) '-'                     
001808                       S426-DTFINPER(5:2) '-'                     
001809                       S426-DTFINPER(3:2)                         
001810           DELIMITED BY SIZE   INTO C805-RIGAFATT                 
001811      ELSE                                                        
001812       IF WS-CONTPROV = 'LOGENE'                                  
001813          STRING 'SERVIZI DI GESTIONE ENERGETICA'                 
001814                ' - '                                             
001815                'DAL ' S426-DTINIPER(7:2) '-'                     
001816                       S426-DTINIPER(5:2) '-'                     
001817                       S426-DTINIPER(3:2)                         
001818                ' AL ' S426-DTFINPER(7:2) '-'                     
001819                       S426-DTFINPER(5:2) '-'                     
001820                       S426-DTFINPER(3:2)                         
001821           DELIMITED BY SIZE   INTO C805-RIGAFATT                 
001822       ELSE                                                       
001823         IF WS-CONTPROV = 'FACON'                                 
001824            STRING 'FATTURAZIONE ' '- '                           
001825                    C861-DESCRDCE                                 
001826                ' - '                                             
001827                'MESE '                                           
001828                WS-MESEELAB(5:2) '/' WS-MESEELAB(1:4)             
001829               DELIMITED BY SIZE  INTO C805-RIGAFATT              
001830         ELSE                                                     
001831           IF WS-CONTPROV = 'FATGOV'                              
001832              STRING 'ADDEBITO BONIFICI/RESI '                    
001833                ' - '                                             
001834                'MESE '                                           
001835                WS-MESEELAB(5:2) '/' WS-MESEELAB(1:4)             
001836               DELIMITED BY SIZE  INTO C805-RIGAFATT              
001837           ELSE                                                   
001838             IF WS-CONTPROV = 'FATTEF'                            
001839                STRING 'ADDEBITO CONSUMO MAT.PRIMA'               
001840                       ' - '                                      
001841                       'MESE '                                    
001842                        WS-MESEELAB(5:2) '/' WS-MESEELAB(1:4)     
001843                DELIMITED BY SIZE  INTO C805-RIGAFATT             
001844             ELSE                                                 
001845               IF WS-CONTPROV = 'FATTIA'                          
001846                  STRING 'ADDEBITO MAT.PRIMA'                     
001847                         ' - '                                    
001848                         'MESE '                                  
001849                          WS-MESEELAB(5:2) '/' WS-MESEELAB(1:4)   
001850                  DELIMITED BY SIZE  INTO C805-RIGAFATT           
001851               ELSE                                               
001852               IF WS-TIPSERVI = 'M'                               
001853                  STRING 'SERVIZI DI MAGAZZINO ' '- '             
001854                          C861-DESCRDCE                           
001855                          ' - '                                   
001856                          'DAL ' S426-DTINIPER(7:2) '-'           
001857                                 S426-DTINIPER(5:2) '-'           
001858                                 S426-DTINIPER(3:2)               
001859                          ' AL ' S426-DTFINPER(7:2) '-'           
001860                                 S426-DTFINPER(5:2) '-'           
001861                                 S426-DTFINPER(3:2)               
001862                     DELIMITED BY SIZE  INTO C805-RIGAFATT        
001863               ELSE                                               
001864                 IF WS-TIPSERVI = 'L'                             
001865                    IF WS-CONTPROV = 'LOGMAG'                     
001866                       STRING 'VISITA FINITI'                     
001867                          ' - '                                   
001868                          'MESE '                                 
001869                           WS-MESEELAB(5:2) '/' WS-MESEELAB(1:4)  
001870                          DELIMITED BY SIZE INTO C805-RIGAFATT    
001871                    ELSE                                          
001872                       IF WS-CONTPROV = 'FATWEB'                  
001873                          MOVE 'THECOLORSOUP - VENDITA TESSUTO'   
001874                                              TO C805-RIGAFATT    
001875                       ELSE                                       
001876                          IF WS-CONTPROV = 'RICCOL'               
001877                             MOVE 'CUSTOM COLOUR MATCHING'        
001878                                              TO C805-RIGAFATT    
001879                          ELSE                                    
001880                            IF WS-CONTPROV = 'RICROT'             
001881                               STRING 'FATTURAZIONE ' '- '        
001882                                      C861-DESCRDCE               
001883                                  DELIMITED BY SIZE               
001884                                            INTO C805-RIGAFATT    
001885                            ELSE                                  
001886                          MOVE 'SERVIZI VARI - ALLEST/ROYALTIES'  
001887                                              TO C805-RIGAFATT    
001888                            END-IF                                
001889                          END-IF                                  
001890                       END-IF                                     
001891                    END-IF                                        
001892                 ELSE                                             
001893                     STRING 'GESTIONE SERVIZI TRASPORTI ' '- '    
001894                                          C861-DESCRDCE           
001895                          ' - '                                   
001896                          'DAL ' S426-DTINIPER(7:2) '-'           
001897                                 S426-DTINIPER(5:2) '-'           
001898                                 S426-DTINIPER(3:2)               
001899                          ' AL ' S426-DTFINPER(7:2) '-'           
001900                                 S426-DTFINPER(5:2) '-'           
001901                                 S426-DTFINPER(3:2)               
001902                        DELIMITED BY SIZE  INTO C805-RIGAFATT.    
001903                                                                  
001904     PERFORM I00-INSERT-RIGHEDOCU                                 
001905        THRU I00-EX.                                              
001906                                                                  
001907     MOVE ' '                    TO C805-TIPORIGA.                
001908     PERFORM I00-INSERT-RIGHEDOCU                                 
001909        THRU I00-EX.                                              
001910                                                                  
001911*    MOVE '  - VEDERE DETTAGLIO ALLEGATO -  '                     
001912*                                TO C805-RIGAFATT.                
001913                                                                  
001914     PERFORM I00-INSERT-RIGHEDOCU                                 
001915        THRU I00-EX 3 TIMES.                                      
001916                                                                  
001917     MOVE WS-LINGIMPO            TO WS-DESIMPO3                   
001918     MOVE A963-SLDIVBAN          TO WS-SIGLADI3                   
001919     MOVE WS-TOTMOVIM            TO WS-IMPORTO3                   
001920                                                                  
001921     MOVE WS-RIGAST03            TO C805-RIGAFATT                 
001922     PERFORM I00-INSERT-RIGHEDOCU                                 
001923        THRU I00-EX.                                              
001924                                                                  
001925     IF WS-FLAGGIVA = 'S'                                         
001926        MOVE WS-CODSOCIE         TO A122-CODSOCIE                 
001927        MOVE '*'                 TO A122-INDICIVA                 
001928        PERFORM L70-SELECT-ALIQUIVA                               
001929           THRU L70-EX                                            
001930        MOVE A122-PERIVAFA       TO WS-PERCEIVA                   
001931        IF WS-TOTIVAXX > ZEROES                                   
001932           MOVE WS-TOTIVAXX      TO WS-IMPORIVA                   
001933        ELSE                                                      
001934           COMPUTE WS-IMPORIVA =                                  
001935                   (WS-TOTMOVIM * A122-PERIVAFA) / 100            
001936           MOVE WS-IMPORIVA      TO ARR1-IMPORTOX                 
001937           PERFORM D60-INCLUDE-SRARR1                             
001938              THRU D60-EX                                         
001939           MOVE ARR1-IMPORTOX    TO WS-IMPORIVA                   
001940        END-IF                                                    
001941        MOVE '%'                 TO WS-SEGNOPE4                   
001942        MOVE WS-PERCEIVA         TO WS-PERCIVA4                   
001943        MOVE WS-LINGIVAA         TO WS-DESCIVA4                   
001944        MOVE WS-IMPORIVA         TO WS-IMPOIVA4                   
001945        MOVE WS-RIGAST04         TO C805-RIGAFATT                 
001946        PERFORM I00-INSERT-RIGHEDOCU                              
001947           THRU I00-EX.                                           
001948                                                                  
001949     COMPUTE WS-TOTFATTU = WS-TOTMOVIM + WS-IMPORIVA.             
001950                                                                  
001951     MOVE A963-SLDIVBAN          TO WS-SIGLADI5.                  
001952     MOVE '***'                  TO WS-ASTERIX5.                  
001953     MOVE SPACES                 TO WS-DESCRIG5.                  
001954     MOVE WS-LINGTOTA            TO WS-DESCTOT5.                  
001955     MOVE WS-TOTFATTU            TO WS-IMPOTRA5.                  
001956                                                                  
001957     MOVE WS-RIGAST05            TO C805-RIGAFATT.                
001958     PERFORM I00-INSERT-RIGHEDOCU                                 
001959        THRU I00-EX.                                              
001960                                                                  
001961     PERFORM I00-INSERT-RIGHEDOCU                                 
001962        THRU I00-EX 2 TIMES.                                      
001963                                                                  
001964 D50-EX. EXIT.                                                   
001965*----------------------------------------------------------------*
001966 D60-INCLUDE-SRARR1.                                              
001967*----------------------------------------------------------------*
001968                                                                  
001969     MOVE A963-CODDIVIS          TO ARR1-CODDIVIS.                
001970     MOVE A901-PAESFATT          TO ARR1-CODPAESE.                
001971     MOVE A963-DECIDIVI          TO ARR1-DECIDIVI.                
001974*    EXEC SQL                                                     
      *         INCLUDE SRARR1                                          
      *    END-EXEC.                                                    
      *>>((file: SRARR1))
000001*----------------------------------------------------------------*
000002*                                                                *
000003*    GESTIONE RIGHE DI FATTURA.                                  *
000004*                                                                *
000005*    CALCOLA IMPORTO IVA ARROTONDATO IN BASE AL CODICE DIVISA    *
000006*    OPPURE IN BASE AL NUMERO DI DECIMALI DELLA DIVISA.          *
000007*                                                                *
000008*    N.B.  INSERIRE IN WORKING STORAGE :                         *
000009*                                                                *
000010*    COPY DCARR1.                                                *
000011*                                                                *
000012*----------------------------------------------------------------*
000013                                                                  
000014     MOVE ZERO                   TO ARR1-ARROTIVA                 
000015                                    ARR1-INTEROXX                 
000016                                    ARR1-DECIMA2X.                
000017                                                                  
000018     IF ARR1-CODDIVIS = '75'                                      
000019        MOVE 0,005               TO ARR1-ARROTIVA                 
000020     ELSE                                                         
000021        IF ARR1-DECIDIVI = '0'                                    
000022           MOVE 0,4999           TO ARR1-ARROTIVA                 
000023           IF ARR1-CODPAESE = '000' OR '005'                      
000024              MOVE 0,9999        TO ARR1-ARROTIVA                 
000025           ELSE                                                   
000026              IF ARR1-CODPAESE = '004'                            
000027                 MOVE 0,5999     TO ARR1-ARROTIVA                 
000028              ELSE                                                
000029                 IF ARR1-CODPAESE = '068'                         
000030                    MOVE 0,5000  TO ARR1-ARROTIVA                 
000031                 END-IF                                           
000032        ELSE                                                      
000033           MOVE 0,0049           TO ARR1-ARROTIVA                 
000034           IF ARR1-CODPAESE = '000' OR '005'                      
000035              MOVE 0,0099        TO ARR1-ARROTIVA                 
000036           ELSE                                                   
000037              IF ARR1-CODPAESE = '004'                            
000038                 MOVE 0,0059     TO ARR1-ARROTIVA                 
000039              ELSE                                                
000040                 IF ARR1-CODPAESE = '068'                         
000041                    MOVE 0,0050  TO ARR1-ARROTIVA.                
000042                                                                  
000043     COMPUTE ARR1-IMPORTOX = ARR1-IMPORTOX + ARR1-ARROTIVA        
000044                                                                  
000045     IF ARR1-DECIDIVI = '0'                                       
000046        MOVE ARR1-IMPORTOX       TO ARR1-INTEROXX                 
000047        MOVE ARR1-INTEROXX       TO ARR1-IMPORTOX                 
000048     ELSE                                                         
000049        MOVE ARR1-IMPORTOX       TO ARR1-DECIMA2X                 
000050        MOVE ARR1-DECIMA2X       TO ARR1-IMPORTOX.                
      *<<((file: SRARR1))
001975                                                                  
001976 D60-EX. EXIT.                                                    
001977*----------------------------------------------------------------*
001978 D70-CREA-RIGHE-ESENTIVA.                                         
001979*----------------------------------------------------------------*
001980                                                                  
001981     PERFORM I00-INSERT-RIGHEDOCU                                 
001982        THRU I00-EX.                                              
001983                                                                  
001984     MOVE SPACES                    TO ESE0-ESENTIVA.             
001985                                                                  
001986     PERFORM D71-ESENTIVA                                         
001987        THRU D71-EX.                                              
001988                                                                  
001989     IF A901-PAESFATT = A531-CODPAESE AND                         
001990        A901-PAESFATT = '000'         AND                         
001991        WS-ESENTIVA = '1'                                         
001992        MOVE ''                 TO A842-CODIRESA                 
001993        MOVE WS-CODSOCIE         TO A842-CODSOCIE                 
001994        MOVE A901-PAESMERC       TO A842-CODPAESE                 
001995        MOVE 'M'                 TO A842-FLFATMER                 
001996        MOVE 'FD'                TO A842-TIPODOCU                 
001997        PERFORM D100-DICITURE                                     
001998           THRU D100-EX.                                          
001999                                                                  
002000 D70-EX. EXIT.                                                    
002001*----------------------------------------------------------------*
002002 D71-ESENTIVA.                                                    
002003*----------------------------------------------------------------*
002004                                                                  
002005     IF A901-PAESFATT = A531-CODPAESE AND                         
002006        A901-PAESFATT = '000'         AND                         
002007        WS-ESENTIVA = '1'                                         
002008        PERFORM D80-ESENTIVA-ITALIA                               
002009           THRU D80-EX                                            
002010     ELSE                                                         
002011        MOVE WS-CODSOCIE            TO ESE0-CODSOCIE              
002012        IF WS-ESENTIVA > SPACES                                   
002013           MOVE WS-ESENTIVA         TO ESE0-ESENTIVA              
002014        ELSE                                                      
002015           IF A901-PAESFATT   = '000' AND                         
002016              WS-TIPSERVI NOT = 'L'                               
002017              MOVE '4'              TO ESE0-ESENTIVA              
002018           ELSE                                                   
002019              MOVE A901-PAESFATT    TO A528-CODPAESE              
002020              PERFORM L55-SELECT-PAESI                            
002021                 THRU L55-EX                                      
002022              IF A528-FLPAECEE NOT = 'C'                          
002023                 IF WS-CONTPROV NOT = 'FATWEB'                    
002024                    MOVE 'V'        TO ESE0-ESENTIVA              
002025                 ELSE                                             
002026                    MOVE '1'        TO ESE0-ESENTIVA              
002027                 END-IF                                           
002028              ELSE                                                
002029                 IF WS-CONTPROV NOT = 'FATWEB'                    
002030                    MOVE 'V'        TO ESE0-ESENTIVA              
002031                 ELSE                                             
002032                    MOVE 'J'        TO ESE0-ESENTIVA              
002033                 END-IF                                           
002034              END-IF                                              
002035           END-IF                                                 
002036        END-IF                                                    
002037        PERFORM SRESEN0                                           
002038           THRU SRESEN0-EX                                        
002039        PERFORM D90-SCARICA-ESENZIONI                             
002040           THRU D90-EX.                                           
002041                                                                  
002042     IF WS-PROVADEF     = 'D' AND                                 
002043        NMFA-FLAGINTR   = 'S' AND                                 
002044        WS-TIPSERVI NOT = 'M' AND                                 
002045        WS-CONTPROV NOT = 'FATWEB'                                
002046        PERFORM D72-GESTIONE-INTRASTAT                            
002047           THRU D72-EX.                                           
002048                                                                  
002049 D71-EX. EXIT.                                                    
002050*----------------------------------------------------------------*
002051 D72-GESTIONE-INTRASTAT.                                          
002052*----------------------------------------------------------------*
002053                                                                  
002054     MOVE SPACES                 TO DCLTSCAMBICEE                 
002055     INITIALIZE                     DCLTSCAMBICEE                 
002056                                                                  
002057     MOVE 'V'                    TO A967-FLACQVEN                 
002058     MOVE WS-CODSOCIE            TO A967-CODSOCIE                 
002059     MOVE 'F'                    TO A967-CDMOVCON                 
002060     MOVE WS-NUMEAUTO            TO A967-NRMOVCON.                
002061     MOVE A901-CDIVACEE          TO A967-CDIVACEE.                
002062     MOVE WS-TOTMOVIM            TO A967-VLVOCEDO.                
002063     MOVE WS-CODDIVIS            TO A967-CODDIVIS.                
002064     MOVE 'C'                    TO A967-INCLIFOR.                
002065     MOVE WS-CODCLIEN            TO A967-CLIEFORN.                
002066     MOVE 'S'                    TO A967-FLSERMER.                
002067     IF WS-CONTPROV = 'ROYALL'                                    
002068        MOVE '774019'            TO A967-CDSERVIZ                 
002069     ELSE                                                         
002070        IF WS-TIPSERVI = 'L'                                      
002071           MOVE '181330'         TO A967-CDSERVIZ                 
002072        ELSE                                                      
002073           MOVE '494119'         TO A967-CDSERVIZ.                
002074                                                                  
002075     MOVE WS-DTGIORNO            TO A967-DTREGMOV                 
002076                                    A967-DTCREAZI                 
002077                                    A967-DTULTVAR.                
002078     MOVE 'AVLO90'               TO A967-CODUTVAR.                
002079                                                                  
002080     PERFORM I20-INSERT-SCAMBICEE                                 
002081        THRU I20-EX.                                              
002082                                                                  
002083 D72-EX. EXIT.                                                    
002084*----------------------------------------------------------------*
002085 D80-ESENTIVA-ITALIA.                                             
002086*----------------------------------------------------------------*
002087                                                                  
002088     PERFORM D81-SCARICA-ESENZIONI                                
002089        THRU D81-EX                                               
002090            VARYING IND-I FROM 1 BY 1                             
002091              UNTIL IND-I > MAXIND-I                              
002092                 OR IVA-NUMESIVA(IND-I) NOT > SPACES.             
002093                                                                  
002094     MOVE SPACES                 TO DCESE0.                       
002095     MOVE WS-CODSOCIE            TO ESE0-CODSOCIE                 
002096     MOVE 'L'                    TO ESE0-ESENTIVA                 
002097     PERFORM SRESEN0                                              
002098        THRU SRESEN0-EX                                           
002099     PERFORM D90-SCARICA-ESENZIONI                                
002100        THRU D90-EX.                                              
002101                                                                  
002102 D80-EX. EXIT.                                                    
002103*----------------------------------------------------------------*
002104 D81-SCARICA-ESENZIONI.                                           
002105*----------------------------------------------------------------*
002106                                                                  
002107     STRING 'N.PROGR. ' IVA-NUMESIVA(IND-I)                       
002108            ' DEL '     IVA-DATESIVA(IND-I) (7:2)  '/'            
002109                        IVA-DATESIVA(IND-I) (5:2)  '/'            
002110                        IVA-DATESIVA(IND-I) (3:2)                 
002111            DELIMITED BY SIZE  INTO C805-RIGAFATT.                
002112     PERFORM I00-INSERT-RIGHEDOCU                                 
002113        THRU I00-EX.                                              
002114                                                                  
002115 D81-EX. EXIT.                                                    
002116*----------------------------------------------------------------*
002117 D90-SCARICA-ESENZIONI.                                           
002118*----------------------------------------------------------------*
002119                                                                  
002120     IF ESE0-CODERROR NOT > SPACES                                
002121        PERFORM VARYING ESE0-INDICE FROM 1 BY 1                   
002122                  UNTIL ESE0-INDICE GREATER ESE0-MAX-IND          
002123                  OR ESE0-RIGASOLL (ESE0-INDICE) NOT > SPACES     
002124            MOVE ESE0-RIGASOLL (ESE0-INDICE) TO C805-RIGAFATT     
002125            PERFORM I00-INSERT-RIGHEDOCU                          
002126               THRU I00-EX                                        
002127        END-PERFORM                                               
002128        PERFORM I00-INSERT-RIGHEDOCU                              
002129           THRU I00-EX                                            
002130     ELSE                                                         
002131        MOVE 'D90-'              TO WCOM-CODABEND                 
002132        MOVE 'ESENZIONE'         TO WCOM-FILEFUNZ                 
002133        MOVE 'ERRORE'            TO WCOM-FILENOME                 
002134        MOVE ESE0-ESENTIVA       TO WCOM-FILECTRL                 
002135        PERFORM Z00-ERRORE                                        
002136           THRU Z00-EX.                                           
002137                                                                  
002138 D90-EX. EXIT.                                                    
002139*----------------------------------------------------------------*
002140 D100-DICITURE.                                                   
002141*----------------------------------------------------------------*
002142                                                                  
002143     PERFORM SRDESC1                                              
002144        THRU SRDESC1-EX.                                          
002145                                                                  
002146     IF DES1-CODERROR > SPACES                                    
002147        MOVE DES1-CODERROR       TO WCOM-CODABEND                 
002148        STRING A842-CODSOCIE ' ' A842-CODPAESE ' '                
002149               A842-FLFATMER ' ' A842-TIPODOCU                    
002150               DELIMITED BY SIZE INTO WCOM-FILECTRL               
002151        PERFORM Z00-ERRORE                                        
002152           THRU Z00-EX                                            
002153     ELSE                                                         
002154        PERFORM VARYING DES1-INDICE FROM 1 BY 1                   
002155          UNTIL DES1-INDICE GREATER DES1-MAX-IND                  
002156                OR DES1-RIGADOCU (DES1-INDICE) = HIGH-VALUE       
002157                MOVE DES1-RIGADOCU (DES1-INDICE) TO C805-RIGAFATT 
002158                PERFORM I00-INSERT-RIGHEDOCU                      
002159                   THRU I00-EX                                    
002160        END-PERFORM                                               
002161        PERFORM I00-INSERT-RIGHEDOCU                              
002162           THRU I00-EX.                                           
002163                                                                  
002164 D100-EX. EXIT.                                                   
002165*----------------------------------------------------------------*
002166 D105-DICITURE.                                                   
002167*----------------------------------------------------------------*
002168                                                                  
002169     PERFORM SRDESC0                                              
002170        THRU SRDESC0-EX.                                          
002171                                                                  
002172     IF DES0-CODERROR > SPACES                                    
002173        MOVE DES0-CODERROR       TO WCOM-CODABEND                 
002174        STRING A842-CODSOCIE ' ' A842-CODPAESE ' '                
002175               A842-FLFATMER ' ' A842-TIPODOCU                    
002176               DELIMITED BY SIZE INTO WCOM-FILECTRL               
002177        PERFORM Z00-ERRORE                                        
002178           THRU Z00-EX                                            
002179     ELSE                                                         
002180        PERFORM VARYING DES0-INDICE FROM 1 BY 1                   
002181          UNTIL DES0-INDICE GREATER DES0-MAX-IND                  
002182                OR DES0-RIGADOCU (DES0-INDICE) = HIGH-VALUE       
002183                MOVE DES0-RIGADOCU (DES0-INDICE) TO C805-RIGAFATT 
002184                PERFORM I00-INSERT-RIGHEDOCU                      
002185                   THRU I00-EX                                    
002186        END-PERFORM                                               
002187        PERFORM I00-INSERT-RIGHEDOCU                              
002188           THRU I00-EX.                                           
002189                                                                  
002190 D105-EX. EXIT.                                                   
002191*----------------------------------------------------------------*
002192 D110-CALL-SCBSCA5.                                               
002193*----------------------------------------------------------------*
002194                                                                  
002195     MOVE SPACES                 TO DCSCADEN                      
002196     INITIALIZE                     DCSCADEN                      
002197                                                                  
002198     MOVE A963-DECIDIVI          TO IN-DECIMALI.                  
002199     MOVE A901-CODCLIEN          TO IN-SCACLIEN.                  
002200     MOVE WS-TOTFATTU            TO IN-IMPOFATT.                  
002201     MOVE A901-CONDPAGA          TO IN-CONDPAGA.                  
002202     MOVE 'V'                    TO IN-TIPOFATT.                  
002203     MOVE WS-DTGIORNO            TO IN-DATAINIZ.                  
002204                                                                  
002205     MOVE 'SCBSCA5'              TO PPCALL.                       
002206     CALL PPCALL USING DCPARM DCSCADEN.                           
002207                                                                  
002208     IF DCSC-RISPOSTA NOT = '****'                                
002209        MOVE 'D110'              TO WCOM-CODABEND                 
002210        MOVE 'MODULO'            TO WCOM-FILEFUNZ                 
002211        MOVE 'SCBSCA5'           TO WCOM-FILENOME                 
002212        MOVE DCSC-RISPOSTA       TO WCOM-FILECTRL                 
002213        PERFORM Z00-ERRORE                                        
002214           THRU Z00-EX.                                           
002215                                                                  
002216 D110-EX. EXIT.                                                   
002217*----------------------------------------------------------------*
002218 D120-ELABORA-SCADENZE.                                           
002219*----------------------------------------------------------------*
002220                                                                  
002221     MOVE OUT-GGGGSCAD(IND)     TO WS-GGGGSCAD(IND).              
002222     MOVE '/'                   TO WS-BARRAXX1(IND).              
002223     MOVE OUT-MMMMSCAD(IND)     TO WS-MMMMSCAD(IND).              
002224     MOVE '/'                   TO WS-BARRAXX2(IND).              
002225     MOVE OUT-ANNOINIZ(IND)     TO WS-AAAASCAD(IND).              
002226                                                                  
002227     IF  A963-DECIDIVI  =  '0'                                    
002228         MOVE OUT-IMPOSCAD(IND)         TO WS-IMPSCADI (IND)      
002229     ELSE                                                         
002230         IF  OUT-IMPOSCAD (IND) GREATER ZEROES                    
002231             MOVE OUT-IMPOSCAD(IND)     TO WS-IMPSCADD (IND).     
002232                                                                  
002233 D120-EX. EXIT.                                                   
002234*----------------------------------------------------------------*
002235 D130-STAMPA-NOTE.                                                
002236*----------------------------------------------------------------*
002237                                                                  
002238     MOVE NOTE-NOTEORDI(IND-N)      TO C805-RIGAFATT              
002239     PERFORM I00-INSERT-RIGHEDOCU                                 
002240        THRU I00-EX.                                              
002241                                                                  
002242 D130-EX. EXIT.                                                   
002243*----------------------------------------------------------------*
002244 D140-STAMPA-RIFORDIN.                                            
002245*----------------------------------------------------------------*
002246                                                                  
002247     MOVE RIFE-ELEMENTO(IND-R)      TO C805-RIGAFATT.             
002248     PERFORM I00-INSERT-RIGHEDOCU                                 
002249        THRU I00-EX.                                              
002250                                                                  
002251 D140-EX. EXIT.                                                   
002252*----------------------------------------------------------------*
002253 E00-STAMPA-PACKING.                                              
002254*----------------------------------------------------------------*
002255                                                                  
002256     MOVE SPACES                 TO DCLTRIGHEPACARKI.             
002257     INITIALIZE                     DCLTRIGHEPACARKI.             
002258                                                                  
002259     MOVE SPACES                 TO PK-RIGAPAC1                   
002260                                    PK-RIGAPAC2                   
002261                                    PK-RIGAPAC3                   
002262                                    PK-RIGAPAC4                   
002263                                                                  
002264     MOVE ZEROES                 TO WS-NRTIRIFA.                  
002265                                                                  
002266     MOVE '01'                   TO F760-TIRIGPAK.                
002267     STRING '    ' WS-NUMEAUTO '     '                            
002268            WS-DTGIORNO(7:2) '/' WS-DTGIORNO(5:2) '/'             
002269            WS-DTGIORNO(1:4)                                      
002270        DELIMITED BY SIZE      INTO F760-RIGAPACK.                
002271                                                                  
002272     PERFORM I10-INSERT-RIGHEPACARKI                              
002273        THRU I10-EX.                                              
002274                                                                  
002275     MOVE SPACES                 TO F760-RIGAPACK.                
002276     PERFORM I10-INSERT-RIGHEPACARKI                              
002277        THRU I10-EX.                                              
002278                                                                  
002279     MOVE WS-RIGAPAC1            TO F760-RIGAPACK.                
002280     PERFORM I10-INSERT-RIGHEPACARKI                              
002281        THRU I10-EX.                                              
002282                                                                  
002283     MOVE WS-RIGAPAC2            TO F760-RIGAPACK.                
002284     PERFORM I10-INSERT-RIGHEPACARKI                              
002285        THRU I10-EX.                                              
002286                                                                  
002287     MOVE WS-RIGAPAC3            TO F760-RIGAPACK.                
002288     PERFORM I10-INSERT-RIGHEPACARKI                              
002289        THRU I10-EX.                                              
002290                                                                  
002291     MOVE WS-RIGAPAC4            TO F760-RIGAPACK.                
002292     PERFORM I10-INSERT-RIGHEPACARKI                              
002293        THRU I10-EX.                                              
002294                                                                  
002295     IF WS-RIGAPAC5 > SPACES                                      
002296        MOVE WS-RIGAPAC5         TO F760-RIGAPACK                 
002297        PERFORM I10-INSERT-RIGHEPACARKI                           
002298           THRU I10-EX.                                           
002299                                                                  
002300     MOVE WS-RIGAPAC6            TO F760-RIGAPACK.                
002301     PERFORM I10-INSERT-RIGHEPACARKI                              
002302        THRU I10-EX.                                              
002303                                                                  
002304     MOVE WS-RIGAPAC7            TO F760-RIGAPACK.                
002305     PERFORM I10-INSERT-RIGHEPACARKI                              
002306        THRU I10-EX.                                              
002307                                                                  
002308     MOVE SPACES                 TO F760-RIGAPACK.                
002309     PERFORM I10-INSERT-RIGHEPACARKI                              
002310        THRU I10-EX.                                              
002311                                                                  
002312     MOVE '02'                   TO F760-TIRIGPAK.                
002313                                                                  
002314     IF WS-TIPSERVI   = 'L' AND                                   
002315        A901-TIPOCONS > ' '                                       
002316        MOVE WS-LINGSERV         TO PK5-FILLER                    
002317        MOVE WS-LINGTMER         TO PK5-MERCEMAG                  
002318        MOVE WS-LINGARTI         TO PK5-CODARTIC                  
002319        MOVE WS-LINGDESC         TO PK5-DESARTIC                  
002320        MOVE WS-LINGCICL         TO PK5-SIGLCICL                  
002321        MOVE WS-LINGQUAN         TO PK5-QTAORDIN-X                
002322        MOVE WS-LINGUNMI         TO PK5-UNMISURA                  
002323        MOVE WS-LINGPREZ         TO PK5-PREZZORD-X                
002324        MOVE WS-LINGIMPO         TO PK5-IMPORDIN-X                
002325        MOVE PK-RIGAPAC5         TO F760-RIGAPACK                 
002326     ELSE                                                         
002327        MOVE WS-LINGORDI         TO PK-TESTORDI                   
002328        MOVE WS-LINGSERV         TO PK-TESTSERV                   
002329        MOVE WS-LINGQUAN         TO PK-TESTQUAN                   
002330        MOVE WS-LINGUNMI         TO PK-TESTUNMI                   
002331        MOVE WS-LINGPREZ         TO PK-TESTPREZ                   
002332        MOVE WS-LINGIMPO         TO PK-TESTIMPO                   
002333        MOVE PK-RIGAPAC1         TO F760-RIGAPACK                 
002334     END-IF                                                       
002335                                                                  
002336     PERFORM I10-INSERT-RIGHEPACARKI                              
002337        THRU I10-EX.                                              
002338                                                                  
002339     IF WS-TIPSERVI   = 'L' AND                                   
002340        A901-TIPOCONS > ' '                                       
002341        MOVE ALL '-'              TO PK5-MERCEMAG                 
002342                                     PK5-CODARTIC                 
002343                                     PK5-DESARTIC                 
002344                                     PK5-SIGLCICL                 
002345                                     PK5-QTAORDIN-X               
002346                                     PK5-UNMISURA                 
002347                                     PK5-PREZZORD-X               
002348                                     PK5-IMPORDIN-X               
002349                                     PK5-FILLER                   
002350        MOVE PK-RIGAPAC5         TO F760-RIGAPACK                 
002351     ELSE                                                         
002352        MOVE ALL '-'             TO PK-TRATTIN1                   
002353                                    PK-TRATTIN2                   
002354                                    PK-TRATTIN3                   
002355                                    PK-TRATTIN4                   
002356                                    PK-TRATTIN5                   
002357                                    PK-TRATTIN6                   
002358        MOVE PK-RIGAPAC2         TO F760-RIGAPACK                 
002359     END-IF                                                       
002360                                                                  
002361     PERFORM I10-INSERT-RIGHEPACARKI                              
002362        THRU I10-EX.                                              
002363                                                                  
002364     MOVE '03'                   TO F760-TIRIGPAK.                
002365     MOVE SPACES                 TO WS-CODSERVI                   
002366     PERFORM E10-RIGHE                                            
002367        THRU E10-EX                                               
002368             VARYING IND FROM 1 BY 1                              
002369               UNTIL IND                   > MAXIND               
002370                  OR PKL-CODSERVI(IND) NOT > SPACES.              
002371                                                                  
002372 E00-EX. EXIT.                                                    
002373*----------------------------------------------------------------*
002374 E10-RIGHE.                                                       
002375*----------------------------------------------------------------*
002376                                                                  
002377     IF WS-TIPSERVI   = 'L' AND                                   
002378        A901-TIPOCONS > ' '                                       
002379        IF PKL-IMPORDIN(IND) > 0                                  
002380           IF WS-CODSERVI NOT = PKL-CODSERVI(IND)                 
002381              MOVE PKL-CODSERVI(IND)   TO WS-CODSERVI             
002382              MOVE SPACES              TO F760-RIGAPACK           
002383              PERFORM I10-INSERT-RIGHEPACARKI                     
002384                 THRU I10-EX                                      
002385              MOVE PKL-CODSERVI(IND)   TO PK6-CODSERVI            
002386              MOVE PKL-DESSERVI(IND)   TO PK6-DESSERVI            
002387              MOVE PK-RIGAPAC6         TO F760-RIGAPACK           
002388              PERFORM I10-INSERT-RIGHEPACARKI                     
002389                 THRU I10-EX                                      
002390           END-IF                                                 
002391           MOVE PKL-MERCEMAG(IND)   TO PK5-MERCEMAG               
002392                                       WS-MERCEMAG                
002393           MOVE PKL-CODARTIC(IND)   TO PK5-CODARTIC               
002394                                       WS-CODARTIC                
002395           PERFORM L100-SELECT-ANAG                               
002396              THRU L100-EX                                        
002397           MOVE WS-DESARTIC         TO PK5-DESARTIC               
002398           IF PKL-UNMISURA(IND) NOT = 'FF'                        
002399              MOVE PKL-QTAORDIN(IND)   TO PK5-QTAORDIN            
002400              MOVE PKL-UNMISURA(IND)   TO PK5-UNMISURA            
002401              MOVE PKL-PREZZORD(IND)   TO PK5-PREZZORD            
002402           ELSE                                                   
002403              MOVE SPACES              TO PK5-QTAORDIN-X          
002404                                          PK5-UNMISURA            
002405                                          PK5-PREZZORD-X          
002406           END-IF                                                 
002407           MOVE PKL-SIGLCICL(IND)   TO PK5-SIGLCICL               
002408           MOVE PKL-IMPORDIN(IND)   TO PK5-IMPORDIN               
002409           MOVE SPACES              TO PK5-FILLER                 
002410           MOVE PK-RIGAPAC5         TO F760-RIGAPACK              
002411           PERFORM I10-INSERT-RIGHEPACARKI                        
002412              THRU I10-EX                                         
002413        END-IF                                                    
002414     ELSE                                                         
002415        MOVE PKL-AANUMORD(IND)   TO PK-AANUMORD                   
002416        MOVE PKL-CODSERVI(IND)   TO PK-CODSERVI                   
002417        MOVE PKL-QTAORDIN(IND)   TO PK-QTAORDIN                   
002418        MOVE PKL-UNMISURA(IND)   TO PK-UNMISURA                   
002419        MOVE PKL-PREZZORD(IND)   TO PK-PREZZORD                   
002420        MOVE PKL-IMPORDIN(IND)   TO PK-IMPORDIN                   
002421        MOVE PK-RIGAPAC3         TO F760-RIGAPACK                 
002422        PERFORM I10-INSERT-RIGHEPACARKI                           
002423           THRU I10-EX                                            
002424        MOVE PKL-DESSERVI(IND)   TO PK-DESSERVI                   
002425        MOVE PKL-NOTENOTE(IND)   TO PK-NOTENOTE                   
002426        MOVE PK-RIGAPAC4         TO F760-RIGAPACK                 
002427        PERFORM I10-INSERT-RIGHEPACARKI                           
002428           THRU I10-EX                                            
002429        MOVE SPACES              TO F760-RIGAPACK                 
002430        PERFORM I10-INSERT-RIGHEPACARKI                           
002431           THRU I10-EX                                            
002432     END-IF.                                                      
002433                                                                  
002434 E10-EX. EXIT.                                                    
002435*----------------------------------------------------------------*
002436 G00-UPDATE-ORDILOGI.                                             
002437*----------------------------------------------------------------*
002438                                                                  
002439     MOVE 'G00-'                 TO WCOM-CODABEND.                
002440     MOVE 'UPDATE'               TO WCOM-FILEFUNZ.                
002441     MOVE 'ORDILOGI'             TO WCOM-FILENOME.                
002442     MOVE WS-AANUMORD            TO WCOM-FILECTRL.                
002443                                                                  
002444     MOVE WS-DTGIORNO(3:2)       TO L652-AANUMFAT(1:2).           
002445     MOVE WS-NUMEAUTO            TO L652-AANUMFAT(3:6).           
002446     MOVE WS-DTGIORNO            TO L652-DTFATTUR                 
002447     MOVE WS-DTGIORNO            TO L652-DTULTVAR                 
002448     MOVE 'AVLO90'               TO L652-CODUTVAR                 
002449                                                                  
002451     
      *EXEC SQL 
      *UPDATE DLOGISTI.TORDILOGI                               
002452*             SET AANUMFAT = :L652-AANUMFAT                        
002453*                ,DTFATTUR = :L652-DTFATTUR                        
002454*                ,DTULTVAR = :L652-DTULTVAR                        
002455*                ,CODUTVAR = :L652-CODUTVAR                        
002456*           WHERE AANUMORD = :WS-AANUMORD                          
002457*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 5 TO SQL-STMT-ID 
           MOVE 5 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMFAT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTFATTUR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODUTVAR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-AANUMORD
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 8 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002458                                                                  
002459     IF SQLCODE = 0                                               
002460        MOVE 'U'                 TO PPROUTIN                      
002461        MOVE 'ORDILOGI'          TO PPNMFILE                      
002462        MOVE 'D'                 TO PPTPFILE                      
002463        MOVE 'U'                 TO PPTPOPER                      
002464        PERFORM Z90-READPRIN                                      
002465           THRU Z90-EX                                            
002466     ELSE                                                         
002467        PERFORM Z00-ERRORE                                        
002468           THRU Z00-EX.                                           
002469                                                                  
002470 G00-EX. EXIT.                                                    
002471*----------------------------------------------------------------*
002472 F00-PREPARA-INPCONT.                                             
002473*----------------------------------------------------------------*
002474                                                                  
002475     MOVE SPACES                 TO FSINFR00.                     
002476     INITIALIZE                     FSINFR00.                     
002477                                                                  
002478     MOVE WS-CODSOCIE            TO FR00-CODSOCIE.                
002479     MOVE 'F'                    TO FR00-CDMOVCON.                
002480     MOVE WS-NUMEAUTO            TO FR00-NRMOVCON.                
002481     MOVE WS-DTGIORNO            TO FR00-DTREGMOV.                
002482                                                                  
002483     MOVE WS-CODDIVIS            TO FR00-CODDIVIS.                
002484     MOVE A901-CODCLIEN          TO FR00-CODCLIEN.                
002485     MOVE 'AWLIL'                TO FR00-CENCOSTO.                
002486     IF A901-GENECLIE NOT = 'S' AND                               
002487        WS-CENCOSTA > SPACES                                      
002488        MOVE WS-CENCOSTA         TO FR00-CENCOSTO.                
002489                                                                  
002490     MOVE SPACES                 TO FR00-SLTIPLIN.                
002491     MOVE A840-TIPOPAGA          TO FR00-TIPOPAGA.                
002492     MOVE A840-CONDXASS          TO FR00-CONDXASS.                
002493     MOVE A901-CONDPAGA          TO FR00-CONDPAGA.                
002494     MOVE WS-TOTFATTU            TO FR00-IMPMOVIM                 
002495                                    FR00-CVLMOVIM                 
002496                                                                  
002497     MOVE ZEROS                  TO WS-TOTCVSCA                   
002498                                                                  
002499     PERFORM F10-SPOSTA-SCAD                                      
002500        THRU F10-EX                                               
002501           VARYING IND  FROM 1 BY 1                               
002502             UNTIL IND  > 4                                       
002503                OR OUT-DATASCAD (IND) = ZEROES.                   
002504                                                                  
002505     MOVE A840-PERCIMP1          TO FR00-PRCSCADE(1).             
002506     MOVE A840-PERCIMP2          TO FR00-PRCSCADE(2).             
002507     MOVE A840-PERCIMP3          TO FR00-PRCSCADE(3).             
002508     MOVE A840-PERCIMP4          TO FR00-PRCSCADE(4).             
002509                                                                  
002510     MOVE '+'                    TO FR00-INDSEGNO.                
002511                                                                  
002512     MOVE A840-TIPOPAGA          TO A112-TIPOPAG1                 
002513     PERFORM L80-SELECT-TIPOPAGA                                  
002514        THRU L80-EX                                               
002515     MOVE A112-TIPOPAG2          TO FR00-CDSELTIP.                
002516     MOVE 'B'                    TO FR00-CDSELMOV.                
002517                                                                  
002518     MOVE '99'                   TO FR00-CODAGENT.                
002519                                                                  
002520     IF A901-GENECLIE = 'S'                                       
002521        MOVE WS-CONTODCE         TO FR00-CDCEACQU.                
002522                                                                  
002523     MOVE WS-CODPIANO            TO C861-CODPIANO.                
002524     MOVE WS-CONTODCE            TO C861-CONTODCE.                
002525     PERFORM L95-SELECT-CONTIDCE                                  
002526        THRU L95-EX.                                              
002527                                                                  
002528     IF WS-CONTPROV = 'LOGGUA'                                    
002529        MOVE 'SORVEGLIANZA'         TO FR00-NOTENOTE              
002530     ELSE                                                         
002531      IF WS-CONTPROV = 'LOGSTA'                                   
002532         MOVE 'PRODUZIONE CARTELLE COLORI ' TO FR00-NOTENOTE      
002533      ELSE                                                        
002534       IF WS-CONTPROV = 'LOGENE'                                  
002535          MOVE 'FATTURA ENERGIA'  TO FR00-NOTENOTE                
002536       ELSE                                                       
002537         IF WS-CONTPROV = 'FACON'                                 
002538            MOVE 'FATTURAZIONE FACON'  TO FR00-NOTENOTE           
002539            MOVE WS-CENCOSTA           TO FR00-CENCOSTO           
002540         ELSE                                                     
002541           IF WS-CONTPROV = 'FATGOV'                              
002542              MOVE 'ADDEBITO BONIFICI/RESI ' TO FR00-NOTENOTE     
002543               MOVE WS-CENCOSTA              TO FR00-CENCOSTO     
002544           ELSE                                                   
002545             IF WS-CONTPROV = 'FATTEF'                            
002546                MOVE 'ADDEBITO CONSUMO MAT.PRIMA'                 
002547                                              TO FR00-NOTENOTE    
002548                MOVE WS-CENCOSTA              TO FR00-CENCOSTO    
002549             ELSE                                                 
002550             IF WS-CONTPROV = 'FATTIA'                            
002551                MOVE 'ADDEBITO MAT.PRIMA'                         
002552                                              TO FR00-NOTENOTE    
002553                MOVE WS-CENCOSTA              TO FR00-CENCOSTO    
002554             ELSE                                                 
002555               IF WS-TIPSERVI = 'T' AND                           
002556                  C861-CONTPROV = 'TRASXX'                        
002557                  MOVE 'FATTURA TRASPORTO'    TO FR00-NOTENOTE    
002558               ELSE                                               
002559                 IF WS-TIPSERVI = 'L'                             
002560                    IF WS-CONTPROV = 'LOGMAG'                     
002561                       MOVE SPACES            TO FR00-NOTENOTE    
002562                       STRING 'VISITA PRONTO ALL' QUOTE ' AGO'    
002563                          DELIMITED BY SIZE INTO FR00-NOTENOTE    
002564                    ELSE                                          
002565                       IF WS-CONTPROV = 'FATWEB'                  
002566                          MOVE 'VENDITA TESSUTO'                  
002567                                              TO FR00-NOTENOTE    
002568                       ELSE                                       
002569                         IF WS-CONTPROV = 'RICCOL'                
002570                            MOVE 'CUSTOM COLOUR MATCHING'         
002571                                              TO FR00-NOTENOTE    
002572                         ELSE                                     
002573                           IF WS-CONTPROV = 'RICROT'              
002574                              MOVE 'FATTURAZIONE'                 
002575                                              TO FR00-NOTENOTE    
002576                           ELSE                                   
002577                              MOVE 'ALLEST/ROYALTIES'             
002578                                              TO FR00-NOTENOTE    
002579                           END-IF                                 
002580                         END-IF                                   
002581                       END-IF                                     
002582                    END-IF                                        
002583                 ELSE                                             
002584                   MOVE 'FATTURA MAGAZZINO'   TO FR00-NOTENOTE.   
002585                                                                  
002586     IF WS-CONTPROV > SPACES                                      
002587        MOVE WS-CONTPROV         TO C861-CONTPROV                 
002588        IF C861-CONTPROV = 'LOGSTA'                               
002589           MOVE 'LOGGUA'         TO C861-CONTPROV                 
002590        END-IF                                                    
002591        IF C861-CONTPROV = 'RICCOL'                               
002592           MOVE 'RICALL'         TO C861-CONTPROV                 
002593        END-IF                                                    
002594     ELSE                                                         
002595        IF WS-TIPSERVI = 'T' AND                                  
002596           C861-CONTPROV = 'TRASXX'                               
002597           MOVE 'LOGTRA'         TO C861-CONTPROV                 
002598        ELSE                                                      
002599           MOVE 'LOGMAG'         TO C861-CONTPROV.                
002600                                                                  
002601     MOVE A531-CODPIANO          TO C861-CODPIANO.                
002602     PERFORM L90-SELECT-CONTIDCE                                  
002603        THRU L90-EX                                               
002604     MOVE C861-CONTODCE          TO FR00-CONTODCE(1)              
002605                                                                  
002606     MOVE WS-TOTMOVIM            TO FR00-IMPORDCE(1)              
002607                                    WS-IMPORTON                   
002608     PERFORM F99-CONTROVALORE                                     
002609        THRU F99-EX                                               
002610     MOVE WS-IMPORTON            TO FR00-CVLXXDCE(1)              
002611                                                                  
002612     IF WS-IMPORIVA > ZEROES                                      
002613        MOVE WS-PERCEIVA         TO FR00-PERCEIVA(1)              
002614        MOVE WS-IMPORIVA         TO FR00-IMPORIVA(1)              
002615        MOVE WS-IMPORIVA         TO WS-IMPORTON                   
002616        PERFORM F99-CONTROVALORE                                  
002617           THRU F99-EX                                            
002618        MOVE WS-IMPORTON         TO FR00-CVLXXIVA(1)              
002619     ELSE                                                         
002620        MOVE ESE0-ESENTIVA       TO FR00-ESENTIVA(1).             
002621                                                                  
002622     IF ESE0-ESENTIVA = 'L'                                       
002623        MOVE IVA-NUMESIVA(1)     TO FR00-NUMESIVA                 
002624        MOVE IVA-UFFICIVA(1)     TO FR00-UFFICIVA                 
002625        MOVE IVA-DATESIVA(1)     TO FR00-DATESIVA.                
002626                                                                  
002627     MOVE WS-TOTFATTU            TO WS-IMPORTON                   
002628     PERFORM F99-CONTROVALORE                                     
002629        THRU F99-EX                                               
002630     MOVE WS-IMPORTON            TO WS-TOTCVFAT.                  
002631                                                                  
002632     IF WS-TOTCVSCA NOT = WS-TOTCVFAT                             
002633        COMPUTE FR00-CVLSCADE(1) = FR00-CVLSCADE(1) +             
002634                                   WS-TOTCVFAT      -             
002635                                   WS-TOTCVSCA.                   
002636                                                                  
002637     MOVE 'L'                    TO FR00-TIPOMOVI.                
002638                                                                  
002639     PERFORM W10-WRITE-INPCONT                                    
002640        THRU W10-EX.                                              
002641                                                                  
002642     PERFORM F20-ELABORA-CCOSTO-AVERE                             
002643        THRU F20-EX.                                              
002644                                                                  
002645     IF A901-GENECLIE = 'S'                                       
002646        PERFORM F30-ELABORA-CCOSTO-DARE                           
002647           THRU F30-EX.                                           
002648                                                                  
002649 F00-EX. EXIT.                                                    
002650*----------------------------------------------------------------*
002651 F10-SPOSTA-SCAD.                                                 
002652*----------------------------------------------------------------*
002653                                                                  
002654     MOVE OUT-DATASCAD(IND)      TO FR00-DTSCADEN(IND).           
002655     MOVE OUT-IMPOSCAD(IND)      TO FR00-IMPSCADE(IND).           
002656                                                                  
002657     MOVE FR00-IMPSCADE(IND)     TO WS-IMPORTON                   
002658     PERFORM F99-CONTROVALORE                                     
002659        THRU F99-EX                                               
002660     MOVE WS-IMPORTON            TO FR00-CVLSCADE(IND).           
002661     ADD WS-IMPORTON             TO WS-TOTCVSCA.                  
002662                                                                  
002663 F10-EX. EXIT.                                                    
002664*----------------------------------------------------------------*
002665 F20-ELABORA-CCOSTO-AVERE.                                        
002666*----------------------------------------------------------------*
002667                                                                  
002668     MOVE ZEROS                 TO WS-TOTPERCE                    
002669                                                                  
002670     PERFORM VARYING INDC FROM 1 BY 1                             
002671       UNTIL INDC                  > MAX-INDC                     
002672          OR T1-CENCOSTA(INDC) NOT > ' '                          
002673             PERFORM VARYING INDN FROM INDC BY 1                  
002674               UNTIL INDN                  > MAX-INDC             
002675                  OR T1-CENCOSTA(INDN) NOT > ' '                  
002676                     IF T1-IMPORTO(INDN) >                        
002677                        T1-IMPORTO(INDC)                          
002678                        MOVE T1-ELEMENTO(INDN)                    
002679                                TO WS-ELEMENTO                    
002680                        MOVE T1-ELEMENTO(INDC)                    
002681                                TO T1-ELEMENTO(INDN)              
002682                        MOVE WS-ELEMENTO                          
002683                                TO T1-ELEMENTO(INDC)              
002684                     END-IF                                       
002685             END-PERFORM                                          
002686     END-PERFORM.                                                 
002687                                                                  
002688     PERFORM VARYING INDC FROM 1 BY 1                             
002689       UNTIL INDC                  > MAX-INDC                     
002690          OR T1-CENCOSTA(INDC) NOT > ' '                          
002691             COMPUTE T1-PERCENTU(INDC) ROUNDED =                  
002692                 T1-IMPORTO(INDC) * 100 / WS-TOTMOVIM             
002693             ADD T1-PERCENTU(INDC)      TO WS-TOTPERCE            
002694     END-PERFORM                                                  
002695                                                                  
002696     IF WS-TOTPERCE NOT = 100                                     
002697        COMPUTE T1-PERCENTU(1) =                                  
002698                T1-PERCENTU(1) +                                  
002699                100            -                                  
002700                WS-TOTPERCE                                       
002701     END-IF                                                       
002702                                                                  
002703     PERFORM VARYING INDC FROM 1 BY 1                             
002704       UNTIL INDC                  > MAX-INDC                     
002705          OR T1-CENCOSTA(INDC) NOT > ' '                          
002706             MOVE SPACES                TO FSEC90                 
002707             INITIALIZE                    FSEC90                 
002708             MOVE FR00-CODSOCIE         TO EC90-CODSOCIE          
002709             MOVE FR00-CODCLIEN         TO EC90-CODCLIEN          
002710             MOVE FR00-NRMOVCON         TO EC90-NUMFATTU          
002711             MOVE FR00-CDMOVCON         TO EC90-CDMOVCON          
002712             MOVE FR00-DTREGMOV         TO EC90-DTFATTUR          
002713             MOVE T1-CENCOSTA(INDC)     TO EC90-CENCOSTO          
002714             MOVE T1-PERCENTU(INDC)     TO EC90-PERCENTU          
002715             IF A901-GENECLIE = 'S'                               
002716                MOVE T1-CONTARIG(INDC)  TO EC90-CONTARIG          
002717             END-IF                                               
002718             IF EC90-PERCENTU > ZEROES                            
002719                PERFORM W20-WRITE-OUTCON2                         
002720                   THRU W20-EX                                    
002721             END-IF                                               
002722     END-PERFORM.                                                 
002723                                                                  
002724 F20-EX. EXIT.                                                    
002725*----------------------------------------------------------------*
002726 F30-ELABORA-CCOSTO-DARE.                                         
002727*----------------------------------------------------------------*
002728                                                                  
002729     MOVE ZEROS                 TO WS-TOTPERCE                    
002730                                                                  
002731     PERFORM VARYING INDC FROM 1 BY 1                             
002732       UNTIL INDC                  > MAX-INDC                     
002733          OR T1-CENCOSTD(INDC) NOT > ' '                          
002734             PERFORM VARYING INDN FROM INDC BY 1                  
002735               UNTIL INDN                  > MAX-INDC             
002736                  OR T1-CENCOSTD(INDN) NOT > ' '                  
002737                     IF T1-IMPORTO(INDN) >                        
002738                        T1-IMPORTO(INDC)                          
002739                        MOVE T1-ELEMENTO(INDN)                    
002740                                TO WS-ELEMENTO                    
002741                        MOVE T1-ELEMENTO(INDC)                    
002742                                TO T1-ELEMENTO(INDN)              
002743                        MOVE WS-ELEMENTO                          
002744                                TO T1-ELEMENTO(INDC)              
002745                     END-IF                                       
002746             END-PERFORM                                          
002747     END-PERFORM.                                                 
002748                                                                  
002749     PERFORM VARYING INDC FROM 1 BY 1                             
002750       UNTIL INDC                  > MAX-INDC                     
002751          OR T1-CENCOSTD(INDC) NOT > ' '                          
002752             COMPUTE T1-PERCENTU(INDC) ROUNDED =                  
002753                 T1-IMPORTO(INDC) * 100 / WS-TOTMOVIM             
002754             ADD T1-PERCENTU(INDC)      TO WS-TOTPERCE            
002755     END-PERFORM                                                  
002756                                                                  
002757     IF WS-TOTPERCE NOT = 100                                     
002758        COMPUTE T1-PERCENTU(1) =                                  
002759                T1-PERCENTU(1) +                                  
002760                100            -                                  
002761                WS-TOTPERCE                                       
002762     END-IF                                                       
002763                                                                  
002764     PERFORM VARYING INDC FROM 1 BY 1                             
002765       UNTIL INDC                  > MAX-INDC                     
002766          OR T1-CENCOSTD(INDC) NOT > ' '                          
002767             MOVE SPACES                TO FSEC90                 
002768             INITIALIZE                    FSEC90                 
002769             MOVE FR00-CODSOCIE         TO EC90-CODSOCIE          
002770             MOVE FR00-CODCLIEN         TO EC90-CODCLIEN          
002771             MOVE FR00-NRMOVCON         TO EC90-NUMFATTU          
002772             MOVE FR00-CDMOVCON         TO EC90-CDMOVCON          
002773             MOVE FR00-DTREGMOV         TO EC90-DTFATTUR          
002774             MOVE T1-CENCOSTD(INDC)     TO EC90-CENCOSTD          
002775             MOVE T1-PERCENTU(INDC)     TO EC90-PERCENTU          
002776             MOVE 'A'                   TO EC90-ACQUVEND          
002777             MOVE T1-CONTARIG(INDC)     TO EC90-CONTARIG          
002778             IF EC90-PERCENTU > ZEROES                            
002779                PERFORM W20-WRITE-OUTCON2                         
002780                   THRU W20-EX                                    
002781             END-IF                                               
002782     END-PERFORM.                                                 
002783                                                                  
002784 F30-EX. EXIT.                                                    
002785*----------------------------------------------------------------*
002786 F99-CONTROVALORE.                                                
002787*----------------------------------------------------------------*
002788                                                                  
002789     IF WS-IMPORTON NOT > 0 OR                                    
002790        A531-CODDIVIS   = WS-CODDIVIS                             
002791        GO TO F99-EX.                                             
002792                                                                  
002793     MOVE SPACES                    TO DCWCAMB                    
002794     INITIALIZE                        DCWCAMB                    
002795     MOVE WS-IMPORTON               TO CAMB-IMPORTOO (1)          
002796     MOVE WS-CODDIVIS               TO CAMB-CODDIVIS              
002797     MOVE A531-CODDIVRI             TO CAMB-CODDRIFE              
002798     MOVE A531-CODDIVIS             TO CAMB-CODCAMBI              
002799     MOVE WS-DTGIORNO               TO CAMB-DTCAMBIO              
002800                                                                  
002801     MOVE 'F99-'                    TO WCOM-CODABEND              
002802     MOVE 'CALL'                    TO WCOM-FILEFUNZ              
002803     MOVE 'SCBCB10'                 TO WCOM-FILENOME              
002804     MOVE SPACES                    TO WCOM-FILECTRL              
002805     STRING CAMB-CODDIVIS ' ' CAMB-CODCAMBI ' ' CAMB-CODDRIFE     
002806     DELIMITED BY SIZE            INTO WCOM-FILECTRL              
002807                                                                  
002808     MOVE 'SCBCB10'                 TO PPCALL                     
002809     CALL PPCALL                 USING DCPARM DCWCAMB             
002810                                                                  
002811     IF CAMB-RETCOD NOT = '****'                                  
002812        PERFORM Z00-ERRORE                                        
002813           THRU Z00-EX.                                           
002814                                                                  
002815     MOVE CAMB-CONTROVA(1)          TO WS-IMPORTON.               
002816                                                                  
002817 F99-EX. EXIT.                                                    
002818*----------------------------------------------------------------*
002819 I00-INSERT-RIGHEDOCU.                                            
002820*----------------------------------------------------------------*
002821                                                                  
002822     IF C805-TIRIGFAT NOT = '25'                                  
002823        MOVE SPACES              TO C805-TIPORIGA.                
002824                                                                  
002825     MOVE WS-CODSOCIE            TO C805-CODSOCIE.                
002826     MOVE 'F'                    TO C805-CDMOVCON.                
002827     MOVE WS-NUMEAUTO            TO C805-NRMOVCON.                
002828     MOVE WS-DTGIORNO            TO C805-DTREGMOV                 
002829                                    C805-DTCREAZI                 
002830                                    C805-DTULTVAR.                
002831     MOVE 'AVLO90'               TO C805-CODUTVAR.                
002832     ADD  10                     TO WS-NRTIRIFA.                  
002833     MOVE WS-NRTIRIFA            TO C805-NRTIRIFA.                
002834                                                                  
002835     MOVE 'I00-'                 TO WCOM-CODABEND.                
002836     MOVE 'INSERT'               TO WCOM-FILEFUNZ.                
002837     MOVE 'RIGHEDO'              TO WCOM-FILENOME.                
002838     MOVE SPACES                 TO WCOM-FILECTRL.                
002839     STRING C805-CODSOCIE ' ' C805-CDMOVCON ' ' C805-NRMOVCON ' ' 
002840            DELIMITED BY SIZE  INTO WCOM-FILECTRL.                
002841                                                                  
002843     
      *EXEC SQL 
      *INSERT INTO DCONTCLI.TRIGHEDOCU                          
002844*          (CODSOCIE, CDMOVCON, NRMOVCON                           
002845*          ,DTREGMOV, TIRIGFAT, NRTIRIFA                           
002846*          ,RIGAFATT, DTCREAZI, DTULTVAR                           
002847*          ,CODUTVAR, TIPORIGA)                                    
002848*       VALUES                                                     
002849*         (:C805-CODSOCIE,:C805-CDMOVCON,:C805-NRMOVCON,           
002850*          :C805-DTREGMOV,:C805-TIRIGFAT,:C805-NRTIRIFA,           
002851*          :C805-RIGAFATT,:C805-DTCREAZI,:C805-DTULTVAR,           
002852*          :C805-CODUTVAR,:C805-TIPORIGA)                          
002853*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 6 TO SQL-STMT-ID 
           MOVE 11 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C805-CODSOCIE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C805-CDMOVCON
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C805-NRMOVCON
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C805-DTREGMOV
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C805-TIRIGFAT
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C805-NRTIRIFA
            BY VALUE 0
                     0

           MOVE 91 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C805-RIGAFATT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C805-DTCREAZI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C805-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C805-CODUTVAR
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C805-TIPORIGA
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 9 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002854                                                                  
002855     IF SQLCODE NOT = +0                                          
002856        PERFORM Z00-ERRORE                                        
002857           THRU Z00-EX                                            
002858     ELSE                                                         
002859        MOVE 'U'                 TO PPROUTIN                      
002860        MOVE 'D'                 TO PPTPFILE                      
002861        MOVE 'A'                 TO PPTPOPER                      
002862        MOVE 'RIGHEDO'           TO PPNMFILE                      
002863        PERFORM Z90-READPRIN                                      
002864           THRU Z90-EX                                            
002865        MOVE SPACES              TO C805-RIGAFATT                 
002866                                    WS-RIGAST01.                  
002867                                                                  
002868 I00-EX. EXIT.                                                    
002869*----------------------------------------------------------------*
002870 I10-INSERT-RIGHEPACARKI.                                         
002871*----------------------------------------------------------------*
002872                                                                  
002873     MOVE WS-CODSOCIE            TO F760-CODSOCIE.                
002874     MOVE WS-DTGIORNO(3:2)       TO F760-AANUMFAT(1:2).           
002875     MOVE WS-NUMEAUTO            TO F760-AANUMFAT(3:6).           
002876     ADD  10                     TO WS-NRTIRIFA.                  
002877     MOVE WS-NRTIRIFA            TO F760-NRTIRIPA.                
002878     MOVE 'P'                    TO F760-TIPOFATT.                
002879     MOVE WS-DTGIORNO            TO F760-DTFATTUR.                
002880                                                                  
002881     MOVE 'I10-'                 TO WCOM-CODABEND.                
002882     MOVE 'INSERT'               TO WCOM-FILEFUNZ.                
002883     MOVE 'RIGHEPACARKI'         TO WCOM-FILENOME.                
002884     MOVE SPACES                 TO WCOM-FILECTRL.                
002885     STRING F760-CODSOCIE ' ' F760-AANUMFAT                       
002886            DELIMITED BY SIZE  INTO WCOM-FILECTRL.                
002887                                                                  
002889     
      *EXEC SQL 
      *INSERT INTO DFATTURE.TRIGHEPACARKI                       
002890*          (CODSOCIE, AANUMFAT, TIRIGPAK                           
002891*          ,NRTIRIPA, RIGAPACK, TIPOFATT                           
002892*          ,QUALIFIN, DTFATTUR)                                    
002893*       VALUES                                                     
002894*         (:F760-CODSOCIE, :F760-AANUMFAT, :F760-TIRIGPAK          
002895*         ,:F760-NRTIRIPA, :F760-RIGAPACK, :F760-TIPOFATT          
002896*         ,:F760-QUALIFIN, :F760-DTFATTUR)                         
002897*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 7 TO SQL-STMT-ID 
           MOVE 8 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F760-CODSOCIE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F760-AANUMFAT
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F760-TIRIGPAK
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F760-NRTIRIPA
            BY VALUE 0
                     0

           MOVE 77 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F760-RIGAPACK
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F760-TIPOFATT
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F760-QUALIFIN
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F760-DTFATTUR
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 10 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002898                                                                  
002899     IF SQLCODE NOT = +0                                          
002900        PERFORM Z00-ERRORE                                        
002901           THRU Z00-EX                                            
002902     ELSE                                                         
002903        MOVE 'U'                 TO PPROUTIN                      
002904        MOVE 'D'                 TO PPTPFILE                      
002905        MOVE 'A'                 TO PPTPOPER                      
002906        MOVE 'RIGHEPACARKI'      TO PPNMFILE                      
002907        PERFORM Z90-READPRIN                                      
002908           THRU Z90-EX                                            
002909        MOVE SPACES              TO F760-RIGAPACK.                
002910                                                                  
002911 I10-EX. EXIT.                                                    
002912*----------------------------------------------------------------*
002913 I20-INSERT-SCAMBICEE.                                            
002914*----------------------------------------------------------------*
002915                                                                  
002916     MOVE 'I20-'                 TO WCOM-CODABEND.                
002917     MOVE 'INSERT'               TO WCOM-FILEFUNZ.                
002918     MOVE 'SCAMBICEE'            TO WCOM-FILENOME.                
002919     MOVE SPACES                 TO WCOM-FILECTRL.                
002920     STRING A967-CODSOCIE ' ' A967-NRMOVCON                       
002921            DELIMITED BY SIZE  INTO WCOM-FILECTRL.                
002922                                                                  
002923     
      *EXEC SQL INSERT                                              
002924*          INTO   DANAGRAF.TSCAMBICEE                              
002925*                          (FLACQVEN,                              
002926*                           CODSOCIE,                              
002927*                           CDMOVCON,                              
002928*                           NRMOVCON,                              
002929*                           DTREGMOV,                              
002930*                           VOCEDOGA,                              
002931*                           TRANSCEE,                              
002932*                           CDIVACEE,                              
002933*                           PAESMERC,                              
002934*                           PAESPROV,                              
002935*                           PAESORIG,                              
002936*                           SIGLAPRO,                              
002937*                           PROVORIG,                              
002938*                           REGMSTAT,                              
002939*                           TIPSPEDI,                              
002940*                           KGVOCEDO,                              
002941*                           VLVOCEDO,                              
002942*                           CODDIVIS,                              
002943*                           CODIRESA,                              
002944*                           INCLIFOR,                              
002945*                           CLIEFORN,                              
002946*                           FLAGESTR,                              
002947*                           DTCREAZI,                              
002948*                           DTULTVAR,                              
002949*                           CODUTVAR,                              
002950*                           DESMECEE,                              
002951*                           UNISUPPL,                              
002952*                           FLINTEST,                              
002953*                           CVVOCEDO,                              
002954*                           CDENTDOG,                              
002955*                           FLSERMER,                              
002956*                           CDSERVIZ)                              
002957*                VALUES    (:A967-FLACQVEN,                        
002958*                           :A967-CODSOCIE,                        
002959*                           :A967-CDMOVCON,                        
002960*                           :A967-NRMOVCON,                        
002961*                           :A967-DTREGMOV,                        
002962*                           :A967-VOCEDOGA,                        
002963*                           :A967-TRANSCEE,                        
002964*                           :A967-CDIVACEE,                        
002965*                           :A967-PAESMERC,                        
002966*                           :A967-PAESPROV,                        
002967*                           :A967-PAESORIG,                        
002968*                           :A967-SIGLAPRO,                        
002969*                           :A967-PROVORIG,                        
002970*                           :A967-REGMSTAT,                        
002971*                           :A967-TIPSPEDI,                        
002972*                           :A967-KGVOCEDO,                        
002973*                           :A967-VLVOCEDO,                        
002974*                           :A967-CODDIVIS,                        
002975*                           :A967-CODIRESA,                        
002976*                           :A967-INCLIFOR,                        
002977*                           :A967-CLIEFORN,                        
002978*                           :A967-FLAGESTR,                        
002979*                           :A967-DTCREAZI,                        
002980*                           :A967-DTULTVAR,                        
002981*                           :A967-CODUTVAR,                        
002982*                           :A967-DESMECEE,                        
002983*                           :A967-UNISUPPL,                        
002984*                           :A967-FLINTEST,                        
002985*                           :A967-CVVOCEDO,                        
002986*                           :A967-CDENTDOG,                        
002987*                           :A967-FLSERMER,                        
002988*                           :A967-CDSERVIZ)                        
002989*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 8 TO SQL-STMT-ID 
           MOVE 32 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-FLACQVEN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-CODSOCIE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-CDMOVCON
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-NRMOVCON
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-DTREGMOV
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-VOCEDOGA
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-TRANSCEE
            BY VALUE 0
                     0

           MOVE 14 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-CDIVACEE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-PAESMERC
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-PAESPROV
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-PAESORIG
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-SIGLAPRO
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-PROVORIG
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-REGMSTAT
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-TIPSPEDI
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-KGVOCEDO
            BY VALUE 0
                     0

           MOVE 523 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-VLVOCEDO
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 17 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-CODDIVIS
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 18 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-CODIRESA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 19 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-INCLIFOR
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 20 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-CLIEFORN
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 21 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-FLAGESTR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 22 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-DTCREAZI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 23 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 24 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-CODUTVAR
            BY VALUE 0
                     0

           MOVE 30 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 25 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-DESMECEE
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 26 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-UNISUPPL
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 27 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-FLINTEST
            BY VALUE 0
                     0

           MOVE 523 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 28 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-CVVOCEDO
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 29 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-CDENTDOG
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 30 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-FLSERMER
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 31 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A967-CDSERVIZ
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 11 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002990                                                                  
002991     IF SQLCODE NOT = +0                                          
002992        PERFORM Z00-ERRORE                                        
002993           THRU Z00-EX                                            
002994     ELSE                                                         
002995        MOVE 'U'                 TO PPROUTIN                      
002996        MOVE 'D'                 TO PPTPFILE                      
002997        MOVE 'A'                 TO PPTPOPER                      
002998        MOVE 'SCAMBICEE'         TO PPNMFILE                      
002999        PERFORM Z90-READPRIN                                      
003000           THRU Z90-EX.                                           
003001                                                                  
003002 I20-EX. EXIT.                                                    
003003*----------------------------------------------------------------*
003004 L00-SELECT-TEMPITRANS.                                           
003005*----------------------------------------------------------------*
003006                                                                  
003007     MOVE 'L00-'                 TO WCOM-CODABEND.                
003008     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003009     MOVE 'TEMPITRANS'           TO WCOM-FILENOME.                
003010     MOVE SPACES                 TO WCOM-FILECTRL.                
003011     STRING A839-CODITRAN ' ' A839-CODIFUNZ ' '                   
003012        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
003013                                                                  
003015     
      *EXEC SQL 
      *SELECT NOTENOTE, CODSOCIE                               
003016*            INTO :A839-NOTENOTE, :A839-CODSOCIE                   
003017*            FROM DANAGRAF.TTEMPITRANS                             
003018*           WHERE CODITRAN = :A839-CODITRAN                        
003019*             AND CODIFUNZ IN ('50', '51')                         
003020*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 9 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A839-CODITRAN
            BY VALUE 0
                     0

           MOVE 10 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 60 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A839-NOTENOTE
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A839-CODSOCIE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 12 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003021                                                                  
003022     IF SQLCODE NOT = ZEROES                                      
003023        PERFORM Z00-ERRORE                                        
003024           THRU Z00-EX                                            
003025     ELSE                                                         
003026        MOVE 'U'                 TO PPROUTIN                      
003027        MOVE 'D'                 TO PPTPFILE                      
003028        MOVE 'R'                 TO PPTPOPER                      
003029        MOVE 'TEMPITRANS'        TO PPNMFILE                      
003030        PERFORM Z90-READPRIN                                      
003031           THRU Z90-EX.                                           
003032                                                                  
003033 L00-EX. EXIT.                                                    
003034*----------------------------------------------------------------*
003035 L05-FETCH-POINTER1.                                              
003036*----------------------------------------------------------------*
003037                                                                  
003038     MOVE 'FETCH'                TO WCOM-FILEFUNZ.                
003039     MOVE 'POINTER1'             TO WCOM-FILENOME.                
003040     MOVE 'L05-'                 TO WCOM-CODABEND.                
003041                                                                  
003043     
      *EXEC SQL 
      *FETCH POINTER1                                           
003044*          INTO :L652-CODCLIEN, :L652-CODSOCIE                     
003045*              ,:L652-AANUMORD, :L652-TIPSERVI                     
003046*              ,:L652-FLAGGIVA, :L652-ESENTIVA                     
003047*              ,:L652-CODDIVIS, :L652-CONTODCE                     
003048*              ,:L653-CODSERVI, :L653-UNMISURA                     
003049*              ,:L653-PREZZORD, :L653-NOTENOTE                     
003050*              ,:L653-CENCOSTD, :L653-CENCOSTA                     
003051*              ,:L652-AAMMCOMP, :L651-CONTPROV                     
003052*              ,:L653-QTAORDIN, :L653-IMPORDIN                     
003053*              ,:L653-IMPORIVA                                     
003054*              ,:L655-MERCEMAG                                     
003055*              ,:COMO-CODARTIC                                     
003056*              ,:L651-DESSERVI                                     
003057*              ,:L655-SIGLCICL                                     
003058*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 11 TO SQL-STMT-ID 
           MOVE 23 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODCLIEN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODSOCIE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMORD
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-TIPSERVI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-FLAGGIVA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-ESENTIVA
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODDIVIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CONTODCE
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CODSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-UNMISURA
            BY VALUE 0
                     0

           MOVE 1035 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-PREZZORD
            BY VALUE 0
                     0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-NOTENOTE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CENCOSTD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CENCOSTA
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AAMMCOMP
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CONTPROV
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-QTAORDIN
            BY VALUE 0
                     0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 17 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-IMPORDIN
            BY VALUE 0
                     0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 18 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-IMPORIVA
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 19 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-MERCEMAG
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 20 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE COMO-CODARTIC
            BY VALUE 0
                     0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 21 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-DESSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 22 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-SIGLCICL
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 4 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003059                                                                  
003060     MOVE SQLCODE                TO WS-SQLCODE                    
003061                                                                  
003062     IF SQLCODE = ZERO                                            
003063        MOVE 'U'                 TO PPROUTIN                      
003064        MOVE 'D'                 TO PPTPFILE                      
003065        MOVE 'R'                 TO PPTPOPER                      
003066        MOVE 'POINT1'            TO PPNMFILE                      
003067        PERFORM Z90-READPRIN                                      
003068           THRU Z90-EX                                            
003069        IF WS-AANUMORD-X NOT = L652-AANUMORD                      
003070           MOVE L652-AANUMORD    TO WS-AANUMORD-X                 
003071           PERFORM L05A-SELECT-RIGORDILOGI                        
003072              THRU L05A-EX                                        
003073           COMPUTE WS-CONTAFAT = WS-CONTAFAT + WS-NUMRIGHE.       
003074                                                                  
003075 L05-EX. EXIT.                                                    
003076*----------------------------------------------------------------*
003077 L05A-SELECT-RIGORDILOGI.                                         
003078*----------------------------------------------------------------*
003079                                                                  
003080     MOVE 'L05A-'                TO WCOM-CODABEND.                
003081     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003082     MOVE 'RIGORDILOGI'          TO WCOM-FILENOME.                
003083     MOVE L652-AANUMORD          TO WCOM-FILECTRL.                
003084                                                                  
003085     MOVE ZERO                   TO WS-NUMRIGHE                   
003087     
      *EXEC SQL 
      *SELECT VALUE(COUNT(*),0) AS NUMRIGHE                    
003088*            INTO :WS-NUMRIGHE                                     
003089*            FROM DLOGISTI.TRIGORDILOGI                            
003090*           WHERE AANUMORD = :L652-AANUMORD                        
003091*             AND DTANNULL <= ' '                                  
003092*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 12 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMORD
            BY VALUE 0
                     0

           MOVE 13 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-NUMRIGHE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 13 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003093                                                                  
003094     IF SQLCODE NOT EQUAL ZERO OR                                 
003095        WS-NUMRIGHE NOT > ZERO                                    
003096        PERFORM Z00-ERRORE                                        
003097           THRU Z00-EX                                            
003098     ELSE                                                         
003099        MOVE 'U'                 TO PPROUTIN                      
003100        MOVE 'D'                 TO PPTPFILE                      
003101        MOVE 'R'                 TO PPTPOPER                      
003102        MOVE 'RIGODILOGX'        TO PPNMFILE                      
003103        PERFORM Z90-READPRIN                                      
003104           THRU Z90-EX.                                           
003105                                                                  
003106 L05A-EX. EXIT.                                                   
003107*----------------------------------------------------------------*
003108 L06-FETCH-POINTER2.                                              
003109*----------------------------------------------------------------*
003110                                                                  
003111     MOVE 'FETCH'                TO WCOM-FILEFUNZ.                
003112     MOVE 'POINTER2'             TO WCOM-FILENOME.                
003113     MOVE 'L06-'                 TO WCOM-CODABEND.                
003114                                                                  
003116     
      *EXEC SQL 
      *FETCH POINTER2                                           
003117*          INTO :L656-NOTEORDI, :L656-NUMPROG3                     
003118*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 14 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 78 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L656-NOTEORDI
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L656-NUMPROG3
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 5 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003119                                                                  
003120     IF SQLCODE = ZERO                                            
003121        MOVE 'U'                 TO PPROUTIN                      
003122        MOVE 'D'                 TO PPTPFILE                      
003123        MOVE 'R'                 TO PPTPOPER                      
003124        MOVE 'POINT2'            TO PPNMFILE                      
003125        PERFORM Z90-READPRIN                                      
003126           THRU Z90-EX.                                           
003127                                                                  
003128 L06-EX. EXIT.                                                    
003129*----------------------------------------------------------------*
003130 L07-FETCH-POINTIVA.                                              
003131*----------------------------------------------------------------*
003132                                                                  
003133     MOVE 'FETCH'                TO WCOM-FILEFUNZ.                
003134     MOVE 'POINTIVA'             TO WCOM-FILENOME.                
003135     MOVE 'L07-'                 TO WCOM-CODABEND.                
003136                                                                  
003138     
      *EXEC SQL 
      *FETCH POINTIVA                                          
003139*           INTO :AT66-NUMESIVA, :AT66-DATESIVA                    
003140*               ,:AT66-UFFICIVA                                    
003141*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 15 TO SQL-STMT-ID 
           MOVE 3 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE AT66-NUMESIVA
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE AT66-DATESIVA
            BY VALUE 0
                     0

           MOVE 18 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE AT66-UFFICIVA
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 7 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003142                                                                  
003143     IF SQLCODE = ZERO                                            
003144        MOVE 'U'                 TO PPROUTIN                      
003145        MOVE 'D'                 TO PPTPFILE                      
003146        MOVE 'R'                 TO PPTPOPER                      
003147        MOVE 'POINTIVA'          TO PPNMFILE                      
003148        PERFORM Z90-READPRIN                                      
003149           THRU Z90-EX.                                           
003150                                                                  
003151 L07-EX. EXIT.                                                    
003152*----------------------------------------------------------------*
003153 L08-FETCH-POINT-RIF.                                             
003154*----------------------------------------------------------------*
003155                                                                  
003156     MOVE 'FETCH'                TO WCOM-FILEFUNZ.                
003157     MOVE 'POINT-RIF'            TO WCOM-FILENOME.                
003158     MOVE 'L08-'                 TO WCOM-CODABEND.                
003159                                                                  
003161     
      *EXEC SQL 
      *FETCH POINT-RIF                                          
003162*          INTO :L430-RIFORDIN, :L430-NUMPROG3                     
003163*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 16 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L430-RIFORDIN
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L430-NUMPROG3
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 6 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003164                                                                  
003165     IF SQLCODE = ZERO                                            
003166        MOVE 'U'                 TO PPROUTIN                      
003167        MOVE 'D'                 TO PPTPFILE                      
003168        MOVE 'R'                 TO PPTPOPER                      
003169        MOVE 'PRIFOR'            TO PPNMFILE                      
003170        PERFORM Z90-READPRIN                                      
003171           THRU Z90-EX.                                           
003172                                                                  
003173 L08-EX. EXIT.                                                    
003174*----------------------------------------------------------------*
003175 L10-SELECT-TSOCIETA.                                             
003176*----------------------------------------------------------------*
003177                                                                  
003178     MOVE 'L10-'                 TO WCOM-CODABEND.                
003179     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003180     MOVE 'SOCIETA'              TO WCOM-FILENOME.                
003181     MOVE A531-CODSOCIE          TO WCOM-FILECTRL.                
003182                                                                  
003184     
      *EXEC SQL 
      *SELECT CODPAESE, CODDIVIS                               
003185*                ,CODDIVRI, CODPIANO                               
003186*            INTO :A531-CODPAESE, :A531-CODDIVIS                   
003187*                ,:A531-CODDIVRI, :A531-CODPIANO                   
003188*            FROM DANAGRAF.TSOCIETA                                
003189*           WHERE CODSOCIE = :A531-CODSOCIE                        
003190*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 17 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 18 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODPAESE
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODDIVIS
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODDIVRI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODPIANO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 14 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003191                                                                  
003192     IF SQLCODE NOT = +0                                          
003193        PERFORM Z00-ERRORE                                        
003194           THRU Z00-EX                                            
003195     ELSE                                                         
003196        MOVE 'U'                 TO PPROUTIN                      
003197        MOVE 'D'                 TO PPTPFILE                      
003198        MOVE 'R'                 TO PPTPOPER                      
003199        MOVE 'SOCIETA'           TO PPNMFILE                      
003200        PERFORM Z90-READPRIN                                      
003201           THRU Z90-EX.                                           
003202                                                                  
003203 L10-EX. EXIT.                                                    
003204*----------------------------------------------------------------*
003205 L11-SELECT-TSOCIETA.                                             
003206*----------------------------------------------------------------*
003207                                                                  
003208     MOVE 'L11-'                 TO WCOM-CODABEND.                
003209     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003210     MOVE 'SOCIETA'              TO WCOM-FILENOME.                
003211     MOVE A531-CODFORNI          TO WCOM-FILECTRL.                
003212                                                                  
003214     
      *EXEC SQL 
      *SELECT CODPIANO                                         
003215*            INTO :WS-CODPIANO                                     
003216*            FROM DANAGRAF.TSOCIETA                                
003217*           WHERE CODFORNI = :A531-CODFORNI                        
003218*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 19 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODFORNI
            BY VALUE 0
                     0

           MOVE 20 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CODPIANO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 15 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003219                                                                  
003220     IF SQLCODE NOT = +0                                          
003221        PERFORM Z00-ERRORE                                        
003222           THRU Z00-EX                                            
003223     ELSE                                                         
003224        MOVE 'U'                 TO PPROUTIN                      
003225        MOVE 'D'                 TO PPTPFILE                      
003226        MOVE 'R'                 TO PPTPOPER                      
003227        MOVE 'SOCIETA'           TO PPNMFILE                      
003228        PERFORM Z90-READPRIN                                      
003229           THRU Z90-EX.                                           
003230                                                                  
003231 L11-EX. EXIT.                                                    
003232*----------------------------------------------------------------*
003233 L15-SELECT-TCLIENTI.                                             
003234*----------------------------------------------------------------*
003235                                                                  
003236     MOVE 'L15-'                 TO WCOM-CODABEND.                
003237     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003238     MOVE 'CLIENTI'              TO WCOM-FILENOME.                
003239     MOVE A901-CODCLIEN          TO WCOM-FILECTRL.                
003240                                                                  
003242     
      *EXEC SQL 
      *SELECT ESENTIVA, PAESFATT, PAESMERC,                    
003243*                 CONDPAGA, RAGFATTU, CITFATTU,                    
003244*                 CODDIVIS, CAPFATTU, INDFATTU,                    
003245*                 ZONAFATT, CODILING, CODFISCA,                    
003246*                 ESRAGFAT, ESINDFAT, ESCITFAT,                    
003247*                 CDIVACEE, BULSTATX, GENECLIE,                    
003248*                 CLIEFATT, RAGMERCE, ESRAGMER,                    
003249*                 INDMERCE, ESINDMER, CAPMERCE,                    
003250*                 CITMERCE, ESCITMER,                              
003251*                 NUMESIVA, DATESIVA, UFFICIVA,                    
003252*                 ZIPMERCE, ZIPFATTU, TIPOCONS,                    
003253*                 FLFATELE, CLIFOCON                               
003254*            INTO :A901-ESENTIVA, :A901-PAESFATT, :A901-PAESMERC,  
003255*                 :A901-CONDPAGA, :A901-RAGFATTU, :A901-CITFATTU,  
003256*                 :A901-CODDIVIS, :A901-CAPFATTU, :A901-INDFATTU,  
003257*                 :A901-ZONAFATT, :A901-CODILING, :A901-CODFISCA,  
003258*                 :A901-ESRAGFAT, :A901-ESINDFAT, :A901-ESCITFAT,  
003259*                 :A901-CDIVACEE, :A901-BULSTATX, :A901-GENECLIE,  
003260*                 :A901-CLIEFATT, :A901-RAGMERCE, :A901-ESRAGMER,  
003261*                 :A901-INDMERCE, :A901-ESINDMER, :A901-CAPMERCE,  
003262*                 :A901-CITMERCE, :A901-ESCITMER,                  
003263*                 :A901-NUMESIVA, :A901-DATESIVA, :A901-UFFICIVA,  
003264*                 :A901-ZIPMERCE, :A901-ZIPFATTU, :A901-TIPOCONS,  
003265*                 :A901-FLFATELE, :A901-CLIFOCON                   
003266*            FROM DANAGRAF.TCLIENTI                                
003267*           WHERE CODCLIEN = :A901-CODCLIEN                        
003268*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 21 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODCLIEN
            BY VALUE 0
                     0

           MOVE 22 TO SQL-STMT-ID 
           MOVE 34 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-ESENTIVA
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-PAESFATT
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-PAESMERC
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CONDPAGA
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-RAGFATTU
            BY VALUE 0
                     0

           MOVE 18 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CITFATTU
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODDIVIS
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CAPFATTU
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-INDFATTU
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-ZONAFATT
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODILING
            BY VALUE 0
                     0

           MOVE 16 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODFISCA
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-ESRAGFAT
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-ESINDFAT
            BY VALUE 0
                     0

           MOVE 18 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-ESCITFAT
            BY VALUE 0
                     0

           MOVE 14 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CDIVACEE
            BY VALUE 0
                     0

           MOVE 13 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-BULSTATX
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 17 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-GENECLIE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 18 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CLIEFATT
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 19 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-RAGMERCE
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 20 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-ESRAGMER
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 21 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-INDMERCE
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 22 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-ESINDMER
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 23 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CAPMERCE
            BY VALUE 0
                     0

           MOVE 18 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 24 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CITMERCE
            BY VALUE 0
                     0

           MOVE 18 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 25 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-ESCITMER
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 26 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-NUMESIVA
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 27 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-DATESIVA
            BY VALUE 0
                     0

           MOVE 18 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 28 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-UFFICIVA
            BY VALUE 0
                     0

           MOVE 15 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 29 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-ZIPMERCE
            BY VALUE 0
                     0

           MOVE 15 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 30 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-ZIPFATTU
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 31 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-TIPOCONS
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 32 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-FLFATELE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 33 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CLIFOCON
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 16 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003269                                                                  
003270     IF SQLCODE NOT = +0                                          
003271        PERFORM Z00-ERRORE                                        
003272           THRU Z00-EX                                            
003273     ELSE                                                         
003274        MOVE 'U'                 TO PPROUTIN                      
003275        MOVE 'D'                 TO PPTPFILE                      
003276        MOVE 'R'                 TO PPTPOPER                      
003277        MOVE 'TCLIENTI'          TO PPNMFILE                      
003278        PERFORM Z90-READPRIN                                      
003279           THRU Z90-EX.                                           
003280                                                                  
003281 L15-EX. EXIT.                                                    
003282*----------------------------------------------------------------*
003283 L17-SELECT-CLIEFATT.                                             
003284*----------------------------------------------------------------*
003285                                                                  
003286     MOVE 'L17-'                 TO WCOM-CODABEND.                
003287     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003288     MOVE 'CLIENTI'              TO WCOM-FILENOME.                
003289     MOVE A901-CODCLIEN          TO WCOM-FILECTRL.                
003290                                                                  
003292     
      *EXEC SQL 
      *SELECT ESENTIVA, PAESFATT,                              
003293*                 CONDPAGA, RAGFATTU, CITFATTU,                    
003294*                 CODDIVIS, CAPFATTU, INDFATTU,                    
003295*                 ZONAFATT, CODILING, CODFISCA,                    
003296*                 ESRAGFAT, ESINDFAT, ESCITFAT,                    
003297*                 CDIVACEE, BULSTATX, GENECLIE,                    
003298*                 NUMESIVA, DATESIVA, UFFICIVA,                    
003299*                 ZIPFATTU, FLFATELE                               
003300*            INTO :A901-ESENTIVA,:A901-PAESFATT,                   
003301*                 :A901-CONDPAGA,:A901-RAGFATTU,:A901-CITFATTU,    
003302*                 :A901-CODDIVIS,:A901-CAPFATTU,:A901-INDFATTU,    
003303*                 :A901-ZONAFATT,:A901-CODILING,:A901-CODFISCA,    
003304*                 :A901-ESRAGFAT,:A901-ESINDFAT,:A901-ESCITFAT,    
003305*                 :A901-CDIVACEE,:A901-BULSTATX,:A901-GENECLIE,    
003306*                 :A901-NUMESIVA,:A901-DATESIVA,:A901-UFFICIVA,    
003307*                 :A901-ZIPFATTU,:A901-FLFATELE                    
003308*            FROM DANAGRAF.TCLIENTI                                
003309*           WHERE CODCLIEN = :A901-CODCLIEN                        
003310*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 23 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODCLIEN
            BY VALUE 0
                     0

           MOVE 24 TO SQL-STMT-ID 
           MOVE 22 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-ESENTIVA
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-PAESFATT
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CONDPAGA
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-RAGFATTU
            BY VALUE 0
                     0

           MOVE 18 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CITFATTU
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODDIVIS
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CAPFATTU
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-INDFATTU
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-ZONAFATT
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODILING
            BY VALUE 0
                     0

           MOVE 16 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODFISCA
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-ESRAGFAT
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-ESINDFAT
            BY VALUE 0
                     0

           MOVE 18 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-ESCITFAT
            BY VALUE 0
                     0

           MOVE 14 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CDIVACEE
            BY VALUE 0
                     0

           MOVE 13 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-BULSTATX
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-GENECLIE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 17 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-NUMESIVA
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 18 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-DATESIVA
            BY VALUE 0
                     0

           MOVE 18 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 19 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-UFFICIVA
            BY VALUE 0
                     0

           MOVE 15 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 20 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-ZIPFATTU
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 21 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-FLFATELE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 17 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003311                                                                  
003312     IF SQLCODE NOT = +0                                          
003313        PERFORM Z00-ERRORE                                        
003314           THRU Z00-EX                                            
003315     ELSE                                                         
003316        MOVE 'U'                 TO PPROUTIN                      
003317        MOVE 'D'                 TO PPTPFILE                      
003318        MOVE 'R'                 TO PPTPOPER                      
003319        MOVE 'CLIEFAT'           TO PPNMFILE                      
003320        PERFORM Z90-READPRIN                                      
003321           THRU Z90-EX.                                           
003322                                                                  
003323 L17-EX. EXIT.                                                    
003324*----------------------------------------------------------------*
003325 L20-SELECT-MOVICONT.                                             
003326*----------------------------------------------------------------*
003327                                                                  
003328     MOVE 'L20-'                 TO WCOM-CODABEND.                
003329     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003330     MOVE 'MOVICONT'             TO WCOM-FILENOME.                
003331     MOVE SPACES                 TO WCOM-FILECTRL.                
003332     STRING A019-CDMOVCON ' ' A019-CODILING                       
003333        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
003334                                                                  
003336     
      *EXEC SQL 
      *SELECT DESCMOVI                                         
003337*            INTO :A019-DESCMOVI                                   
003338*            FROM DANAGRAF.VANAGRAF_019                            
003339*           WHERE CDMOVCON = :A019-CDMOVCON                        
003340*             AND CODILING = :A019-CODILING                        
003341*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 25 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A019-CDMOVCON
            BY VALUE 0
                     0

           MOVE 20 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A019-CODILING
            BY VALUE 0
                     0

           MOVE 26 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 20 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A019-DESCMOVI
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 18 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003342                                                                  
003343     IF SQLCODE NOT = +0                                          
003344        PERFORM Z00-ERRORE                                        
003345           THRU Z00-EX                                            
003346     ELSE                                                         
003347        MOVE 'U'                 TO PPROUTIN                      
003348        MOVE 'D'                 TO PPTPFILE                      
003349        MOVE 'R'                 TO PPTPOPER                      
003350        MOVE 'MOVICONT'          TO PPNMFILE                      
003351        PERFORM Z90-READPRIN                                      
003352           THRU Z90-EX.                                           
003353                                                                  
003354 L20-EX. EXIT.                                                    
003355*----------------------------------------------------------------*
003356 L30-SELECT-CONDIPAGADESC.                                        
003357*----------------------------------------------------------------*
003358                                                                  
003359     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003360     MOVE 'CONDIPAGADESC'        TO WCOM-FILENOME.                
003361     MOVE 'L30-'                 TO WCOM-CODABEND.                
003362     MOVE SPACE                  TO WCOM-FILECTRL.                
003363     STRING A355-CONDPAGA ' '  A355-CODILING                      
003364            DELIMITED BY SIZE  INTO WCOM-FILECTRL.                
003365                                                                  
003366     MOVE SPACES                 TO A355-DESCPAGA.                
003367     MOVE SPACES                 TO A840-TIPOPAGA.                
003368                                                                  
003369     MOVE ZEROS                  TO A840-PERCIMP1                 
003370                                    A840-PERCIMP2                 
003371                                    A840-PERCIMP3                 
003372                                    A840-PERCIMP4                 
003374     
      *EXEC SQL 
      *SELECT A.DESCPAGA, B.TIPOPAGA                           
003375*                ,B.CONDXASS                                       
003376*                ,B.PERCIMP1, B.PERCIMP2                           
003377*                ,B.PERCIMP3, B.PERCIMP4                           
003378*            INTO :A355-DESCPAGA, :A840-TIPOPAGA                   
003379*                ,:A840-CONDXASS                                   
003380*                ,:A840-PERCIMP1, :A840-PERCIMP2                   
003381*                ,:A840-PERCIMP3, :A840-PERCIMP4                   
003382*            FROM DANAGRAF.TCONDIPAGADESC A                        
003383*                ,DANAGRAF.TCONDIPAGA     B                        
003384*           WHERE A.CONDPAGA = :A355-CONDPAGA                      
003385*             AND A.CODILING = :A355-CODILING                      
003386*             AND A.CONDPAGA = B.CONDPAGA                          
003387*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 27 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A355-CONDPAGA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A355-CODILING
            BY VALUE 0
                     0

           MOVE 28 TO SQL-STMT-ID 
           MOVE 7 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 60 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A355-DESCPAGA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A840-TIPOPAGA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A840-CONDXASS
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A840-PERCIMP1
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A840-PERCIMP2
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A840-PERCIMP3
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A840-PERCIMP4
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 19 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003388                                                                  
003389     IF SQLCODE = +0                                              
003390        MOVE 'U'                 TO PPROUTIN                      
003391        MOVE 'D'                 TO PPTPFILE                      
003392        MOVE 'R'                 TO PPTPOPER                      
003393        MOVE 'CONDIPAGA'         TO PPNMFILE                      
003394        PERFORM Z90-READPRIN                                      
003395           THRU Z90-EX.                                           
003396                                                                  
003397 L30-EX. EXIT.                                                    
003398*----------------------------------------------------------------*
003399 L40-SCBNMFA.                                                     
003400*----------------------------------------------------------------*
003401                                                                  
003402     MOVE 'L40-'                 TO WCOM-CODABEND.                
003403     MOVE 'CALL  '               TO WCOM-FILEFUNZ.                
003404     MOVE 'SCBNMFA'              TO WCOM-FILENOME                 
003405     MOVE 'SCBNMFA'              TO PPCALL.                       
003406     CALL  PPCALL    USING       DCPARM  DCNMFA.                  
003407                                                                  
003408     IF NMFA-RISPOSTA NOT = '****'                                
003409        MOVE NMFA-RISPOSTA       TO WCOM-CODABEND                 
003410        PERFORM Z00-ERRORE                                        
003411           THRU Z00-EX.                                           
003412                                                                  
003413 L40-EX. EXIT.                                                    
003414*----------------------------------------------------------------*
003415 L50-SELECT-PAESLING.                                             
003416*----------------------------------------------------------------*
003417                                                                  
003418     MOVE 'L50-'                 TO WCOM-CODABEND.                
003419     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003420     MOVE 'PAELING'              TO WCOM-FILENOME.                
003421     MOVE SPACES                 TO WCOM-FILECTRL.                
003422     STRING A529-CODPAESE ' ' A529-CODILING                       
003423        DELIMITED BY SIZE INTO      WCOM-FILECTRL.                
003424                                                                  
003426     
      *EXEC SQL 
      *SELECT SIGLAPAE                                         
003427*            INTO :A529-SIGLAPAE                                   
003428*            FROM DANAGRAF.TPAESLING                               
003429*           WHERE CODPAESE = :A529-CODPAESE                        
003430*             AND CODILING = :A529-CODILING                        
003431*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 29 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A529-CODPAESE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A529-CODILING
            BY VALUE 0
                     0

           MOVE 30 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A529-SIGLAPAE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 20 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003432                                                                  
003433     IF SQLCODE NOT EQUAL ZERO                                    
003434        PERFORM Z00-ERRORE                                        
003435           THRU Z00-EX                                            
003436     ELSE                                                         
003437        MOVE 'U'                 TO PPROUTIN                      
003438        MOVE 'D'                 TO PPTPFILE                      
003439        MOVE 'R'                 TO PPTPOPER                      
003440        MOVE 'PAESLING'          TO PPNMFILE                      
003441        PERFORM Z90-READPRIN                                      
003442           THRU Z90-EX.                                           
003443                                                                  
003444 L50-EX. EXIT.                                                    
003445*----------------------------------------------------------------*
003446 L55-SELECT-PAESI.                                                
003447*----------------------------------------------------------------*
003448                                                                  
003449     MOVE 'L55-'                 TO WCOM-CODABEND.                
003450     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003451     MOVE 'PAESI'                TO WCOM-FILENOME.                
003452     MOVE A528-CODPAESE          TO WCOM-FILECTRL.                
003453                                                                  
003455     
      *EXEC SQL 
      *SELECT FLPAECEE                                         
003456*            INTO :A528-FLPAECEE                                   
003457*            FROM DANAGRAF.TPAESI                                  
003458*           WHERE CODPAESE = :A528-CODPAESE                        
003459*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 31 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A528-CODPAESE
            BY VALUE 0
                     0

           MOVE 32 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A528-FLPAECEE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 21 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003460                                                                  
003461     IF SQLCODE NOT EQUAL ZERO                                    
003462        PERFORM Z00-ERRORE                                        
003463           THRU Z00-EX                                            
003464     ELSE                                                         
003465        MOVE 'U'                 TO PPROUTIN                      
003466        MOVE 'D'                 TO PPTPFILE                      
003467        MOVE 'R'                 TO PPTPOPER                      
003468        MOVE 'PAESI'             TO PPNMFILE                      
003469        PERFORM Z90-READPRIN                                      
003470           THRU Z90-EX.                                           
003471                                                                  
003472 L55-EX. EXIT.                                                    
003473*----------------------------------------------------------------*
003474 L60-SELECT-DIVISE.                                               
003475*----------------------------------------------------------------*
003476                                                                  
003477     MOVE 'L60-'                 TO WCOM-CODABEND.                
003478     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003479     MOVE 'DIVISE'               TO WCOM-FILENOME.                
003480     MOVE A963-CODDIVIS          TO WCOM-FILECTRL.                
003481                                                                  
003483     
      *EXEC SQL 
      *SELECT DISTINCT SLDIVBAN, DECIDIVI                      
003484*            INTO :A963-SLDIVBAN, :A963-DECIDIVI                   
003485*            FROM DANAGRAF.TDIVISE                                 
003486*           WHERE CODDIVIS = :A963-CODDIVIS                        
003487*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 33 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A963-CODDIVIS
            BY VALUE 0
                     0

           MOVE 34 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A963-SLDIVBAN
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A963-DECIDIVI
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 22 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003488                                                                  
003489     IF SQLCODE NOT EQUAL ZERO                                    
003490        PERFORM Z00-ERRORE                                        
003491           THRU Z00-EX                                            
003492     ELSE                                                         
003493        MOVE 'U'                 TO PPROUTIN                      
003494        MOVE 'D'                 TO PPTPFILE                      
003495        MOVE 'R'                 TO PPTPOPER                      
003496        MOVE 'DIVISE'            TO PPNMFILE                      
003497        PERFORM Z90-READPRIN                                      
003498           THRU Z90-EX.                                           
003499                                                                  
003500 L60-EX. EXIT.                                                    
003501*----------------------------------------------------------------*
003502 L65-SELECT-RIGORDILOGI.                                          
003503*----------------------------------------------------------------*
003504                                                                  
003505     MOVE 'L65-'                 TO WCOM-CODABEND.                
003506     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003507     MOVE 'RIGORDILOGI'          TO WCOM-FILENOME.                
003508     MOVE L652-AANUMORD          TO WCOM-FILECTRL.                
003509                                                                  
003511     
      *EXEC SQL 
      *SELECT CENCOSTA                                         
003512*            INTO :WS-CENCOSTA                                     
003513*            FROM DLOGISTI.TRIGORDILOGI                            
003514*           WHERE AANUMORD = :L652-AANUMORD                        
003515*           FETCH FIRST ROWS ONLY                                  
003516*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 35 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMORD
            BY VALUE 0
                     0

           MOVE 36 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CENCOSTA
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 23 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003517                                                                  
003518     IF SQLCODE NOT EQUAL ZERO                                    
003519        PERFORM Z00-ERRORE                                        
003520           THRU Z00-EX                                            
003521     ELSE                                                         
003522        MOVE 'U'                 TO PPROUTIN                      
003523        MOVE 'D'                 TO PPTPFILE                      
003524        MOVE 'R'                 TO PPTPOPER                      
003525        MOVE 'RIGODILOGI'        TO PPNMFILE                      
003526        PERFORM Z90-READPRIN                                      
003527           THRU Z90-EX.                                           
003528                                                                  
003529 L65-EX. EXIT.                                                    
003530*----------------------------------------------------------------*
003531 L70-SELECT-ALIQUIVA.                                             
003532*----------------------------------------------------------------*
003533                                                                  
003534     MOVE 'L70-'                 TO WCOM-CODABEND.                
003535     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003536     MOVE 'ALIQUIVA'             TO WCOM-FILENOME.                
003537     MOVE  A122-CODSOCIE         TO WCOM-FILECTRL.                
003538                                                                  
003540     
      *EXEC SQL 
      *SELECT PERIVAFA                                          
003541*           INTO :A122-PERIVAFA                                    
003542*           FROM DANAGRAF.VANAGRAF_122                             
003543*          WHERE CODSOCIE = :A122-CODSOCIE                         
003544*            AND INDICIVA = :A122-INDICIVA                         
003545*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 37 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A122-CODSOCIE
            BY VALUE 0
                     0

           MOVE 20 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A122-INDICIVA
            BY VALUE 0
                     0

           MOVE 38 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 781 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A122-PERIVAFA
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 24 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003546                                                                  
003547     IF SQLCODE NOT EQUAL ZERO                                    
003548        PERFORM Z00-ERRORE                                        
003549           THRU Z00-EX                                            
003550     ELSE                                                         
003551        MOVE 'U'                 TO PPROUTIN                      
003552        MOVE 'D'                 TO PPTPFILE                      
003553        MOVE 'R'                 TO PPTPOPER                      
003554        MOVE 'ALIQUIVA'          TO PPNMFILE                      
003555        PERFORM Z90-READPRIN                                      
003556           THRU Z90-EX.                                           
003557                                                                  
003558 L70-EX. EXIT.                                                    
003559*----------------------------------------------------------------*
003560 L80-SELECT-TIPOPAGA.                                             
003561*----------------------------------------------------------------*
003562                                                                  
003563     MOVE 'L80-'                    TO WCOM-CODABEND              
003564     MOVE 'SELECT'                  TO WCOM-FILEFUNZ              
003565     MOVE 'TIPOPAGA'                TO WCOM-FILENOME              
003566     MOVE A112-TIPOPAG1             TO WCOM-FILECTRL              
003567                                                                  
003569     
      *EXEC SQL 
      *SELECT TIPOPAG2                                         
003570*            INTO :A112-TIPOPAG2                                   
003571*            FROM DANAGRAF.VANAGRAF_112                            
003572*           WHERE TIPOPAG1 =:A112-TIPOPAG1                         
003573*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 39 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A112-TIPOPAG1
            BY VALUE 0
                     0

           MOVE 40 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 20 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A112-TIPOPAG2
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 25 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003574                                                                  
003575     IF SQLCODE NOT EQUAL ZERO                                    
003576        PERFORM Z00-ERRORE                                        
003577           THRU Z00-EX                                            
003578     ELSE                                                         
003579        MOVE 'U'                 TO PPROUTIN                      
003580        MOVE 'D'                 TO PPTPFILE                      
003581        MOVE 'R'                 TO PPTPOPER                      
003582        MOVE 'TIPOPAGA'          TO PPNMFILE                      
003583        PERFORM Z90-READPRIN                                      
003584           THRU Z90-EX.                                           
003585                                                                  
003586 L80-EX. EXIT.                                                    
003587*----------------------------------------------------------------*
003588 L90-SELECT-CONTIDCE.                                             
003589*----------------------------------------------------------------*
003590                                                                  
003591     MOVE 'L90-'                    TO WCOM-CODABEND              
003592     MOVE 'SELECT'                  TO WCOM-FILEFUNZ              
003593     MOVE 'CONTIDCE'                TO WCOM-FILENOME              
003594     MOVE SPACES                    TO WCOM-FILECTRL              
003595     STRING C861-CODPIANO ' ' C861-CONTPROV                       
003596        DELIMITED BY SIZE          INTO WCOM-FILECTRL.            
003597                                                                  
003599     
      *EXEC SQL 
      *SELECT CONTODCE                                         
003600*            INTO :C861-CONTODCE                                   
003601*            FROM DCONTCLI.TCONTIDCE                               
003602*           WHERE CODPIANO = :C861-CODPIANO                        
003603*             AND CONTPROV = :C861-CONTPROV                        
003604*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 41 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CODPIANO
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTPROV
            BY VALUE 0
                     0

           MOVE 42 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTODCE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 26 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003605                                                                  
003606     IF SQLCODE NOT EQUAL ZERO                                    
003607        PERFORM Z00-ERRORE                                        
003608           THRU Z00-EX                                            
003609     ELSE                                                         
003610        MOVE 'U'                 TO PPROUTIN                      
003611        MOVE 'D'                 TO PPTPFILE                      
003612        MOVE 'R'                 TO PPTPOPER                      
003613        MOVE 'CONTIDCE'          TO PPNMFILE                      
003614        PERFORM Z90-READPRIN                                      
003615           THRU Z90-EX.                                           
003616                                                                  
003617 L90-EX. EXIT.                                                    
003618*----------------------------------------------------------------*
003619 L95-SELECT-CONTIDCE.                                             
003620*----------------------------------------------------------------*
003621                                                                  
003622     MOVE 'L95-'                    TO WCOM-CODABEND              
003623     MOVE 'SELECT'                  TO WCOM-FILEFUNZ              
003624     MOVE 'CONTIDCE'                TO WCOM-FILENOME              
003625     MOVE SPACES                    TO WCOM-FILECTRL              
003626     STRING C861-CODPIANO ' ' C861-CONTODCE                       
003627        DELIMITED BY SIZE          INTO WCOM-FILECTRL.            
003628                                                                  
003630     
      *EXEC SQL 
      *SELECT DESCRDCE, CONTPROV                               
003631*            INTO :C861-DESCRDCE, :C861-CONTPROV                   
003632*            FROM DCONTCLI.TCONTIDCE                               
003633*           WHERE CODPIANO = :C861-CODPIANO                        
003634*             AND CONTODCE = :C861-CONTODCE                        
003635*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 43 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CODPIANO
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTODCE
            BY VALUE 0
                     0

           MOVE 44 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 25 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-DESCRDCE
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTPROV
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 27 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003636                                                                  
003637     IF SQLCODE NOT EQUAL ZERO                                    
003638        PERFORM Z00-ERRORE                                        
003639           THRU Z00-EX                                            
003640     ELSE                                                         
003641        MOVE 'U'                 TO PPROUTIN                      
003642        MOVE 'D'                 TO PPTPFILE                      
003643        MOVE 'R'                 TO PPTPOPER                      
003644        MOVE 'CONTIDCE'          TO PPNMFILE                      
003645        PERFORM Z90-READPRIN                                      
003646           THRU Z90-EX.                                           
003647                                                                  
003648 L95-EX. EXIT.                                                    
003649*----------------------------------------------------------------*
003650 L100-SELECT-ANAG.                                                
003651*----------------------------------------------------------------*
003652                                                                  
003653     MOVE 'L100'                    TO WCOM-CODABEND              
003654     MOVE 'SELECT'                  TO WCOM-FILEFUNZ              
003655     MOVE 'ANAG-ARTI'               TO WCOM-FILENOME              
003656     MOVE WS-CODARTIC               TO WCOM-FILECTRL              
003657                                                                  
003658     MOVE SPACES                    TO WS-DESARTIC                
003660     
      *EXEC SQL 
      *SELECT DESARTIC                                         
003661*            INTO :WS-DESARTIC                                     
003662*            FROM                                                  
003663*         (SELECT DESARTGG DESARTIC                                
003664*            FROM DANAGRAF.TARTIGREG                               
003665*           WHERE CODARTGG         = :WS-CODARTIC                  
003666*             AND :WS-MERCEMAG     IN ('GS','PS','PT')             
003667*       UNION ALL                                                  
003668*          SELECT DESARTFI DESARTIC                                
003669*            FROM DANAGRAF.TARTICOLI                               
003670*           WHERE CODARTFI         = :WS-CODARTIC                  
003671*             AND :WS-MERCEMAG NOT IN ('GS','PS','PT')) AS X       
003672*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 45 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CODARTIC
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-MERCEMAG
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CODARTIC
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-MERCEMAG
            BY VALUE 0
                     0

           MOVE 46 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DESARTIC
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 28 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003673                                                                  
003674     IF SQLCODE EQUAL ZERO                                        
003675        MOVE 'U'                 TO PPROUTIN                      
003676        MOVE 'D'                 TO PPTPFILE                      
003677        MOVE 'R'                 TO PPTPOPER                      
003678        MOVE 'ANAG-ARTI'         TO PPNMFILE                      
003679        PERFORM Z90-READPRIN                                      
003680           THRU Z90-EX.                                           
003681                                                                  
003682 L100-EX. EXIT.                                                   
003683*----------------------------------------------------------------*
003684 L105-SELECT-CONTROLSKCOS.                                        
003685*----------------------------------------------------------------*
003686                                                                  
003687     MOVE L652-CODSOCIE          TO S426-CODSOCIE                 
003688                                                                  
003689     MOVE 'L105-'                TO WCOM-CODABEND.                
003690     MOVE 'CONTROLSKCOS'         TO WCOM-FILENOME.                
003691     MOVE S426-CODSOCIE          TO WCOM-FILECTRL                 
003692     MOVE 'SELECT'               TO WCOM-FILECTRL                 
003693                                                                  
003695     
      *EXEC SQL 
      *SELECT DTINIPER, DTFINPER, DATACOST                     
003696*            INTO :S426-DTINIPER, :S426-DTFINPER, :S426-DATACOST   
003697*            FROM DSKCOSTO.TCONTROLSKCOS                           
003698*           WHERE CODSOCIE = :S426-CODSOCIE                        
003699*             AND DATAESTR > ' '                                   
003700*           ORDER BY DATAESTR DESC                                 
003701*           FETCH FIRST 1 ROWS ONLY                                
003702*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 47 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S426-CODSOCIE
            BY VALUE 0
                     0

           MOVE 48 TO SQL-STMT-ID 
           MOVE 3 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S426-DTINIPER
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S426-DTFINPER
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S426-DATACOST
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 29 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003703     IF SQLCODE = ZEROES                                          
003704        MOVE 'U'                 TO PPROUTIN                      
003705        MOVE 'D'                 TO PPTPFILE                      
003706        MOVE 'R'                 TO PPTPOPER                      
003707        MOVE WCOM-FILENOME       TO PPNMFILE                      
003708        PERFORM Z90-READPRIN                                      
003709           THRU Z90-EX.                                           
003710                                                                  
003711 L105-EX. EXIT.                                                   
003712*----------------------------------------------------------------*
003713 W00-WRITE-OUTFATT.                                               
003714*----------------------------------------------------------------*
003715                                                                  
003716     MOVE SPACES                 TO WS-OUTFATT.                   
003717     INITIALIZE                     WS-OUTFATT.                   
003718                                                                  
003719     MOVE WS-CODSOCIE            TO OUT-CODSOCIE.                 
003720     MOVE 'F'                    TO OUT-CDMOVCON.                 
003721     MOVE WS-NUMEAUTO            TO OUT-NRMOVCON.                 
003722     MOVE WS-DTGIORNO            TO OUT-DTREGMOV.                 
003723     MOVE A901-CODILING          TO OUT-CODILING.                 
003724     MOVE A901-CODCLIEN          TO OUT-CODCLIEN.                 
003725     MOVE WS-CONTPROV            TO OUT-CONTPROV.                 
003726                                                                  
003727     WRITE REC-OUTFATT FROM WS-OUTFATT.                           
003728     MOVE 'U'                    TO PPROUTIN.                     
003729     MOVE 'S'                    TO PPTPFILE.                     
003730     MOVE 'A'                    TO PPTPOPER.                     
003731     MOVE 'OUTFATT'              TO PPNMFILE.                     
003732     PERFORM Z90-READPRIN                                         
003733        THRU Z90-EX.                                              
003734                                                                  
003735 W00-EX. EXIT.                                                    
003736*----------------------------------------------------------------*
003737 W10-WRITE-INPCONT.                                               
003738*----------------------------------------------------------------*
003739                                                                  
003740     WRITE REC-INPCONT FROM FSINFR00.                             
003741     MOVE 'U'                    TO PPROUTIN.                     
003742     MOVE 'S'                    TO PPTPFILE.                     
003743     MOVE 'A'                    TO PPTPOPER.                     
003744     MOVE 'INPCONT'              TO PPNMFILE.                     
003745     PERFORM Z90-READPRIN                                         
003746        THRU Z90-EX.                                              
003747                                                                  
003748 W10-EX. EXIT.                                                    
003749*----------------------------------------------------------------*
003750 W20-WRITE-OUTCON2.                                               
003751*----------------------------------------------------------------*
003752                                                                  
003753     WRITE REC-OUTCON2 FROM FSEC90.                               
003754     MOVE 'U'                    TO PPROUTIN.                     
003755     MOVE 'S'                    TO PPTPFILE.                     
003756     MOVE 'A'                    TO PPTPOPER.                     
003757     MOVE 'OUTCON2'              TO PPNMFILE.                     
003758     PERFORM Z90-READPRIN                                         
003759        THRU Z90-EX.                                              
003760                                                                  
003761 W20-EX. EXIT.                                                    
003762*----------------------------------------------------------------*
003763 Z00-ERRORE.                                                      
003764*----------------------------------------------------------------*
003765                                                                  
003766     MOVE 'SCDB2ER'              TO PPCALL.                       
003767     CALL  PPCALL USING DCPARM DCDB2ER SQLCA.                     
003768                                                                  
003769 Z00-EX. EXIT.                                                    
003770*----------------------------------------------------------------*
003771 Z90-READPRIN.                                                    
003772*----------------------------------------------------------------*
003773                                                                  
003774     MOVE 'READPRIN'             TO PPCALL.                       
003775     CALL  PPCALL USING DCPARM.                                   
003776                                                                  
003777 Z90-EX. EXIT.                                                    
003778*----------------------------------------------------------------*
003781*    EXEC SQL                                                     
      *         INCLUDE SRESEN0                                         
      *    END-EXEC.                                                    
      *>>((file: SRESEN0))
000001*---------------------------------------------------------------* 
000002*    RICERCA RIGHE DICHIARAZIONI FATTURA X ESENZIONE IVA        * 
000003*---------------------------------------------------------------* 
000004* N.B.  INSERIRE IN WORKING STORAGE :                           * 
000005*    EXEC SQL INCLUDE FDCLI865 END-EXEC.(TSOLLECITI)            * 
000006*    EXEC SQL INCLUDE FDANA531 END-EXEC.(TSOCIETA)              * 
000007*    EXEC SQL INCLUDE FDANA528 END-EXEC.(TPAESI)                * 
000008*    EXEC SQL INCLUDE DCESE0   END-EXEC.(AREA DATI)             * 
000009*    IMPOSTARE I SEGUENTI CAMPI DELLA DCESE0   :                * 
000010*                ESE0-CODSOCIE                                  * 
000011*                ESE0-ESENTIVA                                  * 
000012*                ESE0-FLDESFAT                                  * 
000013*    IN OUTPUT RESTITUISCE TABELLA RIGA ESENZIONI :             * 
000014*                ESE0-RIGASOLL                                  * 
000015*---------------------------------------------------------------* 
000016 SRESEN0.                                                         
000017*---------------------------------------------------------------* 
000018                                                                  
000019     INITIALIZE ESE0-TABESEN.                                     
000020     MOVE SPACES                            TO ESE0-CODERROR.     
000021     PERFORM SRESEN0-A00-VALIDITA                                 
000022        THRU SRESEN0-A00-EX.                                      
000023     IF ESE0-CODERROR NOT GREATER SPACES                          
000024        PERFORM SRESEN0-A10-ELABORA                               
000025           THRU SRESEN0-A10-EX.                                   
000026                                                                  
000027 SRESEN0-EX. EXIT.                                                
000028                                                                  
000029*---------------------------------------------------------------* 
000030 SRESEN0-A00-VALIDITA.                                            
000031*---------------------------------------------------------------* 
000032                                                                  
000033     IF ESE0-CODSOCIE NOT GREATER SPACES                          
000034        MOVE '00036'                        TO ESE0-CODERROR      
000035     ELSE                                                         
000036        MOVE ESE0-CODSOCIE                  TO A531-CODSOCIE      
000038        
      *EXEC SQL 
      *SELECT B.CODILING                                    
000039*             INTO :A528-CODILING                                  
000040*             FROM DANAGRAF.TSOCIETA     A,                        
000041*                  DANAGRAF.TPAESI       B                         
000042*             WHERE A.CODSOCIE = :A531-CODSOCIE                    
000043*               AND A.CODPAESE = B.CODPAESE                        
000044*        END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 49 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 50 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A528-CODILING
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 30 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000045        IF SQLCODE = +100                                         
000046           MOVE '00205'                     TO ESE0-CODERROR.     
000047                                                                  
000048 SRESEN0-A00-EX. EXIT.                                            
000049                                                                  
000050*---------------------------------------------------------------* 
000051 SRESEN0-A10-ELABORA.                                             
000052*---------------------------------------------------------------* 
000053                                                                  
000054     MOVE A528-CODILING                     TO C865-CODILING.     
000055     MOVE ESE0-CODSOCIE                     TO C865-CODSOCIE.     
000056                                                                  
000058     
      *EXEC SQL 
      *OPEN POINT-ESE0                                          
000059*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 51 TO SQL-STMT-ID 
           MOVE 6 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C865-CODSOCIE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C865-CODILING
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE ESE0-ESENTIVA
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C865-CODSOCIE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C865-CODILING
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE ESE0-FLDESFAT
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000060                                                                  
000061     PERFORM SRESEN0-L00-FETCH-ESE0                               
000062        THRU SRESEN0-L00-EX.                                      
000063     IF SQLCODE EQUAL +100                                        
000064        MOVE  '00984'                      TO ESE0-CODERROR       
000065        GO TO SRESEN0-A10-CLOSE.                                  
000066                                                                  
000067     PERFORM SRESEN0-A15-MUOVI                                    
000068        THRU SRESEN0-A15-EX                                       
000069             VARYING ESE0-INDICE FROM 1 BY 1                      
000070               UNTIL SQLCODE = +100                               
000071                  OR ESE0-INDICE GREATER ESE0-MAX-IND.            
000072     IF ESE0-INDICE GREATER ESE0-MAX-IND                          
000073        MOVE  '00170'                      TO ESE0-CODERROR.      
000074                                                                  
000075 SRESEN0-A10-CLOSE.                                               
000077     
      *EXEC SQL 
      *CLOSE POINT-ESE0                                         
000078*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000079                                                                  
000080 SRESEN0-A10-EX. EXIT.                                            
000081                                                                  
000082*---------------------------------------------------------------* 
000083 SRESEN0-A15-MUOVI.                                               
000084*---------------------------------------------------------------* 
000085                                                                  
000086     MOVE  C865-RIGASOLL         TO ESE0-RIGASOLL(ESE0-INDICE).   
000087     PERFORM SRESEN0-L00-FETCH-ESE0                               
000088        THRU SRESEN0-L00-EX.                                      
000089                                                                  
000090 SRESEN0-A15-EX. EXIT.                                            
000091                                                                  
000092*---------------------------------------------------------------* 
000093 SRESEN0-L00-FETCH-ESE0.                                          
000094*---------------------------------------------------------------* 
000095                                                                  
000096     MOVE 'L00-'                            TO WCOM-CODABEND.     
000097     MOVE 'FETCH'                           TO WCOM-FILEFUNZ.     
000098     MOVE 'FDCLI865'                        TO WCOM-FILENOME.     
000099     STRING C865-CODSOCIE ' S ' C865-CODILING ' ' ESE0-ESENTIVA   
000100            ' ' ESE0-FLDESFAT                                     
000101     DELIMITED BY SIZE INTO                    WCOM-FILECTRL.     
000102                                                                  
000104     
      *EXEC SQL 
      *FETCH POINT-ESE0                                         
000105*         INTO :ESE0-ORDER-BY,                                     
000106*              :C865-NUMPROG5,                                     
000107*              :C865-RIGASOLL                                      
000108*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 52 TO SQL-STMT-ID 
           MOVE 3 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE ESE0-ORDER-BY
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C865-NUMPROG5
            BY VALUE 0
                     0

           MOVE 80 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C865-RIGASOLL
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000109                                                                  
000110 SRESEN0-L00-EX. EXIT.                                            
000111*---------------------------------------------------------------* 
      *<<((file: SRESEN0))
003782*----------------------------------------------------------------*
003785*    EXEC SQL                                                     
      *         INCLUDE SRDESC1                                         
      *    END-EXEC.                                                    
      *>>((file: SRDESC1))
000001*---------------------------------------------------------------* 
000002*    RICERCA RIGHE DICHIARAZIONI FATTURA X CODICE RESA MERCE    * 
000003*---------------------------------------------------------------* 
000004* N.B.  INSERIRE IN WORKING STORAGE :                           * 
000005*    EXEC SQL INCLUDE FDANA842 END-EXEC.(TCOMPLEDOC)            * 
000006*    EXEC SQL INCLUDE DCDES1   END-EXEC.(AREA DATI)             * 
000007*    IMPOSTARE I SEGUENTI CAMPI DELLA FDANA842 :                * 
000008*                A842-CODSOCIE                                  * 
000009*                A842-CODPAESE                                  * 
000010*                A842-FLFATMER                                  * 
000011*                A842-TIPODOCU                                  * 
000012*                A842-CODIRESA                                  * 
000013*    IN OUTPUT RESTITUISCE TABELLA RIGA DOCUMENTI :             * 
000014*                DES0-RIGADOCU                                  * 
000015*---------------------------------------------------------------* 
000016 SRDESC1.                                                         
000017                                                                  
000018     MOVE HIGH-VALUE             TO DES1-TABDOCU.                 
000019     MOVE SPACES                 TO DES1-CODERROR.                
000020     PERFORM SRDESC1-A00-VALIDITA                                 
000021        THRU SRDESC1-A00-EX.                                      
000022     IF DES1-CODERROR NOT GREATER SPACES                          
000023        PERFORM SRDESC1-A10-ELABORA                               
000024           THRU SRDESC1-A10-EX.                                   
000025                                                                  
000026 SRDESC1-EX. EXIT.                                                
000027                                                                  
000028 SRDESC1-A00-VALIDITA.                                            
000029                                                                  
000030     MOVE A842-TIPODOCU          TO DES1-TIPODOCU.                
000031     IF  A842-CODSOCIE NOT GREATER SPACES                         
000032         MOVE '00036'            TO DES1-CODERROR                 
000033     ELSE                                                         
000034         IF  A842-TIPODOCU NOT GREATER SPACES                     
000035             MOVE '00216'        TO DES1-CODERROR                 
000036         ELSE                                                     
000037             IF A842-TIPODOCU NOT = 'CG' AND                      
000038                DES1-TIPODOC1 NOT = 'F'                           
000039                MOVE '00216'     TO DES1-CODERROR                 
000040             ELSE                                                 
000041                IF A842-FLFATMER NOT EQUAL 'F' AND 'M'            
000042                   MOVE '00053'  TO DES1-CODERROR.                
000043                                                                  
000044 SRDESC1-A00-EX. EXIT.                                           
000045                                                                  
000046 SRDESC1-A10-ELABORA.                                             
000047                                                                  
000049     
      *EXEC SQL 
      *OPEN POINTDES1                                           
000050*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 53 TO SQL-STMT-ID 
           MOVE 5 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A842-CODSOCIE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A842-CODPAESE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A842-FLFATMER
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A842-TIPODOCU
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A842-CODIRESA
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000051                                                                  
000052     PERFORM SRDESC1-B00-FETCH-DES1                               
000053        THRU SRDESC1-B00-EX.                                      
000054                                                                  
000055     PERFORM SRDESC1-A20-MUOVI                                    
000056        THRU SRDESC1-A20-EX                                       
000057          VARYING DES1-INDICE FROM 1 BY 1                         
000058            UNTIL SQLCODE = 100  OR                               
000059                  DES1-INDICE GREATER DES1-MAX-IND.               
000060     IF SQLCODE NOT = 100                                         
000061        MOVE  '00170'            TO DES1-CODERROR.                
000062                                                                  
000064     
      *EXEC SQL 
      *CLOSE POINTDES1                                          
000065*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000066                                                                  
000067 SRDESC1-A10-EX. EXIT.                                           
000068                                                                  
000069 SRDESC1-A20-MUOVI.                                               
000070                                                                  
000071     MOVE  A842-RIGADOCU         TO DES1-RIGADOCU(DES1-INDICE).   
000072     PERFORM SRDESC1-B00-FETCH-DES1                               
000073        THRU SRDESC1-B00-EX.                                      
000074                                                                  
000075 SRDESC1-A20-EX. EXIT.                                            
000076                                                                  
000077 SRDESC1-B00-FETCH-DES1.                                          
000078                                                                  
000079     MOVE 'B00-'                 TO WCOM-CODABEND.                
000080     MOVE 'FETCH'                TO WCOM-FILEFUNZ.                
000081     MOVE 'FDANA842'             TO WCOM-FILENOME.                
000082     STRING  A842-CODSOCIE ' '  A842-CODPAESE ' '                 
000083             A842-TIPODOCU ' '  A842-CODIRESA ' '                 
000084             A842-FLFATMER                                        
000085             DELIMITED BY SIZE INTO WCOM-FILECTRL.                
000086                                                                  
000088     
      *EXEC SQL 
      *FETCH POINTDES1                                          
000089*         INTO :A842-NUMPROG5,                                     
000090*              :A842-RIGADOCU                                      
000091*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 54 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A842-NUMPROG5
            BY VALUE 0
                     0

           MOVE 80 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A842-RIGADOCU
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000092                                                                  
000093 SRDESC1-B00-EX. EXIT.                                           
000094                                                                  
      *<<((file: SRDESC1))
003788*    EXEC SQL                                                     
      *         INCLUDE SRDESC0                                         
      *    END-EXEC.                                                    
      *>>((file: SRDESC0))
000001*---------------------------------------------------------------* 
000002*    SUBROUTINE X LA RICERCA DICHIARAZIONI FATTURA X TIPO-MERCE * 
000003*---------------------------------------------------------------* 
000004* N.B.  INSERIRE IN WORKING STORAGE :                           * 
000005*    EXEC SQL INCLUDE FDANA842 END-EXEC.(TCOMPLEDOC)            * 
000006*    EXEC SQL INCLUDE DCDES0   END-EXEC.(AREA COMODI)           * 
000007*---------------------------------------------------------------* 
000008*    IMPOSTARE I SEGUENTI CAMPI DELLA FDANA842 :                * 
000009*                A842-CODSOCIE                                  * 
000010*                A842-CODPAESE                                  * 
000011*                A842-FLFATMER                                  * 
000012*                A842-TIPODOCU                                  * 
000013*                A842-TIPOMERC                                  * 
000014*    IN OUTPUT RESTITUISCE TABELLA RIGA DOCUMENTI :             * 
000015*                DES0-RIGADOCU                                  * 
000016*---------------------------------------------------------------* 
000017 SRDESC0.                                                         
000018                                                                  
000019     MOVE HIGH-VALUE             TO DES0-TABDOCU.                 
000020     MOVE SPACES                 TO DES0-CODERROR.                
000021     PERFORM SRDESC0-A00-VALIDITA                                 
000022        THRU SRDESC0-A00-EX.                                      
000023                                                                  
000024     IF DES0-CODERROR GREATER SPACES                              
000025        GO TO SRDESC0-EX.                                         
000026                                                                  
000027     IF A842-TIPOMERC NUMERIC                                     
000028        IF A842-CODPAESE = '009' AND                              
000029           A842-TIPOMERC = '3'                                    
000030           CONTINUE                                               
000031        ELSE                                                      
000032           IF A842-TIPOMERC NOT = '4'                             
000033              MOVE '1'           TO A842-TIPOMERC.                
000034                                                                  
000035     PERFORM SRDESC0-A10-ELABORA                                  
000036        THRU SRDESC0-A10-EX.                                      
000037                                                                  
000038 SRDESC0-EX. EXIT.                                                
000039                                                                  
000040 SRDESC0-A00-VALIDITA.                                            
000041                                                                  
000042     MOVE  A842-TIPODOCU         TO DES0-TIPODOCU.                
000043     IF  A842-CODSOCIE NOT GREATER SPACES                         
000044         MOVE '00036'            TO DES0-CODERROR                 
000045     ELSE                                                         
000046         IF  A842-TIPODOCU NOT GREATER SPACES                     
000047             MOVE '00216'        TO DES0-CODERROR                 
000048         ELSE                                                     
000049             IF A842-TIPODOCU NOT = 'CG' AND                      
000050                A842-TIPODOCU NOT = 'IN' AND                      
000051                DES0-TIPODOC1 NOT = 'F'                           
000052                MOVE '00216'     TO DES0-CODERROR                 
000053             ELSE                                                 
000054                IF A842-FLFATMER NOT EQUAL 'F' AND 'M'            
000055                   MOVE '00053'  TO DES0-CODERROR.                
000056                                                                  
000057 SRDESC0-A00-EX. EXIT.                                           
000058                                                                  
000059 SRDESC0-A10-ELABORA.                                             
000060                                                                  
000062     
      *EXEC SQL 
      *OPEN POINTDES0                                           
000063*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 55 TO SQL-STMT-ID 
           MOVE 5 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A842-CODSOCIE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A842-CODPAESE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A842-FLFATMER
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A842-TIPODOCU
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A842-TIPOMERC
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000064                                                                  
000065     PERFORM SRDESC0-B00-FETCH-DES0                               
000066        THRU SRDESC0-B00-EX.                                      
000067     IF SQLCODE = 100   AND                                       
000068       (A842-TIPOMERC = '4' OR 'T')                               
000070        
      *EXEC SQL 
      *CLOSE POINTDES0                                      
000071*        END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000072        MOVE '1'                 TO A842-TIPOMERC                 
000074        
      *EXEC SQL 
      *OPEN POINTDES0                                       
000075*        END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 56 TO SQL-STMT-ID 
           MOVE 5 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A842-CODSOCIE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A842-CODPAESE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A842-FLFATMER
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A842-TIPODOCU
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A842-TIPOMERC
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000076        PERFORM SRDESC0-B00-FETCH-DES0                            
000077           THRU SRDESC0-B00-EX.                                   
000078                                                                  
000079     IF SQLCODE = 100        AND                                  
000080        A842-TIPODOCU = 'FD' AND                                  
000081        A842-FLFATMER = 'F'                                       
000083        
      *EXEC SQL 
      *CLOSE POINTDES0                                      
000084*        END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000085        MOVE '***'               TO A842-CODPAESE                 
000087        
      *EXEC SQL 
      *OPEN POINTDES0                                       
000088*        END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 57 TO SQL-STMT-ID 
           MOVE 5 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A842-CODSOCIE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A842-CODPAESE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A842-FLFATMER
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A842-TIPODOCU
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A842-TIPOMERC
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000089        PERFORM SRDESC0-B00-FETCH-DES0                            
000090           THRU SRDESC0-B00-EX.                                   
000091                                                                  
000092     PERFORM SRDESC0-A20-MUOVI                                    
000093        THRU SRDESC0-A20-EX                                       
000094          VARYING DES0-INDICE FROM 1 BY 1                         
000095            UNTIL SQLCODE = 100  OR                               
000096                  DES0-INDICE GREATER DES0-MAX-IND.               
000097     IF SQLCODE NOT = 100                                         
000098        MOVE  '00170'            TO DES0-CODERROR.                
000099                                                                  
000101     
      *EXEC SQL 
      *CLOSE POINTDES0                                          
000102*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000103                                                                  
000104 SRDESC0-A10-EX. EXIT.                                           
000105                                                                  
000106 SRDESC0-A20-MUOVI.                                               
000107                                                                  
000108     MOVE  A842-RIGADOCU         TO DES0-RIGADOCU(DES0-INDICE).   
000109     PERFORM SRDESC0-B00-FETCH-DES0                               
000110        THRU SRDESC0-B00-EX.                                      
000111                                                                  
000112 SRDESC0-A20-EX. EXIT.                                            
000113                                                                  
000114 SRDESC0-B00-FETCH-DES0.                                          
000115                                                                  
000116     MOVE 'B00-'                 TO WCOM-CODABEND.                
000117     MOVE 'FETCH'                TO WCOM-FILEFUNZ.                
000118     MOVE 'FDANA842'             TO WCOM-FILENOME.                
000119     STRING  A842-CODSOCIE ' '  A842-CODPAESE ' '                 
000120             A842-TIPODOCU ' '  A842-TIPOMERC ' '                 
000121             A842-FLFATMER                                        
000122             DELIMITED BY SIZE INTO WCOM-FILECTRL.                
000123                                                                  
000125     
      *EXEC SQL 
      *FETCH POINTDES0                                          
000126*         INTO :A842-NUMPROG5,                                     
000127*              :A842-RIGADOCU                                      
000128*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 58 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A842-NUMPROG5
            BY VALUE 0
                     0

           MOVE 80 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A842-RIGADOCU
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000129                                                                  
000130 SRDESC0-B00-EX. EXIT.                                           
000131                                                                  
000132*-------------------------------------------------------------*   
      *<<((file: SRDESC0))
