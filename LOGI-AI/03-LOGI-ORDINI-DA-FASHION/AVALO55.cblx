      *((program: AVALO55.cblx))
000001*-------------* PROGRAMMA BATCH COBOL2 DB2 *---------------------*
000002 ID DIVISION.                                                     
000003*-------------*                                                   
000004 PROGRAM-ID. AVALO55.                         
000005                                                                  
000006*----------------------------------------------------------------*
000007* IL PROGRAMMA PREVEDE 3 TIPI DI ELABORAZIONE IN BASE ALLA SCHE- *
000008* DA PARAMETRO.                                                  *
000009* SE SCHEDA='INV ANAG'                                           *
000010* - CREAZIONE SEQUENZIALI A PARTIRE DALLE TABELLA LEGATE ALLA    *
000011*   LOGISTICA PER PASSAGGIO DATI A FASHION/TESI (ANAG/LISTINI)   *
000012* SE SCHEDA='INV ORDI'                                           *
000013* - CREAZIONE SEQUENZIALI A PARTIRE DALLE TABELLA LEGATE ALLA    *
000014*   LOGISTICA PER PASSAGGIO DATI A FASHION (ORDINI)              *
000015* SE SCHEDA='RIC'                                                *
000016* - RICEZIONE ORDINI CREATI IN FASHION PER INSERIMENTO SU NS     *
000017*   TABELLE                                                      *
000018*----------------------------------------------------------------*
000019 ENVIRONMENT DIVISION.                                            
000020*---------------------*                                           
000021 CONFIGURATION SECTION.                                           
000022 SPECIAL-NAMES.                                                   
000023     DECIMAL-POINT IS COMMA.                                      
000024                                                                  
000025 INPUT-OUTPUT SECTION.                                            
000026 FILE-CONTROL.                                                    
000027     SELECT  SERVIZI  ASSIGN UT-S-SERVIZI.                        
000028     SELECT  LISTINI  ASSIGN UT-S-LISTINI.                        
000029     SELECT  ORDINI   ASSIGN UT-S-ORDINI.                         
000030     SELECT  ORDINIVB ASSIGN UT-S-ORDINIVB.                       
000031     SELECT  ORDIRECU ASSIGN UT-S-ORDIRECU.                       
000032     SELECT  ORDIARCH ASSIGN UT-S-ORDIARCH.                       
000033                                                                  
000034 DATA DIVISION.                                                   
000035*--------------*                                                  
000036 FILE SECTION.                                                    
000037 FD  SERVIZI                                                      
000038     RECORDING MODE IS F                                          
000039     BLOCK CONTAINS  0 RECORDS.                                   
000040 01  REC-SERVIZI                 PIC X(66).                       
000041 FD  LISTINI                                                      
000042     RECORDING MODE IS F                                          
000043     BLOCK CONTAINS  0 RECORDS.                                   
000044 01  REC-LISTINI                 PIC X(40).                       
000045 FD  ORDINI                                                       
000046     RECORDING MODE IS F                                          
000047     BLOCK CONTAINS  0 RECORDS.                                   
000048 01  REC-ORDINI                  PIC X(200).                      
000049 FD  ORDINIVB                                                     
000050     RECORDING MODE IS F                                          
000051     BLOCK CONTAINS  0 RECORDS.                                   
000052 01  REC-ORDINIVB                PIC X(200).                      
000053 FD  ORDIRECU                                                     
000054     RECORDING MODE IS F                                          
000055     BLOCK CONTAINS  0 RECORDS.                                   
000056 01  REC-ORDIRECU                PIC X(200).                      
000057 FD  ORDIARCH                                                     
000058     RECORDING MODE IS F                                          
000059     BLOCK CONTAINS  0 RECORDS.                                   
000060 01  REC-ORDIARCH                PIC X(200).                      
000061                                                                  
000062 WORKING-STORAGE SECTION.

       01  SQLDA-ID pic 9(4) comp-5.
       01  SQLDSIZE pic 9(4) comp-5.
       01  SQL-STMT-ID pic 9(4) comp-5.
       01  SQLVAR-INDEX pic 9(4) comp-5.
       01  SQL-DATA-TYPE pic 9(4) comp-5.
       01  SQL-HOST-VAR-LENGTH pic 9(9) comp-5.
       01  SQL-S-HOST-VAR-LENGTH pic 9(9) comp-5.
       01  SQL-S-LITERAL pic X(258).
       01  SQL-LITERAL1 pic X(130).
       01  SQL-LITERAL2 pic X(130).
       01  SQL-LITERAL3 pic X(130).
       01  SQL-LITERAL4 pic X(130).
       01  SQL-LITERAL5 pic X(130).
       01  SQL-LITERAL6 pic X(130).
       01  SQL-LITERAL7 pic X(130).
       01  SQL-LITERAL8 pic X(130).
       01  SQL-LITERAL9 pic X(130).
       01  SQL-LITERAL10 pic X(130).
       01  SQL-IS-LITERAL pic 9(4) comp-5 value 1.
       01  SQL-IS-INPUT-HVAR pic 9(4) comp-5 value 2.
       01  SQL-CALL-TYPE pic 9(4) comp-5.
       01  SQL-SECTIONUMBER pic 9(4) comp-5.
       01  SQL-INPUT-SQLDA-ID pic 9(4) comp-5.
       01  SQL-OUTPUT-SQLDA-ID pic 9(4) comp-5.
       01  SQLA-PROGRAM-ID.
           05 SQL-PART1 pic 9(4) COMP-5 value 172.
           05 SQL-PART2 pic X(6) value "AEAQAI".
           05 SQL-PART3 pic X(24) value "EALYIBGn01111 2         ".
           05 SQL-PART4 pic 9(4) COMP-5 value 8.
           05 SQL-PART5 pic X(8) value "DB2XMT  ".
           05 SQL-PART6 pic X(120) value LOW-VALUES.
           05 SQL-PART7 pic 9(4) COMP-5 value 8.
           05 SQL-PART8 pic X(8) value "AVALO55 ".
           05 SQL-PART9 pic X(120) value LOW-VALUES.
                                                                        
000063 01  FILLER                      PIC X(8)  VALUE '*DCPARM*'.      
000064*    COPY DCPARM.                                                 
      *>>((file: DCPARM))
000001***************************************************************** 
000002*******                                                         * 
000003*******       A R E A   P A R A M E T R I C A       *COBOL*     * 
000004*******                                                         * 
000005***************************************************************** 
000006 01  DCPARM.                                                      
000007*******  PPNAME   = NOME PROGRAMMA                                
000008     02  PPNAME           PIC X(8)    VALUE SPACES.               
000009*******  PPROUTIN = ROUTINE DA ESEGUIRE                           
000010     02  PPROUTIN         PIC X       VALUE SPACES.               
000011     02  PPSTAT           PIC X(4)    VALUE SPACES.               
000012*******  PPNUSK   = NUMERO DI SCHEDE X LA FUNZIONE -N-            
000013     02  PPNUSK           PIC X(2)    VALUE SPACES.               
000014     02  PPFIRST          PIC X       VALUE SPACES.               
000015*******                                                           
000016*********************** SKEDE PARAMETRO - MAX 10 **************** 
000017*******                                                           
000018     02  SK-PARM.                                                 
000019         05  PPSK1            PIC X(80)   VALUE SPACES.           
000020         05  PPSK2            PIC X(80)   VALUE SPACES.           
000021         05  PPSK3            PIC X(80)   VALUE SPACES.           
000022         05  PPSK4            PIC X(80)   VALUE SPACES.           
000023         05  PPSK5            PIC X(80)   VALUE SPACES.           
000024         05  PPSK6            PIC X(80)   VALUE SPACES.           
000025         05  PPSK7            PIC X(80)   VALUE SPACES.           
000026         05  PPSK8            PIC X(80)   VALUE SPACES.           
000027         05  PPSK9            PIC X(80)   VALUE SPACES.           
000028         05  PPSK10           PIC X(80)   VALUE SPACES.           
000029         05  PPSK11           PIC X(80)   VALUE SPACES.           
000030     02  TAB-SK-PARM REDEFINES SK-PARM.                           
000031         05  EL-SK-PARM OCCURS 11 TIMES.                          
000032             10  NAME-SK-PARM     PIC XX.                         
000033             10  FILLER           PIC X.                          
000034             10  DATA-SK-PARM     PIC X(77).                      
000035*******                                                           
000036*********************** ELEMENTO DI RICERCA ********************* 
000037*******                                                           
000038*******  PPNMFILE  = NOME FILE                                    
000039     02  PPNMFILE         PIC X(7)    VALUE SPACES.               
000040*******  PPTPFILE  = TIPO FILE                                    
000041     02  PPTPFILE         PIC X(1)    VALUE SPACES.               
000042*******  PPTPOPER  = TIPO OPERAZIONE                              
000043     02  PPTPOPER         PIC X(1)    VALUE SPACES.               
000044     02  FILLER           PIC X(7)    VALUE SPACES.               
000045*******                                                           
000046*********************** TABELLA DI 30 ELEMENTI ****************** 
000047*******                                                           
000048     02  TAB-CONTATORI.                                           
000049         05  EL-CONTATORI OCCURS 30 TIMES.                        
000050             10  EL-PPNMFILE      PIC X(7)        VALUE SPACES.   
000051             10  EL-PPTPFILE      PIC X           VALUE SPACES.   
000052             10  EL-PPTPOPER      PIC X           VALUE SPACES.   
000053             10  EL-CONTATOR      PIC 9(9) COMP-3 VALUE ZEROES.   
000054             10  EL-FILLER        PIC XX          VALUE SPACES.   
000055*    02  FILLER           PIC X(7)     VALUE SPACES.              
000056*******              TIPO FILE                                    
000057*    02  FILLER           PIC X(1)     VALUE SPACES.              
000058*******              TIPO OPERAZIONE                              
000059*    02  FILLER           PIC X(1)     VALUE SPACES.              
000060*******              NUMERO OPERAZIONI                            
000061*    02  FILLER           PIC 9(9)     COMP-3    VALUE ZERO.      
000062*    02  FILLER           PIC X(2)     VALUE SPACES.              
000063*******  29 CAMPI DA 16 BYTES, IN TOTALE 464 BYTES                
000064*    02  FILLER           PIC X(464)   VALUE SPACES.              
000065*******                                                           
000066*********************** STAMPA MESSAGGI ************************* 
000067*******                                                           
000068*******  PPMESSAG  = MESSAGGIO DA STAMPARE                        
000069     02  PPMESSAG         PIC X(132)  VALUE SPACES.               
000070     02  FILLER           PIC X(4)    VALUE SPACES.               
000071*******                                                           
000072*********************** DATE DA TABE TABPRODA ******************* 
000073*******                                                           
000074*******  DATA-PROG = NOME ELEMENTO DI TABE TABPRODA               
000075     02  DATA-PROG        PIC X(7)    VALUE SPACES.               
000076*******  DATA-TIPO = TIPO DI DATA  DI TABE TABPRODA               
000077     02  DATA-TIPO        PIC X       VALUE SPACES.               
000078*******  DATA-INIZ = DATA INIZIO PERIODO                          
000079     02  DATA-INIZ.                                               
000080         05  GG-INIZ.                                             
000081             10  SS-CORSO PIC XX      VALUE SPACES.               
000082         05  MM-INIZ      PIC XX      VALUE SPACES.               
000083         05  AA-INIZ      PIC XX      VALUE SPACES.               
000084*******  DATA-FINE = DATA FINE PERIODO                            
000085     02  DATA-FINE.                                               
000086         05  GG-FINE      PIC XX      VALUE SPACES.               
000087         05  MM-FINE      PIC XX      VALUE SPACES.               
000088         05  AA-FINE      PIC XX      VALUE SPACES.               
000089     02  FILLER           PIC X(4)    VALUE SPACES.               
000090*******                                                           
000091*********************** CALL GENERALIZZATA ********************** 
000092*******                                                           
000093*******  PPCALL    = NOME MODULO X CALLER                         
000094     02  PPCALL           PIC X(8)    VALUE SPACES.               
000095*******                                                           
000096***************************************************************** 
000097*  EJECT                                                          
      *<<((file: DCPARM))
000065 01  FILLER                      PIC X(8)  VALUE 'DCDB2ER*'.      
000066*    COPY DCDB2ER.                                                
      *>>((file: DCDB2ER))
000001******************************************************************
000002*****               AREA PER MODULO SCDB2ER                  *****
000003******************************************************************
000004 01  DCDB2ER.                                                     
000005     02 WCOM-LUNGHEZZ         PIC S9(3) COMP-3 VALUE +171.        
000006     02 WCOM-FILEFUNZ         PIC X(10).                          
000007     02 WCOM-FILENOME         PIC X(30).                          
000008     02 WCOM-FILECTRL         PIC X(30).                          
000009     02 WCOM-MESSAGES         PIC X(80).                          
000010     02 WCOM-CODABEND         PIC X(4).                           
000011     02 MESS-CODERROR         PIC X(6).                           
000012     02 WSWERROR              PIC X.                              
000013        88 ERRORE             VALUE '*'.                          
000014     02 WCOM-PROGNAME         PIC X(8).                           
      *<<((file: DCDB2ER))
000067 01  FILLER                      PIC X(8)  VALUE 'DCWDTEL*'.      
000068*    COPY DCWDTEL.                                                
      *>>((file: DCWDTEL))
000001***************************************************************** 
000002******         AREA PASSAGGIO CHIAMATA                     ****** 
000003******             MODULO  SCTDTEL (LENGTH 100)            ****** 
000004***************************************************************** 
000005 01  DCWDTEL.                                                     
000006*                         ZEROES SE OK  ALTRIMENTI SQLCODE        
000007     05 DTEL-RETCOD              PIC S9(3).                       
000008*                         R = LETTURA   U = AGGIORNAMENTO         
000009     05 DTEL-TIPORICH            PIC X.                           
000010     05 DTEL-SIGLDATA            PIC X(8).                        
000011*         G=AAAAAAA   S=SETTIMA   M=MENSILE   A=ANNUALE   W=WEEK  
000012     05 DTEL-DATATIPO            PIC X(1).                        
000013*                                                                 
000014     05 DTEL-DTINELAB            PIC X(8).                        
000015     05 DTEL-TMINELAB            PIC X(6).                        
000016     05 DTEL-DTFIELAB            PIC X(8).                        
000017     05 DTEL-TMFIELAB            PIC X(6).                        
000018     05 FILLER                   PIC X(59).                       
      *<<((file: DCWDTEL))
000069 01  FILLER                      PIC X(8)  VALUE 'FSNET17*'.      
000070*    COPY FSNET17.                                                
      *>>((file: FSNET17))
000001******************************************************************
000002** -LOGISTAICA                                                  **
000003** -TRASMISSIONE ANAGRAFICA SERVIZI TEXTILE-- >FASHION          **
000004**  LUNGHEZZA    --> 66                                         **
000005******************************************************************
000006 01  FSNET17.                                                     
000007     05 N17-CODSERVI              PIC X(06).                      
000008     05 N17-DESSERVI              PIC X(40).                      
000009     05 N17-UNMISURA              PIC X(02).                      
000010     05 N17-TIPSERVI              PIC X(01).                      
000011     05 N17-CONTODCD              PIC X(06).                      
000012     05 N17-CONTODCA              PIC X(06).                      
000013     05 N17-CENCOSTA              PIC X(05).                      
      *<<((file: FSNET17))
000071 01  FILLER                      PIC X(8)  VALUE 'FSNET16*'.      
000072*    COPY FSNET16.                                                
      *>>((file: FSNET16))
000001******************************************************************
000002** -LOGISTICA                                                   **
000003** -TRASMISSIONE LISTINI            TEXTILE-- >FASHION          **
000004**  LUNGHEZZA    --> 40                                         **
000005******************************************************************
000006 01  FSNET16.                                                     
000007     05 N16-CODCLIEN              PIC X(05).                      
000008     05 N16-DTINILIS              PIC X(06).                      
000009     05 N16-DTFINLIS              PIC X(06).                      
000010     05 N16-CODSERVI              PIC X(06).                      
000011     05 N16-SIGLADIV              PIC X(03).                      
000012     05 N16-TIPSERVI              PIC X(01).                      
000013     05 N16-PREZZLIS              PIC 9(5)V9(4).                  
000014     05 N16-PERCLIST              PIC 9(3)V9(1).                  
      *<<((file: FSNET16))
000073 01  FILLER                      PIC X(8)  VALUE 'FSNET15*'.      
000074*    COPY FSNET15.                                                
      *>>((file: FSNET15))
000001******************************************************************
000002** -LOGISTICA                                                   **
000003** -TRASMISSIONE ORDINI             TEXTILE-- >FASHION (146)    **
000004**                                  FASHION-- >TEXTILE (146)    **
000005** -LUNGHEZZA TOTALE (200). IN CODA SONO AGGIUNTI DATA/ORA ELAB **
000006******************************************************************
000007 01  FSNET15.                                                     
000008     05 N15-CODSOCIE              PIC X(02).                      
000009     05 N15-DTCARORD              PIC X(08).                      
000010     05 N15-AANUMORD              PIC X(08).                      
000011     05 N15-SIGLADIV              PIC X(03).                      
000012     05 N15-TIPSERVI              PIC X(01).                      
000013     05 N15-CODCLIEN              PIC X(05).                      
000014     05 N15-CODSERVI              PIC X(06).                      
000015     05 N15-NOTENOTE              PIC X(60).                      
000016     05 N15-QTAORDIN              PIC 9(7)V9(2).                  
000017     05 N15-PREZZORD              PIC 9(5)V9(4).                  
000018     05 N15-IMPORDIN              PIC 9(9)V9(2).                  
000019     05 N15-CENCOSTD              PIC X(05).                      
000020     05 N15-CENCOSTA              PIC X(05).                      
000021     05 N15-CONTODCE              PIC X(06).                      
000022     05 N15-FLAGGIVA              PIC X(01).                      
000023     05 N15-AAMMCOMP              PIC X(06).                      
000024     05 N15-OPERAZIO              PIC X(01).                      
000025     05 N15-CODUTEVB              PIC X(05).                      
000026     05 N15-ESENTIVA              PIC X(01).                      
000027     05 N15-FILLER                PIC X(34).                      
000028     05 N15-DATAELAB              PIC X(08).                      
000029     05 N15-TEMPELAB              PIC X(06).                      
      *<<((file: FSNET15))
000075 01  FILLER                      PIC X(8)  VALUE 'DCNUME**'.      
000076*    COPY DCNUME.                                                 
      *>>((file: DCNUME))
000001******************************************************************
000002*                       ***  DCNUME  ***                         *
000003*   PARAMETRI PER LA LETTURA E L'AGGIORNAMENTO DELLA TABELLA     *
000004*   DB2   'TNUMEAUTO'.                                           *
000005*   LUNGHEZZA = 100                                              *
000006******************************************************************
000007*                                                                *
000008 01  DCNUME.                                                      
000009     05  DCNU-RISPOSTA                    PIC X(04).              
000010     05  DCNU-FLAGOPER                    PIC X(01).              
000011*                                                                *
000012     05  DCNU-SIGLNUME                    PIC X(08).              
000013     05  DCNU-NUMEAUTO                    PIC X(09).              
000014     05  DCNU-NUMERIPR                    PIC X(09).              
000015     05  DCNU-DESCNUME                    PIC X(21).              
000016     05  DCNU-NUMERIP1                    PIC X(09).              
000017     05  DCNU-FILLER39                    PIC X(39).              
000018                                                                  
000019******************************************************************
000020                                                                  
      *<<((file: DCNUME))
000077                                                                  
000078 01  FILLER                      PIC X(8)  VALUE '*COMODI*'.      
000079 01  COMODI.                                                      
000080     05 WS-NUMEAUTO.                                              
000081        10 FILLER                PIC X.                           
000082        10 WS-NUMORDIN           PIC 9(08).                       
000083     05 SALVA-FSNET15            PIC X(500).                      
000084     05 WS-NRRIGORD              PIC S9(5) COMP-3.                
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000085     05 WS-ANNOMESE              PIC X(06).                       
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000086     05 WS-MENSILE               PIC X(06).                       
000087     05 WS-ESISTE                PIC X(01).                       
000088     05 EOF                      PIC X(01).                       
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000089     05 WS-ORDINE                PIC X(08).                       
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000090     05 WS-AANUMORD              PIC X(08).                       
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000091     05 WS-AANUMOR1              PIC X(08).                       
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000092     05 WS-TIPSERVI              PIC X(01).                       
000093     05 COMO-TIPSERVI            PIC X(01).                       
000094     05 WS-CODUTEVB              PIC X(06).                       
000095     05 WS-FLAGGIVA              PIC X(01).                       
000096     05 WS-ESENTIVA              PIC X(01).                       
000097     05 WS-CODCLIEN              PIC X(05).                       
000098     05 WS-CODSOCIE              PIC X(02).                       
000099     05 WS-CONTODCE              PIC X(06).                       
000100     05 WS-DTCARORD              PIC X(08).                       
000101     05 WS-AAMMCOMP              PIC X(06).                       
000102     05 WS-SIGLADIV              PIC X(03).                       
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000103     05 WS-TEMPELAB              PIC X(06).                       
000104     05 WS-DTGIORNO              PIC X(08).                       
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000105     05 WS-MESSAGGI.                                              
000106        10 FILLER                PIC X(08) VALUE '*RENATO:'.      
000107        10 FILLER                PIC X(07) VALUE 'ORDINE:'.       
000108        10 M1-AANUMORD           PIC X(08) VALUE SPACES.          
000109        10 FILLER                PIC X(06) VALUE ' SERV:'.        
000110        10 M1-CODSERVI           PIC X(06) VALUE SPACES.          
000111        10 FILLER                PIC X(01) VALUE ' '.             
000112        10 M1-MESSAGGI           PIC X(59) VALUE SPACES.          
000113     05 WS-SKPARAME.                                              
000114        10 SK-TIPOELAB           PIC X(03).                       
000115        10 FILLER                PIC X(01).                       
000116        10 SK-TIPODATI           PIC X(04).                       
000117        10 FILLER                PIC X(01).                       
000118        10 SK-RECUPERO           PIC X(03).                       
000119                                                                  
000120 01  TABELLA1.                                                    
000121     05 T1-ELEMENTO.                                              
000122        10 T1-ELEM-OLD           PIC X(200).                      
000123        10 T1-ELEM-NEW           PIC X(200).                      
000124                                                                  
000125 01  IND2                        PIC S9(5) COMP-3.                
000126 01  MAX-IND2                    PIC S9(5) COMP-3 VALUE 1000.     
000127 01  TABELLA2.                                                    
000128     05 T2-ELEMENTO                        OCCURS 1000.           
000129        10 T2-AANUMORD           PIC X(08).                       
000130        10 T2-ESISTEXX           PIC X(01).                       
000131                                                                  
000132*------------------------------- DANAGRAF.TSOCIETA                
000133 01  FILLER                      PIC X(8) VALUE 'FDANA531'.       
000134*    EXEC SQL INCLUDE FDANA531 END-EXEC.                          
      *>>((file: FDANA531))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TSOCIETA                  *
000003******************************************************************
000004 01  DCLTSOCIETA.                                                 
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 A531-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000006     10 A531-NOMSOCIE        PIC X(23).                           
000007     10 A531-CODFORNI        PIC X(5).                            
000008     10 A531-TASSINTE        PIC S9(3)V9(2) USAGE COMP-3.         
000009     10 A531-CODPAESE        PIC X(3).                            
000010     10 A531-NRGGRISC        PIC S9(3)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000011     10 A531-CODPIANO        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000012     10 A531-CITTASOC        PIC X(18).                           
000013     10 A531-FLPAGIVA        PIC X(1).                            
000014     10 A531-FLFATACQ        PIC X(1).                            
000015     10 A531-CODAZIEN        PIC X(5).                            
000016     10 A531-FLIVATRA        PIC X(1).                            
000017     10 A531-CODDIVIS        PIC X(2).                            
000018     10 A531-COSTINTE        PIC S9(3)V9(2) USAGE COMP-3.         
000019     10 A531-FLCONTAB        PIC X(1).                            
000020     10 A531-FLAGMAGA        PIC X(1).                            
000021     10 A531-RAGSOCIE        PIC X(50).                           
000022     10 A531-SOCIECON        PIC X(2).                            
000023     10 A531-DTCREAZI        PIC X(8).                            
000024     10 A531-DTULTVAR        PIC X(8).                            
000025     10 A531-CODUTVAR        PIC X(6).                            
000026     10 A531-INDLEGAL        PIC X(35).                           
000027     10 A531-CAPLEGAL        PIC X(5).                            
000028     10 A531-CITLEGAL        PIC X(18).                           
000029     10 A531-CODFISCA        PIC X(16).                           
000030     10 A531-CODDIVRI        PIC X(2).                            
000031     10 A531-SOCIEGTM        PIC X(2).                            
000032     10 A531-GENEFATT        PIC X(1).                            
000033     10 A531-FLAGATTI        PIC X(1).                            
000034     10 A531-DIVISOLD        PIC X(2).                            
000035     10 A531-DTFINOLD        PIC X(8).                            
000036     10 A531-DIVRIOLD        PIC X(2).                            
000037     10 A531-DIVIRIFA        PIC X(2).                            
000038     10 A531-FLEURUSA        PIC X(1).                            
000039     10 A531-FLAGLIMI        PIC X(1).                            
000040     10 A531-FLFILIAL        PIC X(1).                            
000041     10 A531-FLPRESEN        PIC X(1).                            
000042     10 A531-CODSOCPA        PIC X(1).                            
000043     10 A531-FLBOLGVB        PIC X(1).                            
000044     10 A531-FLSTCART        PIC X(1).                            
000045     10 A531-FLDIPEST        PIC X(1).                            
000046     10 A531-CODFIRMA        PIC X(8).                            
000047     10 A531-DESFIRMA        PIC X(24).                           
000048     10 A531-CDSOCJDE        PIC X(5).                            
000049     10 A531-CODFORNV        PIC X(5).                            
000050     10 A531-CODFORNA        PIC X(5).                            
000051     10 A531-IMPCCASO        PIC S9(13) COMP-3.                   
000052     10 A531-TRIBCCIA        PIC X(10).                           
000053     10 A531-PROLEGAL        PIC X(2).                            
000054     10 A531-FLSOCSAP        PIC X(1).                            
000055     10 A531-DIVIXLAV        PIC X(2).                            
000056******************************************************************
000057* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 51      *
000058******************************************************************
      *<<((file: FDANA531))
000135*------------------------------- DANAGRAF.TCLIENTI                
000136 01  FILLER                      PIC X(8) VALUE 'FDANA901'.       
000137*    EXEC SQL INCLUDE FDANA901 END-EXEC.                          
      *>>((file: FDANA901))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TCLIENTI                  *
000003******************************************************************
000004 01  DCLTCLIENTI.                                                 
000005*                       CODCLIEN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006     10 A901-CODCLIEN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007*                       STATCLIE                                  
000008     10 A901-STATCLIE        PIC X(1).                            
000009*                       GENECLIE                                  
000010     10 A901-GENECLIE        PIC X(1).                            
000011*                       TIPOCLIE                                  
000012     10 A901-TIPOCLIE        PIC X(1).                            
000013*                       TIPOCONS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000014     10 A901-TIPOCONS        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000015*                       CLIFOCON                                  
000016     10 A901-CLIFOCON        PIC X(5).                            
000017*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000018     10 A901-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000019*                       CAPOCONT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000020     10 A901-CAPOCONT        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000021*                       CODFISCA                                  
000022     10 A901-CODFISCA        PIC X(16).                           
000023*                       ESENTIVA                                  
000024     10 A901-ESENTIVA        PIC X(1).                            
000025*                       NUMESIVA                                  
000026     10 A901-NUMESIVA        PIC X(5).                            
000027*                       DATESIVA                                  
000028     10 A901-DATESIVA        PIC X(8).                            
000029*                       UFFICIVA                                  
000030     10 A901-UFFICIVA        PIC X(18).                           
000031*                       IMPESIVA                                  
000032     10 A901-IMPESIVA        PIC S9(4)V USAGE COMP-3.             
000033*                       BANCAPPO                                  
000034     10 A901-BANCAPPO        PIC X(3).                            
000035*                       NOMBANCL                                  
000036     10 A901-NOMBANCL        PIC X(114).                          
000037*                       CONTOCOR                                  
000038     10 A901-CONTOCOR        PIC X(13).                           
000039*                       ASSOBANC                                  
000040     10 A901-ASSOBANC        PIC X(5).                            
000041*                       AVVIBANC                                  
000042     10 A901-AVVIBANC        PIC X(5).                            
000043*                       CLIEFATT                                  
000044     10 A901-CLIEFATT        PIC X(5).                            
000045*                       PAESFATT                                  
000046     10 A901-PAESFATT        PIC X(3).                            
000047*                       RAGFATTU                                  
000048     10 A901-RAGFATTU        PIC X(24).                           
000049*                       ESRAGFAT                                  
000050     10 A901-ESRAGFAT        PIC X(24).                           
000051*                       INDFATTU                                  
000052     10 A901-INDFATTU        PIC X(24).                           
000053*                       ESINDFAT                                  
000054     10 A901-ESINDFAT        PIC X(24).                           
000055*                       CITFATTU                                  
000056     10 A901-CITFATTU        PIC X(18).                           
000057*                       ESCITFAT                                  
000058     10 A901-ESCITFAT        PIC X(18).                           
000059*                       CAPFATTU                                  
000060     10 A901-CAPFATTU        PIC X(5).                            
000061*                       PAESMERC                                  
000062     10 A901-PAESMERC        PIC X(3).                            
000063*                       RAGMERCE                                  
000064     10 A901-RAGMERCE        PIC X(24).                           
000065*                       ESRAGMER                                  
000066     10 A901-ESRAGMER        PIC X(24).                           
000067*                       INDMERCE                                  
000068     10 A901-INDMERCE        PIC X(24).                           
000069*                       ESINDMER                                  
000070     10 A901-ESINDMER        PIC X(24).                           
000071*                       CITMERCE                                  
000072     10 A901-CITMERCE        PIC X(18).                           
000073*                       ESCITMER                                  
000074     10 A901-ESCITMER        PIC X(18).                           
000075*                       CAPMERCE                                  
000076     10 A901-CAPMERCE        PIC X(5).                            
000077*                       ZONAMERC                                  
000078     10 A901-ZONAMERC        PIC X(2).                            
000079*                       TELCLIEN                                  
000080     10 A901-TELCLIEN        PIC X(20).                           
000081*                       TLXCLIEN                                  
000082     10 A901-TLXCLIEN        PIC X(20).                           
000083*                       FAXCLIEN                                  
000084     10 A901-FAXCLIEN        PIC X(20).                           
000085*                       RIFEMIRO                                  
000086     10 A901-RIFEMIRO        PIC X(11).                           
000087*                       PAESORDI                                  
000088     10 A901-PAESORDI        PIC X(3).                            
000089*                       ZONAORDI                                  
000090     10 A901-ZONAORDI        PIC X(2).                            
000091*                       DATVASTA                                  
000092     10 A901-DATVASTA        PIC X(8).                            
000093*                       ATTENZDI                                  
000094     10 A901-ATTENZDI        PIC X(24).                           
000095*                       CONDPAGA                                  
000096     10 A901-CONDPAGA        PIC X(3).                            
000097*                       MMESCLU1                                  
000098     10 A901-MMESCLU1        PIC S9(2)V USAGE COMP-3.             
000099*                       MMESCLU2                                  
000100     10 A901-MMESCLU2        PIC S9(2)V USAGE COMP-3.             
000101*                       GGSCATRA                                  
000102     10 A901-GGSCATRA        PIC S9(2)V USAGE COMP-3.             
000103*                       NUMGGVIA                                  
000104     10 A901-NUMGGVIA        PIC S9(2)V USAGE COMP-3.             
000105*                       TIPOTRAT                                  
000106     10 A901-TIPOTRAT        PIC X(1).                            
000107*                       ALTERSPE                                  
000108     10 A901-ALTERSPE        PIC X(1).                            
000109*                       CODILING                                  
000110     10 A901-CODILING        PIC X(1).                            
000111*                       DTULTVAR                                  
000112     10 A901-DTULTVAR        PIC X(8).                            
000113*                       TIPCLCAR                                  
000114     10 A901-TIPCLCAR        PIC X(1).                            
000115*                       SPETRASP                                  
000116     10 A901-SPETRASP        PIC X(1).                            
000117*                       DTCREAZI                                  
000118     10 A901-DTCREAZI        PIC X(8).                            
000119*                       CODDIVIS                                  
000120     10 A901-CODDIVIS        PIC X(2).                            
000121*                       CDIVACEE                                  
000122     10 A901-CDIVACEE        PIC X(14).                           
000123*                       ZONAFATT                                  
000124     10 A901-ZONAFATT        PIC X(2).                            
000125*                       CLASDOGA                                  
000126     10 A901-CLASDOGA        PIC X(1).                            
000127*                       INTNCLIE                                  
000128     10 A901-INTNCLIE        PIC X(50).                           
000129*                       CAPOCOMM                                  
000130     10 A901-CAPOCOMM        PIC X(5).                            
000131*                       PRIORITA                                  
000132     10 A901-PRIORITA        PIC X(1).                            
000133*                       BULSTATX                                  
000134     10 A901-BULSTATX        PIC X(13).                           
000135*                       CODUTVAR                                  
000136     10 A901-CODUTVAR        PIC X(6).                            
000137*                       CODUTCRE                                  
000138     10 A901-CODUTCRE        PIC X(6).                            
000139*                       CDRESCON                                  
000140     10 A901-CDRESCON        PIC X(2).                            
000141*                       CENCOACQ                                  
000142     10 A901-CENCOACQ        PIC X(5).                            
000143*                       CAPOSOCI                                  
000144     10 A901-CAPOSOCI        PIC X(5).                            
000145*                       CDFISCAL                                  
000146     10 A901-CDFISCAL        PIC X(16).                           
000147*                       CONDPACA                                  
000148     10 A901-CONDPACA        PIC X(3).                            
000149*                       CODXIBAN                                  
000150     10 A901-CODXIBAN        PIC X(4).                            
000151*                       CODXXCIN                                  
000152     10 A901-CODXXCIN        PIC X(2).                            
000153*                       ZIPFATTU                                  
000154     10 A901-ZIPFATTU        PIC X(15).                           
000155*                       ZIPMERCE                                  
000156     10 A901-ZIPMERCE        PIC X(15).                           
000157*                       TIPOLIST                                  
000158     10 A901-TIPOLIST        PIC X(1).                            
000159*                       SWIFTCOD                                  
000160     10 A901-SWIFTCOD        PIC X(11).                           
000161*                       PERCEIVA                                  
000162     10 A901-PERCEIVA        PIC S9(3)V9(2) USAGE COMP-3.         
000163*                       DTVALIVA                                  
000164     10 A901-DTVALIVA        PIC X(8).                            
000165*                       CLASSCLI                                  
000166     10 A901-CLASSCLI        PIC X(1).                            
000167*                       RATINGCO                                  
000168     10 A901-RATINGCO        PIC X(3).                            
000169*                       RISCHCLI                                  
000170     10 A901-RISCHCLI        PIC X(1).                            
000171*                                                                 
000172     10 A901-NRPROIVA        PIC X(30).                           
000173*                                                                 
000174     10 A901-IMPESNEW        PIC S9(9)V9(2) USAGE COMP-3.         
000175     10 A901-TIPOSTAG        PIC X(1).                            
000176     10 A901-FLFATELE        PIC X(1).                            
000177     10 A901-CDDESTFE        PIC X(7).                            
000178     10 A901-INPECCLI        PIC X(50).                           
000179******************************************************************
000180* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 88      *
000181******************************************************************
      *<<((file: FDANA901))
000138*------------------------------- DANAGRAF.TDIVISE                 
000139 01  FILLER                      PIC X(8) VALUE 'FDANA963'.       
000140*    EXEC SQL INCLUDE FDANA963 END-EXEC.                          
      *>>((file: FDANA963))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TDIVISE                   *
000003******************************************************************
000004 01  DCLTDIVISE.                                                  
000005*                       SIGLADIV                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006     10 A963-SIGLADIV        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007*                       CAMBIODV                                  
000008     10 A963-CAMBIODV        PIC S9(5)V9(6) USAGE COMP-3.         
000009*                       DESCDIVI                                  
000010     10 A963-DESCDIVI        PIC X(20).                           
000011*                       CODDIVIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000012     10 A963-CODDIVIS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000013*                       DECIDIVI                                  
000014     10 A963-DECIDIVI        PIC X(1).                            
000015*                       DIVIBANC                                  
000016     10 A963-DIVIBANC        PIC X(3).                            
000017*                       DIVIPREZ                                  
000018     10 A963-DIVIPREZ        PIC X(1).                            
000019*                       CODDIVRI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000020     10 A963-CODDIVRI        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000021*                       RAPPCAMB                                  
000022     10 A963-RAPPCAMB        PIC S9(5)V USAGE COMP-3.             
000023*                       CODDIGTM                                  
000024     10 A963-CODDIGTM        PIC X(2).                            
000025*                       FLAGEURO                                  
000026     10 A963-FLAGEURO        PIC X(1).                            
000027*                       SLDIVBAN                                  
000028     10 A963-SLDIVBAN        PIC X(3).                            
000029*                       CDDIVSCA                                  
000030     10 A963-CDDIVSCA        PIC X(2).                            
000031*                       FLDIVINT                                  
000032     10 A963-FLDIVINT        PIC X(1).                            
000033     10 A963-VBDIVSCA        PIC X(2).                            
000034******************************************************************
000035* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 15      *
000036******************************************************************
      *<<((file: FDANA963))
000141*------------------------------- DANAGRAF.TDATARIO                
000142 01  FILLER                      PIC X(8) VALUE 'FDANA973'.       
000143*    EXEC SQL INCLUDE FDANA973 END-EXEC.                          
      *>>((file: FDANA973))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TDATARIO)                                *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA973))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(A973-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DANAGRAF.TDATARIO TABLE                     
000012*     ( DTGIORNO                       CHAR(8) NOT NULL,           
000013*       PRGIORNO                       DECIMAL(7, 0) NOT NULL,     
000014*       NUMGIORN                       CHAR(3) NOT NULL,           
000015*       NUMSETTI                       CHAR(2) NOT NULL,           
000016*       NRGGSETT                       CHAR(1) NOT NULL,           
000017*       DTINISET                       CHAR(8) NOT NULL,           
000018*       DTFINSET                       CHAR(8) NOT NULL,           
000019*       DTINIMES                       CHAR(8) NOT NULL,           
000020*       DTFINMES                       CHAR(8) NOT NULL,           
000021*       ANNOSETT                       CHAR(6) NOT NULL,           
000022*       FLAGFEST                       CHAR(1) NOT NULL            
000023*     ) END-EXEC
                                                                        
000024******************************************************************
000025* COBOL DECLARATION FOR TABLE DANAGRAF.TDATARIO                  *
000026******************************************************************
000027 01  DCLTDATARIO.                                                 
000028*                       DTGIORNO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000029     10 A973-DTGIORNO        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000030*                       PRGIORNO                                  
000031     10 A973-PRGIORNO        PIC S9(7)V USAGE COMP-3.             
000032*                       NUMGIORN                                  
000033     10 A973-NUMGIORN        PIC X(3).                            
000034*                       NUMSETTI                                  
000035     10 A973-NUMSETTI        PIC X(2).                            
000036*                       NRGGSETT                                  
000037     10 A973-NRGGSETT        PIC X(1).                            
000038*                       DTINISET                                  
000039     10 A973-DTINISET        PIC X(8).                            
000040*                       DTFINSET                                  
000041     10 A973-DTFINSET        PIC X(8).                            
000042*                       DTINIMES                                  
000043     10 A973-DTINIMES        PIC X(8).                            
000044*                       DTFINMES                                  
000045     10 A973-DTFINMES        PIC X(8).                            
000046*                       ANNOSETT                                  
000047     10 A973-ANNOSETT        PIC X(6).                            
000048*                       FLAGFEST                                  
000049     10 A973-FLAGFEST        PIC X(1).                            
000050******************************************************************
000051* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 11      *
000052******************************************************************
      *<<((file: FDANA973))
000144*------------------------------- DANAGRAF.TCENCOSTO               
000145 01  FILLER                      PIC X(8) VALUE 'FDANA982'.       
000146*    EXEC SQL INCLUDE FDANA982 END-EXEC.                          
      *>>((file: FDANA982))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TCENCOSTO)                               *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA982))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(A982-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DANAGRAF.TCENCOSTO TABLE                    
000012*     ( CODSOCIE                       CHAR(2) NOT NULL,           
000013*       CENCOSTO                       CHAR(5) NOT NULL,           
000014*       DESCENCO                       CHAR(30) NOT NULL,          
000015*       RAGCENCO                       CHAR(3) NOT NULL,           
000016*       ANNULLAM                       CHAR(1) NOT NULL,           
000017*       NEWCENCO                       CHAR(5) NOT NULL,           
000018*       CENCOLIS                       CHAR(5) NOT NULL,           
000019*       DTCREAZI                       CHAR(8) NOT NULL,           
000020*       DTULTVAR                       CHAR(8) NOT NULL,           
000021*       CODUTVAR                       CHAR(6) NOT NULL,           
000022*       CDMCAGTM                       CHAR(1) NOT NULL,           
000023*       CDAREGTM                       CHAR(2) NOT NULL,           
000024*       CDDIPGTM                       CHAR(1) NOT NULL,           
000025*       CDUBIGTM                       CHAR(2) NOT NULL,           
000026*       CDLINGTM                       CHAR(2) NOT NULL,           
000027*       SIGLCALE                       CHAR(3) NOT NULL,           
000028*       GRUPSIGE                       CHAR(1) NOT NULL,           
000029*       CDDIVISI                       CHAR(1) NOT NULL            
000030*     ) END-EXEC
                                                                        
000031******************************************************************
000032* COBOL DECLARATION FOR TABLE DANAGRAF.TCENCOSTO                 *
000033******************************************************************
000034 01  DCLTCENCOSTO.                                                
000035*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000036     10 A982-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000037*                       CENCOSTO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000038     10 A982-CENCOSTO        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000039*                       DESCENCO                                  
000040     10 A982-DESCENCO        PIC X(30).                           
000041*                       RAGCENCO                                  
000042     10 A982-RAGCENCO        PIC X(3).                            
000043*                       ANNULLAM                                  
000044     10 A982-ANNULLAM        PIC X(1).                            
000045*                       NEWCENCO                                  
000046     10 A982-NEWCENCO        PIC X(5).                            
000047*                       CENCOLIS                                  
000048     10 A982-CENCOLIS        PIC X(5).                            
000049*                       DTCREAZI                                  
000050     10 A982-DTCREAZI        PIC X(8).                            
000051*                       DTULTVAR                                  
000052     10 A982-DTULTVAR        PIC X(8).                            
000053*                       CODUTVAR                                  
000054     10 A982-CODUTVAR        PIC X(6).                            
000055*                       CDMCAGTM                                  
000056     10 A982-CDMCAGTM        PIC X(1).                            
000057*                       CDAREGTM                                  
000058     10 A982-CDAREGTM        PIC X(2).                            
000059*                       CDDIPGTM                                  
000060     10 A982-CDDIPGTM        PIC X(1).                            
000061*                       CDUBIGTM                                  
000062     10 A982-CDUBIGTM        PIC X(2).                            
000063*                       CDLINGTM                                  
000064     10 A982-CDLINGTM        PIC X(2).                            
000065*                       SIGLCALE                                  
000066     10 A982-SIGLCALE        PIC X(3).                            
000067*                       GRUPSIGE                                  
000068     10 A982-GRUPSIGE        PIC X(1).                            
000069*                       CDDIVISI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000070     10 A982-CDDIVISI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000071******************************************************************
000072* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 18      *
000073******************************************************************
      *<<((file: FDANA982))
000147*------------------------------- DCONTCLI.TCONTIDCE               
000148 01  FILLER                      PIC X(8) VALUE 'FDCLI861'.       
000149*    EXEC SQL INCLUDE FDCLI861 END-EXEC.                          
      *>>((file: FDCLI861))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DCONTCLI.TCONTIDCE                 *
000003******************************************************************
000004 01  DCLTCONTIDCE.                                                
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 C861-CONTODCE        PIC X(6).                            
000006     10 C861-CODPIANO        PIC X(2).                            
000007     10 C861-CONTPROV        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000008     10 C861-DESCRDCE        PIC X(25).                           
000009     10 C861-ANNULLAM        PIC X(1).                            
000010     10 C861-TIPCONTO        PIC X(2).                            
000011     10 C861-CONTGRUP        PIC X(6).                            
000012     10 C861-NOTECON1        PIC X(33).                           
000013     10 C861-NOTECON2        PIC X(33).                           
000014     10 C861-INDBILQU        PIC X(1).                            
000015     10 C861-FLCOMMES        PIC X(1).                            
000016******************************************************************
000017* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 11 C861- 
000018******************************************************************
      *<<((file: FDCLI861))
000150*------------------------------- DLOGISTI.TSERVIZI                
000151 01  FILLER                      PIC X(8) VALUE 'FDLOG651'.       
000152*    EXEC SQL INCLUDE FDLOG651 END-EXEC.                          
      *>>((file: FDLOG651))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TSERVIZI                  *
000003******************************************************************
000004 01  DCLTSERVIZI.                                                 
000005*                       CODSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006     10 L651-CODSERVI        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007*                       DESSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000008     10 L651-DESSERVI        PIC X(40).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000009*                       UNMISURA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000010     10 L651-UNMISURA        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000011*                       TIPSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000012     10 L651-TIPSERVI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000013*                       DTCREAZI                                  
000014     10 L651-DTCREAZI        PIC X(8).                            
000015*                       DTULTVAR                                  
000016     10 L651-DTULTVAR        PIC X(8).                            
000017*                       CODUTVAR                                  
000018     10 L651-CODUTVAR        PIC X(6).                            
000019*                       CONTODCD                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000020     10 L651-CONTODCD        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000021*                       CONTODCA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000022     10 L651-CONTODCA        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000023*                       CENCOSTA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000024     10 L651-CENCOSTA        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025     10 L651-ESENTIVA        PIC X(1).                            
000026     10 L651-CONTPROV        PIC X(6).                            
000027******************************************************************
000028* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 12      *
000029******************************************************************
      *<<((file: FDLOG651))
000153*------------------------------- DLOGISTI.TORDILOGI               
000154 01  FILLER                      PIC X(8) VALUE 'FDLOG652'.       
000155*    EXEC SQL INCLUDE FDLOG652 END-EXEC.                          
      *>>((file: FDLOG652))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TORDILOGI                 *
000003******************************************************************
000004 01  DCLTORDILOGI.                                                
000005*                       AANUMORD                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006     10 L652-AANUMORD        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007*                       CODCLIEN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000008     10 L652-CODCLIEN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000009*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000010     10 L652-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000011*                       CDDIVISI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000012     10 L652-CDDIVISI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000013*                       DTCARORD                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000014     10 L652-DTCARORD        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000015*                       CODDIVIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000016     10 L652-CODDIVIS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000017*                       TIPSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000018     10 L652-TIPSERVI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000019*                       FLAGAUTO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000020     10 L652-FLAGAUTO        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000021*                       FLAGGIVA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000022     10 L652-FLAGGIVA        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000023*                       CONTODCE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000024     10 L652-CONTODCE        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025*                       DTEVAORD                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000026     10 L652-DTEVAORD        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000027*                       AANUMFAT                                  
000028     10 L652-AANUMFAT        PIC X(8).                            
000029*                       DTFATTUR                                  
000030     10 L652-DTFATTUR        PIC X(8).                            
000031*                       NRPREATT                                  
000032     10 L652-NRPREATT        PIC X(10).                           
000033*                       DTPREATT                                  
000034     10 L652-DTPREATT        PIC X(8).                            
000035*                       DTCREAZI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000036     10 L652-DTCREAZI        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000037*                       DTULTVAR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000038     10 L652-DTULTVAR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000039*                       CODUTVAR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000040     10 L652-CODUTVAR        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000041*                       DTANNULL                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000042     10 L652-DTANNULL        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000043*                       SOCIEMER                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000044     10 L652-SOCIEMER        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000045*                       DATAESTR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000046     10 L652-DATAESTR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000047*                       AAMMCOMP                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000048     10 L652-AAMMCOMP        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000049*                       FLAGSOSP                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000050     10 L652-FLAGSOSP        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000051*                       CODUTEVB                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000052     10 L652-CODUTEVB        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000053*                       ESENTIVA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000054     10 L652-ESENTIVA        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000055*                       FLORDIVB                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000056     10 L652-FLORDIVB        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000057******************************************************************
000058* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 26      *
000059******************************************************************
      *<<((file: FDLOG652))
000156*------------------------------- DLOGISTI.TRIGORDILOGI            
000157 01  FILLER                      PIC X(8) VALUE 'FDLOG653'.       
000158*    EXEC SQL INCLUDE FDLOG653 END-EXEC.                          
      *>>((file: FDLOG653))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TRIGORDILOGI              *
000003******************************************************************
000004 01  DCLTRIGORDILOGI.                                             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 L653-AANUMORD        PIC X(8).                            
000006     10 L653-NRRIGORD        PIC S9(5)V USAGE COMP-3.             
000007     10 L653-CODSERVI        PIC X(6).                            
000008     10 L653-UNMISURA        PIC X(2).                            
000009     10 L653-QTAORDIN        PIC S9(7)V9(2) USAGE COMP-3.         
000010     10 L653-PREZZORD        PIC S9(7)V9(4) USAGE COMP-3.         
000011     10 L653-IMPORDIN        PIC S9(11)V9(2) USAGE COMP-3.        
000012     10 L653-NOTENOTE        PIC X(40).                           
000013     10 L653-CENCOSTD        PIC X(5).                            
000014     10 L653-CENCOSTA        PIC X(5).                            
000015     10 L653-RIFECLIE        PIC X(15).                           
000016     10 L653-DTCREAZI        PIC X(8).                            
000017     10 L653-DTULTVAR        PIC X(8).                            
000018     10 L653-CODUTVAR        PIC X(6).                            
000019     10 L653-DTANNULL        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000020     10 L653-IMPORIVA        PIC S9(11)V9(2) USAGE COMP-3.        
000021******************************************************************
000022* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 16      *
000023******************************************************************
      *<<((file: FDLOG653))
000159*------------------------------- DLOGISTI.TLISTILOGI              
000160 01  FILLER                      PIC X(8) VALUE 'FDLOG654'.       
000161*    EXEC SQL INCLUDE FDLOG654 END-EXEC.                          
      *>>((file: FDLOG654))
000001******************************************************************
000002* DCLGEN TABLE(DLOGISTI.TLISTILOGI)                              *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDLOG654))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(L654-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DLOGISTI.TLISTILOGI TABLE                   
000012*     ( CODCLIEN                       CHAR(5) NOT NULL,           
000013*       DTINILIS                       CHAR(6) NOT NULL,           
000014*       DTFINLIS                       CHAR(6) NOT NULL,           
000015*       CODSERVI                       CHAR(6) NOT NULL,           
000016*       TIPSERVI                       CHAR(1) NOT NULL,           
000017*       CODDIVIS                       CHAR(2) NOT NULL,           
000018*       PREZZLIS                       DECIMAL(11, 4) NOT NULL,    
000019*       PERCLIST                       DECIMAL(5, 2) NOT NULL,     
000020*       DTCREAZI                       CHAR(8) NOT NULL,           
000021*       DTULTVAR                       CHAR(8) NOT NULL,           
000022*       CODUTVAR                       CHAR(8) NOT NULL            
000023*     ) END-EXEC
                                                                        
000024******************************************************************
000025* COBOL DECLARATION FOR TABLE DLOGISTI.TLISTILOGI                *
000026******************************************************************
000027 01  DCLTLISTILOGI.                                               
000028*                       CODCLIEN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000029     10 L654-CODCLIEN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000030*                       DTINILIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000031     10 L654-DTINILIS        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000032*                       DTFINLIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000033     10 L654-DTFINLIS        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000034*                       CODSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000035     10 L654-CODSERVI        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000036*                       TIPSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000037     10 L654-TIPSERVI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000038*                       CODDIVIS                                  
000039     10 L654-CODDIVIS        PIC X(2).                            
000040*                       PREZZLIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000041     10 L654-PREZZLIS        PIC S9(7)V9(4) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000042*                       PERCLIST                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000043     10 L654-PERCLIST        PIC S9(3)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000044*                       DTCREAZI                                  
000045     10 L654-DTCREAZI        PIC X(8).                            
000046*                       DTULTVAR                                  
000047     10 L654-DTULTVAR        PIC X(8).                            
000048*                       CODUTVAR                                  
000049     10 L654-CODUTVAR        PIC X(8).                            
000050******************************************************************
000051* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 11      *
000052******************************************************************
      *<<((file: FDLOG654))
000162*------------------------------- DLOGISTI.TDETTORDILOGI           
000163 01  FILLER                      PIC X(8) VALUE 'FDLOG655'.       
000164*    EXEC SQL INCLUDE FDLOG655 END-EXEC.                          
      *>>((file: FDLOG655))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TDETTORDILOGI             *
000003******************************************************************
000004 01  DCLTDETTORDILOGI.                                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 L655-AANUMORD        PIC X(8).                            
000006     10 L655-NRRIGORD        PIC S9(5)V USAGE COMP-3.             
000007     10 L655-NUMPROG7        PIC S9(7)V USAGE COMP-3.             
000008     10 L655-CDMCAGTM        PIC X(1).                            
000009     10 L655-CDAREGTM        PIC X(2).                            
000010     10 L655-CDDIPGTM        PIC X(1).                            
000011     10 L655-TIPOADDE        PIC X(2).                            
000012     10 L655-KEYADDE1        PIC X(5).                            
000013     10 L655-KEYADDE2        PIC X(3).                            
000014     10 L655-KEYADDE3        PIC X(3).                            
000015     10 L655-KEYADDE4        PIC X(5).                            
000016     10 L655-CODSOCID        PIC X(2).                            
000017     10 L655-CDDIVISD        PIC X(1).                            
000018     10 L655-CENCOSTD        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000019     10 L655-CONTODCD        PIC X(6).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000020     10 L655-CODSOCIA        PIC X(2).                            
000021     10 L655-CDDIVISA        PIC X(1).                            
000022     10 L655-CENCOSTA        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000023     10 L655-CONTODCA        PIC X(6).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000024     10 L655-UNMISURA        PIC X(2).                            
000025     10 L655-QTAORDIN        PIC S9(7)V9(2) USAGE COMP-3.         
000026     10 L655-IMPORDIN        PIC S9(11)V9(2) USAGE COMP-3.        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000027     10 L655-CODSOCIE        PIC X(2).                            
000028     10 L655-AANUMFAT        PIC X(8).                            
000029     10 L655-CENCOSTO        PIC X(5).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000030     10 L655-SOCIEMER        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000031     10 L655-PROLOMER        PIC X(2).                            
000032     10 L655-CODLINEA        PIC X(2).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000033     10 L655-TIPOARTI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000034     10 L655-MERCEMAG        PIC X(2).                            
000035     10 L655-CODARTIC        PIC X(5).                            
000036     10 L655-CODDISEG        PIC X(5).                            
000037     10 L655-CODVARIA        PIC X(3).                            
000038     10 L655-STAGIONE        PIC X(2).                            
000039     10 L655-CAUSAMOV        PIC X(2).                            
000040     10 L655-CLIEFORN        PIC X(5).                            
000041     10 L655-INCLIFOR        PIC X(1).                            
000042     10 L655-STABILIM        PIC X(2).                            
000043     10 L655-NRDISPOS        PIC X(6).                            
000044     10 L655-SIGLCICL        PIC X(2).                            
000045     10 L655-TIPOAPPA        PIC X(1).                            
000046     10 L655-AANRRECL        PIC X(8).                            
000047     10 L655-NUMERIFE        PIC X(5).                            
000048     10 L655-FLTAGSCA        PIC X(1).                            
000049     10 L655-CAUSACON        PIC X(1).                            
000050     10 L655-QUALIFIN        PIC X(4).                            
000051     10 L655-QTAMTMOV        PIC S9(7)V9(2) USAGE COMP-3.         
000052     10 L655-QTAKGMOV        PIC S9(7)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000053     10 L655-DTCREAZI        PIC X(8).                            
000054     10 L655-DTULTVAR        PIC X(8).                            
000055     10 L655-CODUTVAR        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000056     10 L655-IMPTRPAG        PIC S9(7)V9(2) USAGE COMP-3.         
000057     10 L655-PAESMERC        PIC X(3).                            
000058     10 L655-TIPORECO        PIC X(4).                            
000059     10 L655-DTFATTUR        PIC X(8).                            
000060     10 L655-TIPOSTAG        PIC X(1).                            
000061     10 L655-MTDISPOS        PIC S9(7)       COMP-3.              
000062     10 L655-PERC2SCE        PIC S9(2)V9     COMP-3.              
000063     10 L655-MTDIFMAX        PIC S9(7)V99    COMP-3.              
000064     10 L655-MTDIFTOT        PIC S9(7)V99    COMP-3.              
000065     10 L655-MTDIFMES        PIC S9(7)V99    COMP-3.              
000066     10 L655-PARTLAVO        PIC X(6).                            
000067     10 L655-MTDISPAR        PIC S9(7)       COMP-3.              
000068     10 L655-SERIECIL        PIC X(2).                            
000069     10 L655-TPLAVMES        PIC X(1).                            
000070     10 L655-FLAGRICH        PIC X(1).                            
000071     10 L655-NRCILLAV        PIC S9(3)       COMP-3.              
000072     10 L655-SLLAVMES        PIC X(2).                            
000073     10 L655-MTMATEFF        PIC S9(7)V99    COMP-3.              
000074     10 L655-MTCONSUM        PIC S9(7)V99    COMP-3.              
000075     10 L655-QTORDPRE        PIC S9(7)V99    COMP-3.              
000076     10 L655-PREZZORD        PIC S9(7)V9(4)  COMP-3.              
000077     10 L655-CODFORVI        PIC X(5).                            
000078     10 L655-CODIMBAL        PIC X(2).                            
000079     10 L655-CODCOLLO        PIC X(5).                            
000080     10 L655-MTRAGDIS        PIC S9(7) COMP-3.                    
000081     10 L655-NUMDISTI        PIC X(6).                            
000082******************************************************************
000083* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 77      *
000084******************************************************************
      *<<((file: FDLOG655))
000165                                                                  
000166*--- ESTRAZIONE ANAGRAFICA SERVIZI (FASHION/TESI)                 
000168     
      *EXEC SQL 
      *DECLARE PSERVI CURSOR FOR                               
000169*           SELECT CODSERVI                                        
000170*                 ,DESSERVI                                        
000171*                 ,UNMISURA                                        
000172*                 ,TIPSERVI                                        
000173*                 ,CONTODCD                                        
000174*                 ,CONTODCA                                        
000175*                 ,CENCOSTA                                        
000176*             FROM DLOGISTI.TSERVIZI                               
000177*            WHERE TIPSERVI IN ('T','M')                           
000178*            ORDER BY CODSERVI                                     
000179*     END-EXEC
                                                                        
000180                                                                  
000181*--- ESTRAZIONE LISTINI            (FASHION)                      
000183     
      *EXEC SQL 
      *DECLARE PLISTI CURSOR FOR                               
000184*           SELECT L.CODCLIEN                                      
000185*                 ,L.DTINILIS                                      
000186*                 ,L.DTFINLIS                                      
000187*                 ,L.CODSERVI                                      
000188*                 ,D.SIGLADIV                                      
000189*                 ,L.PREZZLIS                                      
000190*                 ,L.PERCLIST                                      
000191*                 ,L.TIPSERVI                                      
000192*             FROM DLOGISTI.TLISTILOGI L                           
000193*                 ,DANAGRAF.TCLIENTI   C                           
000194*                 ,DANAGRAF.TDIVISE    D                           
000195*            WHERE L.CODCLIEN = C.CODCLIEN                         
000196*              AND C.CLIFOCON > ' '                                
000197*              AND (C.TIPOCONS = 'V'  OR                           
000198*                  (C.TIPOCONS = 'T'  AND                          
000199*                   LEFT(L.CODSERVI,4) IN                          
000200*                       ('15ML','15RL')))                          
000201*              AND L.CODDIVIS = D.CODDIVIS                         
000202*              AND D.CODDIVRI = '75'                               
000203*            ORDER BY L.DTINILIS, L.DTFINLIS, L.CODCLIEN           
000204*                    ,L.CODSERVI                                   
000205*     END-EXEC
                                                                        
000206                                                                  
000207*--- ESTRAZIONE ORDINI             (FASHION)                      
000209     
      *EXEC SQL 
      *DECLARE PORDIN CURSOR FOR                               
000210*           SELECT T.CODSOCIE                                      
000211*                 ,T.DTCARORD                                      
000212*                 ,CASE WHEN R.RIFECLIE > ' '                      
000213*                       THEN R.RIFECLIE                            
000214*                       ELSE T.AANUMORD END AANUMORD               
000215*                 ,D.SIGLADIV                                      
000216*                 ,T.TIPSERVI                                      
000217*                 ,T.CODCLIEN                                      
000218*                 ,R.CODSERVI                                      
000219*                 ,R.NOTENOTE                                      
000220*                 ,R.QTAORDIN                                      
000221*                 ,R.PREZZORD                                      
000222*                 ,R.IMPORDIN                                      
000223*                 ,R.CENCOSTD                                      
000224*                 ,R.CENCOSTA                                      
000225*                 ,T.FLAGGIVA                                      
000226*                 ,T.AAMMCOMP                                      
000227*                 ,T.DTANNULL                                      
000228*                 ,R.DTANNULL                                      
000229*                 ,T.CONTODCE                                      
000230*                 ,R.AANUMORD                                      
000231*                 ,T.CODUTEVB                                      
000232*             FROM DLOGISTI.TORDILOGI    T                         
000233*                 ,DLOGISTI.TRIGORDILOGI R                         
000234*                 ,DANAGRAF.TDIVISE      D                         
000235*                 ,DANAGRAF.TCLIENTI     C                         
000236*            WHERE T.DATAESTR = ' '                                
000237*              AND T.FLAGSOSP = ' '                                
000238*              AND T.CODCLIEN = C.CODCLIEN                         
000239*              AND C.CLIFOCON > ' '                                
000240*              AND (C.TIPOCONS = 'V' OR                            
000241*                   T.FLORDIVB = 'V'   )                           
000242*              AND T.CODDIVIS = D.CODDIVIS                         
000243*              AND D.CODDIVRI = '75'                               
000244*              AND T.AANUMORD = R.AANUMORD                         
000245*              AND T.TIPSERVI IN ('T','M')                         
000246*            ORDER BY R.RIFECLIE, T.AANUMORD, R.NRRIGORD           
000247*     END-EXEC
                                                                        
000248                                                                  
000251*    EXEC SQL                                                     
      *         INCLUDE SQLCA                                           
      *    END-EXEC.                                                    
      *>>((file: SQLCA))
000001****************************************************************<*
000002* Copyright (c) 2016-2023 NTT DATA, Inc. All rights reserved.  *<*
000003* Users of NTT DATA Enterprise COBOL may freely                *<*
000004* redistribute this copybook.                                  *<*
000005****************************************************************<*
000006                                                                  
000007 01  SQLCA GLOBAL.                                                
000008     05  SQLCAID                PIC X(8).                         
000009     05  SQLCABC                PIC S9(9) COMP-5.                 
000010     05  SQLCODE                PIC S9(9) COMP-5.                 
000011     05  SQLERRM.                                                 
000012         49  SQLERRML           PIC S9(4) COMP-5.                 
000013         49  SQLERRMC           PIC X(254).                       
000014     05  SQLERRP                PIC X(8).                         
000015     05  SQLERRD OCCURS 6 TIMES PIC S9(9) COMP-5.                 
000016     05  SQLWARN.                                                 
000017         10 SQLWARN0            PIC X(1).                         
000018         10 SQLWARN1            PIC X(1).                         
000019         10 SQLWARN2            PIC X(1).                         
000020         10 SQLWARN3            PIC X(1).                         
000021         10 SQLWARN4            PIC X(1).                         
000022         10 SQLWARN5            PIC X(1).                         
000023         10 SQLWARN6            PIC X(1).                         
000024         10 SQLWARN7            PIC X(1).                         
000025     05  SQLSTATE               PIC X(5).                         
000026     05  SQLEXT                 PIC S9(5) COMP-3 VALUE 1.         
      *<<((file: SQLCA))
000252                                                                  
000253*----------------------------------------------------------------*
000254 PROCEDURE DIVISION.                                              
000255*----------------------------------------------------------------*
000254 VCOBOL-DUMMY-PROCEDURE.
000256                                                                  
000257     
      *EXEC SQL WHENEVER SQLERROR GO TO Z00-ERRORE END-EXEC
                                                                        
000258                                                                  
000259     MOVE 'AVALO55'              TO PPNAME                        
000260                                    WCOM-PROGNAME.                
000261                                                                  
000262     PERFORM A10-OPERAZIONI-INIZIALI                              
000263        THRU A10-EX.                                              
000264                                                                  
000265     IF SK-TIPOELAB = 'INV'                                       
000266        IF SK-TIPODATI = 'ANAG'                                   
000267           PERFORM A20-INVIO-ANAGRAFICHE                          
000268              THRU A20-EX                                         
000269        END-IF                                                    
000270        IF SK-TIPODATI = 'ORDI'                                   
000271           PERFORM A30-INVIO-ORDINI                               
000272              THRU A30-EX.                                        
000273                                                                  
000274     IF SK-TIPOELAB = 'RIC'                                       
000275        PERFORM A40-RICEZIONE-DATI                                
000276           THRU A40-EX.                                           
000277                                                                  
000278     MOVE 'P'                    TO PPROUTIN.                     
000279     PERFORM Z90-READPRIN                                         
000280        THRU Z90-EX.                                              
000281                                                                  
000282     MOVE ZERO                   TO  RETURN-CODE.                 
000283                                                                  
000284     CALL "CCF_SET_RETCODE" USING RETURN-CODE                     
000285     STOP RUN.                                                    
000286                                                                  
000287*-------------------------------------------------------*         
000288 A10-OPERAZIONI-INIZIALI.                                         
000289*-------------------------------------------------------*         
000290                                                                  
000291*--- SCHEDA PARAMETRO                                             
000292     MOVE 'S'                    TO PPROUTIN                      
000293     PERFORM Z90-READPRIN                                         
000294        THRU Z90-EX.                                              
000295     MOVE PPSK1                  TO WS-SKPARAME.                  
000296     IF PPSTAT NOT EQUAL '****'                                   
000297        MOVE 'MANCA SK-PARAMETRO'                                 
000298                                 TO PPMESSAG                      
000299        MOVE 'M'                 TO PPROUTIN                      
000300        PERFORM Z90-READPRIN                                      
000301           THRU Z90-EX                                            
000302        PERFORM Z00-ERRORE                                        
000303           THRU Z00-EX.                                           
000304                                                                  
000305*--- ORA ELABORAZIONE                                             
000306     MOVE 'A10-'                 TO WCOM-CODABEND                 
000307     MOVE 'SELECT'               TO WCOM-FILEFUNZ                 
000308     MOVE 'DATEDATE'             TO WCOM-FILENOME                 
000309     MOVE SPACES                 TO WCOM-FILECTRL                 
000311     
      *EXEC SQL 
      *SELECT HEX(CURRENT TIME)                                
000312*            INTO :WS-TEMPELAB                                     
000313*            FROM DANAGRAF.VANAGRAF_082                            
000314*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 1 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-TEMPELAB
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 4 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000315     IF SQLCODE NOT = 0                                           
000316        PERFORM Z00-ERRORE                                        
000317           THRU Z00-EX.                                           
000318                                                                  
000319*--- DATA GIORNO                                                  
000320     INITIALIZE  DCWDTEL.                                         
000321     MOVE 'R'                    TO DTEL-TIPORICH.                
000322     MOVE 'AVALO55'              TO DTEL-SIGLDATA.                
000323     MOVE 'G'                    TO DTEL-DATATIPO.                
000324                                                                  
000325     MOVE 'SCADTEL'              TO PPCALL.                       
000326     CALL  PPCALL             USING DCPARM                        
000327                                    DCWDTEL.                      
000328     IF DTEL-RETCOD NOT = ZEROES                                  
000329        MOVE DTEL-RETCOD         TO WCOM-FILECTRL                 
000330        MOVE 'MODULO'            TO WCOM-FILEFUNZ                 
000331        MOVE 'SCADTEL'           TO WCOM-FILENOME                 
000332        MOVE 'A10-'              TO WCOM-CODABEND                 
000333        PERFORM Z00-ERRORE                                        
000334           THRU Z00-EX.                                           
000335                                                                  
000336     MOVE DTEL-DTINELAB          TO WS-DTGIORNO.                  
000337                                                                  
000338*--- MENSILE                                                      
000339     INITIALIZE  DCWDTEL.                                         
000340     MOVE 'R'                    TO DTEL-TIPORICH.                
000341     MOVE 'AVALO55'              TO DTEL-SIGLDATA.                
000342     MOVE 'M'                    TO DTEL-DATATIPO.                
000343                                                                  
000344     MOVE 'SCADTEL'              TO PPCALL.                       
000345     CALL  PPCALL             USING DCPARM                        
000346                                    DCWDTEL.                      
000347     IF DTEL-RETCOD NOT = ZEROES                                  
000348        MOVE DTEL-RETCOD         TO WCOM-FILECTRL                 
000349        MOVE 'MODULO'            TO WCOM-FILEFUNZ                 
000350        MOVE 'SCADTEL'           TO WCOM-FILENOME                 
000351        MOVE 'A10-'              TO WCOM-CODABEND                 
000352        PERFORM Z00-ERRORE                                        
000353           THRU Z00-EX.                                           
000354                                                                  
000355     MOVE DTEL-DTINELAB          TO WS-MENSILE.                   
000356                                                                  
000357 A10-EX. EXIT.                                                    
000358*----------------------------------------------------------------*
000359 A20-INVIO-ANAGRAFICHE.                                           
000360*----------------------------------------------------------------*
000361                                                                  
000362*--- ANAGRAFICA SERVIZI FASHION / TESI                            
000363*--- IL FILE PER TESI E' FATTO CON SORT IN PROCEDURA              
000364     OPEN OUTPUT SERVIZI                                          
000365                                                                  
000366     MOVE 'A20-'                 TO WCOM-CODABEND                 
000367     MOVE 'PSERVI'               TO WCOM-FILENOME                 
000368     MOVE 'OPEN'                 TO WCOM-FILEFUNZ                 
000369     MOVE SPACES                 TO WCOM-FILECTRL                 
000370     
      *EXEC SQL OPEN PSERVI  END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000371                                                                  
000372     PERFORM L00-FETCH-PSERVI                                     
000373        THRU L00-EX                                               
000374     PERFORM B00-ELABORA-PSERVI                                   
000375        THRU B00-EX                                               
000376             UNTIL SQLCODE = 100                                  
000377                                                                  
000378     MOVE 'A20-'                 TO WCOM-CODABEND                 
000379     MOVE 'PSERVI'               TO WCOM-FILENOME                 
000380     MOVE 'CLOSE'                TO WCOM-FILEFUNZ                 
000381     MOVE SPACES                 TO WCOM-FILECTRL                 
000382     
      *EXEC SQL CLOSE PSERVI    END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000383                                                                  
000384     CLOSE SERVIZI.                                               
000385                                                                  
000386*--- LISTINI X FASHION                                            
000387     OPEN OUTPUT LISTINI                                          
000388     MOVE 'A20-'                 TO WCOM-CODABEND                 
000389     MOVE 'PLISTI'               TO WCOM-FILENOME                 
000390     MOVE 'OPEN'                 TO WCOM-FILEFUNZ                 
000391     MOVE SPACES                 TO WCOM-FILECTRL                 
000392     
      *EXEC SQL OPEN PLISTI  END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000393                                                                  
000394     PERFORM L10-FETCH-PLISTI                                     
000395        THRU L10-EX                                               
000396     PERFORM B10-ELABORA-PLISTI                                   
000397        THRU B10-EX                                               
000398             UNTIL SQLCODE = 100                                  
000399                                                                  
000400     MOVE 'A20-'                 TO WCOM-CODABEND                 
000401     MOVE 'PLISTI'               TO WCOM-FILENOME                 
000402     MOVE 'CLOSE'                TO WCOM-FILEFUNZ                 
000403     MOVE SPACES                 TO WCOM-FILECTRL                 
000404     
      *EXEC SQL CLOSE PLISTI    END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000405                                                                  
000406     CLOSE LISTINI.                                               
000407                                                                  
000408 A20-EX. EXIT.                                                    
000409*----------------------------------------------------------------*
000410 A30-INVIO-ORDINI.                                                
000411*----------------------------------------------------------------*
000412                                                                  
000413*--- INVIO ORDINI (FASHION)                                       
000414     OPEN OUTPUT ORDINI                                           
000415                                                                  
000416     MOVE 'A30-'                 TO WCOM-CODABEND                 
000417     MOVE 'PORDIN'               TO WCOM-FILENOME                 
000418     MOVE 'OPEN'                 TO WCOM-FILEFUNZ                 
000419     MOVE SPACES                 TO WCOM-FILECTRL                 
000420     
      *EXEC SQL OPEN PORDIN  END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000421                                                                  
000422     PERFORM L20-FETCH-PORDIN                                     
000423        THRU L20-EX                                               
000424     PERFORM B30-ELABORA-PORDIN                                   
000425        THRU B30-EX                                               
000426             UNTIL SQLCODE = 100                                  
000427                                                                  
000428     MOVE 'A30-'                 TO WCOM-CODABEND                 
000429     MOVE 'PORDIN'               TO WCOM-FILENOME                 
000430     MOVE 'CLOSE'                TO WCOM-FILEFUNZ                 
000431     MOVE SPACES                 TO WCOM-FILECTRL                 
000432     
      *EXEC SQL CLOSE PORDIN    END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000433                                                                  
000434     CLOSE ORDINI.                                                
000435                                                                  
000436 A30-EX. EXIT.                                                    
000437*----------------------------------------------------------------*
000438 A40-RICEZIONE-DATI.                                              
000439*----------------------------------------------------------------*
000440                                                                  
000441*--- RICEZIONE ORDINI FASHION                                     
000442     OPEN INPUT  ORDINIVB                                         
000443     OPEN OUTPUT ORDIRECU ORDIARCH                                
000444                                                                  
000445     INITIALIZE TABELLA2                                          
000446                                                                  
000447     PERFORM L30-READ-ORDINIVB                                    
000448        THRU L30-EX                                               
000449     PERFORM B40-ELABORA-ORDINIVB                                 
000450        THRU B40-EX                                               
000451             UNTIL EOF = 'S'                                      
000452                                                                  
000453     CLOSE ORDINIVB ORDIRECU ORDIARCH.                            
000454                                                                  
000455 A40-EX. EXIT.                                                    
000456*----------------------------------------------------------------*
000457 B00-ELABORA-PSERVI.                                              
000458*----------------------------------------------------------------*
000459                                                                  
000460     MOVE L651-CODSERVI           TO N17-CODSERVI                 
000461     MOVE L651-DESSERVI           TO N17-DESSERVI                 
000462     MOVE L651-UNMISURA           TO N17-UNMISURA                 
000463     MOVE L651-TIPSERVI           TO N17-TIPSERVI                 
000464     MOVE L651-CONTODCD           TO N17-CONTODCD                 
000465     MOVE L651-CONTODCA           TO N17-CONTODCA                 
000466     MOVE L651-CENCOSTA           TO N17-CENCOSTA                 
000467                                                                  
000468     PERFORM W00-WRITE-SERVIZI                                    
000469        THRU W00-EX                                               
000470                                                                  
000471     PERFORM L00-FETCH-PSERVI                                     
000472        THRU L00-EX.                                              
000473                                                                  
000474 B00-EX. EXIT.                                                    
000475*----------------------------------------------------------------*
000476 B10-ELABORA-PLISTI.                                              
000477*----------------------------------------------------------------*
000478                                                                  
000479     MOVE L654-CODCLIEN           TO N16-CODCLIEN                 
000480     MOVE L654-DTINILIS           TO N16-DTINILIS                 
000481     MOVE L654-DTFINLIS           TO N16-DTFINLIS                 
000482     MOVE L654-CODSERVI           TO N16-CODSERVI                 
000483     MOVE A963-SIGLADIV           TO N16-SIGLADIV                 
000484     MOVE L654-PREZZLIS           TO N16-PREZZLIS                 
000485     MOVE L654-PERCLIST           TO N16-PERCLIST                 
000486     MOVE L654-TIPSERVI           TO N16-TIPSERVI                 
000487                                                                  
000488     PERFORM W10-WRITE-LISTINI                                    
000489        THRU W10-EX                                               
000490                                                                  
000491     PERFORM L10-FETCH-PLISTI                                     
000492        THRU L10-EX.                                              
000493                                                                  
000494 B10-EX. EXIT.                                                    
000495*----------------------------------------------------------------*
000496 B30-ELABORA-PORDIN.                                              
000497*----------------------------------------------------------------*
000498                                                                  
000499     MOVE WS-ORDINE               TO WS-AANUMORD                  
000500                                                                  
000501*--- SE L'ORDINE HA TUTTE LE RIGHE ANNULLATE, SCRIVO RECORD CON   
000502*--- TIPO OPERAZIONE='A'. IL CONTROLLO CHE TUTTE LE RIGHE         
000503*--- SIANO ANNULLATE VA FATTO ANCHE SUGLI ALTRI EVENTUALI ORDINI  
000504*--- CHE HANNO LO STESSO RIFERIMENTO ORDINE VB                    
000505     IF L652-DTANNULL > ' '                                       
000506        PERFORM L120-SELECT-ORDILOGI-ANN                          
000507           THRU L120-EX                                           
000508        IF SQLCODE = 100                                          
000509           INITIALIZE                FSNET15                      
000510           MOVE L652-CODSOCIE     TO N15-CODSOCIE                 
000511           MOVE WS-ORDINE         TO N15-AANUMORD                 
000512           MOVE 'A'               TO N15-OPERAZIO                 
000513           MOVE WS-DTGIORNO       TO N15-DATAELAB                 
000514           MOVE WS-TEMPELAB       TO N15-TEMPELAB                 
000515           PERFORM W20-WRITE-ORDINI                               
000516              THRU W20-EX.                                        
000517                                                                  
000518     MOVE ZEROS                   TO SQLCODE                      
000519                                                                  
000520     PERFORM B31-ELABORA-PORDIN                                   
000521        THRU B31-EX                                               
000522             UNTIL SQLCODE       = 100                            
000523                OR WS-ORDINE NOT = WS-AANUMORD.                   
000524                                                                  
000525 B30-EX. EXIT.                                                    
000526*----------------------------------------------------------------*
000527 B31-ELABORA-PORDIN.                                              
000528*----------------------------------------------------------------*
000529                                                                  
000530     IF L652-DTANNULL NOT > ' ' AND                               
000531        L653-DTANNULL NOT > ' '                                   
000532        INITIALIZE                   FSNET15                      
000533        MOVE L652-CODSOCIE        TO N15-CODSOCIE                 
000534        MOVE L652-DTCARORD        TO N15-DTCARORD                 
000535        MOVE WS-ORDINE            TO N15-AANUMORD                 
000536        MOVE A963-SIGLADIV        TO N15-SIGLADIV                 
000537        MOVE L652-TIPSERVI        TO N15-TIPSERVI                 
000538        MOVE L652-CODCLIEN        TO N15-CODCLIEN                 
000539        MOVE L653-CODSERVI        TO N15-CODSERVI                 
000540        MOVE L653-NOTENOTE        TO N15-NOTENOTE                 
000541        MOVE L653-QTAORDIN        TO N15-QTAORDIN                 
000542        MOVE L653-PREZZORD        TO N15-PREZZORD                 
000543        MOVE L653-IMPORDIN        TO N15-IMPORDIN                 
000544        MOVE L653-CENCOSTD        TO N15-CENCOSTD                 
000545        MOVE L653-CENCOSTA        TO N15-CENCOSTA                 
000546        MOVE L652-FLAGGIVA        TO N15-FLAGGIVA                 
000547        MOVE L652-AAMMCOMP        TO N15-AAMMCOMP                 
000548        MOVE L652-CONTODCE        TO N15-CONTODCE                 
000549        MOVE 'I'                  TO N15-OPERAZIO                 
000550        MOVE WS-DTGIORNO          TO N15-DATAELAB                 
000551        MOVE WS-TEMPELAB          TO N15-TEMPELAB                 
000552        MOVE L652-CODUTEVB        TO N15-CODUTEVB                 
000553        PERFORM W20-WRITE-ORDINI                                  
000554           THRU W20-EX.                                           
000555                                                                  
000556     PERFORM W30-UPDATE-ORDILOGI                                  
000557        THRU W30-EX                                               
000558                                                                  
000559     PERFORM L20-FETCH-PORDIN                                     
000560        THRU L20-EX.                                              
000561                                                                  
000562 B31-EX. EXIT.                                                    
000563*----------------------------------------------------------------*
000564 B40-ELABORA-ORDINIVB.                                            
000565*----------------------------------------------------------------*
000566                                                                  
000567     MOVE SPACES                  TO M1-MESSAGGI                  
000568     MOVE N15-TIPSERVI            TO WS-TIPSERVI                  
000569     MOVE SPACES                  TO COMO-TIPSERVI                
000570     MOVE N15-CONTODCE            TO WS-CONTODCE                  
000571     MOVE N15-FLAGGIVA            TO WS-FLAGGIVA                  
000572     MOVE N15-ESENTIVA            TO WS-ESENTIVA                  
000573     MOVE N15-CODCLIEN            TO WS-CODCLIEN                  
000574     MOVE N15-CODSOCIE            TO WS-CODSOCIE                  
000575     MOVE N15-DTCARORD            TO WS-DTCARORD                  
000576     MOVE N15-SIGLADIV            TO WS-SIGLADIV                  
000577     MOVE N15-AAMMCOMP            TO WS-AAMMCOMP                  
000578     MOVE N15-CODUTEVB            TO WS-CODUTEVB                  
000579     INITIALIZE                      TABELLA1                     
000580                                                                  
000581     MOVE SPACES                 TO WS-NUMEAUTO                   
000582     MOVE ZEROS                  TO WS-NRRIGORD                   
000583                                                                  
000584     PERFORM B41-SCORRI-ORDINIVB                                  
000585        THRU B41-EX                                               
000586             UNTIL EOF              = 'S'                         
000587                OR N15-TIPSERVI NOT = WS-TIPSERVI                 
000588                OR N15-CONTODCE NOT = WS-CONTODCE                 
000589                OR N15-FLAGGIVA NOT = WS-FLAGGIVA                 
000590                OR N15-ESENTIVA NOT = WS-ESENTIVA                 
000591                OR N15-CODCLIEN NOT = WS-CODCLIEN                 
000592                OR N15-CODUTEVB NOT = WS-CODUTEVB                 
000593                OR WS-NRRIGORD      > 500                         
000594     IF WS-NRRIGORD > 0                                           
000595        PERFORM B45-TESTATA                                       
000596           THRU B45-EX.                                           
000597                                                                  
000598 B40-EX. EXIT.                                                    
000599*----------------------------------------------------------------*
000600 B41-SCORRI-ORDINIVB.                                             
000601*----------------------------------------------------------------*
000602                                                                  
000603     MOVE FSNET15                TO T1-ELEM-OLD                   
000604                                                                  
000605     PERFORM B42-CONTROLLA                                        
000606        THRU B42-EX.                                              
000607                                                                  
000608     MOVE FSNET15                TO T1-ELEM-NEW                   
000609                                                                  
000610     MOVE T1-ELEM-OLD            TO FSNET15                       
000611                                                                  
000612     IF M1-MESSAGGI     > ' ' AND                                 
000613        SK-RECUPERO NOT > ' '                                     
000614        PERFORM W40-WRITE-ORDIRECU                                
000615           THRU W40-EX                                            
000616     ELSE                                                         
000617        PERFORM W50-WRITE-ORDIARCH                                
000618           THRU W50-EX                                            
000619        MOVE T1-ELEM-NEW         TO FSNET15                       
000620        PERFORM B46-RIGHE                                         
000621           THRU B46-EX.                                           
000622                                                                  
000623     PERFORM L30-READ-ORDINIVB                                    
000624        THRU L30-EX.                                              
000625                                                                  
000626 B41-EX. EXIT.                                                    
000627*----------------------------------------------------------------*
000628 B42-CONTROLLA.                                                   
000629*----------------------------------------------------------------*
000630                                                                  
000631     MOVE N15-AANUMORD                           TO M1-AANUMORD   
000632     MOVE N15-CODSERVI                           TO M1-CODSERVI   
000633     MOVE SPACES                                 TO M1-MESSAGGI.  
000634                                                                  
000635*--- CONTROLLA IL NR.ORDINE SE  > SPACES PERCH SUL FILE CREATO  
000636*--- DAL CSV IL NR.ORDINE NON  VALORIZZATO                       
000637*--- CONTROLLA SE IL NR.ORDINE E  GIA  ARRIVATO. SE SI SCARTIAMO  
000638*--- NON NEL CASO DI ELABORAZIONE A PARTIRE DAL FILE DI SCARTI    
000639     IF SK-RECUPERO NOT > ' '                                     
000640        IF N15-AANUMORD > ' '                                     
000641           PERFORM B43-CTRL-ORDINE                                
000642              THRU B43-EX.                                        
000643                                                                  
000644     IF M1-MESSAGGI NOT > ' '                                     
000645        MOVE N15-CODCLIEN                        TO A901-CODCLIEN 
000646        PERFORM L50-SELECT-CLIENTI                                
000647           THRU L50-EX                                            
000648        IF SQLCODE           = 100  OR                            
000649           A901-CODSOCIE NOT = '22'                               
000650           MOVE 'CLIENTE ERRATO' TO M1-MESSAGGI                   
000651           MOVE WS-MESSAGGI      TO PPMESSAG                      
000652           MOVE 'M'              TO PPROUTIN                      
000653           PERFORM Z90-READPRIN                                   
000654              THRU Z90-EX                                         
000655           PERFORM Z00-ERRORE                                     
000656              THRU Z00-EX.                                        
000657                                                                  
000658     IF M1-MESSAGGI NOT > ' '                                     
000659        MOVE N15-CODSERVI                        TO L651-CODSERVI 
000660        PERFORM L60-SELECT-SERVIZI                                
000661           THRU L60-EX                                            
000662        IF SQLCODE = 100                                          
000663           MOVE 'CODICE SERVIZIO ERRATO'         TO M1-MESSAGGI.  
000664                                                                  
000665     IF M1-MESSAGGI NOT > ' '                                     
000666        IF COMO-TIPSERVI NOT > ' '                                
000667           IF WS-TIPSERVI > ' '                                   
000668              MOVE WS-TIPSERVI                   TO COMO-TIPSERVI 
000669           ELSE                                                   
000670              MOVE L651-TIPSERVI                 TO COMO-TIPSERVI 
000671           END-IF                                                 
000672        END-IF                                                    
000673        IF COMO-TIPSERVI NOT = L651-TIPSERVI                      
000674           MOVE 'TIPO SERVIZIO NON CONGRUENTE'   TO M1-MESSAGGI.  
000675                                                                  
000676     IF M1-MESSAGGI NOT > ' '                                     
000677        IF N15-PREZZORD = 0 AND                                   
000678           N15-IMPORDIN = 0                                       
000679           MOVE N15-CODCLIEN      TO L654-CODCLIEN                
000680           MOVE COMO-TIPSERVI     TO L654-TIPSERVI                
000681           MOVE N15-CODSERVI      TO L654-CODSERVI                
000682           PERFORM L90-SELECT-LISTILOGI                           
000683              THRU L90-EX                                         
000684           MOVE L654-PREZZLIS     TO N15-PREZZORD                 
000685        END-IF                                                    
000686        IF N15-QTAORDIN > 0 OR                                    
000687           N15-PREZZORD > 0                                       
000688           IF N15-QTAORDIN NOT > 0                                
000689              MOVE 'MANCA QUANTITA'               TO M1-MESSAGGI  
000690           END-IF                                                 
000691           IF N15-PREZZORD NOT > 0                                
000692              MOVE 'MANCA PREZZO UNITARIO'        TO M1-MESSAGGI  
000693           END-IF                                                 
000694        ELSE                                                      
000695           IF N15-IMPORDIN NOT > 0                                
000696              MOVE 'MANCA IMPORTO DI RIGA'        TO M1-MESSAGGI. 
000697                                                                  
000698     IF M1-MESSAGGI NOT > ' '                                     
000699        IF N15-CENCOSTD NOT > ' '                                 
000700           MOVE 'MANCA C/COSTO DARE'              TO M1-MESSAGGI  
000701        ELSE                                                      
000702           MOVE N15-CENCOSTD                      TO A982-CENCOSTO
000703           MOVE A531-CODSOCIE                     TO A982-CODSOCIE
000704           MOVE 'V'                               TO A982-CDDIVISI
000705           PERFORM L100-SELECT-CENCOSTO                           
000706              THRU L100-EX                                        
000707           IF SQLCODE = 100                                       
000708              MOVE 'C/COSTO DARE ERRATO'          TO M1-MESSAGGI. 
000709                                                                  
000710     IF M1-MESSAGGI NOT > ' '                                     
000711        IF N15-CENCOSTA NOT > ' '                                 
000712           MOVE L651-CENCOSTA                     TO N15-CENCOSTA 
000713        END-IF                                                    
000714        IF N15-CENCOSTA NOT > ' '                                 
000715           MOVE 'MANCA C/COSTO AVERE'             TO M1-MESSAGGI  
000716        ELSE                                                      
000717           MOVE N15-CENCOSTA                      TO A982-CENCOSTO
000718           MOVE A901-CODSOCIE                     TO A982-CODSOCIE
000719           MOVE 'A'                               TO A982-CDDIVISI
000720           PERFORM L100-SELECT-CENCOSTO                           
000721              THRU L100-EX                                        
000722           IF SQLCODE = 100                                       
000723              MOVE 'C/COSTO AVERE ERRATO'         TO M1-MESSAGGI. 
000724                                                                  
000725     IF M1-MESSAGGI NOT > ' '                                     
000726        IF N15-CONTODCE NOT > ' '                                 
000727           MOVE 'MANCA CONTO DCE'                 TO M1-MESSAGGI  
000728        ELSE                                                      
000729           MOVE A531-CODPIANO                     TO C861-CODPIANO
000730           MOVE N15-CONTODCE                      TO C861-CONTODCE
000731           PERFORM L110-SELECT-CONTIDCE                           
000732              THRU L110-EX                                        
000733           IF SQLCODE = 100           OR                          
000734              (A901-CAPOCONT          = '33020' AND               
000735               C861-CONTODCE(1:1) NOT = 'G')        OR            
000736              (A901-CAPOCONT      NOT = '33020' AND               
000737               C861-CONTODCE(1:1)     = 'G')                      
000738              MOVE 'CONTO DCE ERRATO'             TO M1-MESSAGGI  
000739           ELSE                                                   
000740              IF COMO-TIPSERVI     = 'M' AND                      
000741                 C861-CONTPROV NOT = 'MAGAVB'                     
000742                 MOVE 'CONTO DCE ERRATO'          TO M1-MESSAGGI  
000743              ELSE                                                
000744                 IF COMO-TIPSERVI     = 'T'      AND              
000745                    C861-CONTPROV NOT = 'TRASXX' AND              
000746                    C861-CONTPROV NOT = 'TRASAC'                  
000747                    MOVE 'CONTO DCE ERRATO'       TO M1-MESSAGGI. 
000748                                                                  
000749     IF M1-MESSAGGI NOT > ' '                                     
000750        IF WS-FLAGGIVA NOT = 'S' AND 'N'                          
000751           MOVE 'FLAG IVA ERRATO'                 TO M1-MESSAGGI. 
000752                                                                  
000753     IF M1-MESSAGGI NOT > ' '                                     
000754        IF WS-FLAGGIVA = 'S' AND                                  
000755           WS-ESENTIVA > SPACES                                   
000756           MOVE 'INCONGRUENZA TRA FLAG IVA ED ESENZIONE'          
000757                                                  TO M1-MESSAGGI. 
000758                                                                  
000759     IF M1-MESSAGGI     > ' ' AND                                 
000760        SK-RECUPERO NOT > ' '                                     
000761        MOVE WS-MESSAGGI         TO PPMESSAG                      
000762        MOVE 'M'                 TO PPROUTIN                      
000763        PERFORM Z90-READPRIN                                      
000764           THRU Z90-EX.                                           
000765                                                                  
000766 B42-EX. EXIT.                                                    
000767*----------------------------------------------------------------*
000768 B43-CTRL-ORDINE.                                                 
000769*----------------------------------------------------------------*
000770                                                                  
000771     PERFORM VARYING IND2 FROM 1 BY 1                             
000772       UNTIL IND2                  > MAX-IND2                     
000773          OR T2-AANUMORD(IND2)     = N15-AANUMORD                 
000774          OR T2-AANUMORD(IND2) NOT > ' '                          
000775     END-PERFORM                                                  
000776     IF IND2 > MAX-IND2                                           
000777        MOVE 'B43-'               TO WCOM-CODABEND                
000778        MOVE 'CARICA'             TO WCOM-FILEFUNZ                
000779        MOVE 'TABELLA2'           TO WCOM-FILENOME                
000780        MOVE N15-AANUMORD         TO WCOM-FILECTRL                
000781        PERFORM Z00-ERRORE                                        
000782           THRU Z00-EX.                                           
000783                                                                  
000784     IF T2-AANUMORD(IND2) NOT > ' '                               
000785        MOVE N15-AANUMORD         TO L653-RIFECLIE                
000786                                     T2-AANUMORD(IND2)            
000787        MOVE 'N'                  TO T2-ESISTEXX(IND2)            
000788        PERFORM L40-SELECT-RIGORDILOGI                            
000789           THRU L40-EX                                            
000790        IF SQLCODE = 0                                            
000791           MOVE 'S'                         TO T2-ESISTEXX(IND2)  
000792           MOVE 'ORDINE GIA  ESISTENTE'     TO M1-MESSAGGI        
000793        END-IF                                                    
000794     ELSE                                                         
000795        IF T2-ESISTEXX(IND2) = 'S'                                
000796           MOVE 'ORDINE GIA  ESISTENTE'     TO M1-MESSAGGI.       
000797                                                                  
000798 B43-EX. EXIT.                                                    
000799*----------------------------------------------------------------*
000800 B45-TESTATA.                                                     
000801*----------------------------------------------------------------*
000802                                                                  
000803     MOVE WS-NUMORDIN            TO L652-AANUMORD                 
000804                                                                  
000805     MOVE WS-CODCLIEN            TO L652-CODCLIEN                 
000806                                                                  
000807     MOVE WS-CODSOCIE            TO L652-CODSOCIE                 
000808     IF WS-CODSOCIE NOT = '22'                                    
000809        MOVE '22'                TO L652-CODSOCIE.                
000810                                                                  
000811     MOVE 'A'                    TO L652-CDDIVISI                 
000812                                                                  
000813     MOVE WS-DTCARORD            TO L652-DTCARORD                 
000814                                    A973-DTGIORNO                 
000815     PERFORM L70-SELECT-DATARIO                                   
000816        THRU L70-EX                                               
000817     IF SQLCODE = 100                                             
000818        MOVE WS-DTGIORNO         TO L652-DTCARORD.                
000819                                                                  
000820     MOVE WS-SIGLADIV            TO A963-SIGLADIV                 
000821     MOVE '75'                   TO A963-CODDIVRI                 
000822     PERFORM L80-SELECT-DIVISE                                    
000823        THRU L80-EX                                               
000824     IF SQLCODE = 100                                             
000825        MOVE '75'                TO L652-CODDIVIS                 
000826     ELSE                                                         
000827        MOVE A963-CODDIVIS       TO L652-CODDIVIS.                
000828                                                                  
000829     MOVE COMO-TIPSERVI          TO L652-TIPSERVI                 
000830     MOVE 'A'                    TO L652-FLAGAUTO                 
000831                                                                  
000832     MOVE WS-FLAGGIVA            TO L652-FLAGGIVA                 
000833     IF WS-FLAGGIVA = '2'                                         
000834        MOVE '?'                 TO L652-FLAGGIVA                 
000835     END-IF                                                       
000836                                                                  
000837     MOVE WS-ESENTIVA            TO L652-ESENTIVA                 
000838                                                                  
000839     MOVE WS-CONTODCE            TO L652-CONTODCE                 
000840     MOVE SPACES                 TO L652-DTEVAORD                 
000841     MOVE 'AVLO55'               TO L652-CODUTVAR                 
000842     MOVE WS-DTGIORNO            TO L652-DTCREAZI                 
000843                                    L652-DTULTVAR                 
000844     MOVE A531-CODSOCIE          TO L652-SOCIEMER                 
000845     MOVE WS-DTGIORNO            TO L652-DATAESTR                 
000846     MOVE WS-AAMMCOMP            TO L652-AAMMCOMP                 
000847                                    WS-ANNOMESE                   
000848     PERFORM L71-SELECT-DATARIO                                   
000849        THRU L71-EX                                               
000850     IF SQLCODE = 100                                             
000851        MOVE WS-MENSILE          TO L652-AAMMCOMP.                
000852                                                                  
000853     MOVE ' '                    TO L652-FLAGSOSP.                
000854     IF SK-RECUPERO > ' '                                         
000855        MOVE 'S'                 TO L652-FLAGSOSP.                
000856                                                                  
000857     MOVE WS-CODUTEVB            TO L652-CODUTEVB                 
000858     MOVE 'V'                    TO L652-FLORDIVB                 
000859                                                                  
000860     PERFORM W70-INSERT-ORDILOGI                                  
000861        THRU W70-EX.                                              
000862                                                                  
000863 B45-EX. EXIT.                                                    
000864*----------------------------------------------------------------*
000865 B45A-CERCA-NUMERO.                                               
000866*----------------------------------------------------------------*
000867                                                                  
000868     MOVE SPACES                 TO DCNUME.                       
000869     MOVE 'ORDILOGI'             TO DCNU-SIGLNUME.                
000870     MOVE 'R'                    TO DCNU-FLAGOPER.                
000871     PERFORM W60-SCANUME                                          
000872        THRU W60-EX.                                              
000873                                                                  
000874     MOVE DCNU-NUMEAUTO          TO WS-NUMEAUTO                   
000875     ADD 1                       TO WS-NUMORDIN                   
000876     MOVE WS-NUMEAUTO            TO DCNU-NUMEAUTO                 
000877                                                                  
000878     MOVE 'ORDILOGI'             TO DCNU-SIGLNUME.                
000879     MOVE 'U'                    TO DCNU-FLAGOPER.                
000880     PERFORM W60-SCANUME                                          
000881        THRU W60-EX.                                              
000882                                                                  
000883 B45A-EX. EXIT.                                                   
000884*----------------------------------------------------------------*
000885 B46-RIGHE.                                                       
000886*----------------------------------------------------------------*
000887                                                                  
000888     IF WS-NUMEAUTO NOT > ' '                                     
000889        PERFORM B45A-CERCA-NUMERO                                 
000890           THRU B45A-EX.                                          
000891                                                                  
000892     MOVE WS-NUMORDIN            TO L653-AANUMORD                 
000893     ADD 1                       TO WS-NRRIGORD                   
000894     MOVE WS-NRRIGORD            TO L653-NRRIGORD                 
000895     MOVE N15-CODSERVI           TO L653-CODSERVI                 
000896                                    L651-CODSERVI                 
000897     PERFORM L60-SELECT-SERVIZI                                   
000898        THRU L60-EX                                               
000899     MOVE L651-UNMISURA          TO L653-UNMISURA                 
000900     IF L651-UNMISURA NOT > ' '                                   
000901        MOVE 'NR'                TO L653-UNMISURA.                
000902                                                                  
000903     MOVE N15-QTAORDIN           TO L653-QTAORDIN                 
000904     IF N15-QTAORDIN NOT > 0                                      
000905        MOVE 1                   TO L653-QTAORDIN.                
000906     MOVE N15-PREZZORD           TO L653-PREZZORD                 
000907                                                                  
000908     IF N15-IMPORDIN > 0                                          
000909        MOVE N15-IMPORDIN        TO L653-IMPORDIN                 
000910     ELSE                                                         
000911        COMPUTE L653-IMPORDIN ROUNDED =                           
000912                L653-PREZZORD * L653-QTAORDIN.                    
000913                                                                  
000914     MOVE N15-NOTENOTE           TO L653-NOTENOTE                 
000915     MOVE N15-CENCOSTD           TO L653-CENCOSTD                 
000916     MOVE N15-CENCOSTA           TO L653-CENCOSTA                 
000917     MOVE N15-AANUMORD           TO L653-RIFECLIE                 
000918     MOVE 'AVLO55'               TO L653-CODUTVAR                 
000919     MOVE WS-DTGIORNO            TO L653-DTCREAZI                 
000920                                    L653-DTULTVAR                 
000921     PERFORM W80-INSERT-RIGORDILOGI                               
000922        THRU W80-EX.                                              
000923                                                                  
000924     IF COMO-TIPSERVI = 'T' AND                                   
000925        A901-TIPOCONS = 'T'                                       
000926        PERFORM B50-DETTAGLIO                                     
000927           THRU B50-EX.                                           
000928                                                                  
000929 B46-EX. EXIT.                                                    
000930*----------------------------------------------------------------*
000931 B50-DETTAGLIO.                                                   
000932*----------------------------------------------------------------*
000933                                                                  
000934     INITIALIZE                     DCLTDETTORDILOGI              
000935                                                                  
000936     MOVE WS-NUMORDIN            TO L655-AANUMORD                 
000937     MOVE WS-NRRIGORD            TO L655-NRRIGORD                 
000938     MOVE 1                      TO L655-NUMPROG7                 
000939     MOVE A901-CODSOCIE          TO L655-CODSOCIA                 
000940     MOVE 'A'                    TO L655-CDDIVISA                 
000941     MOVE L653-CENCOSTA          TO L655-CENCOSTA                 
000942     MOVE A531-CODSOCIE          TO L655-CODSOCID                 
000943                                    L655-SOCIEMER                 
000944     MOVE A901-TIPOCONS          TO L655-CDDIVISD                 
000945     MOVE L653-CENCOSTD          TO L655-CENCOSTD                 
000946     MOVE L653-UNMISURA          TO L655-UNMISURA                 
000947     MOVE L653-QTAORDIN          TO L655-QTAORDIN                 
000948     MOVE L653-IMPORDIN          TO L655-IMPORDIN                 
000949     MOVE 'T'                    TO L655-TIPOARTI                 
000950     MOVE 'AVLO55'               TO L655-CODUTVAR                 
000951     MOVE WS-DTGIORNO            TO L655-DTCREAZI                 
000952                                    L655-DTULTVAR                 
000953                                                                  
000954     PERFORM W85-INSERT-DETTORDILOGI                              
000955        THRU W85-EX.                                              
000956                                                                  
000957 B50-EX. EXIT.                                                    
000958*----------------------------------------------------------------*
000959 L00-FETCH-PSERVI.                                                
000960*----------------------------------------------------------------*
000961                                                                  
000962     MOVE 'L00-'                 TO WCOM-CODABEND                 
000963     MOVE 'FETCH'                TO WCOM-FILEFUNZ                 
000964     MOVE 'PSERVI'               TO WCOM-FILENOME                 
000966     
      *EXEC SQL 
      *FETCH PSERVI                                            
000967*           INTO :L651-CODSERVI                                    
000968*               ,:L651-DESSERVI                                    
000969*               ,:L651-UNMISURA                                    
000970*               ,:L651-TIPSERVI                                    
000971*               ,:L651-CONTODCD                                    
000972*               ,:L651-CONTODCA                                    
000973*               ,:L651-CENCOSTA                                    
000974*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 2 TO SQL-STMT-ID 
           MOVE 7 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CODSERVI
            BY VALUE 0
                     0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-DESSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-UNMISURA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-TIPSERVI
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CONTODCD
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CONTODCA
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CENCOSTA
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000975                                                                  
000976     IF SQLCODE = 0                                               
000977        MOVE 'U'                 TO PPROUTIN                      
000978        MOVE 'D'                 TO PPTPFILE                      
000979        MOVE 'R'                 TO PPTPOPER                      
000980        MOVE WCOM-FILENOME       TO PPNMFILE                      
000981        PERFORM Z90-READPRIN                                      
000982           THRU Z90-EX.                                           
000983                                                                  
000984 L00-EX. EXIT.                                                    
000985*----------------------------------------------------------------*
000986 L10-FETCH-PLISTI.                                                
000987*----------------------------------------------------------------*
000988                                                                  
000989     MOVE 'L10-'                 TO WCOM-CODABEND                 
000990     MOVE 'PLISTI'               TO WCOM-FILENOME                 
000991     MOVE 'FETCH'                TO WCOM-FILEFUNZ                 
000993     
      *EXEC SQL 
      *FETCH PLISTI                                            
000994*           INTO :L654-CODCLIEN                                    
000995*               ,:L654-DTINILIS                                    
000996*               ,:L654-DTFINLIS                                    
000997*               ,:L654-CODSERVI                                    
000998*               ,:A963-SIGLADIV                                    
000999*               ,:L654-PREZZLIS                                    
001000*               ,:L654-PERCLIST                                    
001001*               ,:L654-TIPSERVI                                    
001002*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 3 TO SQL-STMT-ID 
           MOVE 8 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODCLIEN
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTINILIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTFINLIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODSERVI
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A963-SIGLADIV
            BY VALUE 0
                     0

           MOVE 1035 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-PREZZLIS
            BY VALUE 0
                     0

           MOVE 517 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-PERCLIST
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-TIPSERVI
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001003                                                                  
001004     IF SQLCODE = 0                                               
001005        MOVE 'U'                 TO PPROUTIN                      
001006        MOVE 'D'                 TO PPTPFILE                      
001007        MOVE 'R'                 TO PPTPOPER                      
001008        MOVE WCOM-FILENOME       TO PPNMFILE                      
001009        PERFORM Z90-READPRIN                                      
001010           THRU Z90-EX.                                           
001011                                                                  
001012 L10-EX. EXIT.                                                    
001013*----------------------------------------------------------------*
001014 L20-FETCH-PORDIN.                                                
001015*----------------------------------------------------------------*
001016                                                                  
001017     MOVE 'L20-'                 TO WCOM-CODABEND                 
001018     MOVE 'PORDIN'               TO WCOM-FILENOME                 
001019     MOVE 'FETCH'                TO WCOM-FILEFUNZ                 
001021     
      *EXEC SQL 
      *FETCH PORDIN                                            
001022*           INTO :L652-CODSOCIE                                    
001023*               ,:L652-DTCARORD                                    
001024*               ,:WS-ORDINE                                        
001025*               ,:A963-SIGLADIV                                    
001026*               ,:L652-TIPSERVI                                    
001027*               ,:L652-CODCLIEN                                    
001028*               ,:L653-CODSERVI                                    
001029*               ,:L653-NOTENOTE                                    
001030*               ,:L653-QTAORDIN                                    
001031*               ,:L653-PREZZORD                                    
001032*               ,:L653-IMPORDIN                                    
001033*               ,:L653-CENCOSTD                                    
001034*               ,:L653-CENCOSTA                                    
001035*               ,:L652-FLAGGIVA                                    
001036*               ,:L652-AAMMCOMP                                    
001037*               ,:L652-DTANNULL                                    
001038*               ,:L653-DTANNULL                                    
001039*               ,:L652-CONTODCE                                    
001040*               ,:L652-AANUMORD                                    
001041*               ,:L652-CODUTEVB                                    
001042*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 4 TO SQL-STMT-ID 
           MOVE 20 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODSOCIE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTCARORD
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-ORDINE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A963-SIGLADIV
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-TIPSERVI
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODCLIEN
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CODSERVI
            BY VALUE 0
                     0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-NOTENOTE
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-QTAORDIN
            BY VALUE 0
                     0

           MOVE 1035 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-PREZZORD
            BY VALUE 0
                     0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-IMPORDIN
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CENCOSTD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CENCOSTA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-FLAGGIVA
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AAMMCOMP
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTANNULL
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-DTANNULL
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 17 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CONTODCE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 18 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMORD
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 19 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODUTEVB
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001043                                                                  
001044     IF SQLCODE = 0                                               
001045        MOVE 'U'                 TO PPROUTIN                      
001046        MOVE 'D'                 TO PPTPFILE                      
001047        MOVE 'R'                 TO PPTPOPER                      
001048        MOVE WCOM-FILENOME       TO PPNMFILE                      
001049        PERFORM Z90-READPRIN                                      
001050           THRU Z90-EX.                                           
001051                                                                  
001052 L20-EX. EXIT.                                                    
001053*----------------------------------------------------------------*
001054 L30-READ-ORDINIVB.                                               
001055*----------------------------------------------------------------*
001056                                                                  
001057     MOVE 'N'                           TO EOF                    
001058     READ ORDINIVB INTO FSNET15                                   
001059          AT END               MOVE 'S' TO EOF.                   
001060                                                                  
001061     IF EOF = 'N'                                                 
001062        MOVE 'U'                 TO PPROUTIN                      
001063        MOVE 'S'                 TO PPTPFILE                      
001064        MOVE 'R'                 TO PPTPOPER                      
001065        MOVE 'ORDINIVB'          TO PPNMFILE                      
001066        PERFORM Z90-READPRIN                                      
001067           THRU Z90-EX.                                           
001068                                                                  
001069 L30-EX. EXIT.                                                    
001070*----------------------------------------------------------------*
001071 L40-SELECT-RIGORDILOGI.                                          
001072*----------------------------------------------------------------*
001073                                                                  
001074     MOVE 'L40-'                 TO WCOM-CODABEND                 
001075     MOVE 'SELECT'               TO WCOM-FILEFUNZ                 
001076     MOVE 'RIGORDILOGI'          TO WCOM-FILENOME                 
001077     MOVE L653-RIFECLIE          TO WCOM-FILECTRL                 
001078                                                                  
001080     
      *EXEC SQL 
      *SELECT AANUMORD                                         
001081*            INTO :L653-AANUMORD                                   
001082*            FROM DLOGISTI.TRIGORDILOGI                            
001083*           WHERE RIFECLIE = :L653-RIFECLIE                        
001084*             AND DTANNULL = ' '                                   
001085*           FETCH FIRST 1 ROWS ONLY                                
001086*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 5 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 15 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-RIFECLIE
            BY VALUE 0
                     0

           MOVE 6 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-AANUMORD
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 5 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001087                                                                  
001088     IF SQLCODE = 0                                               
001089        MOVE 'U'                 TO PPROUTIN                      
001090        MOVE 'D'                 TO PPTPFILE                      
001091        MOVE 'R'                 TO PPTPOPER                      
001092        MOVE 'RIGORDILOGI'       TO PPNMFILE                      
001093        PERFORM Z90-READPRIN                                      
001094           THRU Z90-EX.                                           
001095                                                                  
001096 L40-EX. EXIT.                                                    
001097*----------------------------------------------------------------*
001098 L50-SELECT-CLIENTI.                                              
001099*----------------------------------------------------------------*
001100                                                                  
001101     MOVE 'L50-'                 TO WCOM-CODABEND                 
001102     MOVE 'SELECT'               TO WCOM-FILEFUNZ                 
001103     MOVE 'CLIENTI'              TO WCOM-FILENOME                 
001104     MOVE A901-CODCLIEN          TO WCOM-FILECTRL                 
001105                                                                  
001106     MOVE SPACES                 TO A901-CODSOCIE                 
001107                                    A901-TIPOCONS                 
001108                                    A901-CAPOCONT                 
001109                                    A531-CODSOCIE.                
001111     
      *EXEC SQL 
      *SELECT C.CODSOCIE, C.TIPOCONS, S.CODSOCIE               
001112*                ,S.CODPIANO, C.CAPOCONT                           
001113*            INTO :A901-CODSOCIE, :A901-TIPOCONS, :A531-CODSOCIE   
001114*                ,:A531-CODPIANO, :A901-CAPOCONT                   
001115*            FROM DANAGRAF.TCLIENTI C                              
001116*                ,DANAGRAF.TSOCIETA S                              
001117*           WHERE C.CODCLIEN = :A901-CODCLIEN                      
001118*             AND C.CLIFOCON > ' '                                 
001119*             AND C.TIPOCONS IN ('V','T')                          
001120*             AND C.CLIFOCON = S.CODFORNI                          
001121*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 7 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODCLIEN
            BY VALUE 0
                     0

           MOVE 8 TO SQL-STMT-ID 
           MOVE 5 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODSOCIE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-TIPOCONS
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODPIANO
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CAPOCONT
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 6 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001122                                                                  
001123     IF SQLCODE = 0                                               
001124        MOVE 'U'                 TO PPROUTIN                      
001125        MOVE 'D'                 TO PPTPFILE                      
001126        MOVE 'R'                 TO PPTPOPER                      
001127        MOVE 'CLIENTI'           TO PPNMFILE                      
001128        PERFORM Z90-READPRIN                                      
001129           THRU Z90-EX.                                           
001130                                                                  
001131 L50-EX. EXIT.                                                    
001132*----------------------------------------------------------------*
001133 L60-SELECT-SERVIZI.                                              
001134*----------------------------------------------------------------*
001135                                                                  
001136     MOVE 'L60-'                 TO WCOM-CODABEND                 
001137     MOVE 'SELECT'               TO WCOM-FILEFUNZ                 
001138     MOVE 'SERVIZI'              TO WCOM-FILENOME                 
001139     MOVE L651-CODSERVI          TO WCOM-FILECTRL                 
001140                                                                  
001141     MOVE SPACES                 TO L651-CENCOSTA                 
001142     MOVE SPACES                 TO L651-TIPSERVI                 
001143     MOVE SPACES                 TO L651-UNMISURA                 
001145     
      *EXEC SQL 
      *SELECT CENCOSTA, TIPSERVI                               
001146*                ,UNMISURA                                         
001147*            INTO :L651-CENCOSTA, :L651-TIPSERVI                   
001148*                ,:L651-UNMISURA                                   
001149*            FROM DLOGISTI.TSERVIZI                                
001150*           WHERE CODSERVI = :L651-CODSERVI                        
001151*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 9 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CODSERVI
            BY VALUE 0
                     0

           MOVE 10 TO SQL-STMT-ID 
           MOVE 3 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CENCOSTA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-TIPSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-UNMISURA
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 7 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001152                                                                  
001153     IF SQLCODE = 0                                               
001154        MOVE 'U'                 TO PPROUTIN                      
001155        MOVE 'D'                 TO PPTPFILE                      
001156        MOVE 'R'                 TO PPTPOPER                      
001157        MOVE 'SERVIZI'           TO PPNMFILE                      
001158        PERFORM Z90-READPRIN                                      
001159           THRU Z90-EX.                                           
001160                                                                  
001161 L60-EX. EXIT.                                                    
001162*----------------------------------------------------------------*
001163 L70-SELECT-DATARIO.                                              
001164*----------------------------------------------------------------*
001165                                                                  
001166     MOVE 'L70-'                 TO WCOM-CODABEND                 
001167     MOVE 'SELECT'               TO WCOM-FILEFUNZ                 
001168     MOVE 'DATARIO'              TO WCOM-FILENOME                 
001169     MOVE A973-DTGIORNO          TO WCOM-FILECTRL                 
001170                                                                  
001172     
      *EXEC SQL 
      *SELECT DTGIORNO                                         
001173*            INTO :A973-DTGIORNO                                   
001174*            FROM DANAGRAF.TDATARIO                                
001175*           WHERE DTGIORNO = :A973-DTGIORNO                        
001176*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 11 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTGIORNO
            BY VALUE 0
                     0

           MOVE 12 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTGIORNO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 8 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001177                                                                  
001178     IF SQLCODE = 0                                               
001179        MOVE 'U'                 TO PPROUTIN                      
001180        MOVE 'D'                 TO PPTPFILE                      
001181        MOVE 'R'                 TO PPTPOPER                      
001182        MOVE 'DATARIO'           TO PPNMFILE                      
001183        PERFORM Z90-READPRIN                                      
001184           THRU Z90-EX.                                           
001185                                                                  
001186 L70-EX. EXIT.                                                    
001187*----------------------------------------------------------------*
001188 L71-SELECT-DATARIO.                                              
001189*----------------------------------------------------------------*
001190                                                                  
001191     MOVE 'L71-'                 TO WCOM-CODABEND                 
001192     MOVE 'SELECT'               TO WCOM-FILEFUNZ                 
001193     MOVE 'DATARIO'              TO WCOM-FILENOME                 
001194     MOVE WS-ANNOMESE            TO WCOM-FILECTRL                 
001195                                                                  
001197     
      *EXEC SQL 
      *SELECT DTGIORNO                                         
001198*            INTO :A973-DTGIORNO                                   
001199*            FROM DANAGRAF.TDATARIO                                
001200*           WHERE LEFT(DTGIORNO, 6) = :WS-ANNOMESE                 
001201*           FETCH FIRST 1 ROWS ONLY                                
001202*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 13 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-ANNOMESE
            BY VALUE 0
                     0

           MOVE 14 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTGIORNO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 9 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001203                                                                  
001204     IF SQLCODE = 0                                               
001205        MOVE 'U'                 TO PPROUTIN                      
001206        MOVE 'D'                 TO PPTPFILE                      
001207        MOVE 'R'                 TO PPTPOPER                      
001208        MOVE 'DATARIO'           TO PPNMFILE                      
001209        PERFORM Z90-READPRIN                                      
001210           THRU Z90-EX.                                           
001211                                                                  
001212 L71-EX. EXIT.                                                    
001213*----------------------------------------------------------------*
001214 L80-SELECT-DIVISE.                                               
001215*----------------------------------------------------------------*
001216                                                                  
001217     MOVE 'L80-'                 TO WCOM-CODABEND                 
001218     MOVE 'SELECT'               TO WCOM-FILEFUNZ                 
001219     MOVE 'DIVISE'               TO WCOM-FILENOME                 
001220     MOVE SPACES                 TO WCOM-FILECTRL                 
001221     STRING A963-SIGLADIV ' ' A963-CODDIVRI                       
001222     DELIMITED BY SIZE         INTO WCOM-FILECTRL                 
001223                                                                  
001224     MOVE SPACES                 TO A963-CODDIVIS                 
001226     
      *EXEC SQL 
      *SELECT CODDIVIS                                         
001227*            INTO :A963-CODDIVIS                                   
001228*            FROM DANAGRAF.TDIVISE                                 
001229*           WHERE SIGLADIV = :A963-SIGLADIV                        
001230*             AND CODDIVRI = :A963-CODDIVRI                        
001231*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 15 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A963-SIGLADIV
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A963-CODDIVRI
            BY VALUE 0
                     0

           MOVE 16 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A963-CODDIVIS
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 10 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001232                                                                  
001233     IF SQLCODE = 0                                               
001234        MOVE 'U'                 TO PPROUTIN                      
001235        MOVE 'D'                 TO PPTPFILE                      
001236        MOVE 'R'                 TO PPTPOPER                      
001237        MOVE 'DIVISE'            TO PPNMFILE                      
001238        PERFORM Z90-READPRIN                                      
001239           THRU Z90-EX.                                           
001240                                                                  
001241 L80-EX. EXIT.                                                    
001242*----------------------------------------------------------------*
001243 L90-SELECT-LISTILOGI.                                            
001244*----------------------------------------------------------------*
001245                                                                  
001246     MOVE 'L90-'                 TO WCOM-CODABEND                 
001247     MOVE 'SELECT'               TO WCOM-FILEFUNZ                 
001248     MOVE 'LISTILOGI'            TO WCOM-FILENOME                 
001249     MOVE SPACES                 TO WCOM-FILECTRL                 
001250     STRING L654-CODCLIEN ' ' L654-CODSERVI ' ' L654-TIPSERVI     
001251     DELIMITED BY SIZE         INTO WCOM-FILECTRL                 
001252                                                                  
001253     MOVE ZEROS                  TO L654-PREZZLIS                 
001255     
      *EXEC SQL 
      *SELECT PREZZLIS                                         
001256*            INTO :L654-PREZZLIS                                   
001257*            FROM DLOGISTI.TLISTILOGI                              
001258*           WHERE CODCLIEN = :L654-CODCLIEN                        
001259*             AND TIPSERVI = :L654-TIPSERVI                        
001260*             AND CODSERVI = :L654-CODSERVI                        
001261*             AND :WS-DTGIORNO BETWEEN DTINILIS                    
001262*                                  AND DTFINLIS                    
001263*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 17 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODCLIEN
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-TIPSERVI
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODSERVI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DTGIORNO
            BY VALUE 0
                     0

           MOVE 18 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1035 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-PREZZLIS
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 11 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001264                                                                  
001265     IF SQLCODE = 0                                               
001266        MOVE 'U'                 TO PPROUTIN                      
001267        MOVE 'D'                 TO PPTPFILE                      
001268        MOVE 'R'                 TO PPTPOPER                      
001269        MOVE 'LISTILOG'          TO PPNMFILE                      
001270        PERFORM Z90-READPRIN                                      
001271           THRU Z90-EX.                                           
001272                                                                  
001273 L90-EX. EXIT.                                                    
001274*----------------------------------------------------------------*
001275 L100-SELECT-CENCOSTO.                                            
001276*----------------------------------------------------------------*
001277                                                                  
001278     MOVE 'L100-'                TO WCOM-CODABEND                 
001279     MOVE 'SELECT'               TO WCOM-FILEFUNZ                 
001280     MOVE 'CENCOSTO'             TO WCOM-FILENOME                 
001281     MOVE SPACES                 TO WCOM-FILECTRL                 
001282     STRING A982-CODSOCIE ' ' A982-CENCOSTO                       
001283     DELIMITED BY SIZE         INTO WCOM-FILECTRL                 
001284                                                                  
001286     
      *EXEC SQL 
      *SELECT CODSOCIE                                         
001287*            INTO :A982-CODSOCIE                                   
001288*            FROM DANAGRAF.TCENCOSTO                               
001289*           WHERE CODSOCIE = :A982-CODSOCIE                        
001290*             AND CENCOSTO = :A982-CENCOSTO                        
001291*             AND CDDIVISI = :A982-CDDIVISI                        
001292*             AND ANNULLAM = ' '                                   
001293*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 19 TO SQL-STMT-ID 
           MOVE 3 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A982-CODSOCIE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A982-CENCOSTO
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A982-CDDIVISI
            BY VALUE 0
                     0

           MOVE 20 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A982-CODSOCIE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 12 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001294                                                                  
001295     IF SQLCODE = 0                                               
001296        MOVE 'U'                 TO PPROUTIN                      
001297        MOVE 'D'                 TO PPTPFILE                      
001298        MOVE 'R'                 TO PPTPOPER                      
001299        MOVE 'CENCOSTO'          TO PPNMFILE                      
001300        PERFORM Z90-READPRIN                                      
001301           THRU Z90-EX.                                           
001302                                                                  
001303 L100-EX. EXIT.                                                   
001304*----------------------------------------------------------------*
001305 L110-SELECT-CONTIDCE.                                            
001306*----------------------------------------------------------------*
001307                                                                  
001308     MOVE 'L110-'                TO WCOM-CODABEND                 
001309     MOVE 'SELECT'               TO WCOM-FILEFUNZ                 
001310     MOVE 'CONTIDCE'             TO WCOM-FILENOME                 
001311     MOVE SPACES                 TO WCOM-FILECTRL                 
001312     STRING C861-CODPIANO ' ' C861-CONTODCE                       
001313     DELIMITED BY SIZE         INTO WCOM-FILECTRL                 
001314                                                                  
001316     
      *EXEC SQL 
      *SELECT CONTPROV                                         
001317*            INTO :C861-CONTPROV                                   
001318*            FROM DCONTCLI.TCONTIDCE                               
001319*           WHERE CODPIANO = :C861-CODPIANO                        
001320*             AND CONTODCE = :C861-CONTODCE                        
001321*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 21 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CODPIANO
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTODCE
            BY VALUE 0
                     0

           MOVE 22 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTPROV
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 13 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001322                                                                  
001323     IF SQLCODE = 0                                               
001324        MOVE 'U'                 TO PPROUTIN                      
001325        MOVE 'D'                 TO PPTPFILE                      
001326        MOVE 'R'                 TO PPTPOPER                      
001327        MOVE 'CONTODCE'          TO PPNMFILE                      
001328        PERFORM Z90-READPRIN                                      
001329           THRU Z90-EX.                                           
001330                                                                  
001331 L110-EX. EXIT.                                                   
001332*----------------------------------------------------------------*
001333 L120-SELECT-ORDILOGI-ANN.                                        
001334*----------------------------------------------------------------*
001335                                                                  
001336     MOVE 'L120-'                TO WCOM-CODABEND                 
001337     MOVE 'SELECT'               TO WCOM-FILEFUNZ                 
001338     MOVE 'ORDILOGI'             TO WCOM-FILENOME                 
001339     MOVE L652-AANUMORD          TO WCOM-FILECTRL                 
001340                                                                  
001342     
      *EXEC SQL 
      *SELECT A.AANUMORD                                       
001343*            INTO :WS-AANUMOR1                                     
001344*            FROM DLOGISTI.TORDILOGI A                             
001345*           WHERE A.DTANNULL = ' '                                 
001346*             AND A.AANUMORD <>:L652-AANUMORD                      
001347*             AND A.AANUMORD IN                                    
001348*         (SELECT B.AANUMORD                                       
001349*            FROM DLOGISTI.TRIGORDILOGI B                          
001350*                ,DLOGISTI.TRIGORDILOGI C                          
001351*                ,DLOGISTI.TORDILOGI    D                          
001352*           WHERE D.AANUMORD = :L652-AANUMORD                      
001353*             AND D.AANUMORD = C.AANUMORD                          
001354*             AND C.RIFECLIE > ' '                                 
001355*             AND C.RIFECLIE = B.RIFECLIE)                         
001356*           FETCH FIRST 1 ROWS ONLY                                
001357*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 23 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMORD
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMORD
            BY VALUE 0
                     0

           MOVE 24 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-AANUMOR1
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 14 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001358                                                                  
001359     IF SQLCODE = 0                                               
001360        MOVE 'U'                 TO PPROUTIN                      
001361        MOVE 'D'                 TO PPTPFILE                      
001362        MOVE 'R'                 TO PPTPOPER                      
001363        MOVE WCOM-FILENOME       TO PPNMFILE                      
001364        PERFORM Z90-READPRIN                                      
001365           THRU Z90-EX.                                           
001366                                                                  
001367 L120-EX. EXIT.                                                   
001368*----------------------------------------------------------------*
001369 W00-WRITE-SERVIZI.                                               
001370*----------------------------------------------------------------*
001371                                                                  
001372     WRITE REC-SERVIZI FROM FSNET17.                              
001373                                                                  
001374     MOVE   'U'                  TO PPROUTIN.                     
001375     MOVE   'S'                  TO PPTPFILE.                     
001376     MOVE   'A'                  TO PPTPOPER.                     
001377     MOVE   'SERVIZI'            TO PPNMFILE.                     
001378     PERFORM Z90-READPRIN                                         
001379        THRU Z90-EX.                                              
001380                                                                  
001381 W00-EX. EXIT.                                                    
001382*----------------------------------------------------------------*
001383 W10-WRITE-LISTINI.                                               
001384*----------------------------------------------------------------*
001385                                                                  
001386     WRITE REC-LISTINI FROM FSNET16.                              
001387                                                                  
001388     MOVE   'U'                  TO PPROUTIN.                     
001389     MOVE   'S'                  TO PPTPFILE.                     
001390     MOVE   'A'                  TO PPTPOPER.                     
001391     MOVE   'LISTINI'            TO PPNMFILE.                     
001392     PERFORM Z90-READPRIN                                         
001393        THRU Z90-EX.                                              
001394                                                                  
001395 W10-EX. EXIT.                                                    
001396*----------------------------------------------------------------*
001397 W20-WRITE-ORDINI.                                                
001398*----------------------------------------------------------------*
001399                                                                  
001400     WRITE REC-ORDINI FROM FSNET15.                               
001401                                                                  
001402     MOVE   'U'                  TO PPROUTIN.                     
001403     MOVE   'S'                  TO PPTPFILE.                     
001404     MOVE   'A'                  TO PPTPOPER.                     
001405     MOVE   'ORDINI'             TO PPNMFILE.                     
001406     PERFORM Z90-READPRIN                                         
001407        THRU Z90-EX.                                              
001408                                                                  
001409 W20-EX. EXIT.                                                    
001410*----------------------------------------------------------------*
001411 W30-UPDATE-ORDILOGI.                                             
001412*----------------------------------------------------------------*
001413                                                                  
001414     MOVE 'W30-'                 TO WCOM-CODABEND                 
001415     MOVE 'UPDATE'               TO WCOM-FILEFUNZ                 
001416     MOVE 'ORDILOGI'             TO WCOM-FILENOME                 
001417     MOVE L652-AANUMORD          TO WCOM-FILECTRL                 
001418                                                                  
001419     MOVE WS-DTGIORNO            TO L652-DATAESTR                 
001421     
      *EXEC SQL 
      *UPDATE DLOGISTI.TORDILOGI                               
001422*             SET DATAESTR = :L652-DATAESTR                        
001423*           WHERE AANUMORD = :L652-AANUMORD                        
001424*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 25 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DATAESTR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMORD
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 15 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001425                                                                  
001426     IF SQLCODE = 0                                               
001427        MOVE 'U'                 TO PPROUTIN                      
001428        MOVE 'D'                 TO PPTPFILE                      
001429        MOVE 'U'                 TO PPTPOPER                      
001430        MOVE 'ORDILOGI'          TO PPNMFILE                      
001431        PERFORM Z90-READPRIN                                      
001432           THRU Z90-EX                                            
001433     ELSE                                                         
001434        PERFORM Z00-ERRORE                                        
001435           THRU Z00-EX.                                           
001436                                                                  
001437 W30-EX. EXIT.                                                    
001438*----------------------------------------------------------------*
001439 W40-WRITE-ORDIRECU.                                              
001440*----------------------------------------------------------------*
001441                                                                  
001442     IF N15-DATAELAB NOT > ' '                                    
001443        MOVE WS-DTGIORNO         TO N15-DATAELAB                  
001444        MOVE WS-TEMPELAB         TO N15-TEMPELAB.                 
001445                                                                  
001446     WRITE REC-ORDIRECU FROM FSNET15.                             
001447                                                                  
001448     MOVE   'U'                  TO PPROUTIN.                     
001449     MOVE   'S'                  TO PPTPFILE.                     
001450     MOVE   'A'                  TO PPTPOPER.                     
001451     MOVE   'ORDIRECU'           TO PPNMFILE.                     
001452     PERFORM Z90-READPRIN                                         
001453        THRU Z90-EX.                                              
001454                                                                  
001455 W40-EX. EXIT.                                                    
001456*----------------------------------------------------------------*
001457 W50-WRITE-ORDIARCH.                                              
001458*----------------------------------------------------------------*
001459                                                                  
001460     IF N15-DATAELAB NOT > ' '                                    
001461       MOVE WS-DTGIORNO          TO N15-DATAELAB                  
001462       MOVE WS-TEMPELAB          TO N15-TEMPELAB.                 
001463                                                                  
001464     WRITE REC-ORDIARCH FROM FSNET15.                             
001465                                                                  
001466     MOVE   'U'                  TO PPROUTIN.                     
001467     MOVE   'S'                  TO PPTPFILE.                     
001468     MOVE   'A'                  TO PPTPOPER.                     
001469     MOVE   'ORDIARCH'           TO PPNMFILE.                     
001470     PERFORM Z90-READPRIN                                         
001471        THRU Z90-EX.                                              
001472                                                                  
001473 W50-EX. EXIT.                                                    
001474*----------------------------------------------------------------*
001475 W60-SCANUME.                                                     
001476*----------------------------------------------------------------*
001477                                                                  
001478     MOVE 'W60-'                 TO WCOM-CODABEND.                
001479     MOVE 'LETTURA'              TO WCOM-FILEFUNZ.                
001480     MOVE 'SCANUME'              TO WCOM-FILENOME.                
001481     MOVE DCNU-SIGLNUME          TO WCOM-FILECTRL.                
001482                                                                  
001483     MOVE 'SCANUME'              TO  PPCALL.                      
001484     CALL PPCALL  USING  DCPARM  DCNUME.                          
001485     IF DCNU-RISPOSTA NOT = '****'                                
001486        PERFORM Z00-ERRORE                                        
001487           THRU Z00-EX.                                           
001488                                                                  
001489     MOVE   'U'                  TO PPROUTIN.                     
001490     MOVE   'D'                  TO PPTPFILE.                     
001491     MOVE   'R'                  TO PPTPOPER.                     
001492     MOVE   'SCANUME'            TO PPNMFILE.                     
001493     PERFORM Z90-READPRIN                                         
001494        THRU Z90-EX.                                              
001495                                                                  
001496 W60-EX. EXIT.                                                    
001497*----------------------------------------------------------------*
001498 W70-INSERT-ORDILOGI.                                             
001499*----------------------------------------------------------------*
001500                                                                  
001501     MOVE 'W70-'                 TO WCOM-CODABEND                 
001502     MOVE 'INSERT'               TO WCOM-FILEFUNZ                 
001503     MOVE 'ORDILOGI'             TO WCOM-FILENOME                 
001504     MOVE L652-AANUMORD          TO WCOM-FILECTRL                 
001505                                                                  
001507     
      *EXEC SQL 
      *INSERT INTO DLOGISTI.TORDILOGI                          
001508*                (AANUMORD                                         
001509*                ,CODCLIEN                                         
001510*                ,CODSOCIE                                         
001511*                ,CDDIVISI                                         
001512*                ,DTCARORD                                         
001513*                ,CODDIVIS                                         
001514*                ,TIPSERVI                                         
001515*                ,FLAGAUTO                                         
001516*                ,FLAGGIVA                                         
001517*                ,ESENTIVA                                         
001518*                ,CONTODCE                                         
001519*                ,DTEVAORD                                         
001520*                ,DTCREAZI                                         
001521*                ,DTULTVAR                                         
001522*                ,CODUTVAR                                         
001523*                ,SOCIEMER                                         
001524*                ,DATAESTR                                         
001525*                ,AAMMCOMP                                         
001526*                ,FLAGSOSP                                         
001527*                ,CODUTEVB                                         
001528*                ,FLORDIVB)                                        
001529*          VALUES                                                  
001530*                (:L652-AANUMORD                                   
001531*                ,:L652-CODCLIEN                                   
001532*                ,:L652-CODSOCIE                                   
001533*                ,:L652-CDDIVISI                                   
001534*                ,:L652-DTCARORD                                   
001535*                ,:L652-CODDIVIS                                   
001536*                ,:L652-TIPSERVI                                   
001537*                ,:L652-FLAGAUTO                                   
001538*                ,:L652-FLAGGIVA                                   
001539*                ,:L652-ESENTIVA                                   
001540*                ,:L652-CONTODCE                                   
001541*                ,:L652-DTEVAORD                                   
001542*                ,:L652-DTCREAZI                                   
001543*                ,:L652-DTULTVAR                                   
001544*                ,:L652-CODUTVAR                                   
001545*                ,:L652-SOCIEMER                                   
001546*                ,:L652-DATAESTR                                   
001547*                ,:L652-AAMMCOMP                                   
001548*                ,:L652-FLAGSOSP                                   
001549*                ,:L652-CODUTEVB                                   
001550*                ,:L652-FLORDIVB)                                  
001551*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 26 TO SQL-STMT-ID 
           MOVE 21 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMORD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODCLIEN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODSOCIE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CDDIVISI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTCARORD
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODDIVIS
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-TIPSERVI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-FLAGAUTO
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-FLAGGIVA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-ESENTIVA
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CONTODCE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTEVAORD
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTCREAZI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODUTVAR
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-SOCIEMER
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DATAESTR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 17 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AAMMCOMP
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 18 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-FLAGSOSP
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 19 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODUTEVB
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 20 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-FLORDIVB
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 16 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001552     MOVE 'U'                    TO PPROUTIN                      
001553     MOVE 'D'                    TO PPTPFILE                      
001554     MOVE 'A'                    TO PPTPOPER                      
001555     MOVE WCOM-FILENOME          TO PPNMFILE                      
001556     PERFORM Z90-READPRIN                                         
001557        THRU Z90-EX.                                              
001558                                                                  
001559 W70-EX. EXIT.                                                    
001560*----------------------------------------------------------------*
001561 W80-INSERT-RIGORDILOGI.                                          
001562*----------------------------------------------------------------*
001563                                                                  
001564     MOVE 'W80-'                 TO WCOM-CODABEND                 
001565     MOVE 'INSERT'               TO WCOM-FILEFUNZ                 
001566     MOVE 'RIGORDILOGI'          TO WCOM-FILENOME                 
001567     MOVE L653-AANUMORD          TO WCOM-FILECTRL                 
001568                                                                  
001570     
      *EXEC SQL 
      *INSERT INTO DLOGISTI.TRIGORDILOGI                       
001571*                (AANUMORD                                         
001572*                ,NRRIGORD                                         
001573*                ,CODSERVI                                         
001574*                ,UNMISURA                                         
001575*                ,QTAORDIN                                         
001576*                ,PREZZORD                                         
001577*                ,IMPORDIN                                         
001578*                ,CENCOSTD                                         
001579*                ,CENCOSTA                                         
001580*                ,RIFECLIE                                         
001581*                ,DTCREAZI                                         
001582*                ,DTULTVAR                                         
001583*                ,CODUTVAR                                         
001584*                ,NOTENOTE)                                        
001585*          VALUES                                                  
001586*                (:L653-AANUMORD                                   
001587*                ,:L653-NRRIGORD                                   
001588*                ,:L653-CODSERVI                                   
001589*                ,:L653-UNMISURA                                   
001590*                ,:L653-QTAORDIN                                   
001591*                ,:L653-PREZZORD                                   
001592*                ,:L653-IMPORDIN                                   
001593*                ,:L653-CENCOSTD                                   
001594*                ,:L653-CENCOSTA                                   
001595*                ,:L653-RIFECLIE                                   
001596*                ,:L653-DTCREAZI                                   
001597*                ,:L653-DTULTVAR                                   
001598*                ,:L653-CODUTVAR                                   
001599*                ,:L653-NOTENOTE)                                  
001600*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 27 TO SQL-STMT-ID 
           MOVE 14 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-AANUMORD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-NRRIGORD
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CODSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-UNMISURA
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-QTAORDIN
            BY VALUE 0
                     0

           MOVE 1035 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-PREZZORD
            BY VALUE 0
                     0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-IMPORDIN
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CENCOSTD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CENCOSTA
            BY VALUE 0
                     0

           MOVE 15 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-RIFECLIE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-DTCREAZI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CODUTVAR
            BY VALUE 0
                     0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-NOTENOTE
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 17 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001601     MOVE 'U'                    TO PPROUTIN                      
001602     MOVE 'D'                    TO PPTPFILE                      
001603     MOVE 'A'                    TO PPTPOPER                      
001604     MOVE WCOM-FILENOME          TO PPNMFILE                      
001605     PERFORM Z90-READPRIN                                         
001606        THRU Z90-EX.                                              
001607                                                                  
001608 W80-EX. EXIT.                                                    
001609*----------------------------------------------------------------*
001610 W85-INSERT-DETTORDILOGI.                                         
001611*----------------------------------------------------------------*
001612                                                                  
001613     MOVE 'W85-'                 TO WCOM-CODABEND                 
001614     MOVE 'INSERT'               TO WCOM-FILEFUNZ                 
001615     MOVE 'DETTORDILOGI'         TO WCOM-FILENOME                 
001616     MOVE L655-AANUMORD          TO WCOM-FILECTRL                 
001617                                                                  
001619     
      *EXEC SQL 
      *INSERT INTO DLOGISTI.TDETTORDILOGI                      
001620*                (AANUMORD                                         
001621*                ,NRRIGORD                                         
001622*                ,NUMPROG7                                         
001623*                ,CDMCAGTM                                         
001624*                ,CDAREGTM                                         
001625*                ,CDDIPGTM                                         
001626*                ,TIPOADDE                                         
001627*                ,KEYADDE1                                         
001628*                ,KEYADDE2                                         
001629*                ,KEYADDE3                                         
001630*                ,KEYADDE4                                         
001631*                ,UNMISURA                                         
001632*                ,QTAORDIN                                         
001633*                ,IMPORDIN                                         
001634*                ,CENCOSTD                                         
001635*                ,CENCOSTA                                         
001636*                ,CODSOCIA                                         
001637*                ,CDDIVISA                                         
001638*                ,CODSOCID                                         
001639*                ,CDDIVISD                                         
001640*                ,SOCIEMER                                         
001641*                ,TIPOARTI                                         
001642*                ,DTCREAZI                                         
001643*                ,DTULTVAR                                         
001644*                ,CODUTVAR)                                        
001645*          VALUES                                                  
001646*                (:L655-AANUMORD                                   
001647*                ,:L655-NRRIGORD                                   
001648*                ,:L655-NUMPROG7                                   
001649*                ,:L655-CDMCAGTM                                   
001650*                ,:L655-CDAREGTM                                   
001651*                ,:L655-CDDIPGTM                                   
001652*                ,:L655-TIPOADDE                                   
001653*                ,:L655-KEYADDE1                                   
001654*                ,:L655-KEYADDE2                                   
001655*                ,:L655-KEYADDE3                                   
001656*                ,:L655-KEYADDE4                                   
001657*                ,:L655-UNMISURA                                   
001658*                ,:L655-QTAORDIN                                   
001659*                ,:L655-IMPORDIN                                   
001660*                ,:L655-CENCOSTD                                   
001661*                ,:L655-CENCOSTA                                   
001662*                ,:L655-CODSOCIA                                   
001663*                ,:L655-CDDIVISA                                   
001664*                ,:L655-CODSOCID                                   
001665*                ,:L655-CDDIVISD                                   
001666*                ,:L655-SOCIEMER                                   
001667*                ,:L655-TIPOARTI                                   
001668*                ,:L655-DTCREAZI                                   
001669*                ,:L655-DTULTVAR                                   
001670*                ,:L655-CODUTVAR)                                  
001671*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 28 TO SQL-STMT-ID 
           MOVE 25 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-AANUMORD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-NRRIGORD
            BY VALUE 0
                     0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-NUMPROG7
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CDMCAGTM
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CDAREGTM
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CDDIPGTM
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-TIPOADDE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-KEYADDE1
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-KEYADDE2
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-KEYADDE3
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-KEYADDE4
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-UNMISURA
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-QTAORDIN
            BY VALUE 0
                     0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-IMPORDIN
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CENCOSTD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CENCOSTA
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CODSOCIA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 17 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CDDIVISA
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 18 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CODSOCID
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 19 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CDDIVISD
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 20 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-SOCIEMER
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 21 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-TIPOARTI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 22 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-DTCREAZI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 23 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 24 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CODUTVAR
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 18 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001672     MOVE 'U'                    TO PPROUTIN                      
001673     MOVE 'D'                    TO PPTPFILE                      
001674     MOVE 'A'                    TO PPTPOPER                      
001675     MOVE WCOM-FILENOME          TO PPNMFILE                      
001676     PERFORM Z90-READPRIN                                         
001677        THRU Z90-EX.                                              
001678                                                                  
001679 W85-EX. EXIT.                                                    
001680*----------------------------------------------------------------*
001681 Z00-ERRORE.                                                      
001682*----------------------------------------------------------------*
001683                                                                  
001684     MOVE 'M'                    TO PPROUTIN.                     
001685     PERFORM Z90-READPRIN                                         
001686        THRU Z90-EX.                                              
001687                                                                  
001688     MOVE 'SCDB2ER '             TO PPCALL.                       
001689     CALL PPCALL                 USING DCPARM                     
001690                                       DCDB2ER                    
001691                                       SQLCA.                     
001692 Z00-EX. EXIT.                                                    
001693*----------------------------------------------------------------*
001694 Z90-READPRIN.                                                    
001695*----------------------------------------------------------------*
001696                                                                  
001697     MOVE 'READPRIN '            TO PPCALL                        
001698     CALL PPCALL                 USING DCPARM.                    
001699                                                                  
001700 Z90-EX. EXIT.                                                   
