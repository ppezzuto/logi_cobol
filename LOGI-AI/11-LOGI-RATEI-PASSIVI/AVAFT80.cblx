      *((program: AVAFT80.cblx))
000001*-------------* PROGRAMMA BATCH COBOL2 DB2 *---------------------*
000002 ID DIVISION.                                                     
000003*-------------*                                                   
000004 PROGRAM-ID. AVAFT80.                         
000005                                                                  
000006*----------------------------------------------------------------*
000007*                                                                *
000008* ==> ATENZIONE MODIFICATO PER OPLA                              *
000009*                                                                *
000010* IL PROGRAMMA CREA IL FILE PER I RATEI RELATIVI ALLE SPESE      *
000011* DI TRASPORTO. IL FILE VIENE CREATO  A PARTITE DALLA            *
000012* TNETMOVEREXPO E SERVE PER IL GIRO DEGLI ADDEBITI.              *
000013*----------------------------------------------------------------*
000014 ENVIRONMENT DIVISION.                                            
000015*---------------------*                                           
000016 CONFIGURATION SECTION.                                           
000017 SPECIAL-NAMES.                                                   
000018     DECIMAL-POINT IS COMMA.                                      
000019                                                                  
000020 INPUT-OUTPUT SECTION.                                            
000021 FILE-CONTROL.                                                    
000022     SELECT  RATEINP  ASSIGN UT-S-RATEINP.                        
000023                                                                  
000024 DATA DIVISION.                                                   
000025*--------------*                                                  
000026 FILE SECTION.                                                    
000027 FD  RATEINP                                                      
000028     RECORDING MODE IS F                                          
000029     BLOCK CONTAINS  0 RECORDS.                                   
000030 01  REC-RATEINP                 PIC X(120).                      
000031                                                                  
000032 WORKING-STORAGE SECTION.

       01  SQLDA-ID pic 9(4) comp-5.
       01  SQLDSIZE pic 9(4) comp-5.
       01  SQL-STMT-ID pic 9(4) comp-5.
       01  SQLVAR-INDEX pic 9(4) comp-5.
       01  SQL-DATA-TYPE pic 9(4) comp-5.
       01  SQL-HOST-VAR-LENGTH pic 9(9) comp-5.
       01  SQL-S-HOST-VAR-LENGTH pic 9(9) comp-5.
       01  SQL-S-LITERAL pic X(258).
       01  SQL-LITERAL1 pic X(130).
       01  SQL-LITERAL2 pic X(130).
       01  SQL-LITERAL3 pic X(130).
       01  SQL-LITERAL4 pic X(130).
       01  SQL-LITERAL5 pic X(130).
       01  SQL-LITERAL6 pic X(130).
       01  SQL-LITERAL7 pic X(130).
       01  SQL-LITERAL8 pic X(130).
       01  SQL-LITERAL9 pic X(130).
       01  SQL-LITERAL10 pic X(130).
       01  SQL-IS-LITERAL pic 9(4) comp-5 value 1.
       01  SQL-IS-INPUT-HVAR pic 9(4) comp-5 value 2.
       01  SQL-CALL-TYPE pic 9(4) comp-5.
       01  SQL-SECTIONUMBER pic 9(4) comp-5.
       01  SQL-INPUT-SQLDA-ID pic 9(4) comp-5.
       01  SQL-OUTPUT-SQLDA-ID pic 9(4) comp-5.
       01  SQLA-PROGRAM-ID.
           05 SQL-PART1 pic 9(4) COMP-5 value 172.
           05 SQL-PART2 pic X(6) value "AEAQAI".
           05 SQL-PART3 pic X(24) value "YBJ2MfMo01111 2         ".
           05 SQL-PART4 pic 9(4) COMP-5 value 8.
           05 SQL-PART5 pic X(8) value "DB2XMT  ".
           05 SQL-PART6 pic X(120) value LOW-VALUES.
           05 SQL-PART7 pic 9(4) COMP-5 value 8.
           05 SQL-PART8 pic X(8) value "AVAFT80 ".
           05 SQL-PART9 pic X(120) value LOW-VALUES.
                                                                        
000033 01  FILLER                      PIC X(8)  VALUE '*DCPARM*'.      
000034*    COPY DCPARM.                                                 
      *>>((file: DCPARM))
000001***************************************************************** 
000002*******                                                         * 
000003*******       A R E A   P A R A M E T R I C A       *COBOL*     * 
000004*******                                                         * 
000005***************************************************************** 
000006 01  DCPARM.                                                      
000007*******  PPNAME   = NOME PROGRAMMA                                
000008     02  PPNAME           PIC X(8)    VALUE SPACES.               
000009*******  PPROUTIN = ROUTINE DA ESEGUIRE                           
000010     02  PPROUTIN         PIC X       VALUE SPACES.               
000011     02  PPSTAT           PIC X(4)    VALUE SPACES.               
000012*******  PPNUSK   = NUMERO DI SCHEDE X LA FUNZIONE -N-            
000013     02  PPNUSK           PIC X(2)    VALUE SPACES.               
000014     02  PPFIRST          PIC X       VALUE SPACES.               
000015*******                                                           
000016*********************** SKEDE PARAMETRO - MAX 10 **************** 
000017*******                                                           
000018     02  SK-PARM.                                                 
000019         05  PPSK1            PIC X(80)   VALUE SPACES.           
000020         05  PPSK2            PIC X(80)   VALUE SPACES.           
000021         05  PPSK3            PIC X(80)   VALUE SPACES.           
000022         05  PPSK4            PIC X(80)   VALUE SPACES.           
000023         05  PPSK5            PIC X(80)   VALUE SPACES.           
000024         05  PPSK6            PIC X(80)   VALUE SPACES.           
000025         05  PPSK7            PIC X(80)   VALUE SPACES.           
000026         05  PPSK8            PIC X(80)   VALUE SPACES.           
000027         05  PPSK9            PIC X(80)   VALUE SPACES.           
000028         05  PPSK10           PIC X(80)   VALUE SPACES.           
000029         05  PPSK11           PIC X(80)   VALUE SPACES.           
000030     02  TAB-SK-PARM REDEFINES SK-PARM.                           
000031         05  EL-SK-PARM OCCURS 11 TIMES.                          
000032             10  NAME-SK-PARM     PIC XX.                         
000033             10  FILLER           PIC X.                          
000034             10  DATA-SK-PARM     PIC X(77).                      
000035*******                                                           
000036*********************** ELEMENTO DI RICERCA ********************* 
000037*******                                                           
000038*******  PPNMFILE  = NOME FILE                                    
000039     02  PPNMFILE         PIC X(7)    VALUE SPACES.               
000040*******  PPTPFILE  = TIPO FILE                                    
000041     02  PPTPFILE         PIC X(1)    VALUE SPACES.               
000042*******  PPTPOPER  = TIPO OPERAZIONE                              
000043     02  PPTPOPER         PIC X(1)    VALUE SPACES.               
000044     02  FILLER           PIC X(7)    VALUE SPACES.               
000045*******                                                           
000046*********************** TABELLA DI 30 ELEMENTI ****************** 
000047*******                                                           
000048     02  TAB-CONTATORI.                                           
000049         05  EL-CONTATORI OCCURS 30 TIMES.                        
000050             10  EL-PPNMFILE      PIC X(7)        VALUE SPACES.   
000051             10  EL-PPTPFILE      PIC X           VALUE SPACES.   
000052             10  EL-PPTPOPER      PIC X           VALUE SPACES.   
000053             10  EL-CONTATOR      PIC 9(9) COMP-3 VALUE ZEROES.   
000054             10  EL-FILLER        PIC XX          VALUE SPACES.   
000055*    02  FILLER           PIC X(7)     VALUE SPACES.              
000056*******              TIPO FILE                                    
000057*    02  FILLER           PIC X(1)     VALUE SPACES.              
000058*******              TIPO OPERAZIONE                              
000059*    02  FILLER           PIC X(1)     VALUE SPACES.              
000060*******              NUMERO OPERAZIONI                            
000061*    02  FILLER           PIC 9(9)     COMP-3    VALUE ZERO.      
000062*    02  FILLER           PIC X(2)     VALUE SPACES.              
000063*******  29 CAMPI DA 16 BYTES, IN TOTALE 464 BYTES                
000064*    02  FILLER           PIC X(464)   VALUE SPACES.              
000065*******                                                           
000066*********************** STAMPA MESSAGGI ************************* 
000067*******                                                           
000068*******  PPMESSAG  = MESSAGGIO DA STAMPARE                        
000069     02  PPMESSAG         PIC X(132)  VALUE SPACES.               
000070     02  FILLER           PIC X(4)    VALUE SPACES.               
000071*******                                                           
000072*********************** DATE DA TABE TABPRODA ******************* 
000073*******                                                           
000074*******  DATA-PROG = NOME ELEMENTO DI TABE TABPRODA               
000075     02  DATA-PROG        PIC X(7)    VALUE SPACES.               
000076*******  DATA-TIPO = TIPO DI DATA  DI TABE TABPRODA               
000077     02  DATA-TIPO        PIC X       VALUE SPACES.               
000078*******  DATA-INIZ = DATA INIZIO PERIODO                          
000079     02  DATA-INIZ.                                               
000080         05  GG-INIZ.                                             
000081             10  SS-CORSO PIC XX      VALUE SPACES.               
000082         05  MM-INIZ      PIC XX      VALUE SPACES.               
000083         05  AA-INIZ      PIC XX      VALUE SPACES.               
000084*******  DATA-FINE = DATA FINE PERIODO                            
000085     02  DATA-FINE.                                               
000086         05  GG-FINE      PIC XX      VALUE SPACES.               
000087         05  MM-FINE      PIC XX      VALUE SPACES.               
000088         05  AA-FINE      PIC XX      VALUE SPACES.               
000089     02  FILLER           PIC X(4)    VALUE SPACES.               
000090*******                                                           
000091*********************** CALL GENERALIZZATA ********************** 
000092*******                                                           
000093*******  PPCALL    = NOME MODULO X CALLER                         
000094     02  PPCALL           PIC X(8)    VALUE SPACES.               
000095*******                                                           
000096***************************************************************** 
000097*  EJECT                                                          
      *<<((file: DCPARM))
000035 01  FILLER                      PIC X(8)  VALUE 'DCDB2ER*'.      
000036*    COPY DCDB2ER.                                                
      *>>((file: DCDB2ER))
000001******************************************************************
000002*****               AREA PER MODULO SCDB2ER                  *****
000003******************************************************************
000004 01  DCDB2ER.                                                     
000005     02 WCOM-LUNGHEZZ         PIC S9(3) COMP-3 VALUE +171.        
000006     02 WCOM-FILEFUNZ         PIC X(10).                          
000007     02 WCOM-FILENOME         PIC X(30).                          
000008     02 WCOM-FILECTRL         PIC X(30).                          
000009     02 WCOM-MESSAGES         PIC X(80).                          
000010     02 WCOM-CODABEND         PIC X(4).                           
000011     02 MESS-CODERROR         PIC X(6).                           
000012     02 WSWERROR              PIC X.                              
000013        88 ERRORE             VALUE '*'.                          
000014     02 WCOM-PROGNAME         PIC X(8).                           
      *<<((file: DCDB2ER))
000037 01  FILLER                      PIC X(8)  VALUE 'DCWDTEL*'.      
000038*    COPY DCWDTEL.                                                
      *>>((file: DCWDTEL))
000001***************************************************************** 
000002******         AREA PASSAGGIO CHIAMATA                     ****** 
000003******             MODULO  SCTDTEL (LENGTH 100)            ****** 
000004***************************************************************** 
000005 01  DCWDTEL.                                                     
000006*                         ZEROES SE OK  ALTRIMENTI SQLCODE        
000007     05 DTEL-RETCOD              PIC S9(3).                       
000008*                         R = LETTURA   U = AGGIORNAMENTO         
000009     05 DTEL-TIPORICH            PIC X.                           
000010     05 DTEL-SIGLDATA            PIC X(8).                        
000011*         G=AAAAAAA   S=SETTIMA   M=MENSILE   A=ANNUALE   W=WEEK  
000012     05 DTEL-DATATIPO            PIC X(1).                        
000013*                                                                 
000014     05 DTEL-DTINELAB            PIC X(8).                        
000015     05 DTEL-TMINELAB            PIC X(6).                        
000016     05 DTEL-DTFIELAB            PIC X(8).                        
000017     05 DTEL-TMFIELAB            PIC X(6).                        
000018     05 FILLER                   PIC X(59).                       
      *<<((file: DCWDTEL))
000039 01  FILLER                      PIC X(8)  VALUE 'DCWCAMB*'.      
000040*    COPY DCWCAMB.                                                
      *>>((file: DCWCAMB))
000001******************************************************************
000002******              AREA PASSAGGIO CHIAMATA                 ******
000003******         MODULI SCTCB05, SCBCB05, SCTCB10 E SCBCB10   ******
000004******         LENGTH -250-                                 ******
000005******                                                      ******
000006******   DATI-INPUT                                         ******
000007******         DA : CAMB-SIGLADIV                           ******
000008******          A   CAMB-SIGLACAM                           ******
000009******        OPPURE                                        ******
000010******         DA : CAMB-CODDIVIS                           ******
000011******          A   CAMB-CODCAMBI                           ******
000012******        OPPURE                                        ******
000013******         DA : CAMB-CODDIVIS                           ******
000014******          A   CAMB-SIGLACAM                           ******
000015******        OPPURE                                        ******
000016******         DA : CAMB-SIGLADIV                           ******
000017******          A   CAMB-CODCAMBI                           ******
000018******************************************************************
000019 01  DCWCAMB.                                                     
000020   02  CAMB-DATI-INPUT.                                           
000021     03  CAMB-DATI-COMUNI.                                        
000022       05  CAMB-SIGLACAM            PIC X(3).                     
000023       05  CAMB-SIGLADIV            PIC X(3).                     
000024       05  CAMB-CODCAMBI            PIC X(2).                     
000025       05  CAMB-CODDIVIS            PIC X(2).                     
000026       05  CAMB-IMPORTOO OCCURS 5   PIC S9(11)V99.                
000027       05  CAMB-DTCAMBIO            PIC X(8).                     
000028       05  CAMB-SOCIRIFE            PIC X(2).                     
000029       05  CAMB-CODDRIFE            PIC X(2).                     
000030       05  CAMB-SIGLRIFE            PIC X(3).                     
000031       05  FILLER                   PIC X(23).                    
000032   02  CAMB-DATI-OUTPUT.                                          
000033     03  CAMB-DATI-SIGLACAM.                                      
000034       05  CAMB-CAMBCAMB            PIC S9(9)V9999 COMP-3.        
000035       05  CAMB-DESCCAMB            PIC X(20).                    
000036       05  CAMB-DECICAMB            PIC X.                        
000037       05  CAMB-CAMBBANC            PIC X(3).                     
000038       05  CAMB-CAMBPREZ            PIC X.                        
000039     03  CAMB-DATI-SIGLADIV.                                      
000040       05  FILLER                   PIC X(7).                     
000041       05  CAMB-DESCDIVI            PIC X(20).                    
000042       05  CAMB-DECIDIVI            PIC X.                        
000043       05  CAMB-DIVIBANC            PIC X(3).                     
000044       05  CAMB-DIVIPREZ            PIC X.                        
000045     03  CAMB-CONTROVA OCCURS 5     PIC S9(11)V99  COMP-3.        
000046     03  CAMB-RAPPCAMB              PIC S9(5)      COMP-3.        
000047     03  CAMB-RAPPDIVI              PIC S9(5)      COMP-3.        
000048     03  CAMB-CAMBIODV              PIC S9(7)V9(6) COMP-3.        
000049     03  CAMB-CAMBDV10              PIC S9(5)V9(10) COMP-3.       
000050     03  FILLER                     PIC X(13).                    
000051     03  CAMB-RETCOD                PIC X(4).                     
      *<<((file: DCWCAMB))
000041 01  FILLER                      PIC X(8)  VALUE 'DCNUME**'.      
000042*    COPY DCNUME.                                                 
      *>>((file: DCNUME))
000001******************************************************************
000002*                       ***  DCNUME  ***                         *
000003*   PARAMETRI PER LA LETTURA E L'AGGIORNAMENTO DELLA TABELLA     *
000004*   DB2   'TNUMEAUTO'.                                           *
000005*   LUNGHEZZA = 100                                              *
000006******************************************************************
000007*                                                                *
000008 01  DCNUME.                                                      
000009     05  DCNU-RISPOSTA                    PIC X(04).              
000010     05  DCNU-FLAGOPER                    PIC X(01).              
000011*                                                                *
000012     05  DCNU-SIGLNUME                    PIC X(08).              
000013     05  DCNU-NUMEAUTO                    PIC X(09).              
000014     05  DCNU-NUMERIPR                    PIC X(09).              
000015     05  DCNU-DESCNUME                    PIC X(21).              
000016     05  DCNU-NUMERIP1                    PIC X(09).              
000017     05  DCNU-FILLER39                    PIC X(39).              
000018                                                                  
000019******************************************************************
000020                                                                  
      *<<((file: DCNUME))
000043 01  FILLER                      PIC X(8)  VALUE 'FSNET18*'.      
000044*    COPY FSNET18.                                                
      *>>((file: FSNET18))
000001******************************************************************
000002** -LOGISTAICA                                                  **
000003** -TRASMISSIONE RATEI SOCIETA 22A (RELATIIV A SPEDIZIONI VB)   **
000004** -DA TESI A TEXTILE                                           **
000005**  LUNGHEZZA    --> 120                                        **
000006******************************************************************
000007 01  FSNET18.                                                     
000008     05 N18-ANAGSEND              PIC X(20).                      
000009     05 N18-CONTODCE              PIC X(15).                      
000010     05 N18-CENCOTRA              PIC X(15).                      
000011     05 N18-SIGLADIV              PIC X(03).                      
000012     05 N18-IMPOADDE              PIC 9(09)V9(2).                 
000013     05 N18-DATAINIZ              PIC X(08).                      
000014     05 N18-DATAFINE              PIC X(08).                      
000015     05 N18-ANAGRECE              PIC X(20).                      
000016     05 N18-ANAGPROP              PIC X(20).                      
      *<<((file: FSNET18))
000045                                                                  
000046 01  FILLER                      PIC X(8)  VALUE 'SK-PARAM'.      
000047 01  SKEDA.                                                       
000048     05 SK-PARAM.                                                 
000049        10 SK-TIPOELAB           PIC X(01).                       
000050        10 FILLER                PIC X(79).                       
000051                                                                  
000052 01  FILLER                      PIC X(8)  VALUE '*COMODI*'.      
000053 01  COMODI.                                                      
000054     05 WS-AANUMFAT              PIC X(20).                       
000055     05 WS-TIPORECO              PIC X(04).                       
000056     05 WS-CODSOCIE              PIC X(02).                       
000057     05 WS-CENCOSTO              PIC X(05).                       
000058     05 WS-CENCOTRA              PIC X(05).                       
000059     05 WS-SOCIEFAT              PIC X(02).                       
000060     05 WS-CONTODCE              PIC X(06).                       
000061     05 WS-IMPTRLIS              PIC S9(9)V99 COMP-3.             
000062     05 WS-IMPTRPAG              PIC S9(9)V99 COMP-3.             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000063     05 WS-SOCICONS              PIC X(02).                       
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000064     05 WS-NUMEAUTO.                                              
000065        10 WS-FATTURA.                                            
000066           15 WS-FILLER          PIC X(01).                       
000067           15 WS-FATTUR7         PIC 9(07).                       
000068        10 WS-FILLER             PIC X(01).                       
000069     05 WS-SQLCODE               PIC S9(5)    COMP-3.             
000070     05 WS-INIZANNO              PIC X(8)  VALUE SPACES.          
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000071     05 WS-INIZMESE              PIC X(8)  VALUE SPACES.          
000072     05 WS-FINEMESE              PIC X(8)  VALUE SPACES.          
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000073     05 WS-DTGIORNO              PIC X(8)  VALUE SPACES.          
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000074     05 WS-CURRDATE              PIC X(8)  VALUE SPACES.          
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000075     05 EOF                      PIC X(1)  VALUE SPACES.          
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000076     05 WS-TIPOELAB-1            PIC X(3)  VALUE SPACES.          
000077     05 WS-TIPOELAB-2            PIC X(3)  VALUE SPACES.          
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000078     05 WS-ESTRAI                PIC X(1)  VALUE SPACES.          
000079     05 WS-CODFOMER              PIC X(5)  VALUE SPACES.          
000080                                                                  
000081*------------------------------- DADDEBIT.TRATEINM                
000082 01  FILLER                      PIC X(8) VALUE 'FDADD203'.       
000083*    EXEC SQL INCLUDE FDADD203 END-EXEC.                          
      *>>((file: FDADD203))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DADDEBIT.TRATEINM                  *
000003******************************************************************
000004 01  DCLTRATEINM.                                                 
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 A203-ANNOMESE        PIC X(6).                            
000006     10 A203-CDMCAGTM        PIC X(1).                            
000007     10 A203-CDAREGTM        PIC X(2).                            
000008     10 A203-CDDIPGTM        PIC X(1).                            
000009     10 A203-TIPOADDE        PIC X(2).                            
000010     10 A203-KEYADDE1        PIC X(5).                            
000011     10 A203-KEYADDE2        PIC X(3).                            
000012     10 A203-KEYADDE3        PIC X(3).                            
000013     10 A203-KEYADDE4        PIC X(5).                            
000014     10 A203-SOCIEFAT        PIC X(2).                            
000015     10 A203-DIVIFATT        PIC X(1).                            
000016     10 A203-CODFORNI        PIC X(5).                            
000017     10 A203-CODSOCIE        PIC X(2).                            
000018     10 A203-DIVIPROP        PIC X(1).                            
000019     10 A203-AANUMFAT        PIC X(20).                           
000020     10 A203-DTFATTUR        PIC X(8).                            
000021     10 A203-TIPORECO        PIC X(4).                            
000022     10 A203-CODFOMER        PIC X(5).                            
000023     10 A203-NUMPROG5        PIC S9(5) COMP-3.                    
000024     10 A203-MERCEMAG        PIC X(2).                            
000025     10 A203-PROLOMER        PIC X(2).                            
000026     10 A203-CODLINEA        PIC X(2).                            
000027     10 A203-CENCOTRA        PIC X(5).                            
000028     10 A203-CENCOSTO        PIC X(5).                            
000029     10 A203-CONTODCE        PIC X(6).                            
000030     10 A203-CODDIVIS        PIC X(2).                            
000031     10 A203-IMPCOSTO        PIC S9(9)V9(2) USAGE COMP-3.         
000032     10 A203-NRPREFAT        PIC X(10).                           
000033     10 A203-DTPREFAT        PIC X(8).                            
000034     10 A203-STPREFAT        PIC X(1).                            
000035     10 A203-NRDOCCOT        PIC X(10).                           
000036     10 A203-DTSPEDIZ        PIC X(8).                            
000037     10 A203-DTCREAZI        PIC X(8).                            
000038     10 A203-DTULTVAR        PIC X(8).                            
000039     10 A203-CODUTVAR        PIC X(6).                            
000040     10 A203-TIPOELAB        PIC X(4).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000041******************************************************************
000042* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 33      *
000043******************************************************************
      *<<((file: FDADD203))
000084*------------------------------- DANAGRAF.TPAESI                  
000085 01  FILLER                      PIC X(8) VALUE 'FDANA528'.       
000086*    EXEC SQL INCLUDE FDANA528 END-EXEC.                          
      *>>((file: FDANA528))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TPAESI                    *
000003******************************************************************
000004 01  DCLTPAESI.                                                   
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 A528-CODPAESE        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000006     10 A528-CODILING        PIC X(1).                            
000007     10 A528-PAESBANC        PIC X(3).                            
000008     10 A528-PAESEISO        PIC X(2).                            
000009     10 A528-FLPAECEE        PIC X(1).                            
000010     10 A528-FLPAEORI        PIC X(1).                            
000011     10 A528-DTCREAZI        PIC X(8).                            
000012     10 A528-DTULTVAR        PIC X(8).                            
000013     10 A528-CODUTVAR        PIC X(6).                            
000014     10 A528-SLPAEGTM        PIC X(3).                            
000015     10 A528-PRFINTER        PIC X(5).                            
000016     10 A528-GRUPPAES        PIC X(2).                            
000017     10 A528-CDMCAREG        PIC X(2).                            
000018     10 A528-CDAREREG        PIC X(2).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000019     10 A528-CDRAGCEN        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000020     10 A528-CDRAGTRA        PIC X(2).                            
000021     10 A528-CDRAGFOC        PIC X(2).                            
000022     10 A528-CODPAGVB        PIC X(3).                            
000023     10 A528-SIGPAGVB        PIC X(2).                            
000024     10 A528-CODPARUS        PIC X(3).                            
000025     10 A528-CDRAGLIS        PIC X(2).                            
000026     10 A528-CDRAGSTA        PIC X(2).                            
000027     10 A528-CDRAGLIC        PIC X(2).                            
000028     10 A528-CDRAGLIF        PIC X(2).                            
000029******************************************************************
000030* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 24      *
000031******************************************************************
      *<<((file: FDANA528))
000087*------------------------------- DANAGRAF.TSOCIETA                
000088 01  FILLER                      PIC X(8) VALUE 'FDANA531'.       
000089*    EXEC SQL INCLUDE FDANA531 END-EXEC.                          
      *>>((file: FDANA531))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TSOCIETA                  *
000003******************************************************************
000004 01  DCLTSOCIETA.                                                 
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 A531-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000006     10 A531-NOMSOCIE        PIC X(23).                           
000007     10 A531-CODFORNI        PIC X(5).                            
000008     10 A531-TASSINTE        PIC S9(3)V9(2) USAGE COMP-3.         
000009     10 A531-CODPAESE        PIC X(3).                            
000010     10 A531-NRGGRISC        PIC S9(3)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000011     10 A531-CODPIANO        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000012     10 A531-CITTASOC        PIC X(18).                           
000013     10 A531-FLPAGIVA        PIC X(1).                            
000014     10 A531-FLFATACQ        PIC X(1).                            
000015     10 A531-CODAZIEN        PIC X(5).                            
000016     10 A531-FLIVATRA        PIC X(1).                            
000017     10 A531-CODDIVIS        PIC X(2).                            
000018     10 A531-COSTINTE        PIC S9(3)V9(2) USAGE COMP-3.         
000019     10 A531-FLCONTAB        PIC X(1).                            
000020     10 A531-FLAGMAGA        PIC X(1).                            
000021     10 A531-RAGSOCIE        PIC X(50).                           
000022     10 A531-SOCIECON        PIC X(2).                            
000023     10 A531-DTCREAZI        PIC X(8).                            
000024     10 A531-DTULTVAR        PIC X(8).                            
000025     10 A531-CODUTVAR        PIC X(6).                            
000026     10 A531-INDLEGAL        PIC X(35).                           
000027     10 A531-CAPLEGAL        PIC X(5).                            
000028     10 A531-CITLEGAL        PIC X(18).                           
000029     10 A531-CODFISCA        PIC X(16).                           
000030     10 A531-CODDIVRI        PIC X(2).                            
000031     10 A531-SOCIEGTM        PIC X(2).                            
000032     10 A531-GENEFATT        PIC X(1).                            
000033     10 A531-FLAGATTI        PIC X(1).                            
000034     10 A531-DIVISOLD        PIC X(2).                            
000035     10 A531-DTFINOLD        PIC X(8).                            
000036     10 A531-DIVRIOLD        PIC X(2).                            
000037     10 A531-DIVIRIFA        PIC X(2).                            
000038     10 A531-FLEURUSA        PIC X(1).                            
000039     10 A531-FLAGLIMI        PIC X(1).                            
000040     10 A531-FLFILIAL        PIC X(1).                            
000041     10 A531-FLPRESEN        PIC X(1).                            
000042     10 A531-CODSOCPA        PIC X(1).                            
000043     10 A531-FLBOLGVB        PIC X(1).                            
000044     10 A531-FLSTCART        PIC X(1).                            
000045     10 A531-FLDIPEST        PIC X(1).                            
000046     10 A531-CODFIRMA        PIC X(8).                            
000047     10 A531-DESFIRMA        PIC X(24).                           
000048     10 A531-CDSOCJDE        PIC X(5).                            
000049     10 A531-CODFORNV        PIC X(5).                            
000050     10 A531-CODFORNA        PIC X(5).                            
000051     10 A531-IMPCCASO        PIC S9(13) COMP-3.                   
000052     10 A531-TRIBCCIA        PIC X(10).                           
000053     10 A531-PROLEGAL        PIC X(2).                            
000054     10 A531-FLSOCSAP        PIC X(1).                            
000055     10 A531-DIVIXLAV        PIC X(2).                            
000056******************************************************************
000057* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 51      *
000058******************************************************************
      *<<((file: FDANA531))
000090*------------------------------- DANAGRAF.TCLIENTI                
000091 01  FILLER                      PIC X(8) VALUE 'FDANA901'.       
000092*    EXEC SQL INCLUDE FDANA901 END-EXEC.                          
      *>>((file: FDANA901))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TCLIENTI                  *
000003******************************************************************
000004 01  DCLTCLIENTI.                                                 
000005*                       CODCLIEN                                  
000006     10 A901-CODCLIEN        PIC X(5).                            
000007*                       STATCLIE                                  
000008     10 A901-STATCLIE        PIC X(1).                            
000009*                       GENECLIE                                  
000010     10 A901-GENECLIE        PIC X(1).                            
000011*                       TIPOCLIE                                  
000012     10 A901-TIPOCLIE        PIC X(1).                            
000013*                       TIPOCONS                                  
000014     10 A901-TIPOCONS        PIC X(1).                            
000015*                       CLIFOCON                                  
000016     10 A901-CLIFOCON        PIC X(5).                            
000017*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000018     10 A901-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000019*                       CAPOCONT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000020     10 A901-CAPOCONT        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000021*                       CODFISCA                                  
000022     10 A901-CODFISCA        PIC X(16).                           
000023*                       ESENTIVA                                  
000024     10 A901-ESENTIVA        PIC X(1).                            
000025*                       NUMESIVA                                  
000026     10 A901-NUMESIVA        PIC X(5).                            
000027*                       DATESIVA                                  
000028     10 A901-DATESIVA        PIC X(8).                            
000029*                       UFFICIVA                                  
000030     10 A901-UFFICIVA        PIC X(18).                           
000031*                       IMPESIVA                                  
000032     10 A901-IMPESIVA        PIC S9(4)V USAGE COMP-3.             
000033*                       BANCAPPO                                  
000034     10 A901-BANCAPPO        PIC X(3).                            
000035*                       NOMBANCL                                  
000036     10 A901-NOMBANCL        PIC X(114).                          
000037*                       CONTOCOR                                  
000038     10 A901-CONTOCOR        PIC X(13).                           
000039*                       ASSOBANC                                  
000040     10 A901-ASSOBANC        PIC X(5).                            
000041*                       AVVIBANC                                  
000042     10 A901-AVVIBANC        PIC X(5).                            
000043*                       CLIEFATT                                  
000044     10 A901-CLIEFATT        PIC X(5).                            
000045*                       PAESFATT                                  
000046     10 A901-PAESFATT        PIC X(3).                            
000047*                       RAGFATTU                                  
000048     10 A901-RAGFATTU        PIC X(24).                           
000049*                       ESRAGFAT                                  
000050     10 A901-ESRAGFAT        PIC X(24).                           
000051*                       INDFATTU                                  
000052     10 A901-INDFATTU        PIC X(24).                           
000053*                       ESINDFAT                                  
000054     10 A901-ESINDFAT        PIC X(24).                           
000055*                       CITFATTU                                  
000056     10 A901-CITFATTU        PIC X(18).                           
000057*                       ESCITFAT                                  
000058     10 A901-ESCITFAT        PIC X(18).                           
000059*                       CAPFATTU                                  
000060     10 A901-CAPFATTU        PIC X(5).                            
000061*                       PAESMERC                                  
000062     10 A901-PAESMERC        PIC X(3).                            
000063*                       RAGMERCE                                  
000064     10 A901-RAGMERCE        PIC X(24).                           
000065*                       ESRAGMER                                  
000066     10 A901-ESRAGMER        PIC X(24).                           
000067*                       INDMERCE                                  
000068     10 A901-INDMERCE        PIC X(24).                           
000069*                       ESINDMER                                  
000070     10 A901-ESINDMER        PIC X(24).                           
000071*                       CITMERCE                                  
000072     10 A901-CITMERCE        PIC X(18).                           
000073*                       ESCITMER                                  
000074     10 A901-ESCITMER        PIC X(18).                           
000075*                       CAPMERCE                                  
000076     10 A901-CAPMERCE        PIC X(5).                            
000077*                       ZONAMERC                                  
000078     10 A901-ZONAMERC        PIC X(2).                            
000079*                       TELCLIEN                                  
000080     10 A901-TELCLIEN        PIC X(20).                           
000081*                       TLXCLIEN                                  
000082     10 A901-TLXCLIEN        PIC X(20).                           
000083*                       FAXCLIEN                                  
000084     10 A901-FAXCLIEN        PIC X(20).                           
000085*                       RIFEMIRO                                  
000086     10 A901-RIFEMIRO        PIC X(11).                           
000087*                       PAESORDI                                  
000088     10 A901-PAESORDI        PIC X(3).                            
000089*                       ZONAORDI                                  
000090     10 A901-ZONAORDI        PIC X(2).                            
000091*                       DATVASTA                                  
000092     10 A901-DATVASTA        PIC X(8).                            
000093*                       ATTENZDI                                  
000094     10 A901-ATTENZDI        PIC X(24).                           
000095*                       CONDPAGA                                  
000096     10 A901-CONDPAGA        PIC X(3).                            
000097*                       MMESCLU1                                  
000098     10 A901-MMESCLU1        PIC S9(2)V USAGE COMP-3.             
000099*                       MMESCLU2                                  
000100     10 A901-MMESCLU2        PIC S9(2)V USAGE COMP-3.             
000101*                       GGSCATRA                                  
000102     10 A901-GGSCATRA        PIC S9(2)V USAGE COMP-3.             
000103*                       NUMGGVIA                                  
000104     10 A901-NUMGGVIA        PIC S9(2)V USAGE COMP-3.             
000105*                       TIPOTRAT                                  
000106     10 A901-TIPOTRAT        PIC X(1).                            
000107*                       ALTERSPE                                  
000108     10 A901-ALTERSPE        PIC X(1).                            
000109*                       CODILING                                  
000110     10 A901-CODILING        PIC X(1).                            
000111*                       DTULTVAR                                  
000112     10 A901-DTULTVAR        PIC X(8).                            
000113*                       TIPCLCAR                                  
000114     10 A901-TIPCLCAR        PIC X(1).                            
000115*                       SPETRASP                                  
000116     10 A901-SPETRASP        PIC X(1).                            
000117*                       DTCREAZI                                  
000118     10 A901-DTCREAZI        PIC X(8).                            
000119*                       CODDIVIS                                  
000120     10 A901-CODDIVIS        PIC X(2).                            
000121*                       CDIVACEE                                  
000122     10 A901-CDIVACEE        PIC X(14).                           
000123*                       ZONAFATT                                  
000124     10 A901-ZONAFATT        PIC X(2).                            
000125*                       CLASDOGA                                  
000126     10 A901-CLASDOGA        PIC X(1).                            
000127*                       INTNCLIE                                  
000128     10 A901-INTNCLIE        PIC X(50).                           
000129*                       CAPOCOMM                                  
000130     10 A901-CAPOCOMM        PIC X(5).                            
000131*                       PRIORITA                                  
000132     10 A901-PRIORITA        PIC X(1).                            
000133*                       BULSTATX                                  
000134     10 A901-BULSTATX        PIC X(13).                           
000135*                       CODUTVAR                                  
000136     10 A901-CODUTVAR        PIC X(6).                            
000137*                       CODUTCRE                                  
000138     10 A901-CODUTCRE        PIC X(6).                            
000139*                       CDRESCON                                  
000140     10 A901-CDRESCON        PIC X(2).                            
000141*                       CENCOACQ                                  
000142     10 A901-CENCOACQ        PIC X(5).                            
000143*                       CAPOSOCI                                  
000144     10 A901-CAPOSOCI        PIC X(5).                            
000145*                       CDFISCAL                                  
000146     10 A901-CDFISCAL        PIC X(16).                           
000147*                       CONDPACA                                  
000148     10 A901-CONDPACA        PIC X(3).                            
000149*                       CODXIBAN                                  
000150     10 A901-CODXIBAN        PIC X(4).                            
000151*                       CODXXCIN                                  
000152     10 A901-CODXXCIN        PIC X(2).                            
000153*                       ZIPFATTU                                  
000154     10 A901-ZIPFATTU        PIC X(15).                           
000155*                       ZIPMERCE                                  
000156     10 A901-ZIPMERCE        PIC X(15).                           
000157*                       TIPOLIST                                  
000158     10 A901-TIPOLIST        PIC X(1).                            
000159*                       SWIFTCOD                                  
000160     10 A901-SWIFTCOD        PIC X(11).                           
000161*                       PERCEIVA                                  
000162     10 A901-PERCEIVA        PIC S9(3)V9(2) USAGE COMP-3.         
000163*                       DTVALIVA                                  
000164     10 A901-DTVALIVA        PIC X(8).                            
000165*                       CLASSCLI                                  
000166     10 A901-CLASSCLI        PIC X(1).                            
000167*                       RATINGCO                                  
000168     10 A901-RATINGCO        PIC X(3).                            
000169*                       RISCHCLI                                  
000170     10 A901-RISCHCLI        PIC X(1).                            
000171*                                                                 
000172     10 A901-NRPROIVA        PIC X(30).                           
000173*                                                                 
000174     10 A901-IMPESNEW        PIC S9(9)V9(2) USAGE COMP-3.         
000175     10 A901-TIPOSTAG        PIC X(1).                            
000176     10 A901-FLFATELE        PIC X(1).                            
000177     10 A901-CDDESTFE        PIC X(7).                            
000178     10 A901-INPECCLI        PIC X(50).                           
000179******************************************************************
000180* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 88      *
000181******************************************************************
      *<<((file: FDANA901))
000093*------------------------------- DANAGRAF.TDIVISE                 
000094 01  FILLER                      PIC X(8) VALUE 'FDANA963'.       
000095*    EXEC SQL INCLUDE FDANA963 END-EXEC.                          
      *>>((file: FDANA963))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TDIVISE                   *
000003******************************************************************
000004 01  DCLTDIVISE.                                                  
000005*                       SIGLADIV                                  
000006     10 A963-SIGLADIV        PIC X(3).                            
000007*                       CAMBIODV                                  
000008     10 A963-CAMBIODV        PIC S9(5)V9(6) USAGE COMP-3.         
000009*                       DESCDIVI                                  
000010     10 A963-DESCDIVI        PIC X(20).                           
000011*                       CODDIVIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000012     10 A963-CODDIVIS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000013*                       DECIDIVI                                  
000014     10 A963-DECIDIVI        PIC X(1).                            
000015*                       DIVIBANC                                  
000016     10 A963-DIVIBANC        PIC X(3).                            
000017*                       DIVIPREZ                                  
000018     10 A963-DIVIPREZ        PIC X(1).                            
000019*                       CODDIVRI                                  
000020     10 A963-CODDIVRI        PIC X(2).                            
000021*                       RAPPCAMB                                  
000022     10 A963-RAPPCAMB        PIC S9(5)V USAGE COMP-3.             
000023*                       CODDIGTM                                  
000024     10 A963-CODDIGTM        PIC X(2).                            
000025*                       FLAGEURO                                  
000026     10 A963-FLAGEURO        PIC X(1).                            
000027*                       SLDIVBAN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000028     10 A963-SLDIVBAN        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000029*                       CDDIVSCA                                  
000030     10 A963-CDDIVSCA        PIC X(2).                            
000031*                       FLDIVINT                                  
000032     10 A963-FLDIVINT        PIC X(1).                            
000033     10 A963-VBDIVSCA        PIC X(2).                            
000034******************************************************************
000035* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 15      *
000036******************************************************************
      *<<((file: FDANA963))
000096*------------------------------- DANAGRAF.TCENCOSTO               
000097 01  FILLER                      PIC X(8) VALUE 'FDANA982'.       
000098*    EXEC SQL INCLUDE FDANA982 END-EXEC.                          
      *>>((file: FDANA982))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TCENCOSTO)                               *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA982))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(A982-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DANAGRAF.TCENCOSTO TABLE                    
000012*     ( CODSOCIE                       CHAR(2) NOT NULL,           
000013*       CENCOSTO                       CHAR(5) NOT NULL,           
000014*       DESCENCO                       CHAR(30) NOT NULL,          
000015*       RAGCENCO                       CHAR(3) NOT NULL,           
000016*       ANNULLAM                       CHAR(1) NOT NULL,           
000017*       NEWCENCO                       CHAR(5) NOT NULL,           
000018*       CENCOLIS                       CHAR(5) NOT NULL,           
000019*       DTCREAZI                       CHAR(8) NOT NULL,           
000020*       DTULTVAR                       CHAR(8) NOT NULL,           
000021*       CODUTVAR                       CHAR(6) NOT NULL,           
000022*       CDMCAGTM                       CHAR(1) NOT NULL,           
000023*       CDAREGTM                       CHAR(2) NOT NULL,           
000024*       CDDIPGTM                       CHAR(1) NOT NULL,           
000025*       CDUBIGTM                       CHAR(2) NOT NULL,           
000026*       CDLINGTM                       CHAR(2) NOT NULL,           
000027*       SIGLCALE                       CHAR(3) NOT NULL,           
000028*       GRUPSIGE                       CHAR(1) NOT NULL,           
000029*       CDDIVISI                       CHAR(1) NOT NULL            
000030*     ) END-EXEC
                                                                        
000031******************************************************************
000032* COBOL DECLARATION FOR TABLE DANAGRAF.TCENCOSTO                 *
000033******************************************************************
000034 01  DCLTCENCOSTO.                                                
000035*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000036     10 A982-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000037*                       CENCOSTO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000038     10 A982-CENCOSTO        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000039*                       DESCENCO                                  
000040     10 A982-DESCENCO        PIC X(30).                           
000041*                       RAGCENCO                                  
000042     10 A982-RAGCENCO        PIC X(3).                            
000043*                       ANNULLAM                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000044     10 A982-ANNULLAM        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000045*                       NEWCENCO                                  
000046     10 A982-NEWCENCO        PIC X(5).                            
000047*                       CENCOLIS                                  
000048     10 A982-CENCOLIS        PIC X(5).                            
000049*                       DTCREAZI                                  
000050     10 A982-DTCREAZI        PIC X(8).                            
000051*                       DTULTVAR                                  
000052     10 A982-DTULTVAR        PIC X(8).                            
000053*                       CODUTVAR                                  
000054     10 A982-CODUTVAR        PIC X(6).                            
000055*                       CDMCAGTM                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000056     10 A982-CDMCAGTM        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000057*                       CDAREGTM                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000058     10 A982-CDAREGTM        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000059*                       CDDIPGTM                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000060     10 A982-CDDIPGTM        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000061*                       CDUBIGTM                                  
000062     10 A982-CDUBIGTM        PIC X(2).                            
000063*                       CDLINGTM                                  
000064     10 A982-CDLINGTM        PIC X(2).                            
000065*                       SIGLCALE                                  
000066     10 A982-SIGLCALE        PIC X(3).                            
000067*                       GRUPSIGE                                  
000068     10 A982-GRUPSIGE        PIC X(1).                            
000069*                       CDDIVISI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000070     10 A982-CDDIVISI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000071******************************************************************
000072* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 18      *
000073******************************************************************
      *<<((file: FDANA982))
000099*------------------------------- DCONTCLI.TCONTIDCE               
000100 01  FILLER                      PIC X(8) VALUE 'FDCLI861'.       
000101*    EXEC SQL INCLUDE FDCLI861 END-EXEC.                          
      *>>((file: FDCLI861))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DCONTCLI.TCONTIDCE                 *
000003******************************************************************
000004 01  DCLTCONTIDCE.                                                
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 C861-CONTODCE        PIC X(6).                            
000006     10 C861-CODPIANO        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007     10 C861-CONTPROV        PIC X(6).                            
000008     10 C861-DESCRDCE        PIC X(25).                           
000009     10 C861-ANNULLAM        PIC X(1).                            
000010     10 C861-TIPCONTO        PIC X(2).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000011     10 C861-CONTGRUP        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000012     10 C861-NOTECON1        PIC X(33).                           
000013     10 C861-NOTECON2        PIC X(33).                           
000014     10 C861-INDBILQU        PIC X(1).                            
000015     10 C861-FLCOMMES        PIC X(1).                            
000016******************************************************************
000017* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 11 C861- 
000018******************************************************************
      *<<((file: FDCLI861))
000102*------------------------------- DLOGISTI.TORDILOGI               
000103 01  FILLER                      PIC X(8) VALUE 'FDLOG652'.       
000104*    EXEC SQL INCLUDE FDLOG652 END-EXEC.                          
      *>>((file: FDLOG652))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TORDILOGI                 *
000003******************************************************************
000004 01  DCLTORDILOGI.                                                
000005*                       AANUMORD                                  
000006     10 L652-AANUMORD        PIC X(8).                            
000007*                       CODCLIEN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000008     10 L652-CODCLIEN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000009*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000010     10 L652-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000011*                       CDDIVISI                                  
000012     10 L652-CDDIVISI        PIC X(1).                            
000013*                       DTCARORD                                  
000014     10 L652-DTCARORD        PIC X(8).                            
000015*                       CODDIVIS                                  
000016     10 L652-CODDIVIS        PIC X(2).                            
000017*                       TIPSERVI                                  
000018     10 L652-TIPSERVI        PIC X(1).                            
000019*                       FLAGAUTO                                  
000020     10 L652-FLAGAUTO        PIC X(1).                            
000021*                       FLAGGIVA                                  
000022     10 L652-FLAGGIVA        PIC X(1).                            
000023*                       CONTODCE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000024     10 L652-CONTODCE        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025*                       DTEVAORD                                  
000026     10 L652-DTEVAORD        PIC X(8).                            
000027*                       AANUMFAT                                  
000028     10 L652-AANUMFAT        PIC X(8).                            
000029*                       DTFATTUR                                  
000030     10 L652-DTFATTUR        PIC X(8).                            
000031*                       NRPREATT                                  
000032     10 L652-NRPREATT        PIC X(10).                           
000033*                       DTPREATT                                  
000034     10 L652-DTPREATT        PIC X(8).                            
000035*                       DTCREAZI                                  
000036     10 L652-DTCREAZI        PIC X(8).                            
000037*                       DTULTVAR                                  
000038     10 L652-DTULTVAR        PIC X(8).                            
000039*                       CODUTVAR                                  
000040     10 L652-CODUTVAR        PIC X(6).                            
000041*                       DTANNULL                                  
000042     10 L652-DTANNULL        PIC X(8).                            
000043*                       SOCIEMER                                  
000044     10 L652-SOCIEMER        PIC X(2).                            
000045*                       DATAESTR                                  
000046     10 L652-DATAESTR        PIC X(8).                            
000047*                       AAMMCOMP                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000048     10 L652-AAMMCOMP        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000049*                       FLAGSOSP                                  
000050     10 L652-FLAGSOSP        PIC X(1).                            
000051*                       CODUTEVB                                  
000052     10 L652-CODUTEVB        PIC X(6).                            
000053*                       ESENTIVA                                  
000054     10 L652-ESENTIVA        PIC X(1).                            
000055*                       FLORDIVB                                  
000056     10 L652-FLORDIVB        PIC X(1).                            
000057******************************************************************
000058* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 26      *
000059******************************************************************
      *<<((file: FDLOG652))
000105*------------------------------- DLOGISTI.TRIGORDILOGI            
000106 01  FILLER                      PIC X(8) VALUE 'FDLOG653'.       
000107*    EXEC SQL INCLUDE FDLOG653 END-EXEC.                          
      *>>((file: FDLOG653))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TRIGORDILOGI              *
000003******************************************************************
000004 01  DCLTRIGORDILOGI.                                             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 L653-AANUMORD        PIC X(8).                            
000006     10 L653-NRRIGORD        PIC S9(5)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007     10 L653-CODSERVI        PIC X(6).                            
000008     10 L653-UNMISURA        PIC X(2).                            
000009     10 L653-QTAORDIN        PIC S9(7)V9(2) USAGE COMP-3.         
000010     10 L653-PREZZORD        PIC S9(7)V9(4) USAGE COMP-3.         
000011     10 L653-IMPORDIN        PIC S9(11)V9(2) USAGE COMP-3.        
000012     10 L653-NOTENOTE        PIC X(40).                           
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000013     10 L653-CENCOSTD        PIC X(5).                            
000014     10 L653-CENCOSTA        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000015     10 L653-RIFECLIE        PIC X(15).                           
000016     10 L653-DTCREAZI        PIC X(8).                            
000017     10 L653-DTULTVAR        PIC X(8).                            
000018     10 L653-CODUTVAR        PIC X(6).                            
000019     10 L653-DTANNULL        PIC X(8).                            
000020     10 L653-IMPORIVA        PIC S9(11)V9(2) USAGE COMP-3.        
000021******************************************************************
000022* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 16      *
000023******************************************************************
      *<<((file: FDLOG653))
000108*------------------------------- DSIFO.TFATTFORN                  
000109 01  FILLER                      PIC X(8) VALUE 'FDSIF222'.       
000110*    EXEC SQL INCLUDE FDSIF222 END-EXEC.                          
      *>>((file: FDSIF222))
000001******************************************************************
000002* DCLGEN TABLE(DSIFO.TFATTFORN)                                  *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDSIF222))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(S222-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DSIFO.TFATTFORN TABLE                       
000012*     ( AANUMMOV                       CHAR(8) NOT NULL,           
000013*       CODSOCIE                       CHAR(2) NOT NULL,           
000014*       FORNFATT                       CHAR(5) NOT NULL,           
000015*       NUMBOLLA                       CHAR(16) NOT NULL,          
000016*       DATBOLLA                       CHAR(8) NOT NULL,           
000017*       CODDIVIS                       CHAR(2) NOT NULL,           
000018*       IMPOFATT                       DECIMAL(12, 2) NOT NULL,    
000019*       IMPOTRAS                       DECIMAL(12, 2) NOT NULL,    
000020*       TIPSPEDI                       CHAR(1) NOT NULL,           
000021*       CODIRESA                       CHAR(1) NOT NULL,           
000022*       DATAESTR                       CHAR(8) NOT NULL,           
000023*       DATASALD                       CHAR(8) NOT NULL,           
000024*       CODUTVAR                       CHAR(6) NOT NULL,           
000025*       DTCREAZI                       CHAR(8) NOT NULL,           
000026*       DTULTVAR                       CHAR(8) NOT NULL,           
000027*       IMPAGGOR                       DECIMAL(12, 2) NOT NULL,    
000028*       FORNTRAS                       CHAR(5) NOT NULL,           
000029*       FORNDOGA                       CHAR(5) NOT NULL,           
000030*       CODAWBXX                       CHAR(21) NOT NULL,          
000031*       DTPARPRE                       CHAR(8) NOT NULL,           
000032*       DTARRIVO                       CHAR(8) NOT NULL,           
000033*       TTCOLFAT                       DECIMAL(5, 0) NOT NULL,     
000034*       KGLORFAT                       DECIMAL(9, 2) NOT NULL,     
000035*       KGNETFAT                       DECIMAL(9, 2) NOT NULL,     
000036*       FORNDEST                       CHAR(5) NOT NULL,           
000037*       DATATRAS                       CHAR(8) NOT NULL,           
000038*       NOTENOTE                       CHAR(70) NOT NULL,          
000039*       DIVITRAS                       CHAR(2) NOT NULL,           
000040*       AANRMAND                       CHAR(8) NOT NULL,           
000041*       CODUTCRE                       CHAR(6) NOT NULL,           
000042*       NUMRICTR                       CHAR(7) NOT NULL,           
000043*       IMPOFAT4                       DECIMAL(15, 4) NOT NULL     
000044*     ) END-EXEC
                                                                        
000045******************************************************************
000046* COBOL DECLARATION FOR TABLE DSIFO.TFATTFORN                    *
000047******************************************************************
000048 01  DCLTFATTFORN.                                                
000049*                       AANUMMOV                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000050     10 S222-AANUMMOV        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000051*                       CODSOCIE                                  
000052     10 S222-CODSOCIE        PIC X(2).                            
000053*                       FORNFATT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000054     10 S222-FORNFATT        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000055*                       NUMBOLLA                                  
000056     10 S222-NUMBOLLA        PIC X(16).                           
000057*                       DATBOLLA                                  
000058     10 S222-DATBOLLA        PIC X(8).                            
000059*                       CODDIVIS                                  
000060     10 S222-CODDIVIS        PIC X(2).                            
000061*                       IMPOFATT                                  
000062     10 S222-IMPOFATT        PIC S9(10)V9(2) USAGE COMP-3.        
000063*                       IMPOTRAS                                  
000064     10 S222-IMPOTRAS        PIC S9(10)V9(2) USAGE COMP-3.        
000065*                       TIPSPEDI                                  
000066     10 S222-TIPSPEDI        PIC X(1).                            
000067*                       CODIRESA                                  
000068     10 S222-CODIRESA        PIC X(1).                            
000069*                       DATAESTR                                  
000070     10 S222-DATAESTR        PIC X(8).                            
000071*                       DATASALD                                  
000072     10 S222-DATASALD        PIC X(8).                            
000073*                       CODUTVAR                                  
000074     10 S222-CODUTVAR        PIC X(6).                            
000075*                       DTCREAZI                                  
000076     10 S222-DTCREAZI        PIC X(8).                            
000077*                       DTULTVAR                                  
000078     10 S222-DTULTVAR        PIC X(8).                            
000079*                       IMPAGGOR                                  
000080     10 S222-IMPAGGOR        PIC S9(10)V9(2) USAGE COMP-3.        
000081*                       FORNTRAS                                  
000082     10 S222-FORNTRAS        PIC X(5).                            
000083*                       FORNDOGA                                  
000084     10 S222-FORNDOGA        PIC X(5).                            
000085*                       CODAWBXX                                  
000086     10 S222-CODAWBXX        PIC X(21).                           
000087*                       DTPARPRE                                  
000088     10 S222-DTPARPRE        PIC X(8).                            
000089*                       DTARRIVO                                  
000090     10 S222-DTARRIVO        PIC X(8).                            
000091*                       TTCOLFAT                                  
000092     10 S222-TTCOLFAT        PIC S9(5)V USAGE COMP-3.             
000093*                       KGLORFAT                                  
000094     10 S222-KGLORFAT        PIC S9(7)V9(2) USAGE COMP-3.         
000095*                       KGNETFAT                                  
000096     10 S222-KGNETFAT        PIC S9(7)V9(2) USAGE COMP-3.         
000097*                       FORNDEST                                  
000098     10 S222-FORNDEST        PIC X(5).                            
000099*                       DATATRAS                                  
000100     10 S222-DATATRAS        PIC X(8).                            
000101*                       NOTENOTE                                  
000102     10 S222-NOTENOTE        PIC X(70).                           
000103*                       DIVITRAS                                  
000104     10 S222-DIVITRAS        PIC X(2).                            
000105*                       AANRMAND                                  
000106     10 S222-AANRMAND        PIC X(8).                            
000107*                       CODUTCRE                                  
000108     10 S222-CODUTCRE        PIC X(6).                            
000109*                       NUMRICTR                                  
000110     10 S222-NUMRICTR        PIC X(7).                            
000111*                       IMPOFAT4                                  
000112     10 S222-IMPOFAT4        PIC S9(11)V9(4) USAGE COMP-3.        
000113******************************************************************
000114* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 32      *
000115******************************************************************
      *<<((file: FDSIF222))
000111*------------------------------- DTRASP.TCOSTRASPCDC              
000112 01  FILLER                      PIC X(8) VALUE 'FDTRA308'.       
000113*    EXEC SQL INCLUDE FDTRA308 END-EXEC.                          
      *>>((file: FDTRA308))
000001******************************************************************
000002* DCLGEN TABLE(DTRASP.TCOSTRASPCDC)                              *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDTRA308))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(T308-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DTRASP.TCOSTRASPCDC TABLE                   
000012*     ( DTFATTUR                       CHAR(8) NOT NULL,           
000013*       CODSOCIE                       CHAR(2) NOT NULL,           
000014*       AANUMFAT                       CHAR(8) NOT NULL,           
000015*       SOCIEPAS                       CHAR(2) NOT NULL,           
000016*       PAESPROV                       CHAR(3) NOT NULL,           
000017*       PAESMERC                       CHAR(3) NOT NULL,           
000018*       PAESORDI                       CHAR(3) NOT NULL,           
000019*       TIPOARTI                       CHAR(1) NOT NULL,           
000020*       TIPSPEDI                       CHAR(1) NOT NULL,           
000021*       CODIRESA                       CHAR(1) NOT NULL,           
000022*       CONTODCE                       CHAR(6) NOT NULL,           
000023*       CENCOSTO                       CHAR(5) NOT NULL,           
000024*       CENCOTRA                       CHAR(5) NOT NULL,           
000025*       UNMISURA                       CHAR(2) NOT NULL,           
000026*       QTARIGFA                       DECIMAL(9, 2) NOT NULL,     
000027*       KGLORRIG                       DECIMAL(9, 2) NOT NULL,     
000028*       KGNETRIG                       DECIMAL(9, 2) NOT NULL,     
000029*       UNMISLIS                       CHAR(2) NOT NULL,           
000030*       COSTUTRA                       DECIMAL(7, 2) NOT NULL,     
000031*       IMPTRLIS                       DECIMAL(9, 2) NOT NULL,     
000032*       IMPTRCLI                       DECIMAL(9, 2) NOT NULL,     
000033*       IMPTRPAG                       DECIMAL(9, 2) NOT NULL,     
000034*       DTCREAZI                       CHAR(8) NOT NULL,           
000035*       DTULTVAR                       CHAR(8) NOT NULL,           
000036*       CODUTVAR                       CHAR(6) NOT NULL,           
000037*       SOCIEFAT                       CHAR(2) NOT NULL,           
000038*       TIPORECO                       CHAR(4) NOT NULL,           
000039*       TIPOELAB                       CHAR(1) NOT NULL,           
000040*       AANRFATR                       CHAR(8) NOT NULL,           
000041*       AANUMORD                       CHAR(8) NOT NULL,           
000042*       NRRIGORD                       DECIMAL(3, 0) NOT NULL      
000043*     ) END-EXEC
                                                                        
000044******************************************************************
000045* COBOL DECLARATION FOR TABLE DTRASP.TCOSTRASPCDC                *
000046******************************************************************
000047 01  DCLTCOSTRASPCDC.                                             
000048*                       DTFATTUR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000049     10 T308-DTFATTUR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000050*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000051     10 T308-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000052*                       AANUMFAT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000053     10 T308-AANUMFAT        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000054*                       SOCIEPAS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000055     10 T308-SOCIEPAS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000056*                       PAESPROV                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000057     10 T308-PAESPROV        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000058*                       PAESMERC                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000059     10 T308-PAESMERC        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000060*                       PAESORDI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000061     10 T308-PAESORDI        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000062*                       TIPOARTI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000063     10 T308-TIPOARTI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000064*                       TIPSPEDI                                  
000065     10 T308-TIPSPEDI        PIC X(1).                            
000066*                       CODIRESA                                  
000067     10 T308-CODIRESA        PIC X(1).                            
000068*                       CONTODCE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000069     10 T308-CONTODCE        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000070*                       CENCOSTO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000071     10 T308-CENCOSTO        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000072*                       CENCOTRA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000073     10 T308-CENCOTRA        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000074*                       UNMISURA                                  
000075     10 T308-UNMISURA        PIC X(2).                            
000076*                       QTARIGFA                                  
000077     10 T308-QTARIGFA        PIC S9(7)V9(2) USAGE COMP-3.         
000078*                       KGLORRIG                                  
000079     10 T308-KGLORRIG        PIC S9(7)V9(2) USAGE COMP-3.         
000080*                       KGNETRIG                                  
000081     10 T308-KGNETRIG        PIC S9(7)V9(2) USAGE COMP-3.         
000082*                       UNMISLIS                                  
000083     10 T308-UNMISLIS        PIC X(2).                            
000084*                       COSTUTRA                                  
000085     10 T308-COSTUTRA        PIC S9(5)V9(2) USAGE COMP-3.         
000086*                       IMPTRLIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000087     10 T308-IMPTRLIS        PIC S9(7)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000088*                       IMPTRCLI                                  
000089     10 T308-IMPTRCLI        PIC S9(7)V9(2) USAGE COMP-3.         
000090*                       IMPTRPAG                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000091     10 T308-IMPTRPAG        PIC S9(7)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000092*                       DTCREAZI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000093     10 T308-DTCREAZI        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000094*                       DTULTVAR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000095     10 T308-DTULTVAR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000096*                       CODUTVAR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000097     10 T308-CODUTVAR        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000098*                       SOCIEFAT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000099     10 T308-SOCIEFAT        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000100*                       TIPORECO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000101     10 T308-TIPORECO        PIC X(4).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000102*                       TIPOELAB                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000103     10 T308-TIPOELAB        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000104*                       AANRFATR                                  
000105     10 T308-AANRFATR        PIC X(8).                            
000106*                       AANUMORD                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000107     10 T308-AANUMORD        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000108*                       NRRIGORD                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000109     10 T308-NRRIGORD        PIC S9(3)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000110******************************************************************
000111* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 31      *
000112******************************************************************
      *<<((file: FDTRA308))
000114*------------------------------- DTRASP.TNETMOVEREXPO             
000115 01  FILLER                      PIC X(8) VALUE 'FDTRA358'.       
000116*    EXEC SQL INCLUDE FDTRA358 END-EXEC.                          
      *>>((file: FDTRA358))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DTRASP.TNETMOVEREXPO               *
000003******************************************************************
000004 01  DCLTNETMOVEREXPO.                                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 T358-SOCIEFAT        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000006     10 T358-NRPREFAT        PIC X(10).                           
000007     10 T358-DTPREFAT        PIC X(8).                            
000008     10 T358-CODFORNI        PIC X(5).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000009     10 T358-CODSOCIE        PIC X(2).                            
000010     10 T358-AANUMFAT        PIC X(20).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000011     10 T358-DTFATTUR        PIC X(8).                            
000012     10 T358-NUMPROG5        PIC S9(5)V USAGE COMP-3.             
000013     10 T358-MERCEMAG        PIC X(2).                            
000014     10 T358-PROLOMER        PIC X(2).                            
000015     10 T358-CODLINEA        PIC X(2).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000016     10 T358-CENCOSTO        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000017     10 T358-CDTPCOST        PIC X(10).                           
000018     10 T358-CODDIVIS        PIC X(2).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000019     10 T358-IMPCOSTO        PIC S9(9)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000020     10 T358-DTCREAZI        PIC X(8).                            
000021     10 T358-DTULTVAR        PIC X(8).                            
000022     10 T358-CODUTVAR        PIC X(6).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000023     10 T358-TIPORECO        PIC X(4).                            
000024     10 T358-CONTODCE        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025     10 T358-STPREFAT        PIC X(3).                            
000026     10 T358-DTSPEDIZ        PIC X(8).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000027     10 T358-DATATRAS        PIC X(8).                            
000028     10 T358-CENCOTRA        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000029     10 T358-NRPREATT        PIC X(10).                           
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000030     10 T358-DTPREATT        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000031     10 T358-STPREATT        PIC X(3).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000032     10 T358-IMCOSATT        PIC S9(9)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000033     10 T358-NRDOCCOT        PIC X(10).                           
000034     10 T358-NRRIGORD        PIC S9(3)V USAGE COMP-3.             
000035     10 T358-AANUMORD        PIC X(8).                            
000036******************************************************************
000037* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 31      *
000038******************************************************************
      *<<((file: FDTRA358))
000117                                                                  
000118*    EXEC SQL                                                     
000119*         DECLARE POINTER1 CURSOR FOR                             
000120*          SELECT SOCIEFAT, CODSOCIE, AANUMFAT                    
000121*                ,TIPORECO, CONTODCE, CENCOTRA                    
000122*                ,CODDIVIS, CODFORNI, MERCEMAG                    
000123*                ,CENCOSTO, NRPREFAT, DTPREFAT                    
000124*                ,STPREFAT, DTFATTUR                              
000125*                ,PROLOMER, CODLINEA, NRDOCCOT                    
000126*                ,DTSPEDIZ                                        
000127*                ,IMPCOSTO, NUMPROG5                              
000128*            FROM DTRASP.TNETMOVEREXPO                            
000129*           WHERE   STPREFAT      <> 'A'                          
000130*********      OR  (STPREFAT       = 'A'                          
000131*********     AND   DATATRAS      <= ' '))                        
000132*             AND ((DTPREFAT       > ' '                          
000133*             AND   DTPREFAT BETWEEN :WS-INIZANNO                 
000134*                                AND :WS-FINEMESE)                
000135*              OR  (DTPREFAT       = ' '                          
000136*             AND   DTSPEDIZ BETWEEN :WS-INIZANNO                 
000137*                                AND :WS-FINEMESE))               
000138*           ORDER BY SOCIEFAT, CODSOCIE, AANUMFAT                 
000139*                   ,TIPORECO                                     
000140*    END-EXEC.                                                    
000141                                                                  
000142*--- ESTRAE LE RIGHE CARICATE MANUALMENTE SU NETMOVER OPPURE      
000143*--- I COSTI RELATIVI AI PREAVVISI PER INSERIRLE SU COSTRASPCDC.  
000144*--- ESTRAE LE RIGHE CHE SONO ENTRATE                             
000145*--- NELLA PREFATTURA ATTIVA DEL MESE IN CORSO OPPURE SONO        
000146*--- STATE PASSATE IN GTM NEL MESE IN CORSO (SE NO SOC.22)        
000147*--- DAL 2025 CON LA PARTENZA DI OPLA QUESTA ELABORAZIONE VERRA'  
000148*--- FATTA SOLO PIU' PER TEXTILE XC NON CI SARA' PIU'             
000149*--- LA TNETMOVEREXPO PER LA SUBLITEX.                            
000150                                                                  
000152     
      *EXEC SQL 
      *DECLARE POINTER2 CURSOR  FOR                             
000153*          SELECT SOCIEFAT                                         
000154*                ,CODSOCIE                                         
000155*                ,CONTODCE                                         
000156*                ,CENCOSTO                                         
000157*                ,CENCOTRA                                         
000158*                ,TIPORECO                                         
000159*                ,DATATRAS                                         
000160*                ,DTPREATT                                         
000161*                ,SUM(IMPCOSTO)                                    
000162*                ,SUM(IMCOSATT)                                    
000163*                ,CASE WHEN TIPORECO = ' '                         
000164*                      THEN ' '                                    
000165*                      ELSE AANUMFAT END AANUMFAT                  
000166*            FROM DTRASP.TNETMOVEREXPO                             
000167*           WHERE TIPORECO      IN (' ','PREA','DOGA')             
000168*             AND(DTPREATT BETWEEN :WS-INIZMESE                    
000169*                              AND :WS-FINEMESE OR                 
000170*                 DATATRAS BETWEEN :WS-INIZMESE                    
000171*                              AND :WS-FINEMESE)                   
000172*             AND SOCIEFAT <> '24'                                 
000173*             AND CODSOCIE <> '24'                                 
000174*           GROUP BY SOCIEFAT                                      
000175*                   ,CODSOCIE                                      
000176*                   ,CONTODCE                                      
000177*                   ,CENCOSTO                                      
000178*                   ,CENCOTRA                                      
000179*                   ,TIPORECO                                      
000180*                   ,DATATRAS                                      
000181*                   ,DTPREATT                                      
000182*                   ,CASE WHEN TIPORECO = ' '                      
000183*                         THEN ' '                                 
000184*                         ELSE AANUMFAT END                        
000185*           ORDER BY SOCIEFAT                                      
000186*                   ,CODSOCIE                                      
000187*                   ,CONTODCE                                      
000188*                   ,CENCOSTO                                      
000189*                   ,CENCOTRA                                      
000190*                   ,TIPORECO                                      
000191*                   ,CASE WHEN TIPORECO = ' '                      
000192*                         THEN ' '                                 
000193*                         ELSE AANUMFAT END                        
000194*     END-EXEC
                                                                        
000195                                                                  
000196*    EXEC SQL INCLUDE SQLCA END-EXEC.                             
      *>>((file: SQLCA))
000001****************************************************************<*
000002* Copyright (c) 2016-2023 NTT DATA, Inc. All rights reserved.  *<*
000003* Users of NTT DATA Enterprise COBOL may freely                *<*
000004* redistribute this copybook.                                  *<*
000005****************************************************************<*
000006                                                                  
000007 01  SQLCA GLOBAL.                                                
000008     05  SQLCAID                PIC X(8).                         
000009     05  SQLCABC                PIC S9(9) COMP-5.                 
000010     05  SQLCODE                PIC S9(9) COMP-5.                 
000011     05  SQLERRM.                                                 
000012         49  SQLERRML           PIC S9(4) COMP-5.                 
000013         49  SQLERRMC           PIC X(254).                       
000014     05  SQLERRP                PIC X(8).                         
000015     05  SQLERRD OCCURS 6 TIMES PIC S9(9) COMP-5.                 
000016     05  SQLWARN.                                                 
000017         10 SQLWARN0            PIC X(1).                         
000018         10 SQLWARN1            PIC X(1).                         
000019         10 SQLWARN2            PIC X(1).                         
000020         10 SQLWARN3            PIC X(1).                         
000021         10 SQLWARN4            PIC X(1).                         
000022         10 SQLWARN5            PIC X(1).                         
000023         10 SQLWARN6            PIC X(1).                         
000024         10 SQLWARN7            PIC X(1).                         
000025     05  SQLSTATE               PIC X(5).                         
000026     05  SQLEXT                 PIC S9(5) COMP-3 VALUE 1.         
      *<<((file: SQLCA))
000197                                                                  
000198*----------------------------------------------------------------*
000199 PROCEDURE DIVISION.                                              
000200*----------------------------------------------------------------*
000199 VCOBOL-DUMMY-PROCEDURE.
000201                                                                  
000202     
      *EXEC SQL WHENEVER SQLERROR GO TO Z00-ERRORE END-EXEC
                                                                        
000203                                                                  
000204     MOVE 'AVAFT80'              TO PPNAME                        
000205                                    WCOM-PROGNAME.                
000206                                                                  
000207     PERFORM A00-OPERAZIONI-INIZIALI                              
000208        THRU A00-EX.                                              
000209                                                                  
000210*--  ELABORAZIONE MENSILE PER TEXTILE:                            
000211*    - DOPO PARTENZA FILE RATEI NM X TUTTI:                       
000212*      DA TOGLIERE GESTIONE POINTER1                              
000213*    - DOPO PARTENZA OPLA-BOTTINELLI:                             
000214*--    LASCIARE SOLO POINTER2 X COSTRASPCDC SOLO PER '09'         
000215                                                                  
000216     IF SK-TIPOELAB = 'T'                                         
000217        PERFORM B00-ELABORA-TEXTILE                               
000218           THRU B00-EX.                                           
000219                                                                  
000220*--  ELABORAZIONE MENSILE DA FILE SOLO PER FASHION                
000221*    - DOPO PARTENZA FILE RATEI NM X TUTTI:                       
000222*      TOGLIERE GESTIONE C00-                                     
000223*                                                                 
000224*    IF SK-TIPOELAB = 'F'                                         
000225*       PERFORM C00-ELABORA-FASHION                               
000226*--        THRU C00-EX.                                           
000227                                                                  
000228*    ELABORAZIONE MENSILE DA FILE PER TUTTI.                      
000229*    E' IL GIRO UFFICIALE PER TUTTI.                              
000230                                                                  
000231     IF SK-TIPOELAB = 'R'                                         
000232        PERFORM D00-ELABORA-RATEI                                 
000233           THRU D00-EX.                                           
000234                                                                  
000235     MOVE 'P'                    TO PPROUTIN.                     
000236     PERFORM Z90-READPRIN                                         
000237        THRU Z90-EX.                                              
000238                                                                  
000239     MOVE ZERO                   TO  RETURN-CODE.                 
000240                                                                  
000241     CALL "CCF_SET_RETCODE" USING RETURN-CODE                     
000242     STOP RUN.                                                    
000243                                                                  
000244*-------------------------------------------------------*         
000245 A00-OPERAZIONI-INIZIALI.                                         
000246*-------------------------------------------------------*         
000247                                                                  
000248*--- LEGGI MENSILE                                                
000249     INITIALIZE  DCWDTEL.                                         
000250     MOVE 'R'                    TO DTEL-TIPORICH.                
000251     MOVE 'MENSILE'              TO DTEL-SIGLDATA.                
000252     MOVE 'M'                    TO DTEL-DATATIPO.                
000253                                                                  
000254     MOVE 'SCADTEL'              TO PPCALL.                       
000255     CALL  PPCALL             USING DCPARM                        
000256                                    DCWDTEL.                      
000257     IF DTEL-RETCOD NOT = ZEROES                                  
000258        MOVE DTEL-RETCOD         TO WCOM-FILECTRL                 
000259        MOVE 'MODULO'            TO WCOM-FILEFUNZ                 
000260        MOVE 'SCADTEL'           TO WCOM-FILENOME                 
000261        MOVE 'A00-'              TO WCOM-CODABEND                 
000262        PERFORM Z00-ERRORE                                        
000263           THRU Z00-EX.                                           
000264                                                                  
000265     MOVE DTEL-DTINELAB          TO WS-INIZMESE                   
000266     STRING DTEL-DTINELAB(1:4) '0101'                             
000267     DELIMITED BY SIZE         INTO WS-INIZANNO                   
000268     MOVE DTEL-DTFIELAB          TO WS-FINEMESE.                  
000269                                                                  
000270*--- LEGGI GIORNO                                                 
000271     INITIALIZE  DCWDTEL.                                         
000272     MOVE 'R'                    TO DTEL-TIPORICH.                
000273     MOVE 'AVAFT80'              TO DTEL-SIGLDATA.                
000274     MOVE 'G'                    TO DTEL-DATATIPO.                
000275                                                                  
000276     MOVE 'SCADTEL'              TO PPCALL.                       
000277     CALL  PPCALL             USING DCPARM                        
000278                                    DCWDTEL.                      
000279     IF DTEL-RETCOD NOT = ZEROES                                  
000280        MOVE DTEL-RETCOD         TO WCOM-FILECTRL                 
000281        MOVE 'MODULO'            TO WCOM-FILEFUNZ                 
000282        MOVE 'SCADTEL'           TO WCOM-FILENOME                 
000283        MOVE 'A00-'              TO WCOM-CODABEND                 
000284        PERFORM Z00-ERRORE                                        
000285           THRU Z00-EX.                                           
000286                                                                  
000287     MOVE DTEL-DTINELAB          TO WS-DTGIORNO.                  
000288                                                                  
000289*--- SCHEDA PARAMETRO                                             
000290     MOVE SK-PARAM               TO WCOM-FILECTRL.                
000291     MOVE 'READ'                 TO WCOM-FILEFUNZ.                
000292     MOVE 'SK-PAR '              TO WCOM-FILENOME.                
000293     MOVE 'A00-'                 TO WCOM-CODABEND.                
000294                                                                  
000295     MOVE SPACES                 TO SK-PARAM                      
000296     MOVE 'S'                    TO PPROUTIN.                     
000297     PERFORM Z90-READPRIN                                         
000298        THRU Z90-EX.                                              
000299     MOVE PPSK1                  TO SK-PARAM.                     
000300                                                                  
000301     IF SK-TIPOELAB NOT > SPACES OR                               
000302        PPSTAT      NOT = '****'                                  
000303        MOVE SPACES              TO PPMESSAG                      
000304        STRING 'SCHEDA PARAMETRO ERRATO: '  SK-PARAM              
000305             DELIMITED BY SIZE INTO PPMESSAG                      
000306        MOVE 'M'                 TO PPROUTIN                      
000307        PERFORM Z90-READPRIN                                      
000308           THRU Z90-EX                                            
000309        PERFORM Z00-ERRORE                                        
000310           THRU Z00-EX.                                           
000311                                                                  
000312 A00-EX. EXIT.                                                    
000313*----------------------------------------------------------------*
000314 B00-ELABORA-TEXTILE.                                             
000315*----------------------------------------------------------------*
000316*--- DOPO LA PARTENZA DI OPLA QUESTA ELABORAZIONE VERRA'          
000317*--- FATTA SOLO PIU' PER 09T TEXTILE XC NON CI SARA' PIU'         
000318*--- LA TNETMOVEREXPO PER LA 24T SUBLITEX.                        
000319*--- INTERVENTI SULLA W05 E SUL POINTER2.                         
000320                                                                  
000321*--- ELABORA COSTI RIFERITI A C/COSTI COMMERCIALI CARICATI        
000322*--- MANUALMETE SU NETMOVER (SOLO A FINE MESE)                    
000323     MOVE WS-FINEMESE            TO T308-DTFATTUR                 
000324     PERFORM W05-DELETE-COSTRASPCDC                               
000325        THRU W05-EX                                               
000326                                                                  
000327     PERFORM O40-OPEN-POINTER2                                    
000328        THRU O40-EX                                               
000329     PERFORM L45-FETCH-POINTER2                                   
000330        THRU L45-EX                                               
000331     IF WS-SQLCODE = 0                                            
000332        PERFORM B10-ELABORA-POINTER2                              
000333           THRU B10-EX                                            
000334                UNTIL WS-SQLCODE = 100                            
000335     END-IF                                                       
000336                                                                  
000337     PERFORM O41-CLOSE-POINTER2                                   
000338        THRU O41-EX.                                              
000339                                                                  
000340*----------------------------------------------------------------*
000341*--- DAL 2025 QUANDO SI PARTE CON OPLA OPPURE                     
000342*--- QUANDO SI DECIDE DI PRENDERE I RATEI PER TUTTI DAL FILE,     
000343*--- QUESTA ELABORAZIONE NON DEVE PIU' ESSEREE FATTA.             
000344                                                                  
000345*--- ELABORA POINTER NETMOVEREXPO                                 
000346*    MOVE WS-FINEMESE            TO A203-ANNOMESE                 
000347*    MOVE 'DB2'                  TO A203-TIPOELAB                 
000348*    PERFORM W00-DELETE-RATEINM                                   
000349*       THRU W00-EX                                               
000350*                                                                 
000351*    PERFORM O00-OPEN-POINTER1                                    
000352*       THRU O00-EX                                               
000353*    PERFORM L00-FETCH-POINTER1                                   
000354*       THRU L00-EX                                               
000355*    PERFORM B50-ELABORA-POINTER1                                 
000356*       THRU B50-EX                                               
000357*            UNTIL SQLCODE = 100                                  
000358*    PERFORM O01-CLOSE-POINTER1                                   
000359*---    THRU O01-EX.                                              
000360                                                                  
000361 B00-EX. EXIT.                                                    
000362*----------------------------------------------------------------*
000363 B10-ELABORA-POINTER2.                                            
000364*----------------------------------------------------------------*
000365                                                                  
000366     MOVE T358-AANUMFAT          TO WS-AANUMFAT                   
000367     MOVE T358-TIPORECO          TO WS-TIPORECO                   
000368     MOVE T358-CODSOCIE          TO WS-CODSOCIE                   
000369     MOVE T358-CENCOSTO          TO WS-CENCOSTO                   
000370     MOVE T358-SOCIEFAT          TO WS-SOCIEFAT                   
000371     MOVE T358-CENCOTRA          TO WS-CENCOTRA                   
000372     MOVE T358-CONTODCE          TO WS-CONTODCE                   
000373     MOVE ZEROS                  TO WS-IMPTRLIS                   
000374     MOVE ZEROS                  TO WS-IMPTRPAG                   
000375                                                                  
000376     IF WS-TIPORECO NOT > ' '                                     
000377        PERFORM B11-CERCA-NUMERO                                  
000378           THRU B11-EX                                            
000379     ELSE                                                         
000380        IF WS-TIPORECO = 'PREA'                                   
000381           STRING 'P' WS-AANUMFAT(2:7)                            
000382           DELIMITED BY SIZE     INTO WS-FATTURA                  
000383        ELSE                                                      
000384           IF WS-TIPORECO = 'DOGA'                                
000385              STRING 'D' WS-AANUMFAT(2:7)                         
000386              DELIMITED BY SIZE  INTO WS-FATTURA.                 
000387                                                                  
000388     PERFORM B20-ELABORA-POINTER2                                 
000389        THRU B20-EX                                               
000390             UNTIL WS-SQLCODE        = 100                        
000391                OR T358-TIPORECO NOT = WS-TIPORECO                
000392                OR T358-CODSOCIE NOT = WS-CODSOCIE                
000393                OR T358-CENCOSTO NOT = WS-CENCOSTO                
000394                OR T358-SOCIEFAT NOT = WS-SOCIEFAT                
000395                OR T358-CONTODCE NOT = WS-CONTODCE                
000396                OR T358-CENCOTRA NOT = WS-CENCOTRA                
000397                OR T358-AANUMFAT NOT = WS-AANUMFAT                
000398                                                                  
000399     PERFORM B30-INSERISCI                                        
000400        THRU B30-EX.                                              
000401                                                                  
000402 B10-EX. EXIT.                                                    
000403*----------------------------------------------------------------*
000404 B11-CERCA-NUMERO.                                                
000405*----------------------------------------------------------------*
000406                                                                  
000407     MOVE SPACES                 TO  DCNUME.                      
000408     MOVE 'R'                    TO  DCNU-FLAGOPER.               
000409     MOVE 'NETMCOST'             TO  DCNU-SIGLNUME.               
000410     PERFORM L50-SCANUME                                          
000411        THRU L50-EX.                                              
000412                                                                  
000413     MOVE DCNU-NUMEAUTO          TO  WS-NUMEAUTO.                 
000414     ADD 1                       TO  WS-FATTUR7 .                 
000415                                                                  
000416     MOVE WS-NUMEAUTO            TO  DCNU-NUMEAUTO.               
000417     MOVE 'U'                    TO  DCNU-FLAGOPER.               
000418     MOVE 'NETMCOST'             TO  DCNU-SIGLNUME.               
000419     PERFORM L50-SCANUME                                          
000420        THRU L50-EX.                                              
000421                                                                  
000422 B11-EX. EXIT.                                                    
000423*----------------------------------------------------------------*
000424 B20-ELABORA-POINTER2.                                            
000425*----------------------------------------------------------------*
000426                                                                  
000427     ADD  T358-IMPCOSTO          TO WS-IMPTRPAG                   
000428                                                                  
000429     IF WS-SOCIEFAT = '22'                                        
000430        ADD  T358-IMCOSATT       TO WS-IMPTRLIS.                  
000431                                                                  
000432     PERFORM L45-FETCH-POINTER2                                   
000433        THRU L45-EX.                                              
000434                                                                  
000435 B20-EX. EXIT.                                                    
000436*----------------------------------------------------------------*
000437 B30-INSERISCI.                                                   
000438*----------------------------------------------------------------*
000439                                                                  
000440     INITIALIZE                     DCLTCOSTRASPCDC               
000441                                                                  
000442     MOVE WS-SOCIEFAT            TO T308-SOCIEFAT                 
000443     MOVE WS-FINEMESE            TO T308-DTFATTUR                 
000444     MOVE WS-CODSOCIE            TO T308-CODSOCIE                 
000445     MOVE WS-FATTURA             TO T308-AANUMFAT                 
000446     MOVE WS-CODSOCIE            TO T308-SOCIEPAS                 
000447     MOVE '000'                  TO T308-PAESPROV                 
000448                                                                  
000449     MOVE WS-CENCOSTO(4:2)       TO A528-CDRAGCEN                 
000450     PERFORM L40-SELECT-PAESI                                     
000451        THRU L40-EX                                               
000452     MOVE A528-CODPAESE          TO T308-PAESMERC                 
000453                                    T308-PAESORDI                 
000454                                                                  
000455     IF WS-CENCOSTO(1:1) = '1'                                    
000456        MOVE 'F'                 TO T308-TIPOARTI                 
000457     ELSE                                                         
000458        IF WS-CENCOSTO(1:1) = '3'                                 
000459           MOVE 'C'              TO T308-TIPOARTI                 
000460        ELSE                                                      
000461           MOVE 'T'              TO T308-TIPOARTI.                
000462                                                                  
000463     MOVE WS-CONTODCE            TO T308-CONTODCE                 
000464     MOVE WS-CENCOSTO            TO T308-CENCOSTO                 
000465     MOVE WS-CENCOTRA            TO T308-CENCOTRA                 
000466     MOVE WS-IMPTRPAG            TO T308-IMPTRPAG                 
000467                                                                  
000468     MOVE WS-DTGIORNO            TO T308-DTCREAZI                 
000469                                    T308-DTULTVAR                 
000470     MOVE 'AVFT75'               TO T308-CODUTVAR                 
000471                                                                  
000472     MOVE 'A'                    TO T308-TIPOELAB                 
000473     IF WS-SOCIEFAT = '22'                                        
000474        MOVE 'V'                 TO T308-TIPOELAB.                
000475     MOVE WS-IMPTRLIS            TO T308-IMPTRLIS                 
000476                                                                  
000477     IF WS-SOCIEFAT = '22' AND                                    
000478        WS-IMPTRLIS > 0                                           
000479        MOVE WS-CODSOCIE         TO WS-SOCICONS                   
000480        MOVE WS-SOCIEFAT         TO A901-CODSOCIE                 
000481        PERFORM L30-SELECT-CLIENTI                                
000482           THRU L30-EX                                            
000483        IF A901-CAPOCONT > ' '                                    
000484           MOVE A901-CAPOCONT    TO L652-CODCLIEN                 
000485           MOVE WS-SOCIEFAT      TO L652-CODSOCIE                 
000486           MOVE WS-FINEMESE(1:6) TO L652-AAMMCOMP                 
000487           MOVE WS-CONTODCE      TO L652-CONTODCE                 
000488           MOVE WS-CENCOSTO      TO L653-CENCOSTD                 
000489           MOVE WS-CENCOTRA      TO L653-CENCOSTA                 
000490           PERFORM L35-SELECT-ORDILOGI                            
000491              THRU L35-EX                                         
000492           MOVE L653-AANUMORD    TO T308-AANUMORD                 
000493           MOVE L653-NRRIGORD    TO T308-NRRIGORD.                
000494                                                                  
000495     MOVE WS-TIPORECO            TO T308-TIPORECO.                
000496                                                                  
000497     PERFORM W10-INSERT-COSTRASPCDC                               
000498        THRU W10-EX.                                              
000499                                                                  
000500 B30-EX. EXIT.                                                    
000501*----------------------------------------------------------------*
000502*B50-ELABORA-POINTER1.                                            
000503*----------------------------------------------------------------*
000504*                                                                 
000505*    IF A203-IMPCOSTO > 0                                         
000506*       MOVE 'DB2'              TO A203-TIPOELAB                  
000507*       PERFORM B60-SCRIVI-XRATEI                                 
000508*          THRU B60-EX.                                           
000509*                                                                 
000510*    PERFORM L00-FETCH-POINTER1                                   
000511*       THRU L00-EX.                                              
000512*                                                                 
000513*B50-EX. EXIT.                                                    
000514*----------------------------------------------------------------*
000515 B60-SCRIVI-XRATEI.                                               
000516*----------------------------------------------------------------*
000517*--> NEL MODULO VIENE PRESA LA DATA DEL GIORNO PER CERCARE        
000518*--> IL CAMBIO.                                                   
000519*--> POTREBBE ESERE IL GIORNO DEL FINE MESE X LA COXMA650         
000520*--> OPPURE IL PRIMO GIORNO MESE PER LA AFFRLO45.                 
000521*--> SE SERVISSE FARE DELLE PROVE DELLA AFFRLO45 FUORI            
000522*--> DELL'INIZIO MESE, OCCORRE IMPOSTARE LA DATA X LE PROVE       
000523*--> AD ESEMPIO:                                                  
000524*****   MOVE '20240901'          TO CAMB-DTCAMBIO                 
000525                                                                  
000526     IF A203-CODDIVIS NOT = '75' AND                              
000527        A203-IMPCOSTO     > 0                                     
000528        MOVE SPACES              TO DCWCAMB                       
000529        INITIALIZE                  DCWCAMB                       
000530        MOVE A203-CODDIVIS       TO CAMB-CODDIVIS                 
000531        MOVE '75'                TO CAMB-CODCAMBI                 
000532        MOVE '75'                TO CAMB-CODDRIFE                 
000533        MOVE A203-IMPCOSTO       TO CAMB-IMPORTOO(1)              
000534        PERFORM L25-LINK-SCBCB10                                  
000535           THRU L25-EX                                            
000536        MOVE CAMB-CONTROVA(1)    TO A203-IMPCOSTO                 
000537        MOVE '75'                TO A203-CODDIVIS.                
000538                                                                  
000539     MOVE WS-FINEMESE            TO A203-ANNOMESE                 
000540                                                                  
000541     IF A203-SOCIEFAT = '22'                                      
000542        MOVE '16'                TO A203-SOCIEFAT.                
000543                                                                  
000544     IF A203-DIVIFATT NOT > SPACES                                
000545        MOVE 'T'                 TO A203-DIVIFATT                 
000546        IF A203-SOCIEFAT = '16'                                   
000547           MOVE 'V'              TO A203-DIVIFATT.                
000548                                                                  
000549     IF A203-CODSOCIE = '22'                                      
000550        MOVE '16'                TO A203-CODSOCIE.                
000551                                                                  
000552     IF A203-CODSOCIE > ' '                                       
000553        IF A203-DIVIPROP NOT > SPACES                             
000554           MOVE 'T'              TO A203-DIVIPROP                 
000555           IF A203-CODSOCIE = '16'                                
000556              MOVE 'V'           TO A203-DIVIPROP.                
000557                                                                  
000558     MOVE A203-SOCIEFAT          TO A531-CODSOCIE                 
000559     PERFORM L05-SELECT-SOCIETA                                   
000560        THRU L05-EX                                               
000561                                                                  
000562     IF A203-CONTODCE(1:1) = 'G'                                  
000563        EVALUATE A203-CONTODCE                                    
000564            WHEN 'G80008'                                         
000565                 MOVE '620101'   TO A203-CONTODCE                 
000566            WHEN 'G80009'                                         
000567                 MOVE '620200'   TO A203-CONTODCE                 
000568            WHEN 'G80010'                                         
000569                 MOVE '620102'   TO A203-CONTODCE                 
000570            WHEN 'G80011'                                         
000571                 MOVE '620103'   TO A203-CONTODCE                 
000572        END-EVALUATE.                                             
000573                                                                  
000574     IF A203-CONTODCE NOT > SPACES                                
000575        MOVE SPACES              TO A203-TIPOADDE                 
000576     ELSE                                                         
000577        MOVE A531-CODPIANO       TO C861-CODPIANO                 
000578        MOVE A203-CONTODCE       TO C861-CONTODCE                 
000579        PERFORM L15-SELECT-CONTIDCE                               
000580           THRU L15-EX                                            
000581        IF SQLCODE = 100 AND                                      
000582           A531-CODPIANO NOT = '$I'                               
000583           MOVE '$I'             TO C861-CODPIANO                 
000584            PERFORM L15-SELECT-CONTIDCE                           
000585               THRU L15-EX                                        
000586        END-IF                                                    
000587        IF C861-CONTGRUP = SPACES                                 
000588           MOVE SPACES           TO A203-TIPOADDE                 
000589        ELSE                                                      
000590           EVALUATE C861-CONTGRUP                                 
000591               WHEN '625000'                                      
000592                    MOVE '04'    TO A203-TIPOADDE                 
000593               WHEN '625002'                                      
000594                    MOVE '04'    TO A203-TIPOADDE                 
000595               WHEN '625004'                                      
000596                    MOVE '04'    TO A203-TIPOADDE                 
000597               WHEN '625092'                                      
000598                    MOVE '04'    TO A203-TIPOADDE                 
000599               WHEN '625001'                                      
000600                    MOVE '65'    TO A203-TIPOADDE                 
000601               WHEN '625093'                                      
000602                    MOVE '65'    TO A203-TIPOADDE                 
000603               WHEN '608000'                                      
000604                    MOVE '02'    TO A203-TIPOADDE                 
000605               WHEN '608002'                                      
000606                    MOVE '62'    TO A203-TIPOADDE                 
000607           END-EVALUATE.                                          
000608                                                                  
000609     IF A203-CENCOTRA NOT > SPACES                                
000610        MOVE SPACES              TO A203-TIPOADDE                 
000611        MOVE SPACES              TO A203-CDMCAGTM                 
000612        MOVE SPACES              TO A203-CDAREGTM                 
000613        MOVE SPACES              TO A203-CDDIPGTM                 
000614     ELSE                                                         
000615        MOVE A203-CENCOTRA       TO A982-CENCOSTO                 
000616        MOVE A203-SOCIEFAT       TO A982-CODSOCIE                 
000617        MOVE A203-DIVIFATT       TO A982-CDDIVISI                 
000618        PERFORM L20-SELECT-CENCOSTO                               
000619           THRU L20-EX.                                           
000620        IF SQLCODE = 100 OR A982-ANNULLAM > SPACES                
000621           MOVE SPACES           TO A203-TIPOADDE                 
000622        END-IF                                                    
000623        MOVE A982-CDMCAGTM       TO A203-CDMCAGTM                 
000624        MOVE A982-CDAREGTM       TO A203-CDAREGTM                 
000625        MOVE A982-CDDIPGTM       TO A203-CDDIPGTM.                
000626                                                                  
000627     MOVE SPACES                 TO A203-CODFOMER.                
000628     IF WS-CODFOMER > SPACES                                      
000629        MOVE WS-CODFOMER         TO A203-CODFOMER                 
000630     ELSE                                                         
000631        IF A203-TIPORECO = 'IMPF'                                 
000632           MOVE A203-AANUMFAT    TO S222-AANUMMOV                 
000633           PERFORM L10-SELECT-FATTFORN                            
000634              THRU L10-EX                                         
000635           MOVE S222-FORNFATT    TO A203-CODFOMER.                
000636                                                                  
000637     MOVE A203-CENCOTRA          TO A203-KEYADDE1                 
000638     MOVE 'TRA'                  TO A203-KEYADDE2                 
000639     MOVE A203-CODSOCIE          TO A203-KEYADDE3                 
000640     MOVE A203-SOCIEFAT          TO A203-KEYADDE4                 
000641     IF A203-CODFOMER > ' '                                       
000642        MOVE A203-CODFOMER       TO A203-KEYADDE4.                
000643                                                                  
000644     MOVE WS-FINEMESE            TO A203-DTCREAZI                 
000645                                    A203-DTULTVAR                 
000646     MOVE 'AVFT80'               TO A203-CODUTVAR                 
000647     PERFORM W20-INSERT-RATEINM                                   
000648        THRU W20-EX.                                              
000649                                                                  
000650 B60-EX. EXIT.                                                    
000651*----------------------------------------------------------------*
000652*C00-ELABORA-FASHION.                                             
000653*----------------------------------------------------------------*
000654*                                                                 
000655*--- CURRENT DATE                                                 
000656*--- I RATEI FASHION CI VENGONO PASSATI TUTTE LE NOTTI (TESI LI   
000657*--- APPOGGIA VERSO LE ORE 01.00, NOI LI PRENDIAMO VERSO LE ORE   
000658*--- 02.00)                                                       
000659*--- DAL MOMENTO CHE CI SERVONO SOLO I RATEI DI FINE MESE E DATO  
000660*--- CHE NON ABBIAMO LA CERTEZZA DELL'ORA ESATTA DEL CAMBIO       
000661*--- DI DATA SU TDATEELAB, NEL DUBBIO USIAMO CURRENT DATE, ELABO- 
000662*--- RANDO SOLO QUANDO IL GIORNO E' PARI A '01', SEMPRE SPERANDO  
000663*--- CHE I FILE CI ARRIVINO ALL'ORA CORRETTA.                     
000664*                                                                 
000665*    MOVE 'C00-'                 TO WCOM-CODABEND                 
000666*    MOVE 'SELECT'               TO WCOM-FILEFUNZ                 
000667*    MOVE 'DATEDATE'             TO WCOM-FILENOME                 
000668*    MOVE SPACES                 TO WCOM-FILECTRL                 
000669*    EXEC SQL                                                     
000670*         SELECT HEX(CURRENT DATE)                                
000671*           INTO :WS-CURRDATE                                     
000672*           FROM DANAGRAF.VANAGRAF_082                            
000673*    END-EXEC                                                     
000674*    IF SQLCODE NOT = 0                                           
000675*       PERFORM Z00-ERRORE                                        
000676*          THRU Z00-EX.                                           
000677*                                                                 
000678*    IF WS-CURRDATE(7:2) NOT = '01'                               
000679*       GO TO C00-EX.                                             
000680*                                                                 
000681*    MOVE WS-FINEMESE            TO A203-ANNOMESE                 
000682*    MOVE 'TXT'                  TO A203-TIPOELAB                 
000683*    PERFORM W00-DELETE-RATEINM                                   
000684*       THRU W00-EX                                               
000685*                                                                 
000686*    OPEN INPUT  RATEINP.                                         
000687*    PERFORM L55-LEGGI-RATEINP                                    
000688*       THRU L55-EX.                                              
000689*    PERFORM C10-ELABORA-RATEINP                                  
000690*       THRU C10-EX                                               
000691*            UNTIL EOF = 'S'                                      
000692*    CLOSE RATEINP.                                               
000693*                                                                 
000694*C00-EX. EXIT.                                                    
000695*----------------------------------------------------------------*
000696*C10-ELABORA-RATEINP.                                             
000697*----------------------------------------------------------------*
000698*                                                                 
000699*    MOVE 'TXT'                 TO A203-TIPOELAB                  
000700*    PERFORM B60-SCRIVI-XRATEI                                    
000701*       THRU B60-EX.                                              
000702*                                                                 
000703*    PERFORM L55-LEGGI-RATEINP                                    
000704*       THRU L55-EX.                                              
000705*                                                                 
000706*C10-EX. EXIT.                                                    
000707*----------------------------------------------------------------*
000708 D00-ELABORA-RATEI.                                               
000709*----------------------------------------------------------------*
000710                                                                  
000711*--- CURRENT DATE                                                 
000712*--- I RATEI FASHION CI VENGONO PASSATI TUTTE LE NOTTI (TESI LI   
000713*--- APPOGGIA VERSO LE ORE 01.00, NOI LI PRENDIAMO VERSO LE ORE   
000714*--- 02.00)                                                       
000715*--- DAL MOMENTO CHE CI SERVONO SOLO I RATEI DI FINE MESE E DATO  
000716*--- CHE NON ABBIAMO LA CERTEZZA DELL'ORA ESATTA DEL CAMBIO       
000717*--- DI DATA SU TDATEELAB, NEL DUBBIO USIAMO CURRENT DATE, ELABO- 
000718*--- RANDO SOLO QUANDO IL GIORNO E' PARI A '01', SEMPRE SPERANDO  
000719*--- CHE I FILE CI ARRIVINO ALL'ORA CORRETTA.                     
000720                                                                  
000721     MOVE 'D00-'                 TO WCOM-CODABEND                 
000722     MOVE 'SELECT'               TO WCOM-FILEFUNZ                 
000723     MOVE 'DATEDATE'             TO WCOM-FILENOME                 
000724     MOVE SPACES                 TO WCOM-FILECTRL                 
000726     
      *EXEC SQL 
      *SELECT HEX(CURRENT DATE)                                
000727*            INTO :WS-CURRDATE                                     
000728*            FROM DANAGRAF.VANAGRAF_082                            
000729*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 1 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CURRDATE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000730     IF SQLCODE NOT = 0                                           
000731        PERFORM Z00-ERRORE                                        
000732           THRU Z00-EX.                                           
000733                                                                  
000734     IF WS-CURRDATE(7:2) NOT = '01'                               
000735        GO TO D00-EX.                                             
000736                                                                  
000737                                                                  
000738     MOVE WS-FINEMESE            TO A203-ANNOMESE                 
000739     MOVE 'RAT'                  TO WS-TIPOELAB-1                 
000740     MOVE 'RAF'                  TO WS-TIPOELAB-2                 
000741     PERFORM W01-DELETE-RATEINM                                   
000742        THRU W01-EX                                               
000743                                                                  
000744     OPEN INPUT  RATEINP.                                         
000745     PERFORM L70-LEGGI-RATEINP                                    
000746        THRU L70-EX.                                              
000747     PERFORM D10-ELABORA-RATEINP                                  
000748        THRU D10-EX                                               
000749             UNTIL EOF = 'S'                                      
000750     CLOSE RATEINP.                                               
000751                                                                  
000752 D00-EX. EXIT.                                                    
000753*----------------------------------------------------------------*
000754 D10-ELABORA-RATEINP.                                             
000755*----------------------------------------------------------------*
000756                                                                  
000757     MOVE 'RAT'                 TO A203-TIPOELAB.                 
000758     IF WS-ESTRAI = 'F'                                           
000759        MOVE 'RAF'              TO A203-TIPOELAB.                 
000760                                                                  
000761     PERFORM B60-SCRIVI-XRATEI                                    
000762        THRU B60-EX.                                              
000763                                                                  
000764     PERFORM L70-LEGGI-RATEINP                                    
000765        THRU L70-EX.                                              
000766                                                                  
000767 D10-EX. EXIT.                                                    
000768*----------------------------------------------------------------*
000769*L00-FETCH-POINTER1.                                              
000770*----------------------------------------------------------------*
000771*                                                                 
000772*    MOVE 'L00-'                 TO WCOM-CODABEND.                
000773*    MOVE 'FETCH'                TO WCOM-FILEFUNZ.                
000774*    MOVE 'POINTER1'             TO WCOM-FILENOME.                
000775*                                                                 
000776*    INITIALIZE                     DCLTRATEINM                   
000777*                                                                 
000778*    EXEC SQL                                                     
000779*         FETCH POINTER1                                          
000780*          INTO :A203-SOCIEFAT, :A203-CODSOCIE, :A203-AANUMFAT    
000781*              ,:A203-TIPORECO, :A203-CONTODCE, :A203-CENCOTRA    
000782*              ,:A203-CODDIVIS, :A203-CODFORNI, :A203-MERCEMAG    
000783*              ,:A203-CENCOSTO, :A203-NRPREFAT, :A203-DTPREFAT    
000784*              ,:A203-STPREFAT, :A203-DTFATTUR                    
000785*              ,:A203-PROLOMER, :A203-CODLINEA, :A203-NRDOCCOT    
000786*              ,:A203-DTSPEDIZ                                    
000787*              ,:A203-IMPCOSTO, :A203-NUMPROG5                    
000788*    END-EXEC.                                                    
000789*    IF SQLCODE = 0                                               
000790*       MOVE 'U'                 TO PPROUTIN                      
000791*       MOVE 'D'                 TO PPTPFILE                      
000792*       MOVE 'R'                 TO PPTPOPER                      
000793*       MOVE 'TER1'              TO PPNMFILE                      
000794*       PERFORM Z90-READPRIN                                      
000795*          THRU Z90-EX.                                           
000796*                                                                 
000797*L00-EX. EXIT.                                                    
000798*----------------------------------------------------------------*
000799 L05-SELECT-SOCIETA.                                              
000800*----------------------------------------------------------------*
000801                                                                  
000802     MOVE 'L05-'                 TO WCOM-CODABEND.                
000803     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
000804     MOVE 'SOCIETA'              TO WCOM-FILENOME.                
000805     MOVE A531-CODSOCIE          TO WCOM-FILECTRL.                
000806                                                                  
000807     MOVE SPACES                 TO A531-CODPIANO.                
000809     
      *EXEC SQL 
      *SELECT CODPIANO                                         
000810*            INTO :A531-CODPIANO                                   
000811*            FROM DANAGRAF.TSOCIETA                                
000812*           WHERE CODSOCIE = :A531-CODSOCIE                        
000813*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 2 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODPIANO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000814     IF SQLCODE = 0                                               
000815        MOVE 'U'                 TO PPROUTIN                      
000816        MOVE 'D'                 TO PPTPFILE                      
000817        MOVE 'R'                 TO PPTPOPER                      
000818        MOVE 'SOCIETA'           TO PPNMFILE                      
000819        PERFORM Z90-READPRIN                                      
000820           THRU Z90-EX.                                           
000821                                                                  
000822 L05-EX. EXIT.                                                    
000823*----------------------------------------------------------------*
000824 L10-SELECT-FATTFORN.                                             
000825*----------------------------------------------------------------*
000826                                                                  
000827     MOVE 'L10-'                 TO WCOM-CODABEND.                
000828     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
000829     MOVE 'FATTFORN'             TO WCOM-FILENOME.                
000830     MOVE S222-AANUMMOV          TO WCOM-FILECTRL.                
000831                                                                  
000832     MOVE SPACES                 TO S222-FORNFATT                 
000834     
      *EXEC SQL 
      *SELECT FORNFATT                                         
000835*            INTO :S222-FORNFATT                                   
000836*            FROM DSIFO.TFATTFORN                                  
000837*           WHERE AANUMMOV = :S222-AANUMMOV                        
000838*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 4 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S222-AANUMMOV
            BY VALUE 0
                     0

           MOVE 5 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S222-FORNFATT
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 4 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000839     IF SQLCODE = 0                                               
000840        MOVE 'U'                 TO PPROUTIN                      
000841        MOVE 'D'                 TO PPTPFILE                      
000842        MOVE 'R'                 TO PPTPOPER                      
000843        MOVE 'FATTFORN'          TO PPNMFILE                      
000844        PERFORM Z90-READPRIN                                      
000845           THRU Z90-EX.                                           
000846                                                                  
000847 L10-EX. EXIT.                                                    
000848*----------------------------------------------------------------*
000849 L15-SELECT-CONTIDCE.                                             
000850*----------------------------------------------------------------*
000851                                                                  
000852     MOVE 'L15-'                 TO WCOM-CODABEND.                
000853     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
000854     MOVE 'TCONTIDCE'            TO WCOM-FILENOME.                
000855     MOVE SPACES                 TO WCOM-FILECTRL.                
000856     STRING C861-CODPIANO ' ' C861-CONTODCE ' '                   
000857             DELIMITED BY SIZE INTO WCOM-FILECTRL.                
000858                                                                  
000859     MOVE SPACES                 TO C861-CONTGRUP.                
000860                                                                  
000862     
      *EXEC SQL 
      *SELECT CONTGRUP                                         
000863*            INTO :C861-CONTGRUP                                   
000864*            FROM DCONTCLI.TCONTIDCE                               
000865*           WHERE CODPIANO = :C861-CODPIANO                        
000866*             AND CONTODCE = :C861-CONTODCE                        
000867*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 6 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CODPIANO
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTODCE
            BY VALUE 0
                     0

           MOVE 7 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTGRUP
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 5 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000868                                                                  
000869     IF SQLCODE = ZERO                                            
000870        MOVE 'U'           TO PPROUTIN                            
000871        MOVE 'D'           TO PPTPFILE                            
000872        MOVE 'R'           TO PPTPOPER                            
000873        MOVE 'TCONTIDCE'   TO PPNMFILE                            
000874        PERFORM Z90-READPRIN                                      
000875           THRU Z90-EX.                                           
000876                                                                  
000877 L15-EX. EXIT.                                                    
000878*----------------------------------------------------------------*
000879 L20-SELECT-CENCOSTO.                                             
000880*----------------------------------------------------------------*
000881                                                                  
000882     MOVE 'L20-'                 TO WCOM-CODABEND.                
000883     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
000884     MOVE 'TCENCOSTO'            TO WCOM-FILENOME.                
000885     MOVE SPACES                 TO WCOM-FILECTRL.                
000886     STRING A982-CODSOCIE ' ' A982-CENCOSTO '  ' A982-CDDIVISI    
000887             DELIMITED BY SIZE INTO WCOM-FILECTRL.                
000888                                                                  
000889     MOVE SPACES                 TO A982-CDMCAGTM.                
000890     MOVE SPACES                 TO A982-CDAREGTM.                
000891     MOVE SPACES                 TO A982-CDDIPGTM.                
000892     MOVE SPACES                 TO A982-ANNULLAM.                
000893                                                                  
000895     
      *EXEC SQL 
      *SELECT CDMCAGTM, CDAREGTM                               
000896*                ,CDDIPGTM, ANNULLAM                               
000897*            INTO :A982-CDMCAGTM, :A982-CDAREGTM                   
000898*                ,:A982-CDDIPGTM, :A982-ANNULLAM                   
000899*            FROM DANAGRAF.TCENCOSTO                               
000900*           WHERE CODSOCIE = :A982-CODSOCIE                        
000901*             AND CENCOSTO = :A982-CENCOSTO                        
000902*             AND CDDIVISI = :A982-CDDIVISI                        
000903*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 8 TO SQL-STMT-ID 
           MOVE 3 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A982-CODSOCIE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A982-CENCOSTO
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A982-CDDIVISI
            BY VALUE 0
                     0

           MOVE 9 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A982-CDMCAGTM
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A982-CDAREGTM
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A982-CDDIPGTM
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A982-ANNULLAM
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 6 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000904                                                                  
000905     IF SQLCODE = ZERO                                            
000906        MOVE 'U'           TO PPROUTIN                            
000907        MOVE 'D'           TO PPTPFILE                            
000908        MOVE 'R'           TO PPTPOPER                            
000909        MOVE 'TCENCOSTO'   TO PPNMFILE                            
000910        PERFORM Z90-READPRIN                                      
000911           THRU Z90-EX.                                           
000912                                                                  
000913 L20-EX. EXIT.                                                    
000914*----------------------------------------------------------------*
000915 L25-LINK-SCBCB10.                                                
000916*----------------------------------------------------------------*
000917                                                                  
000918     MOVE  'L25-'                TO WCOM-CODABEND.                
000919     MOVE  'SCBCB10'             TO WCOM-FILENOME.                
000920     MOVE  'LINK'                TO WCOM-FILEFUNZ.                
000921     MOVE   DCWCAMB              TO WCOM-FILECTRL.                
000922                                                                  
000923     MOVE 'SCBCB10'              TO PPCALL.                       
000924     CALL PPCALL USING DCPARM DCWCAMB.                            
000925                                                                  
000926     IF CAMB-RETCOD NOT = '****'                                  
000927        PERFORM Z00-ERRORE                                        
000928           THRU Z00-EX                                            
000929     ELSE                                                         
000930        MOVE 'U'                 TO PPROUTIN                      
000931        MOVE 'D'                 TO PPTPFILE                      
000932        MOVE 'R'                 TO PPTPOPER                      
000933        MOVE 'SCBCB10'           TO PPNMFILE                      
000934        PERFORM Z90-READPRIN                                      
000935           THRU Z90-EX.                                           
000936                                                                  
000937 L25-EX. EXIT.                                                    
000938*----------------------------------------------------------------*
000939 L30-SELECT-CLIENTI.                                              
000940*----------------------------------------------------------------*
000941                                                                  
000942     MOVE 'L30-'                 TO WCOM-CODABEND                 
000943     MOVE 'CLIENTI'              TO WCOM-FILENOME                 
000944     MOVE 'SELECT'               TO WCOM-FILEFUNZ                 
000945     MOVE SPACES                 TO WCOM-FILECTRL                 
000946     STRING A901-CODSOCIE ' ' WS-SOCICONS                         
000947     DELIMITED BY SIZE         INTO WCOM-FILECTRL                 
000948                                                                  
000949     MOVE SPACES                 TO A901-CAPOCONT                 
000950                                                                  
000952     
      *EXEC SQL 
      *SELECT DISTINCT C.CAPOCONT                              
000953*            INTO :A901-CAPOCONT                                   
000954*            FROM DANAGRAF.TCLIENTI C                              
000955*                ,DANAGRAF.TSOCIETA S                              
000956*           WHERE C.CLIFOCON = S.CODFORNI                          
000957*             AND C.CLIFOCON > ' '                                 
000958*             AND C.TIPOCONS = 'T'                                 
000959*             AND C.CODSOCIE = :A901-CODSOCIE                      
000960*             AND S.CODSOCIE = :WS-SOCICONS                        
000961*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 10 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODSOCIE
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-SOCICONS
            BY VALUE 0
                     0

           MOVE 11 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CAPOCONT
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 7 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000962                                                                  
000963     IF SQLCODE = 0                                               
000964        MOVE 'U'                 TO PPROUTIN                      
000965        MOVE 'D'                 TO PPTPFILE                      
000966        MOVE 'R'                 TO PPTPOPER                      
000967        MOVE WCOM-FILENOME       TO PPNMFILE                      
000968        PERFORM Z90-READPRIN                                      
000969           THRU Z90-EX.                                           
000970                                                                  
000971 L30-EX. EXIT.                                                    
000972*----------------------------------------------------------------*
000973 L35-SELECT-ORDILOGI.                                             
000974*----------------------------------------------------------------*
000975                                                                  
000976     MOVE 'L35-'                 TO WCOM-CODABEND                 
000977     MOVE 'ORDILOGI'             TO WCOM-FILENOME                 
000978     MOVE 'SELECT'               TO WCOM-FILEFUNZ                 
000979     MOVE SPACES                 TO WCOM-FILECTRL                 
000980     STRING L652-CODCLIEN ' '                                     
000981            L652-CODSOCIE ' '                                     
000982            L652-AAMMCOMP ' '                                     
000983            L652-CONTODCE ' '                                     
000984            L653-CENCOSTD ' '                                     
000985            L653-CENCOSTA ' '                                     
000986     DELIMITED BY SIZE         INTO WCOM-FILECTRL                 
000987                                                                  
000988     MOVE SPACES                 TO L653-AANUMORD                 
000989     MOVE ZEROS                  TO L653-NRRIGORD                 
000991     
      *EXEC SQL 
      *SELECT R.AANUMORD, R.NRRIGORD                           
000992*            INTO :L653-AANUMORD, :L653-NRRIGORD                   
000993*            FROM DLOGISTI.TORDILOGI    T                          
000994*                ,DLOGISTI.TRIGORDILOGI R                          
000995*           WHERE T.AANUMORD = R.AANUMORD                          
000996*             AND T.CODSOCIE = :L652-CODSOCIE                      
000997*             AND T.CODCLIEN = :L652-CODCLIEN                      
000998*             AND T.AAMMCOMP = :L652-AAMMCOMP                      
000999*             AND T.CONTODCE = :L652-CONTODCE                      
001000*             AND R.DTANNULL = ' '                                 
001001*             AND R.CENCOSTD = :L653-CENCOSTD                      
001002*             AND R.CENCOSTA = :L653-CENCOSTA                      
001003*           FETCH FIRST 1 ROWS ONLY                                
001004*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 12 TO SQL-STMT-ID 
           MOVE 6 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODSOCIE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODCLIEN
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AAMMCOMP
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CONTODCE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CENCOSTD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CENCOSTA
            BY VALUE 0
                     0

           MOVE 13 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-AANUMORD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-NRRIGORD
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 8 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001005                                                                  
001006     IF SQLCODE = 0                                               
001007        MOVE 'U'                 TO PPROUTIN                      
001008        MOVE 'D'                 TO PPTPFILE                      
001009        MOVE 'R'                 TO PPTPOPER                      
001010        MOVE WCOM-FILENOME       TO PPNMFILE                      
001011        PERFORM Z90-READPRIN                                      
001012           THRU Z90-EX.                                           
001013                                                                  
001014 L35-EX. EXIT.                                                    
001015*----------------------------------------------------------------*
001016 L40-SELECT-PAESI.                                                
001017*----------------------------------------------------------------*
001018                                                                  
001019     MOVE 'L40-'                 TO WCOM-CODABEND.                
001020     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001021     MOVE 'PAESI'                TO WCOM-FILENOME.                
001022     MOVE A528-CDRAGCEN          TO WCOM-FILECTRL                 
001023                                                                  
001024     MOVE SPACES                 TO A528-CODPAESE                 
001026     
      *EXEC SQL 
      *SELECT CODPAESE                                         
001027*            INTO :A528-CODPAESE                                   
001028*            FROM DANAGRAF.TPAESI                                  
001029*           WHERE CDRAGCEN = :A528-CDRAGCEN                        
001030*           FETCH FIRST 1 ROWS ONLY                                
001031*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 14 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A528-CDRAGCEN
            BY VALUE 0
                     0

           MOVE 15 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A528-CODPAESE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 9 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001032                                                                  
001033     IF SQLCODE = ZEROES                                          
001034        MOVE 'U'                 TO PPROUTIN                      
001035        MOVE 'D'                 TO PPTPFILE                      
001036        MOVE 'R'                 TO PPTPOPER                      
001037        MOVE 'PAESI'             TO PPNMFILE                      
001038        PERFORM Z90-READPRIN                                      
001039           THRU Z90-EX.                                           
001040                                                                  
001041 L40-EX. EXIT.                                                    
001042*----------------------------------------------------------------*
001043 L45-FETCH-POINTER2.                                              
001044*----------------------------------------------------------------*
001045                                                                  
001046     MOVE 'L45-'                 TO WCOM-CODABEND                 
001047     MOVE 'POINTER2'             TO WCOM-FILENOME                 
001048     MOVE 'FETCH'                TO WCOM-FILEFUNZ                 
001049                                                                  
001051     
      *EXEC SQL 
      *FETCH POINTER2                                          
001052*           INTO :T358-SOCIEFAT                                    
001053*               ,:T358-CODSOCIE                                    
001054*               ,:T358-CONTODCE                                    
001055*               ,:T358-CENCOSTO                                    
001056*               ,:T358-CENCOTRA                                    
001057*               ,:T358-TIPORECO                                    
001058*               ,:T358-DATATRAS                                    
001059*               ,:T358-DTPREATT                                    
001060*               ,:T358-IMPCOSTO                                    
001061*               ,:T358-IMCOSATT                                    
001062*               ,:T358-AANUMFAT                                    
001063*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 16 TO SQL-STMT-ID 
           MOVE 11 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-SOCIEFAT
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-CODSOCIE
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-CONTODCE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-CENCOSTO
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-CENCOTRA
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-TIPORECO
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-DATATRAS
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-DTPREATT
            BY VALUE 0
                     0

           MOVE 523 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-IMPCOSTO
            BY VALUE 0
                     0

           MOVE 523 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-IMCOSATT
            BY VALUE 0
                     0

           MOVE 20 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-AANUMFAT
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001064     MOVE SQLCODE                TO WS-SQLCODE                    
001065                                                                  
001066*--- SE LA DATATRAS OPPURE DTPREATT SONO VALORIZZATE E ANTE-      
001067*--- CEDENTI AL GIORNO DI INIZIO MESE, SCARTO IL RECORD PERCHE'   
001068*--- L'HO GIA' INSERITO NEI MESI PRECEDENTI                       
001069     IF SQLCODE = 0                                               
001070        IF (T358-DATATRAS > ' '          AND                      
001071            T358-DATATRAS < WS-INIZMESE) OR                       
001072           (T358-DTPREATT > ' '          AND                      
001073            T358-DTPREATT < WS-INIZMESE)                          
001074            GO TO L45-FETCH-POINTER2.                             
001075                                                                  
001076     IF SQLCODE = 0                                               
001077        MOVE 'U'                 TO PPROUTIN                      
001078        MOVE 'D'                 TO PPTPFILE                      
001079        MOVE 'R'                 TO PPTPOPER                      
001080        MOVE WCOM-FILENOME       TO PPNMFILE                      
001081        PERFORM Z90-READPRIN                                      
001082           THRU Z90-EX.                                           
001083                                                                  
001084 L45-EX. EXIT.                                                    
001085*----------------------------------------------------------------*
001086 L50-SCANUME.                                                     
001087*----------------------------------------------------------------*
001088                                                                  
001089     MOVE 'L50-'                 TO WCOM-CODABEND.                
001090     MOVE 'LETTURA'              TO WCOM-FILEFUNZ.                
001091     MOVE 'SCANUME'              TO WCOM-FILENOME.                
001092     MOVE DCNU-SIGLNUME          TO WCOM-FILECTRL.                
001093                                                                  
001094     MOVE 'SCANUME'              TO  PPCALL.                      
001095     CALL PPCALL  USING  DCPARM  DCNUME.                          
001096     IF DCNU-RISPOSTA NOT = '****'                                
001097        PERFORM Z00-ERRORE                                        
001098           THRU Z00-EX.                                           
001099                                                                  
001100     MOVE   'U'                  TO PPROUTIN.                     
001101     MOVE   'D'                  TO PPTPFILE.                     
001102     MOVE   'R'                  TO PPTPOPER.                     
001103     MOVE   'SCANUME'            TO PPNMFILE.                     
001104     PERFORM Z90-READPRIN                                         
001105        THRU Z90-EX.                                              
001106                                                                  
001107 L50-EX. EXIT.                                                    
001108*----------------------------------------------------------------*
001109*L55-LEGGI-RATEINP.                                               
001110*----------------------------------------------------------------*
001111*                                                                 
001112*    MOVE 'N'                    TO EOF                           
001113*    READ RATEINP INTO FSNET18                                    
001114*         AT END MOVE 'S'        TO EOF.                          
001115*                                                                 
001116*    IF EOF = 'N'                                                 
001117*       IF N18-ANAGSEND      NOT > ' '                            
001118*          MOVE N18-ANAGRECE     TO N18-ANAGSEND                  
001119*       END-IF                                                    
001120*       IF N18-ANAGSEND = '22A' OR '09V'                          
001121*          MOVE '16V'            TO N18-ANAGSEND                  
001122*       END-IF                                                    
001123*       IF N18-ANAGSEND          = '16V' AND                      
001124*         ( N18-ANAGPROP NOT > SPACES      OR                     
001125*          (N18-ANAGPROP = '22A' OR '09V') OR                     
001126*           N18-ANAGPROP(4:2) >  ' ' )                            
001127*          IF N18-ANAGPROP = '22A' OR '09V'                       
001128*             MOVE '16V'         TO N18-ANAGPROP                  
001129*          ELSE                                                   
001130*             MOVE SPACES        TO N18-ANAGPROP                  
001131*          END-IF                                                 
001132*       ELSE                                                      
001133*          GO TO L55-LEGGI-RATEINP.                               
001134*                                                                 
001135*    IF EOF = 'N'                                                 
001136*       IF N18-CONTODCE NOT > SPACES OR                           
001137*          N18-CENCOTRA NOT > SPACES                              
001138*          GO TO L55-LEGGI-RATEINP.                               
001139*                                                                 
001140*    IF EOF = 'N'                                                 
001141*       MOVE 'U'                 TO PPROUTIN                      
001142*       MOVE 'S'                 TO PPTPFILE                      
001143*       MOVE 'R'                 TO PPTPOPER                      
001144*       MOVE 'RATEINP'           TO PPNMFILE                      
001145*       PERFORM Z90-READPRIN                                      
001146*          THRU Z90-EX.                                           
001147*                                                                 
001148*    IF EOF = 'N'                                                 
001149*       MOVE SPACES                 TO DCLTRATEINM                
001150*       INITIALIZE DCLTRATEINM                                    
001151*       MOVE N18-ANAGSEND(1:2)      TO A203-SOCIEFAT              
001152*       MOVE N18-ANAGSEND(3:1)      TO A203-DIVIFATT              
001153*       MOVE N18-CONTODCE           TO A203-CONTODCE              
001154*       MOVE N18-CENCOTRA           TO A203-CENCOTRA              
001155*       MOVE N18-SIGLADIV           TO A963-SLDIVBAN              
001156*       PERFORM L60-SELECT-DIVISE                                 
001157*          THRU L60-EX                                            
001158*       MOVE A963-CODDIVIS          TO A203-CODDIVIS              
001159*       MOVE N18-IMPOADDE           TO A203-IMPCOSTO              
001160*       MOVE N18-ANAGPROP           TO A203-CODSOCIE              
001161*    END-IF.                                                      
001162*                                                                 
001163*L55-EX. EXIT.                                                    
001164*----------------------------------------------------------------*
001165 L60-SELECT-DIVISE.                                               
001166*----------------------------------------------------------------*
001167                                                                  
001168     MOVE  'L60-'                TO WCOM-CODABEND.                
001169     MOVE  'DIVISE'              TO WCOM-FILENOME.                
001170     MOVE  'SELECT'              TO WCOM-FILEFUNZ.                
001171     MOVE   A963-SLDIVBAN        TO WCOM-FILECTRL.                
001172                                                                  
001174     
      *EXEC SQL 
      *SELECT CODDIVIS                                         
001175*            INTO :A963-CODDIVIS                                   
001176*            FROM DANAGRAF.TDIVISE                                 
001177*           WHERE SLDIVBAN = :A963-SLDIVBAN                        
001178*           FETCH FIRST 1 ROWS ONLY                                
001179*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 17 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A963-SLDIVBAN
            BY VALUE 0
                     0

           MOVE 18 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A963-CODDIVIS
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 10 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001180                                                                  
001181     IF SQLCODE = 100                                             
001182        PERFORM Z00-ERRORE                                        
001183           THRU Z00-EX                                            
001184     ELSE                                                         
001185        MOVE 'U'                 TO PPROUTIN                      
001186        MOVE 'D'                 TO PPTPFILE                      
001187        MOVE 'R'                 TO PPTPOPER                      
001188        MOVE 'DIVISE'            TO PPNMFILE                      
001189        PERFORM Z90-READPRIN                                      
001190           THRU Z90-EX.                                           
001191                                                                  
001192 L60-EX. EXIT.                                                    
001193*----------------------------------------------------------------*
001194 L70-LEGGI-RATEINP.                                               
001195*----------------------------------------------------------------*
001196                                                                  
001197     MOVE SPACES                 TO WS-CODFOMER.                  
001198     MOVE SPACES                 TO WS-ESTRAI.                    
001199                                                                  
001200     MOVE 'N'                    TO EOF                           
001201     READ RATEINP INTO FSNET18                                    
001202          AT END MOVE 'S'        TO EOF.                          
001203                                                                  
001204     IF EOF = 'S'                                                 
001205        GO TO L70-EX.                                             
001206                                                                  
001207     MOVE 'U'                    TO PPROUTIN.                     
001208     MOVE 'S'                    TO PPTPFILE.                     
001209     MOVE 'R'                    TO PPTPOPER.                     
001210     MOVE 'RATEINP'              TO PPNMFILE.                     
001211     PERFORM Z90-READPRIN                                         
001212        THRU Z90-EX.                                              
001213                                                                  
001214                                                                  
001215     IF N18-ANAGSEND = '22A' OR '09V'                             
001216        MOVE '16V'               TO N18-ANAGSEND.                 
001217                                                                  
001218     IF N18-ANAGRECE = '22A' OR '09V'                             
001219        MOVE '16V'               TO N18-ANAGRECE.                 
001220                                                                  
001221     IF N18-ANAGPROP = '22A' OR '09V'                             
001222        MOVE '16V'               TO N18-ANAGPROP.                 
001223                                                                  
001224     IF N18-ANAGSEND NOT > ' '                                    
001225        MOVE N18-ANAGRECE        TO N18-ANAGSEND.                 
001226                                                                  
001227                                                                  
001228*    CERCO RATEI PER FASHION E PRENDO SE:                         
001229*    - ANAGSEND = '16V'                                           
001230*    - ANAGPROP = '16V' O VUOTO O CLIE/FORN                       
001231                                                                  
001232     IF N18-ANAGSEND = '16V' AND                                  
001233       (N18-ANAGPROP = '16V'     OR                               
001234        N18-ANAGPROP(4:2) > ' '  OR                               
001235        N18-ANAGPROP NOT > SPACES)                                
001236        MOVE 'F'                 TO WS-ESTRAI                     
001237        IF N18-ANAGPROP(4:2) > ' '  OR                            
001238           N18-ANAGPROP NOT > SPACES                              
001239           MOVE N18-ANAGSEND     TO N18-ANAGPROP                  
001240        END-IF                                                    
001241        GO TO L70-AVANTI.                                         
001242                                                                  
001243                                                                  
001244*    CERCO RATEI PER SUBLITEX-TEXTILE E PRENDO SE:                
001245*    - ANAGSEND = '09T' O '24T'                                   
001246*    - ANAGPROP = '09T' O '24T' O VUOTO O CLIE/FORN               
001247                                                                  
001248     IF (N18-ANAGSEND = '09T'    OR                               
001249         N18-ANAGSEND = '24T')     AND                            
001250        (N18-ANAGPROP = '09T'    OR                               
001251         N18-ANAGPROP = '24T'    OR                               
001252         N18-ANAGPROP(4:2) > ' ' OR                               
001253         N18-ANAGPROP NOT > SPACES)                               
001254         MOVE 'T'                 TO WS-ESTRAI                    
001255         IF N18-ANAGPROP(4:2) > ' ' OR                            
001256            N18-ANAGPROP NOT > SPACES                             
001257            MOVE N18-ANAGSEND    TO N18-ANAGPROP                  
001258         END-IF                                                   
001259         GO TO L70-AVANTI.                                        
001260                                                                  
001261*    CERCO RATEI PER SUBLITEX-TEXTILE E PRENDO SE:                
001262*    - ANAGSEND = '16V'                                           
001263*    - ANAGPROP = '09T' O '24T'                                   
001264                                                                  
001265     IF N18-ANAGSEND = '16V'  AND                                 
001266        (N18-ANAGPROP = '09T' OR                                  
001267         N18-ANAGPROP = '24T')                                    
001268         MOVE 'T'                 TO WS-ESTRAI                    
001269         GO TO L70-AVANTI.                                        
001270                                                                  
001271*    CERCO RATEI PER SUBLITEX-TEXTILE E PRENDO SE:                
001272*    - FORNITORE SENDER (SALVO IL CODICE E POI METTO              
001273*                        IL RECE IN SENDER E PROPR)               
001274*    - ANAGPROP = '09T' O '24T'                                   
001275                                                                  
001276     IF N18-ANAGSEND(4:2) > ' ' AND                               
001277       (N18-ANAGRECE = '09T' OR '24T')                            
001278        MOVE 'T'                 TO WS-ESTRAI                     
001279        MOVE N18-ANAGSEND        TO WS-CODFOMER                   
001280        MOVE N18-ANAGRECE        TO N18-ANAGSEND                  
001281        MOVE N18-ANAGRECE        TO N18-ANAGPROP                  
001282        GO TO L70-AVANTI.                                         
001283                                                                  
001284                                                                  
001285*    TUTTO CIO CHE NON E' GESTITO IN PRECEDENZA                   
001286*    VIENE SCARTATO E VIENE FATTO MESSAGGIO                       
001287*    CHE SI PUO VEDERE NELL'HISTORY DEL PGM.                      
001288*    (ES.:SCARTO DIVISIONE 'A',                                   
001289*         SENDER CON FORNITORE MA SENZA SOCIETA, ECC)             
001290                                                                  
001291     MOVE SPACES              TO PPMESSAG.                        
001292     STRING 'RENATO: RATEO SCARTATO.'                             
001293            ' SEND: ' N18-ANAGSEND                                
001294            ' PROP: ' N18-ANAGPROP                                
001295            ' DCE: '  N18-CONTODCE                                
001296            ' CDC: '  N18-CENCOTRA                                
001297          DELIMITED BY SIZE INTO PPMESSAG.                        
001298     MOVE 'M'                 TO PPROUTIN.                        
001299     PERFORM Z90-READPRIN                                         
001300        THRU Z90-EX.                                              
001301                                                                  
001302     GO TO L70-LEGGI-RATEINP.                                     
001303                                                                  
001304                                                                  
001305 L70-AVANTI.                                                      
001306                                                                  
001307     MOVE 'U'                    TO PPROUTIN.                     
001308     MOVE 'S'                    TO PPTPFILE.                     
001309     MOVE 'R'                    TO PPTPOPER.                     
001310     MOVE 'RATEIOK'              TO PPNMFILE.                     
001311     PERFORM Z90-READPRIN                                         
001312        THRU Z90-EX.                                              
001313                                                                  
001314     MOVE SPACES                    TO DCLTRATEINM.               
001315     INITIALIZE DCLTRATEINM.                                      
001316     MOVE N18-ANAGSEND(1:2)         TO A203-SOCIEFAT.             
001317     MOVE N18-ANAGSEND(3:1)         TO A203-DIVIFATT.             
001318     MOVE N18-CONTODCE              TO A203-CONTODCE.             
001319     MOVE N18-CENCOTRA              TO A203-CENCOTRA.             
001320     MOVE N18-SIGLADIV              TO A963-SLDIVBAN.             
001321     PERFORM L60-SELECT-DIVISE                                    
001322        THRU L60-EX.                                              
001323     MOVE A963-CODDIVIS             TO A203-CODDIVIS.             
001324     MOVE N18-IMPOADDE              TO A203-IMPCOSTO.             
001325     MOVE N18-ANAGPROP(1:2)         TO A203-CODSOCIE.             
001326     MOVE N18-ANAGPROP(3:1)         TO A203-DIVIPROP.             
001327                                                                  
001328 L70-EX. EXIT.                                                    
001329*----------------------------------------------------------------*
001330*O00-OPEN-POINTER1.                                               
001331*----------------------------------------------------------------*
001332*                                                                 
001333*    MOVE 'O00-'                 TO WCOM-CODABEND                 
001334*    MOVE 'OPEN'                 TO WCOM-FILEFUNZ                 
001335*    MOVE 'POINTER1'             TO WCOM-FILENOME                 
001336*    MOVE SPACES                 TO WCOM-FILECTRL                 
001337*    STRING WS-INIZANNO ' ' WS-FINEMESE                           
001338*    DELIMITED BY SIZE         INTO WCOM-FILECTRL                 
001339*    EXEC SQL  OPEN POINTER1  END-EXEC.                           
001340*                                                                 
001341*O00-EX. EXIT.                                                    
001342*----------------------------------------------------------------*
001343*O01-CLOSE-POINTER1.                                              
001344*----------------------------------------------------------------*
001345*                                                                 
001346*    MOVE 'O01-'                 TO WCOM-CODABEND                 
001347*    MOVE 'CLOSE'                TO WCOM-FILEFUNZ                 
001348*    MOVE 'POINTER1'             TO WCOM-FILENOME                 
001349*    MOVE SPACES                 TO WCOM-FILECTRL                 
001350*    STRING WS-INIZANNO ' ' WS-FINEMESE                           
001351*    DELIMITED BY SIZE         INTO WCOM-FILECTRL                 
001352*    EXEC SQL  CLOSE POINTER1 END-EXEC.                           
001353*                                                                 
001354*O01-EX. EXIT.                                                    
001355*----------------------------------------------------------------*
001356 O40-OPEN-POINTER2.                                               
001357*----------------------------------------------------------------*
001358                                                                  
001359     MOVE 'O40-'                 TO WCOM-CODABEND                 
001360     MOVE 'POINTER2'             TO WCOM-FILENOME                 
001361     MOVE 'OPEN'                 TO WCOM-FILEFUNZ                 
001362     MOVE SPACES                 TO WCOM-FILECTRL                 
001363     STRING WS-INIZMESE ' ' WS-FINEMESE                           
001364     DELIMITED BY SIZE         INTO WCOM-FILECTRL                 
001365     
      *EXEC SQL OPEN POINTER2 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 19 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-INIZMESE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-FINEMESE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-INIZMESE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-FINEMESE
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                          .                             
001366                                                                  
001367 O40-EX. EXIT.                                                    
001368*----------------------------------------------------------------*
001369 O41-CLOSE-POINTER2.                                              
001370*----------------------------------------------------------------*
001371                                                                  
001372     MOVE 'MAIN'                 TO WCOM-CODABEND                 
001373     MOVE 'POINTER2'             TO WCOM-FILENOME                 
001374     MOVE 'CLOSE'                TO WCOM-FILEFUNZ                 
001375     MOVE SPACES                 TO WCOM-FILECTRL                 
001376     STRING WS-INIZMESE ' ' WS-FINEMESE                           
001377     DELIMITED BY SIZE         INTO WCOM-FILECTRL                 
001378     
      *EXEC SQL CLOSE POINTER2 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                           .                            
001379                                                                  
001380 O41-EX. EXIT.                                                    
001381*----------------------------------------------------------------*
001382 W00-DELETE-RATEINM.                                              
001383*----------------------------------------------------------------*
001384                                                                  
001385     MOVE 'W00-'                 TO WCOM-CODABEND                 
001386     MOVE 'DELETE'               TO WCOM-FILEFUNZ                 
001387     MOVE 'TRATEINM'             TO WCOM-FILENOME                 
001388     MOVE SPACES                 TO WCOM-FILECTRL                 
001389     STRING A203-ANNOMESE ' ' A203-TIPOELAB                       
001390     DELIMITED BY SIZE         INTO WCOM-FILECTRL                 
001391                                                                  
001393     
      *EXEC SQL 
      *DELETE FROM DADDEBIT.TRATEINM                           
001394*           WHERE ANNOMESE = :A203-ANNOMESE                        
001395*             AND TIPOELAB = :A203-TIPOELAB                        
001396*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 20 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-ANNOMESE
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-TIPOELAB
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 11 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001397     IF SQLCODE = 0                                               
001398        MOVE 'U'                 TO PPROUTIN                      
001399        MOVE 'D'                 TO PPTPFILE                      
001400        MOVE 'D'                 TO PPTPOPER                      
001401        MOVE WCOM-FILENOME       TO PPNMFILE                      
001402        PERFORM Z90-READPRIN                                      
001403           THRU Z90-EX                                            
001404     ELSE                                                         
001405        MOVE 'U'                 TO PPROUTIN                      
001406        MOVE 'D'                 TO PPTPFILE                      
001407        MOVE 'D'                 TO PPTPOPER                      
001408        MOVE 'NO-DELE'           TO PPNMFILE                      
001409        PERFORM Z90-READPRIN                                      
001410           THRU Z90-EX.                                           
001411                                                                  
001412 W00-EX. EXIT.                                                    
001413*----------------------------------------------------------------*
001414 W01-DELETE-RATEINM.                                              
001415*----------------------------------------------------------------*
001416                                                                  
001417     MOVE 'W01-'                 TO WCOM-CODABEND                 
001418     MOVE 'DELETE'               TO WCOM-FILEFUNZ                 
001419     MOVE 'TRATE01'              TO WCOM-FILENOME                 
001420     MOVE SPACES                 TO WCOM-FILECTRL                 
001421     STRING A203-ANNOMESE ' ' WS-TIPOELAB-1 ' ' WS-TIPOELAB-2     
001422     DELIMITED BY SIZE         INTO WCOM-FILECTRL                 
001423                                                                  
001425     
      *EXEC SQL 
      *DELETE FROM DADDEBIT.TRATEINM                           
001426*           WHERE ANNOMESE = :A203-ANNOMESE                        
001427*             AND TIPOELAB IN (:WS-TIPOELAB-1, :WS-TIPOELAB-2)     
001428*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 21 TO SQL-STMT-ID 
           MOVE 3 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-ANNOMESE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-TIPOELAB-1
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-TIPOELAB-2
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 12 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001429     IF SQLCODE = 0                                               
001430        MOVE 'U'                 TO PPROUTIN                      
001431        MOVE 'D'                 TO PPTPFILE                      
001432        MOVE 'D'                 TO PPTPOPER                      
001433        MOVE WCOM-FILENOME       TO PPNMFILE                      
001434        PERFORM Z90-READPRIN                                      
001435           THRU Z90-EX                                            
001436     ELSE                                                         
001437        MOVE 'U'                 TO PPROUTIN                      
001438        MOVE 'D'                 TO PPTPFILE                      
001439        MOVE 'D'                 TO PPTPOPER                      
001440        MOVE 'NODEL01'           TO PPNMFILE                      
001441        PERFORM Z90-READPRIN                                      
001442           THRU Z90-EX.                                           
001443                                                                  
001444 W01-EX. EXIT.                                                    
001445*----------------------------------------------------------------*
001446 W05-DELETE-COSTRASPCDC.                                          
001447*----------------------------------------------------------------*
001448                                                                  
001449     MOVE 'W05-'                 TO WCOM-CODABEND                 
001450     MOVE 'DELETE'               TO WCOM-FILEFUNZ                 
001451     MOVE 'COSTRASPCDC'          TO WCOM-FILENOME                 
001452     MOVE T308-DTFATTUR          TO WCOM-FILECTRL                 
001453                                                                  
001455     
      *EXEC SQL 
      *DELETE FROM DTRASP.TCOSTRASPCDC                         
001456*           WHERE DTFATTUR          = :T308-DTFATTUR               
001457*             AND TIPORECO         IN (' ', 'PREA','DOGA')         
001458*             AND CODSOCIE<>'24'                                   
001459*             AND SOCIEFAT<>'24'                                   
001460*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 22 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-DTFATTUR
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 13 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001461     IF SQLCODE = 0                                               
001462        MOVE 'U'                 TO PPROUTIN                      
001463        MOVE 'D'                 TO PPTPFILE                      
001464        MOVE 'D'                 TO PPTPOPER                      
001465        MOVE WCOM-FILENOME       TO PPNMFILE                      
001466        PERFORM Z90-READPRIN                                      
001467           THRU Z90-EX.                                           
001468                                                                  
001469 W05-EX. EXIT.                                                    
001470*----------------------------------------------------------------*
001471 W10-INSERT-COSTRASPCDC.                                          
001472*----------------------------------------------------------------*
001473                                                                  
001474     MOVE 'W10-'                 TO WCOM-CODABEND                 
001475     MOVE 'INSERT'               TO WCOM-FILEFUNZ                 
001476     MOVE 'COSTRASPCDC'          TO WCOM-FILENOME                 
001477     MOVE SPACES                 TO WCOM-FILECTRL                 
001478     STRING T308-CODSOCIE ' ' T308-AANUMFAT ' ' T308-CENCOSTO     
001479     DELIMITED BY SIZE         INTO WCOM-FILECTRL                 
001480                                                                  
001482     
      *EXEC SQL 
      *INSERT INTO DTRASP.TCOSTRASPCDC                         
001483*                (DTFATTUR                                         
001484*                ,CODSOCIE                                         
001485*                ,AANUMFAT                                         
001486*                ,SOCIEPAS                                         
001487*                ,PAESPROV                                         
001488*                ,PAESMERC                                         
001489*                ,PAESORDI                                         
001490*                ,TIPOARTI                                         
001491*                ,CONTODCE                                         
001492*                ,CENCOSTO                                         
001493*                ,CENCOTRA                                         
001494*                ,IMPTRLIS                                         
001495*                ,IMPTRPAG                                         
001496*                ,DTCREAZI                                         
001497*                ,DTULTVAR                                         
001498*                ,CODUTVAR                                         
001499*                ,SOCIEFAT                                         
001500*                ,TIPOELAB                                         
001501*                ,AANUMORD                                         
001502*                ,NRRIGORD                                         
001503*                ,TIPORECO)                                        
001504*          VALUES                                                  
001505*                (:T308-DTFATTUR                                   
001506*                ,:T308-CODSOCIE                                   
001507*                ,:T308-AANUMFAT                                   
001508*                ,:T308-SOCIEPAS                                   
001509*                ,:T308-PAESPROV                                   
001510*                ,:T308-PAESMERC                                   
001511*                ,:T308-PAESORDI                                   
001512*                ,:T308-TIPOARTI                                   
001513*                ,:T308-CONTODCE                                   
001514*                ,:T308-CENCOSTO                                   
001515*                ,:T308-CENCOTRA                                   
001516*                ,:T308-IMPTRLIS                                   
001517*                ,:T308-IMPTRPAG                                   
001518*                ,:T308-DTCREAZI                                   
001519*                ,:T308-DTULTVAR                                   
001520*                ,:T308-CODUTVAR                                   
001521*                ,:T308-SOCIEFAT                                   
001522*                ,:T308-TIPOELAB                                   
001523*                ,:T308-AANUMORD                                   
001524*                ,:T308-NRRIGORD                                   
001525*                ,:T308-TIPORECO)                                  
001526*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 23 TO SQL-STMT-ID 
           MOVE 21 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-DTFATTUR
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-CODSOCIE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-AANUMFAT
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-SOCIEPAS
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-PAESPROV
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-PAESMERC
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-PAESORDI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-TIPOARTI
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-CONTODCE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-CENCOSTO
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-CENCOTRA
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-IMPTRLIS
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-IMPTRPAG
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-DTCREAZI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-CODUTVAR
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-SOCIEFAT
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 17 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-TIPOELAB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 18 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-AANUMORD
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 19 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-NRRIGORD
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 20 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-TIPORECO
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 14 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001527     MOVE 'U'                    TO PPROUTIN                      
001528     MOVE 'D'                    TO PPTPFILE                      
001529     MOVE 'A'                    TO PPTPOPER                      
001530     MOVE WCOM-FILENOME          TO PPNMFILE                      
001531     PERFORM Z90-READPRIN                                         
001532        THRU Z90-EX.                                              
001533                                                                  
001534 W10-EX. EXIT.                                                    
001535*----------------------------------------------------------------*
001536 W20-INSERT-RATEINM.                                              
001537*----------------------------------------------------------------*
001538                                                                  
001539     MOVE 'W20-'                 TO WCOM-CODABEND                 
001540     MOVE 'INSERT'               TO WCOM-FILEFUNZ                 
001541     MOVE 'RATEINM'              TO WCOM-FILENOME                 
001542     MOVE SPACES                 TO WCOM-FILECTRL                 
001543     STRING A203-CODSOCIE ' ' A203-AANUMFAT ' ' A203-CENCOSTO     
001544     DELIMITED BY SIZE         INTO WCOM-FILECTRL                 
001545                                                                  
001547     
      *EXEC SQL 
      *INSERT INTO DADDEBIT.TRATEINM                           
001548*                (ANNOMESE                                         
001549*                ,CDMCAGTM                                         
001550*                ,CDAREGTM                                         
001551*                ,CDDIPGTM                                         
001552*                ,TIPOADDE                                         
001553*                ,KEYADDE1                                         
001554*                ,KEYADDE2                                         
001555*                ,KEYADDE3                                         
001556*                ,KEYADDE4                                         
001557*                ,SOCIEFAT                                         
001558*                ,DIVIFATT                                         
001559*                ,CODFORNI                                         
001560*                ,CODSOCIE                                         
001561*                ,DIVIPROP                                         
001562*                ,AANUMFAT                                         
001563*                ,DTFATTUR                                         
001564*                ,TIPORECO                                         
001565*                ,CODFOMER                                         
001566*                ,NUMPROG5                                         
001567*                ,MERCEMAG                                         
001568*                ,PROLOMER                                         
001569*                ,CODLINEA                                         
001570*                ,CENCOTRA                                         
001571*                ,CENCOSTO                                         
001572*                ,CONTODCE                                         
001573*                ,CODDIVIS                                         
001574*                ,IMPCOSTO                                         
001575*                ,NRPREFAT                                         
001576*                ,DTPREFAT                                         
001577*                ,STPREFAT                                         
001578*                ,NRDOCCOT                                         
001579*                ,DTSPEDIZ                                         
001580*                ,DTCREAZI                                         
001581*                ,DTULTVAR                                         
001582*                ,CODUTVAR                                         
001583*                ,TIPOELAB)                                        
001584*          VALUES                                                  
001585*                (:A203-ANNOMESE                                   
001586*                ,:A203-CDMCAGTM                                   
001587*                ,:A203-CDAREGTM                                   
001588*                ,:A203-CDDIPGTM                                   
001589*                ,:A203-TIPOADDE                                   
001590*                ,:A203-KEYADDE1                                   
001591*                ,:A203-KEYADDE2                                   
001592*                ,:A203-KEYADDE3                                   
001593*                ,:A203-KEYADDE4                                   
001594*                ,:A203-SOCIEFAT                                   
001595*                ,:A203-DIVIFATT                                   
001596*                ,:A203-CODFORNI                                   
001597*                ,:A203-CODSOCIE                                   
001598*                ,:A203-DIVIPROP                                   
001599*                ,:A203-AANUMFAT                                   
001600*                ,:A203-DTFATTUR                                   
001601*                ,:A203-TIPORECO                                   
001602*                ,:A203-CODFOMER                                   
001603*                ,:A203-NUMPROG5                                   
001604*                ,:A203-MERCEMAG                                   
001605*                ,:A203-PROLOMER                                   
001606*                ,:A203-CODLINEA                                   
001607*                ,:A203-CENCOTRA                                   
001608*                ,:A203-CENCOSTO                                   
001609*                ,:A203-CONTODCE                                   
001610*                ,:A203-CODDIVIS                                   
001611*                ,:A203-IMPCOSTO                                   
001612*                ,:A203-NRPREFAT                                   
001613*                ,:A203-DTPREFAT                                   
001614*                ,:A203-STPREFAT                                   
001615*                ,:A203-NRDOCCOT                                   
001616*                ,:A203-DTSPEDIZ                                   
001617*                ,:A203-DTCREAZI                                   
001618*                ,:A203-DTULTVAR                                   
001619*                ,:A203-CODUTVAR                                   
001620*                ,:A203-TIPOELAB)                                  
001621*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 24 TO SQL-STMT-ID 
           MOVE 36 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-ANNOMESE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-CDMCAGTM
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-CDAREGTM
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-CDDIPGTM
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-TIPOADDE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-KEYADDE1
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-KEYADDE2
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-KEYADDE3
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-KEYADDE4
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-SOCIEFAT
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-DIVIFATT
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-CODFORNI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-CODSOCIE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-DIVIPROP
            BY VALUE 0
                     0

           MOVE 20 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-AANUMFAT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-DTFATTUR
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-TIPORECO
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 17 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-CODFOMER
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 18 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-NUMPROG5
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 19 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-MERCEMAG
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 20 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-PROLOMER
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 21 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-CODLINEA
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 22 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-CENCOTRA
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 23 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-CENCOSTO
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 24 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-CONTODCE
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 25 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-CODDIVIS
            BY VALUE 0
                     0

           MOVE 523 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 26 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-IMPCOSTO
            BY VALUE 0
                     0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 27 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-NRPREFAT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 28 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-DTPREFAT
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 29 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-STPREFAT
            BY VALUE 0
                     0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 30 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-NRDOCCOT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 31 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-DTSPEDIZ
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 32 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-DTCREAZI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 33 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 34 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-CODUTVAR
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 35 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A203-TIPOELAB
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 15 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001622     MOVE 'U'                    TO PPROUTIN                      
001623     MOVE 'D'                    TO PPTPFILE                      
001624     MOVE 'A'                    TO PPTPOPER                      
001625     MOVE WCOM-FILENOME          TO PPNMFILE                      
001626     PERFORM Z90-READPRIN                                         
001627        THRU Z90-EX.                                              
001628                                                                  
001629 W20-EX. EXIT.                                                    
001630*----------------------------------------------------------------*
001631 Z00-ERRORE.                                                      
001632*----------------------------------------------------------------*
001633                                                                  
001634     MOVE 'M'                    TO PPROUTIN.                     
001635     PERFORM Z90-READPRIN                                         
001636        THRU Z90-EX.                                              
001637                                                                  
001638     MOVE 'SCDB2ER '             TO PPCALL.                       
001639     CALL PPCALL                 USING DCPARM                     
001640                                       DCDB2ER                    
001641                                       SQLCA.                     
001642 Z00-EX. EXIT.                                                    
001643*----------------------------------------------------------------*
001644 Z90-READPRIN.                                                    
001645*----------------------------------------------------------------*
001646                                                                  
001647     MOVE 'READPRIN '            TO PPCALL                        
001648     CALL PPCALL                 USING DCPARM.                    
001649                                                                  
001650 Z90-EX. EXIT.                                                   
