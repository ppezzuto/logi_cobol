      *((program: AVALO52.cblx))
000001*-------------* PROGRAMMA BATCH COBOL2 DB2 *---------------------*
000002 ID DIVISION.                                                     
000003*-------------*                                                   
000004 PROGRAM-ID. AVALO52.                         
000005                                                                  
000006*----------------------------------------------------------------*
000007*                                                                *
000008* ==> ATENZIONE MODIFICATO PER OPLA                              *
000009*                                                                *
000010* A PARTIRE DAGLI ORDINI DI TRASPORTO DELLA LOGISTICA CARICA IL  *
000011* DETTAGLIO (DETTORDILOGI) PARTENDO DA TNETMOVEREXPO.            *
000012* IL PROGRAMMA GIRA SOLO PER IL CLIENTE MIROGLIO TEXTILE (33018) *
000013* E SUBLITEX (04074) E ORDINI DI TRASPORTO (TIPSERVI='T')        *
000014* DA GENNAIO 2025 LA SUBLITEX (04074) PASSA AS OPLA E NON SI     *
000015* CARICA PIU' IL DETTAGLIO XC I COSTI TRASPORTI SONO SU OPLA.    *
000016*----------------------------------------------------------------*
000017 ENVIRONMENT DIVISION.                                            
000018*---------------------*                                           
000019 CONFIGURATION SECTION.                                           
000020 SPECIAL-NAMES.                                                   
000021     DECIMAL-POINT IS COMMA.                                      
000022                                                                  
000023 INPUT-OUTPUT SECTION.                                            
000024 FILE-CONTROL.                                                    
000025                                                                  
000026 DATA DIVISION.                                                   
000027*--------------*                                                  
000028 FILE SECTION.                                                    
000029                                                                  
000030 WORKING-STORAGE SECTION.

       01  SQLDA-ID pic 9(4) comp-5.
       01  SQLDSIZE pic 9(4) comp-5.
       01  SQL-STMT-ID pic 9(4) comp-5.
       01  SQLVAR-INDEX pic 9(4) comp-5.
       01  SQL-DATA-TYPE pic 9(4) comp-5.
       01  SQL-HOST-VAR-LENGTH pic 9(9) comp-5.
       01  SQL-S-HOST-VAR-LENGTH pic 9(9) comp-5.
       01  SQL-S-LITERAL pic X(258).
       01  SQL-LITERAL1 pic X(130).
       01  SQL-LITERAL2 pic X(130).
       01  SQL-LITERAL3 pic X(130).
       01  SQL-LITERAL4 pic X(130).
       01  SQL-LITERAL5 pic X(130).
       01  SQL-LITERAL6 pic X(130).
       01  SQL-LITERAL7 pic X(130).
       01  SQL-LITERAL8 pic X(130).
       01  SQL-LITERAL9 pic X(130).
       01  SQL-LITERAL10 pic X(130).
       01  SQL-IS-LITERAL pic 9(4) comp-5 value 1.
       01  SQL-IS-INPUT-HVAR pic 9(4) comp-5 value 2.
       01  SQL-CALL-TYPE pic 9(4) comp-5.
       01  SQL-SECTIONUMBER pic 9(4) comp-5.
       01  SQL-INPUT-SQLDA-ID pic 9(4) comp-5.
       01  SQL-OUTPUT-SQLDA-ID pic 9(4) comp-5.
       01  SQLA-PROGRAM-ID.
           05 SQL-PART1 pic 9(4) COMP-5 value 172.
           05 SQL-PART2 pic X(6) value "AEAQAI".
           05 SQL-PART3 pic X(24) value "vAYwMfMo01111 2         ".
           05 SQL-PART4 pic 9(4) COMP-5 value 8.
           05 SQL-PART5 pic X(8) value "DB2XMT  ".
           05 SQL-PART6 pic X(120) value LOW-VALUES.
           05 SQL-PART7 pic 9(4) COMP-5 value 8.
           05 SQL-PART8 pic X(8) value "AVALO52 ".
           05 SQL-PART9 pic X(120) value LOW-VALUES.
                                                                        
000031 01  FILLER                      PIC X(8)  VALUE '*DCPARM*'.      
000032*    COPY DCPARM.                                                 
      *>>((file: DCPARM))
000001***************************************************************** 
000002*******                                                         * 
000003*******       A R E A   P A R A M E T R I C A       *COBOL*     * 
000004*******                                                         * 
000005***************************************************************** 
000006 01  DCPARM.                                                      
000007*******  PPNAME   = NOME PROGRAMMA                                
000008     02  PPNAME           PIC X(8)    VALUE SPACES.               
000009*******  PPROUTIN = ROUTINE DA ESEGUIRE                           
000010     02  PPROUTIN         PIC X       VALUE SPACES.               
000011     02  PPSTAT           PIC X(4)    VALUE SPACES.               
000012*******  PPNUSK   = NUMERO DI SCHEDE X LA FUNZIONE -N-            
000013     02  PPNUSK           PIC X(2)    VALUE SPACES.               
000014     02  PPFIRST          PIC X       VALUE SPACES.               
000015*******                                                           
000016*********************** SKEDE PARAMETRO - MAX 10 **************** 
000017*******                                                           
000018     02  SK-PARM.                                                 
000019         05  PPSK1            PIC X(80)   VALUE SPACES.           
000020         05  PPSK2            PIC X(80)   VALUE SPACES.           
000021         05  PPSK3            PIC X(80)   VALUE SPACES.           
000022         05  PPSK4            PIC X(80)   VALUE SPACES.           
000023         05  PPSK5            PIC X(80)   VALUE SPACES.           
000024         05  PPSK6            PIC X(80)   VALUE SPACES.           
000025         05  PPSK7            PIC X(80)   VALUE SPACES.           
000026         05  PPSK8            PIC X(80)   VALUE SPACES.           
000027         05  PPSK9            PIC X(80)   VALUE SPACES.           
000028         05  PPSK10           PIC X(80)   VALUE SPACES.           
000029         05  PPSK11           PIC X(80)   VALUE SPACES.           
000030     02  TAB-SK-PARM REDEFINES SK-PARM.                           
000031         05  EL-SK-PARM OCCURS 11 TIMES.                          
000032             10  NAME-SK-PARM     PIC XX.                         
000033             10  FILLER           PIC X.                          
000034             10  DATA-SK-PARM     PIC X(77).                      
000035*******                                                           
000036*********************** ELEMENTO DI RICERCA ********************* 
000037*******                                                           
000038*******  PPNMFILE  = NOME FILE                                    
000039     02  PPNMFILE         PIC X(7)    VALUE SPACES.               
000040*******  PPTPFILE  = TIPO FILE                                    
000041     02  PPTPFILE         PIC X(1)    VALUE SPACES.               
000042*******  PPTPOPER  = TIPO OPERAZIONE                              
000043     02  PPTPOPER         PIC X(1)    VALUE SPACES.               
000044     02  FILLER           PIC X(7)    VALUE SPACES.               
000045*******                                                           
000046*********************** TABELLA DI 30 ELEMENTI ****************** 
000047*******                                                           
000048     02  TAB-CONTATORI.                                           
000049         05  EL-CONTATORI OCCURS 30 TIMES.                        
000050             10  EL-PPNMFILE      PIC X(7)        VALUE SPACES.   
000051             10  EL-PPTPFILE      PIC X           VALUE SPACES.   
000052             10  EL-PPTPOPER      PIC X           VALUE SPACES.   
000053             10  EL-CONTATOR      PIC 9(9) COMP-3 VALUE ZEROES.   
000054             10  EL-FILLER        PIC XX          VALUE SPACES.   
000055*    02  FILLER           PIC X(7)     VALUE SPACES.              
000056*******              TIPO FILE                                    
000057*    02  FILLER           PIC X(1)     VALUE SPACES.              
000058*******              TIPO OPERAZIONE                              
000059*    02  FILLER           PIC X(1)     VALUE SPACES.              
000060*******              NUMERO OPERAZIONI                            
000061*    02  FILLER           PIC 9(9)     COMP-3    VALUE ZERO.      
000062*    02  FILLER           PIC X(2)     VALUE SPACES.              
000063*******  29 CAMPI DA 16 BYTES, IN TOTALE 464 BYTES                
000064*    02  FILLER           PIC X(464)   VALUE SPACES.              
000065*******                                                           
000066*********************** STAMPA MESSAGGI ************************* 
000067*******                                                           
000068*******  PPMESSAG  = MESSAGGIO DA STAMPARE                        
000069     02  PPMESSAG         PIC X(132)  VALUE SPACES.               
000070     02  FILLER           PIC X(4)    VALUE SPACES.               
000071*******                                                           
000072*********************** DATE DA TABE TABPRODA ******************* 
000073*******                                                           
000074*******  DATA-PROG = NOME ELEMENTO DI TABE TABPRODA               
000075     02  DATA-PROG        PIC X(7)    VALUE SPACES.               
000076*******  DATA-TIPO = TIPO DI DATA  DI TABE TABPRODA               
000077     02  DATA-TIPO        PIC X       VALUE SPACES.               
000078*******  DATA-INIZ = DATA INIZIO PERIODO                          
000079     02  DATA-INIZ.                                               
000080         05  GG-INIZ.                                             
000081             10  SS-CORSO PIC XX      VALUE SPACES.               
000082         05  MM-INIZ      PIC XX      VALUE SPACES.               
000083         05  AA-INIZ      PIC XX      VALUE SPACES.               
000084*******  DATA-FINE = DATA FINE PERIODO                            
000085     02  DATA-FINE.                                               
000086         05  GG-FINE      PIC XX      VALUE SPACES.               
000087         05  MM-FINE      PIC XX      VALUE SPACES.               
000088         05  AA-FINE      PIC XX      VALUE SPACES.               
000089     02  FILLER           PIC X(4)    VALUE SPACES.               
000090*******                                                           
000091*********************** CALL GENERALIZZATA ********************** 
000092*******                                                           
000093*******  PPCALL    = NOME MODULO X CALLER                         
000094     02  PPCALL           PIC X(8)    VALUE SPACES.               
000095*******                                                           
000096***************************************************************** 
000097*  EJECT                                                          
      *<<((file: DCPARM))
000033 01  FILLER                      PIC X(8)  VALUE 'DCDB2ER*'.      
000034*    COPY DCDB2ER.                                                
      *>>((file: DCDB2ER))
000001******************************************************************
000002*****               AREA PER MODULO SCDB2ER                  *****
000003******************************************************************
000004 01  DCDB2ER.                                                     
000005     02 WCOM-LUNGHEZZ         PIC S9(3) COMP-3 VALUE +171.        
000006     02 WCOM-FILEFUNZ         PIC X(10).                          
000007     02 WCOM-FILENOME         PIC X(30).                          
000008     02 WCOM-FILECTRL         PIC X(30).                          
000009     02 WCOM-MESSAGES         PIC X(80).                          
000010     02 WCOM-CODABEND         PIC X(4).                           
000011     02 MESS-CODERROR         PIC X(6).                           
000012     02 WSWERROR              PIC X.                              
000013        88 ERRORE             VALUE '*'.                          
000014     02 WCOM-PROGNAME         PIC X(8).                           
      *<<((file: DCDB2ER))
000035 01  FILLER                      PIC X(8)  VALUE 'DCWDTEL*'.      
000036*    COPY DCWDTEL.                                                
      *>>((file: DCWDTEL))
000001***************************************************************** 
000002******         AREA PASSAGGIO CHIAMATA                     ****** 
000003******             MODULO  SCTDTEL (LENGTH 100)            ****** 
000004***************************************************************** 
000005 01  DCWDTEL.                                                     
000006*                         ZEROES SE OK  ALTRIMENTI SQLCODE        
000007     05 DTEL-RETCOD              PIC S9(3).                       
000008*                         R = LETTURA   U = AGGIORNAMENTO         
000009     05 DTEL-TIPORICH            PIC X.                           
000010     05 DTEL-SIGLDATA            PIC X(8).                        
000011*         G=AAAAAAA   S=SETTIMA   M=MENSILE   A=ANNUALE   W=WEEK  
000012     05 DTEL-DATATIPO            PIC X(1).                        
000013*                                                                 
000014     05 DTEL-DTINELAB            PIC X(8).                        
000015     05 DTEL-TMINELAB            PIC X(6).                        
000016     05 DTEL-DTFIELAB            PIC X(8).                        
000017     05 DTEL-TMFIELAB            PIC X(6).                        
000018     05 FILLER                   PIC X(59).                       
      *<<((file: DCWDTEL))
000037                                                                  
000038 01  FILLER                      PIC X(8)  VALUE '*COMODI*'.      
000039 01  COMODI.                                                      
000040     05 SW-ERRORE                PIC X(1).                        
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000041     05 WS-SEND-PIANO            PIC X(2).                        
000042     05 WS-PROP-PIANO            PIC X(2).                        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000043     05 WS-SQLCODE               PIC S9(5)V99 COMP-3.             
000044     05 TOT-IMPTRPAG             PIC S9(7)V99 COMP-3.             
000045     05 TOT-IMCOSATT             PIC S9(7)V99 COMP-3.             
000046     05 WS-IMCOSATT              PIC S9(7)V99 COMP-3.             
000047     05 WS-NRPREATT              PIC X(10).                       
000048     05 WS-DTPREATT              PIC X(08).                       
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000049     05 WS-MENSILE               PIC X(06).                       
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000050     05 WS-DTGIORNO              PIC X(08).                       
000051                                                                  
000052     05 INDX                     PIC S9(5) COMP-3.                
000053     05 MAX-INDX                 PIC S9(5) COMP-3 VALUE 10000.    
000054     05 TABELLAX.                                                 
000055        10 TX-ELEMENTO           OCCURS 10000.                    
000056           15 TX-FILLER          PIC X(200).                      
000057     05 IND2                     PIC S9(3) COMP-3.                
000058     05 MAX-IND2                 PIC S9(3) COMP-3 VALUE 100.      
000059     05 TABELLA2.                                                 
000060        10 T2-ELEMENTO           OCCURS 100.                      
000061           15 T2-CODSOCIE        PIC X(02).                       
000062           15 T2-AANUMFAT        PIC X(08).                       
000063           15 T2-KGLORFAT        PIC S9(7)V99 COMP-3.             
000064*------------------------------- DANAGRAF.TPAESI                  
000065 01  FILLER                      PIC X(8) VALUE 'FDANA528'.       
000066*    EXEC SQL INCLUDE FDANA528 END-EXEC.                          
      *>>((file: FDANA528))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TPAESI                    *
000003******************************************************************
000004 01  DCLTPAESI.                                                   
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 A528-CODPAESE        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000006     10 A528-CODILING        PIC X(1).                            
000007     10 A528-PAESBANC        PIC X(3).                            
000008     10 A528-PAESEISO        PIC X(2).                            
000009     10 A528-FLPAECEE        PIC X(1).                            
000010     10 A528-FLPAEORI        PIC X(1).                            
000011     10 A528-DTCREAZI        PIC X(8).                            
000012     10 A528-DTULTVAR        PIC X(8).                            
000013     10 A528-CODUTVAR        PIC X(6).                            
000014     10 A528-SLPAEGTM        PIC X(3).                            
000015     10 A528-PRFINTER        PIC X(5).                            
000016     10 A528-GRUPPAES        PIC X(2).                            
000017     10 A528-CDMCAREG        PIC X(2).                            
000018     10 A528-CDAREREG        PIC X(2).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000019     10 A528-CDRAGCEN        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000020     10 A528-CDRAGTRA        PIC X(2).                            
000021     10 A528-CDRAGFOC        PIC X(2).                            
000022     10 A528-CODPAGVB        PIC X(3).                            
000023     10 A528-SIGPAGVB        PIC X(2).                            
000024     10 A528-CODPARUS        PIC X(3).                            
000025     10 A528-CDRAGLIS        PIC X(2).                            
000026     10 A528-CDRAGSTA        PIC X(2).                            
000027     10 A528-CDRAGLIC        PIC X(2).                            
000028     10 A528-CDRAGLIF        PIC X(2).                            
000029******************************************************************
000030* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 24      *
000031******************************************************************
      *<<((file: FDANA528))
000067*------------------------------- DANAGRAF.TSOCIETA                
000068 01  FILLER                      PIC X(8) VALUE 'FDANA531'.       
000069*    EXEC SQL INCLUDE FDANA531 END-EXEC.                          
      *>>((file: FDANA531))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TSOCIETA                  *
000003******************************************************************
000004 01  DCLTSOCIETA.                                                 
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 A531-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000006     10 A531-NOMSOCIE        PIC X(23).                           
000007     10 A531-CODFORNI        PIC X(5).                            
000008     10 A531-TASSINTE        PIC S9(3)V9(2) USAGE COMP-3.         
000009     10 A531-CODPAESE        PIC X(3).                            
000010     10 A531-NRGGRISC        PIC S9(3)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000011     10 A531-CODPIANO        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000012     10 A531-CITTASOC        PIC X(18).                           
000013     10 A531-FLPAGIVA        PIC X(1).                            
000014     10 A531-FLFATACQ        PIC X(1).                            
000015     10 A531-CODAZIEN        PIC X(5).                            
000016     10 A531-FLIVATRA        PIC X(1).                            
000017     10 A531-CODDIVIS        PIC X(2).                            
000018     10 A531-COSTINTE        PIC S9(3)V9(2) USAGE COMP-3.         
000019     10 A531-FLCONTAB        PIC X(1).                            
000020     10 A531-FLAGMAGA        PIC X(1).                            
000021     10 A531-RAGSOCIE        PIC X(50).                           
000022     10 A531-SOCIECON        PIC X(2).                            
000023     10 A531-DTCREAZI        PIC X(8).                            
000024     10 A531-DTULTVAR        PIC X(8).                            
000025     10 A531-CODUTVAR        PIC X(6).                            
000026     10 A531-INDLEGAL        PIC X(35).                           
000027     10 A531-CAPLEGAL        PIC X(5).                            
000028     10 A531-CITLEGAL        PIC X(18).                           
000029     10 A531-CODFISCA        PIC X(16).                           
000030     10 A531-CODDIVRI        PIC X(2).                            
000031     10 A531-SOCIEGTM        PIC X(2).                            
000032     10 A531-GENEFATT        PIC X(1).                            
000033     10 A531-FLAGATTI        PIC X(1).                            
000034     10 A531-DIVISOLD        PIC X(2).                            
000035     10 A531-DTFINOLD        PIC X(8).                            
000036     10 A531-DIVRIOLD        PIC X(2).                            
000037     10 A531-DIVIRIFA        PIC X(2).                            
000038     10 A531-FLEURUSA        PIC X(1).                            
000039     10 A531-FLAGLIMI        PIC X(1).                            
000040     10 A531-FLFILIAL        PIC X(1).                            
000041     10 A531-FLPRESEN        PIC X(1).                            
000042     10 A531-CODSOCPA        PIC X(1).                            
000043     10 A531-FLBOLGVB        PIC X(1).                            
000044     10 A531-FLSTCART        PIC X(1).                            
000045     10 A531-FLDIPEST        PIC X(1).                            
000046     10 A531-CODFIRMA        PIC X(8).                            
000047     10 A531-DESFIRMA        PIC X(24).                           
000048     10 A531-CDSOCJDE        PIC X(5).                            
000049     10 A531-CODFORNV        PIC X(5).                            
000050     10 A531-CODFORNA        PIC X(5).                            
000051     10 A531-IMPCCASO        PIC S9(13) COMP-3.                   
000052     10 A531-TRIBCCIA        PIC X(10).                           
000053     10 A531-PROLEGAL        PIC X(2).                            
000054     10 A531-FLSOCSAP        PIC X(1).                            
000055     10 A531-DIVIXLAV        PIC X(2).                            
000056******************************************************************
000057* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 51      *
000058******************************************************************
      *<<((file: FDANA531))
000070*------------------------------- DANAGRAF.TSTABILIMENTI           
000071 01  FILLER                      PIC X(8) VALUE 'FDANA838'.       
000072*    EXEC SQL INCLUDE FDANA838 END-EXEC.                          
      *>>((file: FDANA838))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TSTABILIMENTI)                           *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA838))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(A838-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011******************************************************************
000012* COBOL DECLARATION FOR TABLE DANAGRAF.TSTABILIMENTI             *
000013******************************************************************
000014 01  DCLTSTABILIMENTI.                                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000015     10 A838-STABILIM        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000016     10 A838-CODSOCIE        PIC X(2).                            
000017     10 A838-NOMESTAB        PIC X(24).                           
000018     10 A838-INDISTAB        PIC X(24).                           
000019     10 A838-CITTSTAB        PIC X(18).                           
000020     10 A838-CAPSTABI        PIC X(5).                            
000021     10 A838-CODIZONA        PIC X(2).                            
000022     10 A838-CODPAESE        PIC X(3).                            
000023     10 A838-CENCOSTO        PIC X(5).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000024     10 A838-CODFORNI        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025     10 A838-CODDEPFF        PIC X(2).                            
000026     10 A838-CODDEPGG        PIC X(2).                            
000027     10 A838-CODDEPTT        PIC X(2).                            
000028     10 A838-NRPOSMAG        PIC X(1).                            
000029     10 A838-FLLOCREM        PIC X(1).                            
000030     10 A838-ESNOMSTA        PIC X(50).                           
000031     10 A838-FLPALAUT        PIC X(1).                            
000032     10 A838-FLGESFIL        PIC X(1).                            
000033     10 A838-FLGESSUB        PIC X(1).                            
000034     10 A838-FLGESGRE        PIC X(1).                            
000035     10 A838-DTCREAZI        PIC X(8).                            
000036     10 A838-DTULTVAR        PIC X(8).                            
000037     10 A838-CODUTVAR        PIC X(6).                            
000038     10 A838-PRIMNLOT        PIC X(1).                            
000039     10 A838-LUNGNLOT        PIC X(2).                            
000040     10 A838-FLIMBAUT        PIC X(1).                            
000041     10 A838-FLIMBMAN        PIC X(1).                            
000042     10 A838-FLAGMAGA        PIC X(1).                            
000043     10 A838-FLREPSUC        PIC X(1).                            
000044     10 A838-NRCAMMAX        PIC S9(3)V USAGE COMP-3.             
000045     10 A838-QTORDMIN        PIC S9(7)V USAGE COMP-3.             
000046     10 A838-TMATTMED        PIC S9(3)V USAGE COMP-3.             
000047     10 A838-DLCAMBIL        PIC S9(3)V USAGE COMP-3.             
000048     10 A838-NRMAXLOT        PIC S9(3)V USAGE COMP-3.             
000049     10 A838-FLNWAVAN        PIC X(1).                            
000050     10 A838-FLAGMANU        PIC X(1).                            
000051     10 A838-UTENSTAM        PIC X(6).                            
000052     10 A838-CENCOSCO        PIC X(5).                            
000053     10 A838-CODDEPSC        PIC X(2).                            
000054     10 A838-CODDEPRI        PIC X(2).                            
000055     10 A838-CENCOOLD        PIC X(5).                            
000056     10 A838-FLXFATIN        PIC X(1).                            
000057     10 A838-FLAGXWMS        PIC X(1).                            
000058     10 A838-FLAGXFTP        PIC X(1).                            
000059******************************************************************
000060* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 44      *
000061******************************************************************
      *<<((file: FDANA838))
000073*------------------------------ DCONTCLI.TCONTIDCE                
000074 01  FILLER                      PIC X(08) VALUE 'FDCLI861'.      
000075*    EXEC SQL INCLUDE FDCLI861 END-EXEC.                          
      *>>((file: FDCLI861))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DCONTCLI.TCONTIDCE                 *
000003******************************************************************
000004 01  DCLTCONTIDCE.                                                
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 C861-CONTODCE        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000006     10 C861-CODPIANO        PIC X(2).                            
000007     10 C861-CONTPROV        PIC X(6).                            
000008     10 C861-DESCRDCE        PIC X(25).                           
000009     10 C861-ANNULLAM        PIC X(1).                            
000010     10 C861-TIPCONTO        PIC X(2).                            
000011     10 C861-CONTGRUP        PIC X(6).                            
000012     10 C861-NOTECON1        PIC X(33).                           
000013     10 C861-NOTECON2        PIC X(33).                           
000014     10 C861-INDBILQU        PIC X(1).                            
000015     10 C861-FLCOMMES        PIC X(1).                            
000016******************************************************************
000017* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 11 C861- 
000018******************************************************************
      *<<((file: FDCLI861))
000076*------------------------------ DFATTURE.TFATTURESTOR             
000077 01  FILLER                      PIC X(08) VALUE 'FDFAT884'.      
000078*    EXEC SQL INCLUDE FDFAT884 END-EXEC.                          
      *>>((file: FDFAT884))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DFATTURE.TFATTURESTOR              *
000003******************************************************************
000004 01  DCLTFATTURESTOR.                                             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 F884-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000006     10 F884-SOCIEMER        PIC X(2).                            
000007     10 F884-CODPAESE        PIC X(3).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000008     10 F884-CODCLIEN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000009     10 F884-NRFATPRO        PIC X(6).                            
000010     10 F884-TIPOMERC        PIC X(1).                            
000011     10 F884-TIPSPEDI        PIC X(1).                            
000012     10 F884-UNMISURA        PIC X(2).                            
000013     10 F884-CODIRESA        PIC X(1).                            
000014     10 F884-AADISTSP        PIC X(7).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000015     10 F884-AANUMFAT        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000016     10 F884-DTFATTUR        PIC X(8).                            
000017     10 F884-QTAFATTU        PIC S9(7)V9(2) USAGE COMP-3.         
000018     10 F884-TTCOLFAT        PIC S9(5)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000019     10 F884-KGLORFAT        PIC S9(7)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000020     10 F884-KGNETFAT        PIC S9(7)V9(2) USAGE COMP-3.         
000021     10 F884-INDICIMB        PIC X(1).                            
000022     10 F884-VOLFATTU        PIC S9(4)V9(3) USAGE COMP-3.         
000023     10 F884-VALRFATT        PIC S9(9)V9(2) USAGE COMP-3.         
000024     10 F884-TTVALFAT        PIC S9(9)V9(2) USAGE COMP-3.         
000025     10 F884-AANRFATN        PIC X(8).                            
000026     10 F884-NUMBOLLA        PIC X(16).                           
000027     10 F884-DATBOLLA        PIC X(8).                            
000028     10 F884-NRDICVAL        PIC X(6).                            
000029     10 F884-BOLLADOG        PIC X(6).                            
000030     10 F884-FLFATBOL        PIC X(1).                            
000031     10 F884-COSTRFAT        PIC S9(9)V9(2) USAGE COMP-3.         
000032     10 F884-SOCIEPAS        PIC X(2).                            
000033     10 F884-CODDEPOS        PIC X(2).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000034     10 F884-GENEFATT        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000035     10 F884-PAESFATT        PIC X(3).                            
000036     10 F884-CENCOSTO        PIC X(5).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000037     10 F884-AANRFATR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000038     10 F884-CAUSACON        PIC X(1).                            
000039     10 F884-FLSUPFAT        PIC X(1).                            
000040     10 F884-CDMOVCON        PIC X(1).                            
000041     10 F884-CLIEMERC        PIC X(5).                            
000042     10 F884-DTFATUSA        PIC X(8).                            
000043     10 F884-NRFACTOR        PIC X(10).                           
000044     10 F884-CONDPAGA        PIC X(3).                            
000045     10 F884-IMPROFAT        PIC S9(9)V9(2) USAGE COMP-3.         
000046     10 F884-AADISTCO        PIC X(7).                            
000047     10 F884-CODDIVIS        PIC X(2).                            
000048     10 F884-CODAWBXX        PIC X(21).                           
000049     10 F884-FORMDEFI        PIC X(2).                            
000050     10 F884-VALRFAEU        PIC S9(9)V9(2) USAGE COMP-3.         
000051     10 F884-VALRRFEU        PIC S9(9)V9(2) USAGE COMP-3.         
000052     10 F884-COSTRFEU        PIC S9(9)V9(2) USAGE COMP-3.         
000053     10 F884-COSTRNEU        PIC S9(9)V9(2) USAGE COMP-3.         
000054     10 F884-COSTRSEU        PIC S9(9)V9(2) USAGE COMP-3.         
000055     10 F884-IMFATREU        PIC S9(9)V9(2) USAGE COMP-3.         
000056     10 F884-CDRESSTD        PIC X(1).                            
000057     10 F884-TPSPESTD        PIC X(1).                            
000058     10 F884-CDCORSTD        PIC X(5).                            
000059     10 F884-CDSPESTD        PIC X(5).                            
000060     10 F884-FLPROVPA        PIC X(1).                            
000061     10 F884-ZONAMERC        PIC X(2).                            
000062     10 F884-CODMRNXX        PIC X(18).                           
000063     10 F884-AANUMFRI        PIC X(8).                            
000064     10 F884-IMPORIVA        PIC S9(9)V9(2) USAGE COMP-3.         
000065     10 F884-IVAXEURO        PIC S9(9)V9(2) USAGE COMP-3.         
000066     10 F884-COSTRFAZ        PIC S9(11)V9(2) USAGE COMP-3.        
000067     10 F884-AANUMTRA        PIC X(8).                            
000068     10 F884-COSASFAT        PIC S9(11)V9(2) USAGE COMP-3.        
000069     10 F884-COSASFEU        PIC S9(11)V9(2) USAGE COMP-3.        
000070******************************************************************
000071* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 64      *
000072******************************************************************
      *<<((file: FDFAT884))
000079*------------------------------ DFATTURE.TDISTISPEDSTOR           
000080 01  FILLER                      PIC X(08) VALUE 'FDFAT885'.      
000081*    EXEC SQL INCLUDE FDFAT885 END-EXEC.                          
      *>>((file: FDFAT885))
000001******************************************************************
000002* DCLGEN TABLE(DFATTURE.TDISTISPEDSTOR)                          *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDFAT885))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(F885-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DFATTURE.TDISTISPEDSTOR TABLE               
000012*     ( CODSOCIE                       CHAR(2) NOT NULL,           
000013*       TIPODIST                       CHAR(1) NOT NULL,           
000014*       AADISTSP                       CHAR(7) NOT NULL,           
000015*       AADISTCO                       CHAR(7) NOT NULL,           
000016*       DATADIST                       CHAR(8) NOT NULL,           
000017*       CODSPEDI                       CHAR(5) NOT NULL,           
000018*       CODICORR                       CHAR(5) NOT NULL,           
000019*       CODPAESE                       CHAR(3) NOT NULL,           
000020*       TIPODOGA                       CHAR(1) NOT NULL,           
000021*       CODDEPOS                       CHAR(2) NOT NULL,           
000022*       NUMPREAV                       CHAR(6) NOT NULL,           
000023*       SERIEDOG                       CHAR(8) NOT NULL,           
000024*       BOLLADOG                       CHAR(6) NOT NULL,           
000025*       DATBOLLA                       CHAR(8) NOT NULL,           
000026*       NUMRICTR                       CHAR(7) NOT NULL,           
000027*       TEMPDIST                       CHAR(4) NOT NULL,           
000028*       TTFATDIS                       DECIMAL(5, 0) NOT NULL,     
000029*       TTCOLDIS                       DECIMAL(5, 0) NOT NULL,     
000030*       KGLORDIS                       DECIMAL(9, 2) NOT NULL,     
000031*       VOLDISTI                       DECIMAL(7, 3) NOT NULL,     
000032*       VALRDIST                       DECIMAL(13, 2) NOT NULL,    
000033*       FLAGTELE                       CHAR(1) NOT NULL,           
000034*       VALRDISZ                       DECIMAL(13, 2) NOT NULL,    
000035*       TTCOLDIZ                       DECIMAL(5, 0) NOT NULL,     
000036*       FLLETSDO                       CHAR(1) NOT NULL,           
000037*       FLXEMAIL                       CHAR(1) NOT NULL,           
000038*       CODPIATF                       CHAR(5) NOT NULL            
000039*     ) END-EXEC
                                                                        
000040******************************************************************
000041* COBOL DECLARATION FOR TABLE DFATTURE.TDISTISPEDSTOR            *
000042******************************************************************
000043 01  DCLTDISTISPEDSTOR.                                           
000044*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000045     10 F885-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000046*                       TIPODIST                                  
000047     10 F885-TIPODIST        PIC X(1).                            
000048*                       AADISTSP                                  
000049     10 F885-AADISTSP        PIC X(7).                            
000050*                       AADISTCO                                  
000051     10 F885-AADISTCO        PIC X(7).                            
000052*                       DATADIST                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000053     10 F885-DATADIST        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000054*                       CODSPEDI                                  
000055     10 F885-CODSPEDI        PIC X(5).                            
000056*                       CODICORR                                  
000057     10 F885-CODICORR        PIC X(5).                            
000058*                       CODPAESE                                  
000059     10 F885-CODPAESE        PIC X(3).                            
000060*                       TIPODOGA                                  
000061     10 F885-TIPODOGA        PIC X(1).                            
000062*                       CODDEPOS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000063     10 F885-CODDEPOS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000064*                       NUMPREAV                                  
000065     10 F885-NUMPREAV        PIC X(6).                            
000066*                       SERIEDOG                                  
000067     10 F885-SERIEDOG        PIC X(8).                            
000068*                       BOLLADOG                                  
000069     10 F885-BOLLADOG        PIC X(6).                            
000070*                       DATBOLLA                                  
000071     10 F885-DATBOLLA        PIC X(8).                            
000072*                       NUMRICTR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000073     10 F885-NUMRICTR        PIC X(7).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000074*                       TEMPDIST                                  
000075     10 F885-TEMPDIST        PIC X(4).                            
000076*                       TTFATDIS                                  
000077     10 F885-TTFATDIS        PIC S9(5)V USAGE COMP-3.             
000078*                       TTCOLDIS                                  
000079     10 F885-TTCOLDIS        PIC S9(5)V USAGE COMP-3.             
000080*                       KGLORDIS                                  
000081     10 F885-KGLORDIS        PIC S9(7)V9(2) USAGE COMP-3.         
000082*                       VOLDISTI                                  
000083     10 F885-VOLDISTI        PIC S9(4)V9(3) USAGE COMP-3.         
000084*                       VALRDIST                                  
000085     10 F885-VALRDIST        PIC S9(11)V9(2) USAGE COMP-3.        
000086*                       FLAGTELE                                  
000087     10 F885-FLAGTELE        PIC X(1).                            
000088*                       VALRDISZ                                  
000089     10 F885-VALRDISZ        PIC S9(11)V9(2) USAGE COMP-3.        
000090*                       TTCOLDIZ                                  
000091     10 F885-TTCOLDIZ        PIC S9(5)V USAGE COMP-3.             
000092*                       FLLETSDO                                  
000093     10 F885-FLLETSDO        PIC X(1).                            
000094*                       FLXEMAIL                                  
000095     10 F885-FLXEMAIL        PIC X(1).                            
000096*                       CODPIATF                                  
000097     10 F885-CODPIATF        PIC X(5).                            
000098******************************************************************
000099* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 27      *
000100******************************************************************
      *<<((file: FDFAT885))
000082*------------------------------ DFATTURE.TDISTSPEGFSTOR           
000083 01  FILLER                      PIC X(08) VALUE 'FDFAT954'.      
000084*    EXEC SQL INCLUDE FDFAT954 END-EXEC.                          
      *>>((file: FDFAT954))
000001******************************************************************
000002* DCLGEN TABLE(DFATTURE.TDISTSPEGFSTOR)                          *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDFAT954))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(F954-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DFATTURE.TDISTSPEGFSTOR TABLE               
000012*     ( CODSOCIE                       CHAR(2) NOT NULL,           
000013*       CODDEPOS                       CHAR(2) NOT NULL,           
000014*       TIPODIST                       CHAR(1) NOT NULL,           
000015*       AADISTCO                       CHAR(7) NOT NULL,           
000016*       CODSPEDI                       CHAR(5) NOT NULL,           
000017*       AADISTSP                       CHAR(7) NOT NULL,           
000018*       CODICORR                       CHAR(5) NOT NULL,           
000019*       DATADIST                       CHAR(8) NOT NULL,           
000020*       CODPAESE                       CHAR(3) NOT NULL,           
000021*       TIPODOGA                       CHAR(1) NOT NULL,           
000022*       NUMPREAV                       CHAR(6) NOT NULL,           
000023*       SERIEDOG                       CHAR(8) NOT NULL,           
000024*       BOLLADOG                       CHAR(6) NOT NULL,           
000025*       DATBOLLA                       CHAR(8) NOT NULL,           
000026*       DTCREAZI                       CHAR(8) NOT NULL,           
000027*       DTULTVAR                       CHAR(8) NOT NULL,           
000028*       CODUTVAR                       CHAR(6) NOT NULL,           
000029*       NUMRICTR                       CHAR(7) NOT NULL,           
000030*       TEMPDIST                       CHAR(4) NOT NULL,           
000031*       TTFATDIS                       DECIMAL(5, 0) NOT NULL,     
000032*       TTCOLDIS                       DECIMAL(5, 0) NOT NULL,     
000033*       KGLORDIS                       DECIMAL(9, 2) NOT NULL,     
000034*       VOLDISTI                       DECIMAL(7, 3) NOT NULL,     
000035*       VALRDIST                       DECIMAL(13, 2) NOT NULL,    
000036*       FLAGTELE                       CHAR(1) NOT NULL,           
000037*       VALRDISZ                       DECIMAL(13, 2) NOT NULL,    
000038*       TTCOLDIZ                       DECIMAL(5, 0) NOT NULL,     
000039*       FLLETSDO                       CHAR(1) NOT NULL,           
000040*       FLXEMAIL                       CHAR(1) NOT NULL,           
000041*       CODPIATF                       CHAR(5) NOT NULL            
000042*     ) END-EXEC
                                                                        
000043******************************************************************
000044* COBOL DECLARATION FOR TABLE DFATTURE.TDISTSPEGFSTOR            *
000045******************************************************************
000046 01  DCLTDISTSPEGFSTOR.                                           
000047*                       CODSOCIE                                  
000048     10 F954-CODSOCIE        PIC X(2).                            
000049*                       CODDEPOS                                  
000050     10 F954-CODDEPOS        PIC X(2).                            
000051*                       TIPODIST                                  
000052     10 F954-TIPODIST        PIC X(1).                            
000053*                       AADISTCO                                  
000054     10 F954-AADISTCO        PIC X(7).                            
000055*                       CODSPEDI                                  
000056     10 F954-CODSPEDI        PIC X(5).                            
000057*                       AADISTSP                                  
000058     10 F954-AADISTSP        PIC X(7).                            
000059*                       CODICORR                                  
000060     10 F954-CODICORR        PIC X(5).                            
000061*                       DATADIST                                  
000062     10 F954-DATADIST        PIC X(8).                            
000063*                       CODPAESE                                  
000064     10 F954-CODPAESE        PIC X(3).                            
000065*                       TIPODOGA                                  
000066     10 F954-TIPODOGA        PIC X(1).                            
000067*                       NUMPREAV                                  
000068     10 F954-NUMPREAV        PIC X(6).                            
000069*                       SERIEDOG                                  
000070     10 F954-SERIEDOG        PIC X(8).                            
000071*                       BOLLADOG                                  
000072     10 F954-BOLLADOG        PIC X(6).                            
000073*                       DATBOLLA                                  
000074     10 F954-DATBOLLA        PIC X(8).                            
000075*                       DTCREAZI                                  
000076     10 F954-DTCREAZI        PIC X(8).                            
000077*                       DTULTVAR                                  
000078     10 F954-DTULTVAR        PIC X(8).                            
000079*                       CODUTVAR                                  
000080     10 F954-CODUTVAR        PIC X(6).                            
000081*                       NUMRICTR                                  
000082     10 F954-NUMRICTR        PIC X(7).                            
000083*                       TEMPDIST                                  
000084     10 F954-TEMPDIST        PIC X(4).                            
000085*                       TTFATDIS                                  
000086     10 F954-TTFATDIS        PIC S9(5)V USAGE COMP-3.             
000087*                       TTCOLDIS                                  
000088     10 F954-TTCOLDIS        PIC S9(5)V USAGE COMP-3.             
000089*                       KGLORDIS                                  
000090     10 F954-KGLORDIS        PIC S9(7)V9(2) USAGE COMP-3.         
000091*                       VOLDISTI                                  
000092     10 F954-VOLDISTI        PIC S9(4)V9(3) USAGE COMP-3.         
000093*                       VALRDIST                                  
000094     10 F954-VALRDIST        PIC S9(11)V9(2) USAGE COMP-3.        
000095*                       FLAGTELE                                  
000096     10 F954-FLAGTELE        PIC X(1).                            
000097*                       VALRDISZ                                  
000098     10 F954-VALRDISZ        PIC S9(11)V9(2) USAGE COMP-3.        
000099*                       TTCOLDIZ                                  
000100     10 F954-TTCOLDIZ        PIC S9(5)V USAGE COMP-3.             
000101*                       FLLETSDO                                  
000102     10 F954-FLLETSDO        PIC X(1).                            
000103*                       FLXEMAIL                                  
000104     10 F954-FLXEMAIL        PIC X(1).                            
000105*                       CODPIATF                                  
000106     10 F954-CODPIATF        PIC X(5).                            
000107******************************************************************
000108* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 30      *
000109******************************************************************
      *<<((file: FDFAT954))
000085*------------------------------ DFATTURE.TFATTUREGFSTOR           
000086 01  FILLER                      PIC X(08) VALUE 'FDFAT956'.      
000087*    EXEC SQL INCLUDE FDFAT956 END-EXEC.                          
      *>>((file: FDFAT956))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DFATTURE.TFATTUREGFSTOR            *
000003******************************************************************
000004 01  DCLTFATTUREGFSTOR.                                           
000005     10 F956-CODSOCIE        PIC X(2).                            
000006     10 F956-AANUMFAT        PIC X(8).                            
000007     10 F956-DTFATTUR        PIC X(8).                            
000008     10 F956-NRFATPRO        PIC X(6).                            
000009     10 F956-CATEARTI        PIC X(1).                            
000010     10 F956-PAESFATT        PIC X(3).                            
000011     10 F956-CODCLIEN        PIC X(5).                            
000012     10 F956-CODPAESE        PIC X(3).                            
000013     10 F956-CLIEMERC        PIC X(5).                            
000014     10 F956-SOCIEMER        PIC X(2).                            
000015     10 F956-CODDEPOS        PIC X(2).                            
000016     10 F956-TIPSPEDI        PIC X(1).                            
000017     10 F956-CODDIVIS        PIC X(2).                            
000018     10 F956-UNMISURA        PIC X(2).                            
000019     10 F956-CODIRESA        PIC X(1).                            
000020     10 F956-AADISTSP        PIC X(7).                            
000021     10 F956-AADISTCO        PIC X(7).                            
000022     10 F956-QTAFATTU        PIC S9(7)V9(2) USAGE COMP-3.         
000023     10 F956-TTCOLFAT        PIC S9(5)V USAGE COMP-3.             
000024     10 F956-KGLORFAT        PIC S9(7)V9(2) USAGE COMP-3.         
000025     10 F956-KGNETFAT        PIC S9(7)V9(2) USAGE COMP-3.         
000026     10 F956-VOLFATTU        PIC S9(4)V9(3) USAGE COMP-3.         
000027     10 F956-VALRFATT        PIC S9(9)V9(2) USAGE COMP-3.         
000028     10 F956-TTVALFAT        PIC S9(9)V9(2) USAGE COMP-3.         
000029     10 F956-COSTRFAT        PIC S9(9)V9(2) USAGE COMP-3.         
000030     10 F956-NUMBOLLA        PIC X(16).                           
000031     10 F956-DATBOLLA        PIC X(8).                            
000032     10 F956-NRDICVAL        PIC X(6).                            
000033     10 F956-BOLLADOG        PIC X(6).                            
000034     10 F956-FLFATBOL        PIC X(1).                            
000035     10 F956-CENCOSTO        PIC X(5).                            
000036     10 F956-CAUSACON        PIC X(1).                            
000037     10 F956-FLSUPFAT        PIC X(1).                            
000038     10 F956-CDMOVCON        PIC X(1).                            
000039     10 F956-NRFACTOR        PIC X(10).                           
000040     10 F956-CONDPAGA        PIC X(3).                            
000041     10 F956-IMPROFAT        PIC S9(9)V9(2) USAGE COMP-3.         
000042     10 F956-DTCREAZI        PIC X(8).                            
000043     10 F956-DTULTVAR        PIC X(8).                            
000044     10 F956-CODUTVAR        PIC X(6).                            
000045     10 F956-CODAWBXX        PIC X(21).                           
000046     10 F956-FORMDEFI        PIC X(2).                            
000047     10 F956-GENEFATT        PIC X(1).                            
000048     10 F956-SOCIEPAS        PIC X(2).                            
000049     10 F956-AANRFATN        PIC X(8).                            
000050     10 F956-AANRFATR        PIC X(8).                            
000051     10 F956-VALRFAEU        PIC S9(9)V9(2) USAGE COMP-3.         
000052     10 F956-VALRRFEU        PIC S9(9)V9(2) USAGE COMP-3.         
000053     10 F956-COSTRFEU        PIC S9(9)V9(2) USAGE COMP-3.         
000054     10 F956-COSTRNEU        PIC S9(9)V9(2) USAGE COMP-3.         
000055     10 F956-COSTRSEU        PIC S9(9)V9(2) USAGE COMP-3.         
000056     10 F956-IMFATREU        PIC S9(9)V9(2) USAGE COMP-3.         
000057     10 F956-CDRESSTD        PIC X(1).                            
000058     10 F956-TPSPESTD        PIC X(1).                            
000059     10 F956-CDCORSTD        PIC X(5).                            
000060     10 F956-CDSPESTD        PIC X(5).                            
000061     10 F956-FLPROVPA        PIC X(1).                            
000062     10 F956-ZONAMERC        PIC X(2).                            
000063     10 F956-CODMRNXX        PIC X(18).                           
000064     10 F956-AANUMFRI        PIC X(8).                            
000065     10 F956-IMPORIVA        PIC S9(9)V9(2) USAGE COMP-3.         
000066     10 F956-IVAXEURO        PIC S9(9)V9(2) USAGE COMP-3.         
000067     10 F956-COSASFAT        PIC S9(11)V9(2) USAGE COMP-3.        
000068     10 F956-COSASFEU        PIC S9(11)V9(2) USAGE COMP-3.        
000069******************************************************************
000070* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 64      *
000071******************************************************************
      *<<((file: FDFAT956))
000088*------------------------------- DLOGISTI.TORDILOGI               
000089 01  FILLER                      PIC X(8) VALUE 'FDLOG652'.       
000090*    EXEC SQL INCLUDE FDLOG652 END-EXEC.                          
      *>>((file: FDLOG652))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TORDILOGI                 *
000003******************************************************************
000004 01  DCLTORDILOGI.                                                
000005*                       AANUMORD                                  
000006     10 L652-AANUMORD        PIC X(8).                            
000007*                       CODCLIEN                                  
000008     10 L652-CODCLIEN        PIC X(5).                            
000009*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000010     10 L652-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000011*                       CDDIVISI                                  
000012     10 L652-CDDIVISI        PIC X(1).                            
000013*                       DTCARORD                                  
000014     10 L652-DTCARORD        PIC X(8).                            
000015*                       CODDIVIS                                  
000016     10 L652-CODDIVIS        PIC X(2).                            
000017*                       TIPSERVI                                  
000018     10 L652-TIPSERVI        PIC X(1).                            
000019*                       FLAGAUTO                                  
000020     10 L652-FLAGAUTO        PIC X(1).                            
000021*                       FLAGGIVA                                  
000022     10 L652-FLAGGIVA        PIC X(1).                            
000023*                       CONTODCE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000024     10 L652-CONTODCE        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025*                       DTEVAORD                                  
000026     10 L652-DTEVAORD        PIC X(8).                            
000027*                       AANUMFAT                                  
000028     10 L652-AANUMFAT        PIC X(8).                            
000029*                       DTFATTUR                                  
000030     10 L652-DTFATTUR        PIC X(8).                            
000031*                       NRPREATT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000032     10 L652-NRPREATT        PIC X(10).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000033*                       DTPREATT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000034     10 L652-DTPREATT        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000035*                       DTCREAZI                                  
000036     10 L652-DTCREAZI        PIC X(8).                            
000037*                       DTULTVAR                                  
000038     10 L652-DTULTVAR        PIC X(8).                            
000039*                       CODUTVAR                                  
000040     10 L652-CODUTVAR        PIC X(6).                            
000041*                       DTANNULL                                  
000042     10 L652-DTANNULL        PIC X(8).                            
000043*                       SOCIEMER                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000044     10 L652-SOCIEMER        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000045*                       DATAESTR                                  
000046     10 L652-DATAESTR        PIC X(8).                            
000047*                       AAMMCOMP                                  
000048     10 L652-AAMMCOMP        PIC X(6).                            
000049*                       FLAGSOSP                                  
000050     10 L652-FLAGSOSP        PIC X(1).                            
000051*                       CODUTEVB                                  
000052     10 L652-CODUTEVB        PIC X(6).                            
000053*                       ESENTIVA                                  
000054     10 L652-ESENTIVA        PIC X(1).                            
000055*                       FLORDIVB                                  
000056     10 L652-FLORDIVB        PIC X(1).                            
000057******************************************************************
000058* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 26      *
000059******************************************************************
      *<<((file: FDLOG652))
000091*------------------------------- DLOGISTI.TRIGORDILOGI            
000092 01  FILLER                      PIC X(8) VALUE 'FDLOG653'.       
000093*    EXEC SQL INCLUDE FDLOG653 END-EXEC.                          
      *>>((file: FDLOG653))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TRIGORDILOGI              *
000003******************************************************************
000004 01  DCLTRIGORDILOGI.                                             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 L653-AANUMORD        PIC X(8).                            
000006     10 L653-NRRIGORD        PIC S9(5)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007     10 L653-CODSERVI        PIC X(6).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000008     10 L653-UNMISURA        PIC X(2).                            
000009     10 L653-QTAORDIN        PIC S9(7)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000010     10 L653-PREZZORD        PIC S9(7)V9(4) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000011     10 L653-IMPORDIN        PIC S9(11)V9(2) USAGE COMP-3.        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000012     10 L653-NOTENOTE        PIC X(40).                           
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000013     10 L653-CENCOSTD        PIC X(5).                            
000014     10 L653-CENCOSTA        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000015     10 L653-RIFECLIE        PIC X(15).                           
000016     10 L653-DTCREAZI        PIC X(8).                            
000017     10 L653-DTULTVAR        PIC X(8).                            
000018     10 L653-CODUTVAR        PIC X(6).                            
000019     10 L653-DTANNULL        PIC X(8).                            
000020     10 L653-IMPORIVA        PIC S9(11)V9(2) USAGE COMP-3.        
000021******************************************************************
000022* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 16      *
000023******************************************************************
      *<<((file: FDLOG653))
000094*------------------------------- DLOGISTI.TDETTORDILOGI           
000095 01  FILLER                      PIC X(8) VALUE 'FDLOG655'.       
000096*    EXEC SQL INCLUDE FDLOG655 END-EXEC.                          
      *>>((file: FDLOG655))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TDETTORDILOGI             *
000003******************************************************************
000004 01  DCLTDETTORDILOGI.                                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 L655-AANUMORD        PIC X(8).                            
000006     10 L655-NRRIGORD        PIC S9(5)V USAGE COMP-3.             
000007     10 L655-NUMPROG7        PIC S9(7)V USAGE COMP-3.             
000008     10 L655-CDMCAGTM        PIC X(1).                            
000009     10 L655-CDAREGTM        PIC X(2).                            
000010     10 L655-CDDIPGTM        PIC X(1).                            
000011     10 L655-TIPOADDE        PIC X(2).                            
000012     10 L655-KEYADDE1        PIC X(5).                            
000013     10 L655-KEYADDE2        PIC X(3).                            
000014     10 L655-KEYADDE3        PIC X(3).                            
000015     10 L655-KEYADDE4        PIC X(5).                            
000016     10 L655-CODSOCID        PIC X(2).                            
000017     10 L655-CDDIVISD        PIC X(1).                            
000018     10 L655-CENCOSTD        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000019     10 L655-CONTODCD        PIC X(6).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000020     10 L655-CODSOCIA        PIC X(2).                            
000021     10 L655-CDDIVISA        PIC X(1).                            
000022     10 L655-CENCOSTA        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000023     10 L655-CONTODCA        PIC X(6).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000024     10 L655-UNMISURA        PIC X(2).                            
000025     10 L655-QTAORDIN        PIC S9(7)V9(2) USAGE COMP-3.         
000026     10 L655-IMPORDIN        PIC S9(11)V9(2) USAGE COMP-3.        
000027     10 L655-CODSOCIE        PIC X(2).                            
000028     10 L655-AANUMFAT        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000029     10 L655-CENCOSTO        PIC X(5).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000030     10 L655-SOCIEMER        PIC X(2).                            
000031     10 L655-PROLOMER        PIC X(2).                            
000032     10 L655-CODLINEA        PIC X(2).                            
000033     10 L655-TIPOARTI        PIC X(1).                            
000034     10 L655-MERCEMAG        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000035     10 L655-CODARTIC        PIC X(5).                            
000036     10 L655-CODDISEG        PIC X(5).                            
000037     10 L655-CODVARIA        PIC X(3).                            
000038     10 L655-STAGIONE        PIC X(2).                            
000039     10 L655-CAUSAMOV        PIC X(2).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000040     10 L655-CLIEFORN        PIC X(5).                            
000041     10 L655-INCLIFOR        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000042     10 L655-STABILIM        PIC X(2).                            
000043     10 L655-NRDISPOS        PIC X(6).                            
000044     10 L655-SIGLCICL        PIC X(2).                            
000045     10 L655-TIPOAPPA        PIC X(1).                            
000046     10 L655-AANRRECL        PIC X(8).                            
000047     10 L655-NUMERIFE        PIC X(5).                            
000048     10 L655-FLTAGSCA        PIC X(1).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000049     10 L655-CAUSACON        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000050     10 L655-QUALIFIN        PIC X(4).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000051     10 L655-QTAMTMOV        PIC S9(7)V9(2) USAGE COMP-3.         
000052     10 L655-QTAKGMOV        PIC S9(7)V9(2) USAGE COMP-3.         
000053     10 L655-DTCREAZI        PIC X(8).                            
000054     10 L655-DTULTVAR        PIC X(8).                            
000055     10 L655-CODUTVAR        PIC X(6).                            
000056     10 L655-IMPTRPAG        PIC S9(7)V9(2) USAGE COMP-3.         
000057     10 L655-PAESMERC        PIC X(3).                            
000058     10 L655-TIPORECO        PIC X(4).                            
000059     10 L655-DTFATTUR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000060     10 L655-TIPOSTAG        PIC X(1).                            
000061     10 L655-MTDISPOS        PIC S9(7)       COMP-3.              
000062     10 L655-PERC2SCE        PIC S9(2)V9     COMP-3.              
000063     10 L655-MTDIFMAX        PIC S9(7)V99    COMP-3.              
000064     10 L655-MTDIFTOT        PIC S9(7)V99    COMP-3.              
000065     10 L655-MTDIFMES        PIC S9(7)V99    COMP-3.              
000066     10 L655-PARTLAVO        PIC X(6).                            
000067     10 L655-MTDISPAR        PIC S9(7)       COMP-3.              
000068     10 L655-SERIECIL        PIC X(2).                            
000069     10 L655-TPLAVMES        PIC X(1).                            
000070     10 L655-FLAGRICH        PIC X(1).                            
000071     10 L655-NRCILLAV        PIC S9(3)       COMP-3.              
000072     10 L655-SLLAVMES        PIC X(2).                            
000073     10 L655-MTMATEFF        PIC S9(7)V99    COMP-3.              
000074     10 L655-MTCONSUM        PIC S9(7)V99    COMP-3.              
000075     10 L655-QTORDPRE        PIC S9(7)V99    COMP-3.              
000076     10 L655-PREZZORD        PIC S9(7)V9(4)  COMP-3.              
000077     10 L655-CODFORVI        PIC X(5).                            
000078     10 L655-CODIMBAL        PIC X(2).                            
000079     10 L655-CODCOLLO        PIC X(5).                            
000080     10 L655-MTRAGDIS        PIC S9(7) COMP-3.                    
000081     10 L655-NUMDISTI        PIC X(6).                            
000082******************************************************************
000083* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 77      *
000084******************************************************************
      *<<((file: FDLOG655))
000097*------------------------------- DSCORTE.TRICHSCOR                
000098 01  FILLER                      PIC X(8) VALUE 'FDSCO585'.       
000099*    EXEC SQL INCLUDE FDSCO585 END-EXEC.                          
      *>>((file: FDSCO585))
000001******************************************************************
000002* DCLGEN TABLE(DSCORTE.TRICHSCOR)                                *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDSCO585))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(S585-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011******************************************************************
000012* COBOL DECLARATION FOR TABLE DSCORTE.TRICHSCOR                  *
000013******************************************************************
000014 01  DCLTRICHSCOR.                                                
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000015     10 S585-AANUMRIC        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000016     10 S585-CODSOCIE        PIC X(2).                            
000017     10 S585-DEPDESTI        PIC X(2).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000018     10 S585-CODFORNI        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000019     10 S585-NRCOMMES        PIC X(24).                           
000020     10 S585-CENCOSTO        PIC X(5).                            
000021     10 S585-CONTODCE        PIC X(6).                            
000022     10 S585-CODUTENT        PIC X(6).                            
000023     10 S585-DATARICH        PIC X(8).                            
000024     10 S585-DTEVARIC        PIC X(8).                            
000025     10 S585-DTANNULL        PIC X(8).                            
000026     10 S585-NOTERICH        PIC X(16).                           
000027     10 S585-UFFCOMME        PIC X(2).                            
000028     10 S585-RICHORIG        PIC X(8).                            
000029     10 S585-DTCREAZI        PIC X(8).                            
000030     10 S585-DTULTVAR        PIC X(8).                            
000031     10 S585-CODUTVAR        PIC X(6).                            
000032     10 S585-LETTAGEN        PIC X(1).                            
000033     10 S585-DTCONFRI        PIC X(8).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000034     10 S585-INCLIFOR        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000035     10 S585-ITAESTER        PIC X(1).                            
000036     10 S585-CODAGENT        PIC X(2).                            
000037     10 S585-TIPSPEDI        PIC X(1).                            
000038     10 S585-PROLOMER        PIC X(2).                            
000039     10 S585-FLAGSTAM        PIC X(1).                            
000040     10 S585-CODDIVIS        PIC X(2).                            
000041     10 S585-CODICORR        PIC X(5).                            
000042     10 S585-NUMDISTI        PIC X(6).                            
000043     10 S585-NOMCDAWB        PIC X(10).                           
000044     10 S585-CODAWBXX        PIC X(21).                           
000045     10 S585-FLAGMAGA        PIC X(1).                            
000046     10 S585-CATEARTI        PIC X(1).                            
000047     10 S585-CODBUYER        PIC X(2).                            
000048     10 S585-CDDIVISI        PIC X(1).                            
000049******************************************************************
000050* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 34      *
000051******************************************************************
      *<<((file: FDSCO585))
000100*------------------------------- DTRASP.TCOSTRASPCDC              
000101 01  FILLER                      PIC X(8) VALUE 'FDTRA308'.       
000102*    EXEC SQL INCLUDE FDTRA308 END-EXEC.                          
      *>>((file: FDTRA308))
000001******************************************************************
000002* DCLGEN TABLE(DTRASP.TCOSTRASPCDC)                              *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDTRA308))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(T308-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DTRASP.TCOSTRASPCDC TABLE                   
000012*     ( DTFATTUR                       CHAR(8) NOT NULL,           
000013*       CODSOCIE                       CHAR(2) NOT NULL,           
000014*       AANUMFAT                       CHAR(8) NOT NULL,           
000015*       SOCIEPAS                       CHAR(2) NOT NULL,           
000016*       PAESPROV                       CHAR(3) NOT NULL,           
000017*       PAESMERC                       CHAR(3) NOT NULL,           
000018*       PAESORDI                       CHAR(3) NOT NULL,           
000019*       TIPOARTI                       CHAR(1) NOT NULL,           
000020*       TIPSPEDI                       CHAR(1) NOT NULL,           
000021*       CODIRESA                       CHAR(1) NOT NULL,           
000022*       CONTODCE                       CHAR(6) NOT NULL,           
000023*       CENCOSTO                       CHAR(5) NOT NULL,           
000024*       CENCOTRA                       CHAR(5) NOT NULL,           
000025*       UNMISURA                       CHAR(2) NOT NULL,           
000026*       QTARIGFA                       DECIMAL(9, 2) NOT NULL,     
000027*       KGLORRIG                       DECIMAL(9, 2) NOT NULL,     
000028*       KGNETRIG                       DECIMAL(9, 2) NOT NULL,     
000029*       UNMISLIS                       CHAR(2) NOT NULL,           
000030*       COSTUTRA                       DECIMAL(7, 2) NOT NULL,     
000031*       IMPTRLIS                       DECIMAL(9, 2) NOT NULL,     
000032*       IMPTRCLI                       DECIMAL(9, 2) NOT NULL,     
000033*       IMPTRPAG                       DECIMAL(9, 2) NOT NULL,     
000034*       DTCREAZI                       CHAR(8) NOT NULL,           
000035*       DTULTVAR                       CHAR(8) NOT NULL,           
000036*       CODUTVAR                       CHAR(6) NOT NULL,           
000037*       SOCIEFAT                       CHAR(2) NOT NULL,           
000038*       TIPORECO                       CHAR(4) NOT NULL,           
000039*       TIPOELAB                       CHAR(1) NOT NULL,           
000040*       AANRFATR                       CHAR(8) NOT NULL,           
000041*       AANUMORD                       CHAR(8) NOT NULL,           
000042*       NRRIGORD                       DECIMAL(3, 0) NOT NULL      
000043*     ) END-EXEC
                                                                        
000044******************************************************************
000045* COBOL DECLARATION FOR TABLE DTRASP.TCOSTRASPCDC                *
000046******************************************************************
000047 01  DCLTCOSTRASPCDC.                                             
000048*                       DTFATTUR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000049     10 T308-DTFATTUR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000050*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000051     10 T308-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000052*                       AANUMFAT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000053     10 T308-AANUMFAT        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000054*                       SOCIEPAS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000055     10 T308-SOCIEPAS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000056*                       PAESPROV                                  
000057     10 T308-PAESPROV        PIC X(3).                            
000058*                       PAESMERC                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000059     10 T308-PAESMERC        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000060*                       PAESORDI                                  
000061     10 T308-PAESORDI        PIC X(3).                            
000062*                       TIPOARTI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000063     10 T308-TIPOARTI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000064*                       TIPSPEDI                                  
000065     10 T308-TIPSPEDI        PIC X(1).                            
000066*                       CODIRESA                                  
000067     10 T308-CODIRESA        PIC X(1).                            
000068*                       CONTODCE                                  
000069     10 T308-CONTODCE        PIC X(6).                            
000070*                       CENCOSTO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000071     10 T308-CENCOSTO        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000072*                       CENCOTRA                                  
000073     10 T308-CENCOTRA        PIC X(5).                            
000074*                       UNMISURA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000075     10 T308-UNMISURA        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000076*                       QTARIGFA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000077     10 T308-QTARIGFA        PIC S9(7)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000078*                       KGLORRIG                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000079     10 T308-KGLORRIG        PIC S9(7)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000080*                       KGNETRIG                                  
000081     10 T308-KGNETRIG        PIC S9(7)V9(2) USAGE COMP-3.         
000082*                       UNMISLIS                                  
000083     10 T308-UNMISLIS        PIC X(2).                            
000084*                       COSTUTRA                                  
000085     10 T308-COSTUTRA        PIC S9(5)V9(2) USAGE COMP-3.         
000086*                       IMPTRLIS                                  
000087     10 T308-IMPTRLIS        PIC S9(7)V9(2) USAGE COMP-3.         
000088*                       IMPTRCLI                                  
000089     10 T308-IMPTRCLI        PIC S9(7)V9(2) USAGE COMP-3.         
000090*                       IMPTRPAG                                  
000091     10 T308-IMPTRPAG        PIC S9(7)V9(2) USAGE COMP-3.         
000092*                       DTCREAZI                                  
000093     10 T308-DTCREAZI        PIC X(8).                            
000094*                       DTULTVAR                                  
000095     10 T308-DTULTVAR        PIC X(8).                            
000096*                       CODUTVAR                                  
000097     10 T308-CODUTVAR        PIC X(6).                            
000098*                       SOCIEFAT                                  
000099     10 T308-SOCIEFAT        PIC X(2).                            
000100*                       TIPORECO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000101     10 T308-TIPORECO        PIC X(4).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000102*                       TIPOELAB                                  
000103     10 T308-TIPOELAB        PIC X(1).                            
000104*                       AANRFATR                                  
000105     10 T308-AANRFATR        PIC X(8).                            
000106*                       AANUMORD                                  
000107     10 T308-AANUMORD        PIC X(8).                            
000108*                       NRRIGORD                                  
000109     10 T308-NRRIGORD        PIC S9(3)V USAGE COMP-3.             
000110******************************************************************
000111* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 31      *
000112******************************************************************
      *<<((file: FDTRA308))
000103*------------------------------- DTRASP.TNETMOVEREXPO             
000104 01  FILLER                      PIC X(8) VALUE 'FDTRA358'.       
000105*    EXEC SQL INCLUDE FDTRA358 END-EXEC.                          
      *>>((file: FDTRA358))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DTRASP.TNETMOVEREXPO               *
000003******************************************************************
000004 01  DCLTNETMOVEREXPO.                                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 T358-SOCIEFAT        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000006     10 T358-NRPREFAT        PIC X(10).                           
000007     10 T358-DTPREFAT        PIC X(8).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000008     10 T358-CODFORNI        PIC X(5).                            
000009     10 T358-CODSOCIE        PIC X(2).                            
000010     10 T358-AANUMFAT        PIC X(20).                           
000011     10 T358-DTFATTUR        PIC X(8).                            
000012     10 T358-NUMPROG5        PIC S9(5)V USAGE COMP-3.             
000013     10 T358-MERCEMAG        PIC X(2).                            
000014     10 T358-PROLOMER        PIC X(2).                            
000015     10 T358-CODLINEA        PIC X(2).                            
000016     10 T358-CENCOSTO        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000017     10 T358-CDTPCOST        PIC X(10).                           
000018     10 T358-CODDIVIS        PIC X(2).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000019     10 T358-IMPCOSTO        PIC S9(9)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000020     10 T358-DTCREAZI        PIC X(8).                            
000021     10 T358-DTULTVAR        PIC X(8).                            
000022     10 T358-CODUTVAR        PIC X(6).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000023     10 T358-TIPORECO        PIC X(4).                            
000024     10 T358-CONTODCE        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025     10 T358-STPREFAT        PIC X(3).                            
000026     10 T358-DTSPEDIZ        PIC X(8).                            
000027     10 T358-DATATRAS        PIC X(8).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000028     10 T358-CENCOTRA        PIC X(5).                            
000029     10 T358-NRPREATT        PIC X(10).                           
000030     10 T358-DTPREATT        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000031     10 T358-STPREATT        PIC X(3).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000032     10 T358-IMCOSATT        PIC S9(9)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000033     10 T358-NRDOCCOT        PIC X(10).                           
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000034     10 T358-NRRIGORD        PIC S9(3)V USAGE COMP-3.             
000035     10 T358-AANUMORD        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000036******************************************************************
000037* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 31      *
000038******************************************************************
      *<<((file: FDTRA358))
000106*------------------------------- DTRASP.TTRASPORTI                
000107 01  FILLER                      PIC X(8) VALUE 'FDTRA599'.       
000108*    EXEC SQL INCLUDE FDTRA599 END-EXEC.                          
      *>>((file: FDTRA599))
000001******************************************************************
000002* DCLGEN TABLE(DTRASP.TTRASPORTI)                                *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDTRA599))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(T599-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DTRASP.TTRASPORTI TABLE                     
000012*     ( NUMRICTR                       CHAR(7) NOT NULL,           
000013*       CODUTENT                       CHAR(6) NOT NULL,           
000014*       DTRIEXTR                       CHAR(8) NOT NULL,           
000015*       DTRIINTR                       CHAR(8) NOT NULL,           
000016*       CODSOCIE                       CHAR(2) NOT NULL,           
000017*       SOCIECMP                       CHAR(2) NOT NULL,           
000018*       ICLIFOPR                       CHAR(1) NOT NULL,           
000019*       CLIFOPRO                       CHAR(5) NOT NULL,           
000020*       RAGSOPRO                       CHAR(35) NOT NULL,          
000021*       INDIRPRO                       CHAR(35) NOT NULL,          
000022*       CITTAPRO                       CHAR(35) NOT NULL,          
000023*       CDCAPPRO                       CHAR(5) NOT NULL,           
000024*       PROVIPRO                       CHAR(2) NOT NULL,           
000025*       PAESEPRO                       CHAR(3) NOT NULL,           
000026*       NRTELPRO                       CHAR(16) NOT NULL,          
000027*       NRFAXPRO                       CHAR(16) NOT NULL,          
000028*       CONTAPRO                       CHAR(15) NOT NULL,          
000029*       ICLIFODE                       CHAR(1) NOT NULL,           
000030*       CLIFODES                       CHAR(5) NOT NULL,           
000031*       RAGSODES                       CHAR(35) NOT NULL,          
000032*       INDIRDES                       CHAR(35) NOT NULL,          
000033*       CITTADES                       CHAR(35) NOT NULL,          
000034*       CDCAPDES                       CHAR(5) NOT NULL,           
000035*       PROVIDES                       CHAR(2) NOT NULL,           
000036*       PAESEDES                       CHAR(3) NOT NULL,           
000037*       NRTELDES                       CHAR(16) NOT NULL,          
000038*       NRFAXDES                       CHAR(16) NOT NULL,          
000039*       CONTADES                       CHAR(15) NOT NULL,          
000040*       VOLTRASP                       DECIMAL(7, 3) NOT NULL,     
000041*       CODDIVIS                       CHAR(2) NOT NULL,           
000042*       VALTRASP                       DECIMAL(13, 2) NOT NULL,    
000043*       TIPRICTR                       CHAR(1) NOT NULL,           
000044*       PAESESEL                       CHAR(3) NOT NULL,           
000045*       CODPIATF                       CHAR(5) NOT NULL,           
000046*       DISTITRA                       CHAR(7) NOT NULL,           
000047*       SEQDISTR                       CHAR(2) NOT NULL,           
000048*       NOTENOTE                       CHAR(76) NOT NULL,          
000049*       DTCREAZI                       CHAR(8) NOT NULL,           
000050*       DTULTVAR                       CHAR(8) NOT NULL,           
000051*       CODUTVAR                       CHAR(6) NOT NULL,           
000052*       ICLIFORI                       CHAR(1) NOT NULL,           
000053*       CLIFORIG                       CHAR(5) NOT NULL,           
000054*       FLAGESTR                       CHAR(1) NOT NULL,           
000055*       FLTRASPO                       CHAR(1) NOT NULL,           
000056*       NUMERIFE                       CHAR(5) NOT NULL,           
000057*       CDZIPDES                       CHAR(15) NOT NULL,          
000058*       CDZIPPRO                       CHAR(15) NOT NULL,          
000059*       CODAWBXX                       CHAR(21) NOT NULL,          
000060*       AANUMMOV                       CHAR(8) NOT NULL            
000061*     ) END-EXEC
                                                                        
000062******************************************************************
000063* COBOL DECLARATION FOR TABLE DTRASP.TTRASPORTI                  *
000064******************************************************************
000065 01  DCLTTRASPORTI.                                               
000066*                       NUMRICTR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000067     10 T599-NUMRICTR        PIC X(7).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000068*                       CODUTENT                                  
000069     10 T599-CODUTENT        PIC X(6).                            
000070*                       DTRIEXTR                                  
000071     10 T599-DTRIEXTR        PIC X(8).                            
000072*                       DTRIINTR                                  
000073     10 T599-DTRIINTR        PIC X(8).                            
000074*                       CODSOCIE                                  
000075     10 T599-CODSOCIE        PIC X(2).                            
000076*                       SOCIECMP                                  
000077     10 T599-SOCIECMP        PIC X(2).                            
000078*                       ICLIFOPR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000079     10 T599-ICLIFOPR        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000080*                       CLIFOPRO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000081     10 T599-CLIFOPRO        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000082*                       RAGSOPRO                                  
000083     10 T599-RAGSOPRO        PIC X(35).                           
000084*                       INDIRPRO                                  
000085     10 T599-INDIRPRO        PIC X(35).                           
000086*                       CITTAPRO                                  
000087     10 T599-CITTAPRO        PIC X(35).                           
000088*                       CDCAPPRO                                  
000089     10 T599-CDCAPPRO        PIC X(5).                            
000090*                       PROVIPRO                                  
000091     10 T599-PROVIPRO        PIC X(2).                            
000092*                       PAESEPRO                                  
000093     10 T599-PAESEPRO        PIC X(3).                            
000094*                       NRTELPRO                                  
000095     10 T599-NRTELPRO        PIC X(16).                           
000096*                       NRFAXPRO                                  
000097     10 T599-NRFAXPRO        PIC X(16).                           
000098*                       CONTAPRO                                  
000099     10 T599-CONTAPRO        PIC X(15).                           
000100*                       ICLIFODE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000101     10 T599-ICLIFODE        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000102*                       CLIFODES                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000103     10 T599-CLIFODES        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000104*                       RAGSODES                                  
000105     10 T599-RAGSODES        PIC X(35).                           
000106*                       INDIRDES                                  
000107     10 T599-INDIRDES        PIC X(35).                           
000108*                       CITTADES                                  
000109     10 T599-CITTADES        PIC X(35).                           
000110*                       CDCAPDES                                  
000111     10 T599-CDCAPDES        PIC X(5).                            
000112*                       PROVIDES                                  
000113     10 T599-PROVIDES        PIC X(2).                            
000114*                       PAESEDES                                  
000115     10 T599-PAESEDES        PIC X(3).                            
000116*                       NRTELDES                                  
000117     10 T599-NRTELDES        PIC X(16).                           
000118*                       NRFAXDES                                  
000119     10 T599-NRFAXDES        PIC X(16).                           
000120*                       CONTADES                                  
000121     10 T599-CONTADES        PIC X(15).                           
000122*                       VOLTRASP                                  
000123     10 T599-VOLTRASP        PIC S9(4)V9(3) USAGE COMP-3.         
000124*                       CODDIVIS                                  
000125     10 T599-CODDIVIS        PIC X(2).                            
000126*                       VALTRASP                                  
000127     10 T599-VALTRASP        PIC S9(11)V9(2) USAGE COMP-3.        
000128*                       TIPRICTR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000129     10 T599-TIPRICTR        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000130*                       PAESESEL                                  
000131     10 T599-PAESESEL        PIC X(3).                            
000132*                       CODPIATF                                  
000133     10 T599-CODPIATF        PIC X(5).                            
000134*                       DISTITRA                                  
000135     10 T599-DISTITRA        PIC X(7).                            
000136*                       SEQDISTR                                  
000137     10 T599-SEQDISTR        PIC X(2).                            
000138*                       NOTENOTE                                  
000139     10 T599-NOTENOTE        PIC X(76).                           
000140*                       DTCREAZI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000141     10 T599-DTCREAZI        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000142*                       DTULTVAR                                  
000143     10 T599-DTULTVAR        PIC X(8).                            
000144*                       CODUTVAR                                  
000145     10 T599-CODUTVAR        PIC X(6).                            
000146*                       ICLIFORI                                  
000147     10 T599-ICLIFORI        PIC X(1).                            
000148*                       CLIFORIG                                  
000149     10 T599-CLIFORIG        PIC X(5).                            
000150*                       FLAGESTR                                  
000151     10 T599-FLAGESTR        PIC X(1).                            
000152*                       FLTRASPO                                  
000153     10 T599-FLTRASPO        PIC X(1).                            
000154*                       NUMERIFE                                  
000155     10 T599-NUMERIFE        PIC X(5).                            
000156*                       CDZIPDES                                  
000157     10 T599-CDZIPDES        PIC X(15).                           
000158*                       CDZIPPRO                                  
000159     10 T599-CDZIPPRO        PIC X(15).                           
000160*                       CODAWBXX                                  
000161     10 T599-CODAWBXX        PIC X(21).                           
000162*                       AANUMMOV                                  
000163     10 T599-AANUMMOV        PIC X(8).                            
000164******************************************************************
000165* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 49      *
000166******************************************************************
      *<<((file: FDTRA599))
000109*------------------------------- DTRASP.TCENCOTRASP               
000110 01  FILLER                      PIC X(8) VALUE 'FDTRA699'.       
000111*    EXEC SQL INCLUDE FDTRA699 END-EXEC.                          
      *>>((file: FDTRA699))
000001******************************************************************
000002* DCLGEN TABLE(DTRASP.TCENCOTRASP)                               *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDTRA699))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(T699-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DTRASP.TCENCOTRASP TABLE                    
000012*     ( NUMRICTR                       CHAR(7) NOT NULL,           
000013*       CENCOSTO                       CHAR(5) NOT NULL,           
000014*       KGCOLTRA                       DECIMAL(7, 2) NOT NULL,     
000015*       CODDIVIS                       CHAR(2) NOT NULL,           
000016*       COSTOTRA                       DECIMAL(11, 2) NOT NULL,    
000017*       DTCREAZI                       CHAR(8) NOT NULL,           
000018*       DTULTVAR                       CHAR(8) NOT NULL,           
000019*       CODUTVAR                       CHAR(6) NOT NULL,           
000020*       TIPOARTI                       CHAR(1) NOT NULL,           
000021*       QUMERTRA                       CHAR(20) NOT NULL,          
000022*       NRRIGTRA                       DECIMAL(3, 0) NOT NULL      
000023*     ) END-EXEC
                                                                        
000024******************************************************************
000025* COBOL DECLARATION FOR TABLE DTRASP.TCENCOTRASP                 *
000026******************************************************************
000027 01  DCLTCENCOTRASP.                                              
000028*                       NUMRICTR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000029     10 T699-NUMRICTR        PIC X(7).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000030*                       CENCOSTO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000031     10 T699-CENCOSTO        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000032*                       KGCOLTRA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000033     10 T699-KGCOLTRA        PIC S9(5)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000034*                       CODDIVIS                                  
000035     10 T699-CODDIVIS        PIC X(2).                            
000036*                       COSTOTRA                                  
000037     10 T699-COSTOTRA        PIC S9(9)V9(2) USAGE COMP-3.         
000038*                       DTCREAZI                                  
000039     10 T699-DTCREAZI        PIC X(8).                            
000040*                       DTULTVAR                                  
000041     10 T699-DTULTVAR        PIC X(8).                            
000042*                       CODUTVAR                                  
000043     10 T699-CODUTVAR        PIC X(6).                            
000044*                       TIPOARTI                                  
000045     10 T699-TIPOARTI        PIC X(1).                            
000046*                       QUMERTRA                                  
000047     10 T699-QUMERTRA        PIC X(20).                           
000048*                       NRRIGTRA                                  
000049     10 T699-NRRIGTRA        PIC S9(3)V USAGE COMP-3.             
000050******************************************************************
000051* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 11      *
000052******************************************************************
      *<<((file: FDTRA699))
000112                                                                  
000113                                                                  
000114*--> DAL 2025 PER PARTENZA OPLA PER SUBLITEX,                     
000115*--> ESCLUDE SOC.24 (CLIFOCON '01054')                            
000116*--> XC NON POTRA' PIU' CREARE LA TDETTORDILOGI                   
000117*--> IN QUANTO IL CICS NON AVRA' I COSTI                          
000118*--> DI NETMOVER CHE SARANNO IN OPLA.                             
000119                                                                  
000121     
      *EXEC SQL 
      *DECLARE POINTER0 CURSOR FOR                             
000122*           SELECT R.AANUMORD, R.NRRIGORD, T.CONTODCE              
000123*                 ,R.CENCOSTA, R.CENCOSTD, R.IMPORDIN              
000124*                 ,R.QTAORDIN, T.CODSOCIE, T.SOCIEMER              
000125*                 ,R.UNMISURA, T.NRPREATT, T.DTPREATT              
000126*             FROM DLOGISTI.TORDILOGI    T                         
000127*                 ,DLOGISTI.TRIGORDILOGI R                         
000128*                 ,DANAGRAF.TCLIENTI     C                         
000129*            WHERE T.AANUMORD = R.AANUMORD                         
000130*              AND T.AAMMCOMP = :WS-MENSILE                        
000131*              AND T.TIPSERVI = 'T'                                
000132*              AND T.CODCLIEN = C.CODCLIEN                         
000133*              AND C.CODSOCIE = '22'                               
000134*              AND C.TIPOCONS = 'T'                                
000135*              AND C.CLIFOCON > ' '                                
000136*              AND C.CLIFOCON <> '01054'                           
000137*              AND T.NRPREATT > ' '                                
000138*              AND R.DTANNULL = ' '                                
000139*            ORDER BY T.NRPREATT, T.DTPREATT                       
000140*                    ,R.AANUMORD, R.NRRIGORD                       
000141*     END-EXEC
                                                                        
000142                                                                  
000144     
      *EXEC SQL 
      *DECLARE POINTER1 CURSOR FOR                             
000145*           SELECT AANUMFAT, IMCOSATT, PROLOMER                    
000146*                 ,CODLINEA, TIPORECO, DTFATTUR                    
000147*                 ,CODFORNI, NUMPROG5, IMPCOSTO                    
000148*                 ,CODSOCIE, CONTODCE, CENCOSTO                    
000149*                 ,CENCOTRA, SOCIEFAT, AANUMORD                    
000150*                 ,MERCEMAG                                        
000151*             FROM DTRASP.TNETMOVEREXPO                            
000152*            WHERE NRPREATT = :T358-NRPREATT                       
000153*              AND DTPREATT = :T358-DTPREATT                       
000154*              AND IMCOSATT > 0                                    
000155*              AND AANUMORD = ' '                                  
000156*            ORDER BY CODSOCIE, CONTODCE, CENCOSTO                 
000157*                    ,CENCOTRA, SOCIEFAT                           
000158*                    ,IMCOSATT DESC                                
000159*     END-EXEC
                                                                        
000160                                                                  
000162     
      *EXEC SQL 
      *DECLARE POINTER2 CURSOR FOR                             
000163*           SELECT A.CODSOCIE, A.AANUMFAT, A.KGLORFAT              
000164*             FROM DFATTURE.TFATTURESTOR   A                       
000165*                 ,DFATTURE.TDISTISPEDSTOR B                       
000166*            WHERE B.CODSOCIE = :F885-CODSOCIE                     
000167*              AND B.CODDEPOS = :F885-CODDEPOS                     
000168*              AND B.DATADIST = :F885-DATADIST                     
000169*              AND B.TIPODIST = 'C'                                
000170*              AND B.NUMRICTR = :F885-NUMRICTR                     
000171*              AND A.AADISTCO = B.AADISTCO                         
000172*              AND A.SOCIEPAS = B.CODSOCIE                         
000173*            UNION                                                 
000174*           SELECT A.CODSOCIE, A.AANUMFAT, A.KGLORFAT              
000175*             FROM DFATTURE.TFATTURESTOR   A                       
000176*                 ,DFATTURE.TDISTISPEDSTOR B                       
000177*            WHERE B.CODSOCIE = :F885-CODSOCIE                     
000178*              AND B.CODDEPOS = :F885-CODDEPOS                     
000179*              AND B.DATADIST = :F885-DATADIST                     
000180*              AND B.TIPODIST = 'S'                                
000181*              AND B.NUMRICTR = :F885-NUMRICTR                     
000182*              AND A.AADISTSP = B.AADISTSP                         
000183*              AND A.SOCIEPAS = B.CODSOCIE                         
000184*            UNION                                                 
000185*           SELECT A.CODSOCIE, A.AANUMFAT, A.KGLORFAT              
000186*             FROM DFATTURE.TFATTUREGFSTOR A                       
000187*                 ,DFATTURE.TDISTSPEGFSTOR B                       
000188*            WHERE B.CODSOCIE = :F885-CODSOCIE                     
000189*              AND B.CODDEPOS = :F885-CODDEPOS                     
000190*              AND B.DATADIST = :F885-DATADIST                     
000191*              AND B.TIPODIST = 'C'                                
000192*              AND B.NUMRICTR = :F885-NUMRICTR                     
000193*              AND A.AADISTCO = B.AADISTCO                         
000194*              AND A.SOCIEPAS = B.CODSOCIE                         
000195*            UNION                                                 
000196*           SELECT A.CODSOCIE, A.AANUMFAT, A.KGLORFAT              
000197*             FROM DFATTURE.TFATTUREGFSTOR A                       
000198*                 ,DFATTURE.TDISTSPEGFSTOR B                       
000199*            WHERE B.CODSOCIE = :F885-CODSOCIE                     
000200*              AND B.CODDEPOS = :F885-CODDEPOS                     
000201*              AND B.DATADIST = :F885-DATADIST                     
000202*              AND B.TIPODIST = 'S'                                
000203*              AND B.NUMRICTR = :F885-NUMRICTR                     
000204*              AND A.AADISTSP = B.AADISTSP                         
000205*              AND A.SOCIEPAS = B.CODSOCIE                         
000206*     END-EXEC
                                                                        
000207                                                                  
000210*    EXEC SQL                                                     
      *         INCLUDE SQLCA                                           
      *    END-EXEC.                                                    
      *>>((file: SQLCA))
000001****************************************************************<*
000002* Copyright (c) 2016-2023 NTT DATA, Inc. All rights reserved.  *<*
000003* Users of NTT DATA Enterprise COBOL may freely                *<*
000004* redistribute this copybook.                                  *<*
000005****************************************************************<*
000006                                                                  
000007 01  SQLCA GLOBAL.                                                
000008     05  SQLCAID                PIC X(8).                         
000009     05  SQLCABC                PIC S9(9) COMP-5.                 
000010     05  SQLCODE                PIC S9(9) COMP-5.                 
000011     05  SQLERRM.                                                 
000012         49  SQLERRML           PIC S9(4) COMP-5.                 
000013         49  SQLERRMC           PIC X(254).                       
000014     05  SQLERRP                PIC X(8).                         
000015     05  SQLERRD OCCURS 6 TIMES PIC S9(9) COMP-5.                 
000016     05  SQLWARN.                                                 
000017         10 SQLWARN0            PIC X(1).                         
000018         10 SQLWARN1            PIC X(1).                         
000019         10 SQLWARN2            PIC X(1).                         
000020         10 SQLWARN3            PIC X(1).                         
000021         10 SQLWARN4            PIC X(1).                         
000022         10 SQLWARN5            PIC X(1).                         
000023         10 SQLWARN6            PIC X(1).                         
000024         10 SQLWARN7            PIC X(1).                         
000025     05  SQLSTATE               PIC X(5).                         
000026     05  SQLEXT                 PIC S9(5) COMP-3 VALUE 1.         
      *<<((file: SQLCA))
000211                                                                  
000212*----------------------------------------------------------------*
000213 PROCEDURE DIVISION.                                              
000214*----------------------------------------------------------------*
000213 VCOBOL-DUMMY-PROCEDURE.
000215                                                                  
000216     
      *EXEC SQL WHENEVER SQLERROR GO TO Z00-ERRORE END-EXEC
                                                                        
000217                                                                  
000218     MOVE 'AVALO52'              TO PPNAME                        
000219                                    WCOM-PROGNAME.                
000220                                                                  
000221     PERFORM A10-OPERAZIONI-INIZIALI                              
000222        THRU A10-EX.                                              
000223                                                                  
000224     MOVE 0                      TO INDX                          
000225                                                                  
000226     MOVE 'MAIN'                 TO WCOM-CODABEND                 
000227     MOVE 'OPEN'                 TO WCOM-FILEFUNZ                 
000228     MOVE 'POINTER0'             TO WCOM-FILENOME                 
000229     MOVE WS-MENSILE             TO WCOM-FILECTRL                 
000230     
      *EXEC SQL OPEN POINTER0  END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 1 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-MENSILE
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000231                                                                  
000232     PERFORM L00-FETCH-POINTER0                                   
000233        THRU L00-EX                                               
000234     PERFORM B00-ELABORA-POINTER0                                 
000235        THRU B00-EX                                               
000236             UNTIL WS-SQLCODE = 100                               
000237                                                                  
000238     MOVE 'MAIN'                 TO WCOM-CODABEND                 
000239     MOVE 'CLOSE'                TO WCOM-FILEFUNZ                 
000240     MOVE 'POINTER0'             TO WCOM-FILENOME                 
000241     MOVE WS-MENSILE             TO WCOM-FILECTRL                 
000242     
      *EXEC SQL CLOSE POINTER0  END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000243                                                                  
000244     MOVE 'P'                    TO PPROUTIN.                     
000245     PERFORM Z90-READPRIN                                         
000246        THRU Z90-EX.                                              
000247                                                                  
000248     MOVE ZERO                   TO  RETURN-CODE.                 
000249                                                                  
000250     CALL "CCF_SET_RETCODE" USING RETURN-CODE                     
000251     STOP RUN.                                                    
000252                                                                  
000253*-------------------------------------------------------*         
000254 A10-OPERAZIONI-INIZIALI.                                         
000255*-------------------------------------------------------*         
000256                                                                  
000257*--- DATA GIORNO                                                  
000258     INITIALIZE  DCWDTEL.                                         
000259     MOVE 'R'                    TO DTEL-TIPORICH.                
000260     MOVE 'AVALO52'              TO DTEL-SIGLDATA.                
000261     MOVE 'G'                    TO DTEL-DATATIPO.                
000262                                                                  
000263     MOVE 'SCADTEL'              TO PPCALL.                       
000264     CALL  PPCALL             USING DCPARM                        
000265                                    DCWDTEL.                      
000266     IF DTEL-RETCOD NOT = ZEROES                                  
000267        MOVE DTEL-RETCOD         TO WCOM-FILECTRL                 
000268        MOVE 'MODULO'            TO WCOM-FILEFUNZ                 
000269        MOVE 'SCADTEL'           TO WCOM-FILENOME                 
000270        MOVE 'A10-'              TO WCOM-CODABEND                 
000271        PERFORM Z00-ERRORE                                        
000272           THRU Z00-EX.                                           
000273                                                                  
000274     MOVE DTEL-DTINELAB          TO WS-DTGIORNO.                  
000275                                                                  
000276*--- MENSILE                                                      
000277     INITIALIZE  DCWDTEL.                                         
000278     MOVE 'R'                    TO DTEL-TIPORICH.                
000279     MOVE 'AVALO52'              TO DTEL-SIGLDATA.                
000280     MOVE 'M'                    TO DTEL-DATATIPO.                
000281                                                                  
000282     MOVE 'SCADTEL'              TO PPCALL.                       
000283     CALL  PPCALL             USING DCPARM                        
000284                                    DCWDTEL.                      
000285     IF DTEL-RETCOD NOT = ZEROES                                  
000286        MOVE DTEL-RETCOD         TO WCOM-FILECTRL                 
000287        MOVE 'MODULO'            TO WCOM-FILEFUNZ                 
000288        MOVE 'SCADTEL'           TO WCOM-FILENOME                 
000289        MOVE 'A10-'              TO WCOM-CODABEND                 
000290        PERFORM Z00-ERRORE                                        
000291           THRU Z00-EX.                                           
000292                                                                  
000293     MOVE DTEL-DTINELAB          TO WS-MENSILE.                   
000294                                                                  
000295 A10-EX. EXIT.                                                    
000296*----------------------------------------------------------------*
000297 B00-ELABORA-POINTER0.                                            
000298*----------------------------------------------------------------*
000299                                                                  
000300     MOVE L652-NRPREATT           TO WS-NRPREATT                  
000301     MOVE L652-DTPREATT           TO WS-DTPREATT                  
000302                                                                  
000303     PERFORM B01-INTABELLA                                        
000304        THRU B01-EX.                                              
000305                                                                  
000306     PERFORM B10-SCORRI-POINTER0                                  
000307        THRU B10-EX                                               
000308             UNTIL WS-SQLCODE        = 100                        
000309                OR L652-NRPREATT NOT = WS-NRPREATT                
000310                OR L652-DTPREATT NOT = WS-DTPREATT.               
000311                                                                  
000312 B00-EX. EXIT.                                                    
000313*----------------------------------------------------------------*
000314 B01-INTABELLA.                                                   
000315*----------------------------------------------------------------*
000316                                                                  
000317     INITIALIZE TABELLAX                                          
000318     MOVE 0                       TO INDX                         
000319                                                                  
000320     MOVE WS-NRPREATT             TO T358-NRPREATT                
000321     MOVE WS-DTPREATT             TO T358-DTPREATT                
000322                                                                  
000323     MOVE 'B01-'                  TO WCOM-CODABEND                
000324     MOVE 'OPEN'                  TO WCOM-FILEFUNZ                
000325     MOVE 'POINTER1'              TO WCOM-FILENOME                
000326     MOVE SPACES                  TO WCOM-FILECTRL                
000327     STRING T358-NRPREATT ' ' T358-DTPREATT ' '                   
000328     DELIMITED BY SIZE          INTO WCOM-FILECTRL                
000329     
      *EXEC SQL OPEN POINTER1  END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 2 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-NRPREATT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-DTPREATT
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000330                                                                  
000331     PERFORM L15-FETCH-POINTER1                                   
000332        THRU L15-EX                                               
000333     PERFORM B02-SCORRI-POINTER1                                  
000334        THRU B02-EX                                               
000335             UNTIL SQLCODE     = 100                              
000336                                                                  
000337     MOVE 'B01-'                  TO WCOM-CODABEND                
000338     MOVE 'CLOSE'                 TO WCOM-FILEFUNZ                
000339     MOVE 'POINTER1'              TO WCOM-FILENOME                
000340     MOVE SPACES                  TO WCOM-FILECTRL                
000341     STRING T358-NRPREATT ' ' T358-DTPREATT ' '                   
000342     DELIMITED BY SIZE          INTO WCOM-FILECTRL                
000343     
      *EXEC SQL CLOSE POINTER1  END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                             .                          
000344                                                                  
000345 B01-EX. EXIT.                                                    
000346*----------------------------------------------------------------*
000347 B02-SCORRI-POINTER1.                                             
000348*----------------------------------------------------------------*
000349                                                                  
000350     ADD 1                        TO INDX                         
000351     IF INDX > MAX-INDX                                           
000352        MOVE 'B02-'               TO WCOM-CODABEND                
000353        MOVE 'CARICA'             TO WCOM-FILEFUNZ                
000354        MOVE 'TABELLAX'           TO WCOM-FILENOME                
000355        MOVE DCLTNETMOVEREXPO     TO WCOM-FILECTRL                
000356        PERFORM Z00-ERRORE                                        
000357           THRU Z00-EX.                                           
000358                                                                  
000359     MOVE DCLTNETMOVEREXPO        TO TX-FILLER(INDX)              
000360                                                                  
000361     PERFORM L15-FETCH-POINTER1                                   
000362        THRU L15-EX.                                              
000363                                                                  
000364 B02-EX. EXIT.                                                    
000365*----------------------------------------------------------------*
000366 B10-SCORRI-POINTER0.                                             
000367*----------------------------------------------------------------*
000368                                                                  
000369     MOVE L653-AANUMORD           TO L655-AANUMORD                
000370     MOVE L653-NRRIGORD           TO L655-NRRIGORD                
000371     PERFORM L45-SELECT-DETTORDILOGI                              
000372        THRU L45-EX                                               
000373                                                                  
000374     IF L655-IMPORDIN < L653-IMPORDIN                             
000375        PERFORM B30-GESTIONE-DETTAGLIO                            
000376           THRU B30-EX.                                           
000377                                                                  
000378     PERFORM L00-FETCH-POINTER0                                   
000379        THRU L00-EX.                                              
000380                                                                  
000381 B10-EX. EXIT.                                                    
000382*----------------------------------------------------------------*
000383 B30-GESTIONE-DETTAGLIO.                                          
000384*----------------------------------------------------------------*
000385                                                                  
000386     COMPUTE WS-IMCOSATT = L653-IMPORDIN - L655-IMPORDIN          
000387                                                                  
000388     PERFORM B32-SCORRI-NETMOVEREXPO                              
000389        THRU B32-EX                                               
000390             VARYING INDX FROM 1 BY 1                             
000391               UNTIL INDX                > MAX-INDX               
000392                  OR TX-FILLER(INDX) NOT > ' '                    
000393                  OR WS-IMCOSATT         = 0.                     
000394                                                                  
000395*--- FACCIO UN SECONDO GIRO DI TENTATIVI DI AGGIORNAMENTO, ACCET- 
000396*--- TANDO UNA SQUADRATURA DI +10%                                
000397                                                                  
000398     IF WS-IMCOSATT NOT = 0                                       
000399        MOVE L653-AANUMORD        TO L655-AANUMORD                
000400        MOVE L653-NRRIGORD        TO L655-NRRIGORD                
000401        PERFORM L45-SELECT-DETTORDILOGI                           
000402           THRU L45-EX                                            
000403        COMPUTE WS-IMCOSATT =                                     
000404               (L653-IMPORDIN * 1,10) - L655-IMPORDIN             
000405        PERFORM B32-SCORRI-NETMOVEREXPO                           
000406           THRU B32-EX                                            
000407                VARYING INDX FROM 1 BY 1                          
000408                  UNTIL INDX                > MAX-INDX            
000409                     OR TX-FILLER(INDX) NOT > ' '                 
000410                     OR WS-IMCOSATT         = 0.                  
000411                                                                  
000412 B30-EX. EXIT.                                                    
000413*----------------------------------------------------------------*
000414 B32-SCORRI-NETMOVEREXPO.                                         
000415*----------------------------------------------------------------*
000416                                                                  
000417     MOVE TX-FILLER(INDX)         TO DCLTNETMOVEREXPO             
000418                                                                  
000419     MOVE T358-SOCIEFAT           TO A531-CODSOCIE                
000420     PERFORM L70-SELECT-SOCIETA                                   
000421        THRU L70-EX                                               
000422     MOVE A531-CODPIANO           TO WS-SEND-PIANO                
000423                                                                  
000424     MOVE T358-CODSOCIE           TO A531-CODSOCIE                
000425     PERFORM L70-SELECT-SOCIETA                                   
000426        THRU L70-EX                                               
000427     MOVE A531-CODPIANO           TO WS-PROP-PIANO                
000428                                                                  
000429     IF WS-SEND-PIANO NOT = WS-PROP-PIANO                         
000430        PERFORM L75-SELECT-CONTIDCE                               
000431           THRU L75-EX                                            
000432        IF C861-CONTODCE > ' '                                    
000433           MOVE C861-CONTODCE     TO T358-CONTODCE                
000434        END-IF                                                    
000435     END-IF                                                       
000436                                                                  
000437     IF L652-CODSOCIE     = T358-SOCIEFAT AND                     
000438        L652-SOCIEMER     = T358-CODSOCIE AND                     
000439        L652-CONTODCE     = T358-CONTODCE AND                     
000440        L653-CENCOSTD     = T358-CENCOSTO AND                     
000441        L653-CENCOSTA     = T358-CENCOTRA AND                     
000442        T358-AANUMORD     = ' '           AND                     
000443        T358-IMCOSATT NOT > WS-IMCOSATT                           
000444        CONTINUE                                                  
000445     ELSE                                                         
000446        GO TO B32-EX.                                             
000447                                                                  
000448     SUBTRACT T358-IMCOSATT     FROM WS-IMCOSATT                  
000449     IF WS-IMCOSATT < 0                                           
000450        MOVE 0                    TO WS-IMCOSATT                  
000451     END-IF                                                       
000452                                                                  
000453     MOVE L653-AANUMORD           TO T358-AANUMORD                
000454     MOVE L653-NRRIGORD           TO T358-NRRIGORD                
000455                                                                  
000456     PERFORM W10-UPDATE-NETMOVEREXPO                              
000457        THRU W10-EX                                               
000458     MOVE DCLTNETMOVEREXPO        TO TX-FILLER(INDX)              
000459                                                                  
000460     PERFORM B34-DETTORDILOGI                                     
000461        THRU B34-EX.                                              
000462                                                                  
000463 B32-EX. EXIT.                                                    
000464*----------------------------------------------------------------*
000465 B34-DETTORDILOGI.                                                
000466*----------------------------------------------------------------*
000467                                                                  
000468     INITIALIZE DCLTDETTORDILOGI                                  
000469                                                                  
000470     MOVE T358-PROLOMER           TO L655-PROLOMER                
000471     MOVE T358-CODLINEA           TO L655-CODLINEA                
000472     MOVE T358-MERCEMAG           TO L655-MERCEMAG                
000473                                                                  
000474     MOVE SPACES                  TO T599-TIPRICTR                
000475     IF T358-TIPORECO = 'TRAS'                                    
000476        MOVE T358-AANUMFAT        TO T599-NUMRICTR                
000477        PERFORM L05-SELECT-TRASPORTI                              
000478           THRU L05-EX.                                           
000479                                                                  
000480     MOVE SPACES                  TO SW-ERRORE                    
000481     IF T599-TIPRICTR = 'A'                                       
000482        PERFORM B36-CERCA-FATTURE-DISTINTA                        
000483           THRU B36-EX                                            
000484     END-IF                                                       
000485                                                                  
000486     IF T599-TIPRICTR NOT = 'A' OR SW-ERRORE = 'S'                
000487        MOVE T358-CODSOCIE        TO L655-CODSOCIE                
000488        MOVE T358-AANUMFAT        TO L655-AANUMFAT                
000489        MOVE T358-IMCOSATT        TO L655-IMPORDIN                
000490        MOVE T358-IMPCOSTO        TO L655-IMPTRPAG                
000491        PERFORM B38-AGG-DETTORDILOGI                              
000492           THRU B38-EX.                                           
000493                                                                  
000494 B34-EX. EXIT.                                                    
000495*----------------------------------------------------------------*
000496 B36-CERCA-FATTURE-DISTINTA.                                      
000497*----------------------------------------------------------------*
000498                                                                  
000499     MOVE T358-AANUMFAT                  TO T699-NUMRICTR         
000500     MOVE T358-CENCOSTO                  TO T699-CENCOSTO         
000501     PERFORM L10-SELECT-CENCOTRASP                                
000502        THRU L10-EX                                               
000503                                                                  
000504     INITIALIZE                             TABELLA2              
000505     MOVE ZEROS                          TO IND2                  
000506                                                                  
000507     MOVE T358-CODSOCIE                  TO F885-CODSOCIE         
000508     MOVE A838-STABILIM                  TO F885-CODDEPOS         
000509     MOVE T599-DTCREAZI                  TO F885-DATADIST         
000510     MOVE T358-AANUMFAT                  TO F885-NUMRICTR         
000511                                                                  
000512     MOVE 'B36-'                         TO WCOM-CODABEND         
000513     MOVE 'OPEN'                         TO WCOM-FILEFUNZ         
000514     MOVE 'POINTER2'                     TO WCOM-FILENOME         
000515     MOVE SPACES                         TO WCOM-FILECTRL         
000516     STRING F885-CODSOCIE ' '                                     
000517            F885-CODDEPOS ' '                                     
000518            F885-DATADIST ' '                                     
000519            F885-NUMRICTR ' '                                     
000520     DELIMITED BY SIZE                 INTO WCOM-FILECTRL         
000521     
      *EXEC SQL OPEN POINTER2  END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 3 TO SQL-STMT-ID 
           MOVE 16 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F885-CODSOCIE
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F885-CODDEPOS
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F885-DATADIST
            BY VALUE 0
                     0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F885-NUMRICTR
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F885-CODSOCIE
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F885-CODDEPOS
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F885-DATADIST
            BY VALUE 0
                     0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F885-NUMRICTR
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F885-CODSOCIE
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F885-CODDEPOS
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F885-DATADIST
            BY VALUE 0
                     0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F885-NUMRICTR
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F885-CODSOCIE
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F885-CODDEPOS
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F885-DATADIST
            BY VALUE 0
                     0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F885-NUMRICTR
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000522                                                                  
000523     PERFORM L30-FETCH-POINTER2                                   
000524        THRU L30-EX                                               
000525     PERFORM UNTIL SQLCODE = 100                                  
000526             MOVE F884-CODSOCIE          TO T308-CODSOCIE         
000527             MOVE F884-AANUMFAT          TO T308-AANUMFAT         
000528             MOVE T358-CENCOSTO          TO T308-CENCOSTO         
000529             MOVE 'FATT'                 TO T308-TIPORECO         
000530             PERFORM L35-SELECT-COSTRASPCDC                       
000531                THRU L35-EX                                       
000532             IF SQLCODE = 100                                     
000533                MOVE 'S'                 TO SW-ERRORE             
000534             ELSE                                                 
000535                ADD 1                    TO IND2                  
000536                IF IND2 > MAX-IND2                                
000537                   MOVE 'B36-'           TO WCOM-CODABEND         
000538                   MOVE 'CARICA'         TO WCOM-FILEFUNZ         
000539                   MOVE 'TABELLA2'       TO WCOM-FILENOME         
000540                   MOVE SPACES           TO WCOM-FILECTRL         
000541                   STRING F884-CODSOCIE ' ' F884-AANUMFAT         
000542                   DELIMITED BY SIZE   INTO WCOM-FILECTRL         
000543                   PERFORM Z00-ERRORE                             
000544                      THRU Z00-EX                                 
000545                END-IF                                            
000546                MOVE F884-CODSOCIE       TO T2-CODSOCIE(IND2)     
000547                MOVE F884-AANUMFAT       TO T2-AANUMFAT(IND2)     
000548                MOVE T308-KGLORRIG       TO T2-KGLORFAT(IND2)     
000549             END-IF                                               
000550             PERFORM L30-FETCH-POINTER2                           
000551                THRU L30-EX                                       
000552     END-PERFORM                                                  
000553                                                                  
000554     MOVE 'B36-'                         TO WCOM-CODABEND         
000555     MOVE 'CLOSE'                        TO WCOM-FILEFUNZ         
000556     MOVE 'POINTER2'                     TO WCOM-FILENOME         
000557     MOVE SPACES                         TO WCOM-FILECTRL         
000558     STRING F885-CODSOCIE ' '                                     
000559            F885-CODDEPOS ' '                                     
000560            F885-DATADIST ' '                                     
000561            F885-NUMRICTR ' '                                     
000562     DELIMITED BY SIZE                 INTO WCOM-FILECTRL         
000563     
      *EXEC SQL CLOSE POINTER2 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                            .                           
000564                                                                  
000565     IF SW-ERRORE = 'S'                                           
000566        GO TO B36-EX                                              
000567     END-IF                                                       
000568                                                                  
000569     MOVE ZEROS                          TO TOT-IMCOSATT          
000570     MOVE ZEROS                          TO TOT-IMPTRPAG          
000571     PERFORM VARYING IND2 FROM 1 BY 1                             
000572       UNTIL IND2                  > MAX-IND2                     
000573          OR T2-CODSOCIE(IND2) NOT > ' '                          
000574                                                                  
000575             COMPUTE L655-IMPORDIN ROUNDED =                      
000576                     T358-IMCOSATT     *                          
000577                     T2-KGLORFAT(IND2) /                          
000578                     T699-KGCOLTRA                                
000579                                                                  
000580             COMPUTE L655-IMPTRPAG ROUNDED =                      
000581                     T358-IMPCOSTO     *                          
000582                     T2-KGLORFAT(IND2) /                          
000583                     T699-KGCOLTRA                                
000584                                                                  
000585             ADD L655-IMPORDIN           TO TOT-IMCOSATT          
000586             ADD L655-IMPTRPAG           TO TOT-IMPTRPAG          
000587                                                                  
000588             IF T2-CODSOCIE(IND2 + 1) NOT > ' '                   
000589                COMPUTE L655-IMPORDIN =                           
000590                        L655-IMPORDIN +                           
000591                        T358-IMCOSATT -                           
000592                        TOT-IMCOSATT                              
000593                COMPUTE L655-IMPTRPAG =                           
000594                        L655-IMPTRPAG +                           
000595                        T358-IMPCOSTO -                           
000596                        TOT-IMPTRPAG                              
000597             END-IF                                               
000598                                                                  
000599             MOVE T2-CODSOCIE(IND2)  TO L655-CODSOCIE             
000600             MOVE T2-AANUMFAT(IND2)  TO L655-AANUMFAT             
000601             PERFORM B38-AGG-DETTORDILOGI                         
000602                THRU B38-EX                                       
000603                                                                  
000604     END-PERFORM.                                                 
000605                                                                  
000606 B36-EX. EXIT.                                                    
000607*----------------------------------------------------------------*
000608 B38-AGG-DETTORDILOGI.                                            
000609*----------------------------------------------------------------*
000610                                                                  
000611     MOVE L653-AANUMORD           TO L655-AANUMORD                
000612     MOVE L653-NRRIGORD           TO L655-NRRIGORD                
000613     MOVE L652-SOCIEMER           TO L655-CODSOCID                
000614     MOVE 'T'                     TO L655-CDDIVISD.               
000615     MOVE L653-CENCOSTD           TO L655-CENCOSTD                
000616     MOVE L652-CODSOCIE           TO L655-CODSOCIA                
000617     MOVE 'A'                     TO L655-CDDIVISA                
000618     MOVE L653-CENCOSTA           TO L655-CENCOSTA                
000619     MOVE L653-UNMISURA           TO L655-UNMISURA                
000620                                                                  
000621     MOVE WS-DTGIORNO             TO L655-DTCREAZI                
000622     MOVE WS-DTGIORNO             TO L655-DTULTVAR                
000623     MOVE 'AVLO52'                TO L655-CODUTVAR                
000624                                                                  
000625     IF T358-TIPORECO > ' '                                       
000626        MOVE 'FATT'               TO T308-TIPORECO                
000627        IF T358-TIPORECO     = 'IMPF' OR                          
000628           T358-TIPORECO     = 'PACC' OR                          
000629          (T358-TIPORECO     = 'TRAS' AND                         
000630           T599-TIPRICTR NOT = 'A')                               
000631           MOVE T358-TIPORECO     TO T308-TIPORECO                
000632        END-IF                                                    
000633        MOVE L655-CODSOCIE        TO T308-CODSOCIE                
000634        MOVE L655-AANUMFAT        TO T308-AANUMFAT                
000635        MOVE L655-CENCOSTD        TO T308-CENCOSTO                
000636        PERFORM L35-SELECT-COSTRASPCDC                            
000637           THRU L35-EX                                            
000638        MOVE T308-TIPORECO        TO L655-TIPORECO                
000639        MOVE T308-SOCIEPAS        TO L655-SOCIEMER                
000640        MOVE T308-PAESMERC        TO L655-PAESMERC                
000641        MOVE T308-TIPOARTI        TO L655-TIPOARTI                
000642        MOVE T308-KGLORRIG        TO L655-QTAORDIN                
000643        MOVE T308-DTFATTUR        TO L655-DTFATTUR                
000644        IF T308-UNMISURA = 'KG'                                   
000645           MOVE T308-QTARIGFA     TO L655-QTAKGMOV                
000646        ELSE                                                      
000647           MOVE T308-QTARIGFA     TO L655-QTAMTMOV.               
000648                                                                  
000649     IF L655-SOCIEMER NOT > ' '                                   
000650        MOVE L652-SOCIEMER        TO L655-SOCIEMER.               
000651                                                                  
000652     IF L655-PAESMERC NOT > ' '                                   
000653        MOVE L655-CENCOSTD(4:2)   TO A528-CDRAGCEN                
000654        PERFORM L40-SELECT-PAESI                                  
000655           THRU L40-EX                                            
000656        MOVE A528-CODPAESE        TO L655-PAESMERC.               
000657                                                                  
000658     IF L655-TIPOARTI NOT > ' '                                   
000659        IF L655-CENCOSTD(1:1) = '1'                               
000660           MOVE 'F'               TO L655-TIPOARTI                
000661        ELSE                                                      
000662           IF L655-CENCOSTD(1:1) = '3'                            
000663              MOVE 'C'            TO L655-TIPOARTI                
000664           ELSE                                                   
000665              MOVE 'T'            TO L655-TIPOARTI.               
000666                                                                  
000667     IF L655-QTAORDIN NOT > 0                                     
000668        COMPUTE L655-QTAORDIN ROUNDED =                           
000669                L653-QTAORDIN * L655-IMPORDIN / L653-IMPORDIN.    
000670                                                                  
000671     IF L655-DTFATTUR NOT > ' '                                   
000672        MOVE T358-DTFATTUR        TO L655-DTFATTUR.               
000673                                                                  
000674     PERFORM L20-SELECT-DETTORDILOGI                              
000675        THRU L20-EX                                               
000676     IF SQLCODE = 0                                               
000677        PERFORM W00-UPDATE-DETTORDILOGI                           
000678           THRU W00-EX                                            
000679     ELSE                                                         
000680        PERFORM L25-SELECT-DETTORDILOGI-MAX                       
000681           THRU L25-EX                                            
000682        ADD 1                     TO L655-NUMPROG7                
000683        MOVE SPACES               TO L655-INCLIFOR                
000684                                     L655-CLIEFORN                
000685                                     L655-CAUSACON                
000686        IF L655-AANUMFAT > ' ' AND                                
000687          (L655-TIPORECO = 'FATT' OR 'TRAS' OR 'PACC' )           
000688           PERFORM B40-CERCA-CLIENTE-FORN                         
000689              THRU B40-EX                                         
000690        END-IF                                                    
000691        PERFORM W05-INSERT-DETTORDILOGI                           
000692           THRU W05-EX.                                           
000693                                                                  
000694 B38-EX. EXIT.                                                    
000695*----------------------------------------------------------------*
000696 B40-CERCA-CLIENTE-FORN.                                          
000697*----------------------------------------------------------------*
000698                                                                  
000699     IF L655-TIPORECO = 'PACC'                                    
000700        MOVE L655-AANUMFAT      TO S585-AANUMRIC                  
000701        PERFORM L50-SELECT-RICHSCOR                               
000702           THRU L50-EX                                            
000703        MOVE S585-INCLIFOR      TO L655-INCLIFOR                  
000704        MOVE S585-CODFORNI      TO L655-CLIEFORN.                 
000705                                                                  
000706     IF L655-TIPORECO = 'TRAS'                                    
000707        MOVE L655-AANUMFAT      TO T599-NUMRICTR                  
000708        PERFORM L55-SELECT-TRASPORTI                              
000709           THRU L55-EX                                            
000710        IF T599-ICLIFOPR = 'C'                                    
000711           MOVE T599-ICLIFOPR                TO L655-INCLIFOR     
000712           MOVE T599-CLIFOPRO                TO L655-CLIEFORN     
000713        ELSE                                                      
000714           IF T599-ICLIFODE = 'C'                                 
000715              MOVE T599-ICLIFODE             TO L655-INCLIFOR     
000716              MOVE T599-CLIFODES             TO L655-CLIEFORN     
000717           ELSE                                                   
000718              IF T599-ICLIFOPR = 'F'                              
000719                 MOVE T599-CLIFOPRO          TO A838-CODFORNI     
000720                 PERFORM L60-SELECT-STABILIMENTI                  
000721                    THRU L60-EX                                   
000722                 IF SQLCODE = 100                                 
000723                    MOVE T599-ICLIFOPR       TO L655-INCLIFOR     
000724                    MOVE T599-CLIFOPRO       TO L655-CLIEFORN     
000725                 ELSE                                             
000726                    IF T599-ICLIFODE = 'F'                        
000727                       MOVE T599-CLIFODES    TO A838-CODFORNI     
000728                       PERFORM L60-SELECT-STABILIMENTI            
000729                          THRU L60-EX                             
000730                       IF SQLCODE = 100                           
000731                          MOVE T599-ICLIFODE TO L655-INCLIFOR     
000732                          MOVE T599-CLIFODES TO L655-CLIEFORN.    
000733                                                                  
000734     IF L655-TIPORECO     = 'TRAS' AND                            
000735        L655-INCLIFOR NOT > ' '                                   
000736        IF T599-ICLIFOPR > ' '                                    
000737           MOVE T599-ICLIFOPR             TO L655-INCLIFOR        
000738           MOVE T599-CLIFOPRO             TO L655-CLIEFORN        
000739        ELSE                                                      
000740           IF T599-ICLIFODE > ' '                                 
000741              MOVE T599-ICLIFODE          TO L655-INCLIFOR        
000742              MOVE T599-CLIFODES          TO L655-CLIEFORN.       
000743                                                                  
000744     IF L655-TIPORECO = 'FATT'                                    
000745        MOVE L655-CODSOCIE                TO F884-CODSOCIE        
000746        MOVE L655-AANUMFAT                TO F884-AANUMFAT        
000747        PERFORM L65-SELECT-FATTURESTOR                            
000748           THRU L65-EX                                            
000749        MOVE 'C'                          TO L655-INCLIFOR        
000750        MOVE F884-CODCLIEN                TO L655-CLIEFORN        
000751        IF F884-GENEFATT NOT = 'F'                                
000752           MOVE 'T'                       TO L655-CAUSACON        
000753        ELSE                                                      
000754           MOVE 'D'                       TO L655-CAUSACON        
000755           IF F884-AANRFATR > ' '                                 
000756              MOVE 'F'                    TO L655-CAUSACON.       
000757                                                                  
000758 B40-EX. EXIT.                                                    
000759*----------------------------------------------------------------*
000760 L00-FETCH-POINTER0.                                              
000761*----------------------------------------------------------------*
000762                                                                  
000763     MOVE 'L00-'                 TO WCOM-CODABEND                 
000764     MOVE 'FETCH'                TO WCOM-FILEFUNZ                 
000765     MOVE 'POINTER0'             TO WCOM-FILENOME                 
000766                                                                  
000768     
      *EXEC SQL 
      *FETCH POINTER0                                          
000769*           INTO :L653-AANUMORD, :L653-NRRIGORD, :L652-CONTODCE    
000770*               ,:L653-CENCOSTA, :L653-CENCOSTD, :L653-IMPORDIN    
000771*               ,:L653-QTAORDIN, :L652-CODSOCIE, :L652-SOCIEMER    
000772*               ,:L653-UNMISURA, :L652-NRPREATT, :L652-DTPREATT    
000773*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 4 TO SQL-STMT-ID 
           MOVE 12 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-AANUMORD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-NRRIGORD
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CONTODCE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CENCOSTA
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CENCOSTD
            BY VALUE 0
                     0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-IMPORDIN
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-QTAORDIN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODSOCIE
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-SOCIEMER
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-UNMISURA
            BY VALUE 0
                     0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-NRPREATT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTPREATT
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000774     MOVE SQLCODE                TO WS-SQLCODE.                   
000775                                                                  
000776     IF SQLCODE = 0                                               
000777        MOVE 'U'                 TO PPROUTIN                      
000778        MOVE 'D'                 TO PPTPFILE                      
000779        MOVE 'R'                 TO PPTPOPER                      
000780        MOVE 'TER0'              TO PPNMFILE                      
000781        PERFORM Z90-READPRIN                                      
000782           THRU Z90-EX.                                           
000783                                                                  
000784 L00-EX. EXIT.                                                    
000785*----------------------------------------------------------------*
000786 L05-SELECT-TRASPORTI.                                            
000787*----------------------------------------------------------------*
000788                                                                  
000789     MOVE 'L05-'                 TO WCOM-CODABEND                 
000790     MOVE 'SELECT'               TO WCOM-FILEFUNZ                 
000791     MOVE 'TRASPORTI'            TO WCOM-FILENOME                 
000792     MOVE T599-NUMRICTR          TO WCOM-FILECTRL                 
000793                                                                  
000794     MOVE SPACES                 TO T599-TIPRICTR                 
000795     MOVE SPACES                 TO T599-DTCREAZI                 
000796     MOVE SPACES                 TO A838-STABILIM                 
000798     
      *EXEC SQL 
      *SELECT T.TIPRICTR, S.STABILIM, T.DTCREAZI               
000799*            INTO :T599-TIPRICTR, :A838-STABILIM, :T599-DTCREAZI   
000800*            FROM DTRASP.TTRASPORTI      T                         
000801*                ,DANAGRAF.TSTABILIMENTI S                         
000802*           WHERE T.NUMRICTR = :T599-NUMRICTR                      
000803*             AND T.CLIFOPRO = S.CODFORNI                          
000804*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 5 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T599-NUMRICTR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-STMT-ID 
           MOVE 3 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T599-TIPRICTR
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A838-STABILIM
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T599-DTCREAZI
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 4 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000805                                                                  
000806     IF SQLCODE = 0                                               
000807        MOVE 'U'                 TO PPROUTIN                      
000808        MOVE 'D'                 TO PPTPFILE                      
000809        MOVE 'R'                 TO PPTPOPER                      
000810        MOVE 'TRASPORTI'         TO PPNMFILE                      
000811        PERFORM Z90-READPRIN                                      
000812           THRU Z90-EX.                                           
000813                                                                  
000814 L05-EX. EXIT.                                                    
000815*---------------------------------------------------------------  
000816 L10-SELECT-CENCOTRASP.                                           
000817*---------------------------------------------------------------  
000818                                                                  
000819     MOVE 'L10-'                 TO WCOM-CODABEND                 
000820     MOVE 'SELECT'               TO WCOM-FILEFUNZ                 
000821     MOVE 'CENCOTRASP'           TO WCOM-FILENOME                 
000822     MOVE SPACES                 TO WCOM-FILECTRL                 
000823     STRING T699-NUMRICTR ' ' T699-CENCOSTO                       
000824     DELIMITED BY SIZE         INTO WCOM-FILECTRL                 
000825                                                                  
000827     
      *EXEC SQL 
      *SELECT VALUE (SUM(KGCOLTRA), 0)                         
000828*            INTO :T699-KGCOLTRA                                   
000829*            FROM DTRASP.TCENCOTRASP                               
000830*           WHERE NUMRICTR = :T699-NUMRICTR                        
000831*             AND CENCOSTO = :T699-CENCOSTO                        
000832*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 7 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T699-NUMRICTR
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T699-CENCOSTO
            BY VALUE 0
                     0

           MOVE 8 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 519 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T699-KGCOLTRA
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 5 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000833                                                                  
000834     IF SQLCODE = 0                                               
000835        MOVE 'U'                 TO PPROUTIN                      
000836        MOVE 'D'                 TO PPTPFILE                      
000837        MOVE 'U'                 TO PPTPOPER                      
000838        MOVE 'CENCOTR'           TO PPNMFILE                      
000839        PERFORM Z90-READPRIN                                      
000840           THRU Z90-EX.                                           
000841                                                                  
000842 L10-EX. EXIT.                                                    
000843*----------------------------------------------------------------*
000844 L15-FETCH-POINTER1.                                              
000845*----------------------------------------------------------------*
000846                                                                  
000847     MOVE 'L15-'                 TO WCOM-CODABEND                 
000848     MOVE 'POINTER1'             TO WCOM-FILENOME                 
000849     MOVE 'FETCH'                TO WCOM-FILEFUNZ                 
000850                                                                  
000852     
      *EXEC SQL 
      *FETCH POINTER1                                          
000853*           INTO :T358-AANUMFAT, :T358-IMCOSATT, :T358-PROLOMER    
000854*               ,:T358-CODLINEA, :T358-TIPORECO, :T358-DTFATTUR    
000855*               ,:T358-CODFORNI, :T358-NUMPROG5, :T358-IMPCOSTO    
000856*               ,:T358-CODSOCIE, :T358-CONTODCE, :T358-CENCOSTO    
000857*               ,:T358-CENCOTRA, :T358-SOCIEFAT, :T358-AANUMORD    
000858*               ,:T358-MERCEMAG                                    
000859*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 9 TO SQL-STMT-ID 
           MOVE 16 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 20 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-AANUMFAT
            BY VALUE 0
                     0

           MOVE 523 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-IMCOSATT
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-PROLOMER
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-CODLINEA
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-TIPORECO
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-DTFATTUR
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-CODFORNI
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-NUMPROG5
            BY VALUE 0
                     0

           MOVE 523 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-IMPCOSTO
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-CODSOCIE
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-CONTODCE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-CENCOSTO
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-CENCOTRA
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-SOCIEFAT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-AANUMORD
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-MERCEMAG
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000860                                                                  
000861     IF SQLCODE = 0                                               
000862        MOVE 'U'                 TO PPROUTIN                      
000863        MOVE 'D'                 TO PPTPFILE                      
000864        MOVE 'R'                 TO PPTPOPER                      
000865        MOVE 'TER1'              TO PPNMFILE                      
000866        PERFORM Z90-READPRIN                                      
000867           THRU Z90-EX.                                           
000868                                                                  
000869 L15-EX. EXIT.                                                    
000870*----------------------------------------------------------------*
000871 L20-SELECT-DETTORDILOGI.                                         
000872*----------------------------------------------------------------*
000873                                                                  
000874     MOVE 'L20-'                 TO WCOM-CODABEND                 
000875     MOVE 'DETTORDILOGI'         TO WCOM-FILENOME                 
000876     MOVE 'SELECT'               TO WCOM-FILEFUNZ                 
000877     MOVE SPACES                 TO WCOM-FILECTRL                 
000878     STRING L655-AANUMORD ' '                                     
000879            L655-CODSOCIE ' '                                     
000880            L655-AANUMFAT ' '                                     
000881            L655-TIPORECO ' '                                     
000882            L655-CENCOSTD                                         
000883     DELIMITED BY SIZE         INTO WCOM-FILECTRL                 
000884                                                                  
000885     MOVE ZEROS                  TO L655-NUMPROG7                 
000886                                                                  
000888     
      *EXEC SQL 
      *SELECT NUMPROG7                                         
000889*            INTO :L655-NUMPROG7                                   
000890*            FROM DLOGISTI.TDETTORDILOGI                           
000891*           WHERE AANUMORD = :L655-AANUMORD                        
000892*             AND NRRIGORD = :L655-NRRIGORD                        
000893*             AND CODSOCIE = :L655-CODSOCIE                        
000894*             AND AANUMFAT = :L655-AANUMFAT                        
000895*             AND TIPORECO = :L655-TIPORECO                        
000896*             AND DTFATTUR = :L655-DTFATTUR                        
000897*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 10 TO SQL-STMT-ID 
           MOVE 6 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-AANUMORD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-NRRIGORD
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CODSOCIE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-AANUMFAT
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-TIPORECO
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-DTFATTUR
            BY VALUE 0
                     0

           MOVE 11 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-NUMPROG7
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 6 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000898                                                                  
000899     IF SQLCODE = 0                                               
000900        MOVE 'U'                 TO PPROUTIN                      
000901        MOVE 'D'                 TO PPTPFILE                      
000902        MOVE 'R'                 TO PPTPOPER                      
000903        MOVE 'DETLOGI'           TO PPNMFILE                      
000904        PERFORM Z90-READPRIN                                      
000905           THRU Z90-EX.                                           
000906                                                                  
000907 L20-EX. EXIT.                                                    
000908*----------------------------------------------------------------*
000909 L25-SELECT-DETTORDILOGI-MAX.                                     
000910*----------------------------------------------------------------*
000911                                                                  
000912     MOVE 'L25-'                 TO WCOM-CODABEND                 
000913     MOVE 'DETTORDILOGI'         TO WCOM-FILENOME                 
000914     MOVE 'SELECT'               TO WCOM-FILEFUNZ                 
000915     MOVE L655-AANUMORD          TO WCOM-FILECTRL                 
000916                                                                  
000917     MOVE ZEROS                  TO L655-NUMPROG7                 
000918                                                                  
000920     
      *EXEC SQL 
      *SELECT VALUE (MAX(NUMPROG7), 0)                         
000921*            INTO :L655-NUMPROG7                                   
000922*            FROM DLOGISTI.TDETTORDILOGI                           
000923*           WHERE AANUMORD = :L655-AANUMORD                        
000924*             AND NRRIGORD = :L655-NRRIGORD                        
000925*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 12 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-AANUMORD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-NRRIGORD
            BY VALUE 0
                     0

           MOVE 13 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-NUMPROG7
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 7 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000926                                                                  
000927     IF SQLCODE = 0                                               
000928        MOVE 'U'                 TO PPROUTIN                      
000929        MOVE 'D'                 TO PPTPFILE                      
000930        MOVE 'R'                 TO PPTPOPER                      
000931        MOVE 'DETLOGI'           TO PPNMFILE                      
000932        PERFORM Z90-READPRIN                                      
000933           THRU Z90-EX                                            
000934     ELSE                                                         
000935        PERFORM Z00-ERRORE                                        
000936           THRU Z00-EX.                                           
000937                                                                  
000938 L25-EX. EXIT.                                                    
000939*---------------------------------------------------------------  
000940 L30-FETCH-POINTER2.                                              
000941*---------------------------------------------------------------  
000942                                                                  
000943     MOVE 'L30-'                 TO WCOM-CODABEND.                
000944     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
000945     MOVE 'POINTER2'             TO WCOM-FILENOME.                
000946                                                                  
000948     
      *EXEC SQL 
      *FETCH POINTER2                                          
000949*           INTO :F884-CODSOCIE, :F884-AANUMFAT, :F884-KGLORFAT    
000950*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 14 TO SQL-STMT-ID 
           MOVE 3 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F884-CODSOCIE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F884-AANUMFAT
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F884-KGLORFAT
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000951     IF SQLCODE = 0                                               
000952        MOVE 'U'                  TO PPROUTIN                     
000953        MOVE 'D'                  TO PPTPFILE                     
000954        MOVE 'R'                  TO PPTPOPER                     
000955        MOVE 'TER2'               TO PPNMFILE                     
000956        PERFORM Z90-READPRIN                                      
000957           THRU Z90-EX.                                           
000958                                                                  
000959 L30-EX. EXIT.                                                    
000960*----------------------------------------------------------------*
000961 L35-SELECT-COSTRASPCDC.                                          
000962*----------------------------------------------------------------*
000963                                                                  
000964     MOVE 'L35-'                 TO WCOM-CODABEND                 
000965     MOVE 'COSTRASPCDC'          TO WCOM-FILENOME                 
000966     MOVE 'SELECT'               TO WCOM-FILEFUNZ                 
000967     MOVE SPACES                 TO WCOM-FILECTRL                 
000968     STRING T308-CODSOCIE ' '                                     
000969            T308-AANUMFAT ' '                                     
000970            T308-TIPORECO ' '                                     
000971            T308-CENCOSTO                                         
000972     DELIMITED BY SIZE         INTO WCOM-FILECTRL                 
000973                                                                  
000974     MOVE ZEROS                  TO T308-KGLORRIG                 
000975     MOVE SPACES                 TO T308-UNMISURA                 
000976     MOVE ZEROS                  TO T308-QTARIGFA                 
000977     MOVE SPACES                 TO T308-SOCIEPAS                 
000978     MOVE SPACES                 TO T308-PAESMERC                 
000979     MOVE SPACES                 TO T308-TIPOARTI                 
000980     MOVE SPACES                 TO T308-DTFATTUR                 
000981                                                                  
000983     
      *EXEC SQL 
      *SELECT UNMISURA, KGLORRIG, QTARIGFA                     
000984*                ,SOCIEPAS, PAESMERC, TIPOARTI                     
000985*                ,DTFATTUR                                         
000986*            INTO :T308-UNMISURA, :T308-KGLORRIG, :T308-QTARIGFA   
000987*                ,:T308-SOCIEPAS, :T308-PAESMERC, :T308-TIPOARTI   
000988*                ,:T308-DTFATTUR                                   
000989*            FROM DTRASP.TCOSTRASPCDC                              
000990*           WHERE CODSOCIE = :T308-CODSOCIE                        
000991*             AND AANUMFAT = :T308-AANUMFAT                        
000992*             AND TIPORECO = :T308-TIPORECO                        
000993*             AND CENCOSTO = :T308-CENCOSTO                        
000994*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 15 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-CODSOCIE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-AANUMFAT
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-TIPORECO
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-CENCOSTO
            BY VALUE 0
                     0

           MOVE 16 TO SQL-STMT-ID 
           MOVE 7 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-UNMISURA
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-KGLORRIG
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-QTARIGFA
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-SOCIEPAS
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-PAESMERC
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-TIPOARTI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T308-DTFATTUR
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 8 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000995                                                                  
000996     IF SQLCODE = 0                                               
000997        MOVE 'U'                 TO PPROUTIN                      
000998        MOVE 'D'                 TO PPTPFILE                      
000999        MOVE 'R'                 TO PPTPOPER                      
001000        MOVE 'COSTRAS'           TO PPNMFILE                      
001001        PERFORM Z90-READPRIN                                      
001002           THRU Z90-EX.                                           
001003                                                                  
001004 L35-EX. EXIT.                                                    
001005*----------------------------------------------------------------*
001006 L40-SELECT-PAESI.                                                
001007*----------------------------------------------------------------*
001008                                                                  
001009     MOVE 'L40-'                 TO WCOM-CODABEND.                
001010     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001011     MOVE 'PAESI'                TO WCOM-FILENOME.                
001012     MOVE A528-CDRAGCEN          TO WCOM-FILECTRL                 
001013                                                                  
001014     MOVE SPACES                 TO A528-CODPAESE                 
001016     
      *EXEC SQL 
      *SELECT CODPAESE                                         
001017*            INTO :A528-CODPAESE                                   
001018*            FROM DANAGRAF.TPAESI                                  
001019*           WHERE CDRAGCEN = :A528-CDRAGCEN                        
001020*           FETCH FIRST 1 ROWS ONLY                                
001021*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 17 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A528-CDRAGCEN
            BY VALUE 0
                     0

           MOVE 18 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A528-CODPAESE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 9 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001022                                                                  
001023     IF SQLCODE = ZEROES                                          
001024        MOVE 'U'                 TO PPROUTIN                      
001025        MOVE 'D'                 TO PPTPFILE                      
001026        MOVE 'R'                 TO PPTPOPER                      
001027        MOVE 'PAESI'             TO PPNMFILE                      
001028        PERFORM Z90-READPRIN                                      
001029           THRU Z90-EX.                                           
001030                                                                  
001031 L40-EX. EXIT.                                                    
001032*----------------------------------------------------------------*
001033 L45-SELECT-DETTORDILOGI.                                         
001034*----------------------------------------------------------------*
001035                                                                  
001036     MOVE 'L45-'                 TO WCOM-CODABEND.                
001037     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001038     MOVE 'DETTORDILOGI'         TO WCOM-FILENOME.                
001039     MOVE L655-AANUMORD          TO WCOM-FILECTRL                 
001040                                                                  
001042     
      *EXEC SQL 
      *SELECT VALUE (SUM(IMPORDIN), 0)                         
001043*            INTO :L655-IMPORDIN                                   
001044*            FROM DLOGISTI.TDETTORDILOGI                           
001045*           WHERE AANUMORD = :L655-AANUMORD                        
001046*             AND NRRIGORD = :L655-NRRIGORD                        
001047*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 19 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-AANUMORD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-NRRIGORD
            BY VALUE 0
                     0

           MOVE 20 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-IMPORDIN
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 10 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001048                                                                  
001049     IF SQLCODE = ZEROES                                          
001050        MOVE 'U'                 TO PPROUTIN                      
001051        MOVE 'D'                 TO PPTPFILE                      
001052        MOVE 'R'                 TO PPTPOPER                      
001053        MOVE 'DETLOGI'           TO PPNMFILE                      
001054        PERFORM Z90-READPRIN                                      
001055           THRU Z90-EX.                                           
001056                                                                  
001057 L45-EX. EXIT.                                                    
001058*----------------------------------------------------------------*
001059 L50-SELECT-RICHSCOR.                                             
001060*----------------------------------------------------------------*
001061                                                                  
001062     MOVE 'L50-'                 TO WCOM-CODABEND.                
001063     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001064     MOVE 'RICHSCOR'             TO WCOM-FILENOME.                
001065     MOVE S585-AANUMRIC          TO WCOM-FILECTRL                 
001066                                                                  
001067     MOVE SPACES                 TO S585-INCLIFOR                 
001068                                    S585-CODFORNI                 
001070     
      *EXEC SQL 
      *SELECT INCLIFOR, CODFORNI                               
001071*            INTO :S585-INCLIFOR, :S585-CODFORNI                   
001072*            FROM DSCORTE.TRICHSCOR                                
001073*           WHERE AANUMRIC = :S585-AANUMRIC                        
001074*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 21 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S585-AANUMRIC
            BY VALUE 0
                     0

           MOVE 22 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S585-INCLIFOR
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S585-CODFORNI
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 11 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001075                                                                  
001076     IF SQLCODE = ZEROES                                          
001077        MOVE 'U'                 TO PPROUTIN                      
001078        MOVE 'D'                 TO PPTPFILE                      
001079        MOVE 'R'                 TO PPTPOPER                      
001080        MOVE 'RICHSCOR'          TO PPNMFILE                      
001081        PERFORM Z90-READPRIN                                      
001082           THRU Z90-EX.                                           
001083                                                                  
001084 L50-EX. EXIT.                                                    
001085*----------------------------------------------------------------*
001086 L55-SELECT-TRASPORTI.                                            
001087*----------------------------------------------------------------*
001088                                                                  
001089     MOVE 'L55-'                 TO WCOM-CODABEND.                
001090     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001091     MOVE 'TRASPORTI'            TO WCOM-FILENOME.                
001092     MOVE S585-AANUMRIC          TO WCOM-FILECTRL                 
001093                                                                  
001094     MOVE SPACES                 TO T599-ICLIFOPR                 
001095                                    T599-CLIFOPRO                 
001096                                    T599-ICLIFODE                 
001097                                    T599-CLIFODES                 
001099     
      *EXEC SQL 
      *SELECT ICLIFOPR, CLIFOPRO                               
001100*                ,ICLIFODE, CLIFODES                               
001101*            INTO :T599-ICLIFOPR, :T599-CLIFOPRO                   
001102*                ,:T599-ICLIFODE, :T599-CLIFODES                   
001103*            FROM DTRASP.TTRASPORTI                                
001104*           WHERE NUMRICTR = :T599-NUMRICTR                        
001105*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 23 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T599-NUMRICTR
            BY VALUE 0
                     0

           MOVE 24 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T599-ICLIFOPR
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T599-CLIFOPRO
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T599-ICLIFODE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T599-CLIFODES
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 12 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001106                                                                  
001107     IF SQLCODE = ZEROES                                          
001108        MOVE 'U'                 TO PPROUTIN                      
001109        MOVE 'D'                 TO PPTPFILE                      
001110        MOVE 'R'                 TO PPTPOPER                      
001111        MOVE 'TRASPORT'          TO PPNMFILE                      
001112        PERFORM Z90-READPRIN                                      
001113           THRU Z90-EX.                                           
001114                                                                  
001115 L55-EX. EXIT.                                                    
001116*----------------------------------------------------------------*
001117 L60-SELECT-STABILIMENTI.                                         
001118*----------------------------------------------------------------*
001119                                                                  
001120     MOVE 'L60-'                 TO WCOM-CODABEND.                
001121     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001122     MOVE 'STABILIMENTI'         TO WCOM-FILENOME.                
001123     MOVE A838-CODFORNI          TO WCOM-FILECTRL                 
001124                                                                  
001126     
      *EXEC SQL 
      *SELECT CODFORNI                                         
001127*            INTO :A838-CODFORNI                                   
001128*            FROM DANAGRAF.TSTABILIMENTI                           
001129*           WHERE CODFORNI = :A838-CODFORNI                        
001130*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 25 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A838-CODFORNI
            BY VALUE 0
                     0

           MOVE 26 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A838-CODFORNI
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 13 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001131                                                                  
001132     IF SQLCODE = ZEROES                                          
001133        MOVE 'U'                 TO PPROUTIN                      
001134        MOVE 'D'                 TO PPTPFILE                      
001135        MOVE 'R'                 TO PPTPOPER                      
001136        MOVE 'STABILIM'          TO PPNMFILE                      
001137        PERFORM Z90-READPRIN                                      
001138           THRU Z90-EX.                                           
001139                                                                  
001140 L60-EX. EXIT.                                                    
001141*----------------------------------------------------------------*
001142 L65-SELECT-FATTURESTOR.                                          
001143*----------------------------------------------------------------*
001144                                                                  
001145     MOVE 'L65-'                 TO WCOM-CODABEND.                
001146     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001147     MOVE 'FATTURESTOR'          TO WCOM-FILENOME.                
001148     MOVE SPACES                 TO WCOM-FILECTRL                 
001149     STRING F884-CODSOCIE ' ' F884-AANUMFAT                       
001150     DELIMITED BY SIZE         INTO WCOM-FILECTRL                 
001151                                                                  
001152     MOVE SPACES                 TO F884-CODCLIEN                 
001153     MOVE SPACES                 TO F884-GENEFATT                 
001154     MOVE SPACES                 TO F884-AANRFATR                 
001156     
      *EXEC SQL 
      *SELECT X.CODCLIEN                                       
001157*                ,X.GENEFATT                                       
001158*                ,X.AANRFATR                                       
001159*            INTO :F884-CODCLIEN                                   
001160*                ,:F884-GENEFATT                                   
001161*                ,:F884-AANRFATR                                   
001162*            FROM                                                  
001163*         (SELECT CASE WHEN CLIEMERC > ' '                         
001164*                      THEN CLIEMERC                               
001165*                      ELSE CODCLIEN END CODCLIEN                  
001166*                ,GENEFATT                                         
001167*                ,AANRFATR                                         
001168*            FROM DFATTURE.TFATTURESTOR                            
001169*           WHERE CODSOCIE = :F884-CODSOCIE                        
001170*             AND AANUMFAT = :F884-AANUMFAT                        
001171*           UNION ALL                                              
001172*          SELECT CASE WHEN CLIEMERC > ' '                         
001173*                      THEN CLIEMERC                               
001174*                      ELSE CODCLIEN END CODCLIEN                  
001175*                ,GENEFATT                                         
001176*                ,AANRFATR                                         
001177*            FROM DFATTURE.TFATTUREGFSTOR                          
001178*           WHERE CODSOCIE = :F884-CODSOCIE                        
001179*             AND AANUMFAT = :F884-AANUMFAT) AS X                  
001180*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 27 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F884-CODSOCIE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F884-AANUMFAT
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F884-CODSOCIE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F884-AANUMFAT
            BY VALUE 0
                     0

           MOVE 28 TO SQL-STMT-ID 
           MOVE 3 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F884-CODCLIEN
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F884-GENEFATT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE F884-AANRFATR
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 14 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001181                                                                  
001182     IF SQLCODE = ZEROES                                          
001183        MOVE 'U'                 TO PPROUTIN                      
001184        MOVE 'D'                 TO PPTPFILE                      
001185        MOVE 'R'                 TO PPTPOPER                      
001186        MOVE 'FATTSTO'           TO PPNMFILE                      
001187        PERFORM Z90-READPRIN                                      
001188           THRU Z90-EX.                                           
001189                                                                  
001190 L65-EX. EXIT.                                                    
001191*----------------------------------------------------------------*
001192 L70-SELECT-SOCIETA.                                              
001193*----------------------------------------------------------------*
001194                                                                  
001195     MOVE 'L70-'                 TO WCOM-CODABEND                 
001196     MOVE 'SOCIETA'              TO WCOM-FILENOME                 
001197     MOVE 'SELECT'               TO WCOM-FILEFUNZ                 
001198     MOVE A531-CODSOCIE          TO WCOM-FILECTRL                 
001199                                                                  
001201     
      *EXEC SQL 
      *SELECT CODPIANO                                         
001202*            INTO :A531-CODPIANO                                   
001203*            FROM DANAGRAF.TSOCIETA                                
001204*           WHERE CODSOCIE = :A531-CODSOCIE                        
001205*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 29 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 30 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODPIANO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 15 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001206                                                                  
001207     IF SQLCODE = 0                                               
001208        MOVE 'U'                 TO PPROUTIN                      
001209        MOVE 'D'                 TO PPTPFILE                      
001210        MOVE 'R'                 TO PPTPOPER                      
001211        MOVE 'SOCIETA'           TO PPNMFILE                      
001212        PERFORM Z90-READPRIN                                      
001213           THRU Z90-EX                                            
001214     ELSE                                                         
001215        PERFORM Z00-ERRORE                                        
001216           THRU Z00-EX.                                           
001217                                                                  
001218 L70-EX. EXIT.                                                    
001219*----------------------------------------------------------------*
001220 L75-SELECT-CONTIDCE.                                             
001221*----------------------------------------------------------------*
001222                                                                  
001223     MOVE 'L40-'                 TO WCOM-CODABEND                 
001224     MOVE 'SELECT'               TO WCOM-FILEFUNZ                 
001225     MOVE 'CONTIDCE'             TO WCOM-FILENOME                 
001226     MOVE SPACES                 TO WCOM-FILECTRL                 
001227     STRING WS-SEND-PIANO ' ' T358-CONTODCE                       
001228     DELIMITED BY SIZE         INTO WCOM-FILECTRL                 
001229                                                                  
001230     MOVE SPACES                 TO C861-CONTODCE                 
001232     
      *EXEC SQL 
      *SELECT B.CONTODCE                                       
001233*            INTO :C861-CONTODCE                                   
001234*            FROM DCONTCLI.TCONTIDCE A                             
001235*                ,DCONTCLI.TCONTIDCE B                             
001236*           WHERE A.CODPIANO = :WS-SEND-PIANO                      
001237*             AND A.CONTODCE = :T358-CONTODCE                      
001238*             AND A.CONTGRUP = B.CONTGRUP                          
001239*             AND B.CODPIANO = :WS-PROP-PIANO                      
001240*             AND LEFT(A.CONTPROV, 4) = 'TRAS'                     
001241*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 31 TO SQL-STMT-ID 
           MOVE 3 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-SEND-PIANO
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-CONTODCE
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-PROP-PIANO
            BY VALUE 0
                     0

           MOVE 32 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTODCE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 16 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001242                                                                  
001243     IF SQLCODE = 0                                               
001244        MOVE 'U'                 TO PPROUTIN                      
001245        MOVE 'D'                 TO PPTPFILE                      
001246        MOVE 'R'                 TO PPTPOPER                      
001247        MOVE 'CONTODCE'          TO PPNMFILE                      
001248        PERFORM Z90-READPRIN                                      
001249           THRU Z90-EX.                                           
001250                                                                  
001251 L75-EX. EXIT.                                                    
001252*----------------------------------------------------------------*
001253 W00-UPDATE-DETTORDILOGI.                                         
001254*----------------------------------------------------------------*
001255                                                                  
001256     MOVE 'W00-'                 TO WCOM-CODABEND                 
001257     MOVE 'UPDATE'               TO WCOM-FILEFUNZ                 
001258     MOVE 'DETTORDILOGI'         TO WCOM-FILENOME                 
001259     MOVE SPACES                 TO WCOM-FILECTRL                 
001260     STRING L655-AANUMORD ' '                                     
001261            L655-CODSOCIE ' '                                     
001262            L655-AANUMFAT ' '                                     
001263            L655-CENCOSTA ' '                                     
001264            L655-CENCOSTD ' '                                     
001265     DELIMITED BY SIZE         INTO WCOM-FILECTRL                 
001266                                                                  
001268     
      *EXEC SQL 
      *UPDATE DLOGISTI.TDETTORDILOGI                           
001269*             SET IMPORDIN = IMPORDIN + :L655-IMPORDIN             
001270*           WHERE AANUMORD = :L655-AANUMORD                        
001271*             AND NRRIGORD = :L655-NRRIGORD                        
001272*             AND NUMPROG7 = :L655-NUMPROG7                        
001273*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 33 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-IMPORDIN
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-AANUMORD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-NRRIGORD
            BY VALUE 0
                     0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-NUMPROG7
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 17 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001274     IF SQLCODE = 0                                               
001275        MOVE 'U'                 TO PPROUTIN                      
001276        MOVE 'D'                 TO PPTPFILE                      
001277        MOVE 'U'                 TO PPTPOPER                      
001278        MOVE 'DETLOGI'           TO PPNMFILE                      
001279        PERFORM Z90-READPRIN                                      
001280           THRU Z90-EX.                                           
001281                                                                  
001282 W00-EX. EXIT.                                                    
001283*----------------------------------------------------------------*
001284 W05-INSERT-DETTORDILOGI.                                         
001285*----------------------------------------------------------------*
001286                                                                  
001287     MOVE 'W05-'                 TO WCOM-CODABEND                 
001288     MOVE 'INSERT'               TO WCOM-FILEFUNZ                 
001289     MOVE 'DETTORDILOGI'         TO WCOM-FILENOME                 
001290     MOVE SPACES                 TO WCOM-FILECTRL                 
001291     STRING L655-AANUMORD ' '                                     
001292            L655-CODSOCIE ' '                                     
001293            L655-AANUMFAT ' '                                     
001294            L655-CENCOSTA ' '                                     
001295            L655-CENCOSTD ' '                                     
001296     DELIMITED BY SIZE         INTO WCOM-FILECTRL                 
001297                                                                  
001299     
      *EXEC SQL 
      *INSERT INTO DLOGISTI.TDETTORDILOGI                      
001300*                (AANUMORD                                         
001301*                ,NRRIGORD                                         
001302*                ,NUMPROG7                                         
001303*                ,CDMCAGTM                                         
001304*                ,CDAREGTM                                         
001305*                ,CDDIPGTM                                         
001306*                ,TIPOADDE                                         
001307*                ,KEYADDE1                                         
001308*                ,KEYADDE2                                         
001309*                ,KEYADDE3                                         
001310*                ,KEYADDE4                                         
001311*                ,CODSOCID                                         
001312*                ,CDDIVISD                                         
001313*                ,CENCOSTD                                         
001314*                ,CODSOCIA                                         
001315*                ,CDDIVISA                                         
001316*                ,CENCOSTA                                         
001317*                ,UNMISURA                                         
001318*                ,PROLOMER                                         
001319*                ,CODLINEA                                         
001320*                ,TIPOARTI                                         
001321*                ,QTAORDIN                                         
001322*                ,QTAMTMOV                                         
001323*                ,QTAKGMOV                                         
001324*                ,DTCREAZI                                         
001325*                ,DTULTVAR                                         
001326*                ,CODUTVAR                                         
001327*                ,CODSOCIE                                         
001328*                ,AANUMFAT                                         
001329*                ,IMPORDIN                                         
001330*                ,SOCIEMER                                         
001331*                ,PAESMERC                                         
001332*                ,TIPORECO                                         
001333*                ,IMPTRPAG                                         
001334*                ,MERCEMAG                                         
001335*                ,DTFATTUR                                         
001336*                ,INCLIFOR                                         
001337*                ,CLIEFORN                                         
001338*                ,CAUSACON)                                        
001339*          VALUES                                                  
001340*                (:L655-AANUMORD                                   
001341*                ,:L655-NRRIGORD                                   
001342*                ,:L655-NUMPROG7                                   
001343*                ,:L655-CDMCAGTM                                   
001344*                ,:L655-CDAREGTM                                   
001345*                ,:L655-CDDIPGTM                                   
001346*                ,:L655-TIPOADDE                                   
001347*                ,:L655-KEYADDE1                                   
001348*                ,:L655-KEYADDE2                                   
001349*                ,:L655-KEYADDE3                                   
001350*                ,:L655-KEYADDE4                                   
001351*                ,:L655-CODSOCID                                   
001352*                ,:L655-CDDIVISD                                   
001353*                ,:L655-CENCOSTD                                   
001354*                ,:L655-CODSOCIA                                   
001355*                ,:L655-CDDIVISA                                   
001356*                ,:L655-CENCOSTA                                   
001357*                ,:L655-UNMISURA                                   
001358*                ,:L655-PROLOMER                                   
001359*                ,:L655-CODLINEA                                   
001360*                ,:L655-TIPOARTI                                   
001361*                ,:L655-QTAORDIN                                   
001362*                ,:L655-QTAMTMOV                                   
001363*                ,:L655-QTAKGMOV                                   
001364*                ,:L655-DTCREAZI                                   
001365*                ,:L655-DTULTVAR                                   
001366*                ,:L655-CODUTVAR                                   
001367*                ,:L655-CODSOCIE                                   
001368*                ,:L655-AANUMFAT                                   
001369*                ,:L655-IMPORDIN                                   
001370*                ,:L655-SOCIEMER                                   
001371*                ,:L655-PAESMERC                                   
001372*                ,:L655-TIPORECO                                   
001373*                ,:L655-IMPTRPAG                                   
001374*                ,:L655-MERCEMAG                                   
001375*                ,:L655-DTFATTUR                                   
001376*                ,:L655-INCLIFOR                                   
001377*                ,:L655-CLIEFORN                                   
001378*                ,:L655-CAUSACON)                                  
001379*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 34 TO SQL-STMT-ID 
           MOVE 39 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-AANUMORD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-NRRIGORD
            BY VALUE 0
                     0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-NUMPROG7
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CDMCAGTM
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CDAREGTM
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CDDIPGTM
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-TIPOADDE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-KEYADDE1
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-KEYADDE2
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-KEYADDE3
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-KEYADDE4
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CODSOCID
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CDDIVISD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CENCOSTD
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CODSOCIA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CDDIVISA
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CENCOSTA
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 17 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-UNMISURA
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 18 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-PROLOMER
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 19 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CODLINEA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 20 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-TIPOARTI
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 21 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-QTAORDIN
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 22 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-QTAMTMOV
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 23 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-QTAKGMOV
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 24 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-DTCREAZI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 25 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 26 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CODUTVAR
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 27 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CODSOCIE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 28 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-AANUMFAT
            BY VALUE 0
                     0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 29 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-IMPORDIN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 30 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-SOCIEMER
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 31 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-PAESMERC
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 32 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-TIPORECO
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 33 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-IMPTRPAG
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 34 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-MERCEMAG
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 35 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-DTFATTUR
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 36 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-INCLIFOR
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 37 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CLIEFORN
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 38 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CAUSACON
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 18 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001380     MOVE 'U'                    TO PPROUTIN                      
001381     MOVE 'D'                    TO PPTPFILE                      
001382     MOVE 'A'                    TO PPTPOPER                      
001383     MOVE 'DETLOGI'              TO PPNMFILE                      
001384     PERFORM Z90-READPRIN                                         
001385        THRU Z90-EX.                                              
001386                                                                  
001387 W05-EX. EXIT.                                                    
001388*----------------------------------------------------------------*
001389 W10-UPDATE-NETMOVEREXPO.                                         
001390*----------------------------------------------------------------*
001391                                                                  
001392     MOVE 'W10-'                 TO WCOM-CODABEND                 
001393     MOVE 'UPDATE'               TO WCOM-FILEFUNZ                 
001394     MOVE 'NETMOVEREXPO'         TO WCOM-FILENOME                 
001395     MOVE SPACES                 TO WCOM-FILECTRL                 
001396     STRING T358-CODSOCIE ' '                                     
001397            T358-AANUMFAT ' '                                     
001398            T358-DTFATTUR ' '                                     
001399            T358-TIPORECO ' '                                     
001400            T358-CODFORNI ' '                                     
001401     DELIMITED BY SIZE         INTO WCOM-FILECTRL                 
001402                                                                  
001404     
      *EXEC SQL 
      *UPDATE DTRASP.TNETMOVEREXPO                             
001405*             SET AANUMORD = :T358-AANUMORD                        
001406*                ,NRRIGORD = :T358-NRRIGORD                        
001407*           WHERE CODSOCIE = :T358-CODSOCIE                        
001408*             AND AANUMFAT = :T358-AANUMFAT                        
001409*             AND DTFATTUR = :T358-DTFATTUR                        
001410*             AND TIPORECO = :T358-TIPORECO                        
001411*             AND CODFORNI = :T358-CODFORNI                        
001412*             AND NUMPROG5 = :T358-NUMPROG5                        
001413*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 35 TO SQL-STMT-ID 
           MOVE 8 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-AANUMORD
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-NRRIGORD
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-CODSOCIE
            BY VALUE 0
                     0

           MOVE 20 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-AANUMFAT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-DTFATTUR
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-TIPORECO
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-CODFORNI
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-NUMPROG5
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 19 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001414     IF SQLCODE = 0                                               
001415        MOVE 'U'                 TO PPROUTIN                      
001416        MOVE 'D'                 TO PPTPFILE                      
001417        MOVE 'U'                 TO PPTPOPER                      
001418        MOVE 'DETLOGI'           TO PPNMFILE                      
001419        PERFORM Z90-READPRIN                                      
001420           THRU Z90-EX                                            
001421     ELSE                                                         
001422        PERFORM Z00-ERRORE                                        
001423           THRU Z00-EX.                                           
001424                                                                  
001425 W10-EX. EXIT.                                                    
001426*----------------------------------------------------------------*
001427 Z00-ERRORE.                                                      
001428*----------------------------------------------------------------*
001429                                                                  
001430     MOVE 'M'                    TO PPROUTIN.                     
001431     PERFORM Z90-READPRIN                                         
001432        THRU Z90-EX.                                              
001433                                                                  
001434     MOVE 'SCDB2ER '             TO PPCALL.                       
001435     CALL PPCALL                 USING DCPARM                     
001436                                       DCDB2ER                    
001437                                       SQLCA.                     
001438 Z00-EX. EXIT.                                                    
001439*----------------------------------------------------------------*
001440 Z90-READPRIN.                                                    
001441*----------------------------------------------------------------*
001442                                                                  
001443     MOVE 'READPRIN '            TO PPCALL                        
001444     CALL PPCALL                 USING DCPARM.                    
001445                                                                  
001446 Z90-EX. EXIT.                                                   
