      *((program: AVTLO22.cblx))
000001*-------------* PROGRAMMA  CICS/DB2 COBOL2 *--------------------* 
000002 ID  DIVISION.                                                    
000003*-------------*                                                   
000004 PROGRAM-ID. AVTLO22.                             
000005*---------------------------------------------------------------* 
000006*                ELENCO ORDINI LOGISTICA                        * 
000007*---------------------------------------------------------------* 
000008*  IL PROGRAMMA GESTISCE L'ELENCO DEGLI ORDINI PER SERVIZI      * 
000009*  DI LOGISTICA.                                                * 
000010*  OPERAZIONI POSSIBILI:                                        * 
000011*                                                               * 
000012*  - V -   PER VISUALIZZARE IL DETTAGLIO DELL' ORDINE           * 
000013*  - / -   PER EFFETTUARE L'ANNULLAMENTO DELL'ORDINE            * 
000014*  - F -   PER IMPOSTARE DATA DI EVASIONE                       * 
000015*  - X -   PER TOGLIERE DATA DI EVASIONE                        * 
000016*---------------------------------------------------------------* 
000017 ENVIRONMENT DIVISION.                                            
000018*---------------------*                                           
000019 CONFIGURATION SECTION.                                           
000020 SPECIAL-NAMES.                                                   
000021     DECIMAL-POINT IS COMMA.                                      
000022 DATA DIVISION.                                                   
000023*--------------*                                                  
000024 WORKING-STORAGE SECTION.

       01  SQLDA-ID pic 9(4) comp-5.
       01  SQLDSIZE pic 9(4) comp-5.
       01  SQL-STMT-ID pic 9(4) comp-5.
       01  SQLVAR-INDEX pic 9(4) comp-5.
       01  SQL-DATA-TYPE pic 9(4) comp-5.
       01  SQL-HOST-VAR-LENGTH pic 9(9) comp-5.
       01  SQL-S-HOST-VAR-LENGTH pic 9(9) comp-5.
       01  SQL-S-LITERAL pic X(258).
       01  SQL-LITERAL1 pic X(130).
       01  SQL-LITERAL2 pic X(130).
       01  SQL-LITERAL3 pic X(130).
       01  SQL-LITERAL4 pic X(130).
       01  SQL-LITERAL5 pic X(130).
       01  SQL-LITERAL6 pic X(130).
       01  SQL-LITERAL7 pic X(130).
       01  SQL-LITERAL8 pic X(130).
       01  SQL-LITERAL9 pic X(130).
       01  SQL-LITERAL10 pic X(130).
       01  SQL-IS-LITERAL pic 9(4) comp-5 value 1.
       01  SQL-IS-INPUT-HVAR pic 9(4) comp-5 value 2.
       01  SQL-CALL-TYPE pic 9(4) comp-5.
       01  SQL-SECTIONUMBER pic 9(4) comp-5.
       01  SQL-INPUT-SQLDA-ID pic 9(4) comp-5.
       01  SQL-OUTPUT-SQLDA-ID pic 9(4) comp-5.
       01  SQLA-PROGRAM-ID.
           05 SQL-PART1 pic 9(4) COMP-5 value 172.
           05 SQL-PART2 pic X(6) value "AEAQAI".
           05 SQL-PART3 pic X(24) value "YBpeMOFo01111 2         ".
           05 SQL-PART4 pic 9(4) COMP-5 value 8.
           05 SQL-PART5 pic X(8) value "DB2XMT  ".
           05 SQL-PART6 pic X(120) value LOW-VALUES.
           05 SQL-PART7 pic 9(4) COMP-5 value 8.
           05 SQL-PART8 pic X(8) value "AVTLO22 ".
           05 SQL-PART9 pic X(120) value LOW-VALUES.
                                                                        
000025 01  DFH-START PIC X(04).                                         
000026 01  FILLER                      PIC X(08) VALUE 'DCWCOMMA'.      
000027*    COPY DCWCOMMA.                                               
000028*---------------------------------------------------------------* 
000029*----*            AREA DI PASSAGGIO DATI - WWTERRE         *----* 
000030*---------------------------------------------------------------* 
000031 01  WCOM-LUNGHERR                PIC S9(4) COMP VALUE +200.      
000032 01  WCOM-AREA-ERROR.                                             
000033     02 FILLER                    PIC X(8) VALUE 'CICSERRO'.      
000034     02 WCOM-FILEMESG.                                            
000035        04 WCOM-FILEFUNZ          PIC X(10).                      
000036        04 WCOM-FILESTAT          PIC X(5).                       
000037        04 WCOM-SQLCODEX REDEFINES WCOM-FILESTAT                  
000038                                  PIC -Z(4).                      
000039        04 WCOM-FILENOME          PIC X(30).                      
000040        04 WCOM-FILECTR1.                                         
000041           05 WCOM-FILECTRL       PIC X(35).                      
000042     02 WCOM-MESSAGE1 REDEFINES WCOM-FILEMESG.                    
000043        05 WCOM-MESSAGES          PIC X(80).                      
000044     02 WCOM-CODABEND             PIC X(4).                       
000045     02 WCOM-ABENCICS             PIC X(4).                       
000046     02 WCOM-PRGMLINE             PIC X(5)  VALUE SPACES.         
000047     02 WCOM-CODEIBFN             PIC X(2).                       
000048     02 WCOM-CODERCOD             PIC X(6).                       
000049     02 FILLER                    PIC X(91).                      
000050*---------------------------------------------------------------* 
000051*----*                AREA DI COMMAREA                     *----* 
000052*---------------------------------------------------------------* 
000053*---------------------- LUNGHEZZA WCOM-AREAXXXX                   
000054 01  WCOM-LUNGHEZZ                     PIC S9(4) COMP VALUE +300. 
000055*---------------------- NOME DEL PROGRAMMA                        
000056 01  WCOM-AREAXXXX.                                               
000057     05  WCOM-NOMEPRGM                 PIC X(8)  VALUE SPACES.    
000058*---------------------- PAGINA RICHIESTA                          
000059     05  WCOM-PAGIRICH                 PIC S9(5) COMP-3.          
000060*---------------------- PAGINA LISTATA                            
000061     05  WCOM-PAGILIST                 PIC S9(5) COMP-3.          
000062*---------------------- PAGINA ULTIMA                             
000063     05  WCOM-PAGIULTI                 PIC S9(5) COMP-3.          
000064*---------------------- FLAG PER MODULO GESTIONE FUNZIONI ESTERNE 
000065     05  WCOM-FLAGFUNZ.                                           
000066         10  WCOM-RETURNXX             PIC X(1).                  
000067         10  WCOM-DELETETS             PIC X(1).                  
000068         10  WCOM-CODILING             PIC X(1).                  
000069*---------------------- FLAG PER AGGIORNAMENTI                    
000070     05  WCOM-FLAGPRGM                 PIC X(1)  VALUE SPACES.    
000071*---------------------- SOTTOSISTEMA CICS                         
000072     05  WCOM-SYSID                    PIC X(4)  VALUE '????'.    
000073*---------------------- PRINTER ABBINATA CON 'P'                  
000074     05  WCOM-PRINTERX                 PIC X(4).                  
000075*---------------------- PRINTER ASSOCIATA MAG. FINITI             
000076     05  WCOM-PRINTERY                 PIC X(4).                  
000077*---------------------- PRINTER ASSOCIATA ALLA TRANSAZIONE        
000078     05  WCOM-PRINTERT                 PIC X(4).                  
000079*---------------------- PRINTER BAR-CODE O MODULI SPECIALI        
000080     05  WCOM-PRINTERB                 PIC X(4).                  
000081*---------------------- TRANSAZIONE                               
000082     05  WCOM-TRANSAZI                 PIC X(4).                  
000083*---------------------- DATA DEL GIORNO DA MENU'                  
000084     05  WCOM-DATAXXXX.                                           
000085         10  WCOM-DATAGGXX             PIC X(2).                  
000086         10  WCOM-DATAGGXN REDEFINES WCOM-DATAGGXX  PIC 9(2).     
000087         10  WCOM-BARRAUNO             PIC X(1).                  
000088         10  WCOM-DATAMMXX             PIC X(2).                  
000089         10  WCOM-DATAMMXN REDEFINES WCOM-DATAMMXX  PIC 9(2).     
000090         10  WCOM-BARRADUE             PIC X(1).                  
000091         10  WCOM-DATAAAXX.                                       
000092             15 WCOM-DATAAAX1          PIC 9(1).                  
000093             15 WCOM-DATAAAX2          PIC 9(1).                  
000094         10  WCOM-DATAAAXN REDEFINES WCOM-DATAAAXX  PIC 9(2).     
000095*---------------------- NOME DELLA CODA TS GENERICA               
000096     05  WCOM-CODATSXX.                                           
000097         10 WCOM-CODATSX1              PIC X(4)  VALUE SPACES.    
000098         10 WCOM-CODATSX2              PIC X(4)  VALUE SPACES.    
000099*---------------------- DATA DEL GIORNO                           
000100     05  WCOM-DTCREAZI.                                           
000101         10 WCOM-DTCREAZI-SY.                                     
000102            15 WCOM-DTCREAZI-SS        PIC X(2).                  
000103            15 WCOM-DTCREAZI-YY        PIC X(2).                  
000104         10 WCOM-DTCREAZI-SYN REDEFINES WCOM-DTCREAZI-SY PIC 9(4).
000105         10 WCOM-DTCREAZI-MM           PIC X(2).                  
000106         10 WCOM-DTCREAZI-DD           PIC X(2).                  
000107*---------------------- CODICE UTENTE                             
000108     05  WCOM-UTENCICS                 PIC X(6).                  
000109*---------------------- TRANSAZIONI NELL' AMBITO DELLA RICHIESTA  
000110     05  WCOM-INDITRAN                 PIC 9(2).                  
000111     05  WCOM-TABETRAN.                                           
000112         10  WCOM-MENUTRAN  OCCURS 10  PIC X(4).                  
000113         10  WCOM-PAGITRAN  OCCURS 10  PIC S9(5) COMP-3.          
000114*---------------------- FLAG AVVISI UTENTI/TRANSAZIONI DA SCTUTENT
000115     05  WCOM-FLAGUTEN                 PIC X(1).                  
000116     05  WCOM-FLAGTRAN                 PIC X(1).                  
000117*---------------------- FLAG UTENTI LIMITATI                      
000118     05  WCOM-FLAGLIMI                 PIC X(1).                  
000119*---------------------- LIBERI                                    
000120     05  FILLER                        PIC X(25).                 
000121*---------------------- RICHIESTA                                 
000122     05  WCOM-RIKIESTA.                                           
000123         10   WCOM-COMODOXX            PIC X(125).                
000124*    COPY DCLOGI.                                                 
000125******************************************************************
000126*                        *** DCLOGI ***                          *
000127*     DSECT RELATIVA ALLA COMMAREA DEGLI ORDINI DI LOGISTICA     *
000128*                    - LUNGHEZZA 175 BYTES -                     *
000129******************************************************************
000130         10  FILLER                           PIC X(200).         
000131     05  WORK-RICHIESTA REDEFINES WCOM-RIKIESTA.                  
000132         10  WCOM-DCLOGI.                                         
000133             15  WCOM-CODUTENT                PIC X(06).          
000134             15  WCOM-CODSOCIE                PIC X(02).          
000135             15  WCOM-CDDIVISI                PIC X(01).          
000136             15  WCOM-CODDEPOS                PIC X(02).          
000137             15  WCOM-CODCLIEN                PIC X(05).          
000138             15  WCOM-CLIFOCON                PIC X(05).          
000139             15  WCOM-CODSERVI                PIC X(06).          
000140             15  WCOM-TIPSERVI                PIC X(01).          
000141             15  WCOM-CODDIVIS                PIC X(02).          
000142             15  WCOM-UNMISURA                PIC X(02).          
000143             15  WCOM-AANUMORD                PIC X(08).          
000144             15  WCOM-NRRIGORD                PIC S9(3)  COMP-3.  
000145             15  WCOM-CONTODCE                PIC X(06).          
000146             15  WCOM-SALDATOX                PIC X(01).          
000147             15  WCOM-OPERAZIO                PIC X(01).          
000148             15  WCOM-DECIDIVI                PIC X(01).          
000149             15  WCOM-CONTOPER                PIC S9(5)  COMP-3.  
000150             15  WCOM-CODERROR                PIC X(05).          
000151             15  WCOM-FLAGAUTO                PIC X(01).          
000152             15  WCOM-SOCIEMER                PIC X(02).          
000153             15  WCOM-TIPOARTI                PIC X(01).          
000154             15  WCOM-PAESPROV                PIC X(03).          
000155             15  WCOM-PAESMERC                PIC X(03).          
000156             15  WCOM-DTCARORD                PIC X(08).          
000157             15  WCOM-FLAGMANU                PIC X(01).          
000158             15  WCOM-FLAGGIVA                PIC X(01).          
000159             15  WCOM-TIPORECO                PIC X(04).          
000160             15  WCOM-AANUMFAT                PIC X(08).          
000161             15  WCOM-DTFATTUR                PIC X(08).          
000162             15  WCOM-NRPREATT                PIC X(18).          
000163             15  WCOM-DTPREATT                PIC X(08).          
000164             15  WCOM-STATUSXX                PIC X(01).          
000165             15  WCOM-AAMMCOMP                PIC X(06).          
000166             15  WCOM-CENCOSTD                PIC X(05).          
000167             15  WCOM-CENCOSTA                PIC X(05).          
000168             15  WCOM-ESENTIVA                PIC X(01).          
000169             15  FILLER                       PIC X(32).          
000170*--------------------------------------------------------------*  
000171     10  WCOM-DATIPROG.                                           
000172         15 WCOM-RAGFATTU        PIC X(24).                       
000173         15 WCOM-RAGFATT2        PIC X(24).                       
000174         15 WCOM-DESSERVI        PIC X(40).                       
000175         15 WCOM-PF              PIC X(01).                       
000176         15 WCOM-NUMORDIN        PIC X(06).                       
000177         15 FILLER               PIC X(55).                       
000178 01  FILLER                      PIC X(08)  VALUE 'DCWWORK1'.     
000179*    COPY DCWWORK1.                                               
000180***************************************************************** 
000181******            DATI DI USO GENERALE      (DCWWORK1)     ****** 
000182***************************************************************** 
000183 01  DCW-WORK1.                                                   
000184*----------------- NOME MAPPA CON GESTIONE CODICE LINGUA          
000185     05 WNOMEMAP.                                                 
000186        10  FILLER                     PIC X(2).                  
000187        10  WCODLING                   PIC X.                     
000188        10  FILLER                     PIC X(4).                  
000189*----------------- COMODO LINEA CONTENENTE L'ULTIMO EXEC CICS     
000190     05 WLINEAXX.                                                 
000191        10  EL-LINE    OCCURS 5        PIC X.                     
000192*----------------- COMODO CONTENENTE DFHEIV0                      
000193     05 T-COMLINE.                                                
000194        10  EL-COMLINE OCCURS 29       PIC X.                     
000195*----------------- INDICE PER SCORRERE LA T-COMLINE.              
000196     05 INDERR                         PIC S9(5) COMP-3 VALUE +0. 
000197*----------------- TRANSAZIONE IMPOSTATA AL MOMENTO DEL PF5 / PF4 
000198     05 WTRANSID                       PIC X(4) VALUE SPACES.     
000199*----------------- INDICE DELLA RIGA DI MAPPA                     
000200     05 WINDRIGA                       PIC S9(3) COMP-3 VALUE +0. 
000201*----------------- NUMERO MASSIMO DI RIGHE IN UNA MAPPA           
000202     05 WNUMRIGA                       PIC 9(2)        VALUE 0.   
000203*----------------- FLAG PER GLI ERRORI A LIVELLO DI DATI-MAPPA    
000204     05 WSWERROR                       PIC X      VALUE SPACES.   
000205        88 ERRORE                                 VALUE '*'.      
000206*----------------- NUMERO PAGINA RICHIESTO                        
000207     05 WPAGRICH                       PIC S9(5) COMP-3 VALUE +0. 
000208*----------------- NUMERO RECORD CODA-TS                          
000209     05 WNUMITEM                       PIC S9(4) COMP VALUE +0.   
000210*----------------- INDICE DELLA CODA DI PAGINAZIONE TS            
000211     05 WPAGIPAG                       PIC S9(4) COMP VALUE +0.   
000212*----------------- CHIAVE DELLA CODA DI PAGINAZIONE TS            
000213     05 WPAGCTRL.                                                 
000214        10  WPAGNOME                   PIC X(4)    VALUE 'PAGI'.  
000215        10  WPAGVIDE                   PIC X(4).                  
000216*----------------- LUNGHEZZA  CODA DI PAGINAZIONE TS              
000217     05 WPAGLPAG                       PIC S9(4) COMP VALUE +0.   
000218*----------------- ABSOLUTE TIME                                  
000219     05 WABSTIME                       PIC S9(15) COMP-3 VALUE +0.
000220*----------------- ABSOLUTE YEAR                                  
000221     05 WABSYEAR                       PIC S9(8) COMP VALUE +0.   
000222*----------------- FOR RESP OPTION                                
000223     05 WEIBRESP                       PIC S9(8) COMP VALUE +0.   
000224*----------------- FOR CVDA  (CICS VALUE DATA AREA)               
000225     05 WNOLOG                         PIC S9(8) COMP VALUE +0.   
000226     05 WCVDA                          PIC S9(8) COMP VALUE +0.   
000227     05 WCVDA-OPEN                     PIC S9(8) COMP VALUE +18.  
000228     05 WCVDA-CLOSED                   PIC S9(8) COMP VALUE +19.  
000229*----------------- FOR BIF DEEDIT                                 
000230     05 WWTWSNU                        PIC X(8) VALUE 'WWTWSNU'.  
000231     05 WLENGTH                        PIC S9(4) COMP.            
000232*----------------- AREA DELLA CODA TS DI PAGINAZIONE              
000233 01  WPAGREFE.                                                    
000234     05  FILLER                        PIC X    VALUE SPACES.     
000235     05  WPAG-OCODCLIE           PIC X(05).                       
000236     05  WPAG-ORAGFATT           PIC X(24).                       
000237     05  WPAGREF1 OCCURS 17.                                      
000238         15  WPAG-RCODSOCI       PIC X(02).                       
000239         15  WPAG-RCDDIVIS       PIC X(01).                       
000240         15  WPAG-RTIPSERV       PIC X(01).                       
000241         15  WPAG-RAANUMOR       PIC X(08).                       
000242         15  WPAG-RAAMMCOM       PIC X(06).                       
000243         15  WPAG-RFLAGAUT       PIC X(01).                       
000244         15  WPAG-RFLAGIVA       PIC X(01).                       
000245         15  WPAG-RCONTODC       PIC X(06).                       
000246         15  WPAG-RCODDIVI       PIC X(02).                       
000247         15  WPAG-RIMPORDI       PIC S9(11)V99   COMP-3.          
000248         15  WPAG-RDTEVAOR       PIC X(08).                       
000249         15  WPAG-RAANUMFA       PIC X(08).                       
000250         15  WPAG-RDTFATTU       PIC X(08).                       
000251         15  WPAG-RNRPREAT       PIC X(10).                       
000252         15  WPAG-RDTPREAT       PIC X(08).                       
000253         15  WPAG-RSOCIEME       PIC X(02).                       
000254         15  WPAG-DATAESTR       PIC X(08).                       
000255         15  WPAG-FLAGSOSP       PIC X(01).                       
000256         15  WPAG-CODUTEVB       PIC X(06).                       
000257         15  WPAG-DTCARORD       PIC X(08).                       
000258         15  WPAG-RESENTIV       PIC X(01).                       
000259         15  WPAG-FLAGRIFE       PIC X(01).                       
000260 01  FILLER                      PIC X(08) VALUE 'COMODI**'.      
000261 01  COMODI.                                                      
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000262     05  WSWS-ORDINAME           PIC X(01)  VALUE SPACES.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000263     05  WS-CODERROR             PIC X(05)  VALUE SPACES.         
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000264     05  WS-CONTODCE             PIC X(06)  VALUE SPACES.         
000265     05  MIN-FLAGSOSP            PIC X(01)  VALUE SPACES.         
000266     05  MAX-FLAGSOSP            PIC X(01)  VALUE SPACES.         
000267     05  MIN-TIPSERVI            PIC X(01)  VALUE SPACES.         
000268     05  MAX-TIPSERVI            PIC X(01)  VALUE SPACES.         
000269     05  MIN-AAMMCOMP            PIC X(08)  VALUE SPACES.         
000270     05  MAX-AAMMCOMP            PIC X(08)  VALUE SPACES.         
000271     05  MIN-DTEVAORD            PIC X(08)  VALUE SPACES.         
000272     05  MAX-DTEVAORD            PIC X(08)  VALUE SPACES.         
000273     05  MIN-DTFATTUR            PIC X(08)  VALUE SPACES.         
000274     05  MAX-DTFATTUR            PIC X(08)  VALUE SPACES.         
000275     05  MIN-CODSOCIE            PIC X(02)  VALUE SPACES.         
000276     05  MAX-CODSOCIE            PIC X(02)  VALUE SPACES.         
000277     05  WS-CENCOSTD             PIC X(05)  VALUE SPACES.         
000278     05  WS-CENCOSTA             PIC X(05)  VALUE SPACES.         
000279     05  WS-CODSERVI             PIC X(06)  VALUE SPACES.         
000280     05  WS-DESSERVI             PIC X(40)  VALUE SPACES.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000281     05  WS-SQLCODE              PIC S9(5) COMP-3 VALUE +0.       
000282     05  WS-SQLCODE2             PIC S9(5) COMP-3 VALUE +0.       
000283     05  WS-OPERAZIO             PIC X(01)  VALUE SPACES.         
000284     05  WS-IND1                 PIC S9(3) COMP-3 VALUE +0.       
000285     05  WS-IND2                 PIC S9(3) COMP-3 VALUE +0.       
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000286     05  WS-CODCLIEN             PIC X(05)  VALUE SPACES.         
000287     05  WS-ANNOANNO             PIC X(4)   VALUE SPACES.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000288     05  WS-IMPESNEW             PIC S9(11)V99 COMP-3 VALUE +0.   
000289     05  WS-TOTFATTU             PIC S9(11)V99 COMP-3 VALUE +0.   
000290     05  WS-VALRFAT2             PIC S9(9)V99 COMP-3 VALUE +0.    
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000291     05  WS-RAGFATTU             PIC X(24)  VALUE SPACES.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000292     05  WS-RAGFATT2.                                             
000293         10 WS-BYTE2             PIC X OCCURS 24.                 
000294     05  WS-RAGFATT3.                                             
000295         10 WS-BYTE3             PIC X OCCURS 24.                 
000296 01  WPAGCTR2.                                                    
000297     10  WPAGNOM2                PIC X(4)    VALUE 'CLIE'.        
000298     10  WPAGVID2                PIC X(4).                        
000299 01  WPAGLPA2                    PIC S9(4) COMP VALUE +0.         
000300 01  WPAGREF2.                                                    
000301     05 WPA2-ELEMENTO            OCCURS 100.                      
000302        10 WPA2-CODCLIEN         PIC X(05).                       
000303        10 WPA2-TOTQUANT         PIC S9(11)V99.                   
000304        10 WPA2-TOTIMPOR         PIC S9(11)V99.                   
000305 01  FILLER                      PIC X(08)  VALUE 'OR73-ARE'.     
000306 01  OR73-RIKIESTA.                                               
000307     05 OR73-AANUMORD            PIC X(08).                       
000308     05 OR73-TIPOORDI            PIC X(01).                       
000309     05 OR73-MERCEMAG            PIC X(02).                       
000310     05 OR73-TINOTORD            PIC X(01).                       
000311     05 OR73-CODSOCIE            PIC X(02).                       
000312     05 OR73-CODCLIEN            PIC X(05).                       
000313     05 OR73-DTCARICO            PIC X(08).                       
000314     05 OR73-FLAGPROT            PIC X(01).                       
000315     05 OR73-SOCIEMER            PIC X(02).                       
000316     05 OR73-CODDEPOS            PIC X(02).                       
000317     05 OR73-ORDIORIG            PIC X(08).                       
000318     05 OR73-TIPOMERC            PIC X(02).                       
000319     05 OR73-NORDLOTN            PIC X(11).                       
000320     05 FILLER                   PIC X(272).                      
000321*---------------------------------------------------------------- 
000322 01  FILLER                      PIC X(08) VALUE '*DFHAID*'.      
000323*    COPY DFHAID   SUPPRESS.                                      
000324***************************************************************** 
000325*                                                               * 
000326* Copyright (c) 2016-2022 NTT DATA, Inc.                        * 
000327* All rights reserved.                                          * 
000328*                                                               * 
000329***************************************************************** 
000330 01  DFHAID.                                                      
000331     02  DFHNULL   PIC X VALUE "-".                               
000332     02  DFHENTER  PIC X VALUE "'".                               
000333     02  DFHCLEAR  PIC X VALUE "_".                               
000334     02  DFHCLRP   PIC X VALUE "|".                               
000335     02  DFHPEN    PIC X VALUE "=".                               
000336     02  DFHOPID   PIC X VALUE "W".                               
000337     02  DFHMSRE   PIC X VALUE "X".                               
000338     02  DFHSTRF   PIC X VALUE "h".                               
000339     02  DFHTRIG   PIC X VALUE '"'.                               
000340     02  DFHPA1    PIC X VALUE "%".                               
000341     02  DFHPA2    PIC X VALUE ">".                               
000342     02  DFHPA3    PIC X VALUE ",".                               
000343     02  DFHPF1    PIC X VALUE "1".                               
000344     02  DFHPF2    PIC X VALUE "2".                               
000345     02  DFHPF3    PIC X VALUE "3".                               
000346     02  DFHPF4    PIC X VALUE "4".                               
000347     02  DFHPF5    PIC X VALUE "5".                               
000348     02  DFHPF6    PIC X VALUE "6".                               
000349     02  DFHPF7    PIC X VALUE "7".                               
000350     02  DFHPF8    PIC X VALUE "8".                               
000351     02  DFHPF9    PIC X VALUE "9".                               
000352     02  DFHPF10   PIC X VALUE ":".                               
000353     02  DFHPF11   PIC X VALUE "#".                               
000354     02  DFHPF12   PIC X VALUE "@".                               
000355     02  DFHPF13   PIC X VALUE "A".                               
000356     02  DFHPF14   PIC X VALUE "B".                               
000357     02  DFHPF15   PIC X VALUE "C".                               
000358     02  DFHPF16   PIC X VALUE "D".                               
000359     02  DFHPF17   PIC X VALUE "E".                               
000360     02  DFHPF18   PIC X VALUE "F".                               
000361     02  DFHPF19   PIC X VALUE "G".                               
000362     02  DFHPF20   PIC X VALUE "H".                               
000363     02  DFHPF21   PIC X VALUE "I".                               
000364     02  DFHPF22   PIC X VALUE "[".                               
000365     02  DFHPF23   PIC X VALUE ".".                               
000366     02  DFHPF24   PIC X VALUE "<".                               
000367 01  FILLER                      PIC X(08) VALUE 'DCWATTRI'.      
000368*    COPY DCWATTRI SUPPRESS.                                      
000369******************************************************************
000370******       VALORI    DEGLI   ATTRIBUTI    (WCOPATTR)      ******
000371******************************************************************
000372 01       DFHBMSCA.                                               
000373   05     DFHBMEOF                    PIC X  VALUE ' '.           
000374*  X'80'  CC DI RITORNO DI UN CAMPO ANNULLATO CON CANCEL F.C.     
000375   05     DFHBMUNP                    PIC X  VALUE ' '.           
000376*  X'40'  NON PROTETTO                                            
000377   05     DFHBMFSE                    PIC X  VALUE 'A'.           
000378*  X'C1'  NON PROTETTO MDT                                        
000379   05     DFHUNPSP                    PIC X  VALUE 'D'.           
000380*  X'C4'  NON PROTETTO SELEZIONABILE                              
000381   05     DFHUNPSM                    PIC X  VALUE 'E'.           
000382*  X'C5'  NON PROTETTO SELEZIONABILE MDT                          
000383   05     DFHBMBRY                    PIC X  VALUE 'H'.           
000384*  X'C8'  NON PROTETTO LUMINOSO SELEZIONABILE                     
000385   05     DFHUNIMD                    PIC X  VALUE 'I'.           
000386*  X'C9'  NON PROTETTO LUMINOSO SELEZIONABILE MDT                 
000387   05     DFHBMDAR                    PIC X  VALUE '<'.           
000388*  X'4C'  NON PROTETTO NON VISIBILE                               
000389   05     DFHUNNOD                    PIC X  VALUE '('.           
000390*  X'4D'  NON PROTETTO NON VISIBILE MDT                           
000391   05     DFHBMUNN                    PIC X  VALUE '&'.           
000392*  X'50'  NON PROTETTO NUMERICO                                   
000393   05     DFHUNNUM                    PIC X  VALUE 'J'.           
000394*  X'D1'  NON PROTETTO NUMERICO MDT                               
000395   05     DFHUNPNS                    PIC X  VALUE 'M'.           
000396*  X'D4'  NON PROTETTO NUMERICO SELEZIONABILE                     
000397   05     DFHUNNSM                    PIC X  VALUE 'N'.           
000398*  X'D5'  NON PROTETTO NUMERICO SELEZIONABILE MDT                 
000399   05     DFHUNNBS                    PIC X  VALUE 'Q'.           
000400*  X'D8'  NON PROTETTO NUMERICO LUMINOSO SELEZIONABILE            
000401   05     DFHUNBSM                    PIC X  VALUE 'R'.           
000402*  X'D9'  NON PROTETTO NUMERICO LUMINOSO SELEZIONABILE MDT        
000403   05     DFHUNPND                    PIC X  VALUE '*'.           
000404*  X'5C'  NON PROTETTO NUMERICO NON VISIBILE                      
000405   05     DFHUNNON                    PIC X  VALUE ')'.           
000406*  X'5D'  NON PROTETTO NUMERICO NON VISIBILE MDT                  
000407   05     DFHBMPRO                    PIC X  VALUE '-'.           
000408*  X'60'  PROTETTO                                                
000409   05     DFHBMPRF                    PIC X  VALUE '/'.           
000410*  X'61'  PROTETTO MDT                                            
000411   05     DFHPROSP                    PIC X  VALUE 'U'.           
000412*  X'E4'  PROTETTO SELEZIONABILE                                  
000413   05     DFHPRSPM                    PIC X  VALUE 'V'.           
000414*  X'E5'  PROTETTO SELEZIONABILE MDT                              
000415   05     DFHPROTI                    PIC X  VALUE 'Y'.           
000416*  X'E8'  PROTETTO LUMINOSO SELEZIONABILE                         
000417   05     DFHPRLSM                    PIC X  VALUE 'Z'.           
000418*  X'E9'  PROTETTO LUMINOSO SELEZIONABILE MDT                     
000419   05     DFHPROTN                    PIC X  VALUE '%'.           
000420*  X'6C'  PROTETTO NON VISIBILE                                   
000421   05     DFHPRODM                    PIC X  VALUE '_'.           
000422*  X'6D'  PROTETTO NON VISIBILE MDT                               
000423   05     DFHBMASK                    PIC X  VALUE '0'.           
000424*  X'F0'  PROTETTO SKIP                                           
000425   05     DFHBMASF                    PIC X  VALUE '1'.           
000426*  X'F1'  PROTETTO SKIP  MDT                                      
000427   05     DFHPRSKS                    PIC X  VALUE '4'.           
000428*  X'F4'  PROTETTO SKIP  SELEZIONABILE                            
000429   05     DFHPSKSM                    PIC X  VALUE '5'.           
000430*  X'F5'  PROTETTO SKIP  SELEZIONABILE MDT                        
000431   05     DFHBMASB                    PIC X  VALUE '8'.           
000432*  X'F8'  PROTETTO SKIP  LUMINOSO SELEZIONABILE                   
000433   05     DFHPROIM                    PIC X  VALUE '9'.           
000434*  X'F9'  PROTETTO SKIP  LUMINOSO SELEZIONABILE MDT               
000435*  05     DFHPRSKD                    PIC X  VALUE '§'.           
000436   05     DFHPRSKD                    PIC X  VALUE '@'.           
000437*  X'7C'  PROTETTO SKIP  NON VISIBILE                             
000438   05     DFHPSKDM                    PIC X  VALUE QUOTE.         
000439*  X'7D'  PROTETTO SKIP  NON VISIBILE MDT                         
000440   05     DFHBLUE                     PIC X  VALUE '1'.           
000441*  X'F1'  COLORE BLUE                                             
000442   05     DFHRED                      PIC X  VALUE '2'.           
000443*  X'F2'  COLORE ROSSO                                            
000444   05     DFHPINK                     PIC X  VALUE '3'.           
000445*  X'F3'  COLORE ROSA                                             
000446   05     DFHGREEN                    PIC X  VALUE '4'.           
000447*  X'F4'  COLORE VERDE                                            
000448   05     DFHTURQ                     PIC X  VALUE '5'.           
000449*  X'F5'  COLORE AZZURRO                                          
000450   05     DFHYELLO                    PIC X  VALUE '6'.           
000451*  X'F6'  COLORE GIALLO                                           
000452   05     DFHNEUTR                    PIC X  VALUE '7'.           
000453*  X'F7'  COLORE NEUTRO                                           
000454   05     DFHDFHI                     PIC X  VALUE HIGH-VALUE.    
000455*  X'FF'  TOGLIE LA SOTTOLINEATURA (UNDERLINE)                    
000456   05     DFHUNDLN                    PIC X  VALUE '4'.           
000457*  X'F4'  IMPOSTA LA SOTTOLINEATURA (UNDERLINE)                   
000458   05     DFHREVRS                    PIC X  VALUE '2'.           
000459*  X'F4'  IMPOSTA IL REVERSE                                      
000460   05     DFHALL                      PIC X  VALUE ' '.           
000461*  X'00'  PULISCE GLI ATTRIBUTI PRENDENDO QUELLI DI MAPPA         
000462 01  FILLER                      PIC X(08) VALUE '*DCMESS*'.      
000463*    COPY DCMESS.                                                 
000464********************     DCMESS           ************************
000465*********  COPY PER ESECUZIONE DELLA SUBROUTINE SRMESS     *******
000466*********  GESTIONE MESSAGGI DI ERRORE TP/BATCH            *******
000467******************************************************************
000468 01  DCMESS.                                                      
000469     05  MESS-CAMPI-INPUT.                                        
000470         10  MESS-CODERROR      PIC X(5)       VALUE SPACES.      
000471         10  MESS-CODILING      PIC X(1)       VALUE SPACES.      
000472     05  MESS-CAMPI-OUTPUT.                                       
000473         10  MESS-MSGERROR.                                       
000474             15  MESS-COMCODER  PIC X(5)       VALUE SPACES.      
000475             15  FILLER         PIC X          VALUE SPACES.      
000476             15  MESS-MESSAGGI  PIC X(66)      VALUE SPACES.      
000477 01  FILLER                      PIC X(08)  VALUE 'DCWCAMB'.      
000478*    COPY DCWCAMB.                                                
000479******************************************************************
000480******              AREA PASSAGGIO CHIAMATA                 ******
000481******         MODULI SCTCB05, SCBCB05, SCTCB10 E SCBCB10   ******
000482******         LENGTH -250-                                 ******
000483******                                                      ******
000484******   DATI-INPUT                                         ******
000485******         DA : CAMB-SIGLADIV                           ******
000486******          A   CAMB-SIGLACAM                           ******
000487******        OPPURE                                        ******
000488******         DA : CAMB-CODDIVIS                           ******
000489******          A   CAMB-CODCAMBI                           ******
000490******        OPPURE                                        ******
000491******         DA : CAMB-CODDIVIS                           ******
000492******          A   CAMB-SIGLACAM                           ******
000493******        OPPURE                                        ******
000494******         DA : CAMB-SIGLADIV                           ******
000495******          A   CAMB-CODCAMBI                           ******
000496******************************************************************
000497 01  DCWCAMB.                                                     
000498   02  CAMB-DATI-INPUT.                                           
000499     03  CAMB-DATI-COMUNI.                                        
000500       05  CAMB-SIGLACAM            PIC X(3).                     
000501       05  CAMB-SIGLADIV            PIC X(3).                     
000502       05  CAMB-CODCAMBI            PIC X(2).                     
000503       05  CAMB-CODDIVIS            PIC X(2).                     
000504       05  CAMB-IMPORTOO OCCURS 5   PIC S9(11)V99.                
000505       05  CAMB-DTCAMBIO            PIC X(8).                     
000506       05  CAMB-SOCIRIFE            PIC X(2).                     
000507       05  CAMB-CODDRIFE            PIC X(2).                     
000508       05  CAMB-SIGLRIFE            PIC X(3).                     
000509       05  FILLER                   PIC X(23).                    
000510   02  CAMB-DATI-OUTPUT.                                          
000511     03  CAMB-DATI-SIGLACAM.                                      
000512       05  CAMB-CAMBCAMB            PIC S9(9)V9999 COMP-3.        
000513       05  CAMB-DESCCAMB            PIC X(20).                    
000514       05  CAMB-DECICAMB            PIC X.                        
000515       05  CAMB-CAMBBANC            PIC X(3).                     
000516       05  CAMB-CAMBPREZ            PIC X.                        
000517     03  CAMB-DATI-SIGLADIV.                                      
000518       05  FILLER                   PIC X(7).                     
000519       05  CAMB-DESCDIVI            PIC X(20).                    
000520       05  CAMB-DECIDIVI            PIC X.                        
000521       05  CAMB-DIVIBANC            PIC X(3).                     
000522       05  CAMB-DIVIPREZ            PIC X.                        
000523     03  CAMB-CONTROVA OCCURS 5     PIC S9(11)V99  COMP-3.        
000524     03  CAMB-RAPPCAMB              PIC S9(5)      COMP-3.        
000525     03  CAMB-RAPPDIVI              PIC S9(5)      COMP-3.        
000526     03  CAMB-CAMBIODV              PIC S9(7)V9(6) COMP-3.        
000527     03  CAMB-CAMBDV10              PIC S9(5)V9(10) COMP-3.       
000528     03  FILLER                     PIC X(13).                    
000529     03  CAMB-RETCOD                PIC X(4).                     
000530 01  FILLER                      PIC X(08)  VALUE 'DCWEIVA'.      
000531*    COPY DCWEIVA.                                                
000532***************************************************************   
000533*                                                             *   
000534*                 AREA PER MODULO  SCTEIVA                    *   
000535*                                                             *   
000536***************************************************************   
000537 01  DCWEIVA.                                                     
000538   05  EIVA-OPERAZIO   PIC X(01).                                 
000539   05  EIVA-CODSOCIE   PIC X(02).                                 
000540   05  EIVA-CODCLIEN   PIC X(05).                                 
000541   05  EIVA-CDMOVCON   PIC X(01).                                 
000542   05  EIVA-INDSEGNO   PIC X(01).                                 
000543   05  EIVA-AANUMFAT   PIC X(08).                                 
000544   05  EIVA-DTFATTUR   PIC X(08).                                 
000545   05  EIVA-CODDIVIS   PIC X(02).                                 
000546   05  EIVA-VALRFATT   PIC S9(09)V99 COMP-3.                      
000547   05  EIVA-AANUMFRI   PIC X(08).                                 
000548   05  EIVA-DTCREAZI   PIC X(08).                                 
000549   05  EIVA-CODUTVAR   PIC X(06).                                 
000550   05  EIVA-FLAGSCAD   PIC X(01).                                 
000551   05  EIVA-NUMESIVA   PIC X(05).                                 
000552   05  EIVA-FILLER     PIC X(38).                                 
000553 01  FILLER                      PIC X(08)  VALUE 'DCWTSTR0'.     
000554*    COPY DCWTSTR0.                                               
000555*------------------------------------- -------------------------* 
000556*                    --- DCWTSTR0 ---                           * 
000557*              DSECT PER SALVATAGGIO COMMAREA.                  * 
000558*---------------------------------------------------------------* 
000559 01  DCWTSTR0.                                                    
000560     05  TSTR-LENGCODA               PIC S9(4)  COMP VALUE +4096. 
000561     05  TSTR-ITEMXXXX               PIC S9(4)  COMP VALUE +0.    
000562     05  TSTR-NOMECODA.                                           
000563         10  TSTR-NOMETRAN           PIC X(4)   VALUE SPACES.     
000564         10  TSTR-NOMETERM           PIC X(4)   VALUE SPACES.     
000565     05  TSTR-AREATSTR               PIC X(4096) VALUE SPACES.    
000566*---------------------------------------------------------------* 
000567 01  FILLER                      PIC X(08) VALUE '*AVMLO22'.      
000568*    COPY AVMLO22.                                                
000569*   Micro Focus Enterprise Developer  2.2.01204                   
000570*   Micro Focus BMS Screen Painter (ver BMSIDE_2-2-20)            
000571*   MapSet Name   AVMLO22                                         
000572*   Date Created  09/17/2021                                      
000573*   Time Created  11:49:52                                        
000574*  Input Data For Map AVILO22                                     
000575   01 AVILO22I.                                                   
000576      03 FILLER                         PIC X(12).                
000577      03 LO22-CODSOCIEL                 PIC S9(4) COMP.           
000578      03 LO22-CODSOCIEF                 PIC X.                    
000579      03 FILLER REDEFINES LO22-CODSOCIEF.                         
000580         05 LO22-CODSOCIEA                 PIC X.                 
000581      03 FILLER                         PIC X(4).                 
000582      03 LO22-CODSOCIEI                 PIC X(2).                 
000583      03 LO22-NOMSOCIEL                 PIC S9(4) COMP.           
000584      03 LO22-NOMSOCIEF                 PIC X.                    
000585      03 FILLER REDEFINES LO22-NOMSOCIEF.                         
000586         05 LO22-NOMSOCIEA                 PIC X.                 
000587      03 FILLER                         PIC X(4).                 
000588      03 LO22-NOMSOCIEI                 PIC X(21).                
000589      03 LO22-FLAGSOSPL                 PIC S9(4) COMP.           
000590      03 LO22-FLAGSOSPF                 PIC X.                    
000591      03 FILLER REDEFINES LO22-FLAGSOSPF.                         
000592         05 LO22-FLAGSOSPA                 PIC X.                 
000593      03 FILLER                         PIC X(4).                 
000594      03 LO22-FLAGSOSPI                 PIC X(1).                 
000595      03 LO22-CODCLIENL                 PIC S9(4) COMP.           
000596      03 LO22-CODCLIENF                 PIC X.                    
000597      03 FILLER REDEFINES LO22-CODCLIENF.                         
000598         05 LO22-CODCLIENA                 PIC X.                 
000599      03 FILLER                         PIC X(4).                 
000600      03 LO22-CODCLIENI                 PIC X(5).                 
000601      03 LO22-RAGFATTUL                 PIC S9(4) COMP.           
000602      03 LO22-RAGFATTUF                 PIC X.                    
000603      03 FILLER REDEFINES LO22-RAGFATTUF.                         
000604         05 LO22-RAGFATTUA                 PIC X.                 
000605      03 FILLER                         PIC X(4).                 
000606      03 LO22-RAGFATTUI                 PIC X(23).                
000607      03 LO22-AAAACOMPL                 PIC S9(4) COMP.           
000608      03 LO22-AAAACOMPF                 PIC X.                    
000609      03 FILLER REDEFINES LO22-AAAACOMPF.                         
000610         05 LO22-AAAACOMPA                 PIC X.                 
000611      03 FILLER                         PIC X(4).                 
000612      03 LO22-AAAACOMPI                 PIC X(4).                 
000613      03 LO22-MMMMCOMPL                 PIC S9(4) COMP.           
000614      03 LO22-MMMMCOMPF                 PIC X.                    
000615      03 FILLER REDEFINES LO22-MMMMCOMPF.                         
000616         05 LO22-MMMMCOMPA                 PIC X.                 
000617      03 FILLER                         PIC X(4).                 
000618      03 LO22-MMMMCOMPI                 PIC X(2).                 
000619      03 LO22-STATUSXXL                 PIC S9(4) COMP.           
000620      03 LO22-STATUSXXF                 PIC X.                    
000621      03 FILLER REDEFINES LO22-STATUSXXF.                         
000622         05 LO22-STATUSXXA                 PIC X.                 
000623      03 FILLER                         PIC X(4).                 
000624      03 LO22-STATUSXXI                 PIC X(1).                 
000625      03 LO22-CODSERVIL                 PIC S9(4) COMP.           
000626      03 LO22-CODSERVIF                 PIC X.                    
000627      03 FILLER REDEFINES LO22-CODSERVIF.                         
000628         05 LO22-CODSERVIA                 PIC X.                 
000629      03 FILLER                         PIC X(4).                 
000630      03 LO22-CODSERVII                 PIC X(6).                 
000631      03 LO22-DESSERVIL                 PIC S9(4) COMP.           
000632      03 LO22-DESSERVIF                 PIC X.                    
000633      03 FILLER REDEFINES LO22-DESSERVIF.                         
000634         05 LO22-DESSERVIA                 PIC X.                 
000635      03 FILLER                         PIC X(4).                 
000636      03 LO22-DESSERVII                 PIC X(35).                
000637      03 LO22-TIPSERVIL                 PIC S9(4) COMP.           
000638      03 LO22-TIPSERVIF                 PIC X.                    
000639      03 FILLER REDEFINES LO22-TIPSERVIF.                         
000640         05 LO22-TIPSERVIA                 PIC X.                 
000641      03 FILLER                         PIC X(4).                 
000642      03 LO22-TIPSERVII                 PIC X(1).                 
000643      03 LO22-DESTIPSEL                 PIC S9(4) COMP.           
000644      03 LO22-DESTIPSEF                 PIC X.                    
000645      03 FILLER REDEFINES LO22-DESTIPSEF.                         
000646         05 LO22-DESTIPSEA                 PIC X.                 
000647      03 FILLER                         PIC X(4).                 
000648      03 LO22-DESTIPSEI                 PIC X(9).                 
000649      03 LO22-CENCOSTDL                 PIC S9(4) COMP.           
000650      03 LO22-CENCOSTDF                 PIC X.                    
000651      03 FILLER REDEFINES LO22-CENCOSTDF.                         
000652         05 LO22-CENCOSTDA                 PIC X.                 
000653      03 FILLER                         PIC X(4).                 
000654      03 LO22-CENCOSTDI                 PIC X(5).                 
000655      03 LO22-CENCOSTAL                 PIC S9(4) COMP.           
000656      03 LO22-CENCOSTAF                 PIC X.                    
000657      03 FILLER REDEFINES LO22-CENCOSTAF.                         
000658         05 LO22-CENCOSTAA                 PIC X.                 
000659      03 FILLER                         PIC X(4).                 
000660      03 LO22-CENCOSTAI                 PIC X(5).                 
000661      03 LO22-CONTODCEL                 PIC S9(4) COMP.           
000662      03 LO22-CONTODCEF                 PIC X.                    
000663      03 FILLER REDEFINES LO22-CONTODCEF.                         
000664         05 LO22-CONTODCEA                 PIC X.                 
000665      03 FILLER                         PIC X(4).                 
000666      03 LO22-CONTODCEI                 PIC X(6).                 
000667      03 LO22-AANUMFATL                 PIC S9(4) COMP.           
000668      03 LO22-AANUMFATF                 PIC X.                    
000669      03 FILLER REDEFINES LO22-AANUMFATF.                         
000670         05 LO22-AANUMFATA                 PIC X.                 
000671      03 FILLER                         PIC X(4).                 
000672      03 LO22-AANUMFATI                 PIC X(8).                 
000673      03 LO22-NUMORDINL                 PIC S9(4) COMP.           
000674      03 LO22-NUMORDINF                 PIC X.                    
000675      03 FILLER REDEFINES LO22-NUMORDINF.                         
000676         05 LO22-NUMORDINA                 PIC X.                 
000677      03 FILLER                         PIC X(4).                 
000678      03 LO22-NUMORDINI                 PIC X(6).                 
000679      03 LO22-OCODCLIEL                 PIC S9(4) COMP.           
000680      03 LO22-OCODCLIEF                 PIC X.                    
000681      03 FILLER REDEFINES LO22-OCODCLIEF.                         
000682         05 LO22-OCODCLIEA                 PIC X.                 
000683      03 FILLER                         PIC X(4).                 
000684      03 LO22-OCODCLIEI                 PIC X(5).                 
000685      03 LO22-ORAGFATTL                 PIC S9(4) COMP.           
000686      03 LO22-ORAGFATTF                 PIC X.                    
000687      03 FILLER REDEFINES LO22-ORAGFATTF.                         
000688         05 LO22-ORAGFATTA                 PIC X.                 
000689      03 FILLER                         PIC X(4).                 
000690      03 LO22-ORAGFATTI                 PIC X(20).                
000691      03 LO22-TOTIMPORL                 PIC S9(4) COMP.           
000692      03 LO22-TOTIMPORF                 PIC X.                    
000693      03 FILLER REDEFINES LO22-TOTIMPORF.                         
000694         05 LO22-TOTIMPORA                 PIC X.                 
000695      03 FILLER                         PIC X(4).                 
000696      03 LO22-TOTIMPORI                 PIC X(14).                
000697      03 LO22-TOTQUANTL                 PIC S9(4) COMP.           
000698      03 LO22-TOTQUANTF                 PIC X.                    
000699      03 FILLER REDEFINES LO22-TOTQUANTF.                         
000700         05 LO22-TOTQUANTA                 PIC X.                 
000701      03 FILLER                         PIC X(4).                 
000702      03 LO22-TOTQUANTI                 PIC X(14).                
000703      03 LO22-PFXXXXXXL                 PIC S9(4) COMP.           
000704      03 LO22-PFXXXXXXF                 PIC X.                    
000705      03 FILLER REDEFINES LO22-PFXXXXXXF.                         
000706         05 LO22-PFXXXXXXA                 PIC X.                 
000707      03 FILLER                         PIC X(4).                 
000708      03 LO22-PFXXXXXXI                 PIC X(5).                 
000709      03 LO22-TESTO1XXL                 PIC S9(4) COMP.           
000710      03 LO22-TESTO1XXF                 PIC X.                    
000711      03 FILLER REDEFINES LO22-TESTO1XXF.                         
000712         05 LO22-TESTO1XXA                 PIC X.                 
000713      03 FILLER                         PIC X(4).                 
000714      03 LO22-TESTO1XXI                 PIC X(6).                 
000715      03 LO22-RIGAI                     OCCURS 17 TIMES.          
000716         05 LO22-OPERAZIOL                 PIC S9(4) COMP.        
000717         05 LO22-OPERAZIOF                 PIC X.                 
000718         05 FILLER REDEFINES LO22-OPERAZIOF.                      
000719            07 LO22-OPERAZIOA                 PIC X.              
000720         05 FILLER                         PIC X(4).              
000721         05 LO22-OPERAZIOI                 PIC X(1).              
000722         05 LO22-RCODSOCIL                 PIC S9(4) COMP.        
000723         05 LO22-RCODSOCIF                 PIC X.                 
000724         05 FILLER REDEFINES LO22-RCODSOCIF.                      
000725            07 LO22-RCODSOCIA                 PIC X.              
000726         05 FILLER                         PIC X(4).              
000727         05 LO22-RCODSOCII                 PIC X(3).              
000728         05 LO22-RAAMMCOML                 PIC S9(4) COMP.        
000729         05 LO22-RAAMMCOMF                 PIC X.                 
000730         05 FILLER REDEFINES LO22-RAAMMCOMF.                      
000731            07 LO22-RAAMMCOMA                 PIC X.              
000732         05 FILLER                         PIC X(4).              
000733         05 LO22-RAAMMCOMI                 PIC X(6).              
000734         05 LO22-RTIPSERVL                 PIC S9(4) COMP.        
000735         05 LO22-RTIPSERVF                 PIC X.                 
000736         05 FILLER REDEFINES LO22-RTIPSERVF.                      
000737            07 LO22-RTIPSERVA                 PIC X.              
000738         05 FILLER                         PIC X(4).              
000739         05 LO22-RTIPSERVI                 PIC X(1).              
000740         05 LO22-RAANUMORL                 PIC S9(4) COMP.        
000741         05 LO22-RAANUMORF                 PIC X.                 
000742         05 FILLER REDEFINES LO22-RAANUMORF.                      
000743            07 LO22-RAANUMORA                 PIC X.              
000744         05 FILLER                         PIC X(4).              
000745         05 LO22-RAANUMORI                 PIC X(8).              
000746         05 LO22-RFLAGAUTL                 PIC S9(4) COMP.        
000747         05 LO22-RFLAGAUTF                 PIC X.                 
000748         05 FILLER REDEFINES LO22-RFLAGAUTF.                      
000749            07 LO22-RFLAGAUTA                 PIC X.              
000750         05 FILLER                         PIC X(4).              
000751         05 LO22-RFLAGAUTI                 PIC X(1).              
000752         05 LO22-RFLAGIVAL                 PIC S9(4) COMP.        
000753         05 LO22-RFLAGIVAF                 PIC X.                 
000754         05 FILLER REDEFINES LO22-RFLAGIVAF.                      
000755            07 LO22-RFLAGIVAA                 PIC X.              
000756         05 FILLER                         PIC X(4).              
000757         05 LO22-RFLAGIVAI                 PIC X(1).              
000758         05 LO22-RCONTODCL                 PIC S9(4) COMP.        
000759         05 LO22-RCONTODCF                 PIC X.                 
000760         05 FILLER REDEFINES LO22-RCONTODCF.                      
000761            07 LO22-RCONTODCA                 PIC X.              
000762         05 FILLER                         PIC X(4).              
000763         05 LO22-RCONTODCI                 PIC X(6).              
000764         05 LO22-RSOCIEMEL                 PIC S9(4) COMP.        
000765         05 LO22-RSOCIEMEF                 PIC X.                 
000766         05 FILLER REDEFINES LO22-RSOCIEMEF.                      
000767            07 LO22-RSOCIEMEA                 PIC X.              
000768         05 FILLER                         PIC X(4).              
000769         05 LO22-RSOCIEMEI                 PIC X(2).              
000770         05 LO22-RCODDIVIL                 PIC S9(4) COMP.        
000771         05 LO22-RCODDIVIF                 PIC X.                 
000772         05 FILLER REDEFINES LO22-RCODDIVIF.                      
000773            07 LO22-RCODDIVIA                 PIC X.              
000774         05 FILLER                         PIC X(4).              
000775         05 LO22-RCODDIVII                 PIC X(2).              
000776         05 LO22-RIMPORDIL                 PIC S9(4) COMP.        
000777         05 LO22-RIMPORDIF                 PIC X.                 
000778         05 FILLER REDEFINES LO22-RIMPORDIF.                      
000779            07 LO22-RIMPORDIA                 PIC X.              
000780         05 FILLER                         PIC X(4).              
000781         05 LO22-RIMPORDII                 PIC X(14).             
000782         05 LO22-RDTEVAORL                 PIC S9(4) COMP.        
000783         05 LO22-RDTEVAORF                 PIC X.                 
000784         05 FILLER REDEFINES LO22-RDTEVAORF.                      
000785            07 LO22-RDTEVAORA                 PIC X.              
000786         05 FILLER                         PIC X(4).              
000787         05 LO22-RDTEVAORI                 PIC X(6).              
000788         05 LO22-RAANUMFAL                 PIC S9(4) COMP.        
000789         05 LO22-RAANUMFAF                 PIC X.                 
000790         05 FILLER REDEFINES LO22-RAANUMFAF.                      
000791            07 LO22-RAANUMFAA                 PIC X.              
000792         05 FILLER                         PIC X(4).              
000793         05 LO22-RAANUMFAI                 PIC X(8).              
000794         05 LO22-RDTFATTUL                 PIC S9(4) COMP.        
000795         05 LO22-RDTFATTUF                 PIC X.                 
000796         05 FILLER REDEFINES LO22-RDTFATTUF.                      
000797            07 LO22-RDTFATTUA                 PIC X.              
000798         05 FILLER                         PIC X(4).              
000799         05 LO22-RDTFATTUI                 PIC X(6).              
000800      03 LO22-MAPRPAGL                  PIC S9(4) COMP.           
000801      03 LO22-MAPRPAGF                  PIC X.                    
000802      03 FILLER REDEFINES LO22-MAPRPAGF.                          
000803         05 LO22-MAPRPAGA                  PIC X.                 
000804      03 FILLER                         PIC X(4).                 
000805      03 LO22-MAPRPAGI                  PIC X(4).                 
000806      03 LO22-MAPPPAGL                  PIC S9(4) COMP.           
000807      03 LO22-MAPPPAGF                  PIC X.                    
000808      03 FILLER REDEFINES LO22-MAPPPAGF.                          
000809         05 LO22-MAPPPAGA                  PIC X.                 
000810      03 FILLER                         PIC X(4).                 
000811      03 LO22-MAPPPAGI                  PIC X(4).                 
000812      03 LO22-MESSAGGL                  PIC S9(4) COMP.           
000813      03 LO22-MESSAGGF                  PIC X.                    
000814      03 FILLER REDEFINES LO22-MESSAGGF.                          
000815         05 LO22-MESSAGGA                  PIC X.                 
000816      03 FILLER                         PIC X(4).                 
000817      03 LO22-MESSAGGI                  PIC X(56).                
000818*  Output Data For Map AVILO22                                    
000819   01 AVILO22O REDEFINES AVILO22I.                                
000820      03 FILLER                         PIC X(12).                
000821      03 FILLER                         PIC X(3).                 
000822      03 LO22-CODSOCIEC                 PIC X.                    
000823      03 LO22-CODSOCIEP                 PIC X.                    
000824      03 LO22-CODSOCIEH                 PIC X.                    
000825      03 LO22-CODSOCIEV                 PIC X.                    
000826      03 LO22-CODSOCIEO                 PIC X(2).                 
000827      03 FILLER                         PIC X(3).                 
000828      03 LO22-NOMSOCIEC                 PIC X.                    
000829      03 LO22-NOMSOCIEP                 PIC X.                    
000830      03 LO22-NOMSOCIEH                 PIC X.                    
000831      03 LO22-NOMSOCIEV                 PIC X.                    
000832      03 LO22-NOMSOCIEO                 PIC X(21).                
000833      03 FILLER                         PIC X(3).                 
000834      03 LO22-FLAGSOSPC                 PIC X.                    
000835      03 LO22-FLAGSOSPP                 PIC X.                    
000836      03 LO22-FLAGSOSPH                 PIC X.                    
000837      03 LO22-FLAGSOSPV                 PIC X.                    
000838      03 LO22-FLAGSOSPO                 PIC X(1).                 
000839      03 FILLER                         PIC X(3).                 
000840      03 LO22-CODCLIENC                 PIC X.                    
000841      03 LO22-CODCLIENP                 PIC X.                    
000842      03 LO22-CODCLIENH                 PIC X.                    
000843      03 LO22-CODCLIENV                 PIC X.                    
000844      03 LO22-CODCLIENO                 PIC X(5).                 
000845      03 FILLER                         PIC X(3).                 
000846      03 LO22-RAGFATTUC                 PIC X.                    
000847      03 LO22-RAGFATTUP                 PIC X.                    
000848      03 LO22-RAGFATTUH                 PIC X.                    
000849      03 LO22-RAGFATTUV                 PIC X.                    
000850      03 LO22-RAGFATTUO                 PIC X(23).                
000851      03 FILLER                         PIC X(3).                 
000852      03 LO22-AAAACOMPC                 PIC X.                    
000853      03 LO22-AAAACOMPP                 PIC X.                    
000854      03 LO22-AAAACOMPH                 PIC X.                    
000855      03 LO22-AAAACOMPV                 PIC X.                    
000856      03 LO22-AAAACOMPO                 PIC X(4).                 
000857      03 FILLER                         PIC X(3).                 
000858      03 LO22-MMMMCOMPC                 PIC X.                    
000859      03 LO22-MMMMCOMPP                 PIC X.                    
000860      03 LO22-MMMMCOMPH                 PIC X.                    
000861      03 LO22-MMMMCOMPV                 PIC X.                    
000862      03 LO22-MMMMCOMPO                 PIC X(2).                 
000863      03 FILLER                         PIC X(3).                 
000864      03 LO22-STATUSXXC                 PIC X.                    
000865      03 LO22-STATUSXXP                 PIC X.                    
000866      03 LO22-STATUSXXH                 PIC X.                    
000867      03 LO22-STATUSXXV                 PIC X.                    
000868      03 LO22-STATUSXXO                 PIC X(1).                 
000869      03 FILLER                         PIC X(3).                 
000870      03 LO22-CODSERVIC                 PIC X.                    
000871      03 LO22-CODSERVIP                 PIC X.                    
000872      03 LO22-CODSERVIH                 PIC X.                    
000873      03 LO22-CODSERVIV                 PIC X.                    
000874      03 LO22-CODSERVIO                 PIC X(6).                 
000875      03 FILLER                         PIC X(3).                 
000876      03 LO22-DESSERVIC                 PIC X.                    
000877      03 LO22-DESSERVIP                 PIC X.                    
000878      03 LO22-DESSERVIH                 PIC X.                    
000879      03 LO22-DESSERVIV                 PIC X.                    
000880      03 LO22-DESSERVIO                 PIC X(35).                
000881      03 FILLER                         PIC X(3).                 
000882      03 LO22-TIPSERVIC                 PIC X.                    
000883      03 LO22-TIPSERVIP                 PIC X.                    
000884      03 LO22-TIPSERVIH                 PIC X.                    
000885      03 LO22-TIPSERVIV                 PIC X.                    
000886      03 LO22-TIPSERVIO                 PIC X(1).                 
000887      03 FILLER                         PIC X(3).                 
000888      03 LO22-DESTIPSEC                 PIC X.                    
000889      03 LO22-DESTIPSEP                 PIC X.                    
000890      03 LO22-DESTIPSEH                 PIC X.                    
000891      03 LO22-DESTIPSEV                 PIC X.                    
000892      03 LO22-DESTIPSEO                 PIC X(9).                 
000893      03 FILLER                         PIC X(3).                 
000894      03 LO22-CENCOSTDC                 PIC X.                    
000895      03 LO22-CENCOSTDP                 PIC X.                    
000896      03 LO22-CENCOSTDH                 PIC X.                    
000897      03 LO22-CENCOSTDV                 PIC X.                    
000898      03 LO22-CENCOSTDO                 PIC X(5).                 
000899      03 FILLER                         PIC X(3).                 
000900      03 LO22-CENCOSTAC                 PIC X.                    
000901      03 LO22-CENCOSTAP                 PIC X.                    
000902      03 LO22-CENCOSTAH                 PIC X.                    
000903      03 LO22-CENCOSTAV                 PIC X.                    
000904      03 LO22-CENCOSTAO                 PIC X(5).                 
000905      03 FILLER                         PIC X(3).                 
000906      03 LO22-CONTODCEC                 PIC X.                    
000907      03 LO22-CONTODCEP                 PIC X.                    
000908      03 LO22-CONTODCEH                 PIC X.                    
000909      03 LO22-CONTODCEV                 PIC X.                    
000910      03 LO22-CONTODCEO                 PIC X(6).                 
000911      03 FILLER                         PIC X(3).                 
000912      03 LO22-AANUMFATC                 PIC X.                    
000913      03 LO22-AANUMFATP                 PIC X.                    
000914      03 LO22-AANUMFATH                 PIC X.                    
000915      03 LO22-AANUMFATV                 PIC X.                    
000916      03 LO22-AANUMFATO                 PIC X(8).                 
000917      03 FILLER                         PIC X(3).                 
000918      03 LO22-NUMORDINC                 PIC X.                    
000919      03 LO22-NUMORDINP                 PIC X.                    
000920      03 LO22-NUMORDINH                 PIC X.                    
000921      03 LO22-NUMORDINV                 PIC X.                    
000922      03 LO22-NUMORDINO                 PIC X(6).                 
000923      03 FILLER                         PIC X(3).                 
000924      03 LO22-OCODCLIEC                 PIC X.                    
000925      03 LO22-OCODCLIEP                 PIC X.                    
000926      03 LO22-OCODCLIEH                 PIC X.                    
000927      03 LO22-OCODCLIEV                 PIC X.                    
000928      03 LO22-OCODCLIEO                 PIC X(5).                 
000929      03 FILLER                         PIC X(3).                 
000930      03 LO22-ORAGFATTC                 PIC X.                    
000931      03 LO22-ORAGFATTP                 PIC X.                    
000932      03 LO22-ORAGFATTH                 PIC X.                    
000933      03 LO22-ORAGFATTV                 PIC X.                    
000934      03 LO22-ORAGFATTO                 PIC X(20).                
000935      03 FILLER                         PIC X(3).                 
000936      03 LO22-TOTIMPORC                 PIC X.                    
000937      03 LO22-TOTIMPORP                 PIC X.                    
000938      03 LO22-TOTIMPORH                 PIC X.                    
000939      03 LO22-TOTIMPORV                 PIC X.                    
000940      03 LO22-TOTIMPORO                 PIC ZZZ.ZZZ.ZZZ,ZZ.       
000941      03 FILLER                         PIC X(3).                 
000942      03 LO22-TOTQUANTC                 PIC X.                    
000943      03 LO22-TOTQUANTP                 PIC X.                    
000944      03 LO22-TOTQUANTH                 PIC X.                    
000945      03 LO22-TOTQUANTV                 PIC X.                    
000946      03 LO22-TOTQUANTO                 PIC ZZZ.ZZZ.ZZZ,ZZ.       
000947      03 FILLER                         PIC X(3).                 
000948      03 LO22-PFXXXXXXC                 PIC X.                    
000949      03 LO22-PFXXXXXXP                 PIC X.                    
000950      03 LO22-PFXXXXXXH                 PIC X.                    
000951      03 LO22-PFXXXXXXV                 PIC X.                    
000952      03 LO22-PFXXXXXXO                 PIC X(5).                 
000953      03 FILLER                         PIC X(3).                 
000954      03 LO22-TESTO1XXC                 PIC X.                    
000955      03 LO22-TESTO1XXP                 PIC X.                    
000956      03 LO22-TESTO1XXH                 PIC X.                    
000957      03 LO22-TESTO1XXV                 PIC X.                    
000958      03 LO22-TESTO1XXO                 PIC X(6).                 
000959      03 LO22-RIGAO OCCURS 17.                                    
000960         05 FILLER                         PIC X(3).              
000961         05 LO22-OPERAZIOC                 PIC X.                 
000962         05 LO22-OPERAZIOP                 PIC X.                 
000963         05 LO22-OPERAZIOH                 PIC X.                 
000964         05 LO22-OPERAZIOV                 PIC X.                 
000965         05 LO22-OPERAZIOO                 PIC X(1).              
000966         05 FILLER                         PIC X(3).              
000967         05 LO22-RCODSOCIC                 PIC X.                 
000968         05 LO22-RCODSOCIP                 PIC X.                 
000969         05 LO22-RCODSOCIH                 PIC X.                 
000970         05 LO22-RCODSOCIV                 PIC X.                 
000971         05 LO22-RCODSOCIO                 PIC X(3).              
000972         05 FILLER                         PIC X(3).              
000973         05 LO22-RAAMMCOMC                 PIC X.                 
000974         05 LO22-RAAMMCOMP                 PIC X.                 
000975         05 LO22-RAAMMCOMH                 PIC X.                 
000976         05 LO22-RAAMMCOMV                 PIC X.                 
000977         05 LO22-RAAMMCOMO                 PIC X(6).              
000978         05 FILLER                         PIC X(3).              
000979         05 LO22-RTIPSERVC                 PIC X.                 
000980         05 LO22-RTIPSERVP                 PIC X.                 
000981         05 LO22-RTIPSERVH                 PIC X.                 
000982         05 LO22-RTIPSERVV                 PIC X.                 
000983         05 LO22-RTIPSERVO                 PIC X(1).              
000984         05 FILLER                         PIC X(3).              
000985         05 LO22-RAANUMORC                 PIC X.                 
000986         05 LO22-RAANUMORP                 PIC X.                 
000987         05 LO22-RAANUMORH                 PIC X.                 
000988         05 LO22-RAANUMORV                 PIC X.                 
000989         05 LO22-RAANUMORO                 PIC X(8).              
000990         05 FILLER                         PIC X(3).              
000991         05 LO22-RFLAGAUTC                 PIC X.                 
000992         05 LO22-RFLAGAUTP                 PIC X.                 
000993         05 LO22-RFLAGAUTH                 PIC X.                 
000994         05 LO22-RFLAGAUTV                 PIC X.                 
000995         05 LO22-RFLAGAUTO                 PIC X(1).              
000996         05 FILLER                         PIC X(3).              
000997         05 LO22-RFLAGIVAC                 PIC X.                 
000998         05 LO22-RFLAGIVAP                 PIC X.                 
000999         05 LO22-RFLAGIVAH                 PIC X.                 
001000         05 LO22-RFLAGIVAV                 PIC X.                 
001001         05 LO22-RFLAGIVAO                 PIC X(1).              
001002         05 FILLER                         PIC X(3).              
001003         05 LO22-RCONTODCC                 PIC X.                 
001004         05 LO22-RCONTODCP                 PIC X.                 
001005         05 LO22-RCONTODCH                 PIC X.                 
001006         05 LO22-RCONTODCV                 PIC X.                 
001007         05 LO22-RCONTODCO                 PIC X(6).              
001008         05 FILLER                         PIC X(3).              
001009         05 LO22-RSOCIEMEC                 PIC X.                 
001010         05 LO22-RSOCIEMEP                 PIC X.                 
001011         05 LO22-RSOCIEMEH                 PIC X.                 
001012         05 LO22-RSOCIEMEV                 PIC X.                 
001013         05 LO22-RSOCIEMEO                 PIC X(2).              
001014         05 FILLER                         PIC X(3).              
001015         05 LO22-RCODDIVIC                 PIC X.                 
001016         05 LO22-RCODDIVIP                 PIC X.                 
001017         05 LO22-RCODDIVIH                 PIC X.                 
001018         05 LO22-RCODDIVIV                 PIC X.                 
001019         05 LO22-RCODDIVIO                 PIC X(2).              
001020         05 FILLER                         PIC X(3).              
001021         05 LO22-RIMPORDIC                 PIC X.                 
001022         05 LO22-RIMPORDIP                 PIC X.                 
001023         05 LO22-RIMPORDIH                 PIC X.                 
001024         05 LO22-RIMPORDIV                 PIC X.                 
001025         05 LO22-RIMPORDIO                 PIC Z(10)9,99.         
001026         05 FILLER                         PIC X(3).              
001027         05 LO22-RDTEVAORC                 PIC X.                 
001028         05 LO22-RDTEVAORP                 PIC X.                 
001029         05 LO22-RDTEVAORH                 PIC X.                 
001030         05 LO22-RDTEVAORV                 PIC X.                 
001031         05 LO22-RDTEVAORO                 PIC X(6).              
001032         05 FILLER                         PIC X(3).              
001033         05 LO22-RAANUMFAC                 PIC X.                 
001034         05 LO22-RAANUMFAP                 PIC X.                 
001035         05 LO22-RAANUMFAH                 PIC X.                 
001036         05 LO22-RAANUMFAV                 PIC X.                 
001037         05 LO22-RAANUMFAO                 PIC X(8).              
001038         05 FILLER                         PIC X(3).              
001039         05 LO22-RDTFATTUC                 PIC X.                 
001040         05 LO22-RDTFATTUP                 PIC X.                 
001041         05 LO22-RDTFATTUH                 PIC X.                 
001042         05 LO22-RDTFATTUV                 PIC X.                 
001043         05 LO22-RDTFATTUO                 PIC X(6).              
001044      03 FILLER                         PIC X(3).                 
001045      03 LO22-MAPRPAGC                  PIC X.                    
001046      03 LO22-MAPRPAGP                  PIC X.                    
001047      03 LO22-MAPRPAGH                  PIC X.                    
001048      03 LO22-MAPRPAGV                  PIC X.                    
001049      03 LO22-MAPRPAGO                  PIC 9(4).                 
001050      03 FILLER                         PIC X(3).                 
001051      03 LO22-MAPPPAGC                  PIC X.                    
001052      03 LO22-MAPPPAGP                  PIC X.                    
001053      03 LO22-MAPPPAGH                  PIC X.                    
001054      03 LO22-MAPPPAGV                  PIC X.                    
001055      03 LO22-MAPPPAGO                  PIC 9(4).                 
001056      03 FILLER                         PIC X(3).                 
001057      03 LO22-MESSAGGC                  PIC X.                    
001058      03 LO22-MESSAGGP                  PIC X.                    
001059      03 LO22-MESSAGGH                  PIC X.                    
001060      03 LO22-MESSAGGV                  PIC X.                    
001061      03 LO22-MESSAGGO                  PIC X(56).                
001062 01 FILLER                       PIC X(8) VALUE 'QUERYSEC'.       
001063 01 WS-USER-ID                   PIC X(10) VALUE SPACES.          
001064 01 WS-TRANS-ID                  PIC X(04) VALUE SPACES.          
001065 01 WS-USER-READABLE             PIC X(01) VALUE SPACES.          
001066    88 NOT-AUTHORIZED            VALUE ' '.                       
001067    88 AUTHORIIZED               VALUE 'X'.                       
001068    88 SUCCESSFUL                VALUE ' ','X'.                   
001069 01 READABLE-GROUP REDEFINES WS-USER-READABLE.                    
001070    05 RETURN-VALUE              PIC 9(2) COMP-5.                 
001071    05 FILLER                    PIC X(3).                        
001072*--------------------------------DLOGI.TORDILOGI                  
001073 01  FILLER                      PIC X(8) VALUE 'FDLOG652'.       
001074*    EXEC SQL INCLUDE FDLOG652 END-EXEC.                          
      *>>((file: FDLOG652))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TORDILOGI                 *
000003******************************************************************
000004 01  DCLTORDILOGI.                                                
000005*                       AANUMORD                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006     10 L652-AANUMORD        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007*                       CODCLIEN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000008     10 L652-CODCLIEN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000009*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000010     10 L652-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000011*                       CDDIVISI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000012     10 L652-CDDIVISI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000013*                       DTCARORD                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000014     10 L652-DTCARORD        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000015*                       CODDIVIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000016     10 L652-CODDIVIS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000017*                       TIPSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000018     10 L652-TIPSERVI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000019*                       FLAGAUTO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000020     10 L652-FLAGAUTO        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000021*                       FLAGGIVA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000022     10 L652-FLAGGIVA        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000023*                       CONTODCE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000024     10 L652-CONTODCE        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025*                       DTEVAORD                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000026     10 L652-DTEVAORD        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000027*                       AANUMFAT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000028     10 L652-AANUMFAT        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000029*                       DTFATTUR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000030     10 L652-DTFATTUR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000031*                       NRPREATT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000032     10 L652-NRPREATT        PIC X(10).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000033*                       DTPREATT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000034     10 L652-DTPREATT        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000035*                       DTCREAZI                                  
000036     10 L652-DTCREAZI        PIC X(8).                            
000037*                       DTULTVAR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000038     10 L652-DTULTVAR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000039*                       CODUTVAR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000040     10 L652-CODUTVAR        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000041*                       DTANNULL                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000042     10 L652-DTANNULL        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000043*                       SOCIEMER                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000044     10 L652-SOCIEMER        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000045*                       DATAESTR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000046     10 L652-DATAESTR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000047*                       AAMMCOMP                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000048     10 L652-AAMMCOMP        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000049*                       FLAGSOSP                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000050     10 L652-FLAGSOSP        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000051*                       CODUTEVB                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000052     10 L652-CODUTEVB        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000053*                       ESENTIVA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000054     10 L652-ESENTIVA        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000055*                       FLORDIVB                                  
000056     10 L652-FLORDIVB        PIC X(1).                            
000057******************************************************************
000058* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 26      *
000059******************************************************************
      *<<((file: FDLOG652))
001075*--------------------------------DLOGI.TRIGORDILOGI               
001076 01  FILLER                      PIC X(8) VALUE 'FDLOG653'.       
001077*    EXEC SQL INCLUDE FDLOG653 END-EXEC.                          
      *>>((file: FDLOG653))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TRIGORDILOGI              *
000003******************************************************************
000004 01  DCLTRIGORDILOGI.                                             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 L653-AANUMORD        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000006     10 L653-NRRIGORD        PIC S9(5)V USAGE COMP-3.             
000007     10 L653-CODSERVI        PIC X(6).                            
000008     10 L653-UNMISURA        PIC X(2).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000009     10 L653-QTAORDIN        PIC S9(7)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000010     10 L653-PREZZORD        PIC S9(7)V9(4) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000011     10 L653-IMPORDIN        PIC S9(11)V9(2) USAGE COMP-3.        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000012     10 L653-NOTENOTE        PIC X(40).                           
000013     10 L653-CENCOSTD        PIC X(5).                            
000014     10 L653-CENCOSTA        PIC X(5).                            
000015     10 L653-RIFECLIE        PIC X(15).                           
000016     10 L653-DTCREAZI        PIC X(8).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000017     10 L653-DTULTVAR        PIC X(8).                            
000018     10 L653-CODUTVAR        PIC X(6).                            
000019     10 L653-DTANNULL        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000020     10 L653-IMPORIVA        PIC S9(11)V9(2) USAGE COMP-3.        
000021******************************************************************
000022* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 16      *
000023******************************************************************
      *<<((file: FDLOG653))
001078*--------------------------------DLOGI.TRIFORDILOGI               
001079 01  FILLER                      PIC X(8) VALUE 'FDLOG430'.       
001080*    EXEC SQL INCLUDE FDLOG430 END-EXEC.                          
      *>>((file: FDLOG430))
000001******************************************************************
000002* DCLGEN TABLE(DLOGISTI.TRIFORDILOGI)                            *
000003******************************************************************
000004 01  DCLTRIFORDILOGI.                                             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 L430-AANUMORD        PIC X(08).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000006     10 L430-NUMPROG3        PIC S9(3)V USAGE COMP-3.             
000007     10 L430-RIFORDIN        PIC X(10).                           
000008     10 L430-DTCREAZI        PIC X(8).                            
000009     10 L430-DTULTVAR        PIC X(8).                            
000010     10 L430-CODUTVAR        PIC X(6).                            
000011******************************************************************
      *<<((file: FDLOG430))
001081*--------------------------------DLOGI.TSERVIZI                   
001082 01  FILLER                      PIC X(8) VALUE 'FDLOG651'.       
001083*    EXEC SQL INCLUDE FDLOG651 END-EXEC.                          
      *>>((file: FDLOG651))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TSERVIZI                  *
000003******************************************************************
000004 01  DCLTSERVIZI.                                                 
000005*                       CODSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006     10 L651-CODSERVI        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007*                       DESSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000008     10 L651-DESSERVI        PIC X(40).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000009*                       UNMISURA                                  
000010     10 L651-UNMISURA        PIC X(2).                            
000011*                       TIPSERVI                                  
000012     10 L651-TIPSERVI        PIC X(1).                            
000013*                       DTCREAZI                                  
000014     10 L651-DTCREAZI        PIC X(8).                            
000015*                       DTULTVAR                                  
000016     10 L651-DTULTVAR        PIC X(8).                            
000017*                       CODUTVAR                                  
000018     10 L651-CODUTVAR        PIC X(6).                            
000019*                       CONTODCD                                  
000020     10 L651-CONTODCD        PIC X(6).                            
000021*                       CONTODCA                                  
000022     10 L651-CONTODCA        PIC X(6).                            
000023*                       CENCOSTA                                  
000024     10 L651-CENCOSTA        PIC X(5).                            
000025     10 L651-ESENTIVA        PIC X(1).                            
000026     10 L651-CONTPROV        PIC X(6).                            
000027******************************************************************
000028* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 12      *
000029******************************************************************
      *<<((file: FDLOG651))
001084*--------------------------------DANAGRAF.TDATEELAB               
001085 01  FILLER                      PIC X(8) VALUE 'FDANA847'.       
001086*    EXEC SQL INCLUDE FDANA847 END-EXEC.                          
      *>>((file: FDANA847))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TDATEELAB)                               *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA847))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        QUOTE                                                   *
000007* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000008******************************************************************
000009     
      *EXEC SQL DECLARE DANAGRAF.TDATEELAB TABLE                    
000010*     ( SIGLDATA                       CHAR(8) NOT NULL,           
000011*       TIPODATA                       CHAR(1) NOT NULL,           
000012*       DTINELAB                       CHAR(8) NOT NULL,           
000013*       TMINELAB                       CHAR(6) NOT NULL,           
000014*       DTFIELAB                       CHAR(8) NOT NULL,           
000015*       TMFIELAB                       CHAR(6) NOT NULL,           
000016*       DESCDATA                       CHAR(25) NOT NULL,          
000017*       FILLA200                       CHAR(200) NOT NULL,         
000018*       FILLB200                       CHAR(200) NOT NULL,         
000019*       FILLC200                       CHAR(200) NOT NULL,         
000020*       FILLD200                       CHAR(200) NOT NULL,         
000021*       FILLE200                       CHAR(200) NOT NULL,         
000022*       FILLF200                       CHAR(200) NOT NULL,         
000023*       FILLG200                       CHAR(200) NOT NULL,         
000024*       FILLH200                       CHAR(200) NOT NULL,         
000025*       FILLI200                       CHAR(200) NOT NULL,         
000026*       FILLJ200                       CHAR(200) NOT NULL,         
000027*       FILLK200                       CHAR(200) NOT NULL,         
000028*       FILLL200                       CHAR(200) NOT NULL,         
000029*       FILLM200                       CHAR(200) NOT NULL,         
000030*       FILLN200                       CHAR(200) NOT NULL,         
000031*       FILLO200                       CHAR(200) NOT NULL          
000032*     ) END-EXEC
                                                                        
000033******************************************************************
000034* COBOL DECLARATION FOR TABLE DANAGRAF.TDATEELAB                 *
000035******************************************************************
000036 01  DCLTDATEELAB.                                                
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000037     10 A847-SIGLDATA        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000038     10 A847-TIPODATA        PIC X(1).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000039     10 A847-DTINELAB        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000040     10 A847-TMINELAB        PIC X(6).                            
000041     10 A847-DTFIELAB        PIC X(8).                            
000042     10 A847-TMFIELAB        PIC X(6).                            
000043     10 A847-DESCDATA        PIC X(25).                           
000044     10 A847-FILLA200        PIC X(200).                          
000045     10 A847-FILLB200        PIC X(200).                          
000046     10 A847-FILLC200        PIC X(200).                          
000047     10 A847-FILLD200        PIC X(200).                          
000048     10 A847-FILLE200        PIC X(200).                          
000049     10 A847-FILLF200        PIC X(200).                          
000050     10 A847-FILLG200        PIC X(200).                          
000051     10 A847-FILLH200        PIC X(200).                          
000052     10 A847-FILLI200        PIC X(200).                          
000053     10 A847-FILLJ200        PIC X(200).                          
000054     10 A847-FILLK200        PIC X(200).                          
000055     10 A847-FILLL200        PIC X(200).                          
000056     10 A847-FILLM200        PIC X(200).                          
000057     10 A847-FILLN200        PIC X(200).                          
000058     10 A847-FILLO200        PIC X(200).                          
000059******************************************************************
000060* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 22      *
000061******************************************************************
      *<<((file: FDANA847))
001087*--------------------------------DANAGRAF.TCLIENTI                
001088 01  FILLER                      PIC X(8) VALUE 'FDANA901'.       
001089*    EXEC SQL INCLUDE FDANA901 END-EXEC.                          
      *>>((file: FDANA901))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TCLIENTI                  *
000003******************************************************************
000004 01  DCLTCLIENTI.                                                 
000005*                       CODCLIEN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006     10 A901-CODCLIEN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007*                       STATCLIE                                  
000008     10 A901-STATCLIE        PIC X(1).                            
000009*                       GENECLIE                                  
000010     10 A901-GENECLIE        PIC X(1).                            
000011*                       TIPOCLIE                                  
000012     10 A901-TIPOCLIE        PIC X(1).                            
000013*                       TIPOCONS                                  
000014     10 A901-TIPOCONS        PIC X(1).                            
000015*                       CLIFOCON                                  
000016     10 A901-CLIFOCON        PIC X(5).                            
000017*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000018     10 A901-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000019*                       CAPOCONT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000020     10 A901-CAPOCONT        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000021*                       CODFISCA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000022     10 A901-CODFISCA        PIC X(16).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000023*                       ESENTIVA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000024     10 A901-ESENTIVA        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025*                       NUMESIVA                                  
000026     10 A901-NUMESIVA        PIC X(5).                            
000027*                       DATESIVA                                  
000028     10 A901-DATESIVA        PIC X(8).                            
000029*                       UFFICIVA                                  
000030     10 A901-UFFICIVA        PIC X(18).                           
000031*                       IMPESIVA                                  
000032     10 A901-IMPESIVA        PIC S9(4)V USAGE COMP-3.             
000033*                       BANCAPPO                                  
000034     10 A901-BANCAPPO        PIC X(3).                            
000035*                       NOMBANCL                                  
000036     10 A901-NOMBANCL        PIC X(114).                          
000037*                       CONTOCOR                                  
000038     10 A901-CONTOCOR        PIC X(13).                           
000039*                       ASSOBANC                                  
000040     10 A901-ASSOBANC        PIC X(5).                            
000041*                       AVVIBANC                                  
000042     10 A901-AVVIBANC        PIC X(5).                            
000043*                       CLIEFATT                                  
000044     10 A901-CLIEFATT        PIC X(5).                            
000045*                       PAESFATT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000046     10 A901-PAESFATT        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000047*                       RAGFATTU                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000048     10 A901-RAGFATTU        PIC X(24).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000049*                       ESRAGFAT                                  
000050     10 A901-ESRAGFAT        PIC X(24).                           
000051*                       INDFATTU                                  
000052     10 A901-INDFATTU        PIC X(24).                           
000053*                       ESINDFAT                                  
000054     10 A901-ESINDFAT        PIC X(24).                           
000055*                       CITFATTU                                  
000056     10 A901-CITFATTU        PIC X(18).                           
000057*                       ESCITFAT                                  
000058     10 A901-ESCITFAT        PIC X(18).                           
000059*                       CAPFATTU                                  
000060     10 A901-CAPFATTU        PIC X(5).                            
000061*                       PAESMERC                                  
000062     10 A901-PAESMERC        PIC X(3).                            
000063*                       RAGMERCE                                  
000064     10 A901-RAGMERCE        PIC X(24).                           
000065*                       ESRAGMER                                  
000066     10 A901-ESRAGMER        PIC X(24).                           
000067*                       INDMERCE                                  
000068     10 A901-INDMERCE        PIC X(24).                           
000069*                       ESINDMER                                  
000070     10 A901-ESINDMER        PIC X(24).                           
000071*                       CITMERCE                                  
000072     10 A901-CITMERCE        PIC X(18).                           
000073*                       ESCITMER                                  
000074     10 A901-ESCITMER        PIC X(18).                           
000075*                       CAPMERCE                                  
000076     10 A901-CAPMERCE        PIC X(5).                            
000077*                       ZONAMERC                                  
000078     10 A901-ZONAMERC        PIC X(2).                            
000079*                       TELCLIEN                                  
000080     10 A901-TELCLIEN        PIC X(20).                           
000081*                       TLXCLIEN                                  
000082     10 A901-TLXCLIEN        PIC X(20).                           
000083*                       FAXCLIEN                                  
000084     10 A901-FAXCLIEN        PIC X(20).                           
000085*                       RIFEMIRO                                  
000086     10 A901-RIFEMIRO        PIC X(11).                           
000087*                       PAESORDI                                  
000088     10 A901-PAESORDI        PIC X(3).                            
000089*                       ZONAORDI                                  
000090     10 A901-ZONAORDI        PIC X(2).                            
000091*                       DATVASTA                                  
000092     10 A901-DATVASTA        PIC X(8).                            
000093*                       ATTENZDI                                  
000094     10 A901-ATTENZDI        PIC X(24).                           
000095*                       CONDPAGA                                  
000096     10 A901-CONDPAGA        PIC X(3).                            
000097*                       MMESCLU1                                  
000098     10 A901-MMESCLU1        PIC S9(2)V USAGE COMP-3.             
000099*                       MMESCLU2                                  
000100     10 A901-MMESCLU2        PIC S9(2)V USAGE COMP-3.             
000101*                       GGSCATRA                                  
000102     10 A901-GGSCATRA        PIC S9(2)V USAGE COMP-3.             
000103*                       NUMGGVIA                                  
000104     10 A901-NUMGGVIA        PIC S9(2)V USAGE COMP-3.             
000105*                       TIPOTRAT                                  
000106     10 A901-TIPOTRAT        PIC X(1).                            
000107*                       ALTERSPE                                  
000108     10 A901-ALTERSPE        PIC X(1).                            
000109*                       CODILING                                  
000110     10 A901-CODILING        PIC X(1).                            
000111*                       DTULTVAR                                  
000112     10 A901-DTULTVAR        PIC X(8).                            
000113*                       TIPCLCAR                                  
000114     10 A901-TIPCLCAR        PIC X(1).                            
000115*                       SPETRASP                                  
000116     10 A901-SPETRASP        PIC X(1).                            
000117*                       DTCREAZI                                  
000118     10 A901-DTCREAZI        PIC X(8).                            
000119*                       CODDIVIS                                  
000120     10 A901-CODDIVIS        PIC X(2).                            
000121*                       CDIVACEE                                  
000122     10 A901-CDIVACEE        PIC X(14).                           
000123*                       ZONAFATT                                  
000124     10 A901-ZONAFATT        PIC X(2).                            
000125*                       CLASDOGA                                  
000126     10 A901-CLASDOGA        PIC X(1).                            
000127*                       INTNCLIE                                  
000128     10 A901-INTNCLIE        PIC X(50).                           
000129*                       CAPOCOMM                                  
000130     10 A901-CAPOCOMM        PIC X(5).                            
000131*                       PRIORITA                                  
000132     10 A901-PRIORITA        PIC X(1).                            
000133*                       BULSTATX                                  
000134     10 A901-BULSTATX        PIC X(13).                           
000135*                       CODUTVAR                                  
000136     10 A901-CODUTVAR        PIC X(6).                            
000137*                       CODUTCRE                                  
000138     10 A901-CODUTCRE        PIC X(6).                            
000139*                       CDRESCON                                  
000140     10 A901-CDRESCON        PIC X(2).                            
000141*                       CENCOACQ                                  
000142     10 A901-CENCOACQ        PIC X(5).                            
000143*                       CAPOSOCI                                  
000144     10 A901-CAPOSOCI        PIC X(5).                            
000145*                       CDFISCAL                                  
000146     10 A901-CDFISCAL        PIC X(16).                           
000147*                       CONDPACA                                  
000148     10 A901-CONDPACA        PIC X(3).                            
000149*                       CODXIBAN                                  
000150     10 A901-CODXIBAN        PIC X(4).                            
000151*                       CODXXCIN                                  
000152     10 A901-CODXXCIN        PIC X(2).                            
000153*                       ZIPFATTU                                  
000154     10 A901-ZIPFATTU        PIC X(15).                           
000155*                       ZIPMERCE                                  
000156     10 A901-ZIPMERCE        PIC X(15).                           
000157*                       TIPOLIST                                  
000158     10 A901-TIPOLIST        PIC X(1).                            
000159*                       SWIFTCOD                                  
000160     10 A901-SWIFTCOD        PIC X(11).                           
000161*                       PERCEIVA                                  
000162     10 A901-PERCEIVA        PIC S9(3)V9(2) USAGE COMP-3.         
000163*                       DTVALIVA                                  
000164     10 A901-DTVALIVA        PIC X(8).                            
000165*                       CLASSCLI                                  
000166     10 A901-CLASSCLI        PIC X(1).                            
000167*                       RATINGCO                                  
000168     10 A901-RATINGCO        PIC X(3).                            
000169*                       RISCHCLI                                  
000170     10 A901-RISCHCLI        PIC X(1).                            
000171*                                                                 
000172     10 A901-NRPROIVA        PIC X(30).                           
000173*                                                                 
000174     10 A901-IMPESNEW        PIC S9(9)V9(2) USAGE COMP-3.         
000175     10 A901-TIPOSTAG        PIC X(1).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000176     10 A901-FLFATELE        PIC X(1).                            
000177     10 A901-CDDESTFE        PIC X(7).                            
000178     10 A901-INPECCLI        PIC X(50).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000179******************************************************************
000180* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 88      *
000181******************************************************************
      *<<((file: FDANA901))
001090*--------------------------------DANAGRAF.TSOCIETA                
001091 01  FILLER                      PIC X(8) VALUE 'FDANA531'.       
001092*    EXEC SQL INCLUDE FDANA531 END-EXEC.                          
      *>>((file: FDANA531))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TSOCIETA                  *
000003******************************************************************
000004 01  DCLTSOCIETA.                                                 
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 A531-CODSOCIE        PIC X(2).                            
000006     10 A531-NOMSOCIE        PIC X(23).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007     10 A531-CODFORNI        PIC X(5).                            
000008     10 A531-TASSINTE        PIC S9(3)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000009     10 A531-CODPAESE        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000010     10 A531-NRGGRISC        PIC S9(3)V USAGE COMP-3.             
000011     10 A531-CODPIANO        PIC X(2).                            
000012     10 A531-CITTASOC        PIC X(18).                           
000013     10 A531-FLPAGIVA        PIC X(1).                            
000014     10 A531-FLFATACQ        PIC X(1).                            
000015     10 A531-CODAZIEN        PIC X(5).                            
000016     10 A531-FLIVATRA        PIC X(1).                            
000017     10 A531-CODDIVIS        PIC X(2).                            
000018     10 A531-COSTINTE        PIC S9(3)V9(2) USAGE COMP-3.         
000019     10 A531-FLCONTAB        PIC X(1).                            
000020     10 A531-FLAGMAGA        PIC X(1).                            
000021     10 A531-RAGSOCIE        PIC X(50).                           
000022     10 A531-SOCIECON        PIC X(2).                            
000023     10 A531-DTCREAZI        PIC X(8).                            
000024     10 A531-DTULTVAR        PIC X(8).                            
000025     10 A531-CODUTVAR        PIC X(6).                            
000026     10 A531-INDLEGAL        PIC X(35).                           
000027     10 A531-CAPLEGAL        PIC X(5).                            
000028     10 A531-CITLEGAL        PIC X(18).                           
000029     10 A531-CODFISCA        PIC X(16).                           
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000030     10 A531-CODDIVRI        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000031     10 A531-SOCIEGTM        PIC X(2).                            
000032     10 A531-GENEFATT        PIC X(1).                            
000033     10 A531-FLAGATTI        PIC X(1).                            
000034     10 A531-DIVISOLD        PIC X(2).                            
000035     10 A531-DTFINOLD        PIC X(8).                            
000036     10 A531-DIVRIOLD        PIC X(2).                            
000037     10 A531-DIVIRIFA        PIC X(2).                            
000038     10 A531-FLEURUSA        PIC X(1).                            
000039     10 A531-FLAGLIMI        PIC X(1).                            
000040     10 A531-FLFILIAL        PIC X(1).                            
000041     10 A531-FLPRESEN        PIC X(1).                            
000042     10 A531-CODSOCPA        PIC X(1).                            
000043     10 A531-FLBOLGVB        PIC X(1).                            
000044     10 A531-FLSTCART        PIC X(1).                            
000045     10 A531-FLDIPEST        PIC X(1).                            
000046     10 A531-CODFIRMA        PIC X(8).                            
000047     10 A531-DESFIRMA        PIC X(24).                           
000048     10 A531-CDSOCJDE        PIC X(5).                            
000049     10 A531-CODFORNV        PIC X(5).                            
000050     10 A531-CODFORNA        PIC X(5).                            
000051     10 A531-IMPCCASO        PIC S9(13) COMP-3.                   
000052     10 A531-TRIBCCIA        PIC X(10).                           
000053     10 A531-PROLEGAL        PIC X(2).                            
000054     10 A531-FLSOCSAP        PIC X(1).                            
000055     10 A531-DIVIXLAV        PIC X(2).                            
000056******************************************************************
000057* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 51      *
000058******************************************************************
      *<<((file: FDANA531))
001093*--------------------------------DANAGRAF.TDIVISE                 
001094 01  FILLER                      PIC X(8) VALUE 'FDANA963'.       
001095*    EXEC SQL INCLUDE FDANA963 END-EXEC.                          
      *>>((file: FDANA963))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TDIVISE                   *
000003******************************************************************
000004 01  DCLTDIVISE.                                                  
000005*                       SIGLADIV                                  
000006     10 A963-SIGLADIV        PIC X(3).                            
000007*                       CAMBIODV                                  
000008     10 A963-CAMBIODV        PIC S9(5)V9(6) USAGE COMP-3.         
000009*                       DESCDIVI                                  
000010     10 A963-DESCDIVI        PIC X(20).                           
000011*                       CODDIVIS                                  
000012     10 A963-CODDIVIS        PIC X(2).                            
000013*                       DECIDIVI                                  
000014     10 A963-DECIDIVI        PIC X(1).                            
000015*                       DIVIBANC                                  
000016     10 A963-DIVIBANC        PIC X(3).                            
000017*                       DIVIPREZ                                  
000018     10 A963-DIVIPREZ        PIC X(1).                            
000019*                       CODDIVRI                                  
000020     10 A963-CODDIVRI        PIC X(2).                            
000021*                       RAPPCAMB                                  
000022     10 A963-RAPPCAMB        PIC S9(5)V USAGE COMP-3.             
000023*                       CODDIGTM                                  
000024     10 A963-CODDIGTM        PIC X(2).                            
000025*                       FLAGEURO                                  
000026     10 A963-FLAGEURO        PIC X(1).                            
000027*                       SLDIVBAN                                  
000028     10 A963-SLDIVBAN        PIC X(3).                            
000029*                       CDDIVSCA                                  
000030     10 A963-CDDIVSCA        PIC X(2).                            
000031*                       FLDIVINT                                  
000032     10 A963-FLDIVINT        PIC X(1).                            
000033     10 A963-VBDIVSCA        PIC X(2).                            
000034******************************************************************
000035* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 15      *
000036******************************************************************
      *<<((file: FDANA963))
001096*--------------------------------DANAGRAF.TMESSAGGI               
001097 01  FILLER                      PIC X(8) VALUE 'FDANA846'.       
001098*    EXEC SQL INCLUDE FDANA846 END-EXEC.                          
      *>>((file: FDANA846))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TMESSAGGI)                               *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA846))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        QUOTE                                                   *
000007* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000008******************************************************************
000009     
      *EXEC SQL DECLARE DANAGRAF.TMESSAGGI TABLE                    
000010*     ( CODERROR                       CHAR(5) NOT NULL,           
000011*       CODILING                       CHAR(1) NOT NULL,           
000012*       MSGERROR                       CHAR(60) NOT NULL,          
000013*       TIPOMESS                       CHAR(1) NOT NULL,           
000014*       DTCREAZI                       CHAR(8) NOT NULL,           
000015*       DTULTVAR                       CHAR(8) NOT NULL,           
000016*       CODUTVAR                       CHAR(6) NOT NULL            
000017*     ) END-EXEC
                                                                        
000018******************************************************************
000019* COBOL DECLARATION FOR TABLE DANAGRAF.TMESSAGGI                 *
000020******************************************************************
000021 01  DCLTMESSAGGI.                                                
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000022     10 A846-CODERROR        PIC X(5).                            
000023     10 A846-CODILING        PIC X(1).                            
000024     10 A846-MSGERROR        PIC X(60).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025     10 A846-TIPOMESS        PIC X(1).                            
000026     10 A846-DTCREAZI        PIC X(8).                            
000027     10 A846-DTULTVAR        PIC X(8).                            
000028     10 A846-CODUTVAR        PIC X(6).                            
000029******************************************************************
000030* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 7       *
000031******************************************************************
      *<<((file: FDANA846))
001099*--------------------------------DANAGRAF.TDATARIO                
001100 01  FILLER                      PIC X(8) VALUE 'FDANA973'.       
001101*    EXEC SQL INCLUDE FDANA973 END-EXEC.                          
      *>>((file: FDANA973))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TDATARIO)                                *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA973))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(A973-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DANAGRAF.TDATARIO TABLE                     
000012*     ( DTGIORNO                       CHAR(8) NOT NULL,           
000013*       PRGIORNO                       DECIMAL(7, 0) NOT NULL,     
000014*       NUMGIORN                       CHAR(3) NOT NULL,           
000015*       NUMSETTI                       CHAR(2) NOT NULL,           
000016*       NRGGSETT                       CHAR(1) NOT NULL,           
000017*       DTINISET                       CHAR(8) NOT NULL,           
000018*       DTFINSET                       CHAR(8) NOT NULL,           
000019*       DTINIMES                       CHAR(8) NOT NULL,           
000020*       DTFINMES                       CHAR(8) NOT NULL,           
000021*       ANNOSETT                       CHAR(6) NOT NULL,           
000022*       FLAGFEST                       CHAR(1) NOT NULL            
000023*     ) END-EXEC
                                                                        
000024******************************************************************
000025* COBOL DECLARATION FOR TABLE DANAGRAF.TDATARIO                  *
000026******************************************************************
000027 01  DCLTDATARIO.                                                 
000028*                       DTGIORNO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000029     10 A973-DTGIORNO        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000030*                       PRGIORNO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000031     10 A973-PRGIORNO        PIC S9(7)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000032*                       NUMGIORN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000033     10 A973-NUMGIORN        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000034*                       NUMSETTI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000035     10 A973-NUMSETTI        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000036*                       NRGGSETT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000037     10 A973-NRGGSETT        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000038*                       DTINISET                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000039     10 A973-DTINISET        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000040*                       DTFINSET                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000041     10 A973-DTFINSET        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000042*                       DTINIMES                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000043     10 A973-DTINIMES        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000044*                       DTFINMES                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000045     10 A973-DTFINMES        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000046*                       ANNOSETT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000047     10 A973-ANNOSETT        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000048*                       FLAGFEST                                  
000049     10 A973-FLAGFEST        PIC X(1).                            
000050******************************************************************
000051* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 11      *
000052******************************************************************
      *<<((file: FDANA973))
001102*--------------------------------'DATEDATE'                       
001103 01  FILLER                      PIC X(8) VALUE 'FDANA082'.       
001104*    EXEC SQL INCLUDE FDANA082 END-EXEC.                          
      *>>((file: FDANA082))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.VANAGRAF_082)                            *
000003*        LIBRARY(PROG169.MTCSV440.DCLGEN(FDANA082))              *
000004*        LANGUAGE(COBOL)                                         *
000005*        QUOTE                                                   *
000006* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000007******************************************************************
000008     
      *EXEC SQL DECLARE DANAGRAF.VANAGRAF_082 TABLE                 
000009*     ( DATEDATE                       CHAR(10) NOT NULL           
000010*     ) END-EXEC
                                                                        
000011******************************************************************
000012* COBOL DECLARATION FOR TABLE DANAGRAF.VANAGRAF_082              *
000013******************************************************************
000014 01  DCLVANAGRAF-082.                                             
000015  10 A082-DATEDATE             PIC X(10).                         
000016******************************************************************
000017* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 1       *
000018******************************************************************
      *<<((file: FDANA082))
001105*--------------------------------DTRASP.TNETMOVEREXPO             
001106 01  FILLER                      PIC X(8) VALUE 'FDTRA358'.       
001107*    EXEC SQL INCLUDE FDTRA358 END-EXEC.                          
      *>>((file: FDTRA358))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DTRASP.TNETMOVEREXPO               *
000003******************************************************************
000004 01  DCLTNETMOVEREXPO.                                            
000005     10 T358-SOCIEFAT        PIC X(2).                            
000006     10 T358-NRPREFAT        PIC X(10).                           
000007     10 T358-DTPREFAT        PIC X(8).                            
000008     10 T358-CODFORNI        PIC X(5).                            
000009     10 T358-CODSOCIE        PIC X(2).                            
000010     10 T358-AANUMFAT        PIC X(20).                           
000011     10 T358-DTFATTUR        PIC X(8).                            
000012     10 T358-NUMPROG5        PIC S9(5)V USAGE COMP-3.             
000013     10 T358-MERCEMAG        PIC X(2).                            
000014     10 T358-PROLOMER        PIC X(2).                            
000015     10 T358-CODLINEA        PIC X(2).                            
000016     10 T358-CENCOSTO        PIC X(5).                            
000017     10 T358-CDTPCOST        PIC X(10).                           
000018     10 T358-CODDIVIS        PIC X(2).                            
000019     10 T358-IMPCOSTO        PIC S9(9)V9(2) USAGE COMP-3.         
000020     10 T358-DTCREAZI        PIC X(8).                            
000021     10 T358-DTULTVAR        PIC X(8).                            
000022     10 T358-CODUTVAR        PIC X(6).                            
000023     10 T358-TIPORECO        PIC X(4).                            
000024     10 T358-CONTODCE        PIC X(6).                            
000025     10 T358-STPREFAT        PIC X(3).                            
000026     10 T358-DTSPEDIZ        PIC X(8).                            
000027     10 T358-DATATRAS        PIC X(8).                            
000028     10 T358-CENCOTRA        PIC X(5).                            
000029     10 T358-NRPREATT        PIC X(10).                           
000030     10 T358-DTPREATT        PIC X(8).                            
000031     10 T358-STPREATT        PIC X(3).                            
000032     10 T358-IMCOSATT        PIC S9(9)V9(2) USAGE COMP-3.         
000033     10 T358-NRDOCCOT        PIC X(10).                           
000034     10 T358-NRRIGORD        PIC S9(3)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000035     10 T358-AANUMORD        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000036******************************************************************
000037* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 31      *
000038******************************************************************
      *<<((file: FDTRA358))
001108*--------------------------------DANAGRAF.TRIGESENCLIE            
001109 01  FILLER                      PIC X(8) VALUE 'FDANAT67'.       
001110*    EXEC SQL INCLUDE FDANAT67 END-EXEC.                          
      *>>((file: FDANAT67))
000001******************************************************************
000002*COBOL DECLARATION FOR TABLE DANAGRAF.TRIGESENCLIE               *
000003******************************************************************
000004 01 DCLTRIGESENCLIE.                                              
000005    10 AT67-AANUMMOV             PIC X(8).                        
000006    10 AT67-CODSOCIE             PIC X(2).                        
000007    10 AT67-CDMOVCON             PIC X(1).                        
000008    10 AT67-AANUMFAT             PIC X(8).                        
000009    10 AT67-DTFATTUR             PIC X(8).                        
000010    10 AT67-CODDIVIS             PIC X(2).                        
000011    10 AT67-INDSEGNO             PIC X(1).                        
000012    10 AT67-VALRFATT             PIC S9(9)V9(2) USAGE COMP-3.     
000013    10 AT67-DTCREAZI             PIC X(8).                        
000014    10 AT67-DTULTVAR             PIC X(8).                        
000015    10 AT67-CODUTVAR             PIC X(6).                        
      *<<((file: FDANAT67))
001111*--------------------------------DANAGRAF.TESENCLIE               
001112 01  FILLER                      PIC X(8) VALUE 'FDANAT66'.       
001113*    EXEC SQL INCLUDE FDANAT66 END-EXEC.                          
      *>>((file: FDANAT66))
000001******************************************************************
000002*COBOL DECLARATION FOR TABLE DANAGRAF.TESENCLIE                  *
000003******************************************************************
000004 01 DCLTESENCLIE.                                                 
000005    10 AT66-AANUMMOV             PIC X(8).                        
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006    10 AT66-CODCLIEN             PIC X(5).                        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007    10 AT66-ESENTIVA             PIC X(1).                        
000008    10 AT66-NUMESIVA             PIC X(5).                        
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000009    10 AT66-DATESIVA             PIC X(8).                        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000010    10 AT66-UFFICIVA             PIC X(18).                       
000011    10 AT66-NRPROIVA             PIC X(30).                       
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000012    10 AT66-CODDIVIS             PIC X(02).                       
000013    10 AT66-IMPESNEW             PIC S9(9)V9(2) USAGE COMP-3.     
000014    10 AT66-IMPOFATT             PIC S9(9)V9(2) USAGE COMP-3.     
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000015    10 AT66-DATASALD             PIC X(8).                        
000016    10 AT66-DTCREAZI             PIC X(8).                        
000017    10 AT66-DTULTVAR             PIC X(8).                        
000018    10 AT66-CODUTVAR             PIC X(6).                        
      *<<((file: FDANAT66))
001114*--------------------------------DCDTGG                           
001115 01  FILLER                      PIC X(8) VALUE '**DCDTGG'.       
001116*    EXEC SQL INCLUDE DCDTGG   END-EXEC.                          
      *>>((file: DCDTGG))
000001*----------------------------------------------------------------*
000002*----               AREA PER SUBROUTINE SRDTGG               ----*
000003*----------------------------------------------------------------*
000004 01  DCDTGG.                                                      
000005*-------------------------------------------- CAMPI DI INPUT      
000006     02 DTGG-DTRICHIE         PIC X(08)         VALUE SPACES.     
000007     02 DTGG-PRRICHIE         PIC S9(7) COMP-3  VALUE +0.         
000008                                                                  
000009*-------------------------------------------- CAMPI DI OUTPUT     
000010     02 DTGG-DTGIORNO.                                            
000011        03 DTGG-SAGIORNO.                                         
000012           04 DTGG-SSGIORNO   PIC XX.                             
000013           04 DTGG-AAGIORNO   PIC XX.                             
000014        03 DTGG-MMGIORNO      PIC XX.                             
000015        03 DTGG-GGGIORNO      PIC XX.                             
000016     02 DTGG-PRGIORNO         PIC S9(7) COMP-3.                   
000017     02 DTGG-NUMSETTI         PIC X(02).                          
000018     02 DTGG-NUMGIORN         PIC X(03).                          
000019     02 DTGG-NRGGSETT         PIC X(01).                          
000020     02 DTGG-DTINISET.                                            
000021        03 DTGG-SAINISET.                                         
000022           04 DTGG-SSINISET   PIC XX.                             
000023           04 DTGG-AAINISET   PIC XX.                             
000024        03 DTGG-MMINISET      PIC XX.                             
000025        03 DTGG-GGINISET      PIC XX.                             
000026     02 DTGG-DTFINSET         PIC X(08).                          
000027     02 DTGG-DTINIMES         PIC X(08).                          
000028     02 DTGG-DTFINMES         PIC X(08).                          
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000029     02 DTGG-CURRENDT         PIC X(08).                          
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000030     02 DTGG-DTCURREN.                                            
000031        03 DTGG-AACURREN      PIC X(04).                          
000032        03 DTGG-MMCURREN      PIC X(02).                          
000033        03 DTGG-GGCURREN      PIC X(02).                          
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000034     02 DTGG-DATAGIOR         PIC X(10).                          
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000035     02 DTGG-ANNOSETT.                                            
000036        03 DTGG-SSAASETT      PIC X(04).                          
000037        03 DTGG-SETTSETT      PIC X(02).                          
000038     02 DTGG-FILLER4          PIC X(04).                          
000039     02 DTGG-RETUCODE         PIC X(04).                          
000040*----------------------------------------------------------------*
      *<<((file: DCDTGG))
001117*    RICERCA PER CODICE CLIENTE                                   
001119     
      *EXEC SQL 
      *DECLARE POINTER1  CURSOR FOR                            
001120*           SELECT A.AANUMORD, A.CODCLIEN                          
001121*                 ,A.CODSOCIE, A.CDDIVISI                          
001122*                 ,A.AAMMCOMP, A.CODDIVIS                          
001123*                 ,A.TIPSERVI, A.FLAGAUTO                          
001124*                 ,A.FLAGGIVA, A.CONTODCE                          
001125*                 ,A.DTEVAORD, A.SOCIEMER                          
001126*                 ,A.AANUMFAT, A.DTFATTUR                          
001127*                 ,A.NRPREATT, A.DTPREATT                          
001128*                 ,A.DATAESTR, A.FLAGSOSP                          
001129*                 ,A.CODUTEVB, A.DTCARORD                          
001130*                 ,A.ESENTIVA                                      
001131*             FROM DLOGISTI.TORDILOGI    A                         
001132*            WHERE A.CODSOCIE = :L652-CODSOCIE                     
001133*              AND A.CODCLIEN = :L652-CODCLIEN                     
001134*              AND A.CONTODCE LIKE :WS-CONTODCE                    
001135*              AND A.TIPSERVI BETWEEN :MIN-TIPSERVI                
001136*                                 AND :MAX-TIPSERVI                
001137*              AND A.AAMMCOMP BETWEEN :MIN-AAMMCOMP                
001138*                                 AND :MAX-AAMMCOMP                
001139*              AND A.DTEVAORD BETWEEN :MIN-DTEVAORD                
001140*                                 AND :MAX-DTEVAORD                
001141*              AND A.DTFATTUR BETWEEN :MIN-DTFATTUR                
001142*                                 AND :MAX-DTFATTUR                
001143*              AND A.FLAGSOSP BETWEEN :MIN-FLAGSOSP                
001144*                                 AND :MAX-FLAGSOSP                
001145*              AND A.DTANNULL = ' '                                
001146*              AND EXISTS (SELECT B.CODSERVI                       
001147*                            FROM DLOGISTI.TRIGORDILOGI B          
001148*                       LEFT JOIN DLOGISTI.TSERVIZI S              
001149*                              ON S.CODSERVI = B.CODSERVI          
001150*                             AND S.DESSERVI LIKE :WS-DESSERVI     
001151*                           WHERE A.AANUMORD = B.AANUMORD          
001152*                             AND B.DTANNULL = ' '                 
001153*                             AND B.CODSERVI LIKE :WS-CODSERVI     
001154*                             AND B.CENCOSTD LIKE :WS-CENCOSTD     
001155*                             AND B.CENCOSTA LIKE :WS-CENCOSTA)    
001156*              ORDER BY A.CODCLIEN, A.CODSOCIE                     
001157*                      ,A.AAMMCOMP, A.TIPSERVI, A.AANUMORD         
001158*     END-EXEC
                                                                        
001159*    RICERCA GENERICA                                             
001161     
      *EXEC SQL 
      *DECLARE POINTER2  CURSOR FOR                            
001162*           SELECT A.AANUMORD, A.CODCLIEN                          
001163*                 ,A.CODSOCIE, A.CDDIVISI                          
001164*                 ,A.AAMMCOMP, A.CODDIVIS                          
001165*                 ,A.TIPSERVI, A.FLAGAUTO                          
001166*                 ,A.FLAGGIVA, A.CONTODCE                          
001167*                 ,A.DTEVAORD, A.SOCIEMER                          
001168*                 ,A.AANUMFAT, A.DTFATTUR                          
001169*                 ,A.NRPREATT, A.DTPREATT                          
001170*                 ,A.DATAESTR, A.FLAGSOSP                          
001171*                 ,A.CODUTEVB, A.DTCARORD                          
001172*                 ,A.ESENTIVA                                      
001173*             FROM DLOGISTI.TORDILOGI    A                         
001174*            WHERE A.CODSOCIE = :L652-CODSOCIE                     
001175*              AND A.CONTODCE LIKE :WS-CONTODCE                    
001176*              AND A.TIPSERVI BETWEEN :MIN-TIPSERVI                
001177*                                 AND :MAX-TIPSERVI                
001178*              AND A.AAMMCOMP BETWEEN :MIN-AAMMCOMP                
001179*                                 AND :MAX-AAMMCOMP                
001180*              AND A.DTEVAORD BETWEEN :MIN-DTEVAORD                
001181*                                 AND :MAX-DTEVAORD                
001182*              AND A.DTFATTUR BETWEEN :MIN-DTFATTUR                
001183*                                 AND :MAX-DTFATTUR                
001184*              AND A.FLAGSOSP BETWEEN :MIN-FLAGSOSP                
001185*                                 AND :MAX-FLAGSOSP                
001186*              AND A.DTANNULL = ' '                                
001187*              AND EXISTS (SELECT B.CODSERVI                       
001188*                            FROM DLOGISTI.TRIGORDILOGI B          
001189*                       LEFT JOIN DLOGISTI.TSERVIZI S              
001190*                              ON S.CODSERVI = B.CODSERVI          
001191*                             AND S.DESSERVI LIKE :WS-DESSERVI     
001192*                           WHERE A.AANUMORD = B.AANUMORD          
001193*                             AND B.DTANNULL = ' '                 
001194*                             AND B.CODSERVI LIKE :WS-CODSERVI     
001195*                             AND B.CENCOSTD LIKE :WS-CENCOSTD     
001196*                             AND B.CENCOSTA LIKE :WS-CENCOSTA)    
001197*              ORDER BY A.CODCLIEN, A.CODSOCIE                     
001198*                      ,A.AAMMCOMP, A.TIPSERVI, A.AANUMORD         
001199*     END-EXEC
                                                                        
001200*    RICERCA PER FATTURA                                          
001202     
      *EXEC SQL 
      *DECLARE POINTER3  CURSOR FOR                            
001203*           SELECT A.AANUMORD, A.CODCLIEN                          
001204*                 ,A.CODSOCIE, A.CDDIVISI                          
001205*                 ,A.AAMMCOMP, A.CODDIVIS                          
001206*                 ,A.TIPSERVI, A.FLAGAUTO                          
001207*                 ,A.FLAGGIVA, A.CONTODCE                          
001208*                 ,A.DTEVAORD, A.SOCIEMER                          
001209*                 ,A.AANUMFAT, A.DTFATTUR                          
001210*                 ,A.NRPREATT, A.DTPREATT                          
001211*                 ,A.DATAESTR, A.FLAGSOSP                          
001212*                 ,A.CODUTEVB, A.DTCARORD                          
001213*                 ,A.ESENTIVA                                      
001214*             FROM DLOGISTI.TORDILOGI    A                         
001215*            WHERE A.CODSOCIE = :L652-CODSOCIE                     
001216*              AND A.DTANNULL = ' '                                
001217*              AND A.AANUMFAT = :L652-AANUMFAT                     
001218*         ORDER BY A.CODCLIEN, A.CODSOCIE                          
001219*                 ,A.AAMMCOMP, A.TIPSERVI, A.AANUMORD              
001220*     END-EXEC
                                                                        
001221*    RICERCA CLIENTE (PF13)                                       
001223     
      *EXEC SQL 
      *DECLARE POINTPF13 CURSOR FOR                            
001224*           SELECT CODCLIEN, RAGFATTU                              
001225*             FROM DANAGRAF.TCLIENTI                               
001226*            WHERE CODCLIEN > :WS-CODCLIEN                         
001227*              AND RAGFATTU LIKE :WS-RAGFATTU                      
001228*            ORDER BY CODCLIEN                                     
001229*     END-EXEC
                                                                        
001230*    RICERCA CLIENTE (PF14)                                       
001232     
      *EXEC SQL 
      *DECLARE POINTPF14 CURSOR FOR                            
001233*           SELECT CODCLIEN, RAGFATTU                              
001234*             FROM DANAGRAF.TCLIENTI                               
001235*            WHERE CODCLIEN < :WS-CODCLIEN                         
001236*              AND RAGFATTU LIKE :WS-RAGFATTU                      
001237*            ORDER BY CODCLIEN DESC                                
001238*     END-EXEC
                                                                        
001241*    EXEC SQL                                                     
      *         INCLUDE SQLCA                                           
      *    END-EXEC.                                                    
      *>>((file: SQLCA))
000001****************************************************************<*
000002* Copyright (c) 2016-2023 NTT DATA, Inc. All rights reserved.  *<*
000003* Users of NTT DATA Enterprise COBOL may freely                *<*
000004* redistribute this copybook.                                  *<*
000005****************************************************************<*
000006                                                                  
000007 01  SQLCA GLOBAL.                                                
000008     05  SQLCAID                PIC X(8).                         
000009     05  SQLCABC                PIC S9(9) COMP-5.                 
000010     05  SQLCODE                PIC S9(9) COMP-5.                 
000011     05  SQLERRM.                                                 
000012         49  SQLERRML           PIC S9(4) COMP-5.                 
000013         49  SQLERRMC           PIC X(254).                       
000014     05  SQLERRP                PIC X(8).                         
000015     05  SQLERRD OCCURS 6 TIMES PIC S9(9) COMP-5.                 
000016     05  SQLWARN.                                                 
000017         10 SQLWARN0            PIC X(1).                         
000018         10 SQLWARN1            PIC X(1).                         
000019         10 SQLWARN2            PIC X(1).                         
000020         10 SQLWARN3            PIC X(1).                         
000021         10 SQLWARN4            PIC X(1).                         
000022         10 SQLWARN5            PIC X(1).                         
000023         10 SQLWARN6            PIC X(1).                         
000024         10 SQLWARN7            PIC X(1).                         
000025     05  SQLSTATE               PIC X(5).                         
000026     05  SQLEXT                 PIC S9(5) COMP-3 VALUE 1.         
      *<<((file: SQLCA))
001242****************************************************************  
001243*                                                                 
001244* Copyright (c) 2016-2022 NTT DATA, Inc.                          
001245* All rights reserved.                                            
001246*                                                                 
001247****************************************************************  
001248 01  DFHEIV.                                                      
001249   02  DFHEIV0               PIC X(35).                           
001250   02  DFHEIV1               PIC X(08).                           
001251   02  DFHEIV2               PIC X(08).                           
001252   02  DFHEIV3               PIC X(08).                           
001253   02  DFHEIV4               PIC X(06).                           
001254   02  DFHEIV5               PIC X(04).                           
001255   02  DFHEIV6               PIC X(04).                           
001256   02  DFHEIV7               PIC X(02).                           
001257   02  DFHEIV8               PIC X(02).                           
001258   02  DFHEIV9               PIC X(01).                           
001259   02  DFHEIV10              PIC S9(7) COMP-3.                    
001260   02  DFHEIV11              PIC S9(4) COMP SYNC.                 
001261   02  DFHEIV12              PIC S9(4) COMP SYNC.                 
001262   02  DFHEIV13              PIC S9(4) COMP SYNC.                 
001263   02  DFHEIV14              PIC S9(4) COMP SYNC.                 
001264   02  DFHEIV15              PIC S9(4) COMP SYNC.                 
001265   02  DFHEIV16              PIC S9(9) COMP SYNC.                 
001266   02  DFHEIV17              PIC X(04).                           
001267   02  DFHEIV18              PIC X(04).                           
001268   02  DFHEIV19              PIC X(04).                           
001269   02  DFHEIV20              USAGE IS POINTER.                    
001270   02  DFHEIV21              USAGE IS POINTER.                    
001271   02  DFHEIV22              USAGE IS POINTER.                    
001272   02  DFHEIV23              USAGE IS POINTER.                    
001273   02  DFHEIV24              USAGE IS POINTER.                    
001274   02  DFHEIV25              PIC S9(9) COMP SYNC.                 
001275   02  DFHEIV26              PIC S9(9) COMP SYNC.                 
001276   02  DFHEIV27              PIC S9(9) COMP SYNC.                 
001277   02  DFHEIV28              PIC S9(9) COMP SYNC.                 
001278   02  DFHEIV29              PIC S9(9) COMP SYNC.                 
001279   02  DFHEIV30              PIC S9(9) COMP SYNC.                 
001280   02  DFHEIV31              PIC S9(9) COMP SYNC.                 
001281   02  DFHEIV32              PIC S9(4) COMP SYNC.                 
001282   02  DFHEIV33              PIC S9(4) COMP SYNC.                 
001283   02  DFHEIV34              PIC S9(4) COMP SYNC.                 
001284   02  DFHEIV35              PIC S9(4) COMP SYNC.                 
001285   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.         
001286   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.      
001287   02  FILLER                PIC X(02).                           
001288   02  DFHEIV99              PIC X(08) VALUE SPACE.               
001289   02  DFHEIVL0              PIC X(48) VALUE SPACE.               
001290   02  DFHEIVL1              PIC X(48) VALUE SPACE.               
001291   02  DFHEIVL2              PIC X(48) VALUE SPACE.               
001292   02  DFHEIVL3              PIC X(48) VALUE SPACE.               
001293   02  DFHEIVL4              PIC X(255) VALUE SPACE.              
001294   02  DFHEIVL5              PIC X(255) VALUE SPACE.              
001295 LINKAGE  SECTION.                                                
001296***************************************************************** 
001297*                                                               * 
001298* Copyright (c) 2016-2022 NTT DATA, Inc.                        * 
001299* All rights reserved.                                          * 
001300*                                                               * 
001301***************************************************************** 
001302 01  dfheiblk.                                                    
001303     02  eibtime          pic s9(7) comp-3.                       
001304     02  eibdate          pic s9(7) comp-3.                       
001305     02  eibtrnid         pic x(4).                               
001306     02  eibtaskn         pic s9(7) comp-3.                       
001307     02  eibtrmid         pic x(4).                               
001308     02  dfheigdi         pic s9(4) comp.                         
001309     02  eibcposn         pic s9(4) comp.                         
001310     02  eibcalen         pic s9(4) comp.                         
001311     02  eibaid           pic x(1).                               
001312     02  eibfiller1       pic x(1).                               
001313     02  eibfn            pic x(2).                               
001314     02  eibfiller2       pic x(2).                               
001315     02  eibrcode         pic x(6).                               
001316     02  eibfiller3       pic x(2).                               
001317     02  eibds            pic x(8).                               
001318     02  eibreqid         pic x(8).                               
001319     02  eibrsrce         pic x(8).                               
001320     02  eibsync          pic x(1).                               
001321     02  eibfree          pic x(1).                               
001322     02  eibrecv          pic x(1).                               
001323     02  eibsend          pic x(1).                               
001324     02  eibatt           pic x(1).                               
001325     02  eibeoc           pic x(1).                               
001326     02  eibfmh           pic x(1).                               
001327     02  eibcompl         pic x(1).                               
001328     02  eibsig           pic x(1).                               
001329     02  eibconf          pic x(1).                               
001330     02  eiberr           pic x(1).                               
001331     02  eibrldbk         pic x(1).                               
001332     02  eiberrcd         pic x(4).                               
001333     02  eibsynrb         pic x(1).                               
001334     02  eibnodat         pic x(1).                               
001335     02  eibfiller5       pic x(2).                               
001336     02  eibresp          pic s9(8) comp.                         
001337     02  eibresp2         pic s9(8) comp.                         
001338     02  dfheigdj         pic s9(4) comp.                         
001339     02  dfheigdk         pic s9(4) comp.                         
001340*----------------*                                                
001341 01  DFHCOMMAREA.                                                 
001342*    COPY DCLCOMMA.                                               
001343     02 LK-AREABYTE PIC X OCCURS 0 TO 4096 TIMES                  
001344                       DEPENDING ON EIBCALEN OF DFHEIBLK.         
001345*-----------------------------------------------------------------
001346 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.                   
001346 VCOBOL-DUMMY-PROCEDURE.
001347 0000-DFHENTRY SECTION.                                           
001348     MOVE FUNCTION WHEN-COMPILED TO DFHEIVL0(1:21).               
001349     MOVE SPACES TO DFHEIV2.                                      
001350     MOVE '9#                    &   ' TO DFHEIV0.                
001351     MOVE 'AVTLO22' TO DFHEIV1.                                   
001352     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1       
001353          DFHEIVL0 DFHEIV2.                                       
001354*-----------------------------------------------------------------
001355                                                                  
001356* EXEC CICS HANDLE ABEND LABEL(Z00-ERRORE)     END-EXEC.          
001357*    MOVE '..L                   " " #00001348' TO DFHEIV0        
001358     MOVE X'2E2E4C202020202020202020' &                           
001359          X'202020202020202020202220' &                           
001360          X'2220233030303031333438' TO DFHEIV0                    
001361     CALL 'kxdfhei1' USING DFHEIV0,                               
001362           DFHEIV99                                               
001363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001364                                                                  
001365     
      *EXEC SQL WHENEVER SQLERROR GO TO Z00-ERRORE END-EXEC
                                                                        
001366     PERFORM A00-INIZIALIZZAZIONE                                 
001367        THRU A00-EX.                                              
001368     IF  EIBCALEN NOT > ZERO                                      
001369         PERFORM B00-ARRIVO-DA-START                              
001370            THRU B00-EX                                           
001371     ELSE                                                         
001372         MOVE DFHCOMMAREA        TO WCOM-AREAXXXX                 
001373         MOVE 'AVMLO22'          TO WNOMEMAP                      
001374         MOVE WCOM-CODILING      TO WCODLING                      
001375         IF EIBAID = DFHENTER OR                                  
001376            EIBAID = DFHPF10  OR                                  
001377            EIBAID = DFHPF13  OR                                  
001378            EIBAID = DFHPF14                                      
001379            PERFORM C00-RICEVI-MAPPA                              
001380               THRU C00-EX                                        
001381         ELSE                                                     
001382            PERFORM D00-GESTIONE-PF                               
001383               THRU D00-EX.                                       
001384     PERFORM E30-INVIA-MAPPA                                      
001385        THRU E30-EX.                                              
001386     PERFORM U00-RETURN-TRAN                                      
001387        THRU U00-EX.                                              
001388*----------------------------------------------------------------*
001389 A00-INIZIALIZZAZIONE.                                            
001390*----------------------------------------------------------------*
001391     MOVE +500                   TO WCOM-LUNGHEZZ.                
001392     MOVE EIBTRMID               TO WPAGVIDE                      
001393                                    WPAGVID2.                     
001394     MOVE LOW-VALUE              TO AVILO22O.                     
001395     MOVE 17                     TO WNUMRIGA.                     
001396     MOVE LENGTH OF WPAGREFE     TO WPAGLPAG.                     
001397     MOVE LENGTH OF WPAGREF2     TO WPAGLPA2.                     
001398 A00-EX. EXIT.                                                    
001399*----------------------------------------------------------------*
001400 B00-ARRIVO-DA-START.                                             
001401*----------------------------------------------------------------*
001402                                                                  
001403* EXEC CICS HANDLE CONDITION ENDDATA (B05-NORESP)                 
001404*                               END-EXEC                          
001405*    MOVE '"$&                   ! # #00001386' TO DFHEIV0        
001406     MOVE X'222426202020202020202020' &                           
001407          X'202020202020202020202120' &                           
001408          X'2320233030303031333836' TO DFHEIV0                    
001409     CALL 'kxdfhei1' USING DFHEIV0                                
001410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
001411                                                                  
001412* EXEC CICS RETRIEVE INTO   (WCOM-AREAXXXX)                       
001413*                       LENGTH (WCOM-LUNGHEZZ)                    
001414*                       END-EXEC                                  
001415*    MOVE '0*I L                 &   #00001388' TO DFHEIV0        
001416     MOVE X'302A49204C20202020202020' &                           
001417          X'202020202020202020202620' &                           
001418          X'2020233030303031333838' TO DFHEIV0                    
001419     CALL 'kxdfhei1' USING DFHEIV0,                               
001420           WCOM-AREAXXXX,                                         
001421           WCOM-LUNGHEZZ,                                         
001422           DFHEIV99,                                              
001423           DFHEIV99,                                              
001424           DFHEIV99                                               
001425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
001426     INITIALIZE  WCOM-DATIPROG.                                   
001427     PERFORM LEGGO-RICICLO                                        
001428        THRU LEGGO-RICICLO-EX.                                    
001429     PERFORM B10-PRIMA-VOLTA                                      
001430        THRU B10-EX.                                              
001431     IF WCOM-DTCARORD NOT > SPACES                                
001432        PERFORM L30-SELECT-DATEELAB                               
001433           THRU L30-EX                                            
001434        MOVE A847-DTINELAB       TO WCOM-DTCARORD.                
001435     MOVE WCOM-CODSOCIE          TO LO22-CODSOCIEO.               
001436     MOVE WCOM-CODCLIEN          TO LO22-CODCLIENO.               
001437     MOVE WCOM-RAGFATTU          TO LO22-RAGFATTUO.               
001438     MOVE WCOM-DTCARORD(1:4)     TO LO22-AAAACOMPO.               
001439     MOVE WCOM-DTCARORD(5:2)     TO LO22-MMMMCOMPO.               
001440     MOVE WCOM-SALDATOX          TO LO22-FLAGSOSPO.               
001441     MOVE WCOM-STATUSXX          TO LO22-STATUSXXO.               
001442     MOVE WCOM-CODSERVI          TO LO22-CODSERVIO.               
001443     MOVE WCOM-DESSERVI          TO LO22-DESSERVIO.               
001444     MOVE WCOM-TIPSERVI          TO LO22-TIPSERVIO.               
001445     MOVE WCOM-CONTODCE          TO LO22-CONTODCEO.               
001446     MOVE WCOM-AANUMFAT          TO LO22-AANUMFATO.               
001447     MOVE WCOM-CENCOSTD          TO LO22-CENCOSTDO.               
001448     MOVE WCOM-CENCOSTA          TO LO22-CENCOSTAO.               
001449     MOVE WCOM-NUMORDIN          TO LO22-NUMORDINO.               
001450     PERFORM C20-GESTIONE-RICICLO                                 
001451        THRU C20-EX.                                              
001452 B00-EX. EXIT.                                                    
001453*----------------------------------------------------------------*
001454 B05-NORESP.                                                      
001455*----------------------------------------------------------------*
001456                                                                  
001457* EXEC CICS SEND CONTROL                                          
001458*                   ERASE                                         
001459*                   CURSOR                                        
001460*                   FREEKB                                        
001461*                   END-EXEC.                                     
001462     MOVE -1                                                      
001463       TO DFHEIV11                                                
001464*    MOVE '82     CT  E F        (   #00001421' TO DFHEIV0        
001465     MOVE X'383220202020204354202045' &                           
001466          X'204620202020202020202820' &                           
001467          X'2020233030303031343231' TO DFHEIV0                    
001468     CALL 'kxdfhei1' USING DFHEIV0,                               
001469           DFHEIV99,                                              
001470           DFHEIV99,                                              
001471           DFHEIV99,                                              
001472           DFHEIV11,                                              
001473           DFHEIV99,                                              
001474           DFHEIV99,                                              
001475           DFHEIV99                                               
001476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001477                                                                  
001478                                                                  
001479* EXEC CICS RETURN END-EXEC.                                      
001480*    MOVE '.(                    ''   #00001426' TO DFHEIV0       
001481     MOVE X'2E2820202020202020202020' &                           
001482          X'202020202020202020202720' &                           
001483          X'2020233030303031343236' TO DFHEIV0                    
001484     CALL 'kxdfhei1' USING DFHEIV0,                               
001485           DFHEIV99,                                              
001486           DFHEIV99,                                              
001487           DFHEIV99,                                              
001488           DFHEIV99,                                              
001489           DFHEIV99,                                              
001490           DFHEIV99                                               
001491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001492                                                                  
001493                                                                  
001494* GOBACK.                                                         
001495     MOVE '9%                    "   ' TO DFHEIV0                 
001496     MOVE 'AVTLO22' TO DFHEIV1                                    
001497     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1                        
001498     GOBACK.                                                      
001499 B05-EX. EXIT.                                                    
001500*----------------------------------------------------------------*
001501 B10-PRIMA-VOLTA.                                                 
001502*----------------------------------------------------------------*
001503     PERFORM U20-DELETE-TS                                        
001504        THRU U20-EX.                                              
001505     PERFORM U22-DELETE-TS2                                       
001506        THRU U22-EX.                                              
001507     MOVE 'AVTLO22'              TO WCOM-NOMEPRGM                 
001508     MOVE EIBTRNID               TO WCOM-TRANSAZI                 
001509     MOVE ZEROES                 TO WCOM-PAGIRICH                 
001510                                    WCOM-PAGILIST                 
001511                                    WPAGRICH.                     
001512     MOVE 99999                  TO WCOM-PAGIULTI                 
001513     MOVE 'AVMLO22'              TO WNOMEMAP                      
001514     MOVE WCOM-CODILING          TO WCODLING                      
001515     IF  WCOM-MENUTRAN (WCOM-INDITRAN) NOT = WCOM-TRANSAZI        
001516         ADD  1                  TO WCOM-INDITRAN                 
001517         MOVE WCOM-TRANSAZI      TO WCOM-MENUTRAN (WCOM-INDITRAN) 
001518         MOVE ZEROES             TO WCOM-PAGITRAN (WCOM-INDITRAN).
001519     IF  WCOM-INDITRAN > 10                                       
001520         MOVE 'TRTR'             TO WCOM-CODABEND                 
001521         PERFORM Z00-ERRORE                                       
001522            THRU Z00-EX.                                          
001523 B10-EX. EXIT.                                                    
001524*----------------------------------------------------------------*
001525 C00-RICEVI-MAPPA.                                                
001526*----------------------------------------------------------------*
001527                                                                  
001528* EXEC CICS RECEIVE MAP    (WNOMEMAP)                             
001529*                      MAPSET ('AVMLO22')                         
001530*                      INTO   (AVILO22I)                          
001531*                      END-EXEC.                                  
001532     MOVE LENGTH OF                                               
001533      AVILO22I                                                    
001534       TO DFHEIV11                                                
001535     MOVE 'AVMLO22' TO DFHEIV1                                    
001536*    MOVE '8"T I  L              ''   #00001456' TO DFHEIV0       
001537     MOVE X'382254204920204C20202020' &                           
001538          X'202020202020202020202720' &                           
001539          X'2020233030303031343536' TO DFHEIV0                    
001540     CALL 'kxdfhei1' USING DFHEIV0,                               
001541           WNOMEMAP,                                              
001542           AVILO22I,                                              
001543           DFHEIV11,                                              
001544           DFHEIV1,                                               
001545           DFHEIV99,                                              
001546           DFHEIV99                                               
001547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001548                                                                  
001549     MOVE LOW-VALUE              TO LO22-MESSAGGO.                
001550     MOVE SPACES                 TO MESS-CODERROR.                
001551     IF LO22-MAPRPAGI IS NUMERIC AND                              
001552        LO22-MAPRPAGI > ZERO                                      
001553        MOVE LO22-MAPRPAGI       TO WPAGRICH                      
001554     ELSE                                                         
001555       MOVE WCOM-PAGIRICH        TO WPAGRICH.                     
001556     IF WPAGRICH NOT = WCOM-PAGIRICH                              
001557        PERFORM E20-PAGINA-PRONTA                                 
001558           THRU E20-EX                                            
001559     ELSE                                                         
001560        IF EIBAID = DFHPF13 OR                                    
001561           EIBAID = DFHPF14                                       
001562           PERFORM C10-CERCA-CLIENTE                              
001563              THRU C10-EX                                         
001564        ELSE                                                      
001565          INSPECT LO22-CODSOCIEI REPLACING ALL LOW-VALUE BY SPACES
001566          INSPECT LO22-CODCLIENI REPLACING ALL LOW-VALUE BY SPACES
001567          INSPECT LO22-RAGFATTUI REPLACING ALL LOW-VALUE BY SPACES
001568          INSPECT LO22-AAAACOMPI REPLACING ALL LOW-VALUE BY SPACES
001569          INSPECT LO22-MMMMCOMPI REPLACING ALL LOW-VALUE BY SPACES
001570          INSPECT LO22-STATUSXXI REPLACING ALL LOW-VALUE BY SPACES
001571          INSPECT LO22-FLAGSOSPI REPLACING ALL LOW-VALUE BY SPACES
001572          INSPECT LO22-CODSERVII REPLACING ALL LOW-VALUE BY SPACES
001573          INSPECT LO22-DESSERVII REPLACING ALL LOW-VALUE BY SPACES
001574          INSPECT LO22-TIPSERVII REPLACING ALL LOW-VALUE BY SPACES
001575          INSPECT LO22-CONTODCEI REPLACING ALL LOW-VALUE BY SPACES
001576          INSPECT LO22-AANUMFATI REPLACING ALL LOW-VALUE BY SPACES
001577          INSPECT LO22-CENCOSTAI REPLACING ALL LOW-VALUE BY SPACES
001578          INSPECT LO22-CENCOSTDI REPLACING ALL LOW-VALUE BY SPACES
001579          IF LO22-CODSOCIEI NOT = WCOM-CODSOCIE OR                
001580             LO22-CODCLIENI NOT = WCOM-CODCLIEN OR                
001581             LO22-RAGFATTUI NOT = WCOM-RAGFATTU OR                
001582             LO22-AAAACOMPI NOT = WCOM-DTCARORD(1:4) OR           
001583             LO22-MMMMCOMPI NOT = WCOM-DTCARORD(5:2) OR           
001584             LO22-FLAGSOSPI NOT = WCOM-SALDATOX OR                
001585             LO22-STATUSXXI NOT = WCOM-STATUSXX OR                
001586             LO22-CODSERVII NOT = WCOM-CODSERVI OR                
001587             LO22-DESSERVII NOT = WCOM-DESSERVI OR                
001588             LO22-TIPSERVII NOT = WCOM-TIPSERVI OR                
001589             LO22-CONTODCEI NOT = WCOM-CONTODCE OR                
001590             LO22-CENCOSTDI NOT = WCOM-CENCOSTD OR                
001591             LO22-CENCOSTAI NOT = WCOM-CENCOSTA OR                
001592             LO22-NUMORDINI NOT = WCOM-NUMORDIN OR                
001593             LO22-AANUMFATI NOT = WCOM-AANUMFAT                   
001594             PERFORM C20-GESTIONE-RICICLO                         
001595                THRU C20-EX                                       
001596          ELSE                                                    
001597             PERFORM C40-GESTIONE-RICEVI                          
001598                THRU C40-EX.                                      
001599 C00-EX. EXIT.                                                    
001600*----------------------------------------------------------------*
001601 C10-CERCA-CLIENTE.                                               
001602*----------------------------------------------------------------*
001603     IF LO22-RAGFATTUI NOT = WCOM-RAGFATTU AND                    
001604        LO22-RAGFATTUI > SPACES                                   
001605        MOVE LO22-RAGFATTUI      TO WCOM-RAGFATT2                 
001606        MOVE SPACES              TO WS-CODCLIEN                   
001607        PERFORM C15-RICERCA-FORNITORE                             
001608           THRU C15-EX                                            
001609     ELSE                                                         
001610        IF WCOM-RAGFATT2 > SPACES                                 
001611           MOVE LO22-CODCLIENI   TO WS-CODCLIEN                   
001612           PERFORM C15-RICERCA-FORNITORE                          
001613              THRU C15-EX.                                        
001614 C10-EX. EXIT.                                                    
001615*----------------------------------------------------------------*
001616 C15-RICERCA-FORNITORE.                                           
001617*----------------------------------------------------------------*
001618     PERFORM C17-DESCRIZIONE-MAPPA                                
001619        THRU C17-EX.                                              
001620     MOVE 'OPEN'                 TO WCOM-FILEFUNZ.                
001621     MOVE 'C15-'                 TO WCOM-CODABEND.                
001622     MOVE SPACES                 TO WCOM-FILECTRL.                
001623     STRING WS-CODCLIEN ' ' WS-RAGFATTU                           
001624        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
001625     IF EIBAID = DFHPF13                                          
001626        MOVE 'POINTPF13'         TO WCOM-FILENOME                 
001627        
      *EXEC SQL OPEN POINTPF13 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 1 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CODCLIEN
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-RAGFATTU
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 4 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001628     ELSE                                                         
001629        MOVE 'POINTPF14'         TO WCOM-FILENOME                 
001630        
      *EXEC SQL OPEN POINTPF14 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 2 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CODCLIEN
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-RAGFATTU
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 5 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                              .                         
001631     IF EIBAID = DFHPF13                                          
001632        PERFORM L01-FETCH-POINTPF13                               
001633           THRU L01-EX                                            
001634     ELSE                                                         
001635        PERFORM L02-FETCH-POINTPF14                               
001636           THRU L02-EX.                                           
001637     MOVE SQLCODE                TO WS-SQLCODE2.                  
001638     MOVE 'CLOSE'                TO WCOM-FILEFUNZ.                
001639     MOVE 'C15-'                 TO WCOM-CODABEND.                
001640     MOVE SPACES                 TO WCOM-FILECTRL.                
001641     STRING WS-CODCLIEN ' ' WS-RAGFATTU                           
001642        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
001643     IF EIBAID = DFHPF13                                          
001644        MOVE 'POINTPF13'         TO WCOM-FILENOME                 
001645        
      *EXEC SQL CLOSE POINTPF13 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 4 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001646     ELSE                                                         
001647        MOVE 'POINTPF14'         TO WCOM-FILENOME                 
001648        
      *EXEC SQL CLOSE POINTPF14 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 5 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                               .                        
001649     IF WS-SQLCODE2 = ZEROES                                      
001650        MOVE A901-CODCLIEN       TO LO22-CODCLIENO                
001651        MOVE A901-RAGFATTU       TO LO22-RAGFATTUO                
001652                                    WCOM-RAGFATTU                 
001653        PERFORM C20-GESTIONE-RICICLO                              
001654           THRU C20-EX.                                           
001655 C15-EX. EXIT.                                                    
001656*----------------------------------------------------------------*
001657 C17-DESCRIZIONE-MAPPA.                                           
001658*----------------------------------------------------------------*
001659     MOVE SPACES                 TO WS-RAGFATT3.                  
001660     MOVE 1                      TO WS-IND2                       
001661     MOVE WCOM-RAGFATT2          TO WS-RAGFATT2.                  
001662     INSPECT WS-RAGFATT2 REPLACING ALL LOW-VALUE BY SPACES.       
001663     PERFORM VARYING WS-IND1 FROM 1 BY 1                          
001664               UNTIL WS-IND1 > 24                                 
001665        IF WS-BYTE2(WS-IND1) NUMERIC   OR                         
001666          (WS-BYTE2(WS-IND1) NOT < 'A' AND                        
001667           WS-BYTE2(WS-IND1) NOT > 'Z' ) OR                       
001668           WS-BYTE2(WS-IND1) = SPACES  OR                         
001669           WS-BYTE2(WS-IND1) = '%'                                
001670           MOVE WS-BYTE2(WS-IND1) TO WS-BYTE3(WS-IND2)            
001671           ADD 1                 TO WS-IND2                       
001672        END-IF                                                    
001673     END-PERFORM.                                                 
001674     STRING '%' WS-RAGFATT3 DELIMITED BY SIZE                     
001675                               INTO WS-RAGFATTU.                  
001676     INSPECT WS-RAGFATTU REPLACING ALL SPACES BY '%'.             
001677 C17-EX. EXIT.                                                    
001678*----------------------------------------------------------------*
001679 C20-GESTIONE-RICICLO.                                            
001680*----------------------------------------------------------------*
001681     MOVE '1'                    TO WCOM-PF                       
001682     MOVE LOW-VALUE              TO WCOM-CODSOCIE                 
001683                                    WCOM-CODCLIEN                 
001684                                    WCOM-RAGFATTU                 
001685                                    WCOM-STATUSXX                 
001686                                    WCOM-SALDATOX                 
001687                                    WCOM-CODSERVI                 
001688                                    WCOM-DESSERVI                 
001689                                    WCOM-TIPSERVI                 
001690                                    WCOM-CONTODCE                 
001691                                    WCOM-CENCOSTD                 
001692                                    WCOM-CENCOSTA                 
001693                                    WCOM-NUMORDIN                 
001694                                    WCOM-AANUMFAT                 
001695                                    WCOM-DTCARORD                 
001696     PERFORM C21-CONTROLLA-RICHIESTA                              
001697        THRU C21-EX.                                              
001698     PERFORM U20-DELETE-TS                                        
001699        THRU U20-EX.                                              
001700     PERFORM U22-DELETE-TS2                                       
001701        THRU U22-EX.                                              
001702     MOVE 99999                  TO WCOM-PAGIULTI.                
001703     MOVE ZERO                   TO WCOM-PAGIRICH                 
001704                                    WCOM-PAGILIST                 
001705                                    WPAGRICH.                     
001706     PERFORM E99-PULISCI-MAPPA                                    
001707        THRU E99-EX                                               
001708     IF ERRORE                                                    
001709        GO TO C20-EX.                                             
001710     MOVE LO22-CODSOCIEI         TO WCOM-CODSOCIE.                
001711     MOVE LO22-CODCLIENI         TO WCOM-CODCLIEN.                
001712     MOVE LO22-RAGFATTUI         TO WCOM-RAGFATTU.                
001713     MOVE LO22-STATUSXXI         TO WCOM-STATUSXX.                
001714     MOVE LO22-FLAGSOSPI         TO WCOM-SALDATOX.                
001715     MOVE LO22-CODSERVII         TO WCOM-CODSERVI.                
001716     MOVE LO22-DESSERVII         TO WCOM-DESSERVI.                
001717     MOVE LO22-TIPSERVII         TO WCOM-TIPSERVI.                
001718     MOVE LO22-CONTODCEI         TO WCOM-CONTODCE.                
001719     MOVE LO22-CENCOSTDI         TO WCOM-CENCOSTD.                
001720     MOVE LO22-CENCOSTAI         TO WCOM-CENCOSTA.                
001721     MOVE LO22-NUMORDINI         TO WCOM-NUMORDIN.                
001722     MOVE LO22-AANUMFATI         TO WCOM-AANUMFAT.                
001723     MOVE LO22-AAAACOMPI         TO WCOM-DTCARORD(1:4)            
001724     MOVE LO22-MMMMCOMPI         TO WCOM-DTCARORD(5:2)            
001725     PERFORM E10-PREPARA-PAGINE                                   
001726        THRU E10-EX.                                              
001727     PERFORM E20-PAGINA-PRONTA                                    
001728        THRU E20-EX.                                              
001729 C20-EX. EXIT.                                                    
001730*----------------------------------------------------------------*
001731 C21-CONTROLLA-RICHIESTA.                                         
001732*----------------------------------------------------------------*
001733     INSPECT LO22-RAGFATTUI REPLACING ALL LOW-VALUE BY SPACES.    
001734     INSPECT LO22-CODCLIENI REPLACING ALL LOW-VALUE BY SPACES.    
001735     INSPECT LO22-CODSERVII REPLACING ALL LOW-VALUE BY SPACES.    
001736     INSPECT LO22-DESSERVII REPLACING ALL LOW-VALUE BY SPACES.    
001737     INSPECT LO22-AANUMFATI REPLACING ALL LOW-VALUE BY SPACES.    
001738     IF LO22-CODCLIENI NOT > SPACES AND                           
001739        LO22-RAGFATTUI NOT > SPACES AND                           
001740        LO22-CODSERVII NOT > SPACES AND                           
001741        LO22-DESSERVII NOT > SPACES AND                           
001742        LO22-AANUMFATI NOT > SPACES                               
001743        MOVE '*'                 TO WSWERROR                      
001744        MOVE '00010'             TO MESS-CODERROR                 
001745        MOVE DFHUNIMD            TO LO22-CODCLIENA                
001746                                    LO22-RAGFATTUA                
001747                                    LO22-CODSERVIA                
001748                                    LO22-DESSERVIA                
001749                                    LO22-AANUMFATA                
001750        MOVE DFHRED              TO LO22-CODCLIENC                
001751                                    LO22-RAGFATTUC                
001752                                    LO22-CODSERVIC                
001753                                    LO22-DESSERVIC                
001754                                    LO22-AANUMFATC                
001755        MOVE -1                  TO LO22-CODCLIENL                
001756        GO TO C21-EX.                                             
001757*    CONTROLLO FATTURA                                            
001758     IF LO22-AANUMFATI > SPACES                                   
001759        MOVE LO22-AANUMFATI      TO L652-AANUMFAT                 
001760        PERFORM L20-SELECT-ORDILOGI-FATT                          
001761           THRU L20-EX                                            
001762        IF SQLCODE = +100                                         
001763           MOVE '*'              TO WSWERROR                      
001764           MOVE '00172'          TO MESS-CODERROR                 
001765           MOVE DFHUNIMD         TO LO22-AANUMFATA                
001766           MOVE DFHRED           TO LO22-AANUMFATC                
001767           MOVE -1               TO LO22-AANUMFATL                
001768           GO TO C21-EX                                           
001769        ELSE                                                      
001770           MOVE 'T'              TO LO22-STATUSXXI                
001771           MOVE L652-CODSOCIE    TO LO22-CODSOCIEI                
001772           MOVE SPACES           TO LO22-CODCLIENI                
001773                                    LO22-RAGFATTUI                
001774                                    LO22-AAAACOMPI                
001775                                    LO22-MMMMCOMPI                
001776                                    LO22-CODSERVII                
001777                                    LO22-DESSERVII                
001778                                    LO22-TIPSERVII                
001779                                    LO22-DESTIPSEI                
001780                                    LO22-CONTODCEI                
001781                                    LO22-CENCOSTDI                
001782                                    LO22-CENCOSTAI                
001783           MOVE SPACES           TO WCOM-RAGFATT2.                
001784*    CONTROLLO CLIENTE E RAGIONE SOCIALE                          
001785     IF LO22-CODCLIENI > SPACES                                   
001786        MOVE SPACES              TO LO22-RAGFATTUI                
001787        MOVE +5                  TO WLENGTH                       
001788        CALL WWTWSNU USING WLENGTH LO22-CODCLIENI                 
001789        MOVE LO22-CODCLIENI      TO A901-CODCLIEN                 
001790        PERFORM L15-SELECT-CLIENTI                                
001791           THRU L15-EX                                            
001792        MOVE A901-CODSOCIE       TO LO22-CODSOCIEO                
001793        MOVE A901-RAGFATTU       TO LO22-RAGFATTUO                
001794     ELSE                                                         
001795        IF LO22-RAGFATTUI > SPACES                                
001796           MOVE LO22-RAGFATTUI   TO WCOM-RAGFATT2                 
001797           PERFORM L17-SELECT-RAGFATTU                            
001798              THRU L17-EX                                         
001799           IF SQLCODE = +100                                      
001800              MOVE '*'           TO WSWERROR                      
001801              MOVE '00053'       TO MESS-CODERROR                 
001802              MOVE DFHUNIMD      TO LO22-RAGFATTUA                
001803              MOVE DFHRED        TO LO22-RAGFATTUC                
001804              MOVE -1            TO LO22-RAGFATTUL                
001805              GO TO C21-EX                                        
001806           ELSE                                                   
001807              MOVE 'T'           TO LO22-STATUSXXI                
001808              MOVE A901-CODSOCIE TO LO22-CODSOCIEI                
001809              MOVE A901-CODCLIEN TO LO22-CODCLIENI                
001810              MOVE A901-RAGFATTU TO LO22-RAGFATTUI.               
001811*    CONTROLLO SOCIETA'                                           
001812     INSPECT LO22-CODSOCIEI REPLACING ALL LOW-VALUE BY SPACES.    
001813     IF LO22-CODSOCIEI NOT > SPACES                               
001814        MOVE '*'                 TO WSWERROR                      
001815        MOVE '00036'             TO MESS-CODERROR                 
001816        MOVE DFHUNIMD            TO LO22-CODSOCIEA                
001817        MOVE DFHRED              TO LO22-CODSOCIEC                
001818        MOVE -1                  TO LO22-CODSOCIEL                
001819        GO TO C21-EX                                              
001820     ELSE                                                         
001821        MOVE LO22-CODSOCIEI      TO A531-CODSOCIE                 
001822        PERFORM L10-SELECT-SOCIETA                                
001823           THRU L10-EX                                            
001824        IF SQLCODE = +100                                         
001825           MOVE '*'              TO WSWERROR                      
001826           MOVE '00036'          TO MESS-CODERROR                 
001827           MOVE DFHUNIMD         TO LO22-CODSOCIEA                
001828           MOVE DFHRED           TO LO22-CODSOCIEC                
001829           MOVE -1               TO LO22-CODSOCIEL                
001830           GO TO C21-EX                                           
001831        ELSE                                                      
001832           MOVE A531-NOMSOCIE    TO LO22-NOMSOCIEO.               
001833     IF LO22-AANUMFATI > SPACES                                   
001834        GO TO C21-EX.                                             
001835*    CONTROLLO DATA COMPETENZA                                    
001836     INSPECT LO22-AAAACOMPI REPLACING ALL LOW-VALUE BY SPACES.    
001837     INSPECT LO22-MMMMCOMPI REPLACING ALL LOW-VALUE BY SPACES.    
001838     IF LO22-AAAACOMPI NOT > SPACES                               
001839        MOVE WCOM-DTCREAZI       TO LO22-AAAACOMPO.               
001840     IF LO22-AAAACOMPI NOT > SPACES                               
001841        MOVE '*'                 TO WSWERROR                      
001842        MOVE '00006'             TO MESS-CODERROR                 
001843        MOVE DFHUNIMD            TO LO22-AAAACOMPA                
001844        MOVE DFHRED              TO LO22-AAAACOMPC                
001845        MOVE -1                  TO LO22-AAAACOMPL                
001846        GO TO C21-EX                                              
001847     ELSE                                                         
001848        MOVE LO22-AAAACOMPI(1:4) TO DTGG-DTRICHIE(1:4)            
001849        MOVE '01'                TO DTGG-DTRICHIE(5:2)            
001850        IF LO22-MMMMCOMPI > ' '                                   
001851           MOVE LO22-MMMMCOMPI   TO DTGG-DTRICHIE(5:2)            
001852        END-IF                                                    
001853        MOVE '01'                TO DTGG-DTRICHIE(7:2)            
001854        PERFORM SRDTGG                                            
001855           THRU SRDTGG-EX                                         
001856        IF DTGG-RETUCODE NOT = '****'                             
001857           MOVE '*'              TO WSWERROR                      
001858           MOVE '00006'          TO MESS-CODERROR                 
001859           MOVE DFHUNIMD         TO LO22-AAAACOMPA                
001860           MOVE DFHRED           TO LO22-AAAACOMPC                
001861           IF LO22-MMMMCOMPI > ' '                                
001862              MOVE DFHRED        TO LO22-MMMMCOMPC                
001863           END-IF                                                 
001864           MOVE -1               TO LO22-AAAACOMPL                
001865           GO TO C21-EX.                                          
001866*    CONTROLLO STATUS                                             
001867     INSPECT LO22-STATUSXXI REPLACING ALL LOW-VALUE BY SPACES.    
001868     IF LO22-STATUSXXI NOT > SPACES                               
001869        MOVE 'N'                 TO LO22-STATUSXXI                
001870     ELSE                                                         
001871        IF LO22-STATUSXXI NOT = 'N' AND 'F' AND 'T'               
001872           MOVE '*'              TO WSWERROR                      
001873           MOVE '00016'          TO MESS-CODERROR                 
001874           MOVE DFHRED           TO LO22-STATUSXXC                
001875           MOVE DFHUNIMD         TO LO22-STATUSXXA                
001876           MOVE -1               TO LO22-STATUSXXL                
001877           GO TO C21-EX.                                          
001878*    CONTROLLO SOSPESO                                            
001879     INSPECT LO22-FLAGSOSPI REPLACING ALL LOW-VALUE BY SPACES.    
001880     IF LO22-FLAGSOSPI NOT > SPACES                               
001881        MOVE 'T'                 TO LO22-FLAGSOSPI                
001882     ELSE                                                         
001883        IF LO22-FLAGSOSPI NOT = 'S' AND 'N' AND 'T'               
001884           MOVE '*'              TO WSWERROR                      
001885           MOVE '00920'          TO MESS-CODERROR                 
001886           MOVE DFHRED           TO LO22-FLAGSOSPC                
001887           MOVE DFHUNIMD         TO LO22-FLAGSOSPA                
001888           MOVE -1               TO LO22-FLAGSOSPL                
001889           GO TO C21-EX.                                          
001890*    CONTROLLO SERVIZIO E NOME SERVIZIO                           
001891     INSPECT LO22-CODSERVII REPLACING ALL LOW-VALUE BY SPACES.    
001892     INSPECT LO22-DESSERVII REPLACING ALL LOW-VALUE BY SPACES.    
001893     IF LO22-CODSERVII(1:1) > SPACES  AND                         
001894        LO22-CODSERVII(1:1) NOT = '%' AND                         
001895        LO22-CODSERVII(2:1) > SPACES  AND                         
001896        LO22-CODSERVII(2:1) NOT = '%' AND                         
001897        LO22-CODSERVII(3:1) > SPACES  AND                         
001898        LO22-CODSERVII(3:1) NOT = '%' AND                         
001899        LO22-CODSERVII(4:1) > SPACES  AND                         
001900        LO22-CODSERVII(4:1) NOT = '%' AND                         
001901        LO22-CODSERVII(5:1) > SPACES  AND                         
001902        LO22-CODSERVII(5:1) NOT = '%' AND                         
001903        LO22-CODSERVII(6:1) > SPACES  AND                         
001904        LO22-CODSERVII(6:1) NOT = '%'                             
001905        MOVE SPACES              TO LO22-DESSERVII                
001906        MOVE LO22-CODSERVII      TO L651-CODSERVI                 
001907        PERFORM L18-SELECT-SERVIZI                                
001908           THRU L18-EX                                            
001909        MOVE L651-DESSERVI       TO LO22-DESSERVIO.               
001910*    CONTROLLO TIPO SERVIZIO                                      
001911     INSPECT LO22-TIPSERVII REPLACING ALL LOW-VALUE BY SPACES.    
001912     MOVE SPACES                 TO LO22-DESTIPSEI.               
001913     IF WCOM-MENUTRAN(1) NOT = 'LOGI'                             
001914        MOVE 'L'                 TO LO22-TIPSERVII                
001915        MOVE MESS-CODERROR TO WS-CODERROR                         
001916        MOVE '02733'             TO MESS-CODERROR                 
001917        PERFORM U10-DECODIFICA-MESSAGGI                           
001918           THRU U10-EX                                            
001919        MOVE MESS-MESSAGGI       TO LO22-DESTIPSEO                
001920        MOVE WS-CODERROR         TO MESS-CODERROR                 
001921        MOVE SPACES              TO MESS-MSGERROR                 
001922        MOVE SPACES              TO WS-CODERROR                   
001923     ELSE                                                         
001924        IF LO22-TIPSERVII > SPACES                                
001925           IF LO22-TIPSERVII NOT = 'M' AND 'T'                    
001926              MOVE '*'              TO WSWERROR                   
001927              MOVE '01678'          TO MESS-CODERROR              
001928              MOVE DFHRED           TO LO22-TIPSERVIC             
001929              MOVE DFHUNIMD         TO LO22-TIPSERVIA             
001930              MOVE -1               TO LO22-TIPSERVIL             
001931              GO TO C21-EX                                        
001932           ELSE                                                   
001933              IF LO22-TIPSERVII = 'T'                             
001934                 MOVE MESS-CODERROR TO WS-CODERROR                
001935                 MOVE '02476'       TO MESS-CODERROR              
001936                 PERFORM U10-DECODIFICA-MESSAGGI                  
001937                    THRU U10-EX                                   
001938                 MOVE MESS-MESSAGGI TO LO22-DESTIPSEO             
001939                 MOVE WS-CODERROR   TO MESS-CODERROR              
001940                 MOVE SPACES        TO MESS-MSGERROR              
001941                 MOVE SPACES        TO WS-CODERROR                
001942              ELSE                                                
001943                 IF LO22-TIPSERVII = 'M'                          
001944                    MOVE MESS-CODERROR TO WS-CODERROR             
001945                    MOVE '02477'       TO MESS-CODERROR           
001946                    PERFORM U10-DECODIFICA-MESSAGGI               
001947                       THRU U10-EX                                
001948                    MOVE MESS-MESSAGGI TO LO22-DESTIPSEO          
001949                    MOVE WS-CODERROR   TO MESS-CODERROR           
001950                    MOVE SPACES        TO MESS-MSGERROR           
001951                    MOVE SPACES        TO WS-CODERROR.            
001952     INSPECT LO22-CONTODCEI REPLACING ALL LOW-VALUE BY SPACES.    
001953 C21-EX. EXIT.                                                    
001954*----------------------------------------------------------------*
001955 C40-GESTIONE-RICEVI.                                             
001956*----------------------------------------------------------------*
001957     MOVE WCOM-PAGIRICH          TO WNUMITEM.                     
001958     PERFORM R00-READQ-WPAGCTRL                                   
001959        THRU R00-EX.                                              
001960     PERFORM F00-CONTROLLI                                        
001961        THRU F00-EX.                                              
001962     IF ERRORE OR                                                 
001963        WS-OPERAZIO NOT > SPACES                                  
001964        GO TO C40-EX.                                             
001965     IF EIBAID = DFHPF10                                          
001966        PERFORM G00-AGGIORNAMENTI                                 
001967           THRU G00-EX                                            
001968     ELSE                                                         
001969        MOVE '00030'          TO MESS-CODERROR.                   
001970 C40-EX. EXIT.                                                    
001971*----------------------------------------------------------------*
001972 D00-GESTIONE-PF.                                                 
001973*----------------------------------------------------------------*
001974     IF EIBAID NOT = DFHPF1  AND                                  
001975        EIBAID NOT = DFHPF2  AND                                  
001976        EIBAID NOT = DFHPF7  AND                                  
001977        EIBAID NOT = DFHPF8  AND                                  
001978        EIBAID NOT = DFHPF11 AND                                  
001979        EIBAID NOT = DFHPF12                                      
001980        PERFORM D30-FUNZIONI-ESTERNE                              
001981           THRU D30-EX                                            
001982     ELSE                                                         
001983        IF WCOM-PAGIRICH > ZEROES                                 
001984           PERFORM D10-IMPOSTA-PAGINA                             
001985              THRU D10-EX                                         
001986           PERFORM E20-PAGINA-PRONTA                              
001987              THRU E20-EX                                         
001988        ELSE                                                      
001989           PERFORM U02-NORESP                                     
001990              THRU U02-EX.                                        
001991 D00-EX. EXIT.                                                    
001992*----------------------------------------------------------------*
001993 D10-IMPOSTA-PAGINA.                                              
001994*----------------------------------------------------------------*
001995                                                                  
001996* EXEC CICS RECEIVE MAP    (WNOMEMAP)                             
001997*                      MAPSET ('AVMLO22')                         
001998*                      INTO   (AVILO22I)                          
001999*                      END-EXEC.                                  
002000     MOVE LENGTH OF                                               
002001      AVILO22I                                                    
002002       TO DFHEIV11                                                
002003     MOVE 'AVMLO22' TO DFHEIV1                                    
002004*    MOVE '8"T I  L              ''   #00001906' TO DFHEIV0       
002005     MOVE X'382254204920204C20202020' &                           
002006          X'202020202020202020202720' &                           
002007          X'2020233030303031393036' TO DFHEIV0                    
002008     CALL 'kxdfhei1' USING DFHEIV0,                               
002009           WNOMEMAP,                                              
002010           AVILO22I,                                              
002011           DFHEIV11,                                              
002012           DFHEIV1,                                               
002013           DFHEIV99,                                              
002014           DFHEIV99                                               
002015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002016                                                                  
002017     EVALUATE EIBAID                                              
002018         WHEN DFHPF1                                              
002019              COMPUTE WPAGRICH = WCOM-PAGIRICH + 1                
002020         WHEN DFHPF2                                              
002021              COMPUTE WPAGRICH = WCOM-PAGIRICH - 1                
002022         WHEN DFHPF7                                              
002023              MOVE 1             TO WPAGRICH                      
002024         WHEN DFHPF8                                              
002025              MOVE WCOM-PAGIULTI TO WPAGRICH                      
002026         WHEN DFHPF11                                             
002027              MOVE '1'           TO WCOM-PF                       
002028              MOVE WCOM-PAGIRICH TO WPAGRICH                      
002029         WHEN DFHPF12                                             
002030              MOVE '2'           TO WCOM-PF                       
002031              MOVE WCOM-PAGIRICH TO WPAGRICH                      
002032     END-EVALUATE.                                                
002033 D10-EX. EXIT.                                                    
002034*----------------------------------------------------------------*
002035 D30-FUNZIONI-ESTERNE.                                            
002036*----------------------------------------------------------------*
002037     MOVE  '*'                   TO WCOM-DELETETS.                
002038                                                                  
002039* EXEC CICS LINK PROGRAM  ('WWTTIM15')                            
002040*                   COMMAREA (WCOM-AREAXXXX)                      
002041*                   LENGTH   (WCOM-LUNGHEZZ)                      
002042*                   END-EXEC.                                     
002043     MOVE 'WWTTIM15' TO DFHEIV1                                   
002044*    MOVE '."C                   (   #00001931' TO DFHEIV0        
002045     MOVE X'2E2243202020202020202020' &                           
002046          X'202020202020202020202820' &                           
002047          X'2020233030303031393331' TO DFHEIV0                    
002048     CALL 'kxdfhei1' USING DFHEIV0,                               
002049           DFHEIV1,                                               
002050           WCOM-AREAXXXX,                                         
002051           WCOM-LUNGHEZZ,                                         
002052           DFHEIV99,                                              
002053           DFHEIV99,                                              
002054           DFHEIV99,                                              
002055           DFHEIV99                                               
002056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002057                                                                  
002058     IF  WCOM-RETURNXX = '*'                                      
002059                                                                  
002060* EXEC CICS RETURN END-EXEC                                       
002061*    MOVE '.(                    ''   #00001936' TO DFHEIV0       
002062     MOVE X'2E2820202020202020202020' &                           
002063          X'202020202020202020202720' &                           
002064          X'2020233030303031393336' TO DFHEIV0                    
002065     CALL 'kxdfhei1' USING DFHEIV0,                               
002066           DFHEIV99,                                              
002067           DFHEIV99,                                              
002068           DFHEIV99,                                              
002069           DFHEIV99,                                              
002070           DFHEIV99,                                              
002071           DFHEIV99                                               
002072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
002073     ELSE                                                         
002074         PERFORM U00-RETURN-TRAN                                  
002075            THRU U00-EX.                                          
002076 D30-EX. EXIT.                                                    
002077*----------------------------------------------------------------*
002078 E10-PREPARA-PAGINE.                                              
002079*----------------------------------------------------------------*
002080     INITIALIZE                     WPAGREF2                      
002081     PERFORM O00-OPEN-POINTER                                     
002082        THRU O00-EX.                                              
002083     PERFORM L00-FETCH-POINTER                                    
002084        THRU L00-EX.                                              
002085     PERFORM E13-PREPARA-TS                                       
002086        THRU E13-EX                                               
002087             UNTIL WS-SQLCODE = +100.                             
002088     PERFORM O10-CLOSE-POINTER                                    
002089        THRU O10-EX.                                              
002090     IF WCOM-PAGILIST > ZEROES                                    
002091        PERFORM R22-WRITEQ-WPA2                                   
002092           THRU R22-EX                                            
002093        MOVE WCOM-PAGILIST       TO WCOM-PAGIULTI                 
002094        IF WCOM-PAGITRAN (WCOM-INDITRAN) > ZEROES                 
002095           MOVE WCOM-PAGITRAN (WCOM-INDITRAN)                     
002096                                 TO WPAGRICH                      
002097           MOVE ZEROES           TO WCOM-PAGITRAN (WCOM-INDITRAN) 
002098        ELSE                                                      
002099           MOVE 1                TO WPAGRICH                      
002100     ELSE                                                         
002101        PERFORM E99-PULISCI-MAPPA                                 
002102           THRU E99-EX                                            
002103        IF MESS-CODERROR NOT > SPACES                             
002104           MOVE '00002'          TO MESS-CODERROR.                
002105 E10-EX. EXIT.                                                    
002106*----------------------------------------------------------------*
002107 E13-PREPARA-TS.                                                  
002108*----------------------------------------------------------------*
002109     MOVE SPACES                 TO WPAGREFE.                     
002110     INITIALIZE                     WPAGREFE.                     
002111     MOVE L652-CODCLIEN          TO WPAG-OCODCLIE                 
002112                                    A901-CODCLIEN.                
002113     PERFORM L15-SELECT-CLIENTI                                   
002114        THRU L15-EX.                                              
002115     MOVE A901-RAGFATTU          TO WPAG-ORAGFATT.                
002116     PERFORM E14-RIGA-TS                                          
002117        THRU E14-EX                                               
002118             VARYING WINDRIGA FROM 1 BY 1                         
002119               UNTIL WINDRIGA > WNUMRIGA                          
002120                  OR WPAG-OCODCLIE NOT = L652-CODCLIEN            
002121                  OR WS-SQLCODE = +100.                           
002122     PERFORM R20-WRITEQ-WPAG                                      
002123        THRU R20-EX.                                              
002124 E13-EX. EXIT.                                                    
002125*----------------------------------------------------------------*
002126 E14-RIGA-TS.                                                     
002127*----------------------------------------------------------------*
002128     MOVE L652-CODSOCIE          TO WPAG-RCODSOCI(WINDRIGA).      
002129     MOVE L652-CDDIVISI          TO WPAG-RCDDIVIS(WINDRIGA).      
002130     MOVE L652-TIPSERVI          TO WPAG-RTIPSERV(WINDRIGA).      
002131     MOVE L652-AANUMORD          TO WPAG-RAANUMOR(WINDRIGA).      
002132     MOVE L652-AAMMCOMP          TO WPAG-RAAMMCOM(WINDRIGA).      
002133     MOVE L652-FLAGAUTO          TO WPAG-RFLAGAUT(WINDRIGA).      
002134     MOVE L652-FLAGGIVA          TO WPAG-RFLAGIVA(WINDRIGA).      
002135     MOVE L652-CONTODCE          TO WPAG-RCONTODC(WINDRIGA).      
002136     MOVE L652-CODDIVIS          TO WPAG-RCODDIVI(WINDRIGA).      
002137     MOVE L652-DTEVAORD          TO WPAG-RDTEVAOR(WINDRIGA).      
002138     MOVE L652-AANUMFAT          TO WPAG-RAANUMFA(WINDRIGA).      
002139     MOVE L652-DTFATTUR          TO WPAG-RDTFATTU(WINDRIGA).      
002140     MOVE L652-NRPREATT          TO WPAG-RNRPREAT(WINDRIGA).      
002141     MOVE L652-DTPREATT          TO WPAG-RDTPREAT(WINDRIGA).      
002142     MOVE L652-SOCIEMER          TO WPAG-RSOCIEME(WINDRIGA).      
002143     MOVE L652-ESENTIVA          TO WPAG-RESENTIV(WINDRIGA).      
002144     MOVE L652-AANUMORD          TO L653-AANUMORD.                
002145     PERFORM L05-SEL-SUM-IMPORTO                                  
002146        THRU L05-EX.                                              
002147     MOVE L653-IMPORDIN          TO WPAG-RIMPORDI(WINDRIGA).      
002148     IF WCOM-CODSERVI > ' ' OR                                    
002149        WCOM-DESSERVI > ' ' OR                                    
002150        WCOM-CENCOSTA > ' ' OR                                    
002151        WCOM-CENCOSTD > ' '                                       
002152        PERFORM L06-SEL-SUM-IMPORTO                               
002153           THRU L06-EX.                                           
002154     PERFORM VARYING WS-IND2 FROM 1 BY 1                          
002155       UNTIL WS-IND2                    > 100                     
002156          OR WPA2-CODCLIEN(WS-IND2)     = L652-CODCLIEN           
002157          OR WPA2-CODCLIEN(WS-IND2) NOT > ' '                     
002158     END-PERFORM                                                  
002159     IF WS-IND2 NOT > 100                                         
002160        MOVE L652-CODCLIEN       TO WPA2-CODCLIEN(WS-IND2)        
002161        ADD L653-QTAORDIN        TO WPA2-TOTQUANT(WS-IND2)        
002162        ADD L653-IMPORDIN        TO WPA2-TOTIMPOR(WS-IND2).       
002163     MOVE L652-DATAESTR          TO WPAG-DATAESTR(WINDRIGA)       
002164     MOVE L652-FLAGSOSP          TO WPAG-FLAGSOSP(WINDRIGA)       
002165     MOVE L652-CODUTEVB          TO WPAG-CODUTEVB(WINDRIGA)       
002166     MOVE L652-DTCARORD          TO WPAG-DTCARORD(WINDRIGA)       
002167     MOVE SPACES                 TO WPAG-FLAGRIFE(WINDRIGA).      
002168     MOVE L652-AANUMORD          TO L430-AANUMORD.                
002169     PERFORM L07-SELECT-TRIFORDILOGI                              
002170        THRU L07-EX.                                              
002171     IF SQLCODE = ZEROES                                          
002172        MOVE 'S'                 TO WPAG-FLAGRIFE(WINDRIGA).      
002173     PERFORM L00-FETCH-POINTER                                    
002174        THRU L00-EX.                                              
002175 E14-EX. EXIT.                                                    
002176*----------------------------------------------------------------*
002177 E20-PAGINA-PRONTA.                                               
002178*----------------------------------------------------------------*
002179     IF WCOM-PAGILIST = ZERO                                      
002180        GO TO E20-EX.                                             
002181     IF  WPAGRICH  LESS  1                                        
002182         MOVE 1                  TO WPAGRICH.                     
002183     IF  WPAGRICH  > WCOM-PAGIULTI                                
002184         MOVE WCOM-PAGIULTI      TO WPAGRICH.                     
002185     MOVE WPAGRICH               TO WCOM-PAGIRICH                 
002186     MOVE WPAGRICH               TO WNUMITEM                      
002187     PERFORM R00-READQ-WPAGCTRL                                   
002188        THRU R00-EX.                                              
002189     PERFORM R10-READQ-WPAGCTR2                                   
002190        THRU R10-EX.                                              
002191     PERFORM E99-PULISCI-MAPPA                                    
002192        THRU E99-EX.                                              
002193     MOVE WPAG-OCODCLIE           TO LO22-OCODCLIEI               
002194     MOVE WPAG-ORAGFATT           TO LO22-ORAGFATTI               
002195     PERFORM E21-SPOSTA-IN-MAPPA                                  
002196        THRU E21-EX                                               
002197             VARYING WINDRIGA FROM 1 BY 1                         
002198               UNTIL WINDRIGA > WNUMRIGA                          
002199                  OR WPAG-RAANUMOR (WINDRIGA) NOT > SPACES.       
002200     PERFORM VARYING WS-IND2 FROM 1 BY 1                          
002201       UNTIL WS-IND2                    > 100                     
002202          OR WPA2-CODCLIEN(WS-IND2) NOT > ' '                     
002203          OR WPA2-CODCLIEN(WS-IND2)     = WPAG-OCODCLIE           
002204     END-PERFORM.                                                 
002205     IF WPA2-CODCLIEN(WS-IND2) = WPAG-OCODCLIE                    
002206        MOVE WPA2-TOTQUANT(WS-IND2)  TO LO22-TOTQUANTO            
002207        MOVE WPA2-TOTIMPOR(WS-IND2)  TO LO22-TOTIMPORO.           
002208 E20-EX. EXIT.                                                    
002209*----------------------------------------------------------------*
002210 E21-SPOSTA-IN-MAPPA.                                             
002211*----------------------------------------------------------------*
002212     MOVE WPAG-RCODSOCI(WINDRIGA) TO                              
002213                                  LO22-RCODSOCIO(WINDRIGA)(1:2)   
002214     MOVE WPAG-RCDDIVIS(WINDRIGA) TO                              
002215                                  LO22-RCODSOCIO(WINDRIGA)(3:1)   
002216     MOVE WPAG-RTIPSERV(WINDRIGA) TO LO22-RTIPSERVO(WINDRIGA).    
002217     MOVE WPAG-RAANUMOR(WINDRIGA) TO LO22-RAANUMORO(WINDRIGA).    
002218     MOVE WPAG-RAAMMCOM(WINDRIGA) TO LO22-RAAMMCOMI(WINDRIGA).    
002219     MOVE WPAG-RFLAGAUT(WINDRIGA) TO LO22-RFLAGAUTO(WINDRIGA).    
002220     MOVE WPAG-RFLAGIVA(WINDRIGA) TO LO22-RFLAGIVAO(WINDRIGA).    
002221     MOVE WPAG-RCONTODC(WINDRIGA) TO LO22-RCONTODCO(WINDRIGA).    
002222     MOVE WPAG-RCODDIVI(WINDRIGA) TO LO22-RCODDIVIO(WINDRIGA).    
002223     MOVE WPAG-RIMPORDI(WINDRIGA) TO LO22-RIMPORDIO(WINDRIGA).    
002224     STRING WPAG-RDTEVAOR(WINDRIGA)(7:2)                          
002225            WPAG-RDTEVAOR(WINDRIGA)(5:2)                          
002226            WPAG-RDTEVAOR(WINDRIGA)(3:2)                          
002227             DELIMITED BY SIZE INTO LO22-RDTEVAORO(WINDRIGA).     
002228     MOVE WPAG-RAANUMFA(WINDRIGA) TO LO22-RAANUMFAO(WINDRIGA).    
002229     MOVE WPAG-RSOCIEME(WINDRIGA) TO LO22-RSOCIEMEO(WINDRIGA).    
002230     IF WCOM-PF = '2'                                             
002231        STRING WPAG-RDTFATTU(WINDRIGA)(7:2)                       
002232               WPAG-RDTFATTU(WINDRIGA)(5:2)                       
002233               WPAG-RDTFATTU(WINDRIGA)(3:2)                       
002234               DELIMITED BY SIZE    INTO LO22-RDTFATTUO(WINDRIGA) 
002235     ELSE                                                         
002236        MOVE WPAG-CODUTEVB(WINDRIGA)  TO LO22-RDTFATTUO(WINDRIGA).
002237 E21-EX. EXIT.                                                    
002238*----------------------------------------------------------------*
002239 E99-PULISCI-MAPPA.                                               
002240*----------------------------------------------------------------*
002241     MOVE LOW-VALUE              TO LO22-OCODCLIEI                
002242                                    LO22-ORAGFATTI                
002243                                    LO22-TOTQUANTI                
002244                                    LO22-TOTIMPORI                
002245     PERFORM VARYING WINDRIGA FROM 1 BY 1                         
002246       UNTIL WINDRIGA > WNUMRIGA                                  
002247             MOVE LOW-VALUE      TO LO22-RIGAO(WINDRIGA)          
002248     END-PERFORM.                                                 
002249 E99-EX. EXIT.                                                    
002250*----------------------------------------------------------------*
002251 E30-INVIA-MAPPA.                                                 
002252*----------------------------------------------------------------*
002253     MOVE WCOM-PAGIRICH          TO WNUMITEM.                     
002254     PERFORM R00-READQ-WPAGCTRL                                   
002255        THRU R00-EX.                                              
002256     IF WCOM-PAGIULTI NOT = 99999                                 
002257        MOVE WCOM-PAGIULTI       TO LO22-MAPPPAGO                 
002258     ELSE                                                         
002259        MOVE ALL '*'             TO LO22-MAPPPAGI.                
002260     MOVE WCOM-PAGIRICH          TO LO22-MAPRPAGO.                
002261     IF MESS-CODERROR NOT > SPACES                                
002262        MOVE '00003'             TO MESS-CODERROR.                
002263     PERFORM U10-DECODIFICA-MESSAGGI                              
002264        THRU U10-EX.                                              
002265     IF NOT ERRORE                                                
002266        IF WCOM-PAGILIST NOT > ZEROS                              
002267           MOVE -1               TO LO22-CODSOCIEL                
002268        ELSE                                                      
002269           MOVE -1               TO LO22-OPERAZIOL(1).            
002270     IF WCOM-PF = '2'                                             
002271        MOVE '<<F11'             TO LO22-PFXXXXXXO                
002272        MOVE 'DT.FAT'            TO LO22-TESTO1XXO                
002273     ELSE                                                         
002274        MOVE 'F12>>'             TO LO22-PFXXXXXXO                
002275        IF WCOM-PAGILIST NOT > ZEROS                              
002276           MOVE 'UTFASH'         TO LO22-TESTO1XXO                
002277        ELSE                                                      
002278           MOVE WPAG-RAANUMOR(1)    TO L653-AANUMORD              
002279           PERFORM L50-SELECT-24XTCS                              
002280              THRU L50-EX                                         
002281           IF SQLCODE = 100                                       
002282              MOVE 'UTFASH'      TO LO22-TESTO1XXO                
002283           ELSE                                                   
002284              MOVE 'ORDTCS'      TO LO22-TESTO1XXO.               
002285     PERFORM P00-ATTRIBUTI-RIGA                                   
002286        THRU P00-EX                                               
002287             VARYING WINDRIGA FROM 1 BY 1                         
002288               UNTIL WINDRIGA > WNUMRIGA.                         
002289                                                                  
002290* EXEC CICS SEND MAPSET ('AVMLO22')                               
002291*                   MAP    (WNOMEMAP)                             
002292*                   FROM   (AVILO22O)                             
002293*                   ERASE                                         
002294*                   CURSOR                                        
002295*                   END-EXEC.                                     
002296     MOVE LENGTH OF                                               
002297      AVILO22O                                                    
002298       TO DFHEIV12                                                
002299     MOVE -1                                                      
002300       TO DFHEIV11                                                
002301     MOVE 'AVMLO22' TO DFHEIV1                                    
002302*    MOVE '8$     CT  E      L F ,   #00002153' TO DFHEIV0        
002303     MOVE X'382420202020204354202045' &                           
002304          X'2020202020204C2046202C20' &                           
002305          X'2020233030303032313533' TO DFHEIV0                    
002306     CALL 'kxdfhei1' USING DFHEIV0,                               
002307           WNOMEMAP,                                              
002308           AVILO22O,                                              
002309           DFHEIV12,                                              
002310           DFHEIV1,                                               
002311           DFHEIV99,                                              
002312           DFHEIV99,                                              
002313           DFHEIV99,                                              
002314           DFHEIV11,                                              
002315           DFHEIV99,                                              
002316           DFHEIV99,                                              
002317           DFHEIV99                                               
002318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002319                                                                  
002320 E30-EX. EXIT.                                                    
002321*----------------------------------------------------------------*
002322 F00-CONTROLLI.                                                   
002323*----------------------------------------------------------------*
002324     MOVE SPACES                 TO WS-OPERAZIO.                  
002325     PERFORM F10-CTRL-OPERAZIONE                                  
002326        THRU F10-EX                                               
002327             VARYING WINDRIGA FROM 1 BY 1                         
002328               UNTIL WINDRIGA > WNUMRIGA                          
002329                  OR ERRORE.                                      
002330     IF ERRORE OR WS-OPERAZIO NOT > SPACES                        
002331        GO TO F00-EX.                                             
002332     PERFORM F30-CTRL-SELEZIONE                                   
002333        THRU F30-EX                                               
002334             VARYING WINDRIGA FROM 1 BY 1                         
002335               UNTIL WINDRIGA > WNUMRIGA                          
002336                  OR ERRORE.                                      
002337 F00-EX. EXIT.                                                    
002338*----------------------------------------------------------------*
002339 F10-CTRL-OPERAZIONE.                                             
002340*----------------------------------------------------------------*
002341     IF LO22-OPERAZIOI(WINDRIGA) NOT > SPACES                     
002342        GO TO F10-EX.                                             
002343     IF LO22-OPERAZIOI(WINDRIGA) NOT = 'V' AND                    
002344        LO22-OPERAZIOI(WINDRIGA) NOT = '/' AND                    
002345        LO22-OPERAZIOI(WINDRIGA) NOT = 'F' AND                    
002346        LO22-OPERAZIOI(WINDRIGA) NOT = 'X' AND                    
002347        LO22-OPERAZIOI(WINDRIGA) NOT = 'N' AND                    
002348        LO22-OPERAZIOI(WINDRIGA) NOT = 'R' AND                    
002349        LO22-OPERAZIOI(WINDRIGA) NOT = '*'                        
002350        MOVE '*'                 TO WSWERROR                      
002351        MOVE '00004'             TO MESS-CODERROR                 
002352        MOVE DFHUNIMD            TO LO22-OPERAZIOA (WINDRIGA)     
002353        MOVE DFHRED              TO LO22-OPERAZIOC (WINDRIGA)     
002354        MOVE -1                  TO LO22-OPERAZIOL (WINDRIGA)     
002355        GO TO F10-EX                                              
002356     ELSE                                                         
002357        IF WS-OPERAZIO NOT > SPACES                               
002358           MOVE LO22-OPERAZIOI (WINDRIGA) TO WS-OPERAZIO          
002359        ELSE                                                      
002360           IF WS-OPERAZIO NOT = LO22-OPERAZIOI(WINDRIGA)          
002361              MOVE '*'           TO WSWERROR                      
002362              MOVE '00037'       TO MESS-CODERROR                 
002363              MOVE DFHUNIMD      TO LO22-OPERAZIOA (WINDRIGA)     
002364              MOVE DFHRED        TO LO22-OPERAZIOC (WINDRIGA)     
002365              MOVE -1            TO LO22-OPERAZIOL (WINDRIGA)     
002366              GO TO F10-EX                                        
002367           ELSE                                                   
002368              IF LO22-OPERAZIOI(WINDRIGA) NOT = '/' AND 'F' AND   
002369                                                'X' AND 'N' AND   
002370                                                'R'               
002371                 MOVE '*'        TO WSWERROR                      
002372                 MOVE '00037'    TO MESS-CODERROR                 
002373                 MOVE DFHUNIMD   TO LO22-OPERAZIOA (WINDRIGA)     
002374                 MOVE DFHRED     TO LO22-OPERAZIOC (WINDRIGA)     
002375                 MOVE -1         TO LO22-OPERAZIOL (WINDRIGA)     
002376                 GO TO F10-EX.                                    
002377 F10-EX. EXIT.                                                    
002378*----------------------------------------------------------------*
002379 F30-CTRL-SELEZIONE.                                              
002380*----------------------------------------------------------------*
002381     IF LO22-OPERAZIOI(WINDRIGA) NOT > SPACES                     
002382        GO TO F30-EX.                                             
002383     IF LO22-OPERAZIOI(WINDRIGA) = '/' AND                        
002384        WPAG-RDTEVAOR(WINDRIGA) > SPACES                          
002385        MOVE '*'                 TO WSWERROR                      
002386        MOVE '02486'             TO MESS-CODERROR                 
002387        MOVE DFHUNIMD            TO LO22-OPERAZIOA (WINDRIGA)     
002388        MOVE DFHRED              TO LO22-OPERAZIOC (WINDRIGA)     
002389        MOVE -1                  TO LO22-OPERAZIOL (WINDRIGA)     
002390        GO TO F30-EX.                                             
002391     IF LO22-OPERAZIOI(WINDRIGA) = 'F' AND                        
002392        WPAG-RDTEVAOR(WINDRIGA) > SPACES                          
002393        MOVE '*'                 TO WSWERROR                      
002394        MOVE '02487'             TO MESS-CODERROR                 
002395        MOVE DFHUNIMD            TO LO22-OPERAZIOA (WINDRIGA)     
002396        MOVE DFHRED              TO LO22-OPERAZIOC (WINDRIGA)     
002397        MOVE -1                  TO LO22-OPERAZIOL (WINDRIGA)     
002398        GO TO F30-EX.                                             
002399     IF LO22-OPERAZIOI(WINDRIGA) = 'F' AND                        
002400        WPAG-FLAGSOSP(WINDRIGA) > SPACES                          
002401        MOVE '*'                 TO WSWERROR                      
002402        MOVE '00752'             TO MESS-CODERROR                 
002403        MOVE DFHUNIMD            TO LO22-OPERAZIOA (WINDRIGA)     
002404        MOVE DFHRED              TO LO22-OPERAZIOC (WINDRIGA)     
002405        MOVE -1                  TO LO22-OPERAZIOL (WINDRIGA)     
002406        GO TO F30-EX.                                             
002407     IF LO22-OPERAZIOI(WINDRIGA) = 'X' AND                        
002408        WPAG-RDTEVAOR(WINDRIGA) NOT > SPACES                      
002409        MOVE '*'                 TO WSWERROR                      
002410        MOVE '02488'             TO MESS-CODERROR                 
002411        MOVE DFHUNIMD            TO LO22-OPERAZIOA (WINDRIGA)     
002412        MOVE DFHRED              TO LO22-OPERAZIOC (WINDRIGA)     
002413        MOVE -1                  TO LO22-OPERAZIOL (WINDRIGA)     
002414        GO TO F30-EX.                                             
002415     IF LO22-OPERAZIOI(WINDRIGA) = 'X' AND                        
002416        WPAG-RAANUMFA(WINDRIGA) > SPACES                          
002417        MOVE '*'                 TO WSWERROR                      
002418        MOVE '02491'             TO MESS-CODERROR                 
002419        MOVE DFHUNIMD            TO LO22-OPERAZIOA (WINDRIGA)     
002420        MOVE DFHRED              TO LO22-OPERAZIOC (WINDRIGA)     
002421        MOVE -1                  TO LO22-OPERAZIOL (WINDRIGA)     
002422        GO TO F30-EX.                                             
002423     IF LO22-OPERAZIOI(WINDRIGA) = 'X'                            
002424        MOVE 'LOGX'        TO WTRANSID                            
002425        PERFORM F31-CONTROLLO-ABILITAZIONE                        
002426           THRU F31-EX                                            
002427        IF ERRORE                                                 
002428           MOVE DFHUNIMD         TO LO22-OPERAZIOA (WINDRIGA)     
002429           MOVE DFHRED           TO LO22-OPERAZIOC (WINDRIGA)     
002430           MOVE -1               TO LO22-OPERAZIOL (WINDRIGA)     
002431           GO TO F30-EX.                                          
002432     IF LO22-OPERAZIOI(WINDRIGA) = 'F' AND                        
002433        WPAG-RFLAGIVA(WINDRIGA) NOT = 'S'                         
002434        PERFORM F50-CTRL-ESENZIONE                                
002435           THRU F50-EX.                                           
002436     IF LO22-OPERAZIOI(WINDRIGA) = 'F'                            
002437        PERFORM F55-CTRL-FE                                       
002438           THRU F55-EX.                                           
002439     IF LO22-OPERAZIOI(WINDRIGA) = 'V' OR '*' OR 'N' OR 'R'       
002440        PERFORM F40-LANCIA-DETTAGLIO                              
002441           THRU F40-EX.                                           
002442 F30-EX. EXIT.                                                    
002443*----------------------------------------------------------------*
002444 F31-CONTROLLO-ABILITAZIONE.                                      
002445*----------------------------------------------------------------*
002446*   MOVE DFHVALUE(NOLOG)        TO WNOLOG.                        
002447*    EXEC CICS QUERY SECURITY                                     
002448*                    RESTYPE    ('TRANSACTION')                   
002449*                    RESID      (WTRANSID)                        
002450*                    LOGMESSAGE (WNOLOG)                          
002451*                    READ       (WCVDA)                           
002452*    END-EXEC.                                                    
002453                                                                  
002454* EXEC CICS ASSIGN USERID(WS-USER-ID) END-EXEC.                   
002455*    MOVE '"(             (      "   #00002292' TO DFHEIV0        
002456     MOVE X'222820202020202020202020' &                           
002457          X'202020282020202020202220' &                           
002458          X'2020233030303032323932' TO DFHEIV0                    
002459     CALL 'kxdfhei1' USING DFHEIV0,                               
002460           WS-USER-ID                                             
002461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002462                                                                  
002463     MOVE WTRANSID            TO WS-TRANS-ID.                     
002464     MOVE SPACES              TO WS-USER-READABLE.                
002465     CALL "querysec" USING WS-USER-ID WS-TRANS-ID                 
002466                     RETURNING                                    
002467                     INTO RETURN-VALUE.                           
002468**                                                                
002469     EVALUATE RETURN-VALUE                                        
002470        WHEN 88                                                   
002471* 88 IS HEX VALUE FOR 'X'                                         
002472             MOVE 'X'            TO WS-USER-READABLE              
002473        WHEN 32                                                   
002474* 32 IS HEX VALUE FOR SPACE                                       
002475             MOVE SPACES         TO WS-USER-READABLE              
002476     END-EVALUATE.                                                
002477**                                                                
002478*    IF WCVDA = DFHVALUE(NOTREADABLE)                             
002479     IF SUCCESSFUL                                                
002480        IF NOT-AUTHORIZED                                         
002481        MOVE '*'                 TO WSWERROR                      
002482        MOVE '00001'             TO MESS-CODERROR                 
002483        END-IF                                                    
002484     ELSE                                                         
002485        PERFORM Z00-ERRORE                                        
002486        THRU Z00-EX                                               
002487     END-IF.                                                      
002488     MOVE SPACES                 TO WTRANSID.                     
002489 F31-EX. EXIT.                                                    
002490*----------------------------------------------------------------*
002491 F40-LANCIA-DETTAGLIO.                                            
002492*----------------------------------------------------------------*
002493     MOVE WCOM-PAGIRICH          TO WCOM-PAGITRAN(WCOM-INDITRAN). 
002494     PERFORM SCRIVO-RICICLO                                       
002495        THRU SCRIVO-RICICLO-EX.                                   
002496     IF LO22-OPERAZIOI(WINDRIGA) = 'V'                            
002497        MOVE WPAG-RAANUMOR(WINDRIGA) TO WCOM-AANUMORD             
002498        MOVE 'V'                     TO WCOM-FLAGPRGM             
002499        MOVE 'LO20'                  TO WTRANSID                  
002500        PERFORM U05-START-TRANSID                                 
002501           THRU U05-EX.                                           
002502     IF LO22-OPERAZIOI(WINDRIGA) = '*'                            
002503        MOVE WPAG-RAANUMOR(WINDRIGA)     TO WCOM-AANUMORD         
002504        MOVE ZEROES                      TO WCOM-NRRIGORD         
002505        MOVE SPACES                      TO WCOM-FLAGPRGM         
002506        IF WPAG-RTIPSERV(WINDRIGA) = 'T'                          
002507           MOVE 'LO40'                   TO WTRANSID              
002508           MOVE SPACES                   TO WCOM-CODSOCIE         
002509                                            WCOM-SOCIEMER         
002510                                            WCOM-TIPOARTI         
002511                                            WCOM-TIPORECO         
002512                                            WCOM-DTFATTUR         
002513                                            WCOM-DTFATTUR         
002514                                            WCOM-PAESPROV         
002515                                            WCOM-PAESMERC         
002516                                            WCOM-CENCOSTA         
002517                                            WCOM-CENCOSTD         
002518                                            WCOM-NUMORDIN         
002519        ELSE                                                      
002520           MOVE 'LO45'                   TO WTRANSID              
002521        END-IF                                                    
002522        PERFORM U05-START-TRANSID                                 
002523           THRU U05-EX.                                           
002524     IF LO22-OPERAZIOI(WINDRIGA) = 'N'                            
002525        MOVE SPACES                      TO OR73-RIKIESTA         
002526        MOVE 'F'                         TO OR73-TINOTORD         
002527        MOVE WPAG-RAANUMOR(WINDRIGA)     TO OR73-AANUMORD         
002528        MOVE 'M2'                        TO OR73-MERCEMAG         
002529        MOVE SPACES                      TO OR73-TIPOORDI         
002530        MOVE WCOM-CODCLIEN               TO OR73-CODCLIEN         
002531        MOVE WPAG-DTCARORD(WINDRIGA)     TO OR73-DTCARICO         
002532        IF WPAG-RAANUMFA(WINDRIGA) > SPACES                       
002533           MOVE 'X'                      TO OR73-FLAGPROT         
002534        END-IF                                                    
002535        MOVE 'OR73'                      TO WTRANSID              
002536        MOVE OR73-RIKIESTA               TO WCOM-RIKIESTA         
002537        PERFORM U05-START-TRANSID                                 
002538           THRU U05-EX.                                           
002539     IF LO22-OPERAZIOI(WINDRIGA) = 'R'                            
002540        MOVE WPAG-OCODCLIE           TO WCOM-CODCLIEN             
002541        MOVE WPAG-RCODSOCI(WINDRIGA) TO WCOM-CODSOCIE             
002542        MOVE WPAG-RAANUMOR(WINDRIGA) TO WCOM-AANUMORD             
002543        MOVE WPAG-DTCARORD(WINDRIGA) TO WCOM-DTCARORD             
002544        MOVE WPAG-RDTFATTU(WINDRIGA) TO WCOM-DTFATTUR             
002545        MOVE 'LO80'                  TO WTRANSID                  
002546        PERFORM U05-START-TRANSID                                 
002547           THRU U05-EX.                                           
002548 F40-EX. EXIT.                                                    
002549*----------------------------------------------------------------*
002550 F50-CTRL-ESENZIONE.                                              
002551*----------------------------------------------------------------*
002552     MOVE WPAG-OCODCLIE                   TO A901-CODCLIEN        
002553     PERFORM L15-SELECT-CLIENTI                                   
002554        THRU L15-EX.                                              
002555     MOVE WPAG-RCODSOCI(WINDRIGA)         TO A531-CODSOCIE        
002556     PERFORM L10-SELECT-SOCIETA                                   
002557        THRU L10-EX                                               
002558     IF WPAG-RESENTIV(WINDRIGA) = '1' AND                         
002559        A901-PAESFATT = '000'         AND                         
002560        A531-CODPAESE = '000'                                     
002561        MOVE WCOM-DTCREAZI                TO AT66-DATESIVA        
002562        MOVE WCOM-DTCREAZI(1:4)           TO WS-ANNOANNO          
002563        MOVE WPAG-RCODSOCI(WINDRIGA)      TO A901-CODSOCIE        
002564        PERFORM L40-SELECT-ESENCLIE                               
002565           THRU L40-EX                                            
002566        IF AT66-IMPESNEW NOT > ZEROES                             
002567           MOVE '*'                  TO WSWERROR                  
002568           MOVE '02680'              TO MESS-CODERROR             
002569           MOVE DFHUNIMD             TO LO22-OPERAZIOA (WINDRIGA) 
002570           MOVE DFHRED               TO LO22-OPERAZIOC (WINDRIGA) 
002571           MOVE -1                   TO LO22-OPERAZIOL (WINDRIGA) 
002572        ELSE                                                      
002573           COMPUTE WS-IMPESNEW = AT66-IMPESNEW * 0,90             
002574           MOVE WPAG-RIMPORDI(WINDRIGA)  TO WS-VALRFAT2           
002575           IF WPAG-RCODDIVI(WINDRIGA) NOT = AT66-CODDIVIS         
002576              MOVE SPACES                    TO DCWCAMB           
002577              MOVE WS-VALRFAT2               TO CAMB-IMPORTOO (1) 
002578              MOVE WPAG-RCODDIVI(WINDRIGA)   TO CAMB-CODDIVIS     
002579              MOVE WCOM-DTCREAZI             TO CAMB-DTCAMBIO     
002580              MOVE AT66-CODDIVIS             TO CAMB-CODCAMBI     
002581              MOVE A531-CODDIVRI             TO CAMB-CODDRIFE     
002582              PERFORM W00-LINK-SCTCB10                            
002583                 THRU W00-EX                                      
002584              MOVE CAMB-CONTROVA (1)         TO WS-VALRFAT2       
002585           END-IF                                                 
002586           COMPUTE WS-TOTFATTU = AT66-IMPOFATT + WS-VALRFAT2      
002587           IF WS-TOTFATTU NOT < WS-IMPESNEW                       
002588              MOVE '*'               TO WSWERROR                  
002589              MOVE '02680'           TO MESS-CODERROR             
002590              MOVE DFHUNIMD          TO LO22-OPERAZIOA (WINDRIGA) 
002591              MOVE DFHRED            TO LO22-OPERAZIOC (WINDRIGA) 
002592              MOVE -1                TO LO22-OPERAZIOL (WINDRIGA).
002593 F50-EX. EXIT.                                                    
002594*----------------------------------------------------------------*
002595 F55-CTRL-FE.                                                     
002596*----------------------------------------------------------------*
002597     MOVE WPAG-OCODCLIE                   TO A901-CODCLIEN        
002598     PERFORM L15-SELECT-CLIENTI                                   
002599        THRU L15-EX.                                              
002600     IF A901-FLFATELE = 'S' AND                                   
002601        A901-CDDESTFE NOT > SPACES AND                            
002602        A901-INPECCLI NOT > SPACES                                
002603        MOVE '*'                     TO WSWERROR                  
002604        MOVE '02806'                 TO MESS-CODERROR             
002605        MOVE DFHUNIMD                TO LO22-OPERAZIOA (WINDRIGA) 
002606        MOVE DFHRED                  TO LO22-OPERAZIOC (WINDRIGA) 
002607        MOVE -1                      TO LO22-OPERAZIOL (WINDRIGA).
002608 F55-EX. EXIT.                                                    
002609*---------------------------------------------------------------* 
002610 G00-AGGIORNAMENTI.                                               
002611*---------------------------------------------------------------* 
002612     PERFORM G10-SCORRI-RIGHE                                     
002613        THRU G10-EX                                               
002614           VARYING WINDRIGA FROM 1 BY 1                           
002615             UNTIL WINDRIGA > WNUMRIGA.                           
002616     PERFORM U20-DELETE-TS                                        
002617        THRU U20-EX.                                              
002618     PERFORM U22-DELETE-TS2                                       
002619        THRU U22-EX.                                              
002620     MOVE WCOM-PAGIRICH          TO WCOM-PAGITRAN(WCOM-INDITRAN). 
002621     MOVE 99999                  TO WCOM-PAGIULTI.                
002622     MOVE ZERO                   TO WCOM-PAGIRICH                 
002623                                    WCOM-PAGILIST                 
002624                                    WPAGRICH.                     
002625     PERFORM E10-PREPARA-PAGINE                                   
002626        THRU E10-EX.                                              
002627     PERFORM E20-PAGINA-PRONTA                                    
002628        THRU E20-EX.                                              
002629     MOVE '00005'                TO MESS-CODERROR.                
002630 G00-EX. EXIT.                                                    
002631*---------------------------------------------------------------* 
002632 G10-SCORRI-RIGHE.                                                
002633*---------------------------------------------------------------* 
002634     IF LO22-OPERAZIOI(WINDRIGA) = '/'                            
002635        PERFORM G30-ANNULLA-RIGHE                                 
002636           THRU G30-EX                                            
002637        PERFORM G35-ANNULLA-TESTATA                               
002638           THRU G35-EX                                            
002639        PERFORM G40-AGGIORNA-DATAESTR                             
002640           THRU G40-EX                                            
002641        IF WPAG-RTIPSERV(WINDRIGA) = 'T'                          
002642           PERFORM G45-AGG-NETMOVEREXPO                           
002643              THRU G45-EX.                                        
002644     IF LO22-OPERAZIOI(WINDRIGA) = 'F' OR 'X'                     
002645        PERFORM G50-EVASIONE-ORDINE                               
002646           THRU G50-EX.                                           
002647 G10-EX. EXIT.                                                    
002648*---------------------------------------------------------------* 
002649 G30-ANNULLA-RIGHE.                                               
002650*---------------------------------------------------------------* 
002651     MOVE WPAG-RAANUMOR(WINDRIGA)  TO L653-AANUMORD.              
002652     MOVE WCOM-DTCREAZI            TO L653-DTULTVAR               
002653                                      L653-DTANNULL.              
002654     MOVE WCOM-UTENCICS            TO L653-CODUTVAR.              
002655     MOVE 'G30-'                   TO WCOM-CODABEND.              
002656     MOVE 'UPDATE'                 TO WCOM-FILEFUNZ.              
002657     MOVE 'RIGORDILOGI'            TO WCOM-FILENOME.              
002658     MOVE L653-AANUMORD            TO WCOM-FILECTRL.              
002660     
      *EXEC SQL 
      *UPDATE DLOGISTI.TRIGORDILOGI                            
002661*             SET DTANNULL = :L653-DTANNULL                        
002662*                ,DTULTVAR = :L653-DTULTVAR                        
002663*                ,CODUTVAR = :L653-CODUTVAR                        
002664*           WHERE AANUMORD = :L653-AANUMORD                        
002665*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 3 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-DTANNULL
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CODUTVAR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-AANUMORD
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 6 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002666     IF SQLCODE NOT = 0                                           
002667        PERFORM Z00-ERRORE                                        
002668           THRU Z00-EX.                                           
002669 G30-EX. EXIT.                                                    
002670*---------------------------------------------------------------* 
002671 G35-ANNULLA-TESTATA.                                             
002672*---------------------------------------------------------------* 
002673     MOVE WPAG-RAANUMOR(WINDRIGA)  TO L652-AANUMORD.              
002674     MOVE WCOM-DTCREAZI            TO L652-DTULTVAR               
002675                                      L652-DTANNULL.              
002676     MOVE WCOM-UTENCICS            TO L652-CODUTVAR.              
002677     MOVE SPACES                   TO L652-DATAESTR.              
002678     MOVE 'G35-'                   TO WCOM-CODABEND.              
002679     MOVE 'UPDATE'                 TO WCOM-FILEFUNZ.              
002680     MOVE 'ORDISCOR'               TO WCOM-FILENOME.              
002681     MOVE L652-AANUMORD            TO WCOM-FILECTRL.              
002683     
      *EXEC SQL 
      *UPDATE DLOGISTI.TORDILOGI                               
002684*             SET DTANNULL = :L652-DTANNULL                        
002685*                ,DTULTVAR = :L652-DTULTVAR                        
002686*                ,CODUTVAR = :L652-CODUTVAR                        
002687*                ,DATAESTR = :L652-DATAESTR                        
002688*           WHERE AANUMORD = :L652-AANUMORD                        
002689*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 4 TO SQL-STMT-ID 
           MOVE 5 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTANNULL
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODUTVAR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DATAESTR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMORD
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 7 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002690     IF SQLCODE NOT = 0                                           
002691        PERFORM Z00-ERRORE                                        
002692           THRU Z00-EX.                                           
002693 G35-EX. EXIT.                                                    
002694*---------------------------------------------------------------* 
002695 G40-AGGIORNA-DATAESTR.                                           
002696*---------------------------------------------------------------* 
002697*--- AGGIORNA DATA ESTRAZIONE SU TUTTI GLI ORDINI CHE HANNO UN    
002698*--- RIFERIMENTO ORDINE VESTEBENE UGUALE A QUELLO DELL'ORDINE     
002699*--- PUNTATO                                                      
002700     MOVE WPAG-RAANUMOR(WINDRIGA)  TO L652-AANUMORD.              
002701     MOVE WCOM-DTCREAZI            TO L652-DTULTVAR               
002702                                      L652-DTANNULL.              
002703     MOVE WCOM-UTENCICS            TO L652-CODUTVAR.              
002704     MOVE SPACES                   TO L652-DATAESTR.              
002705     MOVE 'G40-'                   TO WCOM-CODABEND.              
002706     MOVE 'UPDATE'                 TO WCOM-FILEFUNZ.              
002707     MOVE 'ORDISCOR'               TO WCOM-FILENOME.              
002708     MOVE L652-AANUMORD            TO WCOM-FILECTRL.              
002710     
      *EXEC SQL 
      *UPDATE DLOGISTI.TORDILOGI A                             
002711*             SET DTULTVAR = :L652-DTULTVAR                        
002712*                ,CODUTVAR = :L652-CODUTVAR                        
002713*                ,DATAESTR = :L652-DATAESTR                        
002714*           WHERE A.AANUMORD IN                                    
002715*         (SELECT B.AANUMORD                                       
002716*            FROM DLOGISTI.TRIGORDILOGI B                          
002717*                ,DLOGISTI.TRIGORDILOGI C                          
002718*                ,DLOGISTI.TORDILOGI    D                          
002719*           WHERE D.AANUMORD = :L652-AANUMORD                      
002720*             AND D.AANUMORD = C.AANUMORD                          
002721*             AND C.RIFECLIE > ' '                                 
002722*             AND C.RIFECLIE = B.RIFECLIE)                         
002723*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 5 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODUTVAR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DATAESTR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMORD
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 8 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002724 G40-EX. EXIT.                                                    
002725*----------------------------------------------------------------*
002726 G45-AGG-NETMOVEREXPO.                                            
002727*----------------------------------------------------------------*
002728     MOVE WPAG-RAANUMOR(WINDRIGA)   TO T358-AANUMORD.             
002729     MOVE 'G45-'                    TO WCOM-CODABEND              
002730     MOVE 'UPDATE'                  TO WCOM-FILEFUNZ              
002731     MOVE 'NETMOVEREXPO'            TO WCOM-FILENOME              
002732     MOVE T358-AANUMORD             TO WCOM-FILECTRL              
002734     
      *EXEC SQL 
      *UPDATE DTRASP.TNETMOVEREXPO                             
002735*             SET AANUMORD = ' '                                   
002736*                ,NRRIGORD = 0                                     
002737*           WHERE AANUMORD = :T358-AANUMORD                        
002738*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 6 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-AANUMORD
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 9 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002739 G45-EX. EXIT.                                                    
002740*---------------------------------------------------------------* 
002741 G50-EVASIONE-ORDINE.                                             
002742*---------------------------------------------------------------* 
002743     MOVE WPAG-RAANUMOR(WINDRIGA) TO L652-AANUMORD.               
002744     IF LO22-OPERAZIOI(WINDRIGA) = 'F'                            
002745        MOVE WCOM-DTCREAZI        TO L652-DTEVAORD                
002746     ELSE                                                         
002747        MOVE SPACES               TO L652-DTEVAORD.               
002748     MOVE WCOM-DTCREAZI           TO L652-DTULTVAR.               
002749     MOVE WCOM-UTENCICS           TO L652-CODUTVAR.               
002750     MOVE 'G50-'                  TO WCOM-CODABEND.               
002751     MOVE 'UPDATE'                TO WCOM-FILEFUNZ.               
002752     MOVE 'ORDILOGI'              TO WCOM-FILENOME.               
002753     MOVE L652-AANUMORD           TO WCOM-FILECTRL.               
002755     
      *EXEC SQL 
      *UPDATE DLOGISTI.TORDILOGI                               
002756*             SET DTEVAORD = :L652-DTEVAORD                        
002757*                ,DTULTVAR = :L652-DTULTVAR                        
002758*                ,CODUTVAR = :L652-CODUTVAR                        
002759*           WHERE AANUMORD = :L652-AANUMORD                        
002760*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 7 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTEVAORD
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODUTVAR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMORD
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 10 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002761     IF SQLCODE NOT = 0                                           
002762        PERFORM Z00-ERRORE                                        
002763           THRU Z00-EX.                                           
002764     IF WPAG-RESENTIV(WINDRIGA) = '1'                             
002765        MOVE WPAG-OCODCLIE                TO A901-CODCLIEN        
002766        PERFORM L15-SELECT-CLIENTI                                
002767           THRU L15-EX                                            
002768        MOVE WPAG-RCODSOCI(WINDRIGA)      TO A531-CODSOCIE        
002769        PERFORM L10-SELECT-SOCIETA                                
002770           THRU L10-EX                                            
002771        IF A901-PAESFATT = '000' AND                              
002772           A531-CODPAESE = '000'                                  
002773           MOVE SPACES                    TO DCWEIVA              
002774           INITIALIZE                        DCWEIVA              
002775           MOVE WPAG-RCODSOCI (WINDRIGA)  TO EIVA-CODSOCIE        
002776           MOVE WPAG-OCODCLIE             TO EIVA-CODCLIEN        
002777           MOVE 'O'                       TO EIVA-CDMOVCON        
002778           MOVE '+'                       TO EIVA-INDSEGNO        
002779           MOVE WPAG-RAANUMOR (WINDRIGA)  TO EIVA-AANUMFAT        
002780           MOVE WCOM-DTCREAZI             TO EIVA-DTFATTUR        
002781           MOVE WPAG-RCODDIVI (WINDRIGA)  TO EIVA-CODDIVIS        
002782           MOVE WPAG-RIMPORDI (WINDRIGA)  TO EIVA-VALRFATT        
002783           MOVE WCOM-DTCREAZI             TO EIVA-DTCREAZI        
002784           MOVE WCOM-UTENCICS             TO EIVA-CODUTVAR        
002785           IF LO22-OPERAZIOO(WINDRIGA) = 'F'                      
002786              MOVE 'I'                    TO EIVA-OPERAZIO        
002787              PERFORM W10-LINK-SCTEIVA                            
002788                 THRU W10-EX                                      
002789           ELSE                                                   
002790              MOVE 'D'                    TO EIVA-OPERAZIO        
002791              PERFORM W10-LINK-SCTEIVA                            
002792                 THRU W10-EX.                                     
002793 G50-EX. EXIT.                                                    
002794*---------------------------------------------------------------* 
002795 L00-FETCH-POINTER.                                               
002796*---------------------------------------------------------------* 
002797     MOVE 'L00-'                 TO WCOM-CODABEND.                
002798     MOVE 'FETCH'                TO WCOM-FILEFUNZ.                
002799     IF WCOM-AANUMFAT > SPACES                                    
002800        MOVE 'POINTER3'          TO WCOM-FILENOME                 
002802        
      *EXEC SQL 
      *FETCH POINTER3                                      
002803*               INTO :L652-AANUMORD, :L652-CODCLIEN                
002804*                   ,:L652-CODSOCIE, :L652-CDDIVISI                
002805*                   ,:L652-AAMMCOMP, :L652-CODDIVIS                
002806*                   ,:L652-TIPSERVI, :L652-FLAGAUTO                
002807*                   ,:L652-FLAGGIVA, :L652-CONTODCE                
002808*                   ,:L652-DTEVAORD, :L652-SOCIEMER                
002809*                   ,:L652-AANUMFAT, :L652-DTFATTUR                
002810*                   ,:L652-NRPREATT, :L652-DTPREATT                
002811*                   ,:L652-DATAESTR, :L652-FLAGSOSP                
002812*                   ,:L652-CODUTEVB, :L652-DTCARORD                
002813*                   ,:L652-ESENTIVA                                
002814*        END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 8 TO SQL-STMT-ID 
           MOVE 21 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMORD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODCLIEN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODSOCIE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CDDIVISI
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AAMMCOMP
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODDIVIS
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-TIPSERVI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-FLAGAUTO
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-FLAGGIVA
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CONTODCE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTEVAORD
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-SOCIEMER
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMFAT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTFATTUR
            BY VALUE 0
                     0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-NRPREATT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTPREATT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DATAESTR
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 17 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-FLAGSOSP
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 18 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODUTEVB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 19 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTCARORD
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 20 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-ESENTIVA
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
002815     ELSE                                                         
002816        IF WCOM-CODCLIEN > SPACES                                 
002817           MOVE 'POINTER1'       TO WCOM-FILENOME                 
002819           
      *EXEC SQL 
      *FETCH POINTER1                                   
002820*                  INTO :L652-AANUMORD, :L652-CODCLIEN             
002821*                      ,:L652-CODSOCIE, :L652-CDDIVISI             
002822*                      ,:L652-AAMMCOMP, :L652-CODDIVIS             
002823*                      ,:L652-TIPSERVI, :L652-FLAGAUTO             
002824*                      ,:L652-FLAGGIVA, :L652-CONTODCE             
002825*                      ,:L652-DTEVAORD, :L652-SOCIEMER             
002826*                      ,:L652-AANUMFAT, :L652-DTFATTUR             
002827*                      ,:L652-NRPREATT, :L652-DTPREATT             
002828*                      ,:L652-DATAESTR, :L652-FLAGSOSP             
002829*                      ,:L652-CODUTEVB, :L652-DTCARORD             
002830*                      ,:L652-ESENTIVA                             
002831*           END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 9 TO SQL-STMT-ID 
           MOVE 21 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMORD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODCLIEN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODSOCIE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CDDIVISI
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AAMMCOMP
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODDIVIS
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-TIPSERVI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-FLAGAUTO
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-FLAGGIVA
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CONTODCE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTEVAORD
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-SOCIEMER
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMFAT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTFATTUR
            BY VALUE 0
                     0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-NRPREATT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTPREATT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DATAESTR
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 17 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-FLAGSOSP
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 18 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODUTEVB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 19 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTCARORD
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 20 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-ESENTIVA
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
002832        ELSE                                                      
002833           MOVE 'POINTER2'       TO WCOM-FILENOME                 
002835           
      *EXEC SQL 
      *FETCH POINTER2                                   
002836*                  INTO :L652-AANUMORD, :L652-CODCLIEN             
002837*                      ,:L652-CODSOCIE, :L652-CDDIVISI             
002838*                      ,:L652-AAMMCOMP, :L652-CODDIVIS             
002839*                      ,:L652-TIPSERVI, :L652-FLAGAUTO             
002840*                      ,:L652-FLAGGIVA, :L652-CONTODCE             
002841*                      ,:L652-DTEVAORD, :L652-SOCIEMER             
002842*                      ,:L652-AANUMFAT, :L652-DTFATTUR             
002843*                      ,:L652-NRPREATT, :L652-DTPREATT             
002844*                      ,:L652-DATAESTR, :L652-FLAGSOSP             
002845*                      ,:L652-CODUTEVB, :L652-DTCARORD             
002846*                      ,:L652-ESENTIVA                             
002847*           END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 10 TO SQL-STMT-ID 
           MOVE 21 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMORD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODCLIEN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODSOCIE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CDDIVISI
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AAMMCOMP
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODDIVIS
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-TIPSERVI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-FLAGAUTO
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-FLAGGIVA
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CONTODCE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTEVAORD
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-SOCIEMER
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMFAT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTFATTUR
            BY VALUE 0
                     0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-NRPREATT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTPREATT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DATAESTR
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 17 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-FLAGSOSP
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 18 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODUTEVB
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 19 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTCARORD
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 20 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-ESENTIVA
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                         .                                              
002848     MOVE SQLCODE                TO WS-SQLCODE.                   
002849     IF SQLCODE NOT = 100                                         
002850        IF WCOM-NUMORDIN > SPACES AND                             
002851           L652-CODUTEVB NOT = WCOM-NUMORDIN                      
002852           GO TO L00-FETCH-POINTER.                               
002853 L00-EX. EXIT.                                                    
002854*----------------------------------------------------------------*
002855 L01-FETCH-POINTPF13.                                             
002856*----------------------------------------------------------------*
002857     MOVE 'L01-'                 TO WCOM-CODABEND.                
002858     MOVE 'FETCH'                TO WCOM-FILEFUNZ.                
002859     MOVE 'POINTPF13'            TO WCOM-FILENOME.                
002860     MOVE SPACES                 TO WCOM-FILECTRL.                
002861     STRING WS-CODCLIEN ' ' WS-RAGFATTU                           
002862        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
002864     
      *EXEC SQL 
      *FETCH POINTPF13                                         
002865*           INTO :A901-CODCLIEN, :A901-RAGFATTU                    
002866*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 11 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODCLIEN
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-RAGFATTU
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 4 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002867     MOVE SQLCODE                TO WS-SQLCODE2.                  
002868 L01-EX. EXIT.                                                    
002869*----------------------------------------------------------------*
002870 L02-FETCH-POINTPF14.                                             
002871*----------------------------------------------------------------*
002872     MOVE 'L02-'                 TO WCOM-CODABEND.                
002873     MOVE 'FETCH'                TO WCOM-FILEFUNZ.                
002874     MOVE 'POINTPF14'            TO WCOM-FILENOME.                
002875     MOVE SPACES                 TO WCOM-FILECTRL.                
002876     STRING WS-CODCLIEN ' ' WS-RAGFATTU                           
002877        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
002879     
      *EXEC SQL 
      *FETCH POINTPF14                                         
002880*           INTO :A901-CODCLIEN, :A901-RAGFATTU                    
002881*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 12 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODCLIEN
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-RAGFATTU
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 5 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002882     MOVE SQLCODE                TO WS-SQLCODE2.                  
002883 L02-EX. EXIT.                                                    
002884*----------------------------------------------------------------*
002885 L05-SEL-SUM-IMPORTO.                                             
002886*----------------------------------------------------------------*
002887     MOVE 'L05-'                 TO WCOM-CODABEND                 
002888     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002889     MOVE 'DETTORDIS'            TO WCOM-FILENOME.                
002890     MOVE L653-AANUMORD          TO WCOM-FILECTRL.                
002891     MOVE ZEROES                 TO L653-IMPORDIN.                
002892     MOVE ZEROES                 TO L653-QTAORDIN.                
002894     
      *EXEC SQL 
      *SELECT VALUE(SUM(IMPORDIN), 0)                          
002895*                ,VALUE(SUM(QTAORDIN), 0)                          
002896*            INTO :L653-IMPORDIN                                   
002897*                ,:L653-QTAORDIN                                   
002898*            FROM DLOGISTI.TRIGORDILOGI                            
002899*           WHERE AANUMORD = :L653-AANUMORD                        
002900*             AND DTANNULL = ' '                                   
002901*      END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 13 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-AANUMORD
            BY VALUE 0
                     0

           MOVE 14 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-IMPORDIN
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-QTAORDIN
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 11 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                    .                                                   
002902 L05-EX. EXIT.                                                    
002903*----------------------------------------------------------------*
002904 L06-SEL-SUM-IMPORTO.                                             
002905*----------------------------------------------------------------*
002906     MOVE 'L06-'                 TO WCOM-CODABEND                 
002907     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002908     MOVE 'DETTORDIS'            TO WCOM-FILENOME.                
002909     MOVE L653-AANUMORD          TO WCOM-FILECTRL.                
002910     MOVE ZEROES                 TO L653-IMPORDIN.                
002911     MOVE ZEROES                 TO L653-QTAORDIN.                
002913     
      *EXEC SQL 
      *SELECT VALUE(SUM(IMPORDIN), 0)                          
002914*                ,VALUE(SUM(QTAORDIN), 0)                          
002915*            INTO :L653-IMPORDIN                                   
002916*                ,:L653-QTAORDIN                                   
002917*            FROM DLOGISTI.TRIGORDILOGI R                          
002918*                ,DLOGISTI.TSERVIZI     S                          
002919*           WHERE R.AANUMORD = :L653-AANUMORD                      
002920*             AND R.CODSERVI = S.CODSERVI                          
002921*             AND DTANNULL = ' '                                   
002922*             AND R.CODSERVI LIKE :WS-CODSERVI                     
002923*             AND R.CENCOSTA LIKE :WS-CENCOSTA                     
002924*             AND R.CENCOSTD LIKE :WS-CENCOSTD                     
002925*             AND S.DESSERVI LIKE :WS-DESSERVI                     
002926*      END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 15 TO SQL-STMT-ID 
           MOVE 5 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-AANUMORD
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CODSERVI
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CENCOSTA
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CENCOSTD
            BY VALUE 0
                     0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DESSERVI
            BY VALUE 0
                     0

           MOVE 16 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-IMPORDIN
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-QTAORDIN
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 12 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                    .                                                   
002927 L06-EX. EXIT.                                                    
002928*----------------------------------------------------------------*
002929 L07-SELECT-TRIFORDILOGI.                                         
002930*----------------------------------------------------------------*
002931     MOVE 'L07-'                 TO WCOM-CODABEND                 
002932     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002933     MOVE 'RIFORDIL'             TO WCOM-FILENOME.                
002934     MOVE L430-AANUMORD          TO WCOM-FILECTRL.                
002936     
      *EXEC SQL 
      *SELECT AANUMORD                                         
002937*            INTO :L430-AANUMORD                                   
002938*            FROM DLOGISTI.TRIFORDILOGI                            
002939*           WHERE AANUMORD = :L430-AANUMORD                        
002940*           FETCH FIRST ROW ONLY                                   
002941*      END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 17 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L430-AANUMORD
            BY VALUE 0
                     0

           MOVE 18 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L430-AANUMORD
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 13 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                    .                                                   
002942 L07-EX. EXIT.                                                    
002943*---------------------------------------------------------------* 
002944 L10-SELECT-SOCIETA.                                              
002945*---------------------------------------------------------------* 
002946     MOVE 'L10-'                 TO WCOM-CODABEND.                
002947     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002948     MOVE 'TSOCIETA'             TO WCOM-FILENOME.                
002949     MOVE A531-CODSOCIE          TO WCOM-FILECTRL.                
002951     
      *EXEC SQL 
      *SELECT CODSOCIE, NOMSOCIE                               
002952*                ,CODDIVRI, CODPAESE                               
002953*            INTO :A531-CODSOCIE, :A531-NOMSOCIE                   
002954*                ,:A531-CODDIVRI, :A531-CODPAESE                   
002955*            FROM DANAGRAF.TSOCIETA                                
002956*           WHERE CODSOCIE = :A531-CODSOCIE                        
002957*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 19 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 20 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 23 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-NOMSOCIE
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODDIVRI
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODPAESE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 14 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002958 L10-EX. EXIT.                                                    
002959*---------------------------------------------------------------* 
002960 L15-SELECT-CLIENTI.                                              
002961*---------------------------------------------------------------* 
002962     MOVE 'L15-'                 TO WCOM-CODABEND.                
002963     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002964     MOVE 'CLIENTI'              TO WCOM-FILENOME.                
002965     MOVE A901-CODCLIEN          TO WCOM-FILECTRL.                
002966     MOVE SPACES                 TO A901-CODSOCIE.                
002967     MOVE SPACES                 TO A901-ESENTIVA.                
002968     MOVE ALL '?'                TO A901-RAGFATTU.                
002970     
      *EXEC SQL 
      *SELECT CODSOCIE, RAGFATTU                               
002971*                ,ESENTIVA, CODSOCIE                               
002972*                ,PAESFATT, CAPOCONT                               
002973*                ,CODFISCA, FLFATELE                               
002974*                ,CDDESTFE, INPECCLI                               
002975*            INTO :A901-CODSOCIE, :A901-RAGFATTU                   
002976*                ,:A901-ESENTIVA, :A901-CODSOCIE                   
002977*                ,:A901-PAESFATT, :A901-CAPOCONT                   
002978*                ,:A901-CODFISCA, :A901-FLFATELE                   
002979*                ,:A901-CDDESTFE, :A901-INPECCLI                   
002980*            FROM DANAGRAF.TCLIENTI                                
002981*           WHERE CODCLIEN = :A901-CODCLIEN                        
002982*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 21 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODCLIEN
            BY VALUE 0
                     0

           MOVE 22 TO SQL-STMT-ID 
           MOVE 10 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODSOCIE
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-RAGFATTU
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-ESENTIVA
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODSOCIE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-PAESFATT
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CAPOCONT
            BY VALUE 0
                     0

           MOVE 16 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODFISCA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-FLFATELE
            BY VALUE 0
                     0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CDDESTFE
            BY VALUE 0
                     0

           MOVE 50 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-INPECCLI
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 15 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002983 L15-EX. EXIT.                                                    
002984*---------------------------------------------------------------* 
002985 L17-SELECT-RAGFATTU.                                             
002986*---------------------------------------------------------------* 
002987     PERFORM C17-DESCRIZIONE-MAPPA                                
002988        THRU C17-EX.                                              
002989     MOVE 'L17-'                 TO WCOM-CODABEND.                
002990     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002991     MOVE 'CLIENTI'              TO WCOM-FILENOME.                
002992     MOVE WS-RAGFATTU            TO WCOM-FILECTRL.                
002993     MOVE LOW-VALUE              TO MIN-CODSOCIE.                 
002994     MOVE ALL 'Z'                TO MAX-CODSOCIE.                 
002995     IF LO22-CODSOCIEO > SPACES                                   
002996        MOVE LO22-CODSOCIEO      TO MIN-CODSOCIE                  
002997                                    MAX-CODSOCIE.                 
002998     MOVE SPACES                 TO A901-CODSOCIE.                
002999     MOVE SPACES                 TO A901-CODCLIEN.                
003000     MOVE ALL '?'                TO A901-RAGFATTU.                
003002     
      *EXEC SQL 
      *SELECT X.ORDINAME, X.CODSOCIE                           
003003*                ,X.CODCLIEN, X.RAGFATTU                           
003004*            INTO :WSWS-ORDINAME, :A901-CODSOCIE                   
003005*                ,:A901-CODCLIEN, :A901-RAGFATTU                   
003006*            FROM (                                                
003007*            SELECT '1' AS ORDINAME, C.CODSOCIE                    
003008*                       ,C.CODCLIEN, C.RAGFATTU                    
003009*              FROM DANAGRAF.TCLIENTI C                            
003010*                  ,DLOGISTI.TORDILOGI O                           
003011*             WHERE C.RAGFATTU LIKE :WS-RAGFATTU                   
003012*               AND C.CODSOCIE BETWEEN :MIN-CODSOCIE               
003013*                                  AND :MAX-CODSOCIE               
003014*               AND C.CODCLIEN=O.CODCLIEN                          
003015*               AND O.DTANNULL = ' '                               
003016*            UNION ALL                                             
003017*            SELECT '2' AS ORDINAME, C.CODSOCIE                    
003018*                       ,C.CODCLIEN, C.RAGFATTU                    
003019*              FROM DANAGRAF.TCLIENTI C                            
003020*             WHERE C.RAGFATTU LIKE :WS-RAGFATTU                   
003021*               AND C.CODSOCIE BETWEEN :MIN-CODSOCIE               
003022*                                  AND :MAX-CODSOCIE               
003023*               AND NOT EXISTS (SELECT O.AANUMORD                  
003024*                                 FROM DLOGISTI.TORDILOGI O        
003025*                                WHERE C.CODCLIEN = O.CODCLIEN     
003026*                                  AND O.DTANNULL = ' ')           
003027*                 ) AS X                                           
003028*             ORDER BY 1, 2                                        
003029*             FETCH FIRST ROW ONLY                                 
003030*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 23 TO SQL-STMT-ID 
           MOVE 6 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-RAGFATTU
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-CODSOCIE
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-CODSOCIE
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-RAGFATTU
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-CODSOCIE
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-CODSOCIE
            BY VALUE 0
                     0

           MOVE 24 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WSWS-ORDINAME
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODSOCIE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODCLIEN
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-RAGFATTU
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 16 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003031 L17-EX. EXIT.                                                    
003032*---------------------------------------------------------------* 
003033 L18-SELECT-SERVIZI.                                              
003034*---------------------------------------------------------------* 
003035     MOVE 'L18-'                 TO WCOM-CODABEND.                
003036     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003037     MOVE 'SERVIZI'              TO WCOM-FILENOME.                
003038     MOVE L651-CODSERVI          TO WCOM-FILECTRL.                
003039     MOVE ALL '?'                TO L651-DESSERVI.                
003041     
      *EXEC SQL 
      *SELECT DESSERVI                                         
003042*            INTO :L651-DESSERVI                                   
003043*            FROM DLOGISTI.TSERVIZI                                
003044*           WHERE CODSERVI = :L651-CODSERVI                        
003045*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 25 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CODSERVI
            BY VALUE 0
                     0

           MOVE 26 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-DESSERVI
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 17 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003046 L18-EX. EXIT.                                                    
003047*----------------------------------------------------------------*
003048 L20-SELECT-ORDILOGI-FATT.                                        
003049*----------------------------------------------------------------*
003050     MOVE 'L20-'                 TO WCOM-CODABEND.                
003051     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003052     MOVE 'ORDILOGI'             TO WCOM-FILENOME.                
003053     MOVE L652-AANUMFAT          TO WCOM-FILECTRL.                
003054     MOVE SPACES                 TO L652-CODSOCIE.                
003056     
      *EXEC SQL 
      *SELECT DISTINCT CODSOCIE                               
003057*             INTO :L652-CODSOCIE                                  
003058*             FROM DLOGISTI.TORDILOGI                              
003059*            WHERE AANUMFAT = :L652-AANUMFAT                       
003060*              AND DTANNULL = ' '                                  
003061*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 27 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMFAT
            BY VALUE 0
                     0

           MOVE 28 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODSOCIE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 18 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003062 L20-EX. EXIT.                                                    
003063*----------------------------------------------------------------*
003064 L30-SELECT-DATEELAB.                                             
003065*----------------------------------------------------------------*
003066     MOVE 'MENSILE'              TO A847-SIGLDATA                 
003067     MOVE 'L30-'                 TO WCOM-CODABEND.                
003068     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003069     MOVE 'DATEELAB'             TO WCOM-FILENOME.                
003070     MOVE A847-SIGLDATA          TO WCOM-FILECTRL.                
003071     MOVE SPACES                 TO A847-DTINELAB.                
003073     
      *EXEC SQL 
      *SELECT DTINELAB                                        
003074*             INTO :A847-DTINELAB                                  
003075*             FROM DANAGRAF.TDATEELAB                              
003076*            WHERE SIGLDATA = :A847-SIGLDATA                       
003077*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 29 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A847-SIGLDATA
            BY VALUE 0
                     0

           MOVE 30 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A847-DTINELAB
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 19 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003078 L30-EX. EXIT.                                                    
003079*----------------------------------------------------------------*
003080 L40-SELECT-ESENCLIE.                                             
003081*----------------------------------------------------------------*
003082     MOVE 'L40--'                TO WCOM-CODABEND.                
003083     MOVE 'ESENCLIE'             TO WCOM-FILENOME.                
003084     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003085     MOVE  SPACES                TO WCOM-FILECTRL.                
003086     STRING A901-CODSOCIE ' ' A901-CAPOCONT ' ' A901-PAESFATT' '  
003087            A901-CODFISCA                                         
003088        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
003089     MOVE ZEROES                 TO AT66-IMPESNEW                 
003090     MOVE ZEROES                 TO AT66-IMPOFATT                 
003092     
      *EXEC SQL 
      *SELECT VALUE(SUM(A.IMPESNEW), 0)                        
003093*                ,VALUE(SUM(A.IMPOFATT), 0)                        
003094*                ,A.CODCLIEN, A.CODDIVIS                           
003095*            INTO :AT66-IMPESNEW, :AT66-IMPOFATT                   
003096*                ,:AT66-CODCLIEN, :AT66-CODDIVIS                   
003097*            FROM DANAGRAF.TESENCLIE A                             
003098*                ,DANAGRAF.TCLIENTI  C                             
003099*           WHERE C.CODSOCIE = :A901-CODSOCIE                      
003100*             AND C.PAESFATT = :A901-PAESFATT                      
003101*             AND C.CAPOCONT = :A901-CAPOCONT                      
003102*             AND C.CODFISCA = :A901-CODFISCA                      
003103*             AND A.CODCLIEN = C.CODCLIEN                          
003104*             AND A.DATESIVA <= :AT66-DATESIVA                     
003105*             AND LEFT(A.DATESIVA, 4) = :WS-ANNOANNO               
003106*             AND A.DATASALD = ' '                                 
003107*          GROUP BY A.CODCLIEN, A.CODDIVIS                         
003108*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 31 TO SQL-STMT-ID 
           MOVE 6 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODSOCIE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-PAESFATT
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CAPOCONT
            BY VALUE 0
                     0

           MOVE 16 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODFISCA
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE AT66-DATESIVA
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-ANNOANNO
            BY VALUE 0
                     0

           MOVE 32 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 523 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE AT66-IMPESNEW
            BY VALUE 0
                     0

           MOVE 523 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE AT66-IMPOFATT
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE AT66-CODCLIEN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE AT66-CODDIVIS
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 20 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003109 L40-EX. EXIT.                                                    
003110*----------------------------------------------------------------*
003111 L50-SELECT-24XTCS.                                               
003112*----------------------------------------------------------------*
003113     MOVE 'L55-'                 TO WCOM-CODABEND                 
003114     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003115     MOVE 'RIGORDILOGI'          TO WCOM-FILENOME.                
003116     MOVE L653-AANUMORD          TO WCOM-FILECTRL.                
003118     
      *EXEC SQL 
      *SELECT DISTINCT AANUMORD                                
003119*            INTO :L653-AANUMORD                                   
003120*            FROM DLOGISTI.TRIGORDILOGI                            
003121*           WHERE AANUMORD = :L653-AANUMORD                        
003122*             AND DTANNULL = ' '                                   
003123*             AND CODSERVI = '24XTCS'                              
003124*      END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 33 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-AANUMORD
            BY VALUE 0
                     0

           MOVE 34 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-AANUMORD
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 21 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                    .                                                   
003125 L50-EX. EXIT.                                                    
003126*----------------------------------------------------------------*
003127 O00-OPEN-POINTER.                                                
003128*----------------------------------------------------------------*
003129     MOVE WCOM-CODSOCIE          TO L652-CODSOCIE.                
003130     MOVE WCOM-CODCLIEN          TO L652-CODCLIEN.                
003131     MOVE WCOM-AANUMFAT          TO L652-AANUMFAT.                
003132     MOVE WCOM-CONTODCE          TO WS-CONTODCE.                  
003133     INSPECT WS-CONTODCE REPLACING ALL SPACES BY '%'.             
003134     MOVE WCOM-CENCOSTD          TO WS-CENCOSTD.                  
003135     INSPECT WS-CENCOSTD REPLACING ALL SPACES BY '%'.             
003136     MOVE WCOM-CENCOSTA          TO WS-CENCOSTA.                  
003137     INSPECT WS-CENCOSTA REPLACING ALL SPACES BY '%'.             
003138     MOVE WCOM-CODSERVI          TO WS-CODSERVI                   
003139     INSPECT WS-CODSERVI   REPLACING ALL SPACES BY '%'.           
003140     IF WCOM-CODSERVI = '??????'                                  
003141        MOVE ' '                 TO WS-CODSERVI(1:1)              
003142        MOVE ALL '%'             TO WS-CODSERVI(2:5).             
003143     MOVE WCOM-DESSERVI          TO WS-DESSERVI                   
003144     INSPECT WS-DESSERVI   REPLACING ALL SPACES BY '%'.           
003145     MOVE LOW-VALUE              TO MIN-TIPSERVI.                 
003146*    MOVE ALL '9'                TO MAX-TIPSERVI.                 
003147     MOVE ALL 'Z'                TO MAX-TIPSERVI.                 
003148     IF WCOM-TIPSERVI > SPACES                                    
003149        MOVE WCOM-TIPSERVI       TO MIN-TIPSERVI                  
003150        MOVE WCOM-TIPSERVI       TO MAX-TIPSERVI.                 
003151     IF WCOM-MENUTRAN(1) NOT = 'LOGI'                             
003152        MOVE 'L'                 TO MIN-TIPSERVI                  
003153                                    MAX-TIPSERVI.                 
003154     MOVE WCOM-DTCARORD          TO MIN-AAMMCOMP(1:4)             
003155                                    MAX-AAMMCOMP(1:4)             
003156     MOVE '01'                   TO MIN-AAMMCOMP(5:2)             
003157     MOVE '12'                   TO MAX-AAMMCOMP(5:2)             
003158     IF WCOM-DTCARORD(5:2) > SPACES                               
003159        MOVE WCOM-DTCARORD(5:2)  TO MIN-AAMMCOMP(5:2)             
003160                                    MAX-AAMMCOMP(5:2).            
003161     MOVE '        '             TO MIN-DTEVAORD.                 
003162     MOVE '99999999'             TO MAX-DTEVAORD.                 
003163     MOVE '        '             TO MIN-DTFATTUR.                 
003164     MOVE '        '             TO MAX-DTFATTUR.                 
003165*    IF WCOM-STATUSXX = 'E'                                       
003166*       MOVE '00000000'          TO MIN-DTEVAORD                  
003167*       MOVE '99999999'          TO MAX-DTEVAORD                  
003168*       MOVE SPACES              TO MIN-DTFATTUR                  
003169*                                   MAX-DTFATTUR.                 
003170     IF WCOM-STATUSXX = 'F'                                       
003171        MOVE '00000000'          TO MIN-DTEVAORD                  
003172        MOVE '99999999'          TO MAX-DTEVAORD                  
003173        MOVE '00000000'          TO MIN-DTFATTUR                  
003174        MOVE '99999999'          TO MAX-DTFATTUR.                 
003175     IF WCOM-STATUSXX = 'T'                                       
003176        MOVE '        '          TO MIN-DTEVAORD                  
003177        MOVE '99999999'          TO MAX-DTEVAORD                  
003178        MOVE '        '          TO MIN-DTFATTUR                  
003179        MOVE '99999999'          TO MAX-DTFATTUR.                 
003180     MOVE LOW-VALUE              TO MIN-FLAGSOSP.                 
003181*    MOVE ALL '9'                TO MAX-FLAGSOSP.                 
003182     MOVE ALL 'Z'                TO MAX-FLAGSOSP.                 
003183     IF WCOM-SALDATOX = 'S'                                       
003184        MOVE 'S'                 TO MIN-FLAGSOSP                  
003185                                    MAX-FLAGSOSP.                 
003186     IF WCOM-SALDATOX = 'N'                                       
003187        MOVE ' '                 TO MIN-FLAGSOSP                  
003188                                    MAX-FLAGSOSP.                 
003189     MOVE 'O00-'                 TO WCOM-CODABEND.                
003190     MOVE 'OPEN'                 TO WCOM-FILEFUNZ                 
003191     STRING WCOM-CODSOCIE ' ' WCOM-CODCLIEN                       
003192            WCOM-CODSERVI ' ' WCOM-RAGFATTU                       
003193            WCOM-TIPSERVI ' ' WCOM-CONTODCE                       
003194            WCOM-AANUMFAT                                         
003195     DELIMITED BY SIZE         INTO WCOM-FILECTRL.                
003196     IF WCOM-AANUMFAT > SPACES                                    
003197        MOVE 'POINTER3'          TO WCOM-FILENOME                 
003198        
      *EXEC SQL OPEN POINTER3 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 35 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODSOCIE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMFAT
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
003199     ELSE                                                         
003200        IF WCOM-CODCLIEN > SPACES                                 
003201           MOVE 'POINTER1'       TO WCOM-FILENOME                 
003202           
      *EXEC SQL OPEN POINTER1 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 36 TO SQL-STMT-ID 
           MOVE 17 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODSOCIE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODCLIEN
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CONTODCE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-TIPSERVI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-TIPSERVI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-AAMMCOMP
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-AAMMCOMP
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-DTEVAORD
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-DTEVAORD
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-DTFATTUR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-DTFATTUR
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-FLAGSOSP
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-FLAGSOSP
            BY VALUE 0
                     0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DESSERVI
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CODSERVI
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CENCOSTD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CENCOSTA
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
003203        ELSE                                                      
003204           MOVE 'POINTER2'       TO WCOM-FILENOME                 
003205           
      *EXEC SQL OPEN POINTER2 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 37 TO SQL-STMT-ID 
           MOVE 16 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODSOCIE
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CONTODCE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-TIPSERVI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-TIPSERVI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-AAMMCOMP
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-AAMMCOMP
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-DTEVAORD
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-DTEVAORD
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-DTFATTUR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-DTFATTUR
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-FLAGSOSP
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-FLAGSOSP
            BY VALUE 0
                     0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DESSERVI
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CODSERVI
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CENCOSTD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CENCOSTA
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                .                       
003206 O00-EX. EXIT.                                                    
003207*----------------------------------------------------------------*
003208 O10-CLOSE-POINTER.                                               
003209*----------------------------------------------------------------*
003210     MOVE 'O10-'                 TO WCOM-CODABEND.                
003211     MOVE 'CLOSE'                TO WCOM-FILEFUNZ                 
003212     STRING WCOM-CODSOCIE ' ' WCOM-CODCLIEN                       
003213            WCOM-CODSERVI ' ' WCOM-RAGFATTU                       
003214            WCOM-TIPSERVI ' ' WCOM-CONTODCE                       
003215            WCOM-AANUMFAT                                         
003216     DELIMITED BY SIZE         INTO WCOM-FILECTRL.                
003217     IF WCOM-AANUMFAT > SPACES                                    
003218        MOVE 'POINTER3'          TO WCOM-FILENOME                 
003219        
      *EXEC SQL CLOSE POINTER3 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
003220     ELSE                                                         
003221        IF WCOM-CODCLIEN > SPACES                                 
003222           MOVE 'POINTER1'       TO WCOM-FILENOME                 
003223           
      *EXEC SQL CLOSE POINTER1 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
003224        ELSE                                                      
003225           MOVE 'POINTER2'       TO WCOM-FILENOME                 
003226           
      *EXEC SQL CLOSE POINTER2 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                 .                      
003227 O10-EX. EXIT.                                                    
003228*----------------------------------------------------------------*
003229 P00-ATTRIBUTI-RIGA.                                              
003230*----------------------------------------------------------------*
003231     IF WPAG-RAANUMOR(WINDRIGA) NOT > SPACES                      
003232        MOVE DFHBLUE             TO LO22-OPERAZIOC(WINDRIGA)      
003233        MOVE DFHDFHI             TO LO22-OPERAZIOH(WINDRIGA)      
003234        MOVE DFHBMASF            TO LO22-OPERAZIOA(WINDRIGA).     
003235     IF WPAG-RNRPREAT(WINDRIGA) > SPACES                          
003236        MOVE DFHYELLO            TO LO22-RAANUMORC(WINDRIGA).     
003237     IF WPAG-DATAESTR(WINDRIGA) > SPACES                          
003238        MOVE DFHPINK             TO LO22-RAANUMORC(WINDRIGA).     
003239     IF WPAG-FLAGSOSP(WINDRIGA) > SPACES                          
003240        MOVE DFHNEUTR            TO LO22-RAANUMORC(WINDRIGA).     
003241     IF WPAG-FLAGRIFE(WINDRIGA) > SPACES                          
003242        MOVE DFHTURQ             TO LO22-RAAMMCOMC(WINDRIGA).     
003243 P00-EX. EXIT.                                                   
003244*----------------------------------------------------------------*
003245 R00-READQ-WPAGCTRL.                                              
003246*----------------------------------------------------------------*
003247     MOVE SPACES                 TO WPAGREFE.                     
003248     INITIALIZE                     WPAGREFE.                     
003249                                                                  
003250* EXEC CICS HANDLE CONDITION ITEMERR (R00-EX)                     
003251*                               QIDERR  (R00-EX)                  
003252*    END-EXEC.                                                    
003253*    MOVE '"$<N                  ! $ #00003079' TO DFHEIV0        
003254     MOVE X'22243C4E2020202020202020' &                           
003255          X'202020202020202020202120' &                           
003256          X'2420233030303033303739' TO DFHEIV0                    
003257     CALL 'kxdfhei1' USING DFHEIV0                                
003258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003259                                                                  
003260                                                                  
003261* EXEC CICS READQ  TS QUEUE   (WPAGCTRL)                          
003262*                        INTO    (WPAGREFE)                       
003263*                        ITEM    (WNUMITEM)                       
003264*                        LENGTH  (WPAGLPAG)                       
003265*                        END-EXEC.                                
003266*    MOVE '*$II   L              ''   #00003082' TO DFHEIV0       
003267     MOVE X'2A2449492020204C20202020' &                           
003268          X'202020202020202020202720' &                           
003269          X'2020233030303033303832' TO DFHEIV0                    
003270     CALL 'kxdfhei1' USING DFHEIV0,                               
003271           WPAGCTRL,                                              
003272           WPAGREFE,                                              
003273           WPAGLPAG,                                              
003274           WNUMITEM,                                              
003275           DFHEIV99,                                              
003276           DFHEIV99                                               
003277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003278                                                                  
003279 R00-EX. EXIT.                                                    
003280*----------------------------------------------------------------*
003281 R10-READQ-WPAGCTR2.                                              
003282*----------------------------------------------------------------*
003283     MOVE SPACES                 TO WPAGREF2.                     
003284     INITIALIZE                     WPAGREF2.                     
003285                                                                  
003286* EXEC CICS HANDLE CONDITION ITEMERR (R10-EX)                     
003287*                               QIDERR  (R10-EX)                  
003288*    END-EXEC.                                                    
003289*    MOVE '"$<N                  ! % #00003093' TO DFHEIV0        
003290     MOVE X'22243C4E2020202020202020' &                           
003291          X'202020202020202020202120' &                           
003292          X'2520233030303033303933' TO DFHEIV0                    
003293     CALL 'kxdfhei1' USING DFHEIV0                                
003294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003295                                                                  
003296                                                                  
003297* EXEC CICS READQ  TS QUEUE   (WPAGCTR2)                          
003298*                        INTO    (WPAGREF2)                       
003299*                        ITEM    (1)                              
003300*                        LENGTH  (WPAGLPA2)                       
003301*                        END-EXEC.                                
003302     MOVE 1                                                       
003303       TO DFHEIV11                                                
003304*    MOVE '*$II   L              ''   #00003096' TO DFHEIV0       
003305     MOVE X'2A2449492020204C20202020' &                           
003306          X'202020202020202020202720' &                           
003307          X'2020233030303033303936' TO DFHEIV0                    
003308     CALL 'kxdfhei1' USING DFHEIV0,                               
003309           WPAGCTR2,                                              
003310           WPAGREF2,                                              
003311           WPAGLPA2,                                              
003312           DFHEIV11,                                              
003313           DFHEIV99,                                              
003314           DFHEIV99                                               
003315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003316                                                                  
003317 R10-EX. EXIT.                                                    
003318*----------------------------------------------------------------*
003319 R20-WRITEQ-WPAG.                                                 
003320*----------------------------------------------------------------*
003321     ADD  1                      TO WCOM-PAGILIST.                
003322                                                                  
003323* EXEC CICS WRITEQ TS    QUEUE (WPAGCTRL)                         
003324*                           FROM  (WPAGREFE)                      
003325*                           LENGTH(WPAGLPAG)                      
003326*                           END-EXEC.                             
003327*    MOVE '*"     L              ''   #00003106' TO DFHEIV0       
003328     MOVE X'2A2220202020204C20202020' &                           
003329          X'202020202020202020202720' &                           
003330          X'2020233030303033313036' TO DFHEIV0                    
003331     CALL 'kxdfhei1' USING DFHEIV0,                               
003332           WPAGCTRL,                                              
003333           WPAGREFE,                                              
003334           WPAGLPAG,                                              
003335           DFHEIV99,                                              
003336           DFHEIV99,                                              
003337           DFHEIV99                                               
003338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003339                                                                  
003340 R20-EX. EXIT.                                                    
003341*----------------------------------------------------------------*
003342 R22-WRITEQ-WPA2.                                                 
003343*----------------------------------------------------------------*
003344                                                                  
003345* EXEC CICS WRITEQ TS    QUEUE (WPAGCTR2)                         
003346*                           FROM  (WPAGREF2)                      
003347*                           LENGTH(WPAGLPA2)                      
003348*                           END-EXEC.                             
003349*    MOVE '*"     L              ''   #00003114' TO DFHEIV0       
003350     MOVE X'2A2220202020204C20202020' &                           
003351          X'202020202020202020202720' &                           
003352          X'2020233030303033313134' TO DFHEIV0                    
003353     CALL 'kxdfhei1' USING DFHEIV0,                               
003354           WPAGCTR2,                                              
003355           WPAGREF2,                                              
003356           WPAGLPA2,                                              
003357           DFHEIV99,                                              
003358           DFHEIV99,                                              
003359           DFHEIV99                                               
003360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003361                                                                  
003362 R22-EX. EXIT.                                                    
003363*----------------------------------------------------------------*
003364 U00-RETURN-TRAN.                                                 
003365*----------------------------------------------------------------*
003366                                                                  
003367* EXEC CICS RETURN TRANSID  (EIBTRNID)                            
003368*                     COMMAREA (WCOM-AREAXXXX)                    
003369*                     LENGTH   (WCOM-LUNGHEZZ)                    
003370*    END-EXEC.                                                    
003371*    MOVE '.(CT                  ''   #00003122' TO DFHEIV0       
003372     MOVE X'2E2843542020202020202020' &                           
003373          X'202020202020202020202720' &                           
003374          X'2020233030303033313232' TO DFHEIV0                    
003375     CALL 'kxdfhei1' USING DFHEIV0,                               
003376           EIBTRNID,                                              
003377           WCOM-AREAXXXX,                                         
003378           WCOM-LUNGHEZZ,                                         
003379           DFHEIV99,                                              
003380           DFHEIV99,                                              
003381           DFHEIV99                                               
003382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003383                                                                  
003384 U00-EX. EXIT.                                                    
003385*----------------------------------------------------------------*
003386 U02-NORESP.                                                      
003387*----------------------------------------------------------------*
003388                                                                  
003389* EXEC CICS SEND CONTROL                                          
003390*                   FREEKB                                        
003391*                   END-EXEC.                                     
003392*    MOVE '82      T    F        (   #00003130' TO DFHEIV0        
003393     MOVE X'383220202020202054202020' &                           
003394          X'204620202020202020202820' &                           
003395          X'2020233030303033313330' TO DFHEIV0                    
003396     CALL 'kxdfhei1' USING DFHEIV0,                               
003397           DFHEIV99,                                              
003398           DFHEIV99,                                              
003399           DFHEIV99,                                              
003400           DFHEIV99,                                              
003401           DFHEIV99,                                              
003402           DFHEIV99,                                              
003403           DFHEIV99                                               
003404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003405                                                                  
003406     PERFORM U00-RETURN-TRAN                                      
003407        THRU U00-EX.                                              
003408 U02-EX. EXIT.                                                    
003409*----------------------------------------------------------------*
003410 U05-START-TRANSID.                                               
003411*----------------------------------------------------------------*
003412                                                                  
003413* EXEC CICS START   TRANSID (WTRANSID)                            
003414*                      FROM    (WCOM-AREAXXXX)                    
003415*                      LENGTH  (WCOM-LUNGHEZZ)                    
003416*                      TERMID  (EIBTRMID)                         
003417*                      END-EXEC                                   
003418*    MOVE '0( LFT                1   #00003139' TO DFHEIV0        
003419     MOVE X'3028204C4654202020202020' &                           
003420          X'202020202020202020203120' &                           
003421          X'2020233030303033313339' TO DFHEIV0                    
003422     CALL 'kxdfhei1' USING DFHEIV0,                               
003423           DFHEIV99,                                              
003424           WTRANSID,                                              
003425           DFHEIV99,                                              
003426           WCOM-AREAXXXX,                                         
003427           WCOM-LUNGHEZZ,                                         
003428           EIBTRMID,                                              
003429           DFHEIV99,                                              
003430           DFHEIV99,                                              
003431           DFHEIV99,                                              
003432           DFHEIV99,                                              
003433           DFHEIV99,                                              
003434           DFHEIV99,                                              
003435           DFHEIV99,                                              
003436           DFHEIV99,                                              
003437           DFHEIV99,                                              
003438           DFHEIV99                                               
003439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
003440                                                                  
003441* EXEC CICS RETURN  END-EXEC.                                     
003442*    MOVE '.(                    ''   #00003144' TO DFHEIV0       
003443     MOVE X'2E2820202020202020202020' &                           
003444          X'202020202020202020202720' &                           
003445          X'2020233030303033313434' TO DFHEIV0                    
003446     CALL 'kxdfhei1' USING DFHEIV0,                               
003447           DFHEIV99,                                              
003448           DFHEIV99,                                              
003449           DFHEIV99,                                              
003450           DFHEIV99,                                              
003451           DFHEIV99,                                              
003452           DFHEIV99                                               
003453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003454                                                                  
003455 U05-EX. EXIT.                                                    
003456*----------------------------------------------------------------*
003457 U10-DECODIFICA-MESSAGGI.                                         
003458*----------------------------------------------------------------*
003459     MOVE WCOM-CODILING          TO MESS-CODILING.                
003460*    EXEC SQL  INCLUDE SRMESS  END-EXEC.                          
      *>>((file: SRMESS))
000001*-------------------------------------------------- SRMESS START* 
000002*-  AUTHOR: FEBBRAIOLA DOMENICO & GIUSEPPE RASPINO              * 
000003*---------------------------------------------------------------* 
000004*                                                               * 
000005*  SUBROUTINE PER LA RICERCA DEI MESSAGGI IN LINGUA             * 
000006*                                                               * 
000007*  N.B.  INSERIRE IN WORKING STORAGE :                          * 
000008*            EXEC SQL INCLUDE FDANA846 END-EXEC.                * 
000009*            COPY  DCMESS                                       * 
000010*                                                               * 
000011*  N.B.  IMPOSTARE DATI IN :                                    * 
000012*            MESS-CODERROR                                      * 
000013*            MESS-CODILING                                      * 
000014*                                                               * 
000015***************************************************************** 
000016                                                                  
000017     MOVE 'SELECT'             TO WCOM-FILEFUNZ                   
000018     MOVE 'FDANA846'           TO WCOM-FILENOME                   
000019     MOVE 'SRME'               TO WCOM-CODABEND                   
000020     MOVE MESS-CODERROR        TO WCOM-FILECTRL                   
000021                                                                  
000022     MOVE SPACES               TO MESS-CAMPI-OUTPUT.              
000023     MOVE MESS-CODERROR        TO A846-CODERROR.                  
000024     MOVE MESS-CODILING        TO A846-CODILING.                  
000025                                                                  
000027     
      *EXEC SQL 
      *SELECT MSGERROR                                         
000028*          INTO  :A846-MSGERROR                                    
000029*          FROM   DANAGRAF.TMESSAGGI                               
000030*          WHERE  CODERROR = :A846-CODERROR AND                    
000031*                 CODILING = :A846-CODILING                        
000032*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 38 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODERROR
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODILING
            BY VALUE 0
                     0

           MOVE 39 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 60 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-MSGERROR
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 22 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000033                                                                  
000034     IF SQLCODE NOT EQUAL ZEROS AND                               
000035        SQLCODE NOT EQUAL +100                                    
000036        PERFORM Z00-ERRORE                                        
000037           THRU Z00-EX                                            
000038     ELSE                                                         
000039        IF SQLCODE EQUAL ZEROS                                    
000040           MOVE MESS-CODERROR    TO MESS-COMCODER                 
000041           MOVE A846-MSGERROR    TO MESS-MESSAGGI                 
000042        ELSE                                                      
000043           MOVE '99999'          TO A846-CODERROR                 
000044           MOVE MESS-CODILING    TO A846-CODILING                 
000046           
      *EXEC SQL 
      *SELECT MSGERROR                                   
000047*                INTO  :A846-MSGERROR                              
000048*                FROM   DANAGRAF.TMESSAGGI                         
000049*                WHERE  CODERROR = :A846-CODERROR AND              
000050*                       CODILING = :A846-CODILING                  
000051*           END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 40 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODERROR
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODILING
            BY VALUE 0
                     0

           MOVE 41 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 60 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-MSGERROR
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 23 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000052           IF SQLCODE EQUAL ZEROS                                 
000053              MOVE MESS-CODERROR TO MESS-COMCODER                 
000054              MOVE A846-MSGERROR TO MESS-MESSAGGI                 
000055           ELSE                                                   
000056              IF SQLCODE = 100                                    
000057                 MOVE MESS-CODERROR   TO MESS-COMCODER            
000058                 MOVE '*** MESSAGGIO  NON  TROVATO ****'          
000059                                      TO MESS-MESSAGGI            
000060              ELSE                                                
000061                 PERFORM Z00-ERRORE                               
000062                     THRU Z00-EX.                                 
000063                                                                  
000064*------------------------------------------------- SRMESS    END* 
      *<<((file: SRMESS))
003461     MOVE MESS-MSGERROR          TO LO22-MESSAGGO.                
003462 U10-EX. EXIT.                                                    
003463*----------------------------------------------------------------*
003464 U20-DELETE-TS.                                                   
003465*----------------------------------------------------------------*
003466                                                                  
003467* EXEC CICS DELETEQ TS QUEUE   (WPAGCTRL)                         
003468*              NOHANDLE                                           
003469*              END-EXEC.                                          
003470*    MOVE '*&                    #  N#00003156' TO DFHEIV0        
003471     MOVE X'2A2620202020202020202020' &                           
003472          X'202020202020202020202320' &                           
003473          X'204E233030303033313536' TO DFHEIV0                    
003474     CALL 'kxdfhei1' USING DFHEIV0,                               
003475           WPAGCTRL,                                              
003476           DFHEIV99                                               
003477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003478                                                                  
003479 U20-EX. EXIT.                                                    
003480*----------------------------------------------------------------*
003481 U22-DELETE-TS2.                                                  
003482*----------------------------------------------------------------*
003483                                                                  
003484* EXEC CICS DELETEQ TS QUEUE   (WPAGCTR2)                         
003485*              NOHANDLE                                           
003486*              END-EXEC.                                          
003487*    MOVE '*&                    #  N#00003163' TO DFHEIV0        
003488     MOVE X'2A2620202020202020202020' &                           
003489          X'202020202020202020202320' &                           
003490          X'204E233030303033313633' TO DFHEIV0                    
003491     CALL 'kxdfhei1' USING DFHEIV0,                               
003492           WPAGCTR2,                                              
003493           DFHEIV99                                               
003494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003495                                                                  
003496 U22-EX. EXIT.                                                    
003497*----------------------------------------------------------------*
003498 W00-LINK-SCTCB10.                                                
003499*----------------------------------------------------------------*
003500     MOVE 'W00-'                 TO WCOM-CODABEND                 
003501     MOVE 'LINK'                 TO WCOM-FILEFUNZ                 
003502     MOVE 'SCTCB10'              TO WCOM-FILENOME                 
003503     MOVE DCWCAMB                TO WCOM-FILECTRL                 
003504                                                                  
003505* EXEC CICS LINK PROGRAM ('SCTCB10')                              
003506*                   COMMAREA (DCWCAMB)                            
003507*                   LENGTH (250)                                  
003508*    END-EXEC                                                     
003509     MOVE 'SCTCB10' TO DFHEIV1                                    
003510     MOVE 250                                                     
003511       TO DFHEIV11                                                
003512*    MOVE '."C                   (   #00003174' TO DFHEIV0        
003513     MOVE X'2E2243202020202020202020' &                           
003514          X'202020202020202020202820' &                           
003515          X'2020233030303033313734' TO DFHEIV0                    
003516     CALL 'kxdfhei1' USING DFHEIV0,                               
003517           DFHEIV1,                                               
003518           DCWCAMB,                                               
003519           DFHEIV11,                                              
003520           DFHEIV99,                                              
003521           DFHEIV99,                                              
003522           DFHEIV99,                                              
003523           DFHEIV99                                               
003524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
003525     IF CAMB-RETCOD NOT = '****'                                  
003526        PERFORM Z00-ERRORE                                        
003527           THRU Z00-EX.                                           
003528 W00-EX. EXIT.                                                    
003529*----------------------------------------------------------------*
003530 W10-LINK-SCTEIVA.                                                
003531*----------------------------------------------------------------*
003532     MOVE 'W10-'                 TO WCOM-CODABEND                 
003533     MOVE 'LINK'                 TO WCOM-FILEFUNZ                 
003534     MOVE 'SCTEIVA'              TO WCOM-FILENOME                 
003535     MOVE DCWEIVA                TO WCOM-FILECTRL                 
003536                                                                  
003537* EXEC CICS LINK PROGRAM ('SCTEIVA')                              
003538*                   COMMAREA (DCWEIVA)                            
003539*                   LENGTH (100)                                  
003540*    END-EXEC                                                     
003541     MOVE 'SCTEIVA' TO DFHEIV1                                    
003542     MOVE 100                                                     
003543       TO DFHEIV11                                                
003544*    MOVE '."C                   (   #00003189' TO DFHEIV0        
003545     MOVE X'2E2243202020202020202020' &                           
003546          X'202020202020202020202820' &                           
003547          X'2020233030303033313839' TO DFHEIV0                    
003548     CALL 'kxdfhei1' USING DFHEIV0,                               
003549           DFHEIV1,                                               
003550           DCWEIVA,                                               
003551           DFHEIV11,                                              
003552           DFHEIV99,                                              
003553           DFHEIV99,                                              
003554           DFHEIV99,                                              
003555           DFHEIV99                                               
003556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
003557     MOVE 'AVTLO22'              TO WCOM-NOMEPRGM.                
003558 W10-EX. EXIT.                                                    
003559*----------------------------------------------------------------*
003560*    EXEC SQL INCLUDE SRDTGG END-EXEC.                            
      *>>((file: SRDTGG))
000001*---------------------------------------------------------------* 
000002*    RICERCA DATA DEL GIORNO SULLA TABELLA-DB2 ''TDATARIO''     * 
000003*    PER IL CORRETTO UTILIZZO VEDI IL DATA MANAGER.            *  
000004*---------------------------------------------------------------* 
000005* N.B.  INSERIRE IN WORKING STORAGE :                           * 
000006*                                                               * 
000007*    EXEC SQL INCLUDE FDANA973 END-EXEC.                        * 
000008*    EXEC SQL INCLUDE DCDTGG   END-EXEC.                        * 
000009*    COPY DCWCOMMA(PER PROGRAMMI TP)  X COMODI GESTIONE ERRORI  * 
000010*    COPY DCDB2ER(PER PROGRAMMI BATCH)X COMODI GESTIONE ERRORI  * 
000011*                                                               * 
000012*---------------------------------------------------------------* 
000013                                                                  
000014 SRDTGG.                                                          
000015                                                                  
000016     MOVE +0                     TO DTGG-PRGIORNO.                
000017                                                                  
000018     MOVE SPACES                 TO DTGG-NUMGIORN                 
000019                                    DTGG-DTGIORNO                 
000020                                    DTGG-NUMSETTI                 
000021                                    DTGG-NRGGSETT                 
000022                                    DTGG-DTINISET                 
000023                                    DTGG-DTFINSET                 
000024                                    DTGG-DTINIMES                 
000025                                    DTGG-DTFINMES                 
000026                                    DTGG-ANNOSETT                 
000027                                    DTGG-RETUCODE.                
000028                                                                  
000030     
      *EXEC SQL 
      *SELECT CURRENT DATE                                     
000031*          INTO :DTGG-DATAGIOR                                     
000032*          FROM DANAGRAF.VANAGRAF_082                              
000033*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 42 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE DTGG-DATAGIOR
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 24 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000034                                                                  
000035     MOVE DTGG-DATAGIOR(1:4)     TO DTGG-AACURREN.                
000036     MOVE DTGG-DATAGIOR(6:2)     TO DTGG-MMCURREN.                
000037     MOVE DTGG-DATAGIOR(9:2)     TO DTGG-GGCURREN.                
000038                                                                  
000039     MOVE DTGG-DTCURREN          TO DTGG-CURRENDT.                
000040                                                                  
000041     IF DTGG-DTRICHIE  NOT GREATER SPACES AND                     
000042        DTGG-PRRICHIE  NOT GREATER ZEROES                         
000043        PERFORM SRDTGG-A10-RICERCA-GIORNO                         
000044           THRU SRDTGG-A10-EX                                     
000045     ELSE                                                         
000046        IF DTGG-DTRICHIE   GREATER SPACES                         
000047           MOVE DTGG-DTRICHIE    TO A973-DTGIORNO                 
000048           PERFORM SRDTGG-A20-CALCOLO-DATARIC                     
000049              THRU SRDTGG-A20-EX                                  
000050        ELSE                                                      
000051           MOVE DTGG-PRRICHIE    TO A973-PRGIORNO                 
000052           PERFORM SRDTGG-A30-CALCOLO-PROGRES                     
000053              THRU SRDTGG-A30-EX.                                 
000054                                                                  
000055 SRDTGG-EX. EXIT.                                                 
000056                                                                  
000057*---------------------------------------------------------------* 
000058 SRDTGG-A10-RICERCA-GIORNO.                                       
000059*---------------------------------------------------------------* 
000060                                                                  
000061     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
000062     MOVE 'DATARIO'              TO WCOM-FILENOME.                
000063     MOVE 'DB2 '                 TO WCOM-CODABEND.                
000064     MOVE 'A10-RI'               TO WCOM-FILECTRL.                
000065     MOVE 'ERRORE IN SRDTGG-A10' TO WCOM-MESSAGES.                
000066                                                                  
000068     
      *EXEC SQL 
      *SELECT DTGIORNO, PRGIORNO, NUMGIORN                     
000069*                ,NUMSETTI, NRGGSETT, ANNOSETT                     
000070*                ,DTINISET, DTFINSET                               
000071*                ,DTINIMES, DTFINMES                               
000072*            INTO :A973-DTGIORNO, :A973-PRGIORNO, :A973-NUMGIORN   
000073*                ,:A973-NUMSETTI, :A973-NRGGSETT, :A973-ANNOSETT   
000074*                ,:A973-DTINISET, :A973-DTFINSET                   
000075*                ,:A973-DTINIMES, :A973-DTFINMES                   
000076*            FROM DANAGRAF.TDATARIO                                
000077*           WHERE DTGIORNO = :DTGG-CURRENDT                        
000078*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 43 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE DTGG-CURRENDT
            BY VALUE 0
                     0

           MOVE 44 TO SQL-STMT-ID 
           MOVE 10 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTGIORNO
            BY VALUE 0
                     0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-PRGIORNO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NUMGIORN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NUMSETTI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NRGGSETT
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-ANNOSETT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTINISET
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTFINSET
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTINIMES
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTFINMES
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 25 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000079                                                                  
000080     IF SQLCODE EQUAL 0                                           
000081        MOVE '****'              TO DTGG-RETUCODE                 
000082        MOVE A973-DTGIORNO       TO DTGG-DTGIORNO                 
000083        MOVE A973-PRGIORNO       TO DTGG-PRGIORNO                 
000084        MOVE A973-NUMSETTI       TO DTGG-NUMSETTI                 
000085        MOVE A973-NUMGIORN       TO DTGG-NUMGIORN                 
000086        MOVE A973-NRGGSETT       TO DTGG-NRGGSETT                 
000087        MOVE A973-DTINISET       TO DTGG-DTINISET                 
000088        MOVE A973-DTFINSET       TO DTGG-DTFINSET                 
000089        MOVE A973-DTINIMES       TO DTGG-DTINIMES                 
000090        MOVE A973-DTFINMES       TO DTGG-DTFINMES                 
000091        MOVE A973-ANNOSETT       TO DTGG-ANNOSETT                 
000092     ELSE                                                         
000093        IF SQLCODE EQUAL 100                                      
000094           MOVE 'MRNF'           TO DTGG-RETUCODE                 
000095        ELSE                                                      
000096           MOVE 'ERRO'           TO DTGG-RETUCODE.                
000097                                                                  
000098 SRDTGG-A10-EX. EXIT.                                            
000099                                                                  
000100*---------------------------------------------------------------* 
000101 SRDTGG-A20-CALCOLO-DATARIC.                                      
000102*---------------------------------------------------------------* 
000103                                                                  
000104     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
000105     MOVE 'DATARIO'              TO WCOM-FILENOME.                
000106     MOVE 'DB2 '                 TO WCOM-CODABEND.                
000107     MOVE  A973-DTGIORNO         TO WCOM-FILECTRL.                
000108     MOVE 'ERRORE IN SRDTGG-A20' TO WCOM-MESSAGES.                
000109                                                                  
000111     
      *EXEC SQL 
      *SELECT DTGIORNO, PRGIORNO, NUMGIORN                     
000112*                ,NUMSETTI, NRGGSETT, ANNOSETT                     
000113*                ,DTINISET, DTFINSET                               
000114*                ,DTINIMES, DTFINMES                               
000115*            INTO :A973-DTGIORNO, :A973-PRGIORNO, :A973-NUMGIORN   
000116*                ,:A973-NUMSETTI, :A973-NRGGSETT, :A973-ANNOSETT   
000117*                ,:A973-DTINISET, :A973-DTFINSET                   
000118*                ,:A973-DTINIMES, :A973-DTFINMES                   
000119*            FROM DANAGRAF.TDATARIO                                
000120*           WHERE DTGIORNO = :A973-DTGIORNO                        
000121*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 45 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTGIORNO
            BY VALUE 0
                     0

           MOVE 46 TO SQL-STMT-ID 
           MOVE 10 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTGIORNO
            BY VALUE 0
                     0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-PRGIORNO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NUMGIORN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NUMSETTI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NRGGSETT
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-ANNOSETT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTINISET
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTFINSET
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTINIMES
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTFINMES
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 26 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000122                                                                  
000123     IF SQLCODE EQUAL 0                                           
000124        MOVE '****'              TO DTGG-RETUCODE                 
000125        MOVE A973-DTGIORNO       TO DTGG-DTGIORNO                 
000126        MOVE A973-PRGIORNO       TO DTGG-PRGIORNO                 
000127        MOVE A973-NUMSETTI       TO DTGG-NUMSETTI                 
000128        MOVE A973-NUMGIORN       TO DTGG-NUMGIORN                 
000129        MOVE A973-NRGGSETT       TO DTGG-NRGGSETT                 
000130        MOVE A973-DTINISET       TO DTGG-DTINISET                 
000131        MOVE A973-DTFINSET       TO DTGG-DTFINSET                 
000132        MOVE A973-DTINIMES       TO DTGG-DTINIMES                 
000133        MOVE A973-DTFINMES       TO DTGG-DTFINMES                 
000134        MOVE A973-ANNOSETT       TO DTGG-ANNOSETT                 
000135     ELSE                                                         
000136        IF SQLCODE EQUAL 100                                      
000137           MOVE 'MRNF'           TO DTGG-RETUCODE                 
000138        ELSE                                                      
000139           MOVE 'ERRO'           TO DTGG-RETUCODE.                
000140                                                                  
000141 SRDTGG-A20-EX. EXIT.                                            
000142                                                                  
000143*---------------------------------------------------------------* 
000144 SRDTGG-A30-CALCOLO-PROGRES.                                      
000145*---------------------------------------------------------------* 
000146                                                                  
000147     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
000148     MOVE 'DATARIO'              TO WCOM-FILENOME.                
000149     MOVE 'DB2 '                 TO WCOM-CODABEND.                
000150     MOVE 'ERRORE IN SRDTGG-A30' TO WCOM-MESSAGES.                
000151                                                                  
000153     
      *EXEC SQL 
      *SELECT DTGIORNO, PRGIORNO, NUMGIORN                     
000154*                ,NUMSETTI, NRGGSETT, ANNOSETT                     
000155*                ,DTINISET, DTFINSET                               
000156*                ,DTINIMES, DTFINMES                               
000157*            INTO :A973-DTGIORNO, :A973-PRGIORNO, :A973-NUMGIORN   
000158*                ,:A973-NUMSETTI, :A973-NRGGSETT, :A973-ANNOSETT   
000159*                ,:A973-DTINISET, :A973-DTFINSET                   
000160*                ,:A973-DTINIMES, :A973-DTFINMES                   
000161*            FROM DANAGRAF.TDATARIO                                
000162*           WHERE PRGIORNO = :A973-PRGIORNO                        
000163*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 47 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-PRGIORNO
            BY VALUE 0
                     0

           MOVE 48 TO SQL-STMT-ID 
           MOVE 10 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTGIORNO
            BY VALUE 0
                     0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-PRGIORNO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NUMGIORN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NUMSETTI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NRGGSETT
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-ANNOSETT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTINISET
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTFINSET
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTINIMES
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTFINMES
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 27 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000164                                                                  
000165     IF SQLCODE EQUAL 0                                           
000166        MOVE '****'              TO DTGG-RETUCODE                 
000167        MOVE A973-DTGIORNO       TO DTGG-DTGIORNO                 
000168        MOVE A973-PRGIORNO       TO DTGG-PRGIORNO                 
000169        MOVE A973-NUMSETTI       TO DTGG-NUMSETTI                 
000170        MOVE A973-NUMGIORN       TO DTGG-NUMGIORN                 
000171        MOVE A973-NRGGSETT       TO DTGG-NRGGSETT                 
000172        MOVE A973-DTINISET       TO DTGG-DTINISET                 
000173        MOVE A973-DTFINSET       TO DTGG-DTFINSET                 
000174        MOVE A973-DTINIMES       TO DTGG-DTINIMES                 
000175        MOVE A973-DTFINMES       TO DTGG-DTFINMES                 
000176        MOVE A973-ANNOSETT       TO DTGG-ANNOSETT                 
000177     ELSE                                                         
000178        IF SQLCODE EQUAL 100                                      
000179           MOVE 'MRNF'           TO DTGG-RETUCODE                 
000180        ELSE                                                      
000181           MOVE 'ERRO'           TO DTGG-RETUCODE.                
000182                                                                  
000183 SRDTGG-A30-EX. EXIT.                                            
000184*--------------------------------------------------------------*  
      *<<((file: SRDTGG))
003561*----------------------------------------------------------------*
003562*COPY DCWTSTRP.                                                   
003563*------------------------------------- -------------------------* 
003564*                    --- DCWTSTRp ---                           * 
003565*                GESTIONE DATI PER RICICLO.                     * 
003566*---------------------------------------------------------------* 
003567 LEGGO-RICICLO.                                                   
003568                                                                  
003569* EXEC CICS HANDLE CONDITION ITEMERR (LEGGO-RICICLO-EX)           
003570*                           QIDERR  (LEGGO-RICICLO-EX)            
003571*END-EXEC.                                                        
003572*    MOVE '"$<N                  ! & #00003204' TO DFHEIV0        
003573     MOVE X'22243C4E2020202020202020' &                           
003574          X'202020202020202020202120' &                           
003575          X'2620233030303033323034' TO DFHEIV0                    
003576     CALL 'kxdfhei1' USING DFHEIV0                                
003577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003578                                                                  
003579*    CALL 'DFHEI1' USING DFHEIV0                                  
003580*     SERVICE LABEL                                               
003581*     GO TO  LEGGO-RICICLO-EX LEGGO-RICICLO-EX DEPENDING ON       
003582*    DFHEIGDI.                                                    
003583     MOVE  1                     TO TSTR-ITEMXXXX.                
003584     MOVE EIBTRNID               TO TSTR-NOMETRAN.                
003585     MOVE EIBTRMID               TO TSTR-NOMETERM.                
003586                                                                  
003587* EXEC CICS READQ  TS QUEUE   (TSTR-NOMECODA)                     
003588*                    INTO    (TSTR-AREATSTR)                      
003589*                    ITEM    (TSTR-ITEMXXXX)                      
003590*                    LENGTH  (TSTR-LENGCODA)                      
003591*END-EXEC.                                                        
003592*    MOVE '*$II   L              ''   #00003214' TO DFHEIV0       
003593     MOVE X'2A2449492020204C20202020' &                           
003594          X'202020202020202020202720' &                           
003595          X'2020233030303033323134' TO DFHEIV0                    
003596     CALL 'kxdfhei1' USING DFHEIV0,                               
003597           TSTR-NOMECODA,                                         
003598           TSTR-AREATSTR,                                         
003599           TSTR-LENGCODA,                                         
003600           TSTR-ITEMXXXX,                                         
003601           DFHEIV99,                                              
003602           DFHEIV99                                               
003603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003604                                                                  
003605*    CALL 'DFHEI1' USING DFHEIV0  TSTR-NOMECODA TSTR-AREATSTR     
003606*    TSTR-LENGCODA DFHDUMMY TSTR-ITEMXXXX.                        
003607     MOVE TSTR-AREATSTR          TO WCOM-AREAXXXX.                
003608                                                                  
003609* EXEC CICS DELETEQ TS QUEUE  (TSTR-NOMECODA)                     
003610*                     NOHANDLE                                    
003611*END-EXEC.                                                        
003612*    MOVE '*&                    #  N#00003222' TO DFHEIV0        
003613     MOVE X'2A2620202020202020202020' &                           
003614          X'202020202020202020202320' &                           
003615          X'204E233030303033323232' TO DFHEIV0                    
003616     CALL 'kxdfhei1' USING DFHEIV0,                               
003617           TSTR-NOMECODA,                                         
003618           DFHEIV99                                               
003619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003620                                                                  
003621*    CALL 'DFHEI1' USING DFHEIV0  TSTR-NOMECODA.                  
003622 LEGGO-RICICLO-EX. EXIT.                                          
003623 SCRIVO-RICICLO.                                                  
003624     MOVE WCOM-AREAXXXX          TO TSTR-AREATSTR.                
003625     MOVE  1                     TO TSTR-ITEMXXXX.                
003626     MOVE EIBTRNID               TO TSTR-NOMETRAN.                
003627     MOVE EIBTRMID               TO TSTR-NOMETERM.                
003628                                                                  
003629* EXEC CICS DELETEQ TS QUEUE  (TSTR-NOMECODA)                     
003630*                     NOHANDLE                                    
003631*END-EXEC.                                                        
003632*    MOVE '*&                    #  N#00003232' TO DFHEIV0        
003633     MOVE X'2A2620202020202020202020' &                           
003634          X'202020202020202020202320' &                           
003635          X'204E233030303033323332' TO DFHEIV0                    
003636     CALL 'kxdfhei1' USING DFHEIV0,                               
003637           TSTR-NOMECODA,                                         
003638           DFHEIV99                                               
003639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003640                                                                  
003641*    CALL 'DFHEI1' USING DFHEIV0  TSTR-NOMECODA.                  
003642                                                                  
003643* EXEC CICS WRITEQ TS  QUEUE  (TSTR-NOMECODA)                     
003644*                     FROM   (TSTR-AREATSTR)                      
003645*                     ITEM   (TSTR-ITEMXXXX)                      
003646*                     LENGTH (TSTR-LENGCODA)                      
003647*END-EXEC.                                                        
003648*    MOVE '*" I   L              ''   #00003236' TO DFHEIV0       
003649     MOVE X'2A2220492020204C20202020' &                           
003650          X'202020202020202020202720' &                           
003651          X'2020233030303033323336' TO DFHEIV0                    
003652     CALL 'kxdfhei1' USING DFHEIV0,                               
003653           TSTR-NOMECODA,                                         
003654           TSTR-AREATSTR,                                         
003655           TSTR-LENGCODA,                                         
003656           TSTR-ITEMXXXX,                                         
003657           DFHEIV99,                                              
003658           DFHEIV99                                               
003659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003660                                                                  
003661*    CALL 'DFHEI1' USING DFHEIV0  TSTR-NOMECODA TSTR-AREATSTR     
003662*    TSTR-LENGCODA DFHDUMMY TSTR-ITEMXXXX.                        
003663 SCRIVO-RICICLO-EX. EXIT.                                         
003664*---------------------------------------------------------------* 
003665*COPY DCPERDB2.                                                   
003666*SRERCICS/P---------S = SOURCE / P = PRECOMPILED ----------------*
003667*----*  ROUTINE INTERCETTA ERRORE CICS                      *----*
003668*----*                                                      *----*
003669*----------------------------------------------------------------*
003670*       QUESTA ROUTINE E' LA PRIMA DA DICHIARARE COME COPY        
003671*----*                                                      *----*
003672*----------------------------------------------------------------*
003673*    ES.    **                                                    
003674*    ES.         COPY SRERCICP.                                   
003675*    ES.    **   SE VOGLIO INTERCETTARE ERRORE DB2                
003676*    ES.         COPY SRERDB2P                                    
003677*    ES.    **   SE VOGLIO INTERCETTARE ERRORE TOTAL              
003678*    ES.         COPY SRERDB2P                                    
003679*    ES.    **  ETC.                                              
003680*    ES.                                                          
003681*    ES.    **   ULTIMA ROUTINE CHE RILASCIA TR-ERRE  PER DECODI  
003682*    ES.    **   ERRORE                                           
003683*    ES.         COPY SRERENDS                                    
003684*                                                                 
003685*----------------------------------------------------------------*
003686 Z00-ERRORE.                                                      
003687*----------------------------------------------------------------*
003688     MOVE DFHEIV0                TO T-COMLINE.                    
003689     PERFORM                                                      
003690        VARYING INDERR FROM 1 BY 1                                
003691            UNTIL INDERR GREATER 25                               
003692               OR EL-COMLINE (INDERR) EQUAL ZERO                  
003693     END-PERFORM.                                                 
003694     MOVE SPACES                 TO WLINEAXX.                     
003695     IF INDERR LESS 26                                            
003696        MOVE EL-COMLINE (INDERR) TO EL-LINE (1)                   
003697        ADD 1                    TO INDERR                        
003698        MOVE EL-COMLINE (INDERR) TO EL-LINE (2)                   
003699        ADD 1                    TO INDERR                        
003700        MOVE EL-COMLINE (INDERR) TO EL-LINE (3)                   
003701        ADD 1                    TO INDERR                        
003702        MOVE EL-COMLINE (INDERR) TO EL-LINE (4)                   
003703        ADD 1                    TO INDERR                        
003704        MOVE EL-COMLINE (INDERR) TO EL-LINE (5).                  
003705     MOVE WLINEAXX               TO WCOM-PRGMLINE.                
003706     MOVE EIBFN                  TO WCOM-CODEIBFN.                
003707     MOVE EIBRCODE               TO WCOM-CODERCOD.                
003708     MOVE SPACES                 TO WCOM-ABENCICS.                
003709     IF EIBRESP  NOT = ZERO OR                                    
003710        EIBRESP2 NOT = ZERO                                       
003711                                                                  
003712* EXEC CICS                                                       
003713*      ASSIGN ABCODE (WCOM-ABENCICS)                              
003714*END-EXEC.                                                        
003715*    MOVE '"((                   "   #00003291' TO DFHEIV0        
003716     MOVE X'222828202020202020202020' &                           
003717          X'202020202020202020202220' &                           
003718          X'2020233030303033323931' TO DFHEIV0                    
003719     CALL 'kxdfhei1' USING DFHEIV0,                               
003720           WCOM-ABENCICS                                          
003721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003722                                                                  
003723*       CALL 'DFHEI1' USING DFHEIV0  WCOM-ABENCICS.               
003724*SRERDB2S/P -----------------------------------------------------*
003725*----*  ROUTINE INTERCETTA ERRORE DB2                       *----*
003726*----*                                                      *----*
003727*----------------------------------------------------------------*
003728*       QUESTA ROUTINE E' DA DICHIARARE DOPO LA SRERCICS          
003729*                                                                 
003730     MOVE 'ABEN'                 TO WCOM-CODATSX1.                
003731     MOVE EIBTRMID               TO WCOM-CODATSX2.                
003732*    MOVE LENGTH OF SQLCA        TO WCOM-LUNGHERR.                
003733     MOVE 136                    TO WCOM-LUNGHERR.                
003734                                                                  
003735* EXEC CICS WRITEQ TS    QUEUE  (WCOM-CODATSXX)                   
003736*                       FROM   (SQLCA)                            
003737*                       LENGTH (WCOM-LUNGHERR)                    
003738*END-EXEC.                                                        
003739*    MOVE '*"     L              ''   #00003305' TO DFHEIV0       
003740     MOVE X'2A2220202020204C20202020' &                           
003741          X'202020202020202020202720' &                           
003742          X'2020233030303033333035' TO DFHEIV0                    
003743     CALL 'kxdfhei1' USING DFHEIV0,                               
003744           WCOM-CODATSXX,                                         
003745           SQLCA,                                                 
003746           WCOM-LUNGHERR,                                         
003747           DFHEIV99,                                              
003748           DFHEIV99,                                              
003749           DFHEIV99                                               
003750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003751                                                                  
003752*    CALL 'DFHEI1' USING DFHEIV0  WCOM-CODATSXX SQLCA             
003753*    WCOM-LUNGHERR.                                               
003754*SRERENDS/P------------------------------------------------------*
003755*----*  ROUTINE FINALE                                      *----*
003756*----*                                                      *----*
003757*----------------------------------------------------------------*
003758*       QUESTA ROUTINE DA DICHIARARE PER ULTIMA NELLA SEQUNZA     
003759*       DELLE COPY  PER INTERCETTARE L'ERRORE                     
003760*----------------------------------------------------------------*
003761*----------------------------------------------------------------*
003762      MOVE EIBTRNID              TO WCOM-TRANSAZI.                
003763                                                                  
003764* EXEC CICS SYNCPOINT ROLLBACK                                    
003765*END-EXEC.                                                        
003766*    MOVE '6"R                   !   #00003320' TO DFHEIV0        
003767     MOVE X'362252202020202020202020' &                           
003768          X'202020202020202020202120' &                           
003769          X'2020233030303033333230' TO DFHEIV0                    
003770     CALL 'kxdfhei1' USING DFHEIV0                                
003771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003772                                                                  
003773*     CALL 'DFHEI1' USING DFHEIV0.                                
003774                                                                  
003775* EXEC CICS ASSIGN SYSID (WCOM-SYSID)                             
003776*END-EXEC.                                                        
003777*    MOVE '"(         $          "   #00003323' TO DFHEIV0        
003778     MOVE X'222820202020202020202024' &                           
003779          X'202020202020202020202220' &                           
003780          X'2020233030303033333233' TO DFHEIV0                    
003781     CALL 'kxdfhei1' USING DFHEIV0,                               
003782           WCOM-SYSID                                             
003783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003784                                                                  
003785*     CALL 'DFHEI1' USING DFHEIV0  WCOM-SYSID.                    
003786      MOVE 'ABEN'                    TO WCOM-CODATSX1.            
003787      MOVE EIBTRMID                  TO WCOM-CODATSX2.            
003788*     MOVE LENGTH OF WCOM-AREA-ERROR TO WCOM-LUNGHERR.            
003789      MOVE 200                       TO WCOM-LUNGHERR.            
003790*EXEC CICS WRITEQ TS QUEUE  (WCOM-CODATSXX)                       
003791                                                                  
003792* EXEC CICS WRITEQ TS                                             
003793*                    QUEUE  (WCOM-CODATSXX)                       
003794*                    FROM   (WCOM-AREA-ERROR)                     
003795*                    LENGTH (WCOM-LUNGHERR)                       
003796*END-EXEC.                                                        
003797*    MOVE '*"     L              ''   #00003331' TO DFHEIV0       
003798     MOVE X'2A2220202020204C20202020' &                           
003799          X'202020202020202020202720' &                           
003800          X'2020233030303033333331' TO DFHEIV0                    
003801     CALL 'kxdfhei1' USING DFHEIV0,                               
003802           WCOM-CODATSXX,                                         
003803           WCOM-AREA-ERROR,                                       
003804           WCOM-LUNGHERR,                                         
003805           DFHEIV99,                                              
003806           DFHEIV99,                                              
003807           DFHEIV99                                               
003808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003809                                                                  
003810*     CALL 'DFHEI1' USING DFHEIV0  WCOM-CODATSXX WCOM-AREA-ERROR  
003811*    WCOM-LUNGHERR.                                               
003812                                                                  
003813* EXEC CICS START TRANSID ('ERRE')                                
003814*                FROM    (WCOM-AREAXXXX)                          
003815*                LENGTH  (WCOM-LUNGHEZZ)                          
003816*                TERMID  (EIBTRMID)                               
003817*END-EXEC.                                                        
003818     MOVE 'ERRE' TO DFHEIV5                                       
003819*    MOVE '0( LFT                1   #00003338' TO DFHEIV0        
003820     MOVE X'3028204C4654202020202020' &                           
003821          X'202020202020202020203120' &                           
003822          X'2020233030303033333338' TO DFHEIV0                    
003823     CALL 'kxdfhei1' USING DFHEIV0,                               
003824           DFHEIV99,                                              
003825           DFHEIV5,                                               
003826           DFHEIV99,                                              
003827           WCOM-AREAXXXX,                                         
003828           WCOM-LUNGHEZZ,                                         
003829           EIBTRMID,                                              
003830           DFHEIV99,                                              
003831           DFHEIV99,                                              
003832           DFHEIV99,                                              
003833           DFHEIV99,                                              
003834           DFHEIV99,                                              
003835           DFHEIV99,                                              
003836           DFHEIV99,                                              
003837           DFHEIV99,                                              
003838           DFHEIV99,                                              
003839           DFHEIV99                                               
003840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003841                                                                  
003842*      MOVE 'ERRE' TO DFHC0040                                    
003843*     CALL 'DFHEI1' USING DFHEIV0  DFHEID0 DFHDUMMY DFHC0040      
003844*    WCOM-AREAXXXX WCOM-LUNGHEZZ EIBTRMID.                        
003845                                                                  
003846* EXEC CICS ABEND ABCODE (WCOM-ABENCICS)                          
003847*                CANCEL                                           
003848*END-EXEC.                                                        
003849*    MOVE '.,AC                  "   #00003346' TO DFHEIV0        
003850     MOVE X'2E2C41432020202020202020' &                           
003851          X'202020202020202020202220' &                           
003852          X'2020233030303033333436' TO DFHEIV0                    
003853     CALL 'kxdfhei1' USING DFHEIV0,                               
003854           WCOM-ABENCICS                                          
003855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003856                                                                  
003857*     CALL 'DFHEI1' USING DFHEIV0  WCOM-ABENCICS.                 
003858 Z00-EX. EXIT.                                                    
003859*----------------------------------------------------------------*
003860                                                                  
003861 9999-DFHBACK SECTION.                                            
003862     MOVE '9%                    "   ' TO DFHEIV0                 
003863     MOVE 'AVTLO22' TO DFHEIV1                                    
003864     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1                        
003865     GOBACK.                                                      
003866 9999-DFHEXIT.                                                    
003867     IF DFHEIGDJ EQUAL 0001                                       
003868         NEXT SENTENCE                                            
003869     ELSE IF DFHEIGDJ EQUAL 2                                     
003870         GO TO Z00-ERRORE                                         
003871         DEPENDING ON DFHEIGDI                                    
003872     ELSE IF DFHEIGDJ EQUAL 3                                     
003873         GO TO B05-NORESP                                         
003874         DEPENDING ON DFHEIGDI                                    
003875     ELSE IF DFHEIGDJ EQUAL 4                                     
003876         GO TO R00-EX,                                            
003877               R00-EX                                             
003878         DEPENDING ON DFHEIGDI                                    
003879     ELSE IF DFHEIGDJ EQUAL 5                                     
003880         GO TO R10-EX,                                            
003881               R10-EX                                             
003882         DEPENDING ON DFHEIGDI                                    
003883     ELSE IF DFHEIGDJ EQUAL 6                                     
003884         GO TO LEGGO-RICICLO-EX,                                  
003885               LEGGO-RICICLO-EX                                   
003886         DEPENDING ON DFHEIGDI.                                   
003887     MOVE '9%                    "   ' TO DFHEIV0                 
003888     MOVE 'AVTLO22' TO DFHEIV1                                    
003889     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1                        
003890     GOBACK.                                                      
