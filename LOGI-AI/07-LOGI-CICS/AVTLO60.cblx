      *((program: AVTLO60.cblx))
000001*-------------* PROGRAMMA  CICS/DB2 COBOL2 *--------------------* 
000002 ID  DIVISION.                                                    
000003*-------------*                                                   
000004 PROGRAM-ID. AVTLO60.                             
000005*---------------------------------------------------------------* 
000006*                ELENCO LISTINI LOGISTICA                       * 
000007*---------------------------------------------------------------* 
000008*  IL PROGRAMMA GESTISCE L'ELENCO DEI LISTINI PER  SERVIZI      * 
000009*  DI LOGISTICA.                                                * 
000010*                                                               * 
000011*  OPERAZIONI IN TESTATA:                                       * 
000012*  - DUPLICAZIONE LISTINO                                       * 
000013*                                                               * 
000014*  OPERAZIONI IN RIGA:                                          * 
000015*  - V -   PER VARIARE UN LISTINO                               * 
000016*  - / -   PER CANELLARE UN LISTINO                             * 
000017*  - I -   PER INSERIRE UN LISTINO                              * 
000018*---------------------------------------------------------------* 
000019 ENVIRONMENT DIVISION.                                            
000020*---------------------*                                           
000021 CONFIGURATION SECTION.                                           
000022 SPECIAL-NAMES.                                                   
000023     DECIMAL-POINT IS COMMA.                                      
000024 DATA DIVISION.                                                   
000025*--------------*                                                  
000026 WORKING-STORAGE SECTION.

       01  SQLDA-ID pic 9(4) comp-5.
       01  SQLDSIZE pic 9(4) comp-5.
       01  SQL-STMT-ID pic 9(4) comp-5.
       01  SQLVAR-INDEX pic 9(4) comp-5.
       01  SQL-DATA-TYPE pic 9(4) comp-5.
       01  SQL-HOST-VAR-LENGTH pic 9(9) comp-5.
       01  SQL-S-HOST-VAR-LENGTH pic 9(9) comp-5.
       01  SQL-S-LITERAL pic X(258).
       01  SQL-LITERAL1 pic X(130).
       01  SQL-LITERAL2 pic X(130).
       01  SQL-LITERAL3 pic X(130).
       01  SQL-LITERAL4 pic X(130).
       01  SQL-LITERAL5 pic X(130).
       01  SQL-LITERAL6 pic X(130).
       01  SQL-LITERAL7 pic X(130).
       01  SQL-LITERAL8 pic X(130).
       01  SQL-LITERAL9 pic X(130).
       01  SQL-LITERAL10 pic X(130).
       01  SQL-IS-LITERAL pic 9(4) comp-5 value 1.
       01  SQL-IS-INPUT-HVAR pic 9(4) comp-5 value 2.
       01  SQL-CALL-TYPE pic 9(4) comp-5.
       01  SQL-SECTIONUMBER pic 9(4) comp-5.
       01  SQL-INPUT-SQLDA-ID pic 9(4) comp-5.
       01  SQL-OUTPUT-SQLDA-ID pic 9(4) comp-5.
       01  SQLA-PROGRAM-ID.
           05 SQL-PART1 pic 9(4) COMP-5 value 172.
           05 SQL-PART2 pic X(6) value "AEAQAI".
           05 SQL-PART3 pic X(24) value "EBSEMfFn01111 2         ".
           05 SQL-PART4 pic 9(4) COMP-5 value 8.
           05 SQL-PART5 pic X(8) value "DB2XMT  ".
           05 SQL-PART6 pic X(120) value LOW-VALUES.
           05 SQL-PART7 pic 9(4) COMP-5 value 8.
           05 SQL-PART8 pic X(8) value "AVTLO60 ".
           05 SQL-PART9 pic X(120) value LOW-VALUES.
                                                                        
000027 01  DFH-START PIC X(04).                                         
000028 01  FILLER                      PIC X(08) VALUE 'DCWCOMMA'.      
000029*    COPY DCWCOMMA.                                               
000030*---------------------------------------------------------------* 
000031*----*            AREA DI PASSAGGIO DATI - WWTERRE         *----* 
000032*---------------------------------------------------------------* 
000033 01  WCOM-LUNGHERR                PIC S9(4) COMP VALUE +200.      
000034 01  WCOM-AREA-ERROR.                                             
000035     02 FILLER                    PIC X(8) VALUE 'CICSERRO'.      
000036     02 WCOM-FILEMESG.                                            
000037        04 WCOM-FILEFUNZ          PIC X(10).                      
000038        04 WCOM-FILESTAT          PIC X(5).                       
000039        04 WCOM-SQLCODEX REDEFINES WCOM-FILESTAT                  
000040                                  PIC -Z(4).                      
000041        04 WCOM-FILENOME          PIC X(30).                      
000042        04 WCOM-FILECTR1.                                         
000043           05 WCOM-FILECTRL       PIC X(35).                      
000044     02 WCOM-MESSAGE1 REDEFINES WCOM-FILEMESG.                    
000045        05 WCOM-MESSAGES          PIC X(80).                      
000046     02 WCOM-CODABEND             PIC X(4).                       
000047     02 WCOM-ABENCICS             PIC X(4).                       
000048     02 WCOM-PRGMLINE             PIC X(5)  VALUE SPACES.         
000049     02 WCOM-CODEIBFN             PIC X(2).                       
000050     02 WCOM-CODERCOD             PIC X(6).                       
000051     02 FILLER                    PIC X(91).                      
000052*---------------------------------------------------------------* 
000053*----*                AREA DI COMMAREA                     *----* 
000054*---------------------------------------------------------------* 
000055*---------------------- LUNGHEZZA WCOM-AREAXXXX                   
000056 01  WCOM-LUNGHEZZ                     PIC S9(4) COMP VALUE +300. 
000057*---------------------- NOME DEL PROGRAMMA                        
000058 01  WCOM-AREAXXXX.                                               
000059     05  WCOM-NOMEPRGM                 PIC X(8)  VALUE SPACES.    
000060*---------------------- PAGINA RICHIESTA                          
000061     05  WCOM-PAGIRICH                 PIC S9(5) COMP-3.          
000062*---------------------- PAGINA LISTATA                            
000063     05  WCOM-PAGILIST                 PIC S9(5) COMP-3.          
000064*---------------------- PAGINA ULTIMA                             
000065     05  WCOM-PAGIULTI                 PIC S9(5) COMP-3.          
000066*---------------------- FLAG PER MODULO GESTIONE FUNZIONI ESTERNE 
000067     05  WCOM-FLAGFUNZ.                                           
000068         10  WCOM-RETURNXX             PIC X(1).                  
000069         10  WCOM-DELETETS             PIC X(1).                  
000070         10  WCOM-CODILING             PIC X(1).                  
000071*---------------------- FLAG PER AGGIORNAMENTI                    
000072     05  WCOM-FLAGPRGM                 PIC X(1)  VALUE SPACES.    
000073*---------------------- SOTTOSISTEMA CICS                         
000074     05  WCOM-SYSID                    PIC X(4)  VALUE '????'.    
000075*---------------------- PRINTER ABBINATA CON 'P'                  
000076     05  WCOM-PRINTERX                 PIC X(4).                  
000077*---------------------- PRINTER ASSOCIATA MAG. FINITI             
000078     05  WCOM-PRINTERY                 PIC X(4).                  
000079*---------------------- PRINTER ASSOCIATA ALLA TRANSAZIONE        
000080     05  WCOM-PRINTERT                 PIC X(4).                  
000081*---------------------- PRINTER BAR-CODE O MODULI SPECIALI        
000082     05  WCOM-PRINTERB                 PIC X(4).                  
000083*---------------------- TRANSAZIONE                               
000084     05  WCOM-TRANSAZI                 PIC X(4).                  
000085*---------------------- DATA DEL GIORNO DA MENU'                  
000086     05  WCOM-DATAXXXX.                                           
000087         10  WCOM-DATAGGXX             PIC X(2).                  
000088         10  WCOM-DATAGGXN REDEFINES WCOM-DATAGGXX  PIC 9(2).     
000089         10  WCOM-BARRAUNO             PIC X(1).                  
000090         10  WCOM-DATAMMXX             PIC X(2).                  
000091         10  WCOM-DATAMMXN REDEFINES WCOM-DATAMMXX  PIC 9(2).     
000092         10  WCOM-BARRADUE             PIC X(1).                  
000093         10  WCOM-DATAAAXX.                                       
000094             15 WCOM-DATAAAX1          PIC 9(1).                  
000095             15 WCOM-DATAAAX2          PIC 9(1).                  
000096         10  WCOM-DATAAAXN REDEFINES WCOM-DATAAAXX  PIC 9(2).     
000097*---------------------- NOME DELLA CODA TS GENERICA               
000098     05  WCOM-CODATSXX.                                           
000099         10 WCOM-CODATSX1              PIC X(4)  VALUE SPACES.    
000100         10 WCOM-CODATSX2              PIC X(4)  VALUE SPACES.    
000101*---------------------- DATA DEL GIORNO                           
000102     05  WCOM-DTCREAZI.                                           
000103         10 WCOM-DTCREAZI-SY.                                     
000104            15 WCOM-DTCREAZI-SS        PIC X(2).                  
000105            15 WCOM-DTCREAZI-YY        PIC X(2).                  
000106         10 WCOM-DTCREAZI-SYN REDEFINES WCOM-DTCREAZI-SY PIC 9(4).
000107         10 WCOM-DTCREAZI-MM           PIC X(2).                  
000108         10 WCOM-DTCREAZI-DD           PIC X(2).                  
000109*---------------------- CODICE UTENTE                             
000110     05  WCOM-UTENCICS                 PIC X(6).                  
000111*---------------------- TRANSAZIONI NELL' AMBITO DELLA RICHIESTA  
000112     05  WCOM-INDITRAN                 PIC 9(2).                  
000113     05  WCOM-TABETRAN.                                           
000114         10  WCOM-MENUTRAN  OCCURS 10  PIC X(4).                  
000115         10  WCOM-PAGITRAN  OCCURS 10  PIC S9(5) COMP-3.          
000116*---------------------- FLAG AVVISI UTENTI/TRANSAZIONI DA SCTUTENT
000117     05  WCOM-FLAGUTEN                 PIC X(1).                  
000118     05  WCOM-FLAGTRAN                 PIC X(1).                  
000119*---------------------- FLAG UTENTI LIMITATI                      
000120     05  WCOM-FLAGLIMI                 PIC X(1).                  
000121*---------------------- LIBERI                                    
000122     05  FILLER                        PIC X(25).                 
000123*---------------------- RICHIESTA                                 
000124     05  WCOM-RIKIESTA.                                           
000125         10   WCOM-COMODOXX            PIC X(125).                
000126*    COPY DCLOGI.                                                 
000127******************************************************************
000128*                        *** DCLOGI ***                          *
000129*     DSECT RELATIVA ALLA COMMAREA DEGLI ORDINI DI LOGISTICA     *
000130*                    - LUNGHEZZA 175 BYTES -                     *
000131******************************************************************
000132         10  FILLER                           PIC X(200).         
000133     05  WORK-RICHIESTA REDEFINES WCOM-RIKIESTA.                  
000134         10  WCOM-DCLOGI.                                         
000135             15  WCOM-CODUTENT                PIC X(06).          
000136             15  WCOM-CODSOCIE                PIC X(02).          
000137             15  WCOM-CDDIVISI                PIC X(01).          
000138             15  WCOM-CODDEPOS                PIC X(02).          
000139             15  WCOM-CODCLIEN                PIC X(05).          
000140             15  WCOM-CLIFOCON                PIC X(05).          
000141             15  WCOM-CODSERVI                PIC X(06).          
000142             15  WCOM-TIPSERVI                PIC X(01).          
000143             15  WCOM-CODDIVIS                PIC X(02).          
000144             15  WCOM-UNMISURA                PIC X(02).          
000145             15  WCOM-AANUMORD                PIC X(08).          
000146             15  WCOM-NRRIGORD                PIC S9(3)  COMP-3.  
000147             15  WCOM-CONTODCE                PIC X(06).          
000148             15  WCOM-SALDATOX                PIC X(01).          
000149             15  WCOM-OPERAZIO                PIC X(01).          
000150             15  WCOM-DECIDIVI                PIC X(01).          
000151             15  WCOM-CONTOPER                PIC S9(5)  COMP-3.  
000152             15  WCOM-CODERROR                PIC X(05).          
000153             15  WCOM-FLAGAUTO                PIC X(01).          
000154             15  WCOM-SOCIEMER                PIC X(02).          
000155             15  WCOM-TIPOARTI                PIC X(01).          
000156             15  WCOM-PAESPROV                PIC X(03).          
000157             15  WCOM-PAESMERC                PIC X(03).          
000158             15  WCOM-DTCARORD                PIC X(08).          
000159             15  WCOM-FLAGMANU                PIC X(01).          
000160             15  WCOM-FLAGGIVA                PIC X(01).          
000161             15  WCOM-TIPORECO                PIC X(04).          
000162             15  WCOM-AANUMFAT                PIC X(08).          
000163             15  WCOM-DTFATTUR                PIC X(08).          
000164             15  WCOM-NRPREATT                PIC X(18).          
000165             15  WCOM-DTPREATT                PIC X(08).          
000166             15  WCOM-STATUSXX                PIC X(01).          
000167             15  WCOM-AAMMCOMP                PIC X(06).          
000168             15  WCOM-CENCOSTD                PIC X(05).          
000169             15  WCOM-CENCOSTA                PIC X(05).          
000170             15  WCOM-ESENTIVA                PIC X(01).          
000171             15  FILLER                       PIC X(32).          
000172*--------------------------------------------------------------*  
000173     10  WCOM-DATIPROG.                                           
000174         15 WCOM-RAGFATTU        PIC X(24).                       
000175         15 WCOM-RAGFATT2        PIC X(24).                       
000176         15 WCOM-DTINILIS        PIC X(06).                       
000177         15 WCOM-DTFINLIS        PIC X(06).                       
000178         15 WCOM-CAMBIODT        PIC X(01).                       
000179         15 WCOM-RAGFATT3        PIC X(24).                       
000180         15 WCOM-XRAGFATT        PIC X(24).                       
000181         15 WCOM-FLAGULTI        PIC X(01).                       
000182         15 FILLER               PIC X(40).                       
000183 01  FILLER                      PIC X(08)  VALUE 'DCWWORK1'.     
000184*    COPY DCWWORK1.                                               
000185***************************************************************** 
000186******            DATI DI USO GENERALE      (DCWWORK1)     ****** 
000187***************************************************************** 
000188 01  DCW-WORK1.                                                   
000189*----------------- NOME MAPPA CON GESTIONE CODICE LINGUA          
000190     05 WNOMEMAP.                                                 
000191        10  FILLER                     PIC X(2).                  
000192        10  WCODLING                   PIC X.                     
000193        10  FILLER                     PIC X(4).                  
000194*----------------- COMODO LINEA CONTENENTE L'ULTIMO EXEC CICS     
000195     05 WLINEAXX.                                                 
000196        10  EL-LINE    OCCURS 5        PIC X.                     
000197*----------------- COMODO CONTENENTE DFHEIV0                      
000198     05 T-COMLINE.                                                
000199        10  EL-COMLINE OCCURS 29       PIC X.                     
000200*----------------- INDICE PER SCORRERE LA T-COMLINE.              
000201     05 INDERR                         PIC S9(5) COMP-3 VALUE +0. 
000202*----------------- TRANSAZIONE IMPOSTATA AL MOMENTO DEL PF5 / PF4 
000203     05 WTRANSID                       PIC X(4) VALUE SPACES.     
000204*----------------- INDICE DELLA RIGA DI MAPPA                     
000205     05 WINDRIGA                       PIC S9(3) COMP-3 VALUE +0. 
000206*----------------- NUMERO MASSIMO DI RIGHE IN UNA MAPPA           
000207     05 WNUMRIGA                       PIC 9(2)        VALUE 0.   
000208*----------------- FLAG PER GLI ERRORI A LIVELLO DI DATI-MAPPA    
000209     05 WSWERROR                       PIC X      VALUE SPACES.   
000210        88 ERRORE                                 VALUE '*'.      
000211*----------------- NUMERO PAGINA RICHIESTO                        
000212     05 WPAGRICH                       PIC S9(5) COMP-3 VALUE +0. 
000213*----------------- NUMERO RECORD CODA-TS                          
000214     05 WNUMITEM                       PIC S9(4) COMP VALUE +0.   
000215*----------------- INDICE DELLA CODA DI PAGINAZIONE TS            
000216     05 WPAGIPAG                       PIC S9(4) COMP VALUE +0.   
000217*----------------- CHIAVE DELLA CODA DI PAGINAZIONE TS            
000218     05 WPAGCTRL.                                                 
000219        10  WPAGNOME                   PIC X(4)    VALUE 'PAGI'.  
000220        10  WPAGVIDE                   PIC X(4).                  
000221*----------------- LUNGHEZZA  CODA DI PAGINAZIONE TS              
000222     05 WPAGLPAG                       PIC S9(4) COMP VALUE +0.   
000223*----------------- ABSOLUTE TIME                                  
000224     05 WABSTIME                       PIC S9(15) COMP-3 VALUE +0.
000225*----------------- ABSOLUTE YEAR                                  
000226     05 WABSYEAR                       PIC S9(8) COMP VALUE +0.   
000227*----------------- FOR RESP OPTION                                
000228     05 WEIBRESP                       PIC S9(8) COMP VALUE +0.   
000229*----------------- FOR CVDA  (CICS VALUE DATA AREA)               
000230     05 WNOLOG                         PIC S9(8) COMP VALUE +0.   
000231     05 WCVDA                          PIC S9(8) COMP VALUE +0.   
000232     05 WCVDA-OPEN                     PIC S9(8) COMP VALUE +18.  
000233     05 WCVDA-CLOSED                   PIC S9(8) COMP VALUE +19.  
000234*----------------- FOR BIF DEEDIT                                 
000235     05 WWTWSNU                        PIC X(8) VALUE 'WWTWSNU'.  
000236     05 WLENGTH                        PIC S9(4) COMP.            
000237*----------------- AREA DELLA CODA TS DI PAGINAZIONE              
000238 01  WPAGREFE.                                                    
000239     05  FILLER                        PIC X    VALUE SPACES.     
000240     05  WPAGREF1 OCCURS 18.                                      
000241         15  WPAG-OPERAZIO       PIC X(01).                       
000242         15  WPAG-RCODCLIE       PIC X(05).                       
000243         15  WPAG-RRAGFATT       PIC X(24).                       
000244         15  WPAG-RDTINILI       PIC X(06).                       
000245         15  WPAG-RDTFINLI       PIC X(06).                       
000246         15  WPAG-RCODDIVI       PIC X(02).                       
000247         15  WPAG-RSIGLADI       PIC X(03).                       
000248 01  FILLER                      PIC X(08) VALUE 'COMODI**'.      
000249 01  COMODI.                                                      
000250     05  WS-SQLCODE              PIC S9(5) COMP-3 VALUE +0.       
000251     05  WS-SQLCODE2             PIC S9(5) COMP-3 VALUE +0.       
000252     05  WS-OPERAZIO             PIC X(01)  VALUE SPACES.         
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000253     05  WS-CODCLIEN             PIC X(05)  VALUE SPACES.         
000254     05  WS-CODDIVIS             PIC X(02)  VALUE SPACES.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000255     05  WS-CODSOCIE             PIC X(02)  VALUE SPACES.         
000256     05  WS-CODSOCI1             PIC X(02)  VALUE SPACES.         
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000257     05  WS-TIPSERVI             PIC X(01)  VALUE SPACES.         
000258     05  WS-DTINILIS             PIC X(06)  VALUE SPACES.         
000259     05  WS-DTFINLIS             PIC X(06)  VALUE SPACES.         
000260     05  MIN-CODCLIEN            PIC X(06)  VALUE SPACES.         
000261     05  MAX-CODCLIEN            PIC X(06)  VALUE SPACES.         
000262     05  MIN-DTINILIS            PIC X(06)  VALUE SPACES.         
000263     05  MAX-DTINILIS            PIC X(06)  VALUE SPACES.         
000264     05  MIN-DTFINLIS            PIC X(06)  VALUE SPACES.         
000265     05  MAX-DTFINLIS            PIC X(06)  VALUE SPACES.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000266     05  WS-IND1                 PIC S9(3) COMP-3 VALUE +0.       
000267     05  WS-IND2                 PIC S9(3) COMP-3 VALUE +0.       
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000268     05  WS-RAGFATTU             PIC X(24)  VALUE SPACES.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000269     05  WS-RAGFATT2.                                             
000270         10 WS-BYTE2             PIC X OCCURS 24.                 
000271     05  WS-RAGFATT3.                                             
000272         10 WS-BYTE3             PIC X OCCURS 24.                 
000273*---------------------------------------------------------------- 
000274 01  FILLER                      PIC X(08) VALUE '*DFHAID*'.      
000275*    COPY DFHAID   SUPPRESS.                                      
000276***************************************************************** 
000277*                                                               * 
000278* Copyright (c) 2016-2022 NTT DATA, Inc.                        * 
000279* All rights reserved.                                          * 
000280*                                                               * 
000281***************************************************************** 
000282 01  DFHAID.                                                      
000283     02  DFHNULL   PIC X VALUE "-".                               
000284     02  DFHENTER  PIC X VALUE "'".                               
000285     02  DFHCLEAR  PIC X VALUE "_".                               
000286     02  DFHCLRP   PIC X VALUE "|".                               
000287     02  DFHPEN    PIC X VALUE "=".                               
000288     02  DFHOPID   PIC X VALUE "W".                               
000289     02  DFHMSRE   PIC X VALUE "X".                               
000290     02  DFHSTRF   PIC X VALUE "h".                               
000291     02  DFHTRIG   PIC X VALUE '"'.                               
000292     02  DFHPA1    PIC X VALUE "%".                               
000293     02  DFHPA2    PIC X VALUE ">".                               
000294     02  DFHPA3    PIC X VALUE ",".                               
000295     02  DFHPF1    PIC X VALUE "1".                               
000296     02  DFHPF2    PIC X VALUE "2".                               
000297     02  DFHPF3    PIC X VALUE "3".                               
000298     02  DFHPF4    PIC X VALUE "4".                               
000299     02  DFHPF5    PIC X VALUE "5".                               
000300     02  DFHPF6    PIC X VALUE "6".                               
000301     02  DFHPF7    PIC X VALUE "7".                               
000302     02  DFHPF8    PIC X VALUE "8".                               
000303     02  DFHPF9    PIC X VALUE "9".                               
000304     02  DFHPF10   PIC X VALUE ":".                               
000305     02  DFHPF11   PIC X VALUE "#".                               
000306     02  DFHPF12   PIC X VALUE "@".                               
000307     02  DFHPF13   PIC X VALUE "A".                               
000308     02  DFHPF14   PIC X VALUE "B".                               
000309     02  DFHPF15   PIC X VALUE "C".                               
000310     02  DFHPF16   PIC X VALUE "D".                               
000311     02  DFHPF17   PIC X VALUE "E".                               
000312     02  DFHPF18   PIC X VALUE "F".                               
000313     02  DFHPF19   PIC X VALUE "G".                               
000314     02  DFHPF20   PIC X VALUE "H".                               
000315     02  DFHPF21   PIC X VALUE "I".                               
000316     02  DFHPF22   PIC X VALUE "[".                               
000317     02  DFHPF23   PIC X VALUE ".".                               
000318     02  DFHPF24   PIC X VALUE "<".                               
000319 01  FILLER                      PIC X(08) VALUE 'DCWATTRI'.      
000320*    COPY DCWATTRI SUPPRESS.                                      
000321******************************************************************
000322******       VALORI    DEGLI   ATTRIBUTI    (WCOPATTR)      ******
000323******************************************************************
000324 01       DFHBMSCA.                                               
000325   05     DFHBMEOF                    PIC X  VALUE ' '.           
000326*  X'80'  CC DI RITORNO DI UN CAMPO ANNULLATO CON CANCEL F.C.     
000327   05     DFHBMUNP                    PIC X  VALUE ' '.           
000328*  X'40'  NON PROTETTO                                            
000329   05     DFHBMFSE                    PIC X  VALUE 'A'.           
000330*  X'C1'  NON PROTETTO MDT                                        
000331   05     DFHUNPSP                    PIC X  VALUE 'D'.           
000332*  X'C4'  NON PROTETTO SELEZIONABILE                              
000333   05     DFHUNPSM                    PIC X  VALUE 'E'.           
000334*  X'C5'  NON PROTETTO SELEZIONABILE MDT                          
000335   05     DFHBMBRY                    PIC X  VALUE 'H'.           
000336*  X'C8'  NON PROTETTO LUMINOSO SELEZIONABILE                     
000337   05     DFHUNIMD                    PIC X  VALUE 'I'.           
000338*  X'C9'  NON PROTETTO LUMINOSO SELEZIONABILE MDT                 
000339   05     DFHBMDAR                    PIC X  VALUE '<'.           
000340*  X'4C'  NON PROTETTO NON VISIBILE                               
000341   05     DFHUNNOD                    PIC X  VALUE '('.           
000342*  X'4D'  NON PROTETTO NON VISIBILE MDT                           
000343   05     DFHBMUNN                    PIC X  VALUE '&'.           
000344*  X'50'  NON PROTETTO NUMERICO                                   
000345   05     DFHUNNUM                    PIC X  VALUE 'J'.           
000346*  X'D1'  NON PROTETTO NUMERICO MDT                               
000347   05     DFHUNPNS                    PIC X  VALUE 'M'.           
000348*  X'D4'  NON PROTETTO NUMERICO SELEZIONABILE                     
000349   05     DFHUNNSM                    PIC X  VALUE 'N'.           
000350*  X'D5'  NON PROTETTO NUMERICO SELEZIONABILE MDT                 
000351   05     DFHUNNBS                    PIC X  VALUE 'Q'.           
000352*  X'D8'  NON PROTETTO NUMERICO LUMINOSO SELEZIONABILE            
000353   05     DFHUNBSM                    PIC X  VALUE 'R'.           
000354*  X'D9'  NON PROTETTO NUMERICO LUMINOSO SELEZIONABILE MDT        
000355   05     DFHUNPND                    PIC X  VALUE '*'.           
000356*  X'5C'  NON PROTETTO NUMERICO NON VISIBILE                      
000357   05     DFHUNNON                    PIC X  VALUE ')'.           
000358*  X'5D'  NON PROTETTO NUMERICO NON VISIBILE MDT                  
000359   05     DFHBMPRO                    PIC X  VALUE '-'.           
000360*  X'60'  PROTETTO                                                
000361   05     DFHBMPRF                    PIC X  VALUE '/'.           
000362*  X'61'  PROTETTO MDT                                            
000363   05     DFHPROSP                    PIC X  VALUE 'U'.           
000364*  X'E4'  PROTETTO SELEZIONABILE                                  
000365   05     DFHPRSPM                    PIC X  VALUE 'V'.           
000366*  X'E5'  PROTETTO SELEZIONABILE MDT                              
000367   05     DFHPROTI                    PIC X  VALUE 'Y'.           
000368*  X'E8'  PROTETTO LUMINOSO SELEZIONABILE                         
000369   05     DFHPRLSM                    PIC X  VALUE 'Z'.           
000370*  X'E9'  PROTETTO LUMINOSO SELEZIONABILE MDT                     
000371   05     DFHPROTN                    PIC X  VALUE '%'.           
000372*  X'6C'  PROTETTO NON VISIBILE                                   
000373   05     DFHPRODM                    PIC X  VALUE '_'.           
000374*  X'6D'  PROTETTO NON VISIBILE MDT                               
000375   05     DFHBMASK                    PIC X  VALUE '0'.           
000376*  X'F0'  PROTETTO SKIP                                           
000377   05     DFHBMASF                    PIC X  VALUE '1'.           
000378*  X'F1'  PROTETTO SKIP  MDT                                      
000379   05     DFHPRSKS                    PIC X  VALUE '4'.           
000380*  X'F4'  PROTETTO SKIP  SELEZIONABILE                            
000381   05     DFHPSKSM                    PIC X  VALUE '5'.           
000382*  X'F5'  PROTETTO SKIP  SELEZIONABILE MDT                        
000383   05     DFHBMASB                    PIC X  VALUE '8'.           
000384*  X'F8'  PROTETTO SKIP  LUMINOSO SELEZIONABILE                   
000385   05     DFHPROIM                    PIC X  VALUE '9'.           
000386*  X'F9'  PROTETTO SKIP  LUMINOSO SELEZIONABILE MDT               
000387*  05     DFHPRSKD                    PIC X  VALUE '§'.           
000388   05     DFHPRSKD                    PIC X  VALUE '@'.           
000389*  X'7C'  PROTETTO SKIP  NON VISIBILE                             
000390   05     DFHPSKDM                    PIC X  VALUE QUOTE.         
000391*  X'7D'  PROTETTO SKIP  NON VISIBILE MDT                         
000392   05     DFHBLUE                     PIC X  VALUE '1'.           
000393*  X'F1'  COLORE BLUE                                             
000394   05     DFHRED                      PIC X  VALUE '2'.           
000395*  X'F2'  COLORE ROSSO                                            
000396   05     DFHPINK                     PIC X  VALUE '3'.           
000397*  X'F3'  COLORE ROSA                                             
000398   05     DFHGREEN                    PIC X  VALUE '4'.           
000399*  X'F4'  COLORE VERDE                                            
000400   05     DFHTURQ                     PIC X  VALUE '5'.           
000401*  X'F5'  COLORE AZZURRO                                          
000402   05     DFHYELLO                    PIC X  VALUE '6'.           
000403*  X'F6'  COLORE GIALLO                                           
000404   05     DFHNEUTR                    PIC X  VALUE '7'.           
000405*  X'F7'  COLORE NEUTRO                                           
000406   05     DFHDFHI                     PIC X  VALUE HIGH-VALUE.    
000407*  X'FF'  TOGLIE LA SOTTOLINEATURA (UNDERLINE)                    
000408   05     DFHUNDLN                    PIC X  VALUE '4'.           
000409*  X'F4'  IMPOSTA LA SOTTOLINEATURA (UNDERLINE)                   
000410   05     DFHREVRS                    PIC X  VALUE '2'.           
000411*  X'F4'  IMPOSTA IL REVERSE                                      
000412   05     DFHALL                      PIC X  VALUE ' '.           
000413*  X'00'  PULISCE GLI ATTRIBUTI PRENDENDO QUELLI DI MAPPA         
000414 01  FILLER                      PIC X(08) VALUE '*DCMESS*'.      
000415*    COPY DCMESS.                                                 
000416********************     DCMESS           ************************
000417*********  COPY PER ESECUZIONE DELLA SUBROUTINE SRMESS     *******
000418*********  GESTIONE MESSAGGI DI ERRORE TP/BATCH            *******
000419******************************************************************
000420 01  DCMESS.                                                      
000421     05  MESS-CAMPI-INPUT.                                        
000422         10  MESS-CODERROR      PIC X(5)       VALUE SPACES.      
000423         10  MESS-CODILING      PIC X(1)       VALUE SPACES.      
000424     05  MESS-CAMPI-OUTPUT.                                       
000425         10  MESS-MSGERROR.                                       
000426             15  MESS-COMCODER  PIC X(5)       VALUE SPACES.      
000427             15  FILLER         PIC X          VALUE SPACES.      
000428             15  MESS-MESSAGGI  PIC X(66)      VALUE SPACES.      
000429 01  FILLER                      PIC X(08) VALUE '*AVMLO60'.      
000430*    COPY AVMLO60.                                                
000431***************************************************************** 
000432* SDF: AVMLO60 AVBLO60                                            
000433***************************************************************** 
000434 01   AVBLO60I.                                                   
000435     05 FILLER    PIC X(12).                                      
000436     05 BO60-MAPDATAL  COMP PIC S9(4).                            
000437     05 BO60-MAPDATAF  PIC X.                                     
000438     05 FILLER    PIC X(4).                                       
000439     05 BO60-MAPDATAI  PIC X(8).                                  
000440     05 BO60-MAPORAXL  COMP PIC S9(4).                            
000441     05 BO60-MAPORAXF  PIC X.                                     
000442     05 FILLER    PIC X(4).                                       
000443     05 BO60-MAPORAXI  PIC X(8).                                  
000444     05 BO60-CODCLIENL      COMP PIC S9(4).                       
000445     05 BO60-CODCLIENF      PIC X.                                
000446     05 FILLER    PIC X(4).                                       
000447     05 BO60-CODCLIENI      PIC X(5).                             
000448     05 BO60-RAGFATTUL      COMP PIC S9(4).                       
000449     05 BO60-RAGFATTUF      PIC X.                                
000450     05 FILLER    PIC X(4).                                       
000451     05 BO60-RAGFATTUI      PIC X(24).                            
000452     05 BO60-DTIPSERVL      COMP PIC S9(4).                       
000453     05 BO60-DTIPSERVF      PIC X.                                
000454     05 FILLER    PIC X(4).                                       
000455     05 BO60-DTIPSERVI      PIC X(11).                            
000456     05 BO60-FLAGULTIL      COMP PIC S9(4).                       
000457     05 BO60-FLAGULTIF      PIC X.                                
000458     05 FILLER    PIC X(4).                                       
000459     05 BO60-FLAGULTII      PIC X.                                
000460     05 BO60-DTINILISL      COMP PIC S9(4).                       
000461     05 BO60-DTINILISF      PIC X.                                
000462     05 FILLER    PIC X(4).                                       
000463     05 BO60-DTINILISI      PIC X(6).                             
000464     05 BO60-DTFINLISL      COMP PIC S9(4).                       
000465     05 BO60-DTFINLISF      PIC X.                                
000466     05 FILLER    PIC X(4).                                       
000467     05 BO60-DTFINLISI      PIC X(6).                             
000468     05 BO60-RIGAI OCCURS   18 TIMES .                            
000469       09 BO60-OPERAZIOL    COMP PIC S9(4).                       
000470       09 BO60-OPERAZIOF    PIC X.                                
000471       09 FILLER  PIC X(4).                                       
000472       09 BO60-OPERAZIOI    PIC X.                                
000473       09 BO60-RCODCLIEL    COMP PIC S9(4).                       
000474       09 BO60-RCODCLIEF    PIC X.                                
000475       09 FILLER  PIC X(4).                                       
000476       09 BO60-RCODCLIEI    PIC X(5).                             
000477       09 BO60-RRAGFATTL    COMP PIC S9(4).                       
000478       09 BO60-RRAGFATTF    PIC X.                                
000479       09 FILLER  PIC X(4).                                       
000480       09 BO60-RRAGFATTI    PIC X(24).                            
000481       09 BO60-RDTINILIL    COMP PIC S9(4).                       
000482       09 BO60-RDTINILIF    PIC X.                                
000483       09 FILLER  PIC X(4).                                       
000484       09 BO60-RDTINILII    PIC X(6).                             
000485       09 BO60-RDTFINLIL    COMP PIC S9(4).                       
000486       09 BO60-RDTFINLIF    PIC X.                                
000487       09 FILLER  PIC X(4).                                       
000488       09 BO60-RDTFINLII    PIC X(6).                             
000489       09 BO60-RCODDIVIL    COMP PIC S9(4).                       
000490       09 BO60-RCODDIVIF    PIC X.                                
000491       09 FILLER  PIC X(4).                                       
000492       09 BO60-RCODDIVII    PIC X(2).                             
000493       09 BO60-RSIGLADIL    COMP PIC S9(4).                       
000494       09 BO60-RSIGLADIF    PIC X.                                
000495       09 FILLER  PIC X(4).                                       
000496       09 BO60-RSIGLADII    PIC X(3).                             
000497     05 BO60-XCODCLIEL      COMP PIC S9(4).                       
000498     05 BO60-XCODCLIEF      PIC X.                                
000499     05 FILLER    PIC X(4).                                       
000500     05 BO60-XCODCLIEI      PIC X(5).                             
000501     05 BO60-XRAGFATTL      COMP PIC S9(4).                       
000502     05 BO60-XRAGFATTF      PIC X.                                
000503     05 FILLER    PIC X(4).                                       
000504     05 BO60-XRAGFATTI      PIC X(24).                            
000505     05 BO60-XDTINILIL      COMP PIC S9(4).                       
000506     05 BO60-XDTINILIF      PIC X.                                
000507     05 FILLER    PIC X(4).                                       
000508     05 BO60-XDTINILII      PIC X(6).                             
000509     05 BO60-XDTFINLIL      COMP PIC S9(4).                       
000510     05 BO60-XDTFINLIF      PIC X.                                
000511     05 FILLER    PIC X(4).                                       
000512     05 BO60-XDTFINLII      PIC X(6).                             
000513     05 BO60-XCODDIVIL      COMP PIC S9(4).                       
000514     05 BO60-XCODDIVIF      PIC X.                                
000515     05 FILLER    PIC X(4).                                       
000516     05 BO60-XCODDIVII      PIC X(2).                             
000517     05 BO60-XSIGLADIL      COMP PIC S9(4).                       
000518     05 BO60-XSIGLADIF      PIC X.                                
000519     05 FILLER    PIC X(4).                                       
000520     05 BO60-XSIGLADII      PIC X(3).                             
000521     05 BO60-MAPRPAGL  COMP PIC S9(4).                            
000522     05 BO60-MAPRPAGF  PIC X.                                     
000523     05 FILLER    PIC X(4).                                       
000524     05 BO60-MAPRPAGI  PIC X(4).                                  
000525     05 BO60-MAPPPAGL  COMP PIC S9(4).                            
000526     05 BO60-MAPPPAGF  PIC X.                                     
000527     05 FILLER    PIC X(4).                                       
000528     05 BO60-MAPPPAGI  PIC X(4).                                  
000529     05 BO60-MESSAGGL  COMP PIC S9(4).                            
000530     05 BO60-MESSAGGF  PIC X.                                     
000531     05 FILLER    PIC X(4).                                       
000532     05 BO60-MESSAGGI  PIC X(56).                                 
000533***************************************************************** 
000534* SDF: AVMLO60 AVBLO60                                            
000535***************************************************************** 
000536 01   AVBLO60O REDEFINES AVBLO60I.                                
000537     05 FILLER    PIC X(12).                                      
000538     05 FILLER    PIC X(2).                                       
000539     05 BO60-MAPDATAA  PIC X.                                     
000540     05 BO60-MAPDATAC  PIC X.                                     
000541     05 BO60-MAPDATAP  PIC X.                                     
000542     05 BO60-MAPDATAH  PIC X.                                     
000543     05 BO60-MAPDATAV  PIC X.                                     
000544     05 BO60-MAPDATAO  PIC X(8).                                  
000545     05 FILLER    PIC X(2).                                       
000546     05 BO60-MAPORAXA  PIC X.                                     
000547     05 BO60-MAPORAXC  PIC X.                                     
000548     05 BO60-MAPORAXP  PIC X.                                     
000549     05 BO60-MAPORAXH  PIC X.                                     
000550     05 BO60-MAPORAXV  PIC X.                                     
000551     05 BO60-MAPORAXO  PIC 99.99.99.                              
000552     05 FILLER    PIC X(2).                                       
000553     05 BO60-CODCLIENA      PIC X.                                
000554     05 BO60-CODCLIENC PIC X.                                     
000555     05 BO60-CODCLIENP PIC X.                                     
000556     05 BO60-CODCLIENH PIC X.                                     
000557     05 BO60-CODCLIENV PIC X.                                     
000558     05 BO60-CODCLIENO      PIC X(5).                             
000559     05 FILLER    PIC X(2).                                       
000560     05 BO60-RAGFATTUA      PIC X.                                
000561     05 BO60-RAGFATTUC PIC X.                                     
000562     05 BO60-RAGFATTUP PIC X.                                     
000563     05 BO60-RAGFATTUH PIC X.                                     
000564     05 BO60-RAGFATTUV PIC X.                                     
000565     05 BO60-RAGFATTUO      PIC X(24).                            
000566     05 FILLER    PIC X(2).                                       
000567     05 BO60-DTIPSERVA      PIC X.                                
000568     05 BO60-DTIPSERVC PIC X.                                     
000569     05 BO60-DTIPSERVP PIC X.                                     
000570     05 BO60-DTIPSERVH PIC X.                                     
000571     05 BO60-DTIPSERVV PIC X.                                     
000572     05 BO60-DTIPSERVO      PIC X(11).                            
000573     05 FILLER    PIC X(2).                                       
000574     05 BO60-FLAGULTIA      PIC X.                                
000575     05 BO60-FLAGULTIC PIC X.                                     
000576     05 BO60-FLAGULTIP PIC X.                                     
000577     05 BO60-FLAGULTIH PIC X.                                     
000578     05 BO60-FLAGULTIV PIC X.                                     
000579     05 BO60-FLAGULTIO      PIC X.                                
000580     05 FILLER    PIC X(2).                                       
000581     05 BO60-DTINILISA      PIC X.                                
000582     05 BO60-DTINILISC PIC X.                                     
000583     05 BO60-DTINILISP PIC X.                                     
000584     05 BO60-DTINILISH PIC X.                                     
000585     05 BO60-DTINILISV PIC X.                                     
000586     05 BO60-DTINILISO      PIC X(6).                             
000587     05 FILLER    PIC X(2).                                       
000588     05 BO60-DTFINLISA      PIC X.                                
000589     05 BO60-DTFINLISC PIC X.                                     
000590     05 BO60-DTFINLISP PIC X.                                     
000591     05 BO60-DTFINLISH PIC X.                                     
000592     05 BO60-DTFINLISV PIC X.                                     
000593     05 BO60-DTFINLISO      PIC X(6).                             
000594     05 BO60-RIGAO OCCURS   18 TIMES .                            
000595       09 FILLER       PIC X(2).                                  
000596       09 BO60-OPERAZIOA    PIC X.                                
000597       09 BO60-OPERAZIOC    PIC X.                                
000598       09 BO60-OPERAZIOP    PIC X.                                
000599       09 BO60-OPERAZIOH    PIC X.                                
000600       09 BO60-OPERAZIOV    PIC X.                                
000601       09 BO60-OPERAZIOO    PIC X.                                
000602       09 FILLER       PIC X(2).                                  
000603       09 BO60-RCODCLIEA    PIC X.                                
000604       09 BO60-RCODCLIEC    PIC X.                                
000605       09 BO60-RCODCLIEP    PIC X.                                
000606       09 BO60-RCODCLIEH    PIC X.                                
000607       09 BO60-RCODCLIEV    PIC X.                                
000608       09 BO60-RCODCLIEO    PIC X(5).                             
000609       09 FILLER       PIC X(2).                                  
000610       09 BO60-RRAGFATTA    PIC X.                                
000611       09 BO60-RRAGFATTC    PIC X.                                
000612       09 BO60-RRAGFATTP    PIC X.                                
000613       09 BO60-RRAGFATTH    PIC X.                                
000614       09 BO60-RRAGFATTV    PIC X.                                
000615       09 BO60-RRAGFATTO    PIC X(24).                            
000616       09 FILLER       PIC X(2).                                  
000617       09 BO60-RDTINILIA    PIC X.                                
000618       09 BO60-RDTINILIC    PIC X.                                
000619       09 BO60-RDTINILIP    PIC X.                                
000620       09 BO60-RDTINILIH    PIC X.                                
000621       09 BO60-RDTINILIV    PIC X.                                
000622       09 BO60-RDTINILIO    PIC X(6).                             
000623       09 FILLER       PIC X(2).                                  
000624       09 BO60-RDTFINLIA    PIC X.                                
000625       09 BO60-RDTFINLIC    PIC X.                                
000626       09 BO60-RDTFINLIP    PIC X.                                
000627       09 BO60-RDTFINLIH    PIC X.                                
000628       09 BO60-RDTFINLIV    PIC X.                                
000629       09 BO60-RDTFINLIO    PIC X(6).                             
000630       09 FILLER       PIC X(2).                                  
000631       09 BO60-RCODDIVIA    PIC X.                                
000632       09 BO60-RCODDIVIC    PIC X.                                
000633       09 BO60-RCODDIVIP    PIC X.                                
000634       09 BO60-RCODDIVIH    PIC X.                                
000635       09 BO60-RCODDIVIV    PIC X.                                
000636       09 BO60-RCODDIVIO    PIC X(2).                             
000637       09 FILLER       PIC X(2).                                  
000638       09 BO60-RSIGLADIA    PIC X.                                
000639       09 BO60-RSIGLADIC    PIC X.                                
000640       09 BO60-RSIGLADIP    PIC X.                                
000641       09 BO60-RSIGLADIH    PIC X.                                
000642       09 BO60-RSIGLADIV    PIC X.                                
000643       09 BO60-RSIGLADIO    PIC X(3).                             
000644     05 FILLER    PIC X(2).                                       
000645     05 BO60-XCODCLIEA      PIC X.                                
000646     05 BO60-XCODCLIEC PIC X.                                     
000647     05 BO60-XCODCLIEP PIC X.                                     
000648     05 BO60-XCODCLIEH PIC X.                                     
000649     05 BO60-XCODCLIEV PIC X.                                     
000650     05 BO60-XCODCLIEO      PIC X(5).                             
000651     05 FILLER    PIC X(2).                                       
000652     05 BO60-XRAGFATTA      PIC X.                                
000653     05 BO60-XRAGFATTC PIC X.                                     
000654     05 BO60-XRAGFATTP PIC X.                                     
000655     05 BO60-XRAGFATTH PIC X.                                     
000656     05 BO60-XRAGFATTV PIC X.                                     
000657     05 BO60-XRAGFATTO      PIC X(24).                            
000658     05 FILLER    PIC X(2).                                       
000659     05 BO60-XDTINILIA      PIC X.                                
000660     05 BO60-XDTINILIC PIC X.                                     
000661     05 BO60-XDTINILIP PIC X.                                     
000662     05 BO60-XDTINILIH PIC X.                                     
000663     05 BO60-XDTINILIV PIC X.                                     
000664     05 BO60-XDTINILIO      PIC X(6).                             
000665     05 FILLER    PIC X(2).                                       
000666     05 BO60-XDTFINLIA      PIC X.                                
000667     05 BO60-XDTFINLIC PIC X.                                     
000668     05 BO60-XDTFINLIP PIC X.                                     
000669     05 BO60-XDTFINLIH PIC X.                                     
000670     05 BO60-XDTFINLIV PIC X.                                     
000671     05 BO60-XDTFINLIO      PIC X(6).                             
000672     05 FILLER    PIC X(2).                                       
000673     05 BO60-XCODDIVIA      PIC X.                                
000674     05 BO60-XCODDIVIC PIC X.                                     
000675     05 BO60-XCODDIVIP PIC X.                                     
000676     05 BO60-XCODDIVIH PIC X.                                     
000677     05 BO60-XCODDIVIV PIC X.                                     
000678     05 BO60-XCODDIVIO      PIC X(2).                             
000679     05 FILLER    PIC X(2).                                       
000680     05 BO60-XSIGLADIA      PIC X.                                
000681     05 BO60-XSIGLADIC PIC X.                                     
000682     05 BO60-XSIGLADIP PIC X.                                     
000683     05 BO60-XSIGLADIH PIC X.                                     
000684     05 BO60-XSIGLADIV PIC X.                                     
000685     05 BO60-XSIGLADIO      PIC X(3).                             
000686     05 FILLER    PIC X(2).                                       
000687     05 BO60-MAPRPAGA  PIC X.                                     
000688     05 BO60-MAPRPAGC  PIC X.                                     
000689     05 BO60-MAPRPAGP  PIC X.                                     
000690     05 BO60-MAPRPAGH  PIC X.                                     
000691     05 BO60-MAPRPAGV  PIC X.                                     
000692     05 BO60-MAPRPAGO  PIC 9(4).                                  
000693     05 FILLER    PIC X(2).                                       
000694     05 BO60-MAPPPAGA  PIC X.                                     
000695     05 BO60-MAPPPAGC  PIC X.                                     
000696     05 BO60-MAPPPAGP  PIC X.                                     
000697     05 BO60-MAPPPAGH  PIC X.                                     
000698     05 BO60-MAPPPAGV  PIC X.                                     
000699     05 BO60-MAPPPAGO  PIC 9(4).                                  
000700     05 FILLER    PIC X(2).                                       
000701     05 BO60-MESSAGGA  PIC X.                                     
000702     05 BO60-MESSAGGC  PIC X.                                     
000703     05 BO60-MESSAGGP  PIC X.                                     
000704     05 BO60-MESSAGGH  PIC X.                                     
000705     05 BO60-MESSAGGV  PIC X.                                     
000706     05 BO60-MESSAGGO  PIC X(56).                                 
000707***************************************************************** 
000708* SDF: AVMLO60 AVDLO60                                            
000709***************************************************************** 
000710 01   AVDLO60I REDEFINES AVBLO60I.                                
000711     05 FILLER    PIC X(12).                                      
000712     05 DO60-MAPDATAL  COMP PIC S9(4).                            
000713     05 DO60-MAPDATAF  PIC X.                                     
000714     05 FILLER    PIC X(4).                                       
000715     05 DO60-MAPDATAI  PIC X(8).                                  
000716     05 DO60-MAPORAXL  COMP PIC S9(4).                            
000717     05 DO60-MAPORAXF  PIC X.                                     
000718     05 FILLER    PIC X(4).                                       
000719     05 DO60-MAPORAXI  PIC X(8).                                  
000720     05 DO60-CODCLIENL      COMP PIC S9(4).                       
000721     05 DO60-CODCLIENF      PIC X.                                
000722     05 FILLER    PIC X(4).                                       
000723     05 DO60-CODCLIENI      PIC X(5).                             
000724     05 DO60-RAGFATTUL      COMP PIC S9(4).                       
000725     05 DO60-RAGFATTUF      PIC X.                                
000726     05 FILLER    PIC X(4).                                       
000727     05 DO60-RAGFATTUI      PIC X(24).                            
000728     05 DO60-DTIPSERVL      COMP PIC S9(4).                       
000729     05 DO60-DTIPSERVF      PIC X.                                
000730     05 FILLER    PIC X(4).                                       
000731     05 DO60-DTIPSERVI      PIC X(11).                            
000732     05 DO60-FLAGULTIL      COMP PIC S9(4).                       
000733     05 DO60-FLAGULTIF      PIC X.                                
000734     05 FILLER    PIC X(4).                                       
000735     05 DO60-FLAGULTII      PIC X.                                
000736     05 DO60-DTINILISL      COMP PIC S9(4).                       
000737     05 DO60-DTINILISF      PIC X.                                
000738     05 FILLER    PIC X(4).                                       
000739     05 DO60-DTINILISI      PIC X(6).                             
000740     05 DO60-DTFINLISL      COMP PIC S9(4).                       
000741     05 DO60-DTFINLISF      PIC X.                                
000742     05 FILLER    PIC X(4).                                       
000743     05 DO60-DTFINLISI      PIC X(6).                             
000744     05 DO60-RIGAI OCCURS   18 TIMES .                            
000745       09 DO60-OPERAZIOL    COMP PIC S9(4).                       
000746       09 DO60-OPERAZIOF    PIC X.                                
000747       09 FILLER  PIC X(4).                                       
000748       09 DO60-OPERAZIOI    PIC X.                                
000749       09 DO60-RCODCLIEL    COMP PIC S9(4).                       
000750       09 DO60-RCODCLIEF    PIC X.                                
000751       09 FILLER  PIC X(4).                                       
000752       09 DO60-RCODCLIEI    PIC X(5).                             
000753       09 DO60-RRAGFATTL    COMP PIC S9(4).                       
000754       09 DO60-RRAGFATTF    PIC X.                                
000755       09 FILLER  PIC X(4).                                       
000756       09 DO60-RRAGFATTI    PIC X(24).                            
000757       09 DO60-RDTINILIL    COMP PIC S9(4).                       
000758       09 DO60-RDTINILIF    PIC X.                                
000759       09 FILLER  PIC X(4).                                       
000760       09 DO60-RDTINILII    PIC X(6).                             
000761       09 DO60-RDTFINLIL    COMP PIC S9(4).                       
000762       09 DO60-RDTFINLIF    PIC X.                                
000763       09 FILLER  PIC X(4).                                       
000764       09 DO60-RDTFINLII    PIC X(6).                             
000765       09 DO60-RCODDIVIL    COMP PIC S9(4).                       
000766       09 DO60-RCODDIVIF    PIC X.                                
000767       09 FILLER  PIC X(4).                                       
000768       09 DO60-RCODDIVII    PIC X(2).                             
000769       09 DO60-RSIGLADIL    COMP PIC S9(4).                       
000770       09 DO60-RSIGLADIF    PIC X.                                
000771       09 FILLER  PIC X(4).                                       
000772       09 DO60-RSIGLADII    PIC X(3).                             
000773     05 DO60-XCODCLIEL      COMP PIC S9(4).                       
000774     05 DO60-XCODCLIEF      PIC X.                                
000775     05 FILLER    PIC X(4).                                       
000776     05 DO60-XCODCLIEI      PIC X(5).                             
000777     05 DO60-XRAGFATTL      COMP PIC S9(4).                       
000778     05 DO60-XRAGFATTF      PIC X.                                
000779     05 FILLER    PIC X(4).                                       
000780     05 DO60-XRAGFATTI      PIC X(24).                            
000781     05 DO60-XDTINILIL      COMP PIC S9(4).                       
000782     05 DO60-XDTINILIF      PIC X.                                
000783     05 FILLER    PIC X(4).                                       
000784     05 DO60-XDTINILII      PIC X(6).                             
000785     05 DO60-XDTFINLIL      COMP PIC S9(4).                       
000786     05 DO60-XDTFINLIF      PIC X.                                
000787     05 FILLER    PIC X(4).                                       
000788     05 DO60-XDTFINLII      PIC X(6).                             
000789     05 DO60-XCODDIVIL      COMP PIC S9(4).                       
000790     05 DO60-XCODDIVIF      PIC X.                                
000791     05 FILLER    PIC X(4).                                       
000792     05 DO60-XCODDIVII      PIC X(2).                             
000793     05 DO60-XSIGLADIL      COMP PIC S9(4).                       
000794     05 DO60-XSIGLADIF      PIC X.                                
000795     05 FILLER    PIC X(4).                                       
000796     05 DO60-XSIGLADII      PIC X(3).                             
000797     05 DO60-MAPRPAGL  COMP PIC S9(4).                            
000798     05 DO60-MAPRPAGF  PIC X.                                     
000799     05 FILLER    PIC X(4).                                       
000800     05 DO60-MAPRPAGI  PIC X(4).                                  
000801     05 DO60-MAPPPAGL  COMP PIC S9(4).                            
000802     05 DO60-MAPPPAGF  PIC X.                                     
000803     05 FILLER    PIC X(4).                                       
000804     05 DO60-MAPPPAGI  PIC X(4).                                  
000805     05 DO60-MESSAGGL  COMP PIC S9(4).                            
000806     05 DO60-MESSAGGF  PIC X.                                     
000807     05 FILLER    PIC X(4).                                       
000808     05 DO60-MESSAGGI  PIC X(56).                                 
000809***************************************************************** 
000810* SDF: AVMLO60 AVDLO60                                            
000811***************************************************************** 
000812 01   AVDLO60O REDEFINES AVBLO60I.                                
000813     05 FILLER    PIC X(12).                                      
000814     05 FILLER    PIC X(2).                                       
000815     05 DO60-MAPDATAA  PIC X.                                     
000816     05 DO60-MAPDATAC  PIC X.                                     
000817     05 DO60-MAPDATAP  PIC X.                                     
000818     05 DO60-MAPDATAH  PIC X.                                     
000819     05 DO60-MAPDATAV  PIC X.                                     
000820     05 DO60-MAPDATAO  PIC X(8).                                  
000821     05 FILLER    PIC X(2).                                       
000822     05 DO60-MAPORAXA  PIC X.                                     
000823     05 DO60-MAPORAXC  PIC X.                                     
000824     05 DO60-MAPORAXP  PIC X.                                     
000825     05 DO60-MAPORAXH  PIC X.                                     
000826     05 DO60-MAPORAXV  PIC X.                                     
000827     05 DO60-MAPORAXO  PIC 99.99.99.                              
000828     05 FILLER    PIC X(2).                                       
000829     05 DO60-CODCLIENA      PIC X.                                
000830     05 DO60-CODCLIENC PIC X.                                     
000831     05 DO60-CODCLIENP PIC X.                                     
000832     05 DO60-CODCLIENH PIC X.                                     
000833     05 DO60-CODCLIENV PIC X.                                     
000834     05 DO60-CODCLIENO      PIC X(5).                             
000835     05 FILLER    PIC X(2).                                       
000836     05 DO60-RAGFATTUA      PIC X.                                
000837     05 DO60-RAGFATTUC PIC X.                                     
000838     05 DO60-RAGFATTUP PIC X.                                     
000839     05 DO60-RAGFATTUH PIC X.                                     
000840     05 DO60-RAGFATTUV PIC X.                                     
000841     05 DO60-RAGFATTUO      PIC X(24).                            
000842     05 FILLER    PIC X(2).                                       
000843     05 DO60-DTIPSERVA      PIC X.                                
000844     05 DO60-DTIPSERVC PIC X.                                     
000845     05 DO60-DTIPSERVP PIC X.                                     
000846     05 DO60-DTIPSERVH PIC X.                                     
000847     05 DO60-DTIPSERVV PIC X.                                     
000848     05 DO60-DTIPSERVO      PIC X(11).                            
000849     05 FILLER    PIC X(2).                                       
000850     05 DO60-FLAGULTIA      PIC X.                                
000851     05 DO60-FLAGULTIC PIC X.                                     
000852     05 DO60-FLAGULTIP PIC X.                                     
000853     05 DO60-FLAGULTIH PIC X.                                     
000854     05 DO60-FLAGULTIV PIC X.                                     
000855     05 DO60-FLAGULTIO      PIC X.                                
000856     05 FILLER    PIC X(2).                                       
000857     05 DO60-DTINILISA      PIC X.                                
000858     05 DO60-DTINILISC PIC X.                                     
000859     05 DO60-DTINILISP PIC X.                                     
000860     05 DO60-DTINILISH PIC X.                                     
000861     05 DO60-DTINILISV PIC X.                                     
000862     05 DO60-DTINILISO      PIC X(6).                             
000863     05 FILLER    PIC X(2).                                       
000864     05 DO60-DTFINLISA      PIC X.                                
000865     05 DO60-DTFINLISC PIC X.                                     
000866     05 DO60-DTFINLISP PIC X.                                     
000867     05 DO60-DTFINLISH PIC X.                                     
000868     05 DO60-DTFINLISV PIC X.                                     
000869     05 DO60-DTFINLISO      PIC X(6).                             
000870     05 DO60-RIGAO OCCURS   18 TIMES .                            
000871       09 FILLER       PIC X(2).                                  
000872       09 DO60-OPERAZIOA    PIC X.                                
000873       09 DO60-OPERAZIOC    PIC X.                                
000874       09 DO60-OPERAZIOP    PIC X.                                
000875       09 DO60-OPERAZIOH    PIC X.                                
000876       09 DO60-OPERAZIOV    PIC X.                                
000877       09 DO60-OPERAZIOO    PIC X.                                
000878       09 FILLER       PIC X(2).                                  
000879       09 DO60-RCODCLIEA    PIC X.                                
000880       09 DO60-RCODCLIEC    PIC X.                                
000881       09 DO60-RCODCLIEP    PIC X.                                
000882       09 DO60-RCODCLIEH    PIC X.                                
000883       09 DO60-RCODCLIEV    PIC X.                                
000884       09 DO60-RCODCLIEO    PIC X(5).                             
000885       09 FILLER       PIC X(2).                                  
000886       09 DO60-RRAGFATTA    PIC X.                                
000887       09 DO60-RRAGFATTC    PIC X.                                
000888       09 DO60-RRAGFATTP    PIC X.                                
000889       09 DO60-RRAGFATTH    PIC X.                                
000890       09 DO60-RRAGFATTV    PIC X.                                
000891       09 DO60-RRAGFATTO    PIC X(24).                            
000892       09 FILLER       PIC X(2).                                  
000893       09 DO60-RDTINILIA    PIC X.                                
000894       09 DO60-RDTINILIC    PIC X.                                
000895       09 DO60-RDTINILIP    PIC X.                                
000896       09 DO60-RDTINILIH    PIC X.                                
000897       09 DO60-RDTINILIV    PIC X.                                
000898       09 DO60-RDTINILIO    PIC X(6).                             
000899       09 FILLER       PIC X(2).                                  
000900       09 DO60-RDTFINLIA    PIC X.                                
000901       09 DO60-RDTFINLIC    PIC X.                                
000902       09 DO60-RDTFINLIP    PIC X.                                
000903       09 DO60-RDTFINLIH    PIC X.                                
000904       09 DO60-RDTFINLIV    PIC X.                                
000905       09 DO60-RDTFINLIO    PIC X(6).                             
000906       09 FILLER       PIC X(2).                                  
000907       09 DO60-RCODDIVIA    PIC X.                                
000908       09 DO60-RCODDIVIC    PIC X.                                
000909       09 DO60-RCODDIVIP    PIC X.                                
000910       09 DO60-RCODDIVIH    PIC X.                                
000911       09 DO60-RCODDIVIV    PIC X.                                
000912       09 DO60-RCODDIVIO    PIC X(2).                             
000913       09 FILLER       PIC X(2).                                  
000914       09 DO60-RSIGLADIA    PIC X.                                
000915       09 DO60-RSIGLADIC    PIC X.                                
000916       09 DO60-RSIGLADIP    PIC X.                                
000917       09 DO60-RSIGLADIH    PIC X.                                
000918       09 DO60-RSIGLADIV    PIC X.                                
000919       09 DO60-RSIGLADIO    PIC X(3).                             
000920     05 FILLER    PIC X(2).                                       
000921     05 DO60-XCODCLIEA      PIC X.                                
000922     05 DO60-XCODCLIEC PIC X.                                     
000923     05 DO60-XCODCLIEP PIC X.                                     
000924     05 DO60-XCODCLIEH PIC X.                                     
000925     05 DO60-XCODCLIEV PIC X.                                     
000926     05 DO60-XCODCLIEO      PIC X(5).                             
000927     05 FILLER    PIC X(2).                                       
000928     05 DO60-XRAGFATTA      PIC X.                                
000929     05 DO60-XRAGFATTC PIC X.                                     
000930     05 DO60-XRAGFATTP PIC X.                                     
000931     05 DO60-XRAGFATTH PIC X.                                     
000932     05 DO60-XRAGFATTV PIC X.                                     
000933     05 DO60-XRAGFATTO      PIC X(24).                            
000934     05 FILLER    PIC X(2).                                       
000935     05 DO60-XDTINILIA      PIC X.                                
000936     05 DO60-XDTINILIC PIC X.                                     
000937     05 DO60-XDTINILIP PIC X.                                     
000938     05 DO60-XDTINILIH PIC X.                                     
000939     05 DO60-XDTINILIV PIC X.                                     
000940     05 DO60-XDTINILIO      PIC X(6).                             
000941     05 FILLER    PIC X(2).                                       
000942     05 DO60-XDTFINLIA      PIC X.                                
000943     05 DO60-XDTFINLIC PIC X.                                     
000944     05 DO60-XDTFINLIP PIC X.                                     
000945     05 DO60-XDTFINLIH PIC X.                                     
000946     05 DO60-XDTFINLIV PIC X.                                     
000947     05 DO60-XDTFINLIO      PIC X(6).                             
000948     05 FILLER    PIC X(2).                                       
000949     05 DO60-XCODDIVIA      PIC X.                                
000950     05 DO60-XCODDIVIC PIC X.                                     
000951     05 DO60-XCODDIVIP PIC X.                                     
000952     05 DO60-XCODDIVIH PIC X.                                     
000953     05 DO60-XCODDIVIV PIC X.                                     
000954     05 DO60-XCODDIVIO      PIC X(2).                             
000955     05 FILLER    PIC X(2).                                       
000956     05 DO60-XSIGLADIA      PIC X.                                
000957     05 DO60-XSIGLADIC PIC X.                                     
000958     05 DO60-XSIGLADIP PIC X.                                     
000959     05 DO60-XSIGLADIH PIC X.                                     
000960     05 DO60-XSIGLADIV PIC X.                                     
000961     05 DO60-XSIGLADIO      PIC X(3).                             
000962     05 FILLER    PIC X(2).                                       
000963     05 DO60-MAPRPAGA  PIC X.                                     
000964     05 DO60-MAPRPAGC  PIC X.                                     
000965     05 DO60-MAPRPAGP  PIC X.                                     
000966     05 DO60-MAPRPAGH  PIC X.                                     
000967     05 DO60-MAPRPAGV  PIC X.                                     
000968     05 DO60-MAPRPAGO  PIC 9(4).                                  
000969     05 FILLER    PIC X(2).                                       
000970     05 DO60-MAPPPAGA  PIC X.                                     
000971     05 DO60-MAPPPAGC  PIC X.                                     
000972     05 DO60-MAPPPAGP  PIC X.                                     
000973     05 DO60-MAPPPAGH  PIC X.                                     
000974     05 DO60-MAPPPAGV  PIC X.                                     
000975     05 DO60-MAPPPAGO  PIC 9(4).                                  
000976     05 FILLER    PIC X(2).                                       
000977     05 DO60-MESSAGGA  PIC X.                                     
000978     05 DO60-MESSAGGC  PIC X.                                     
000979     05 DO60-MESSAGGP  PIC X.                                     
000980     05 DO60-MESSAGGH  PIC X.                                     
000981     05 DO60-MESSAGGV  PIC X.                                     
000982     05 DO60-MESSAGGO  PIC X(56).                                 
000983***************************************************************** 
000984* SDF: AVMLO60 AVFLO60                                            
000985***************************************************************** 
000986 01   AVFLO60I REDEFINES AVBLO60I.                                
000987     05 FILLER    PIC X(12).                                      
000988     05 FO60-MAPDATAL  COMP PIC S9(4).                            
000989     05 FO60-MAPDATAF  PIC X.                                     
000990     05 FILLER    PIC X(4).                                       
000991     05 FO60-MAPDATAI  PIC X(8).                                  
000992     05 FO60-MAPORAXL  COMP PIC S9(4).                            
000993     05 FO60-MAPORAXF  PIC X.                                     
000994     05 FILLER    PIC X(4).                                       
000995     05 FO60-MAPORAXI  PIC X(8).                                  
000996     05 FO60-CODCLIENL      COMP PIC S9(4).                       
000997     05 FO60-CODCLIENF      PIC X.                                
000998     05 FILLER    PIC X(4).                                       
000999     05 FO60-CODCLIENI      PIC X(5).                             
001000     05 FO60-RAGFATTUL      COMP PIC S9(4).                       
001001     05 FO60-RAGFATTUF      PIC X.                                
001002     05 FILLER    PIC X(4).                                       
001003     05 FO60-RAGFATTUI      PIC X(24).                            
001004     05 FO60-DTIPSERVL      COMP PIC S9(4).                       
001005     05 FO60-DTIPSERVF      PIC X.                                
001006     05 FILLER    PIC X(4).                                       
001007     05 FO60-DTIPSERVI      PIC X(11).                            
001008     05 FO60-FLAGULTIL      COMP PIC S9(4).                       
001009     05 FO60-FLAGULTIF      PIC X.                                
001010     05 FILLER    PIC X(4).                                       
001011     05 FO60-FLAGULTII      PIC X.                                
001012     05 FO60-DTINILISL      COMP PIC S9(4).                       
001013     05 FO60-DTINILISF      PIC X.                                
001014     05 FILLER    PIC X(4).                                       
001015     05 FO60-DTINILISI      PIC X(6).                             
001016     05 FO60-DTFINLISL      COMP PIC S9(4).                       
001017     05 FO60-DTFINLISF      PIC X.                                
001018     05 FILLER    PIC X(4).                                       
001019     05 FO60-DTFINLISI      PIC X(6).                             
001020     05 FO60-RIGAI OCCURS   18 TIMES .                            
001021       09 FO60-OPERAZIOL    COMP PIC S9(4).                       
001022       09 FO60-OPERAZIOF    PIC X.                                
001023       09 FILLER  PIC X(4).                                       
001024       09 FO60-OPERAZIOI    PIC X.                                
001025       09 FO60-RCODCLIEL    COMP PIC S9(4).                       
001026       09 FO60-RCODCLIEF    PIC X.                                
001027       09 FILLER  PIC X(4).                                       
001028       09 FO60-RCODCLIEI    PIC X(5).                             
001029       09 FO60-RRAGFATTL    COMP PIC S9(4).                       
001030       09 FO60-RRAGFATTF    PIC X.                                
001031       09 FILLER  PIC X(4).                                       
001032       09 FO60-RRAGFATTI    PIC X(24).                            
001033       09 FO60-RDTINILIL    COMP PIC S9(4).                       
001034       09 FO60-RDTINILIF    PIC X.                                
001035       09 FILLER  PIC X(4).                                       
001036       09 FO60-RDTINILII    PIC X(6).                             
001037       09 FO60-RDTFINLIL    COMP PIC S9(4).                       
001038       09 FO60-RDTFINLIF    PIC X.                                
001039       09 FILLER  PIC X(4).                                       
001040       09 FO60-RDTFINLII    PIC X(6).                             
001041       09 FO60-RCODDIVIL    COMP PIC S9(4).                       
001042       09 FO60-RCODDIVIF    PIC X.                                
001043       09 FILLER  PIC X(4).                                       
001044       09 FO60-RCODDIVII    PIC X(2).                             
001045       09 FO60-RSIGLADIL    COMP PIC S9(4).                       
001046       09 FO60-RSIGLADIF    PIC X.                                
001047       09 FILLER  PIC X(4).                                       
001048       09 FO60-RSIGLADII    PIC X(3).                             
001049     05 FO60-XCODCLIEL      COMP PIC S9(4).                       
001050     05 FO60-XCODCLIEF      PIC X.                                
001051     05 FILLER    PIC X(4).                                       
001052     05 FO60-XCODCLIEI      PIC X(5).                             
001053     05 FO60-XRAGFATTL      COMP PIC S9(4).                       
001054     05 FO60-XRAGFATTF      PIC X.                                
001055     05 FILLER    PIC X(4).                                       
001056     05 FO60-XRAGFATTI      PIC X(24).                            
001057     05 FO60-XDTINILIL      COMP PIC S9(4).                       
001058     05 FO60-XDTINILIF      PIC X.                                
001059     05 FILLER    PIC X(4).                                       
001060     05 FO60-XDTINILII      PIC X(6).                             
001061     05 FO60-XDTFINLIL      COMP PIC S9(4).                       
001062     05 FO60-XDTFINLIF      PIC X.                                
001063     05 FILLER    PIC X(4).                                       
001064     05 FO60-XDTFINLII      PIC X(6).                             
001065     05 FO60-XCODDIVIL      COMP PIC S9(4).                       
001066     05 FO60-XCODDIVIF      PIC X.                                
001067     05 FILLER    PIC X(4).                                       
001068     05 FO60-XCODDIVII      PIC X(2).                             
001069     05 FO60-XSIGLADIL      COMP PIC S9(4).                       
001070     05 FO60-XSIGLADIF      PIC X.                                
001071     05 FILLER    PIC X(4).                                       
001072     05 FO60-XSIGLADII      PIC X(3).                             
001073     05 FO60-MAPRPAGL  COMP PIC S9(4).                            
001074     05 FO60-MAPRPAGF  PIC X.                                     
001075     05 FILLER    PIC X(4).                                       
001076     05 FO60-MAPRPAGI  PIC X(4).                                  
001077     05 FO60-MAPPPAGL  COMP PIC S9(4).                            
001078     05 FO60-MAPPPAGF  PIC X.                                     
001079     05 FILLER    PIC X(4).                                       
001080     05 FO60-MAPPPAGI  PIC X(4).                                  
001081     05 FO60-MESSAGGL  COMP PIC S9(4).                            
001082     05 FO60-MESSAGGF  PIC X.                                     
001083     05 FILLER    PIC X(4).                                       
001084     05 FO60-MESSAGGI  PIC X(56).                                 
001085***************************************************************** 
001086* SDF: AVMLO60 AVFLO60                                            
001087***************************************************************** 
001088 01   AVFLO60O REDEFINES AVBLO60I.                                
001089     05 FILLER    PIC X(12).                                      
001090     05 FILLER    PIC X(2).                                       
001091     05 FO60-MAPDATAA  PIC X.                                     
001092     05 FO60-MAPDATAC  PIC X.                                     
001093     05 FO60-MAPDATAP  PIC X.                                     
001094     05 FO60-MAPDATAH  PIC X.                                     
001095     05 FO60-MAPDATAV  PIC X.                                     
001096     05 FO60-MAPDATAO  PIC X(8).                                  
001097     05 FILLER    PIC X(2).                                       
001098     05 FO60-MAPORAXA  PIC X.                                     
001099     05 FO60-MAPORAXC  PIC X.                                     
001100     05 FO60-MAPORAXP  PIC X.                                     
001101     05 FO60-MAPORAXH  PIC X.                                     
001102     05 FO60-MAPORAXV  PIC X.                                     
001103     05 FO60-MAPORAXO  PIC 99.99.99.                              
001104     05 FILLER    PIC X(2).                                       
001105     05 FO60-CODCLIENA      PIC X.                                
001106     05 FO60-CODCLIENC PIC X.                                     
001107     05 FO60-CODCLIENP PIC X.                                     
001108     05 FO60-CODCLIENH PIC X.                                     
001109     05 FO60-CODCLIENV PIC X.                                     
001110     05 FO60-CODCLIENO      PIC X(5).                             
001111     05 FILLER    PIC X(2).                                       
001112     05 FO60-RAGFATTUA      PIC X.                                
001113     05 FO60-RAGFATTUC PIC X.                                     
001114     05 FO60-RAGFATTUP PIC X.                                     
001115     05 FO60-RAGFATTUH PIC X.                                     
001116     05 FO60-RAGFATTUV PIC X.                                     
001117     05 FO60-RAGFATTUO      PIC X(24).                            
001118     05 FILLER    PIC X(2).                                       
001119     05 FO60-DTIPSERVA      PIC X.                                
001120     05 FO60-DTIPSERVC PIC X.                                     
001121     05 FO60-DTIPSERVP PIC X.                                     
001122     05 FO60-DTIPSERVH PIC X.                                     
001123     05 FO60-DTIPSERVV PIC X.                                     
001124     05 FO60-DTIPSERVO      PIC X(11).                            
001125     05 FILLER    PIC X(2).                                       
001126     05 FO60-FLAGULTIA      PIC X.                                
001127     05 FO60-FLAGULTIC PIC X.                                     
001128     05 FO60-FLAGULTIP PIC X.                                     
001129     05 FO60-FLAGULTIH PIC X.                                     
001130     05 FO60-FLAGULTIV PIC X.                                     
001131     05 FO60-FLAGULTIO      PIC X.                                
001132     05 FILLER    PIC X(2).                                       
001133     05 FO60-DTINILISA      PIC X.                                
001134     05 FO60-DTINILISC PIC X.                                     
001135     05 FO60-DTINILISP PIC X.                                     
001136     05 FO60-DTINILISH PIC X.                                     
001137     05 FO60-DTINILISV PIC X.                                     
001138     05 FO60-DTINILISO      PIC X(6).                             
001139     05 FILLER    PIC X(2).                                       
001140     05 FO60-DTFINLISA      PIC X.                                
001141     05 FO60-DTFINLISC PIC X.                                     
001142     05 FO60-DTFINLISP PIC X.                                     
001143     05 FO60-DTFINLISH PIC X.                                     
001144     05 FO60-DTFINLISV PIC X.                                     
001145     05 FO60-DTFINLISO      PIC X(6).                             
001146     05 FO60-RIGAO OCCURS   18 TIMES .                            
001147       09 FILLER       PIC X(2).                                  
001148       09 FO60-OPERAZIOA    PIC X.                                
001149       09 FO60-OPERAZIOC    PIC X.                                
001150       09 FO60-OPERAZIOP    PIC X.                                
001151       09 FO60-OPERAZIOH    PIC X.                                
001152       09 FO60-OPERAZIOV    PIC X.                                
001153       09 FO60-OPERAZIOO    PIC X.                                
001154       09 FILLER       PIC X(2).                                  
001155       09 FO60-RCODCLIEA    PIC X.                                
001156       09 FO60-RCODCLIEC    PIC X.                                
001157       09 FO60-RCODCLIEP    PIC X.                                
001158       09 FO60-RCODCLIEH    PIC X.                                
001159       09 FO60-RCODCLIEV    PIC X.                                
001160       09 FO60-RCODCLIEO    PIC X(5).                             
001161       09 FILLER       PIC X(2).                                  
001162       09 FO60-RRAGFATTA    PIC X.                                
001163       09 FO60-RRAGFATTC    PIC X.                                
001164       09 FO60-RRAGFATTP    PIC X.                                
001165       09 FO60-RRAGFATTH    PIC X.                                
001166       09 FO60-RRAGFATTV    PIC X.                                
001167       09 FO60-RRAGFATTO    PIC X(24).                            
001168       09 FILLER       PIC X(2).                                  
001169       09 FO60-RDTINILIA    PIC X.                                
001170       09 FO60-RDTINILIC    PIC X.                                
001171       09 FO60-RDTINILIP    PIC X.                                
001172       09 FO60-RDTINILIH    PIC X.                                
001173       09 FO60-RDTINILIV    PIC X.                                
001174       09 FO60-RDTINILIO    PIC X(6).                             
001175       09 FILLER       PIC X(2).                                  
001176       09 FO60-RDTFINLIA    PIC X.                                
001177       09 FO60-RDTFINLIC    PIC X.                                
001178       09 FO60-RDTFINLIP    PIC X.                                
001179       09 FO60-RDTFINLIH    PIC X.                                
001180       09 FO60-RDTFINLIV    PIC X.                                
001181       09 FO60-RDTFINLIO    PIC X(6).                             
001182       09 FILLER       PIC X(2).                                  
001183       09 FO60-RCODDIVIA    PIC X.                                
001184       09 FO60-RCODDIVIC    PIC X.                                
001185       09 FO60-RCODDIVIP    PIC X.                                
001186       09 FO60-RCODDIVIH    PIC X.                                
001187       09 FO60-RCODDIVIV    PIC X.                                
001188       09 FO60-RCODDIVIO    PIC X(2).                             
001189       09 FILLER       PIC X(2).                                  
001190       09 FO60-RSIGLADIA    PIC X.                                
001191       09 FO60-RSIGLADIC    PIC X.                                
001192       09 FO60-RSIGLADIP    PIC X.                                
001193       09 FO60-RSIGLADIH    PIC X.                                
001194       09 FO60-RSIGLADIV    PIC X.                                
001195       09 FO60-RSIGLADIO    PIC X(3).                             
001196     05 FILLER    PIC X(2).                                       
001197     05 FO60-XCODCLIEA      PIC X.                                
001198     05 FO60-XCODCLIEC PIC X.                                     
001199     05 FO60-XCODCLIEP PIC X.                                     
001200     05 FO60-XCODCLIEH PIC X.                                     
001201     05 FO60-XCODCLIEV PIC X.                                     
001202     05 FO60-XCODCLIEO      PIC X(5).                             
001203     05 FILLER    PIC X(2).                                       
001204     05 FO60-XRAGFATTA      PIC X.                                
001205     05 FO60-XRAGFATTC PIC X.                                     
001206     05 FO60-XRAGFATTP PIC X.                                     
001207     05 FO60-XRAGFATTH PIC X.                                     
001208     05 FO60-XRAGFATTV PIC X.                                     
001209     05 FO60-XRAGFATTO      PIC X(24).                            
001210     05 FILLER    PIC X(2).                                       
001211     05 FO60-XDTINILIA      PIC X.                                
001212     05 FO60-XDTINILIC PIC X.                                     
001213     05 FO60-XDTINILIP PIC X.                                     
001214     05 FO60-XDTINILIH PIC X.                                     
001215     05 FO60-XDTINILIV PIC X.                                     
001216     05 FO60-XDTINILIO      PIC X(6).                             
001217     05 FILLER    PIC X(2).                                       
001218     05 FO60-XDTFINLIA      PIC X.                                
001219     05 FO60-XDTFINLIC PIC X.                                     
001220     05 FO60-XDTFINLIP PIC X.                                     
001221     05 FO60-XDTFINLIH PIC X.                                     
001222     05 FO60-XDTFINLIV PIC X.                                     
001223     05 FO60-XDTFINLIO      PIC X(6).                             
001224     05 FILLER    PIC X(2).                                       
001225     05 FO60-XCODDIVIA      PIC X.                                
001226     05 FO60-XCODDIVIC PIC X.                                     
001227     05 FO60-XCODDIVIP PIC X.                                     
001228     05 FO60-XCODDIVIH PIC X.                                     
001229     05 FO60-XCODDIVIV PIC X.                                     
001230     05 FO60-XCODDIVIO      PIC X(2).                             
001231     05 FILLER    PIC X(2).                                       
001232     05 FO60-XSIGLADIA      PIC X.                                
001233     05 FO60-XSIGLADIC PIC X.                                     
001234     05 FO60-XSIGLADIP PIC X.                                     
001235     05 FO60-XSIGLADIH PIC X.                                     
001236     05 FO60-XSIGLADIV PIC X.                                     
001237     05 FO60-XSIGLADIO      PIC X(3).                             
001238     05 FILLER    PIC X(2).                                       
001239     05 FO60-MAPRPAGA  PIC X.                                     
001240     05 FO60-MAPRPAGC  PIC X.                                     
001241     05 FO60-MAPRPAGP  PIC X.                                     
001242     05 FO60-MAPRPAGH  PIC X.                                     
001243     05 FO60-MAPRPAGV  PIC X.                                     
001244     05 FO60-MAPRPAGO  PIC 9(4).                                  
001245     05 FILLER    PIC X(2).                                       
001246     05 FO60-MAPPPAGA  PIC X.                                     
001247     05 FO60-MAPPPAGC  PIC X.                                     
001248     05 FO60-MAPPPAGP  PIC X.                                     
001249     05 FO60-MAPPPAGH  PIC X.                                     
001250     05 FO60-MAPPPAGV  PIC X.                                     
001251     05 FO60-MAPPPAGO  PIC 9(4).                                  
001252     05 FILLER    PIC X(2).                                       
001253     05 FO60-MESSAGGA  PIC X.                                     
001254     05 FO60-MESSAGGC  PIC X.                                     
001255     05 FO60-MESSAGGP  PIC X.                                     
001256     05 FO60-MESSAGGH  PIC X.                                     
001257     05 FO60-MESSAGGV  PIC X.                                     
001258     05 FO60-MESSAGGO  PIC X(56).                                 
001259***************************************************************** 
001260* SDF: AVMLO60 AVILO60                                            
001261***************************************************************** 
001262 01   AVILO60I REDEFINES AVBLO60I.                                
001263     05 FILLER    PIC X(12).                                      
001264     05 LO60-MAPDATAL  COMP PIC S9(4).                            
001265     05 LO60-MAPDATAF  PIC X.                                     
001266     05 FILLER    PIC X(4).                                       
001267     05 LO60-MAPDATAI  PIC X(8).                                  
001268     05 LO60-MAPORAXL  COMP PIC S9(4).                            
001269     05 LO60-MAPORAXF  PIC X.                                     
001270     05 FILLER    PIC X(4).                                       
001271     05 LO60-MAPORAXI  PIC X(8).                                  
001272     05 LO60-CODCLIENL      COMP PIC S9(4).                       
001273     05 LO60-CODCLIENF      PIC X.                                
001274     05 FILLER    PIC X(4).                                       
001275     05 LO60-CODCLIENI      PIC X(5).                             
001276     05 LO60-RAGFATTUL      COMP PIC S9(4).                       
001277     05 LO60-RAGFATTUF      PIC X.                                
001278     05 FILLER    PIC X(4).                                       
001279     05 LO60-RAGFATTUI      PIC X(24).                            
001280     05 LO60-DTIPSERVL      COMP PIC S9(4).                       
001281     05 LO60-DTIPSERVF      PIC X.                                
001282     05 FILLER    PIC X(4).                                       
001283     05 LO60-DTIPSERVI      PIC X(11).                            
001284     05 LO60-FLAGULTIL      COMP PIC S9(4).                       
001285     05 LO60-FLAGULTIF      PIC X.                                
001286     05 FILLER    PIC X(4).                                       
001287     05 LO60-FLAGULTII      PIC X.                                
001288     05 LO60-DTINILISL      COMP PIC S9(4).                       
001289     05 LO60-DTINILISF      PIC X.                                
001290     05 FILLER    PIC X(4).                                       
001291     05 LO60-DTINILISI      PIC X(6).                             
001292     05 LO60-DTFINLISL      COMP PIC S9(4).                       
001293     05 LO60-DTFINLISF      PIC X.                                
001294     05 FILLER    PIC X(4).                                       
001295     05 LO60-DTFINLISI      PIC X(6).                             
001296     05 LO60-RIGAI OCCURS   18 TIMES .                            
001297       09 LO60-OPERAZIOL    COMP PIC S9(4).                       
001298       09 LO60-OPERAZIOF    PIC X.                                
001299       09 FILLER  PIC X(4).                                       
001300       09 LO60-OPERAZIOI    PIC X.                                
001301       09 LO60-RCODCLIEL    COMP PIC S9(4).                       
001302       09 LO60-RCODCLIEF    PIC X.                                
001303       09 FILLER  PIC X(4).                                       
001304       09 LO60-RCODCLIEI    PIC X(5).                             
001305       09 LO60-RRAGFATTL    COMP PIC S9(4).                       
001306       09 LO60-RRAGFATTF    PIC X.                                
001307       09 FILLER  PIC X(4).                                       
001308       09 LO60-RRAGFATTI    PIC X(24).                            
001309       09 LO60-RDTINILIL    COMP PIC S9(4).                       
001310       09 LO60-RDTINILIF    PIC X.                                
001311       09 FILLER  PIC X(4).                                       
001312       09 LO60-RDTINILII    PIC X(6).                             
001313       09 LO60-RDTFINLIL    COMP PIC S9(4).                       
001314       09 LO60-RDTFINLIF    PIC X.                                
001315       09 FILLER  PIC X(4).                                       
001316       09 LO60-RDTFINLII    PIC X(6).                             
001317       09 LO60-RCODDIVIL    COMP PIC S9(4).                       
001318       09 LO60-RCODDIVIF    PIC X.                                
001319       09 FILLER  PIC X(4).                                       
001320       09 LO60-RCODDIVII    PIC X(2).                             
001321       09 LO60-RSIGLADIL    COMP PIC S9(4).                       
001322       09 LO60-RSIGLADIF    PIC X.                                
001323       09 FILLER  PIC X(4).                                       
001324       09 LO60-RSIGLADII    PIC X(3).                             
001325     05 LO60-XCODCLIEL      COMP PIC S9(4).                       
001326     05 LO60-XCODCLIEF      PIC X.                                
001327     05 FILLER    PIC X(4).                                       
001328     05 LO60-XCODCLIEI      PIC X(5).                             
001329     05 LO60-XRAGFATTL      COMP PIC S9(4).                       
001330     05 LO60-XRAGFATTF      PIC X.                                
001331     05 FILLER    PIC X(4).                                       
001332     05 LO60-XRAGFATTI      PIC X(24).                            
001333     05 LO60-XDTINILIL      COMP PIC S9(4).                       
001334     05 LO60-XDTINILIF      PIC X.                                
001335     05 FILLER    PIC X(4).                                       
001336     05 LO60-XDTINILII      PIC X(6).                             
001337     05 LO60-XDTFINLIL      COMP PIC S9(4).                       
001338     05 LO60-XDTFINLIF      PIC X.                                
001339     05 FILLER    PIC X(4).                                       
001340     05 LO60-XDTFINLII      PIC X(6).                             
001341     05 LO60-XCODDIVIL      COMP PIC S9(4).                       
001342     05 LO60-XCODDIVIF      PIC X.                                
001343     05 FILLER    PIC X(4).                                       
001344     05 LO60-XCODDIVII      PIC X(2).                             
001345     05 LO60-XSIGLADIL      COMP PIC S9(4).                       
001346     05 LO60-XSIGLADIF      PIC X.                                
001347     05 FILLER    PIC X(4).                                       
001348     05 LO60-XSIGLADII      PIC X(3).                             
001349     05 LO60-MAPRPAGL  COMP PIC S9(4).                            
001350     05 LO60-MAPRPAGF  PIC X.                                     
001351     05 FILLER    PIC X(4).                                       
001352     05 LO60-MAPRPAGI  PIC X(4).                                  
001353     05 LO60-MAPPPAGL  COMP PIC S9(4).                            
001354     05 LO60-MAPPPAGF  PIC X.                                     
001355     05 FILLER    PIC X(4).                                       
001356     05 LO60-MAPPPAGI  PIC X(4).                                  
001357     05 LO60-MESSAGGL  COMP PIC S9(4).                            
001358     05 LO60-MESSAGGF  PIC X.                                     
001359     05 FILLER    PIC X(4).                                       
001360     05 LO60-MESSAGGI  PIC X(56).                                 
001361***************************************************************** 
001362* SDF: AVMLO60 AVILO60                                            
001363***************************************************************** 
001364 01   AVILO60O REDEFINES AVBLO60I.                                
001365     05 FILLER    PIC X(12).                                      
001366     05 FILLER    PIC X(2).                                       
001367     05 LO60-MAPDATAA  PIC X.                                     
001368     05 LO60-MAPDATAC  PIC X.                                     
001369     05 LO60-MAPDATAP  PIC X.                                     
001370     05 LO60-MAPDATAH  PIC X.                                     
001371     05 LO60-MAPDATAV  PIC X.                                     
001372     05 LO60-MAPDATAO  PIC X(8).                                  
001373     05 FILLER    PIC X(2).                                       
001374     05 LO60-MAPORAXA  PIC X.                                     
001375     05 LO60-MAPORAXC  PIC X.                                     
001376     05 LO60-MAPORAXP  PIC X.                                     
001377     05 LO60-MAPORAXH  PIC X.                                     
001378     05 LO60-MAPORAXV  PIC X.                                     
001379     05 LO60-MAPORAXO  PIC 99.99.99.                              
001380     05 FILLER    PIC X(2).                                       
001381     05 LO60-CODCLIENA      PIC X.                                
001382     05 LO60-CODCLIENC PIC X.                                     
001383     05 LO60-CODCLIENP PIC X.                                     
001384     05 LO60-CODCLIENH PIC X.                                     
001385     05 LO60-CODCLIENV PIC X.                                     
001386     05 LO60-CODCLIENO      PIC X(5).                             
001387     05 FILLER    PIC X(2).                                       
001388     05 LO60-RAGFATTUA      PIC X.                                
001389     05 LO60-RAGFATTUC PIC X.                                     
001390     05 LO60-RAGFATTUP PIC X.                                     
001391     05 LO60-RAGFATTUH PIC X.                                     
001392     05 LO60-RAGFATTUV PIC X.                                     
001393     05 LO60-RAGFATTUO      PIC X(24).                            
001394     05 FILLER    PIC X(2).                                       
001395     05 LO60-DTIPSERVA      PIC X.                                
001396     05 LO60-DTIPSERVC PIC X.                                     
001397     05 LO60-DTIPSERVP PIC X.                                     
001398     05 LO60-DTIPSERVH PIC X.                                     
001399     05 LO60-DTIPSERVV PIC X.                                     
001400     05 LO60-DTIPSERVO      PIC X(11).                            
001401     05 FILLER    PIC X(2).                                       
001402     05 LO60-FLAGULTIA      PIC X.                                
001403     05 LO60-FLAGULTIC PIC X.                                     
001404     05 LO60-FLAGULTIP PIC X.                                     
001405     05 LO60-FLAGULTIH PIC X.                                     
001406     05 LO60-FLAGULTIV PIC X.                                     
001407     05 LO60-FLAGULTIO      PIC X.                                
001408     05 FILLER    PIC X(2).                                       
001409     05 LO60-DTINILISA      PIC X.                                
001410     05 LO60-DTINILISC PIC X.                                     
001411     05 LO60-DTINILISP PIC X.                                     
001412     05 LO60-DTINILISH PIC X.                                     
001413     05 LO60-DTINILISV PIC X.                                     
001414     05 LO60-DTINILISO      PIC X(6).                             
001415     05 FILLER    PIC X(2).                                       
001416     05 LO60-DTFINLISA      PIC X.                                
001417     05 LO60-DTFINLISC PIC X.                                     
001418     05 LO60-DTFINLISP PIC X.                                     
001419     05 LO60-DTFINLISH PIC X.                                     
001420     05 LO60-DTFINLISV PIC X.                                     
001421     05 LO60-DTFINLISO      PIC X(6).                             
001422     05 LO60-RIGAO OCCURS   18 TIMES .                            
001423       09 FILLER       PIC X(2).                                  
001424       09 LO60-OPERAZIOA    PIC X.                                
001425       09 LO60-OPERAZIOC    PIC X.                                
001426       09 LO60-OPERAZIOP    PIC X.                                
001427       09 LO60-OPERAZIOH    PIC X.                                
001428       09 LO60-OPERAZIOV    PIC X.                                
001429       09 LO60-OPERAZIOO    PIC X.                                
001430       09 FILLER       PIC X(2).                                  
001431       09 LO60-RCODCLIEA    PIC X.                                
001432       09 LO60-RCODCLIEC    PIC X.                                
001433       09 LO60-RCODCLIEP    PIC X.                                
001434       09 LO60-RCODCLIEH    PIC X.                                
001435       09 LO60-RCODCLIEV    PIC X.                                
001436       09 LO60-RCODCLIEO    PIC X(5).                             
001437       09 FILLER       PIC X(2).                                  
001438       09 LO60-RRAGFATTA    PIC X.                                
001439       09 LO60-RRAGFATTC    PIC X.                                
001440       09 LO60-RRAGFATTP    PIC X.                                
001441       09 LO60-RRAGFATTH    PIC X.                                
001442       09 LO60-RRAGFATTV    PIC X.                                
001443       09 LO60-RRAGFATTO    PIC X(24).                            
001444       09 FILLER       PIC X(2).                                  
001445       09 LO60-RDTINILIA    PIC X.                                
001446       09 LO60-RDTINILIC    PIC X.                                
001447       09 LO60-RDTINILIP    PIC X.                                
001448       09 LO60-RDTINILIH    PIC X.                                
001449       09 LO60-RDTINILIV    PIC X.                                
001450       09 LO60-RDTINILIO    PIC X(6).                             
001451       09 FILLER       PIC X(2).                                  
001452       09 LO60-RDTFINLIA    PIC X.                                
001453       09 LO60-RDTFINLIC    PIC X.                                
001454       09 LO60-RDTFINLIP    PIC X.                                
001455       09 LO60-RDTFINLIH    PIC X.                                
001456       09 LO60-RDTFINLIV    PIC X.                                
001457       09 LO60-RDTFINLIO    PIC X(6).                             
001458       09 FILLER       PIC X(2).                                  
001459       09 LO60-RCODDIVIA    PIC X.                                
001460       09 LO60-RCODDIVIC    PIC X.                                
001461       09 LO60-RCODDIVIP    PIC X.                                
001462       09 LO60-RCODDIVIH    PIC X.                                
001463       09 LO60-RCODDIVIV    PIC X.                                
001464       09 LO60-RCODDIVIO    PIC X(2).                             
001465       09 FILLER       PIC X(2).                                  
001466       09 LO60-RSIGLADIA    PIC X.                                
001467       09 LO60-RSIGLADIC    PIC X.                                
001468       09 LO60-RSIGLADIP    PIC X.                                
001469       09 LO60-RSIGLADIH    PIC X.                                
001470       09 LO60-RSIGLADIV    PIC X.                                
001471       09 LO60-RSIGLADIO    PIC X(3).                             
001472     05 FILLER    PIC X(2).                                       
001473     05 LO60-XCODCLIEA      PIC X.                                
001474     05 LO60-XCODCLIEC PIC X.                                     
001475     05 LO60-XCODCLIEP PIC X.                                     
001476     05 LO60-XCODCLIEH PIC X.                                     
001477     05 LO60-XCODCLIEV PIC X.                                     
001478     05 LO60-XCODCLIEO      PIC X(5).                             
001479     05 FILLER    PIC X(2).                                       
001480     05 LO60-XRAGFATTA      PIC X.                                
001481     05 LO60-XRAGFATTC PIC X.                                     
001482     05 LO60-XRAGFATTP PIC X.                                     
001483     05 LO60-XRAGFATTH PIC X.                                     
001484     05 LO60-XRAGFATTV PIC X.                                     
001485     05 LO60-XRAGFATTO      PIC X(24).                            
001486     05 FILLER    PIC X(2).                                       
001487     05 LO60-XDTINILIA      PIC X.                                
001488     05 LO60-XDTINILIC PIC X.                                     
001489     05 LO60-XDTINILIP PIC X.                                     
001490     05 LO60-XDTINILIH PIC X.                                     
001491     05 LO60-XDTINILIV PIC X.                                     
001492     05 LO60-XDTINILIO      PIC X(6).                             
001493     05 FILLER    PIC X(2).                                       
001494     05 LO60-XDTFINLIA      PIC X.                                
001495     05 LO60-XDTFINLIC PIC X.                                     
001496     05 LO60-XDTFINLIP PIC X.                                     
001497     05 LO60-XDTFINLIH PIC X.                                     
001498     05 LO60-XDTFINLIV PIC X.                                     
001499     05 LO60-XDTFINLIO      PIC X(6).                             
001500     05 FILLER    PIC X(2).                                       
001501     05 LO60-XCODDIVIA      PIC X.                                
001502     05 LO60-XCODDIVIC PIC X.                                     
001503     05 LO60-XCODDIVIP PIC X.                                     
001504     05 LO60-XCODDIVIH PIC X.                                     
001505     05 LO60-XCODDIVIV PIC X.                                     
001506     05 LO60-XCODDIVIO      PIC X(2).                             
001507     05 FILLER    PIC X(2).                                       
001508     05 LO60-XSIGLADIA      PIC X.                                
001509     05 LO60-XSIGLADIC PIC X.                                     
001510     05 LO60-XSIGLADIP PIC X.                                     
001511     05 LO60-XSIGLADIH PIC X.                                     
001512     05 LO60-XSIGLADIV PIC X.                                     
001513     05 LO60-XSIGLADIO      PIC X(3).                             
001514     05 FILLER    PIC X(2).                                       
001515     05 LO60-MAPRPAGA  PIC X.                                     
001516     05 LO60-MAPRPAGC  PIC X.                                     
001517     05 LO60-MAPRPAGP  PIC X.                                     
001518     05 LO60-MAPRPAGH  PIC X.                                     
001519     05 LO60-MAPRPAGV  PIC X.                                     
001520     05 LO60-MAPRPAGO  PIC 9(4).                                  
001521     05 FILLER    PIC X(2).                                       
001522     05 LO60-MAPPPAGA  PIC X.                                     
001523     05 LO60-MAPPPAGC  PIC X.                                     
001524     05 LO60-MAPPPAGP  PIC X.                                     
001525     05 LO60-MAPPPAGH  PIC X.                                     
001526     05 LO60-MAPPPAGV  PIC X.                                     
001527     05 LO60-MAPPPAGO  PIC 9(4).                                  
001528     05 FILLER    PIC X(2).                                       
001529     05 LO60-MESSAGGA  PIC X.                                     
001530     05 LO60-MESSAGGC  PIC X.                                     
001531     05 LO60-MESSAGGP  PIC X.                                     
001532     05 LO60-MESSAGGH  PIC X.                                     
001533     05 LO60-MESSAGGV  PIC X.                                     
001534     05 LO60-MESSAGGO  PIC X(56).                                 
001535***************************************************************** 
001536* SDF: AVMLO60 AVJLO60                                            
001537***************************************************************** 
001538 01   AVJLO60I REDEFINES AVBLO60I.                                
001539     05 FILLER    PIC X(12).                                      
001540     05 JO60-MAPDATAL  COMP PIC S9(4).                            
001541     05 JO60-MAPDATAF  PIC X.                                     
001542     05 FILLER    PIC X(4).                                       
001543     05 JO60-MAPDATAI  PIC X(8).                                  
001544     05 JO60-MAPORAXL  COMP PIC S9(4).                            
001545     05 JO60-MAPORAXF  PIC X.                                     
001546     05 FILLER    PIC X(4).                                       
001547     05 JO60-MAPORAXI  PIC X(8).                                  
001548     05 JO60-CODCLIENL      COMP PIC S9(4).                       
001549     05 JO60-CODCLIENF      PIC X.                                
001550     05 FILLER    PIC X(4).                                       
001551     05 JO60-CODCLIENI      PIC X(5).                             
001552     05 JO60-RAGFATTUL      COMP PIC S9(4).                       
001553     05 JO60-RAGFATTUF      PIC X.                                
001554     05 FILLER    PIC X(4).                                       
001555     05 JO60-RAGFATTUI      PIC X(24).                            
001556     05 JO60-DTIPSERVL      COMP PIC S9(4).                       
001557     05 JO60-DTIPSERVF      PIC X.                                
001558     05 FILLER    PIC X(4).                                       
001559     05 JO60-DTIPSERVI      PIC X(11).                            
001560     05 JO60-FLAGULTIL      COMP PIC S9(4).                       
001561     05 JO60-FLAGULTIF      PIC X.                                
001562     05 FILLER    PIC X(4).                                       
001563     05 JO60-FLAGULTII      PIC X.                                
001564     05 JO60-DTINILISL      COMP PIC S9(4).                       
001565     05 JO60-DTINILISF      PIC X.                                
001566     05 FILLER    PIC X(4).                                       
001567     05 JO60-DTINILISI      PIC X(6).                             
001568     05 JO60-DTFINLISL      COMP PIC S9(4).                       
001569     05 JO60-DTFINLISF      PIC X.                                
001570     05 FILLER    PIC X(4).                                       
001571     05 JO60-DTFINLISI      PIC X(6).                             
001572     05 JO60-RIGAI OCCURS   18 TIMES .                            
001573       09 JO60-OPERAZIOL    COMP PIC S9(4).                       
001574       09 JO60-OPERAZIOF    PIC X.                                
001575       09 FILLER  PIC X(4).                                       
001576       09 JO60-OPERAZIOI    PIC X.                                
001577       09 JO60-RCODCLIEL    COMP PIC S9(4).                       
001578       09 JO60-RCODCLIEF    PIC X.                                
001579       09 FILLER  PIC X(4).                                       
001580       09 JO60-RCODCLIEI    PIC X(5).                             
001581       09 JO60-RRAGFATTL    COMP PIC S9(4).                       
001582       09 JO60-RRAGFATTF    PIC X.                                
001583       09 FILLER  PIC X(4).                                       
001584       09 JO60-RRAGFATTI    PIC X(24).                            
001585       09 JO60-RDTINILIL    COMP PIC S9(4).                       
001586       09 JO60-RDTINILIF    PIC X.                                
001587       09 FILLER  PIC X(4).                                       
001588       09 JO60-RDTINILII    PIC X(6).                             
001589       09 JO60-RDTFINLIL    COMP PIC S9(4).                       
001590       09 JO60-RDTFINLIF    PIC X.                                
001591       09 FILLER  PIC X(4).                                       
001592       09 JO60-RDTFINLII    PIC X(6).                             
001593       09 JO60-RCODDIVIL    COMP PIC S9(4).                       
001594       09 JO60-RCODDIVIF    PIC X.                                
001595       09 FILLER  PIC X(4).                                       
001596       09 JO60-RCODDIVII    PIC X(2).                             
001597       09 JO60-RSIGLADIL    COMP PIC S9(4).                       
001598       09 JO60-RSIGLADIF    PIC X.                                
001599       09 FILLER  PIC X(4).                                       
001600       09 JO60-RSIGLADII    PIC X(3).                             
001601     05 JO60-XCODCLIEL      COMP PIC S9(4).                       
001602     05 JO60-XCODCLIEF      PIC X.                                
001603     05 FILLER    PIC X(4).                                       
001604     05 JO60-XCODCLIEI      PIC X(5).                             
001605     05 JO60-XRAGFATTL      COMP PIC S9(4).                       
001606     05 JO60-XRAGFATTF      PIC X.                                
001607     05 FILLER    PIC X(4).                                       
001608     05 JO60-XRAGFATTI      PIC X(24).                            
001609     05 JO60-XDTINILIL      COMP PIC S9(4).                       
001610     05 JO60-XDTINILIF      PIC X.                                
001611     05 FILLER    PIC X(4).                                       
001612     05 JO60-XDTINILII      PIC X(6).                             
001613     05 JO60-XDTFINLIL      COMP PIC S9(4).                       
001614     05 JO60-XDTFINLIF      PIC X.                                
001615     05 FILLER    PIC X(4).                                       
001616     05 JO60-XDTFINLII      PIC X(6).                             
001617     05 JO60-XCODDIVIL      COMP PIC S9(4).                       
001618     05 JO60-XCODDIVIF      PIC X.                                
001619     05 FILLER    PIC X(4).                                       
001620     05 JO60-XCODDIVII      PIC X(2).                             
001621     05 JO60-XSIGLADIL      COMP PIC S9(4).                       
001622     05 JO60-XSIGLADIF      PIC X.                                
001623     05 FILLER    PIC X(4).                                       
001624     05 JO60-XSIGLADII      PIC X(3).                             
001625     05 JO60-MAPRPAGL  COMP PIC S9(4).                            
001626     05 JO60-MAPRPAGF  PIC X.                                     
001627     05 FILLER    PIC X(4).                                       
001628     05 JO60-MAPRPAGI  PIC X(4).                                  
001629     05 JO60-MAPPPAGL  COMP PIC S9(4).                            
001630     05 JO60-MAPPPAGF  PIC X.                                     
001631     05 FILLER    PIC X(4).                                       
001632     05 JO60-MAPPPAGI  PIC X(4).                                  
001633     05 JO60-MESSAGGL  COMP PIC S9(4).                            
001634     05 JO60-MESSAGGF  PIC X.                                     
001635     05 FILLER    PIC X(4).                                       
001636     05 JO60-MESSAGGI  PIC X(56).                                 
001637***************************************************************** 
001638* SDF: AVMLO60 AVJLO60                                            
001639***************************************************************** 
001640 01   AVJLO60O REDEFINES AVBLO60I.                                
001641     05 FILLER    PIC X(12).                                      
001642     05 FILLER    PIC X(2).                                       
001643     05 JO60-MAPDATAA  PIC X.                                     
001644     05 JO60-MAPDATAC  PIC X.                                     
001645     05 JO60-MAPDATAP  PIC X.                                     
001646     05 JO60-MAPDATAH  PIC X.                                     
001647     05 JO60-MAPDATAV  PIC X.                                     
001648     05 JO60-MAPDATAO  PIC X(8).                                  
001649     05 FILLER    PIC X(2).                                       
001650     05 JO60-MAPORAXA  PIC X.                                     
001651     05 JO60-MAPORAXC  PIC X.                                     
001652     05 JO60-MAPORAXP  PIC X.                                     
001653     05 JO60-MAPORAXH  PIC X.                                     
001654     05 JO60-MAPORAXV  PIC X.                                     
001655     05 JO60-MAPORAXO  PIC 99.99.99.                              
001656     05 FILLER    PIC X(2).                                       
001657     05 JO60-CODCLIENA      PIC X.                                
001658     05 JO60-CODCLIENC PIC X.                                     
001659     05 JO60-CODCLIENP PIC X.                                     
001660     05 JO60-CODCLIENH PIC X.                                     
001661     05 JO60-CODCLIENV PIC X.                                     
001662     05 JO60-CODCLIENO      PIC X(5).                             
001663     05 FILLER    PIC X(2).                                       
001664     05 JO60-RAGFATTUA      PIC X.                                
001665     05 JO60-RAGFATTUC PIC X.                                     
001666     05 JO60-RAGFATTUP PIC X.                                     
001667     05 JO60-RAGFATTUH PIC X.                                     
001668     05 JO60-RAGFATTUV PIC X.                                     
001669     05 JO60-RAGFATTUO      PIC X(24).                            
001670     05 FILLER    PIC X(2).                                       
001671     05 JO60-DTIPSERVA      PIC X.                                
001672     05 JO60-DTIPSERVC PIC X.                                     
001673     05 JO60-DTIPSERVP PIC X.                                     
001674     05 JO60-DTIPSERVH PIC X.                                     
001675     05 JO60-DTIPSERVV PIC X.                                     
001676     05 JO60-DTIPSERVO      PIC X(11).                            
001677     05 FILLER    PIC X(2).                                       
001678     05 JO60-FLAGULTIA      PIC X.                                
001679     05 JO60-FLAGULTIC PIC X.                                     
001680     05 JO60-FLAGULTIP PIC X.                                     
001681     05 JO60-FLAGULTIH PIC X.                                     
001682     05 JO60-FLAGULTIV PIC X.                                     
001683     05 JO60-FLAGULTIO      PIC X.                                
001684     05 FILLER    PIC X(2).                                       
001685     05 JO60-DTINILISA      PIC X.                                
001686     05 JO60-DTINILISC PIC X.                                     
001687     05 JO60-DTINILISP PIC X.                                     
001688     05 JO60-DTINILISH PIC X.                                     
001689     05 JO60-DTINILISV PIC X.                                     
001690     05 JO60-DTINILISO      PIC X(6).                             
001691     05 FILLER    PIC X(2).                                       
001692     05 JO60-DTFINLISA      PIC X.                                
001693     05 JO60-DTFINLISC PIC X.                                     
001694     05 JO60-DTFINLISP PIC X.                                     
001695     05 JO60-DTFINLISH PIC X.                                     
001696     05 JO60-DTFINLISV PIC X.                                     
001697     05 JO60-DTFINLISO      PIC X(6).                             
001698     05 JO60-RIGAO OCCURS   18 TIMES .                            
001699       09 FILLER       PIC X(2).                                  
001700       09 JO60-OPERAZIOA    PIC X.                                
001701       09 JO60-OPERAZIOC    PIC X.                                
001702       09 JO60-OPERAZIOP    PIC X.                                
001703       09 JO60-OPERAZIOH    PIC X.                                
001704       09 JO60-OPERAZIOV    PIC X.                                
001705       09 JO60-OPERAZIOO    PIC X.                                
001706       09 FILLER       PIC X(2).                                  
001707       09 JO60-RCODCLIEA    PIC X.                                
001708       09 JO60-RCODCLIEC    PIC X.                                
001709       09 JO60-RCODCLIEP    PIC X.                                
001710       09 JO60-RCODCLIEH    PIC X.                                
001711       09 JO60-RCODCLIEV    PIC X.                                
001712       09 JO60-RCODCLIEO    PIC X(5).                             
001713       09 FILLER       PIC X(2).                                  
001714       09 JO60-RRAGFATTA    PIC X.                                
001715       09 JO60-RRAGFATTC    PIC X.                                
001716       09 JO60-RRAGFATTP    PIC X.                                
001717       09 JO60-RRAGFATTH    PIC X.                                
001718       09 JO60-RRAGFATTV    PIC X.                                
001719       09 JO60-RRAGFATTO    PIC X(24).                            
001720       09 FILLER       PIC X(2).                                  
001721       09 JO60-RDTINILIA    PIC X.                                
001722       09 JO60-RDTINILIC    PIC X.                                
001723       09 JO60-RDTINILIP    PIC X.                                
001724       09 JO60-RDTINILIH    PIC X.                                
001725       09 JO60-RDTINILIV    PIC X.                                
001726       09 JO60-RDTINILIO    PIC X(6).                             
001727       09 FILLER       PIC X(2).                                  
001728       09 JO60-RDTFINLIA    PIC X.                                
001729       09 JO60-RDTFINLIC    PIC X.                                
001730       09 JO60-RDTFINLIP    PIC X.                                
001731       09 JO60-RDTFINLIH    PIC X.                                
001732       09 JO60-RDTFINLIV    PIC X.                                
001733       09 JO60-RDTFINLIO    PIC X(6).                             
001734       09 FILLER       PIC X(2).                                  
001735       09 JO60-RCODDIVIA    PIC X.                                
001736       09 JO60-RCODDIVIC    PIC X.                                
001737       09 JO60-RCODDIVIP    PIC X.                                
001738       09 JO60-RCODDIVIH    PIC X.                                
001739       09 JO60-RCODDIVIV    PIC X.                                
001740       09 JO60-RCODDIVIO    PIC X(2).                             
001741       09 FILLER       PIC X(2).                                  
001742       09 JO60-RSIGLADIA    PIC X.                                
001743       09 JO60-RSIGLADIC    PIC X.                                
001744       09 JO60-RSIGLADIP    PIC X.                                
001745       09 JO60-RSIGLADIH    PIC X.                                
001746       09 JO60-RSIGLADIV    PIC X.                                
001747       09 JO60-RSIGLADIO    PIC X(3).                             
001748     05 FILLER    PIC X(2).                                       
001749     05 JO60-XCODCLIEA      PIC X.                                
001750     05 JO60-XCODCLIEC PIC X.                                     
001751     05 JO60-XCODCLIEP PIC X.                                     
001752     05 JO60-XCODCLIEH PIC X.                                     
001753     05 JO60-XCODCLIEV PIC X.                                     
001754     05 JO60-XCODCLIEO      PIC X(5).                             
001755     05 FILLER    PIC X(2).                                       
001756     05 JO60-XRAGFATTA      PIC X.                                
001757     05 JO60-XRAGFATTC PIC X.                                     
001758     05 JO60-XRAGFATTP PIC X.                                     
001759     05 JO60-XRAGFATTH PIC X.                                     
001760     05 JO60-XRAGFATTV PIC X.                                     
001761     05 JO60-XRAGFATTO      PIC X(24).                            
001762     05 FILLER    PIC X(2).                                       
001763     05 JO60-XDTINILIA      PIC X.                                
001764     05 JO60-XDTINILIC PIC X.                                     
001765     05 JO60-XDTINILIP PIC X.                                     
001766     05 JO60-XDTINILIH PIC X.                                     
001767     05 JO60-XDTINILIV PIC X.                                     
001768     05 JO60-XDTINILIO      PIC X(6).                             
001769     05 FILLER    PIC X(2).                                       
001770     05 JO60-XDTFINLIA      PIC X.                                
001771     05 JO60-XDTFINLIC PIC X.                                     
001772     05 JO60-XDTFINLIP PIC X.                                     
001773     05 JO60-XDTFINLIH PIC X.                                     
001774     05 JO60-XDTFINLIV PIC X.                                     
001775     05 JO60-XDTFINLIO      PIC X(6).                             
001776     05 FILLER    PIC X(2).                                       
001777     05 JO60-XCODDIVIA      PIC X.                                
001778     05 JO60-XCODDIVIC PIC X.                                     
001779     05 JO60-XCODDIVIP PIC X.                                     
001780     05 JO60-XCODDIVIH PIC X.                                     
001781     05 JO60-XCODDIVIV PIC X.                                     
001782     05 JO60-XCODDIVIO      PIC X(2).                             
001783     05 FILLER    PIC X(2).                                       
001784     05 JO60-XSIGLADIA      PIC X.                                
001785     05 JO60-XSIGLADIC PIC X.                                     
001786     05 JO60-XSIGLADIP PIC X.                                     
001787     05 JO60-XSIGLADIH PIC X.                                     
001788     05 JO60-XSIGLADIV PIC X.                                     
001789     05 JO60-XSIGLADIO      PIC X(3).                             
001790     05 FILLER    PIC X(2).                                       
001791     05 JO60-MAPRPAGA  PIC X.                                     
001792     05 JO60-MAPRPAGC  PIC X.                                     
001793     05 JO60-MAPRPAGP  PIC X.                                     
001794     05 JO60-MAPRPAGH  PIC X.                                     
001795     05 JO60-MAPRPAGV  PIC X.                                     
001796     05 JO60-MAPRPAGO  PIC 9(4).                                  
001797     05 FILLER    PIC X(2).                                       
001798     05 JO60-MAPPPAGA  PIC X.                                     
001799     05 JO60-MAPPPAGC  PIC X.                                     
001800     05 JO60-MAPPPAGP  PIC X.                                     
001801     05 JO60-MAPPPAGH  PIC X.                                     
001802     05 JO60-MAPPPAGV  PIC X.                                     
001803     05 JO60-MAPPPAGO  PIC 9(4).                                  
001804     05 FILLER    PIC X(2).                                       
001805     05 JO60-MESSAGGA  PIC X.                                     
001806     05 JO60-MESSAGGC  PIC X.                                     
001807     05 JO60-MESSAGGP  PIC X.                                     
001808     05 JO60-MESSAGGH  PIC X.                                     
001809     05 JO60-MESSAGGV  PIC X.                                     
001810     05 JO60-MESSAGGO  PIC X(56).                                 
001811 01  FILLER                      PIC X(08) VALUE 'DCWTSTR0'.      
001812*    COPY DCWTSTR0.                                               
001813*------------------------------------- -------------------------* 
001814*                    --- DCWTSTR0 ---                           * 
001815*              DSECT PER SALVATAGGIO COMMAREA.                  * 
001816*---------------------------------------------------------------* 
001817 01  DCWTSTR0.                                                    
001818     05  TSTR-LENGCODA               PIC S9(4)  COMP VALUE +4096. 
001819     05  TSTR-ITEMXXXX               PIC S9(4)  COMP VALUE +0.    
001820     05  TSTR-NOMECODA.                                           
001821         10  TSTR-NOMETRAN           PIC X(4)   VALUE SPACES.     
001822         10  TSTR-NOMETERM           PIC X(4)   VALUE SPACES.     
001823     05  TSTR-AREATSTR               PIC X(4096) VALUE SPACES.    
001824*---------------------------------------------------------------* 
001825*--------------------------------DLOGISTI.TORDILOGI               
001826 01  FILLER                      PIC X(8) VALUE 'FDLOG652'.       
001827*    EXEC SQL INCLUDE FDLOG652 END-EXEC.                          
      *>>((file: FDLOG652))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TORDILOGI                 *
000003******************************************************************
000004 01  DCLTORDILOGI.                                                
000005*                       AANUMORD                                  
000006     10 L652-AANUMORD        PIC X(8).                            
000007*                       CODCLIEN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000008     10 L652-CODCLIEN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000009*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000010     10 L652-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000011*                       CDDIVISI                                  
000012     10 L652-CDDIVISI        PIC X(1).                            
000013*                       DTCARORD                                  
000014     10 L652-DTCARORD        PIC X(8).                            
000015*                       CODDIVIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000016     10 L652-CODDIVIS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000017*                       TIPSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000018     10 L652-TIPSERVI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000019*                       FLAGAUTO                                  
000020     10 L652-FLAGAUTO        PIC X(1).                            
000021*                       FLAGGIVA                                  
000022     10 L652-FLAGGIVA        PIC X(1).                            
000023*                       CONTODCE                                  
000024     10 L652-CONTODCE        PIC X(6).                            
000025*                       DTEVAORD                                  
000026     10 L652-DTEVAORD        PIC X(8).                            
000027*                       AANUMFAT                                  
000028     10 L652-AANUMFAT        PIC X(8).                            
000029*                       DTFATTUR                                  
000030     10 L652-DTFATTUR        PIC X(8).                            
000031*                       NRPREATT                                  
000032     10 L652-NRPREATT        PIC X(10).                           
000033*                       DTPREATT                                  
000034     10 L652-DTPREATT        PIC X(8).                            
000035*                       DTCREAZI                                  
000036     10 L652-DTCREAZI        PIC X(8).                            
000037*                       DTULTVAR                                  
000038     10 L652-DTULTVAR        PIC X(8).                            
000039*                       CODUTVAR                                  
000040     10 L652-CODUTVAR        PIC X(6).                            
000041*                       DTANNULL                                  
000042     10 L652-DTANNULL        PIC X(8).                            
000043*                       SOCIEMER                                  
000044     10 L652-SOCIEMER        PIC X(2).                            
000045*                       DATAESTR                                  
000046     10 L652-DATAESTR        PIC X(8).                            
000047*                       AAMMCOMP                                  
000048     10 L652-AAMMCOMP        PIC X(6).                            
000049*                       FLAGSOSP                                  
000050     10 L652-FLAGSOSP        PIC X(1).                            
000051*                       CODUTEVB                                  
000052     10 L652-CODUTEVB        PIC X(6).                            
000053*                       ESENTIVA                                  
000054     10 L652-ESENTIVA        PIC X(1).                            
000055*                       FLORDIVB                                  
000056     10 L652-FLORDIVB        PIC X(1).                            
000057******************************************************************
000058* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 26      *
000059******************************************************************
      *<<((file: FDLOG652))
001828*--------------------------------DLOGISTI.TRIGORDILOGI            
001829 01  FILLER                      PIC X(8) VALUE 'FDLOG653'.       
001830*    EXEC SQL INCLUDE FDLOG653 END-EXEC.                          
      *>>((file: FDLOG653))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TRIGORDILOGI              *
000003******************************************************************
000004 01  DCLTRIGORDILOGI.                                             
000005     10 L653-AANUMORD        PIC X(8).                            
000006     10 L653-NRRIGORD        PIC S9(5)V USAGE COMP-3.             
000007     10 L653-CODSERVI        PIC X(6).                            
000008     10 L653-UNMISURA        PIC X(2).                            
000009     10 L653-QTAORDIN        PIC S9(7)V9(2) USAGE COMP-3.         
000010     10 L653-PREZZORD        PIC S9(7)V9(4) USAGE COMP-3.         
000011     10 L653-IMPORDIN        PIC S9(11)V9(2) USAGE COMP-3.        
000012     10 L653-NOTENOTE        PIC X(40).                           
000013     10 L653-CENCOSTD        PIC X(5).                            
000014     10 L653-CENCOSTA        PIC X(5).                            
000015     10 L653-RIFECLIE        PIC X(15).                           
000016     10 L653-DTCREAZI        PIC X(8).                            
000017     10 L653-DTULTVAR        PIC X(8).                            
000018     10 L653-CODUTVAR        PIC X(6).                            
000019     10 L653-DTANNULL        PIC X(8).                            
000020     10 L653-IMPORIVA        PIC S9(11)V9(2) USAGE COMP-3.        
000021******************************************************************
000022* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 16      *
000023******************************************************************
      *<<((file: FDLOG653))
001831*--------------------------------DLOGISTI.TLISTILOGI              
001832 01  FILLER                      PIC X(8) VALUE 'FDLOG654'.       
001833*    EXEC SQL INCLUDE FDLOG654 END-EXEC.                          
      *>>((file: FDLOG654))
000001******************************************************************
000002* DCLGEN TABLE(DLOGISTI.TLISTILOGI)                              *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDLOG654))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(L654-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DLOGISTI.TLISTILOGI TABLE                   
000012*     ( CODCLIEN                       CHAR(5) NOT NULL,           
000013*       DTINILIS                       CHAR(6) NOT NULL,           
000014*       DTFINLIS                       CHAR(6) NOT NULL,           
000015*       CODSERVI                       CHAR(6) NOT NULL,           
000016*       TIPSERVI                       CHAR(1) NOT NULL,           
000017*       CODDIVIS                       CHAR(2) NOT NULL,           
000018*       PREZZLIS                       DECIMAL(11, 4) NOT NULL,    
000019*       PERCLIST                       DECIMAL(5, 2) NOT NULL,     
000020*       DTCREAZI                       CHAR(8) NOT NULL,           
000021*       DTULTVAR                       CHAR(8) NOT NULL,           
000022*       CODUTVAR                       CHAR(8) NOT NULL            
000023*     ) END-EXEC
                                                                        
000024******************************************************************
000025* COBOL DECLARATION FOR TABLE DLOGISTI.TLISTILOGI                *
000026******************************************************************
000027 01  DCLTLISTILOGI.                                               
000028*                       CODCLIEN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000029     10 L654-CODCLIEN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000030*                       DTINILIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000031     10 L654-DTINILIS        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000032*                       DTFINLIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000033     10 L654-DTFINLIS        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000034*                       CODSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000035     10 L654-CODSERVI        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000036*                       TIPSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000037     10 L654-TIPSERVI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000038*                       CODDIVIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000039     10 L654-CODDIVIS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000040*                       PREZZLIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000041     10 L654-PREZZLIS        PIC S9(7)V9(4) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000042*                       PERCLIST                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000043     10 L654-PERCLIST        PIC S9(3)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000044*                       DTCREAZI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000045     10 L654-DTCREAZI        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000046*                       DTULTVAR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000047     10 L654-DTULTVAR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000048*                       CODUTVAR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000049     10 L654-CODUTVAR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000050******************************************************************
000051* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 11      *
000052******************************************************************
      *<<((file: FDLOG654))
001834*--------------------------------DLOGISTI.TSERVIZI                
001835 01  FILLER                      PIC X(8) VALUE 'FDLOG651'.       
001836*    EXEC SQL INCLUDE FDLOG651 END-EXEC.                          
      *>>((file: FDLOG651))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TSERVIZI                  *
000003******************************************************************
000004 01  DCLTSERVIZI.                                                 
000005*                       CODSERVI                                  
000006     10 L651-CODSERVI        PIC X(6).                            
000007*                       DESSERVI                                  
000008     10 L651-DESSERVI        PIC X(40).                           
000009*                       UNMISURA                                  
000010     10 L651-UNMISURA        PIC X(2).                            
000011*                       TIPSERVI                                  
000012     10 L651-TIPSERVI        PIC X(1).                            
000013*                       DTCREAZI                                  
000014     10 L651-DTCREAZI        PIC X(8).                            
000015*                       DTULTVAR                                  
000016     10 L651-DTULTVAR        PIC X(8).                            
000017*                       CODUTVAR                                  
000018     10 L651-CODUTVAR        PIC X(6).                            
000019*                       CONTODCD                                  
000020     10 L651-CONTODCD        PIC X(6).                            
000021*                       CONTODCA                                  
000022     10 L651-CONTODCA        PIC X(6).                            
000023*                       CENCOSTA                                  
000024     10 L651-CENCOSTA        PIC X(5).                            
000025     10 L651-ESENTIVA        PIC X(1).                            
000026     10 L651-CONTPROV        PIC X(6).                            
000027******************************************************************
000028* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 12      *
000029******************************************************************
      *<<((file: FDLOG651))
001837*--------------------------------DANAGRAF.TCLIENTI                
001838 01  FILLER                      PIC X(8) VALUE 'FDANA901'.       
001839*    EXEC SQL INCLUDE FDANA901 END-EXEC.                          
      *>>((file: FDANA901))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TCLIENTI                  *
000003******************************************************************
000004 01  DCLTCLIENTI.                                                 
000005*                       CODCLIEN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006     10 A901-CODCLIEN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007*                       STATCLIE                                  
000008     10 A901-STATCLIE        PIC X(1).                            
000009*                       GENECLIE                                  
000010     10 A901-GENECLIE        PIC X(1).                            
000011*                       TIPOCLIE                                  
000012     10 A901-TIPOCLIE        PIC X(1).                            
000013*                       TIPOCONS                                  
000014     10 A901-TIPOCONS        PIC X(1).                            
000015*                       CLIFOCON                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000016     10 A901-CLIFOCON        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000017*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000018     10 A901-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000019*                       CAPOCONT                                  
000020     10 A901-CAPOCONT        PIC X(5).                            
000021*                       CODFISCA                                  
000022     10 A901-CODFISCA        PIC X(16).                           
000023*                       ESENTIVA                                  
000024     10 A901-ESENTIVA        PIC X(1).                            
000025*                       NUMESIVA                                  
000026     10 A901-NUMESIVA        PIC X(5).                            
000027*                       DATESIVA                                  
000028     10 A901-DATESIVA        PIC X(8).                            
000029*                       UFFICIVA                                  
000030     10 A901-UFFICIVA        PIC X(18).                           
000031*                       IMPESIVA                                  
000032     10 A901-IMPESIVA        PIC S9(4)V USAGE COMP-3.             
000033*                       BANCAPPO                                  
000034     10 A901-BANCAPPO        PIC X(3).                            
000035*                       NOMBANCL                                  
000036     10 A901-NOMBANCL        PIC X(114).                          
000037*                       CONTOCOR                                  
000038     10 A901-CONTOCOR        PIC X(13).                           
000039*                       ASSOBANC                                  
000040     10 A901-ASSOBANC        PIC X(5).                            
000041*                       AVVIBANC                                  
000042     10 A901-AVVIBANC        PIC X(5).                            
000043*                       CLIEFATT                                  
000044     10 A901-CLIEFATT        PIC X(5).                            
000045*                       PAESFATT                                  
000046     10 A901-PAESFATT        PIC X(3).                            
000047*                       RAGFATTU                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000048     10 A901-RAGFATTU        PIC X(24).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000049*                       ESRAGFAT                                  
000050     10 A901-ESRAGFAT        PIC X(24).                           
000051*                       INDFATTU                                  
000052     10 A901-INDFATTU        PIC X(24).                           
000053*                       ESINDFAT                                  
000054     10 A901-ESINDFAT        PIC X(24).                           
000055*                       CITFATTU                                  
000056     10 A901-CITFATTU        PIC X(18).                           
000057*                       ESCITFAT                                  
000058     10 A901-ESCITFAT        PIC X(18).                           
000059*                       CAPFATTU                                  
000060     10 A901-CAPFATTU        PIC X(5).                            
000061*                       PAESMERC                                  
000062     10 A901-PAESMERC        PIC X(3).                            
000063*                       RAGMERCE                                  
000064     10 A901-RAGMERCE        PIC X(24).                           
000065*                       ESRAGMER                                  
000066     10 A901-ESRAGMER        PIC X(24).                           
000067*                       INDMERCE                                  
000068     10 A901-INDMERCE        PIC X(24).                           
000069*                       ESINDMER                                  
000070     10 A901-ESINDMER        PIC X(24).                           
000071*                       CITMERCE                                  
000072     10 A901-CITMERCE        PIC X(18).                           
000073*                       ESCITMER                                  
000074     10 A901-ESCITMER        PIC X(18).                           
000075*                       CAPMERCE                                  
000076     10 A901-CAPMERCE        PIC X(5).                            
000077*                       ZONAMERC                                  
000078     10 A901-ZONAMERC        PIC X(2).                            
000079*                       TELCLIEN                                  
000080     10 A901-TELCLIEN        PIC X(20).                           
000081*                       TLXCLIEN                                  
000082     10 A901-TLXCLIEN        PIC X(20).                           
000083*                       FAXCLIEN                                  
000084     10 A901-FAXCLIEN        PIC X(20).                           
000085*                       RIFEMIRO                                  
000086     10 A901-RIFEMIRO        PIC X(11).                           
000087*                       PAESORDI                                  
000088     10 A901-PAESORDI        PIC X(3).                            
000089*                       ZONAORDI                                  
000090     10 A901-ZONAORDI        PIC X(2).                            
000091*                       DATVASTA                                  
000092     10 A901-DATVASTA        PIC X(8).                            
000093*                       ATTENZDI                                  
000094     10 A901-ATTENZDI        PIC X(24).                           
000095*                       CONDPAGA                                  
000096     10 A901-CONDPAGA        PIC X(3).                            
000097*                       MMESCLU1                                  
000098     10 A901-MMESCLU1        PIC S9(2)V USAGE COMP-3.             
000099*                       MMESCLU2                                  
000100     10 A901-MMESCLU2        PIC S9(2)V USAGE COMP-3.             
000101*                       GGSCATRA                                  
000102     10 A901-GGSCATRA        PIC S9(2)V USAGE COMP-3.             
000103*                       NUMGGVIA                                  
000104     10 A901-NUMGGVIA        PIC S9(2)V USAGE COMP-3.             
000105*                       TIPOTRAT                                  
000106     10 A901-TIPOTRAT        PIC X(1).                            
000107*                       ALTERSPE                                  
000108     10 A901-ALTERSPE        PIC X(1).                            
000109*                       CODILING                                  
000110     10 A901-CODILING        PIC X(1).                            
000111*                       DTULTVAR                                  
000112     10 A901-DTULTVAR        PIC X(8).                            
000113*                       TIPCLCAR                                  
000114     10 A901-TIPCLCAR        PIC X(1).                            
000115*                       SPETRASP                                  
000116     10 A901-SPETRASP        PIC X(1).                            
000117*                       DTCREAZI                                  
000118     10 A901-DTCREAZI        PIC X(8).                            
000119*                       CODDIVIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000120     10 A901-CODDIVIS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000121*                       CDIVACEE                                  
000122     10 A901-CDIVACEE        PIC X(14).                           
000123*                       ZONAFATT                                  
000124     10 A901-ZONAFATT        PIC X(2).                            
000125*                       CLASDOGA                                  
000126     10 A901-CLASDOGA        PIC X(1).                            
000127*                       INTNCLIE                                  
000128     10 A901-INTNCLIE        PIC X(50).                           
000129*                       CAPOCOMM                                  
000130     10 A901-CAPOCOMM        PIC X(5).                            
000131*                       PRIORITA                                  
000132     10 A901-PRIORITA        PIC X(1).                            
000133*                       BULSTATX                                  
000134     10 A901-BULSTATX        PIC X(13).                           
000135*                       CODUTVAR                                  
000136     10 A901-CODUTVAR        PIC X(6).                            
000137*                       CODUTCRE                                  
000138     10 A901-CODUTCRE        PIC X(6).                            
000139*                       CDRESCON                                  
000140     10 A901-CDRESCON        PIC X(2).                            
000141*                       CENCOACQ                                  
000142     10 A901-CENCOACQ        PIC X(5).                            
000143*                       CAPOSOCI                                  
000144     10 A901-CAPOSOCI        PIC X(5).                            
000145*                       CDFISCAL                                  
000146     10 A901-CDFISCAL        PIC X(16).                           
000147*                       CONDPACA                                  
000148     10 A901-CONDPACA        PIC X(3).                            
000149*                       CODXIBAN                                  
000150     10 A901-CODXIBAN        PIC X(4).                            
000151*                       CODXXCIN                                  
000152     10 A901-CODXXCIN        PIC X(2).                            
000153*                       ZIPFATTU                                  
000154     10 A901-ZIPFATTU        PIC X(15).                           
000155*                       ZIPMERCE                                  
000156     10 A901-ZIPMERCE        PIC X(15).                           
000157*                       TIPOLIST                                  
000158     10 A901-TIPOLIST        PIC X(1).                            
000159*                       SWIFTCOD                                  
000160     10 A901-SWIFTCOD        PIC X(11).                           
000161*                       PERCEIVA                                  
000162     10 A901-PERCEIVA        PIC S9(3)V9(2) USAGE COMP-3.         
000163*                       DTVALIVA                                  
000164     10 A901-DTVALIVA        PIC X(8).                            
000165*                       CLASSCLI                                  
000166     10 A901-CLASSCLI        PIC X(1).                            
000167*                       RATINGCO                                  
000168     10 A901-RATINGCO        PIC X(3).                            
000169*                       RISCHCLI                                  
000170     10 A901-RISCHCLI        PIC X(1).                            
000171*                                                                 
000172     10 A901-NRPROIVA        PIC X(30).                           
000173*                                                                 
000174     10 A901-IMPESNEW        PIC S9(9)V9(2) USAGE COMP-3.         
000175     10 A901-TIPOSTAG        PIC X(1).                            
000176     10 A901-FLFATELE        PIC X(1).                            
000177     10 A901-CDDESTFE        PIC X(7).                            
000178     10 A901-INPECCLI        PIC X(50).                           
000179******************************************************************
000180* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 88      *
000181******************************************************************
      *<<((file: FDANA901))
001840*--------------------------------DANAGRAF.TDATARIO                
001841 01  FILLER                      PIC X(8) VALUE 'FDANA973'.       
001842*    EXEC SQL INCLUDE FDANA973 END-EXEC.                          
      *>>((file: FDANA973))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TDATARIO)                                *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA973))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(A973-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DANAGRAF.TDATARIO TABLE                     
000012*     ( DTGIORNO                       CHAR(8) NOT NULL,           
000013*       PRGIORNO                       DECIMAL(7, 0) NOT NULL,     
000014*       NUMGIORN                       CHAR(3) NOT NULL,           
000015*       NUMSETTI                       CHAR(2) NOT NULL,           
000016*       NRGGSETT                       CHAR(1) NOT NULL,           
000017*       DTINISET                       CHAR(8) NOT NULL,           
000018*       DTFINSET                       CHAR(8) NOT NULL,           
000019*       DTINIMES                       CHAR(8) NOT NULL,           
000020*       DTFINMES                       CHAR(8) NOT NULL,           
000021*       ANNOSETT                       CHAR(6) NOT NULL,           
000022*       FLAGFEST                       CHAR(1) NOT NULL            
000023*     ) END-EXEC
                                                                        
000024******************************************************************
000025* COBOL DECLARATION FOR TABLE DANAGRAF.TDATARIO                  *
000026******************************************************************
000027 01  DCLTDATARIO.                                                 
000028*                       DTGIORNO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000029     10 A973-DTGIORNO        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000030*                       PRGIORNO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000031     10 A973-PRGIORNO        PIC S9(7)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000032*                       NUMGIORN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000033     10 A973-NUMGIORN        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000034*                       NUMSETTI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000035     10 A973-NUMSETTI        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000036*                       NRGGSETT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000037     10 A973-NRGGSETT        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000038*                       DTINISET                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000039     10 A973-DTINISET        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000040*                       DTFINSET                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000041     10 A973-DTFINSET        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000042*                       DTINIMES                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000043     10 A973-DTINIMES        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000044*                       DTFINMES                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000045     10 A973-DTFINMES        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000046*                       ANNOSETT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000047     10 A973-ANNOSETT        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000048*                       FLAGFEST                                  
000049     10 A973-FLAGFEST        PIC X(1).                            
000050******************************************************************
000051* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 11      *
000052******************************************************************
      *<<((file: FDANA973))
001843*--------------------------------DANAGRAF.TSOCIETA                
001844 01  FILLER                      PIC X(8) VALUE 'FDANA531'.       
001845*    EXEC SQL INCLUDE FDANA531 END-EXEC.                          
      *>>((file: FDANA531))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TSOCIETA                  *
000003******************************************************************
000004 01  DCLTSOCIETA.                                                 
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 A531-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000006     10 A531-NOMSOCIE        PIC X(23).                           
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000007     10 A531-CODFORNI        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000008     10 A531-TASSINTE        PIC S9(3)V9(2) USAGE COMP-3.         
000009     10 A531-CODPAESE        PIC X(3).                            
000010     10 A531-NRGGRISC        PIC S9(3)V USAGE COMP-3.             
000011     10 A531-CODPIANO        PIC X(2).                            
000012     10 A531-CITTASOC        PIC X(18).                           
000013     10 A531-FLPAGIVA        PIC X(1).                            
000014     10 A531-FLFATACQ        PIC X(1).                            
000015     10 A531-CODAZIEN        PIC X(5).                            
000016     10 A531-FLIVATRA        PIC X(1).                            
000017     10 A531-CODDIVIS        PIC X(2).                            
000018     10 A531-COSTINTE        PIC S9(3)V9(2) USAGE COMP-3.         
000019     10 A531-FLCONTAB        PIC X(1).                            
000020     10 A531-FLAGMAGA        PIC X(1).                            
000021     10 A531-RAGSOCIE        PIC X(50).                           
000022     10 A531-SOCIECON        PIC X(2).                            
000023     10 A531-DTCREAZI        PIC X(8).                            
000024     10 A531-DTULTVAR        PIC X(8).                            
000025     10 A531-CODUTVAR        PIC X(6).                            
000026     10 A531-INDLEGAL        PIC X(35).                           
000027     10 A531-CAPLEGAL        PIC X(5).                            
000028     10 A531-CITLEGAL        PIC X(18).                           
000029     10 A531-CODFISCA        PIC X(16).                           
000030     10 A531-CODDIVRI        PIC X(2).                            
000031     10 A531-SOCIEGTM        PIC X(2).                            
000032     10 A531-GENEFATT        PIC X(1).                            
000033     10 A531-FLAGATTI        PIC X(1).                            
000034     10 A531-DIVISOLD        PIC X(2).                            
000035     10 A531-DTFINOLD        PIC X(8).                            
000036     10 A531-DIVRIOLD        PIC X(2).                            
000037     10 A531-DIVIRIFA        PIC X(2).                            
000038     10 A531-FLEURUSA        PIC X(1).                            
000039     10 A531-FLAGLIMI        PIC X(1).                            
000040     10 A531-FLFILIAL        PIC X(1).                            
000041     10 A531-FLPRESEN        PIC X(1).                            
000042     10 A531-CODSOCPA        PIC X(1).                            
000043     10 A531-FLBOLGVB        PIC X(1).                            
000044     10 A531-FLSTCART        PIC X(1).                            
000045     10 A531-FLDIPEST        PIC X(1).                            
000046     10 A531-CODFIRMA        PIC X(8).                            
000047     10 A531-DESFIRMA        PIC X(24).                           
000048     10 A531-CDSOCJDE        PIC X(5).                            
000049     10 A531-CODFORNV        PIC X(5).                            
000050     10 A531-CODFORNA        PIC X(5).                            
000051     10 A531-IMPCCASO        PIC S9(13) COMP-3.                   
000052     10 A531-TRIBCCIA        PIC X(10).                           
000053     10 A531-PROLEGAL        PIC X(2).                            
000054     10 A531-FLSOCSAP        PIC X(1).                            
000055     10 A531-DIVIXLAV        PIC X(2).                            
000056******************************************************************
000057* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 51      *
000058******************************************************************
      *<<((file: FDANA531))
001846*--------------------------------DANAGRAF.TDIVISE                 
001847 01  FILLER                      PIC X(8) VALUE 'FDANA963'.       
001848*    EXEC SQL INCLUDE FDANA963 END-EXEC.                          
      *>>((file: FDANA963))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TDIVISE                   *
000003******************************************************************
000004 01  DCLTDIVISE.                                                  
000005*                       SIGLADIV                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006     10 A963-SIGLADIV        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007*                       CAMBIODV                                  
000008     10 A963-CAMBIODV        PIC S9(5)V9(6) USAGE COMP-3.         
000009*                       DESCDIVI                                  
000010     10 A963-DESCDIVI        PIC X(20).                           
000011*                       CODDIVIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000012     10 A963-CODDIVIS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000013*                       DECIDIVI                                  
000014     10 A963-DECIDIVI        PIC X(1).                            
000015*                       DIVIBANC                                  
000016     10 A963-DIVIBANC        PIC X(3).                            
000017*                       DIVIPREZ                                  
000018     10 A963-DIVIPREZ        PIC X(1).                            
000019*                       CODDIVRI                                  
000020     10 A963-CODDIVRI        PIC X(2).                            
000021*                       RAPPCAMB                                  
000022     10 A963-RAPPCAMB        PIC S9(5)V USAGE COMP-3.             
000023*                       CODDIGTM                                  
000024     10 A963-CODDIGTM        PIC X(2).                            
000025*                       FLAGEURO                                  
000026     10 A963-FLAGEURO        PIC X(1).                            
000027*                       SLDIVBAN                                  
000028     10 A963-SLDIVBAN        PIC X(3).                            
000029*                       CDDIVSCA                                  
000030     10 A963-CDDIVSCA        PIC X(2).                            
000031*                       FLDIVINT                                  
000032     10 A963-FLDIVINT        PIC X(1).                            
000033     10 A963-VBDIVSCA        PIC X(2).                            
000034******************************************************************
000035* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 15      *
000036******************************************************************
      *<<((file: FDANA963))
001849*--------------------------------DANAGRAF.TMESSAGGI               
001850 01  FILLER                      PIC X(8) VALUE 'FDANA846'.       
001851*    EXEC SQL INCLUDE FDANA846 END-EXEC.                          
      *>>((file: FDANA846))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TMESSAGGI)                               *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA846))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        QUOTE                                                   *
000007* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000008******************************************************************
000009     
      *EXEC SQL DECLARE DANAGRAF.TMESSAGGI TABLE                    
000010*     ( CODERROR                       CHAR(5) NOT NULL,           
000011*       CODILING                       CHAR(1) NOT NULL,           
000012*       MSGERROR                       CHAR(60) NOT NULL,          
000013*       TIPOMESS                       CHAR(1) NOT NULL,           
000014*       DTCREAZI                       CHAR(8) NOT NULL,           
000015*       DTULTVAR                       CHAR(8) NOT NULL,           
000016*       CODUTVAR                       CHAR(6) NOT NULL            
000017*     ) END-EXEC
                                                                        
000018******************************************************************
000019* COBOL DECLARATION FOR TABLE DANAGRAF.TMESSAGGI                 *
000020******************************************************************
000021 01  DCLTMESSAGGI.                                                
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000022     10 A846-CODERROR        PIC X(5).                            
000023     10 A846-CODILING        PIC X(1).                            
000024     10 A846-MSGERROR        PIC X(60).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025     10 A846-TIPOMESS        PIC X(1).                            
000026     10 A846-DTCREAZI        PIC X(8).                            
000027     10 A846-DTULTVAR        PIC X(8).                            
000028     10 A846-CODUTVAR        PIC X(6).                            
000029******************************************************************
000030* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 7       *
000031******************************************************************
      *<<((file: FDANA846))
001852*--------------------------------'DATEDATE'                       
001853 01  FILLER                      PIC X(8) VALUE 'FDANA082'.       
001854*    EXEC SQL INCLUDE FDANA082 END-EXEC.                          
      *>>((file: FDANA082))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.VANAGRAF_082)                            *
000003*        LIBRARY(PROG169.MTCSV440.DCLGEN(FDANA082))              *
000004*        LANGUAGE(COBOL)                                         *
000005*        QUOTE                                                   *
000006* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000007******************************************************************
000008     
      *EXEC SQL DECLARE DANAGRAF.VANAGRAF_082 TABLE                 
000009*     ( DATEDATE                       CHAR(10) NOT NULL           
000010*     ) END-EXEC
                                                                        
000011******************************************************************
000012* COBOL DECLARATION FOR TABLE DANAGRAF.VANAGRAF_082              *
000013******************************************************************
000014 01  DCLVANAGRAF-082.                                             
000015  10 A082-DATEDATE             PIC X(10).                         
000016******************************************************************
000017* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 1       *
000018******************************************************************
      *<<((file: FDANA082))
001855*--------------------------------DCDTGG                           
001856 01  FILLER                      PIC X(8) VALUE '**DCDTGG'.       
001857*    EXEC SQL INCLUDE DCDTGG   END-EXEC.                          
      *>>((file: DCDTGG))
000001*----------------------------------------------------------------*
000002*----               AREA PER SUBROUTINE SRDTGG               ----*
000003*----------------------------------------------------------------*
000004 01  DCDTGG.                                                      
000005*-------------------------------------------- CAMPI DI INPUT      
000006     02 DTGG-DTRICHIE         PIC X(08)         VALUE SPACES.     
000007     02 DTGG-PRRICHIE         PIC S9(7) COMP-3  VALUE +0.         
000008                                                                  
000009*-------------------------------------------- CAMPI DI OUTPUT     
000010     02 DTGG-DTGIORNO.                                            
000011        03 DTGG-SAGIORNO.                                         
000012           04 DTGG-SSGIORNO   PIC XX.                             
000013           04 DTGG-AAGIORNO   PIC XX.                             
000014        03 DTGG-MMGIORNO      PIC XX.                             
000015        03 DTGG-GGGIORNO      PIC XX.                             
000016     02 DTGG-PRGIORNO         PIC S9(7) COMP-3.                   
000017     02 DTGG-NUMSETTI         PIC X(02).                          
000018     02 DTGG-NUMGIORN         PIC X(03).                          
000019     02 DTGG-NRGGSETT         PIC X(01).                          
000020     02 DTGG-DTINISET.                                            
000021        03 DTGG-SAINISET.                                         
000022           04 DTGG-SSINISET   PIC XX.                             
000023           04 DTGG-AAINISET   PIC XX.                             
000024        03 DTGG-MMINISET      PIC XX.                             
000025        03 DTGG-GGINISET      PIC XX.                             
000026     02 DTGG-DTFINSET         PIC X(08).                          
000027     02 DTGG-DTINIMES         PIC X(08).                          
000028     02 DTGG-DTFINMES         PIC X(08).                          
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000029     02 DTGG-CURRENDT         PIC X(08).                          
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000030     02 DTGG-DTCURREN.                                            
000031        03 DTGG-AACURREN      PIC X(04).                          
000032        03 DTGG-MMCURREN      PIC X(02).                          
000033        03 DTGG-GGCURREN      PIC X(02).                          
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000034     02 DTGG-DATAGIOR         PIC X(10).                          
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000035     02 DTGG-ANNOSETT.                                            
000036        03 DTGG-SSAASETT      PIC X(04).                          
000037        03 DTGG-SETTSETT      PIC X(02).                          
000038     02 DTGG-FILLER4          PIC X(04).                          
000039     02 DTGG-RETUCODE         PIC X(04).                          
000040*----------------------------------------------------------------*
      *<<((file: DCDTGG))
001859     
      *EXEC SQL 
      *DECLARE POINTER1  CURSOR FOR                            
001860*           SELECT A.CODCLIEN, A.DTINILIS                          
001861*                 ,A.DTFINLIS, A.CODDIVIS                          
001862*             FROM DLOGISTI.TLISTILOGI A                           
001863*                 ,DANAGRAF.TCLIENTI   C                           
001864*            WHERE A.CODCLIEN BETWEEN :MIN-CODCLIEN                
001865*                                 AND :MAX-CODCLIEN                
001866*              AND A.DTINILIS BETWEEN :MIN-DTINILIS                
001867*                                 AND :MAX-DTINILIS                
001868*              AND A.DTFINLIS BETWEEN :MIN-DTFINLIS                
001869*                                 AND :MAX-DTFINLIS                
001870*              AND A.TIPSERVI = :L654-TIPSERVI                     
001871*              AND A.CODCLIEN = C.CODCLIEN                         
001872*              AND C.CODSOCIE = '22'                               
001873*         GROUP BY A.CODCLIEN, A.DTINILIS                          
001874*                 ,A.DTFINLIS, A.CODDIVIS                          
001875*          ORDER BY 1, 4, 2 DESC, 3 DESC                           
001876*     END-EXEC
                                                                        
001878     
      *EXEC SQL 
      *DECLARE POINTER2  CURSOR FOR                            
001879*           SELECT CODSERVI, PREZZLIS                              
001880*                 ,PERCLIST, TIPSERVI                              
001881*             FROM DLOGISTI.TLISTILOGI A                           
001882*            WHERE TIPSERVI = :WS-TIPSERVI                         
001883*              AND CODCLIEN = :WS-CODCLIEN                         
001884*              AND DTINILIS = :WS-DTINILIS                         
001885*              AND DTFINLIS = :WS-DTFINLIS                         
001886*              AND CODDIVIS = :WS-CODDIVIS                         
001887*     END-EXEC
                                                                        
001889     
      *EXEC SQL 
      *DECLARE POINTPF13 CURSOR FOR                            
001890*           SELECT CODCLIEN, RAGFATTU                              
001891*             FROM DANAGRAF.TCLIENTI                               
001892*            WHERE CODCLIEN > :WS-CODCLIEN                         
001893*              AND RAGFATTU LIKE :WS-RAGFATTU                      
001894*              AND CODSOCIE = '22'                                 
001895*            ORDER BY CODCLIEN                                     
001896*     END-EXEC
                                                                        
001898     
      *EXEC SQL 
      *DECLARE POINTPF14 CURSOR FOR                            
001899*           SELECT CODCLIEN, RAGFATTU                              
001900*             FROM DANAGRAF.TCLIENTI                               
001901*            WHERE CODCLIEN < :WS-CODCLIEN                         
001902*              AND RAGFATTU LIKE :WS-RAGFATTU                      
001903*              AND CODSOCIE = '22'                                 
001904*            ORDER BY CODCLIEN DESC                                
001905*     END-EXEC
                                                                        
001908*    EXEC SQL                                                     
      *         INCLUDE SQLCA                                           
      *    END-EXEC.                                                    
      *>>((file: SQLCA))
000001****************************************************************<*
000002* Copyright (c) 2016-2023 NTT DATA, Inc. All rights reserved.  *<*
000003* Users of NTT DATA Enterprise COBOL may freely                *<*
000004* redistribute this copybook.                                  *<*
000005****************************************************************<*
000006                                                                  
000007 01  SQLCA GLOBAL.                                                
000008     05  SQLCAID                PIC X(8).                         
000009     05  SQLCABC                PIC S9(9) COMP-5.                 
000010     05  SQLCODE                PIC S9(9) COMP-5.                 
000011     05  SQLERRM.                                                 
000012         49  SQLERRML           PIC S9(4) COMP-5.                 
000013         49  SQLERRMC           PIC X(254).                       
000014     05  SQLERRP                PIC X(8).                         
000015     05  SQLERRD OCCURS 6 TIMES PIC S9(9) COMP-5.                 
000016     05  SQLWARN.                                                 
000017         10 SQLWARN0            PIC X(1).                         
000018         10 SQLWARN1            PIC X(1).                         
000019         10 SQLWARN2            PIC X(1).                         
000020         10 SQLWARN3            PIC X(1).                         
000021         10 SQLWARN4            PIC X(1).                         
000022         10 SQLWARN5            PIC X(1).                         
000023         10 SQLWARN6            PIC X(1).                         
000024         10 SQLWARN7            PIC X(1).                         
000025     05  SQLSTATE               PIC X(5).                         
000026     05  SQLEXT                 PIC S9(5) COMP-3 VALUE 1.         
      *<<((file: SQLCA))
001909****************************************************************  
001910*                                                                 
001911* Copyright (c) 2016-2022 NTT DATA, Inc.                          
001912* All rights reserved.                                            
001913*                                                                 
001914****************************************************************  
001915 01  DFHEIV.                                                      
001916   02  DFHEIV0               PIC X(35).                           
001917   02  DFHEIV1               PIC X(08).                           
001918   02  DFHEIV2               PIC X(08).                           
001919   02  DFHEIV3               PIC X(08).                           
001920   02  DFHEIV4               PIC X(06).                           
001921   02  DFHEIV5               PIC X(04).                           
001922   02  DFHEIV6               PIC X(04).                           
001923   02  DFHEIV7               PIC X(02).                           
001924   02  DFHEIV8               PIC X(02).                           
001925   02  DFHEIV9               PIC X(01).                           
001926   02  DFHEIV10              PIC S9(7) COMP-3.                    
001927   02  DFHEIV11              PIC S9(4) COMP SYNC.                 
001928   02  DFHEIV12              PIC S9(4) COMP SYNC.                 
001929   02  DFHEIV13              PIC S9(4) COMP SYNC.                 
001930   02  DFHEIV14              PIC S9(4) COMP SYNC.                 
001931   02  DFHEIV15              PIC S9(4) COMP SYNC.                 
001932   02  DFHEIV16              PIC S9(9) COMP SYNC.                 
001933   02  DFHEIV17              PIC X(04).                           
001934   02  DFHEIV18              PIC X(04).                           
001935   02  DFHEIV19              PIC X(04).                           
001936   02  DFHEIV20              USAGE IS POINTER.                    
001937   02  DFHEIV21              USAGE IS POINTER.                    
001938   02  DFHEIV22              USAGE IS POINTER.                    
001939   02  DFHEIV23              USAGE IS POINTER.                    
001940   02  DFHEIV24              USAGE IS POINTER.                    
001941   02  DFHEIV25              PIC S9(9) COMP SYNC.                 
001942   02  DFHEIV26              PIC S9(9) COMP SYNC.                 
001943   02  DFHEIV27              PIC S9(9) COMP SYNC.                 
001944   02  DFHEIV28              PIC S9(9) COMP SYNC.                 
001945   02  DFHEIV29              PIC S9(9) COMP SYNC.                 
001946   02  DFHEIV30              PIC S9(9) COMP SYNC.                 
001947   02  DFHEIV31              PIC S9(9) COMP SYNC.                 
001948   02  DFHEIV32              PIC S9(4) COMP SYNC.                 
001949   02  DFHEIV33              PIC S9(4) COMP SYNC.                 
001950   02  DFHEIV34              PIC S9(4) COMP SYNC.                 
001951   02  DFHEIV35              PIC S9(4) COMP SYNC.                 
001952   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.         
001953   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.      
001954   02  FILLER                PIC X(02).                           
001955   02  DFHEIV99              PIC X(08) VALUE SPACE.               
001956   02  DFHEIVL0              PIC X(48) VALUE SPACE.               
001957   02  DFHEIVL1              PIC X(48) VALUE SPACE.               
001958   02  DFHEIVL2              PIC X(48) VALUE SPACE.               
001959   02  DFHEIVL3              PIC X(48) VALUE SPACE.               
001960   02  DFHEIVL4              PIC X(255) VALUE SPACE.              
001961   02  DFHEIVL5              PIC X(255) VALUE SPACE.              
001962 LINKAGE  SECTION.                                                
001963***************************************************************** 
001964*                                                               * 
001965* Copyright (c) 2016-2022 NTT DATA, Inc.                        * 
001966* All rights reserved.                                          * 
001967*                                                               * 
001968***************************************************************** 
001969 01  dfheiblk.                                                    
001970     02  eibtime          pic s9(7) comp-3.                       
001971     02  eibdate          pic s9(7) comp-3.                       
001972     02  eibtrnid         pic x(4).                               
001973     02  eibtaskn         pic s9(7) comp-3.                       
001974     02  eibtrmid         pic x(4).                               
001975     02  dfheigdi         pic s9(4) comp.                         
001976     02  eibcposn         pic s9(4) comp.                         
001977     02  eibcalen         pic s9(4) comp.                         
001978     02  eibaid           pic x(1).                               
001979     02  eibfiller1       pic x(1).                               
001980     02  eibfn            pic x(2).                               
001981     02  eibfiller2       pic x(2).                               
001982     02  eibrcode         pic x(6).                               
001983     02  eibfiller3       pic x(2).                               
001984     02  eibds            pic x(8).                               
001985     02  eibreqid         pic x(8).                               
001986     02  eibrsrce         pic x(8).                               
001987     02  eibsync          pic x(1).                               
001988     02  eibfree          pic x(1).                               
001989     02  eibrecv          pic x(1).                               
001990     02  eibsend          pic x(1).                               
001991     02  eibatt           pic x(1).                               
001992     02  eibeoc           pic x(1).                               
001993     02  eibfmh           pic x(1).                               
001994     02  eibcompl         pic x(1).                               
001995     02  eibsig           pic x(1).                               
001996     02  eibconf          pic x(1).                               
001997     02  eiberr           pic x(1).                               
001998     02  eibrldbk         pic x(1).                               
001999     02  eiberrcd         pic x(4).                               
002000     02  eibsynrb         pic x(1).                               
002001     02  eibnodat         pic x(1).                               
002002     02  eibfiller5       pic x(2).                               
002003     02  eibresp          pic s9(8) comp.                         
002004     02  eibresp2         pic s9(8) comp.                         
002005     02  dfheigdj         pic s9(4) comp.                         
002006     02  dfheigdk         pic s9(4) comp.                         
002007*----------------*                                                
002008 01  DFHCOMMAREA.                                                 
002009*    COPY DCLCOMMA.                                               
002010     02 LK-AREABYTE PIC X OCCURS 0 TO 4096 TIMES                  
002011                       DEPENDING ON EIBCALEN OF DFHEIBLK.         
002012*-----------------------------------------------------------------
002013 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.                   
002013 VCOBOL-DUMMY-PROCEDURE.
002014 0000-DFHENTRY SECTION.                                           
002015     MOVE FUNCTION WHEN-COMPILED TO DFHEIVL0(1:21).               
002016     MOVE SPACES TO DFHEIV2.                                      
002017     MOVE '9#                    &   ' TO DFHEIV0.                
002018     MOVE 'AVTLO60' TO DFHEIV1.                                   
002019     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1       
002020          DFHEIVL0 DFHEIV2.                                       
002021*-----------------------------------------------------------------
002022                                                                  
002023* EXEC CICS HANDLE ABEND LABEL(Z00-ERRORE)     END-EXEC.          
002024*    MOVE '..L                   " " #00002015' TO DFHEIV0        
002025     MOVE X'2E2E4C202020202020202020' &                           
002026          X'202020202020202020202220' &                           
002027          X'2220233030303032303135' TO DFHEIV0                    
002028     CALL 'kxdfhei1' USING DFHEIV0,                               
002029           DFHEIV99                                               
002030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002031                                                                  
002032     PERFORM A00-INIZIALIZZAZIONE                                 
002033        THRU A00-EX.                                              
002034     IF  EIBCALEN NOT > ZERO                                      
002035         PERFORM B00-ARRIVO-DA-START                              
002036            THRU B00-EX                                           
002037     ELSE                                                         
002038         MOVE DFHCOMMAREA        TO WCOM-AREAXXXX                 
002039         MOVE 'AVMLO60'          TO WNOMEMAP                      
002040         MOVE WCOM-CODILING      TO WCODLING                      
002041         IF EIBAID = DFHENTER OR                                  
002042            EIBAID = DFHPF10  OR                                  
002043            EIBAID = DFHPF13  OR                                  
002044            EIBAID = DFHPF14                                      
002045            PERFORM C00-RICEVI-MAPPA                              
002046               THRU C00-EX                                        
002047         ELSE                                                     
002048            PERFORM D00-GESTIONE-PF                               
002049               THRU D00-EX.                                       
002050     PERFORM E30-INVIA-MAPPA                                      
002051        THRU E30-EX.                                              
002052     PERFORM U00-RETURN-TRAN                                      
002053        THRU U00-EX.                                              
002054*----------------------------------------------------------------*
002055 A00-INIZIALIZZAZIONE.                                            
002056*----------------------------------------------------------------*
002057     MOVE +500                   TO WCOM-LUNGHEZZ.                
002058     MOVE EIBTRMID               TO WPAGVIDE                      
002059     MOVE LOW-VALUE              TO AVILO60O.                     
002060     MOVE 18                     TO WNUMRIGA.                     
002061     MOVE LENGTH OF WPAGREFE     TO WPAGLPAG.                     
002062 A00-EX. EXIT.                                                    
002063*----------------------------------------------------------------*
002064 B00-ARRIVO-DA-START.                                             
002065*----------------------------------------------------------------*
002066                                                                  
002067* EXEC CICS HANDLE CONDITION ENDDATA (B05-NORESP)                 
002068*                               END-EXEC                          
002069*    MOVE '"$&                   ! # #00002050' TO DFHEIV0        
002070     MOVE X'222426202020202020202020' &                           
002071          X'202020202020202020202120' &                           
002072          X'2320233030303032303530' TO DFHEIV0                    
002073     CALL 'kxdfhei1' USING DFHEIV0                                
002074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
002075                                                                  
002076* EXEC CICS RETRIEVE INTO   (WCOM-AREAXXXX)                       
002077*                       LENGTH (WCOM-LUNGHEZZ)                    
002078*                       END-EXEC                                  
002079*    MOVE '0*I L                 &   #00002052' TO DFHEIV0        
002080     MOVE X'302A49204C20202020202020' &                           
002081          X'202020202020202020202620' &                           
002082          X'2020233030303032303532' TO DFHEIV0                    
002083     CALL 'kxdfhei1' USING DFHEIV0,                               
002084           WCOM-AREAXXXX,                                         
002085           WCOM-LUNGHEZZ,                                         
002086           DFHEIV99,                                              
002087           DFHEIV99,                                              
002088           DFHEIV99                                               
002089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
002090     INITIALIZE  WCOM-DATIPROG.                                   
002091     PERFORM LEGGO-RICICLO                                        
002092        THRU LEGGO-RICICLO-EX.                                    
002093     PERFORM B10-PRIMA-VOLTA                                      
002094        THRU B10-EX.                                              
002095     MOVE WCOM-CODCLIEN          TO LO60-CODCLIENI.               
002096     MOVE WCOM-RAGFATTU          TO LO60-RAGFATTUI.               
002097     MOVE WCOM-DTINILIS          TO LO60-DTINILISI.               
002098     MOVE WCOM-DTFINLIS          TO LO60-DTFINLISI.               
002099     MOVE WCOM-FLAGULTI          TO LO60-FLAGULTII.               
002100     PERFORM C20-GESTIONE-RICICLO                                 
002101        THRU C20-EX.                                              
002102 B00-EX. EXIT.                                                    
002103*----------------------------------------------------------------*
002104 B05-NORESP.                                                      
002105*----------------------------------------------------------------*
002106                                                                  
002107* EXEC CICS SEND CONTROL                                          
002108*                   ERASE                                         
002109*                   CURSOR                                        
002110*                   FREEKB                                        
002111*                   END-EXEC.                                     
002112     MOVE -1                                                      
002113       TO DFHEIV11                                                
002114*    MOVE '82     CT  E F        (   #00002071' TO DFHEIV0        
002115     MOVE X'383220202020204354202045' &                           
002116          X'204620202020202020202820' &                           
002117          X'2020233030303032303731' TO DFHEIV0                    
002118     CALL 'kxdfhei1' USING DFHEIV0,                               
002119           DFHEIV99,                                              
002120           DFHEIV99,                                              
002121           DFHEIV99,                                              
002122           DFHEIV11,                                              
002123           DFHEIV99,                                              
002124           DFHEIV99,                                              
002125           DFHEIV99                                               
002126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002127                                                                  
002128                                                                  
002129* EXEC CICS RETURN END-EXEC.                                      
002130*    MOVE '.(                    ''   #00002076' TO DFHEIV0       
002131     MOVE X'2E2820202020202020202020' &                           
002132          X'202020202020202020202720' &                           
002133          X'2020233030303032303736' TO DFHEIV0                    
002134     CALL 'kxdfhei1' USING DFHEIV0,                               
002135           DFHEIV99,                                              
002136           DFHEIV99,                                              
002137           DFHEIV99,                                              
002138           DFHEIV99,                                              
002139           DFHEIV99,                                              
002140           DFHEIV99                                               
002141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002142                                                                  
002143                                                                  
002144* GOBACK.                                                         
002145     MOVE '9%                    "   ' TO DFHEIV0                 
002146     MOVE 'AVTLO60' TO DFHEIV1                                    
002147     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1                        
002148     GOBACK.                                                      
002149 B05-EX. EXIT.                                                    
002150*----------------------------------------------------------------*
002151 B10-PRIMA-VOLTA.                                                 
002152*----------------------------------------------------------------*
002153     MOVE 'AVTLO60'              TO WCOM-NOMEPRGM                 
002154     MOVE EIBTRNID               TO WCOM-TRANSAZI                 
002155     PERFORM U20-DELETE-TS                                        
002156        THRU U20-EX                                               
002157     MOVE ZEROES                 TO WCOM-PAGIRICH                 
002158                                    WCOM-PAGILIST                 
002159                                    WPAGRICH                      
002160     MOVE 99999                  TO WCOM-PAGIULTI.                
002161     MOVE 'AVMLO60'              TO WNOMEMAP                      
002162     MOVE WCOM-CODILING          TO WCODLING                      
002163     IF  WCOM-MENUTRAN (WCOM-INDITRAN) NOT = WCOM-TRANSAZI        
002164         ADD  1                  TO WCOM-INDITRAN                 
002165         MOVE WCOM-TRANSAZI      TO WCOM-MENUTRAN (WCOM-INDITRAN) 
002166         MOVE ZEROES             TO WCOM-PAGITRAN (WCOM-INDITRAN).
002167     IF  WCOM-INDITRAN > 10                                       
002168         MOVE 'TRTR'             TO WCOM-CODABEND                 
002169         PERFORM Z00-ERRORE                                       
002170            THRU Z00-EX.                                          
002171 B10-EX. EXIT.                                                    
002172*----------------------------------------------------------------*
002173 C00-RICEVI-MAPPA.                                                
002174*----------------------------------------------------------------*
002175                                                                  
002176* EXEC CICS RECEIVE MAP    (WNOMEMAP)                             
002177*                      MAPSET ('AVMLO60')                         
002178*                      INTO   (AVILO60I)                          
002179*                      END-EXEC.                                  
002180     MOVE LENGTH OF                                               
002181      AVILO60I                                                    
002182       TO DFHEIV11                                                
002183     MOVE 'AVMLO60' TO DFHEIV1                                    
002184*    MOVE '8"T I  L              ''   #00002104' TO DFHEIV0       
002185     MOVE X'382254204920204C20202020' &                           
002186          X'202020202020202020202720' &                           
002187          X'2020233030303032313034' TO DFHEIV0                    
002188     CALL 'kxdfhei1' USING DFHEIV0,                               
002189           WNOMEMAP,                                              
002190           AVILO60I,                                              
002191           DFHEIV11,                                              
002192           DFHEIV1,                                               
002193           DFHEIV99,                                              
002194           DFHEIV99                                               
002195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002196                                                                  
002197     MOVE LOW-VALUE              TO LO60-MESSAGGO.                
002198     MOVE SPACES                 TO MESS-CODERROR.                
002199     IF LO60-MAPRPAGI IS NUMERIC AND                              
002200        LO60-MAPRPAGI > ZERO                                      
002201        MOVE LO60-MAPRPAGI       TO WPAGRICH                      
002202     ELSE                                                         
002203       MOVE WCOM-PAGIRICH        TO WPAGRICH.                     
002204     IF WPAGRICH NOT = WCOM-PAGIRICH                              
002205        PERFORM E20-PAGINA-PRONTA                                 
002206           THRU E20-EX                                            
002207     ELSE                                                         
002208        IF EIBAID = DFHPF13 OR                                    
002209           EIBAID = DFHPF14                                       
002210           IF WCOM-OPERAZIO = 'D'                                 
002211              PERFORM C11-CERCA-CLIENTE-DUPL                      
002212                 THRU C11-EX                                      
002213           ELSE                                                   
002214              PERFORM C10-CERCA-CLIENTE                           
002215                 THRU C10-EX                                      
002216           END-IF                                                 
002217        ELSE                                                      
002218          INSPECT LO60-CODCLIENI REPLACING ALL LOW-VALUE BY SPACES
002219          INSPECT LO60-RAGFATTUI REPLACING ALL LOW-VALUE BY SPACES
002220          INSPECT LO60-DTINILISI REPLACING ALL LOW-VALUE BY SPACES
002221          INSPECT LO60-DTFINLISI REPLACING ALL LOW-VALUE BY SPACES
002222          INSPECT LO60-FLAGULTII REPLACING ALL LOW-VALUE BY SPACES
002223          IF LO60-CODCLIENI NOT = WCOM-CODCLIEN OR                
002224             LO60-RAGFATTUI NOT = WCOM-RAGFATTU OR                
002225             LO60-DTINILISI NOT = WCOM-DTINILIS OR                
002226             LO60-DTFINLISI NOT = WCOM-DTFINLIS OR                
002227             LO60-FLAGULTII NOT = WCOM-FLAGULTI                   
002228             PERFORM C20-GESTIONE-RICICLO                         
002229                THRU C20-EX                                       
002230          ELSE                                                    
002231             PERFORM C40-GESTIONE-RICEVI                          
002232                THRU C40-EX.                                      
002233 C00-EX. EXIT.                                                    
002234*----------------------------------------------------------------*
002235 C10-CERCA-CLIENTE.                                               
002236*----------------------------------------------------------------*
002237     IF LO60-RAGFATTUI NOT = WCOM-RAGFATTU AND                    
002238        LO60-RAGFATTUI > SPACES  AND                              
002239        WCOM-RAGFATT2 NOT > SPACES                                
002240        MOVE LO60-RAGFATTUI      TO WCOM-RAGFATT2                 
002241        MOVE SPACES              TO WS-CODCLIEN                   
002242        PERFORM C15-RICERCA-FORNITORE                             
002243           THRU C15-EX                                            
002244     ELSE                                                         
002245        IF WCOM-RAGFATT2 > SPACES                                 
002246           MOVE LO60-CODCLIENI   TO WS-CODCLIEN                   
002247           PERFORM C15-RICERCA-FORNITORE                          
002248              THRU C15-EX.                                        
002249 C10-EX. EXIT.                                                    
002250*----------------------------------------------------------------*
002251 C11-CERCA-CLIENTE-DUPL.                                          
002252*----------------------------------------------------------------*
002253     IF LO60-XRAGFATTI NOT = WCOM-XRAGFATT AND                    
002254        LO60-XRAGFATTI > SPACES  AND                              
002255        WCOM-RAGFATT3 NOT > SPACES                                
002256        MOVE LO60-XRAGFATTI      TO WCOM-RAGFATT3                 
002257        MOVE SPACES              TO WS-CODCLIEN                   
002258        PERFORM C15-RICERCA-FORNITORE                             
002259           THRU C15-EX                                            
002260     ELSE                                                         
002261        IF WCOM-RAGFATT3 > SPACES                                 
002262           MOVE LO60-XCODCLIEI   TO WS-CODCLIEN                   
002263           PERFORM C15-RICERCA-FORNITORE                          
002264              THRU C15-EX.                                        
002265 C11-EX. EXIT.                                                    
002266*----------------------------------------------------------------*
002267 C15-RICERCA-FORNITORE.                                           
002268*----------------------------------------------------------------*
002269     PERFORM C17-DESCRIZIONE-MAPPA                                
002270        THRU C17-EX.                                              
002271     MOVE 'OPEN'                 TO WCOM-FILEFUNZ.                
002272     MOVE 'C15-'                 TO WCOM-CODABEND.                
002273     MOVE SPACES                 TO WCOM-FILECTRL.                
002274     STRING WS-CODCLIEN ' ' WS-RAGFATTU                           
002275        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
002276     IF EIBAID = DFHPF13                                          
002277        MOVE 'POINTPF13'         TO WCOM-FILENOME                 
002278        
      *EXEC SQL OPEN POINTPF13 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 1 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CODCLIEN
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-RAGFATTU
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
002279     ELSE                                                         
002280        MOVE 'POINTPF14'         TO WCOM-FILENOME                 
002281        
      *EXEC SQL OPEN POINTPF14 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 2 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CODCLIEN
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-RAGFATTU
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 4 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                                              .                         
002282     IF SQLCODE NOT = ZEROES                                      
002283        PERFORM Z00-ERRORE                                        
002284           THRU Z00-EX.                                           
002285     IF EIBAID = DFHPF13                                          
002286        PERFORM L01-FETCH-POINTPF13                               
002287           THRU L01-EX                                            
002288     ELSE                                                         
002289        PERFORM L02-FETCH-POINTPF14                               
002290           THRU L02-EX.                                           
002291     MOVE SQLCODE                TO WS-SQLCODE2.                  
002292     MOVE 'CLOSE'                TO WCOM-FILEFUNZ.                
002293     MOVE 'C15-'                 TO WCOM-CODABEND.                
002294     MOVE SPACES                 TO WCOM-FILECTRL.                
002295     STRING WS-CODCLIEN ' ' WS-RAGFATTU                           
002296        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
002297     IF EIBAID = DFHPF13                                          
002298        MOVE 'POINTPF13'         TO WCOM-FILENOME                 
002299        
      *EXEC SQL CLOSE POINTPF13 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
002300     ELSE                                                         
002301        MOVE 'POINTPF14'         TO WCOM-FILENOME                 
002302        
      *EXEC SQL CLOSE POINTPF14 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 4 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                                               .                        
002303     IF SQLCODE NOT = ZEROES                                      
002304        PERFORM Z00-ERRORE                                        
002305           THRU Z00-EX.                                           
002306     IF WS-SQLCODE2 = ZEROES                                      
002307        IF WCOM-OPERAZIO = 'D'                                    
002308           MOVE A901-CODCLIEN    TO LO60-XCODCLIEO                
002309           MOVE A901-RAGFATTU    TO LO60-XRAGFATTO                
002310                                    WCOM-XRAGFATT                 
002311        ELSE                                                      
002312           MOVE A901-CODCLIEN    TO LO60-CODCLIENO                
002313           MOVE A901-RAGFATTU    TO LO60-RAGFATTUO                
002314                                    WCOM-RAGFATTU                 
002315           PERFORM C20-GESTIONE-RICICLO                           
002316              THRU C20-EX.                                        
002317 C15-EX. EXIT.                                                    
002318*----------------------------------------------------------------*
002319 C17-DESCRIZIONE-MAPPA.                                           
002320*----------------------------------------------------------------*
002321     MOVE SPACES                 TO WS-RAGFATT3.                  
002322     MOVE 1                      TO WS-IND2                       
002323     IF WCOM-OPERAZIO = 'D'                                       
002324        MOVE WCOM-RAGFATT3       TO WS-RAGFATT2                   
002325     ELSE                                                         
002326        MOVE WCOM-RAGFATT2       TO WS-RAGFATT2.                  
002327     INSPECT WS-RAGFATT2 REPLACING ALL LOW-VALUE BY SPACES.       
002328     PERFORM VARYING WS-IND1 FROM 1 BY 1                          
002329               UNTIL WS-IND1 > 24                                 
002330        IF WS-BYTE2(WS-IND1) NUMERIC   OR                         
002331          (WS-BYTE2(WS-IND1) NOT < 'A' AND                        
002332           WS-BYTE2(WS-IND1) NOT > 'Z') OR                        
002333           WS-BYTE2(WS-IND1) = SPACES  OR                         
002334           WS-BYTE2(WS-IND1) = '%'                                
002335           MOVE WS-BYTE2(WS-IND1) TO WS-BYTE3(WS-IND2)            
002336           ADD 1                 TO WS-IND2                       
002337        END-IF                                                    
002338     END-PERFORM.                                                 
002339     STRING '%' WS-RAGFATT3 DELIMITED BY SIZE                     
002340                               INTO WS-RAGFATTU.                  
002341     INSPECT WS-RAGFATTU REPLACING ALL SPACES BY '%'.             
002342 C17-EX. EXIT.                                                    
002343*----------------------------------------------------------------*
002344 C20-GESTIONE-RICICLO.                                            
002345*----------------------------------------------------------------*
002346     MOVE SPACES                 TO WCOM-OPERAZIO.                
002347     MOVE LOW-VALUE              TO WCOM-CODCLIEN                 
002348                                    WCOM-RAGFATTU                 
002349                                    WCOM-DTINILIS                 
002350                                    WCOM-DTFINLIS                 
002351                                    WCOM-FLAGULTI.                
002352     PERFORM C21-CONTROLLA-RICHIESTA                              
002353        THRU C21-EX.                                              
002354     PERFORM U20-DELETE-TS                                        
002355        THRU U20-EX.                                              
002356     MOVE 99999                  TO WCOM-PAGIULTI.                
002357     MOVE ZERO                   TO WCOM-PAGIRICH                 
002358                                    WCOM-PAGILIST                 
002359                                    WPAGRICH.                     
002360     PERFORM E99-PULISCI-MAPPA                                    
002361        THRU E99-EX                                               
002362     IF ERRORE                                                    
002363        GO TO C20-EX.                                             
002364     MOVE LO60-CODCLIENI         TO WCOM-CODCLIEN.                
002365     MOVE LO60-RAGFATTUI         TO WCOM-RAGFATTU.                
002366     MOVE LO60-DTINILISI         TO WCOM-DTINILIS.                
002367     MOVE LO60-DTFINLISI         TO WCOM-DTFINLIS.                
002368     MOVE LO60-FLAGULTII         TO WCOM-FLAGULTI.                
002369     PERFORM E10-PREPARA-PAGINE                                   
002370        THRU E10-EX.                                              
002371     PERFORM E20-PAGINA-PRONTA                                    
002372        THRU E20-EX.                                              
002373 C20-EX. EXIT.                                                    
002374*----------------------------------------------------------------*
002375 C21-CONTROLLA-RICHIESTA.                                         
002376*----------------------------------------------------------------*
002377     INSPECT LO60-CODCLIENI REPLACING ALL LOW-VALUE BY SPACES.    
002378     INSPECT LO60-RAGFATTUI REPLACING ALL LOW-VALUE BY SPACES.    
002379     INSPECT LO60-DTINILISI REPLACING ALL LOW-VALUE BY SPACES.    
002380     INSPECT LO60-DTFINLISI REPLACING ALL LOW-VALUE BY SPACES.    
002381     INSPECT LO60-FLAGULTII REPLACING ALL LOW-VALUE BY SPACES.    
002382     IF LO60-CODCLIENI > SPACES                                   
002383        MOVE SPACES              TO LO60-RAGFATTUI                
002384        MOVE +5                  TO WLENGTH                       
002385        CALL WWTWSNU USING WLENGTH LO60-CODCLIENI                 
002386        MOVE LO60-CODCLIENI      TO A901-CODCLIEN                 
002387        PERFORM L15-SELECT-CLIENTI                                
002388           THRU L15-EX                                            
002389        IF SQLCODE = +100                                         
002390           MOVE '*'              TO WSWERROR                      
002391           MOVE '00112'          TO MESS-CODERROR                 
002392           MOVE DFHUNIMD         TO LO60-CODCLIENA                
002393           MOVE DFHRED           TO LO60-CODCLIENC                
002394           MOVE -1               TO LO60-CODCLIENL                
002395           GO TO C21-EX                                           
002396        ELSE                                                      
002397           MOVE A901-RAGFATTU    TO LO60-RAGFATTUO                
002398        END-IF                                                    
002399     ELSE                                                         
002400        IF LO60-RAGFATTUI > SPACES                                
002401           MOVE LO60-RAGFATTUI   TO WCOM-RAGFATT2                 
002402           PERFORM L17-SELECT-RAGFATTU                            
002403              THRU L17-EX                                         
002404           IF SQLCODE = +100                                      
002405              MOVE '*'           TO WSWERROR                      
002406              MOVE '00112'       TO MESS-CODERROR                 
002407              MOVE DFHUNIMD      TO LO60-RAGFATTUA                
002408              MOVE DFHRED        TO LO60-RAGFATTUC                
002409              MOVE -1            TO LO60-RAGFATTUL                
002410              GO TO C21-EX                                        
002411           ELSE                                                   
002412              MOVE A901-CODCLIEN TO LO60-CODCLIENI                
002413              MOVE A901-RAGFATTU TO LO60-RAGFATTUI.               
002414     IF LO60-DTINILISI > SPACES                                   
002415        MOVE LO60-DTINILISI      TO DTGG-DTRICHIE(1:6)            
002416        MOVE '01'                TO DTGG-DTRICHIE(7:2)            
002417        PERFORM SRDTGG                                            
002418           THRU SRDTGG-EX                                         
002419        IF DTGG-RETUCODE NOT = '****'                             
002420           MOVE '*'              TO WSWERROR                      
002421           MOVE '00006'          TO MESS-CODERROR                 
002422           MOVE DFHUNIMD         TO LO60-DTINILISA                
002423           MOVE DFHRED           TO LO60-DTINILISC                
002424           MOVE -1               TO LO60-DTINILISL                
002425           GO TO C21-EX.                                          
002426     IF LO60-DTFINLISI > SPACES                                   
002427        MOVE LO60-DTFINLISI      TO DTGG-DTRICHIE(1:6)            
002428        MOVE '01'                TO DTGG-DTRICHIE(7:2)            
002429        PERFORM SRDTGG                                            
002430           THRU SRDTGG-EX                                         
002431        IF DTGG-RETUCODE NOT = '****'                             
002432           MOVE '*'              TO WSWERROR                      
002433           MOVE '00006'          TO MESS-CODERROR                 
002434           MOVE DFHUNIMD         TO LO60-DTFINLISA                
002435           MOVE DFHRED           TO LO60-DTFINLISC                
002436           MOVE -1               TO LO60-DTFINLISL                
002437           GO TO C21-EX.                                          
002438     IF LO60-FLAGULTII NOT > SPACES                               
002439        MOVE 'S'                 TO LO60-FLAGULTIO.               
002440     IF LO60-FLAGULTII NOT = 'S' AND 'N'                          
002441        MOVE '*'                 TO WSWERROR                      
002442        MOVE '00920'             TO MESS-CODERROR                 
002443        MOVE DFHUNIMD            TO LO60-FLAGULTIA                
002444        MOVE DFHRED              TO LO60-FLAGULTIC                
002445        MOVE -1                  TO LO60-FLAGULTIL                
002446        GO TO C21-EX.                                             
002447 C21-EX. EXIT.                                                    
002448*----------------------------------------------------------------*
002449 C40-GESTIONE-RICEVI.                                             
002450*----------------------------------------------------------------*
002451     MOVE WCOM-PAGIRICH          TO WNUMITEM.                     
002452     PERFORM R00-READQ-WPAGCTRL                                   
002453        THRU R00-EX.                                              
002454     PERFORM F00-CONTROLLI                                        
002455        THRU F00-EX.                                              
002456     MOVE WS-OPERAZIO         TO WCOM-OPERAZIO                    
002457     IF ERRORE OR                                                 
002458        WS-OPERAZIO NOT > SPACES                                  
002459        GO TO C40-EX.                                             
002460     IF EIBAID = DFHPF10                                          
002461        PERFORM G00-AGGIORNAMENTI                                 
002462           THRU G00-EX                                            
002463     ELSE                                                         
002464        MOVE '00030'          TO MESS-CODERROR.                   
002465 C40-EX. EXIT.                                                    
002466*----------------------------------------------------------------*
002467 D00-GESTIONE-PF.                                                 
002468*----------------------------------------------------------------*
002469     IF EIBAID NOT = DFHPF1 AND                                   
002470        EIBAID NOT = DFHPF2 AND                                   
002471        EIBAID NOT = DFHPF7 AND                                   
002472        EIBAID NOT = DFHPF8                                       
002473        PERFORM D30-FUNZIONI-ESTERNE                              
002474           THRU D30-EX                                            
002475     ELSE                                                         
002476        IF WCOM-PAGIRICH > ZEROES                                 
002477           PERFORM D10-IMPOSTA-PAGINA                             
002478              THRU D10-EX                                         
002479           PERFORM E20-PAGINA-PRONTA                              
002480              THRU E20-EX                                         
002481        ELSE                                                      
002482           PERFORM U02-NORESP                                     
002483              THRU U02-EX.                                        
002484 D00-EX. EXIT.                                                    
002485*----------------------------------------------------------------*
002486 D10-IMPOSTA-PAGINA.                                              
002487*----------------------------------------------------------------*
002488                                                                  
002489* EXEC CICS RECEIVE MAP    (WNOMEMAP)                             
002490*                      MAPSET ('AVMLO60')                         
002491*                      INTO   (AVILO60I)                          
002492*                      END-EXEC.                                  
002493     MOVE LENGTH OF                                               
002494      AVILO60I                                                    
002495       TO DFHEIV11                                                
002496     MOVE 'AVMLO60' TO DFHEIV1                                    
002497*    MOVE '8"T I  L              ''   #00002399' TO DFHEIV0       
002498     MOVE X'382254204920204C20202020' &                           
002499          X'202020202020202020202720' &                           
002500          X'2020233030303032333939' TO DFHEIV0                    
002501     CALL 'kxdfhei1' USING DFHEIV0,                               
002502           WNOMEMAP,                                              
002503           AVILO60I,                                              
002504           DFHEIV11,                                              
002505           DFHEIV1,                                               
002506           DFHEIV99,                                              
002507           DFHEIV99                                               
002508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002509                                                                  
002510     EVALUATE EIBAID                                              
002511         WHEN DFHPF1                                              
002512              COMPUTE WPAGRICH = WCOM-PAGIRICH + 1                
002513         WHEN DFHPF2                                              
002514              COMPUTE WPAGRICH = WCOM-PAGIRICH - 1                
002515         WHEN DFHPF7                                              
002516              MOVE 1             TO WPAGRICH                      
002517         WHEN DFHPF8                                              
002518              MOVE WCOM-PAGIULTI TO WPAGRICH                      
002519     END-EVALUATE.                                                
002520 D10-EX. EXIT.                                                    
002521*----------------------------------------------------------------*
002522 D30-FUNZIONI-ESTERNE.                                            
002523*----------------------------------------------------------------*
002524     MOVE  '*'                   TO WCOM-DELETETS.                
002525                                                                  
002526* EXEC CICS LINK PROGRAM  ('WWTTIM15')                            
002527*                   COMMAREA (WCOM-AREAXXXX)                      
002528*                   LENGTH   (WCOM-LUNGHEZZ)                      
002529*                   END-EXEC.                                     
002530     MOVE 'WWTTIM15' TO DFHEIV1                                   
002531*    MOVE '."C                   (   #00002418' TO DFHEIV0        
002532     MOVE X'2E2243202020202020202020' &                           
002533          X'202020202020202020202820' &                           
002534          X'2020233030303032343138' TO DFHEIV0                    
002535     CALL 'kxdfhei1' USING DFHEIV0,                               
002536           DFHEIV1,                                               
002537           WCOM-AREAXXXX,                                         
002538           WCOM-LUNGHEZZ,                                         
002539           DFHEIV99,                                              
002540           DFHEIV99,                                              
002541           DFHEIV99,                                              
002542           DFHEIV99                                               
002543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002544                                                                  
002545     IF  WCOM-RETURNXX = '*'                                      
002546                                                                  
002547* EXEC CICS RETURN END-EXEC                                       
002548*    MOVE '.(                    ''   #00002423' TO DFHEIV0       
002549     MOVE X'2E2820202020202020202020' &                           
002550          X'202020202020202020202720' &                           
002551          X'2020233030303032343233' TO DFHEIV0                    
002552     CALL 'kxdfhei1' USING DFHEIV0,                               
002553           DFHEIV99,                                              
002554           DFHEIV99,                                              
002555           DFHEIV99,                                              
002556           DFHEIV99,                                              
002557           DFHEIV99,                                              
002558           DFHEIV99                                               
002559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
002560     ELSE                                                         
002561         PERFORM U00-RETURN-TRAN                                  
002562            THRU U00-EX.                                          
002563 D30-EX. EXIT.                                                    
002564*----------------------------------------------------------------*
002565 E10-PREPARA-PAGINE.                                              
002566*----------------------------------------------------------------*
002567     MOVE WCOM-CODCLIEN          TO L654-CODCLIEN                 
002568     MOVE WCOM-DTINILIS          TO L654-DTINILIS                 
002569     MOVE WCOM-DTFINLIS          TO L654-DTFINLIS                 
002570     MOVE WCOM-CODDIVIS          TO L654-CODDIVIS                 
002571     MOVE 'M'                    TO L654-TIPSERVI                 
002572     MOVE LOW-VALUE              TO MIN-CODCLIEN                  
002573                                    MIN-DTINILIS                  
002574                                    MIN-DTFINLIS                  
002575*    MOVE ALL '9'                TO MAX-CODCLIEN                  
002576     MOVE ALL 'Z'                TO MAX-CODCLIEN                  
002577                                    MAX-DTINILIS                  
002578                                    MAX-DTFINLIS                  
002579     IF WCOM-CODCLIEN > SPACES                                    
002580        MOVE WCOM-CODCLIEN       TO MIN-CODCLIEN                  
002581                                    MAX-CODCLIEN.                 
002582     IF WCOM-DTINILIS > SPACES                                    
002583        MOVE WCOM-DTINILIS       TO MIN-DTINILIS                  
002584                                    MAX-DTINILIS.                 
002585     IF WCOM-DTFINLIS > SPACES                                    
002586        MOVE WCOM-DTFINLIS       TO MIN-DTFINLIS                  
002587                                    MAX-DTFINLIS.                 
002588     PERFORM O00-OPEN-POINTER                                     
002589        THRU O00-EX.                                              
002590     PERFORM L00-FETCH-POINTER                                    
002591        THRU L00-EX.                                              
002592     PERFORM E13-PREPARA-TS                                       
002593        THRU E13-EX                                               
002594             UNTIL WS-SQLCODE = +100.                             
002595     PERFORM O10-CLOSE-POINTER                                    
002596        THRU O10-EX.                                              
002597     IF WCOM-PAGILIST > ZEROES                                    
002598        MOVE WCOM-PAGILIST       TO WCOM-PAGIULTI                 
002599        IF WCOM-PAGITRAN (WCOM-INDITRAN) > ZEROES                 
002600           MOVE WCOM-PAGITRAN (WCOM-INDITRAN)                     
002601                                 TO WPAGRICH                      
002602           MOVE ZEROES           TO WCOM-PAGITRAN (WCOM-INDITRAN) 
002603        ELSE                                                      
002604           MOVE 1                TO WPAGRICH                      
002605     ELSE                                                         
002606        PERFORM E99-PULISCI-MAPPA                                 
002607           THRU E99-EX                                            
002608        IF MESS-CODERROR NOT > SPACES                             
002609           MOVE '00002'          TO MESS-CODERROR.                
002610 E10-EX. EXIT.                                                    
002611*----------------------------------------------------------------*
002612 E13-PREPARA-TS.                                                  
002613*----------------------------------------------------------------*
002614     MOVE SPACES                 TO WPAGREFE.                     
002615     INITIALIZE                     WPAGREFE.                     
002616     MOVE 1                      TO WINDRIGA.                     
002617     PERFORM E14-RIGA-TS                                          
002618        THRU E14-EX                                               
002619             UNTIL WINDRIGA > WNUMRIGA                            
002620                OR WS-SQLCODE = +100.                             
002621     PERFORM R20-WRITEQ-WPAG                                      
002622        THRU R20-EX.                                              
002623 E13-EX. EXIT.                                                    
002624*----------------------------------------------------------------*
002625 E14-RIGA-TS.                                                     
002626*----------------------------------------------------------------*
002627     IF L654-CODCLIEN = WS-CODCLIEN AND                           
002628        L654-CODDIVIS = WS-CODDIVIS AND                           
002629        WCOM-FLAGULTI = 'S'                                       
002630        GO TO E14-LEGGI.                                          
002631     MOVE L654-CODCLIEN          TO WS-CODCLIEN                   
002632     MOVE L654-CODDIVIS          TO WS-CODDIVIS                   
002633     MOVE L654-CODCLIEN          TO WPAG-RCODCLIE(WINDRIGA)       
002634                                    A901-CODCLIEN                 
002635     PERFORM L15-SELECT-CLIENTI                                   
002636        THRU L15-EX                                               
002637     MOVE A901-RAGFATTU          TO WPAG-RRAGFATT(WINDRIGA).      
002638     MOVE L654-DTINILIS          TO WPAG-RDTINILI(WINDRIGA)       
002639     MOVE L654-DTFINLIS          TO WPAG-RDTFINLI(WINDRIGA)       
002640     MOVE L654-CODDIVIS          TO WPAG-RCODDIVI(WINDRIGA)       
002641                                    A963-CODDIVIS                 
002642     PERFORM L20-SELECT-DIVISE                                    
002643        THRU L20-EX                                               
002644     MOVE A963-SIGLADIV          TO WPAG-RSIGLADI(WINDRIGA)       
002645     ADD 1                       TO WINDRIGA.                     
002646 E14-LEGGI.                                                       
002647     PERFORM L00-FETCH-POINTER                                    
002648        THRU L00-EX.                                              
002649 E14-EX. EXIT.                                                    
002650*----------------------------------------------------------------*
002651 E20-PAGINA-PRONTA.                                               
002652*----------------------------------------------------------------*
002653     IF WCOM-PAGILIST = ZERO                                      
002654        GO TO E20-EX.                                             
002655     IF  WPAGRICH  LESS  1                                        
002656         MOVE 1                  TO WPAGRICH.                     
002657     IF  WPAGRICH  > WCOM-PAGIULTI                                
002658         MOVE WCOM-PAGIULTI      TO WPAGRICH.                     
002659     MOVE WPAGRICH               TO WCOM-PAGIRICH                 
002660     MOVE WPAGRICH               TO WNUMITEM                      
002661     PERFORM R00-READQ-WPAGCTRL                                   
002662        THRU R00-EX.                                              
002663     PERFORM E99-PULISCI-MAPPA                                    
002664        THRU E99-EX.                                              
002665     PERFORM E21-SPOSTA-IN-MAPPA                                  
002666        THRU E21-EX                                               
002667             VARYING WINDRIGA FROM 1 BY 1                         
002668               UNTIL WINDRIGA > WNUMRIGA                          
002669                  OR WPAG-RCODCLIE (WINDRIGA) NOT > SPACES.       
002670 E20-EX. EXIT.                                                    
002671*----------------------------------------------------------------*
002672 E21-SPOSTA-IN-MAPPA.                                             
002673*----------------------------------------------------------------*
002674     MOVE WPAG-RCODCLIE(WINDRIGA) TO LO60-RCODCLIEO(WINDRIGA).    
002675     MOVE WPAG-RRAGFATT(WINDRIGA) TO LO60-RRAGFATTO(WINDRIGA).    
002676     MOVE WPAG-RDTINILI(WINDRIGA) TO LO60-RDTINILIO(WINDRIGA).    
002677     MOVE WPAG-RDTFINLI(WINDRIGA) TO LO60-RDTFINLIO(WINDRIGA).    
002678     MOVE WPAG-RCODDIVI(WINDRIGA) TO LO60-RCODDIVIO(WINDRIGA).    
002679     MOVE WPAG-RSIGLADI(WINDRIGA) TO LO60-RSIGLADIO(WINDRIGA).    
002680 E21-EX. EXIT.                                                    
002681*----------------------------------------------------------------*
002682 E99-PULISCI-MAPPA.                                               
002683*----------------------------------------------------------------*
002684     PERFORM VARYING WINDRIGA FROM 1 BY 1                         
002685       UNTIL WINDRIGA > WNUMRIGA                                  
002686             MOVE LOW-VALUE      TO LO60-RIGAO(WINDRIGA)          
002687     END-PERFORM.                                                 
002688 E99-EX. EXIT.                                                    
002689*----------------------------------------------------------------*
002690 E30-INVIA-MAPPA.                                                 
002691*----------------------------------------------------------------*
002692     MOVE WCOM-PAGIRICH          TO WNUMITEM.                     
002693     PERFORM R00-READQ-WPAGCTRL                                   
002694        THRU R00-EX.                                              
002695     MOVE WCOM-DATAXXXX          TO LO60-MAPDATAO.                
002696     MOVE EIBTIME                TO LO60-MAPORAXO.                
002697     IF WCOM-PAGIULTI NOT = 99999                                 
002698        MOVE WCOM-PAGIULTI       TO LO60-MAPPPAGO                 
002699     ELSE                                                         
002700        MOVE ALL '*'             TO LO60-MAPPPAGI.                
002701     MOVE WCOM-PAGIRICH          TO LO60-MAPRPAGO.                
002702     IF MESS-CODERROR NOT > SPACES                                
002703        MOVE '00003'             TO MESS-CODERROR.                
002704     PERFORM U10-DECODIFICA-MESSAGGI                              
002705        THRU U10-EX.                                              
002706     IF NOT ERRORE                                                
002707        IF WCOM-PAGILIST NOT > ZEROS                              
002708           MOVE -1               TO LO60-CODCLIENL                
002709        ELSE                                                      
002710           MOVE -1               TO LO60-OPERAZIOL(1).            
002711     MOVE 'MAGAZZINO'            TO LO60-DTIPSERVO.               
002712     PERFORM P00-ATTRIBUTI-RIGA                                   
002713        THRU P00-EX                                               
002714             VARYING WINDRIGA FROM 1 BY 1                         
002715               UNTIL WINDRIGA > WNUMRIGA.                         
002716     IF WCOM-OPERAZIO NOT = 'D'                                   
002717        PERFORM P10-ATTRIBUTI-DUPLICAZIONE                        
002718           THRU P10-EX.                                           
002719                                                                  
002720* EXEC CICS SEND MAPSET ('AVMLO60')                               
002721*                   MAP    (WNOMEMAP)                             
002722*                   FROM   (AVILO60O)                             
002723*                   ERASE                                         
002724*                   CURSOR                                        
002725*                   END-EXEC.                                     
002726     MOVE LENGTH OF                                               
002727      AVILO60O                                                    
002728       TO DFHEIV12                                                
002729     MOVE -1                                                      
002730       TO DFHEIV11                                                
002731     MOVE 'AVMLO60' TO DFHEIV1                                    
002732*    MOVE '8$     CT  E      L F ,   #00002583' TO DFHEIV0        
002733     MOVE X'382420202020204354202045' &                           
002734          X'2020202020204C2046202C20' &                           
002735          X'2020233030303032353833' TO DFHEIV0                    
002736     CALL 'kxdfhei1' USING DFHEIV0,                               
002737           WNOMEMAP,                                              
002738           AVILO60O,                                              
002739           DFHEIV12,                                              
002740           DFHEIV1,                                               
002741           DFHEIV99,                                              
002742           DFHEIV99,                                              
002743           DFHEIV99,                                              
002744           DFHEIV11,                                              
002745           DFHEIV99,                                              
002746           DFHEIV99,                                              
002747           DFHEIV99                                               
002748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002749                                                                  
002750 E30-EX. EXIT.                                                    
002751*----------------------------------------------------------------*
002752 F00-CONTROLLI.                                                   
002753*----------------------------------------------------------------*
002754     MOVE SPACES                 TO WS-OPERAZIO.                  
002755     MOVE SPACES                 TO WCOM-OPERAZIO.                
002756     PERFORM F10-CTRL-OPERAZIONE                                  
002757        THRU F10-EX                                               
002758             VARYING WINDRIGA FROM 1 BY 1                         
002759               UNTIL WINDRIGA > WNUMRIGA                          
002760                  OR ERRORE.                                      
002761     PERFORM F30-CTRL-SELEZIONE                                   
002762        THRU F30-EX                                               
002763             VARYING WINDRIGA FROM 1 BY 1                         
002764               UNTIL WINDRIGA > WNUMRIGA                          
002765                  OR ERRORE.                                      
002766 F00-EX. EXIT.                                                    
002767*----------------------------------------------------------------*
002768 F10-CTRL-OPERAZIONE.                                             
002769*----------------------------------------------------------------*
002770     IF LO60-OPERAZIOI(WINDRIGA) NOT > SPACES                     
002771        GO TO F10-EX.                                             
002772     IF LO60-OPERAZIOI(WINDRIGA) NOT = 'V' AND                    
002773        LO60-OPERAZIOI(WINDRIGA) NOT = '/' AND                    
002774        LO60-OPERAZIOI(WINDRIGA) NOT = 'I' AND                    
002775        LO60-OPERAZIOI(WINDRIGA) NOT = 'D' AND                    
002776        LO60-OPERAZIOI(WINDRIGA) NOT = 'L'                        
002777        MOVE '*'                 TO WSWERROR                      
002778        MOVE '00004'             TO MESS-CODERROR                 
002779        MOVE DFHUNIMD            TO LO60-OPERAZIOA (WINDRIGA)     
002780        MOVE DFHRED              TO LO60-OPERAZIOC (WINDRIGA)     
002781        MOVE -1                  TO LO60-OPERAZIOL (WINDRIGA)     
002782        GO TO F10-EX                                              
002783     ELSE                                                         
002784        IF WS-OPERAZIO NOT > SPACES                               
002785           MOVE LO60-OPERAZIOI (WINDRIGA) TO WS-OPERAZIO          
002786        ELSE                                                      
002787           MOVE '*'              TO WSWERROR                      
002788           MOVE '00037'          TO MESS-CODERROR                 
002789           MOVE DFHUNIMD         TO LO60-OPERAZIOA (WINDRIGA)     
002790           MOVE DFHRED           TO LO60-OPERAZIOC (WINDRIGA)     
002791           MOVE -1               TO LO60-OPERAZIOL (WINDRIGA)     
002792           GO TO F10-EX.                                          
002793 F10-EX. EXIT.                                                    
002794*----------------------------------------------------------------*
002795 F30-CTRL-SELEZIONE.                                              
002796*----------------------------------------------------------------*
002797     IF LO60-OPERAZIOI(WINDRIGA) = 'I' OR 'V'                     
002798        PERFORM F40-CTRL-INSE-VAR                                 
002799           THRU F40-EX.                                           
002800     IF LO60-OPERAZIOI(WINDRIGA) = '/'                            
002801        PERFORM F50-CTRL-CANCELLA                                 
002802           THRU F50-EX.                                           
002803     IF LO60-OPERAZIOI(WINDRIGA) = 'D'                            
002804        PERFORM F60-CTRL-DUPLICAZIONE                             
002805           THRU F60-EX.                                           
002806     IF LO60-OPERAZIOI(WINDRIGA) = 'L'                            
002807        PERFORM F90-CTRL-VARIAZIONE                               
002808           THRU F90-EX.                                           
002809 F30-EX. EXIT.                                                    
002810*----------------------------------------------------------------*
002811 F40-CTRL-INSE-VAR.                                               
002812*----------------------------------------------------------------*
002813     MOVE WCOM-PAGIRICH          TO WCOM-PAGITRAN(WCOM-INDITRAN)  
002814     PERFORM SCRIVO-RICICLO                                       
002815        THRU SCRIVO-RICICLO-EX                                    
002816     IF LO60-OPERAZIOI(WINDRIGA) = 'V'                            
002817        MOVE WPAG-RCODCLIE(WINDRIGA) TO WCOM-CODCLIEN             
002818        MOVE SPACES                  TO WCOM-RAGFATTU             
002819        MOVE WPAG-RDTINILI(WINDRIGA) TO WCOM-DTINILIS             
002820        MOVE WPAG-RDTFINLI(WINDRIGA) TO WCOM-DTFINLIS             
002821        MOVE WPAG-RCODDIVI(WINDRIGA) TO WCOM-CODDIVIS             
002822     ELSE                                                         
002823        MOVE SPACES                  TO WCOM-CODCLIEN             
002824                                        WCOM-RAGFATTU             
002825                                        WCOM-DTINILIS             
002826                                        WCOM-DTFINLIS             
002827                                        WCOM-CODDIVIS.            
002828     MOVE 'LO50'                 TO WTRANSID                      
002829     PERFORM U05-START-TRANSID                                    
002830        THRU U05-EX.                                              
002831 F40-EX. EXIT.                                                    
002832*----------------------------------------------------------------*
002833 F50-CTRL-CANCELLA.                                               
002834*----------------------------------------------------------------*
002835     MOVE 'M'                        TO L652-TIPSERVI             
002836     MOVE '22'                       TO L652-CODSOCIE             
002837     MOVE WPAG-RCODCLIE(WINDRIGA)    TO L652-CODCLIEN             
002838     MOVE WPAG-RCODDIVI(WINDRIGA)    TO L652-CODDIVIS             
002839     MOVE WPAG-RDTINILI(WINDRIGA)    TO L654-DTINILIS             
002840     MOVE WPAG-RDTFINLI(WINDRIGA)    TO L654-DTFINLIS             
002841     PERFORM L50-SELECT-ORDILOGI                                  
002842        THRU L50-EX                                               
002843     IF SQLCODE = 0                                               
002844        MOVE '*'                  TO WSWERROR                     
002845        MOVE '00029'              TO MESS-CODERROR                
002846        MOVE DFHRED               TO LO60-OPERAZIOC(WINDRIGA)     
002847        MOVE DFHUNIMD             TO LO60-OPERAZIOA(WINDRIGA)     
002848        MOVE -1                   TO LO60-OPERAZIOL(WINDRIGA)     
002849        GO TO F50-EX.                                             
002850 F50-EX. EXIT.                                                    
002851*----------------------------------------------------------------*
002852 F60-CTRL-DUPLICAZIONE.                                           
002853*----------------------------------------------------------------*
002854     IF LO60-XCODCLIEO NOT > SPACES AND                           
002855        LO60-XRAGFATTO NOT > SPACES AND                           
002856        LO60-XDTINILIO NOT > SPACES AND                           
002857        LO60-XDTFINLIO NOT > SPACES                               
002858        MOVE WPAG-RCODCLIE(WINDRIGA) TO LO60-XCODCLIEO            
002859        MOVE WPAG-RRAGFATT(WINDRIGA) TO LO60-XRAGFATTO            
002860        MOVE WPAG-RDTINILI(WINDRIGA) TO LO60-XDTINILIO            
002861        MOVE WPAG-RDTFINLI(WINDRIGA) TO LO60-XDTFINLIO            
002862        MOVE WPAG-RCODDIVI(WINDRIGA) TO LO60-XCODDIVIO.           
002863     INSPECT LO60-XCODCLIEI REPLACING ALL LOW-VALUE BY SPACES     
002864     INSPECT LO60-XRAGFATTI REPLACING ALL LOW-VALUE BY SPACES     
002865     INSPECT LO60-XDTINILII REPLACING ALL LOW-VALUE BY SPACES     
002866     INSPECT LO60-XDTFINLII REPLACING ALL LOW-VALUE BY SPACES     
002867     INSPECT LO60-XCODDIVII REPLACING ALL LOW-VALUE BY SPACES     
002868     PERFORM F70-CTRL-CLIENTE                                     
002869        THRU F70-EX                                               
002870     IF ERRORE                                                    
002871        GO TO F60-EX.                                             
002872     PERFORM F80-CTRL-PERIODO                                     
002873        THRU F80-EX                                               
002874     IF ERRORE                                                    
002875        GO TO F60-EX.                                             
002876     IF WPAG-RCODCLIE(WINDRIGA) = LO60-XCODCLIEO AND              
002877        WPAG-RRAGFATT(WINDRIGA) = LO60-XRAGFATTO AND              
002878        WPAG-RDTINILI(WINDRIGA) = LO60-XDTINILIO AND              
002879        WPAG-RDTFINLI(WINDRIGA) = LO60-XDTFINLIO AND              
002880        WPAG-RCODDIVI(WINDRIGA) = LO60-XCODDIVIO                  
002881        MOVE '*'                  TO WSWERROR                     
002882        MOVE '00436'              TO MESS-CODERROR                
002883        MOVE DFHRED               TO LO60-XCODCLIEC               
002884                                     LO60-XDTINILIC               
002885                                     LO60-XDTFINLIC               
002886        MOVE DFHUNIMD             TO LO60-XCODCLIEA               
002887                                     LO60-XDTINILIA               
002888                                     LO60-XDTFINLIA               
002889        MOVE -1                   TO LO60-XCODCLIEL               
002890        GO TO F60-EX.                                             
002891     MOVE LO60-XCODCLIEI         TO L654-CODCLIEN                 
002892     MOVE 'M'                    TO L654-TIPSERVI                 
002893     MOVE LO60-XCODDIVII         TO L654-CODDIVIS                 
002894     PERFORM L30-SELECT-LISTILOGI                                 
002895        THRU L30-EX                                               
002896     IF LO60-XDTINILII NOT > WS-DTFINLIS OR                       
002897        LO60-XDTFINLII NOT > WS-DTFINLIS                          
002898        MOVE '*'                 TO WSWERROR                      
002899        MOVE '02249'             TO MESS-CODERROR                 
002900        MOVE DFHUNIMD            TO LO60-XDTINILIA                
002901        MOVE DFHUNIMD            TO LO60-XDTFINLIA                
002902        MOVE DFHRED              TO LO60-XDTINILIC                
002903        MOVE DFHRED              TO LO60-XDTFINLIC                
002904        MOVE -1                  TO LO60-XDTINILIL                
002905        GO TO F60-EX.                                             
002906 F60-EX. EXIT.                                                    
002907*---------------------------------------------------------------* 
002908 F70-CTRL-CLIENTE.                                                
002909*---------------------------------------------------------------* 
002910     MOVE WPAG-RCODCLIE(WINDRIGA) TO A901-CODCLIEN                
002911     PERFORM L15-SELECT-CLIENTI                                   
002912        THRU L15-EX                                               
002913     IF A901-CLIFOCON > SPACES                                    
002914        MOVE A901-CLIFOCON       TO A531-CODFORNI                 
002915        PERFORM L10-SELECT-SOCIETA                                
002916           THRU L10-EX                                            
002917        MOVE A531-CODSOCIE       TO WS-CODSOCIE                   
002918     ELSE                                                         
002919        MOVE A901-CODSOCIE       TO WS-CODSOCIE.                  
002920     IF LO60-XCODCLIEI NOT > SPACES AND                           
002921        LO60-XRAGFATTI NOT > SPACES                               
002922        MOVE '*'                 TO WSWERROR                      
002923        MOVE '00112'             TO MESS-CODERROR                 
002924        MOVE DFHUNIMD            TO LO60-XCODCLIEA                
002925                                    LO60-XRAGFATTA                
002926        MOVE DFHRED              TO LO60-XCODCLIEC                
002927                                    LO60-XRAGFATTC                
002928        MOVE -1                  TO LO60-XCODCLIEL                
002929        GO TO F70-EX.                                             
002930     IF LO60-XCODCLIEI > SPACES                                   
002931        MOVE SPACES              TO LO60-XRAGFATTI                
002932        MOVE +5                  TO WLENGTH                       
002933        CALL WWTWSNU USING WLENGTH LO60-XCODCLIEI                 
002934        MOVE LO60-XCODCLIEI      TO A901-CODCLIEN                 
002935        PERFORM L15-SELECT-CLIENTI                                
002936           THRU L15-EX                                            
002937        IF SQLCODE = +100                                         
002938           MOVE '*'              TO WSWERROR                      
002939           MOVE '00112'          TO MESS-CODERROR                 
002940           MOVE DFHUNIMD         TO LO60-XCODCLIEA                
002941           MOVE DFHRED           TO LO60-XCODCLIEC                
002942           MOVE -1               TO LO60-XCODCLIEL                
002943           GO TO F70-EX                                           
002944        ELSE                                                      
002945           MOVE A901-RAGFATTU    TO LO60-XRAGFATTO                
002946           MOVE A901-CODDIVIS    TO LO60-XCODDIVIO                
002947                                    A963-CODDIVIS                 
002948           PERFORM L20-SELECT-DIVISE                              
002949              THRU L20-EX                                         
002950           MOVE A963-SIGLADIV    TO LO60-XSIGLADIO                
002951        END-IF                                                    
002952     ELSE                                                         
002953        IF LO60-XRAGFATTI > SPACES                                
002954           MOVE LO60-XRAGFATTI   TO WCOM-RAGFATT3                 
002955           MOVE 'D'              TO WCOM-OPERAZIO                 
002956           PERFORM L17-SELECT-RAGFATTU                            
002957              THRU L17-EX                                         
002958           IF SQLCODE = +100                                      
002959              MOVE '*'           TO WSWERROR                      
002960              MOVE '00112'       TO MESS-CODERROR                 
002961              MOVE DFHUNIMD      TO LO60-XRAGFATTA                
002962              MOVE DFHRED        TO LO60-XRAGFATTC                
002963              MOVE -1            TO LO60-XRAGFATTL                
002964              GO TO F70-EX                                        
002965           ELSE                                                   
002966              MOVE A901-CODCLIEN TO LO60-XCODCLIEI                
002967              MOVE A901-RAGFATTU TO LO60-XRAGFATTI                
002968              MOVE A901-CODDIVIS TO LO60-XCODDIVIO                
002969                                    A963-CODDIVIS                 
002970              PERFORM L20-SELECT-DIVISE                           
002971                 THRU L20-EX                                      
002972              MOVE A963-SIGLADIV TO LO60-XSIGLADIO.               
002973     IF A901-CLIFOCON > SPACES                                    
002974        MOVE A901-CLIFOCON       TO A531-CODFORNI                 
002975        PERFORM L10-SELECT-SOCIETA                                
002976           THRU L10-EX                                            
002977        MOVE A531-CODSOCIE       TO WS-CODSOCI1                   
002978     ELSE                                                         
002979        MOVE A901-CODSOCIE       TO WS-CODSOCI1.                  
002980     IF WS-CODSOCI1 = '09' OR '24' OR '25'                        
002981        MOVE '15'                TO WS-CODSOCI1.                  
002982     IF WS-CODSOCIE = '09' OR '24' OR '25'                        
002983        MOVE '15'                TO WS-CODSOCIE.                  
002984     IF WS-CODSOCI1 = '08'                                        
002985        MOVE '16'                TO WS-CODSOCI1.                  
002986     IF WS-CODSOCIE = '08'                                        
002987        MOVE '16'                TO WS-CODSOCIE.                  
002988     IF WS-CODSOCIE NOT = WS-CODSOCI1                             
002989        MOVE '*'                 TO WSWERROR                      
002990        MOVE '02492'             TO MESS-CODERROR                 
002991        MOVE DFHUNIMD            TO LO60-XCODCLIEA                
002992        MOVE DFHRED              TO LO60-XCODCLIEC                
002993        MOVE -1                  TO LO60-XCODCLIEL                
002994        GO TO F70-EX.                                             
002995 F70-EX. EXIT.                                                    
002996*---------------------------------------------------------------* 
002997 F80-CTRL-PERIODO.                                                
002998*---------------------------------------------------------------* 
002999     IF LO60-XDTINILII NOT > SPACES                               
003000        MOVE '*'                 TO WSWERROR                      
003001        MOVE '00006'             TO MESS-CODERROR                 
003002        MOVE DFHUNIMD            TO LO60-XDTINILIA                
003003        MOVE DFHRED              TO LO60-XDTINILIC                
003004        MOVE -1                  TO LO60-XDTINILIL                
003005        GO TO F80-EX                                              
003006     ELSE                                                         
003007        MOVE LO60-XDTINILII      TO DTGG-DTRICHIE(1:6)            
003008        MOVE '01'                TO DTGG-DTRICHIE(7:2)            
003009        PERFORM SRDTGG                                            
003010           THRU SRDTGG-EX                                         
003011        IF DTGG-RETUCODE NOT = '****'                             
003012           MOVE '*'              TO WSWERROR                      
003013           MOVE '00006'          TO MESS-CODERROR                 
003014           MOVE DFHUNIMD         TO LO60-XDTINILIA                
003015           MOVE DFHRED           TO LO60-XDTINILIC                
003016           MOVE -1               TO LO60-XDTINILIL                
003017           GO TO F80-EX.                                          
003018     IF LO60-XDTFINLII NOT > SPACES                               
003019        MOVE '*'                 TO WSWERROR                      
003020        MOVE '00006'             TO MESS-CODERROR                 
003021        MOVE DFHUNIMD            TO LO60-XDTFINLIA                
003022        MOVE DFHRED              TO LO60-XDTFINLIC                
003023        MOVE -1                  TO LO60-XDTFINLIL                
003024        GO TO F80-EX                                              
003025     ELSE                                                         
003026        MOVE LO60-XDTFINLII      TO DTGG-DTRICHIE(1:6)            
003027        MOVE '01'                TO DTGG-DTRICHIE(7:2)            
003028        PERFORM SRDTGG                                            
003029           THRU SRDTGG-EX                                         
003030        IF DTGG-RETUCODE NOT = '****'                             
003031           MOVE '*'              TO WSWERROR                      
003032           MOVE '00006'          TO MESS-CODERROR                 
003033           MOVE DFHUNIMD         TO LO60-XDTFINLIA                
003034           MOVE DFHRED           TO LO60-XDTFINLIC                
003035           MOVE -1               TO LO60-XDTFINLIL                
003036           GO TO F80-EX.                                          
003037     IF LO60-XDTINILII > LO60-XDTFINLII                           
003038        MOVE '*'                 TO WSWERROR                      
003039        MOVE '00053'             TO MESS-CODERROR                 
003040        MOVE DFHUNIMD            TO LO60-XDTFINLIA                
003041                                    LO60-XDTINILIA                
003042        MOVE DFHRED              TO LO60-XDTFINLIC                
003043                                    LO60-XDTINILIC                
003044        MOVE -1                  TO LO60-XDTFINLIL                
003045        GO TO F80-EX.                                             
003046 F80-EX. EXIT.                                                    
003047*---------------------------------------------------------------* 
003048 F90-CTRL-VARIAZIONE.                                             
003049*---------------------------------------------------------------* 
003050     IF LO60-RDTFINLII(WINDRIGA) NOT > SPACES                     
003051        MOVE '*'                 TO WSWERROR                      
003052        MOVE '00006'             TO MESS-CODERROR                 
003053        MOVE DFHUNIMD            TO LO60-RDTFINLIA(WINDRIGA)      
003054        MOVE DFHRED              TO LO60-RDTFINLIC(WINDRIGA)      
003055        MOVE -1                  TO LO60-RDTFINLIL(WINDRIGA)      
003056        GO TO F90-EX                                              
003057     ELSE                                                         
003058        MOVE LO60-RDTFINLII(WINDRIGA) TO DTGG-DTRICHIE(1:6)       
003059        MOVE '01'                TO DTGG-DTRICHIE(7:2)            
003060        PERFORM SRDTGG                                            
003061           THRU SRDTGG-EX                                         
003062        IF DTGG-RETUCODE NOT = '****'                             
003063           MOVE '*'              TO WSWERROR                      
003064           MOVE '00006'          TO MESS-CODERROR                 
003065           MOVE DFHUNIMD         TO LO60-RDTFINLIA(WINDRIGA)      
003066           MOVE DFHRED           TO LO60-RDTFINLIC(WINDRIGA)      
003067           MOVE -1               TO LO60-RDTFINLIL(WINDRIGA)      
003068           GO TO F90-EX.                                          
003069     IF LO60-RDTINILII(WINDRIGA) > LO60-RDTFINLII(WINDRIGA)       
003070        MOVE '*'                 TO WSWERROR                      
003071        MOVE '00053'             TO MESS-CODERROR                 
003072        MOVE DFHUNIMD            TO LO60-RDTFINLIA(WINDRIGA)      
003073        MOVE DFHRED              TO LO60-RDTFINLIC(WINDRIGA)      
003074        MOVE -1                  TO LO60-RDTFINLIL(WINDRIGA)      
003075        GO TO F90-EX.                                             
003076     MOVE LO60-RCODCLIEI(WINDRIGA) TO L654-CODCLIEN               
003077     MOVE 'M'                      TO L654-TIPSERVI               
003078     MOVE LO60-RCODDIVII(WINDRIGA) TO L654-CODDIVIS               
003079     MOVE WPAG-RDTFINLI (WINDRIGA) TO L654-DTFINLIS               
003080     PERFORM L40-SELECT-LISTILOGI                                 
003081        THRU L40-EX                                               
003082     IF WS-DTINILIS > SPACES                                      
003083        IF LO60-RDTFINLII(WINDRIGA) NOT < WS-DTINILIS             
003084           MOVE '*'              TO WSWERROR                      
003085           MOVE '02249'          TO MESS-CODERROR                 
003086           MOVE DFHUNIMD         TO LO60-RDTFINLIA(WINDRIGA)      
003087           MOVE DFHRED           TO LO60-RDTFINLIC(WINDRIGA)      
003088           MOVE -1               TO LO60-RDTFINLIL(WINDRIGA)      
003089           GO TO F90-EX.                                          
003090 F90-EX. EXIT.                                                    
003091*---------------------------------------------------------------* 
003092 G00-AGGIORNAMENTI.                                               
003093*---------------------------------------------------------------* 
003094     PERFORM G10-SCORRI-RIGHE                                     
003095        THRU G10-EX                                               
003096           VARYING WINDRIGA FROM 1 BY 1                           
003097             UNTIL WINDRIGA > WNUMRIGA.                           
003098     PERFORM U20-DELETE-TS                                        
003099        THRU U20-EX.                                              
003100     MOVE WCOM-PAGIRICH          TO WCOM-PAGITRAN(WCOM-INDITRAN). 
003101     MOVE 99999                  TO WCOM-PAGIULTI.                
003102     MOVE ZERO                   TO WCOM-PAGIRICH                 
003103                                    WCOM-PAGILIST                 
003104                                    WPAGRICH.                     
003105     PERFORM E10-PREPARA-PAGINE                                   
003106        THRU E10-EX.                                              
003107     PERFORM E20-PAGINA-PRONTA                                    
003108        THRU E20-EX.                                              
003109     MOVE '00005'                TO MESS-CODERROR.                
003110     MOVE SPACES                 TO WCOM-OPERAZIO.                
003111 G00-EX. EXIT.                                                    
003112*---------------------------------------------------------------* 
003113 G10-SCORRI-RIGHE.                                                
003114*---------------------------------------------------------------* 
003115     IF LO60-OPERAZIOI(WINDRIGA) NOT > SPACES                     
003116        GO TO G10-EX.                                             
003117     IF LO60-OPERAZIOI(WINDRIGA) = 'D'                            
003118        PERFORM G20-DUPLICAZIONE                                  
003119           THRU G20-EX.                                           
003120     IF LO60-OPERAZIOI(WINDRIGA) = '/'                            
003121        PERFORM G40-DELETE-LISTILOGI                              
003122           THRU G40-EX.                                           
003123     IF LO60-OPERAZIOI(WINDRIGA) = 'L'                            
003124        PERFORM G50-UPDATE-LISTILOGI                              
003125           THRU G50-EX.                                           
003126 G10-EX. EXIT.                                                    
003127*---------------------------------------------------------------* 
003128 G20-DUPLICAZIONE.                                                
003129*---------------------------------------------------------------* 
003130     MOVE 'M'                      TO WS-TIPSERVI                 
003131     MOVE WPAG-RCODCLIE(WINDRIGA)  TO WS-CODCLIEN                 
003132     MOVE WPAG-RDTINILI(WINDRIGA)  TO WS-DTINILIS                 
003133     MOVE WPAG-RDTFINLI(WINDRIGA)  TO WS-DTFINLIS                 
003134     MOVE WPAG-RCODDIVI(WINDRIGA)  TO WS-CODDIVIS                 
003135     PERFORM O20-OPEN-POINTER2                                    
003136        THRU O20-EX.                                              
003137     PERFORM L05-FETCH-POINTER2                                   
003138        THRU L05-EX.                                              
003139     PERFORM UNTIL SQLCODE = +100                                 
003140        MOVE LO60-XCODCLIEO      TO L654-CODCLIEN                 
003141        MOVE LO60-XDTINILIO      TO L654-DTINILIS                 
003142        MOVE LO60-XDTFINLIO      TO L654-DTFINLIS                 
003143        MOVE LO60-XCODDIVIO      TO L654-CODDIVIS                 
003144        MOVE WCOM-DTCREAZI       TO L654-DTCREAZI                 
003145                                    L654-DTULTVAR                 
003146        MOVE WCOM-UTENCICS       TO L654-CODUTVAR                 
003147        PERFORM G30-INSERT-LISTILOGI                              
003148           THRU G30-EX                                            
003149        PERFORM L05-FETCH-POINTER2                                
003150           THRU L05-EX                                            
003151     END-PERFORM.                                                 
003152     PERFORM O30-CLOSE-POINTER2                                   
003153        THRU O30-EX.                                              
003154 G20-EX. EXIT.                                                    
003155*---------------------------------------------------------------* 
003156 G30-INSERT-LISTILOGI.                                            
003157*---------------------------------------------------------------* 
003158     MOVE 'G30-'                   TO WCOM-CODABEND.              
003159     MOVE 'INSERT'                 TO WCOM-FILEFUNZ.              
003160     MOVE 'LISTILOGI'              TO WCOM-FILENOME.              
003161     MOVE SPACES                   TO WCOM-FILECTRL.              
003162     STRING L654-CODCLIEN ' ' L654-DTINILIS ' '                   
003163            L654-DTFINLIS ' ' L654-TIPSERVI ' '                   
003164            L654-CODSERVI ' ' L654-CODDIVIS                       
003165        DELIMITED BY SIZE        INTO WCOM-FILECTRL.              
003167     
      *EXEC SQL 
      *INSERT INTO DLOGISTI.TLISTILOGI                         
003168*                (CODCLIEN                                         
003169*                ,DTINILIS                                         
003170*                ,DTFINLIS                                         
003171*                ,CODSERVI                                         
003172*                ,TIPSERVI                                         
003173*                ,CODDIVIS                                         
003174*                ,PREZZLIS                                         
003175*                ,PERCLIST                                         
003176*                ,DTCREAZI                                         
003177*                ,DTULTVAR                                         
003178*                ,CODUTVAR)                                        
003179*          VALUES                                                  
003180*                (:L654-CODCLIEN                                   
003181*                ,:L654-DTINILIS                                   
003182*                ,:L654-DTFINLIS                                   
003183*                ,:L654-CODSERVI                                   
003184*                ,:L654-TIPSERVI                                   
003185*                ,:L654-CODDIVIS                                   
003186*                ,:L654-PREZZLIS                                   
003187*                ,:L654-PERCLIST                                   
003188*                ,:L654-DTCREAZI                                   
003189*                ,:L654-DTULTVAR                                   
003190*                ,:L654-CODUTVAR)                                  
003191*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 3 TO SQL-STMT-ID 
           MOVE 11 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODCLIEN
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTINILIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTFINLIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODSERVI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-TIPSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODDIVIS
            BY VALUE 0
                     0

           MOVE 1035 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-PREZZLIS
            BY VALUE 0
                     0

           MOVE 517 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-PERCLIST
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTCREAZI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTULTVAR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODUTVAR
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 5 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003192     IF SQLCODE NOT = 0                                           
003193        PERFORM Z00-ERRORE                                        
003194           THRU Z00-EX.                                           
003195 G30-EX. EXIT.                                                    
003196*---------------------------------------------------------------* 
003197 G40-DELETE-LISTILOGI.                                            
003198*---------------------------------------------------------------* 
003199     MOVE 'M'                      TO L654-TIPSERVI.              
003200     MOVE WPAG-RCODCLIE(WINDRIGA)  TO L654-CODCLIEN.              
003201     MOVE WPAG-RCODDIVI(WINDRIGA)  TO L654-CODDIVIS.              
003202     MOVE WPAG-RDTINILI(WINDRIGA)  TO L654-DTINILIS.              
003203     MOVE WPAG-RDTFINLI(WINDRIGA)  TO L654-DTFINLIS.              
003204     MOVE 'G40-'                   TO WCOM-CODABEND.              
003205     MOVE 'DELETE'                 TO WCOM-FILEFUNZ.              
003206     MOVE 'LISTILOGI'              TO WCOM-FILENOME.              
003207     MOVE SPACES                   TO WCOM-FILECTRL.              
003208     STRING L654-CODCLIEN ' ' L654-DTINILIS ' '                   
003209            L654-DTFINLIS ' ' L654-TIPSERVI ' '                   
003210            L654-CODDIVIS                                         
003211        DELIMITED BY SIZE        INTO WCOM-FILECTRL.              
003213     
      *EXEC SQL 
      *DELETE FROM DLOGISTI.TLISTILOGI                         
003214*           WHERE CODCLIEN = :L654-CODCLIEN                        
003215*             AND DTINILIS = :L654-DTINILIS                        
003216*             AND DTFINLIS = :L654-DTFINLIS                        
003217*             AND TIPSERVI = :L654-TIPSERVI                        
003218*             AND CODDIVIS = :L654-CODDIVIS                        
003219*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 4 TO SQL-STMT-ID 
           MOVE 5 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODCLIEN
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTINILIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTFINLIS
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-TIPSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODDIVIS
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 6 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003220     IF SQLCODE NOT = 0                                           
003221        PERFORM Z00-ERRORE                                        
003222           THRU Z00-EX.                                           
003223 G40-EX. EXIT.                                                    
003224*---------------------------------------------------------------* 
003225 G50-UPDATE-LISTILOGI.                                            
003226*---------------------------------------------------------------* 
003227     MOVE 'M'                      TO L654-TIPSERVI.              
003228     MOVE WPAG-RCODCLIE(WINDRIGA)  TO L654-CODCLIEN.              
003229     MOVE WPAG-RCODDIVI(WINDRIGA)  TO L654-CODDIVIS.              
003230     MOVE WPAG-RDTINILI(WINDRIGA)  TO L654-DTINILIS.              
003231     MOVE WPAG-RDTFINLI(WINDRIGA)  TO L654-DTFINLIS.              
003232     MOVE LO60-RDTFINLII(WINDRIGA) TO WS-DTFINLIS                 
003233     MOVE WCOM-DTCREAZI            TO L654-DTULTVAR               
003234     MOVE WCOM-UTENCICS            TO L654-CODUTVAR               
003235     MOVE 'G50-'                   TO WCOM-CODABEND.              
003236     MOVE 'DELETE'                 TO WCOM-FILEFUNZ.              
003237     MOVE 'LISTILOGI'              TO WCOM-FILENOME.              
003238     MOVE SPACES                   TO WCOM-FILECTRL.              
003239     STRING L654-CODCLIEN ' ' L654-DTINILIS ' '                   
003240            L654-DTFINLIS ' ' L654-TIPSERVI ' '                   
003241            L654-CODDIVIS                                         
003242        DELIMITED BY SIZE        INTO WCOM-FILECTRL.              
003244     
      *EXEC SQL 
      *UPDATE DLOGISTI.TLISTILOGI                              
003245*             SET DTFINLIS = :WS-DTFINLIS                          
003246*                ,CODUTVAR = :L654-CODUTVAR                        
003247*                ,DTULTVAR = :L654-DTULTVAR                        
003248*           WHERE CODCLIEN = :L654-CODCLIEN                        
003249*             AND DTINILIS = :L654-DTINILIS                        
003250*             AND DTFINLIS = :L654-DTFINLIS                        
003251*             AND TIPSERVI = :L654-TIPSERVI                        
003252*             AND CODDIVIS = :L654-CODDIVIS                        
003253*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 5 TO SQL-STMT-ID 
           MOVE 8 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DTFINLIS
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODUTVAR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTULTVAR
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODCLIEN
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTINILIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTFINLIS
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-TIPSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODDIVIS
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 7 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003254     IF SQLCODE NOT = 0                                           
003255        PERFORM Z00-ERRORE                                        
003256           THRU Z00-EX.                                           
003257 G50-EX. EXIT.                                                    
003258*---------------------------------------------------------------* 
003259 L00-FETCH-POINTER.                                               
003260*---------------------------------------------------------------* 
003261     MOVE 'L00-'                 TO WCOM-CODABEND.                
003262     MOVE 'FETCH'                TO WCOM-FILEFUNZ.                
003263     MOVE 'POINTER1'             TO WCOM-FILENOME                 
003264     MOVE SPACES                 TO WCOM-FILECTRL.                
003265     STRING L654-CODCLIEN ' ' L654-DTINILIS ' '                   
003266            L654-DTFINLIS ' ' L654-CODDIVIS                       
003267       DELIMITED BY SIZE       INTO WCOM-FILECTRL.                
003269     
      *EXEC SQL 
      *FETCH POINTER1                                         
003270*            INTO :L654-CODCLIEN, :L654-DTINILIS                   
003271*                ,:L654-DTFINLIS, :L654-CODDIVIS                   
003272*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 6 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODCLIEN
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTINILIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTFINLIS
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODDIVIS
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
003273     MOVE SQLCODE                TO WS-SQLCODE.                   
003274     IF SQLCODE NOT = 0 AND +100                                  
003275        PERFORM Z00-ERRORE                                        
003276           THRU Z00-EX.                                           
003277 L00-EX. EXIT.                                                    
003278*----------------------------------------------------------------*
003279 L01-FETCH-POINTPF13.                                             
003280*----------------------------------------------------------------*
003281     MOVE 'L01-'                 TO WCOM-CODABEND.                
003282     MOVE 'FETCH'                TO WCOM-FILEFUNZ.                
003283     MOVE 'POINTPF13'            TO WCOM-FILENOME.                
003284     MOVE SPACES                 TO WCOM-FILECTRL.                
003285     STRING WS-CODCLIEN ' ' WS-RAGFATTU                           
003286        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
003288     
      *EXEC SQL 
      *FETCH POINTPF13                                         
003289*           INTO :A901-CODCLIEN, :A901-RAGFATTU                    
003290*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 7 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODCLIEN
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-RAGFATTU
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003291     IF SQLCODE NOT = ZEROES AND +100                             
003292        PERFORM Z00-ERRORE                                        
003293           THRU Z00-EX.                                           
003294     MOVE SQLCODE                TO WS-SQLCODE2.                  
003295 L01-EX. EXIT.                                                    
003296*----------------------------------------------------------------*
003297 L02-FETCH-POINTPF14.                                             
003298*----------------------------------------------------------------*
003299     MOVE 'L02-'                 TO WCOM-CODABEND.                
003300     MOVE 'FETCH'                TO WCOM-FILEFUNZ.                
003301     MOVE 'POINTPF14'            TO WCOM-FILENOME.                
003302     MOVE SPACES                 TO WCOM-FILECTRL.                
003303     STRING WS-CODCLIEN ' ' WS-RAGFATTU                           
003304        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
003306     
      *EXEC SQL 
      *FETCH POINTPF14                                         
003307*           INTO :A901-CODCLIEN, :A901-RAGFATTU                    
003308*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 8 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODCLIEN
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-RAGFATTU
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 4 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003309     IF SQLCODE NOT = ZEROES AND +100                             
003310        PERFORM Z00-ERRORE                                        
003311           THRU Z00-EX.                                           
003312     MOVE SQLCODE                TO WS-SQLCODE2.                  
003313 L02-EX. EXIT.                                                    
003314*---------------------------------------------------------------* 
003315 L05-FETCH-POINTER2.                                              
003316*---------------------------------------------------------------* 
003317     MOVE 'L05-'                 TO WCOM-CODABEND.                
003318     MOVE 'FETCH'                TO WCOM-FILEFUNZ.                
003319     MOVE 'POINTER2'             TO WCOM-FILENOME                 
003320     MOVE SPACES                 TO WCOM-FILECTRL.                
003321     STRING WS-TIPSERVI ' '                                       
003322            WS-CODCLIEN ' '                                       
003323            WS-DTINILIS ' '                                       
003324            WS-DTFINLIS ' '                                       
003325            WS-CODDIVIS                                           
003326       DELIMITED BY SIZE       INTO WCOM-FILECTRL.                
003328     
      *EXEC SQL 
      *FETCH POINTER2                                         
003329*            INTO :L654-CODSERVI, :L654-PREZZLIS                   
003330*                ,:L654-PERCLIST, :L654-TIPSERVI                   
003331*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 9 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODSERVI
            BY VALUE 0
                     0

           MOVE 1035 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-PREZZLIS
            BY VALUE 0
                     0

           MOVE 517 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-PERCLIST
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-TIPSERVI
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
003332     IF SQLCODE NOT = 0 AND +100                                  
003333        PERFORM Z00-ERRORE                                        
003334           THRU Z00-EX.                                           
003335 L05-EX. EXIT.                                                    
003336*---------------------------------------------------------------* 
003337 L10-SELECT-SOCIETA.                                              
003338*---------------------------------------------------------------* 
003339     MOVE 'L10-'                 TO WCOM-CODABEND.                
003340     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003341     MOVE 'TSOCIETA'             TO WCOM-FILENOME.                
003342     MOVE A531-CODFORNI          TO WCOM-FILECTRL.                
003344     
      *EXEC SQL 
      *SELECT CODSOCIE                                         
003345*            INTO :A531-CODSOCIE                                   
003346*            FROM DANAGRAF.TSOCIETA                                
003347*           WHERE CODFORNI = :A531-CODFORNI                        
003348*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 10 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODFORNI
            BY VALUE 0
                     0

           MOVE 11 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 8 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003349     IF SQLCODE NOT = 0                                           
003350        PERFORM Z00-ERRORE                                        
003351           THRU Z00-EX.                                           
003352 L10-EX. EXIT.                                                    
003353*---------------------------------------------------------------* 
003354 L15-SELECT-CLIENTI.                                              
003355*---------------------------------------------------------------* 
003356     MOVE 'L15-'                 TO WCOM-CODABEND.                
003357     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003358     MOVE 'CLIENTI'              TO WCOM-FILENOME.                
003359     MOVE A901-CODCLIEN          TO WCOM-FILECTRL.                
003360     MOVE SPACES                 TO A901-CODSOCIE.                
003361     MOVE ALL '?'                TO A901-RAGFATTU.                
003363     
      *EXEC SQL 
      *SELECT CODSOCIE, RAGFATTU                               
003364*                ,CLIFOCON, CODDIVIS                               
003365*            INTO :A901-CODSOCIE, :A901-RAGFATTU                   
003366*                ,:A901-CLIFOCON, :A901-CODDIVIS                   
003367*            FROM DANAGRAF.TCLIENTI                                
003368*           WHERE CODCLIEN = :A901-CODCLIEN                        
003369*             AND CODSOCIE = '22'                                  
003370*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 12 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODCLIEN
            BY VALUE 0
                     0

           MOVE 13 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODSOCIE
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-RAGFATTU
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CLIFOCON
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODDIVIS
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 9 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003371     IF SQLCODE NOT = 0 AND +100                                  
003372        PERFORM Z00-ERRORE                                        
003373           THRU Z00-EX.                                           
003374 L15-EX. EXIT.                                                    
003375*---------------------------------------------------------------* 
003376 L17-SELECT-RAGFATTU.                                             
003377*---------------------------------------------------------------* 
003378     PERFORM C17-DESCRIZIONE-MAPPA                                
003379        THRU C17-EX.                                              
003380     MOVE 'L17-'                 TO WCOM-CODABEND.                
003381     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003382     MOVE 'CLIENTI'              TO WCOM-FILENOME.                
003383     MOVE WS-RAGFATTU            TO WCOM-FILECTRL.                
003384     MOVE SPACES                 TO A901-CODSOCIE.                
003385     MOVE SPACES                 TO A901-CODCLIEN.                
003386     MOVE ALL '?'                TO A901-RAGFATTU.                
003388     
      *EXEC SQL 
      *SELECT CODCLIEN, RAGFATTU                               
003389*                ,CLIFOCON, CODSOCIE                               
003390*                ,CODDIVIS                                         
003391*            INTO :A901-CODCLIEN, :A901-RAGFATTU                   
003392*                ,:A901-CLIFOCON, :A901-CODSOCIE                   
003393*                ,:A901-CODDIVIS                                   
003394*            FROM DANAGRAF.TCLIENTI                                
003395*           WHERE RAGFATTU LIKE :WS-RAGFATTU                       
003396*             AND CODSOCIE = '22'                                  
003397*          ORDER BY 1                                              
003398*          FETCH FIRST ROW ONLY                                    
003399*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 14 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-RAGFATTU
            BY VALUE 0
                     0

           MOVE 15 TO SQL-STMT-ID 
           MOVE 5 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODCLIEN
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-RAGFATTU
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CLIFOCON
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODSOCIE
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODDIVIS
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 10 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003400     IF SQLCODE NOT = 0 AND +100                                  
003401        PERFORM Z00-ERRORE                                        
003402           THRU Z00-EX.                                           
003403 L17-EX. EXIT.                                                    
003404*----------------------------------------------------------------*
003405 L20-SELECT-DIVISE.                                               
003406*----------------------------------------------------------------*
003407     MOVE 'L20-'                 TO WCOM-CODABEND.                
003408     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003409     MOVE 'DIVISE'               TO WCOM-FILENOME.                
003410     MOVE A963-CODDIVIS          TO WCOM-FILECTRL.                
003412     
      *EXEC SQL 
      *SELECT DISTINCT SIGLADIV                               
003413*             INTO :A963-SIGLADIV                                  
003414*             FROM DANAGRAF.TDIVISE                                
003415*            WHERE CODDIVIS = :A963-CODDIVIS                       
003416*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 16 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A963-CODDIVIS
            BY VALUE 0
                     0

           MOVE 17 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A963-SIGLADIV
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 11 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003417     IF SQLCODE NOT = ZEROES AND +100                             
003418        PERFORM Z00-ERRORE                                        
003419           THRU Z00-EX.                                           
003420 L20-EX. EXIT.                                                    
003421*---------------------------------------------------------------* 
003422 L30-SELECT-LISTILOGI.                                            
003423*---------------------------------------------------------------* 
003424     MOVE 'L30-'                 TO WCOM-CODABEND.                
003425     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003426     MOVE 'LISTILOGI'            TO WCOM-FILENOME.                
003427     MOVE SPACES                 TO WCOM-FILECTRL.                
003428     STRING L654-CODCLIEN ' ' L654-TIPSERVI ' '                   
003429            L654-CODDIVIS                                         
003430        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
003432     
      *EXEC SQL 
      *SELECT VALUE(MAX(DTFINLIS), ' ' )                       
003433*            INTO :WS-DTFINLIS                                     
003434*            FROM DLOGISTI.TLISTILOGI                              
003435*           WHERE CODCLIEN = :L654-CODCLIEN                        
003436*             AND TIPSERVI = :L654-TIPSERVI                        
003437*             AND CODDIVIS = :L654-CODDIVIS                        
003438*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 18 TO SQL-STMT-ID 
           MOVE 3 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODCLIEN
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-TIPSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODDIVIS
            BY VALUE 0
                     0

           MOVE 19 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DTFINLIS
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 12 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003439     IF SQLCODE NOT = 0                                           
003440        PERFORM Z00-ERRORE                                        
003441           THRU Z00-EX.                                           
003442 L30-EX. EXIT.                                                    
003443*---------------------------------------------------------------* 
003444 L40-SELECT-LISTILOGI.                                            
003445*---------------------------------------------------------------* 
003446     MOVE 'L40-'                 TO WCOM-CODABEND.                
003447     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003448     MOVE 'LISTILOGI'            TO WCOM-FILENOME.                
003449     MOVE SPACES                 TO WCOM-FILECTRL.                
003450     STRING L654-CODCLIEN ' ' L654-TIPSERVI ' '                   
003451            L654-CODDIVIS                                         
003452        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
003454     
      *EXEC SQL 
      *SELECT VALUE(MIN(DTINILIS), ' ' )                       
003455*            INTO :WS-DTINILIS                                     
003456*            FROM DLOGISTI.TLISTILOGI                              
003457*           WHERE CODCLIEN = :L654-CODCLIEN                        
003458*             AND TIPSERVI = :L654-TIPSERVI                        
003459*             AND CODDIVIS = :L654-CODDIVIS                        
003460*             AND DTINILIS >= :L654-DTFINLIS                       
003461*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 20 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODCLIEN
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-TIPSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODDIVIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTFINLIS
            BY VALUE 0
                     0

           MOVE 21 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DTINILIS
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 13 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003462     IF SQLCODE NOT = 0                                           
003463        PERFORM Z00-ERRORE                                        
003464           THRU Z00-EX.                                           
003465 L40-EX. EXIT.                                                    
003466*---------------------------------------------------------------* 
003467 L50-SELECT-ORDILOGI.                                             
003468*---------------------------------------------------------------* 
003469     MOVE 'L50-'                 TO WCOM-CODABEND.                
003470     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003471     MOVE 'ORDILOGI'             TO WCOM-FILENOME.                
003472     MOVE SPACES                 TO WCOM-FILECTRL.                
003473     STRING L652-TIPSERVI ' ' L652-CODSOCIE ' '                   
003474            L652-CODCLIEN ' ' L652-CODDIVIS ' '                   
003475            L654-DTINILIS ' ' L654-DTFINLIS                       
003476     DELIMITED BY SIZE         INTO WCOM-FILECTRL.                
003478     
      *EXEC SQL 
      *SELECT DISTINCT CODCLIEN                                
003479*            INTO :L652-CODCLIEN                                   
003480*            FROM DLOGISTI.TORDILOGI    A                          
003481*                ,DLOGISTI.TRIGORDILOGI B                          
003482*           WHERE A.AANUMORD = B.AANUMORD                          
003483*             AND A.TIPSERVI = :L652-TIPSERVI                      
003484*             AND A.CODSOCIE = :L652-CODSOCIE                      
003485*             AND A.CODCLIEN = :L652-CODCLIEN                      
003486*             AND A.CODDIVIS = :L652-CODDIVIS                      
003487*             AND A.DTANNULL = ' '                                 
003488*             AND B.DTANNULL = ' '                                 
003489*             AND A.AAMMCOMP BETWEEN :L654-DTINILIS                
003490*                                AND :L654-DTFINLIS                
003491*             AND EXISTS(SELECT CODSERVI                           
003492*                          FROM DLOGISTI.TLISTILOGI C              
003493*                         WHERE A.TIPSERVI = C.TIPSERVI            
003494*                           AND A.CODCLIEN = C.CODCLIEN            
003495*                           AND A.CODDIVIS = C.CODDIVIS            
003496*                           AND C.DTINILIS = :L654-DTINILIS        
003497*                           AND C.DTFINLIS = :L654-DTFINLIS        
003498*                           AND B.CODSERVI = C.CODSERVI)           
003499*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 22 TO SQL-STMT-ID 
           MOVE 8 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-TIPSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODSOCIE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODCLIEN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODDIVIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTINILIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTFINLIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTINILIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTFINLIS
            BY VALUE 0
                     0

           MOVE 23 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODCLIEN
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 14 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003500     IF SQLCODE NOT = 0  AND +100                                 
003501        PERFORM Z00-ERRORE                                        
003502           THRU Z00-EX.                                           
003503 L50-EX. EXIT.                                                    
003504*----------------------------------------------------------------*
003505 O00-OPEN-POINTER.                                                
003506*----------------------------------------------------------------*
003507     MOVE 'O00-'                 TO WCOM-CODABEND.                
003508     MOVE 'OPEN'                 TO WCOM-FILEFUNZ                 
003509     MOVE 'POINTER1'             TO WCOM-FILENOME                 
003510     MOVE SPACES                 TO WCOM-FILECTRL.                
003511     STRING L654-CODCLIEN ' ' L654-DTINILIS ' '                   
003512            L654-DTFINLIS ' ' L654-CODDIVIS                       
003513     DELIMITED BY SIZE         INTO WCOM-FILECTRL.                
003514     
      *EXEC SQL OPEN POINTER1 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 24 TO SQL-STMT-ID 
           MOVE 7 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-CODCLIEN
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-CODCLIEN
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-DTINILIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-DTINILIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-DTFINLIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-DTFINLIS
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-TIPSERVI
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
003515     IF SQLCODE NOT = ZEROES                                      
003516        PERFORM Z00-ERRORE                                        
003517           THRU Z00-EX.                                           
003518 O00-EX. EXIT.                                                    
003519*----------------------------------------------------------------*
003520 O10-CLOSE-POINTER.                                               
003521*----------------------------------------------------------------*
003522     MOVE 'O10-'                 TO WCOM-CODABEND.                
003523     MOVE 'CLOSE'                TO WCOM-FILEFUNZ                 
003524     MOVE 'POINTER1'             TO WCOM-FILENOME                 
003525     MOVE SPACES                 TO WCOM-FILECTRL.                
003526     
      *EXEC SQL CLOSE POINTER1 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
003527     IF SQLCODE NOT = ZEROES                                      
003528        PERFORM Z00-ERRORE                                        
003529           THRU Z00-EX.                                           
003530 O10-EX. EXIT.                                                    
003531*----------------------------------------------------------------*
003532 O20-OPEN-POINTER2.                                               
003533*----------------------------------------------------------------*
003534     MOVE 'O20-'                 TO WCOM-CODABEND.                
003535     MOVE 'OPEN'                 TO WCOM-FILEFUNZ                 
003536     MOVE 'POINTER2'             TO WCOM-FILENOME                 
003537     MOVE SPACES                 TO WCOM-FILECTRL.                
003538     STRING WS-TIPSERVI ' '                                       
003539            WS-CODCLIEN ' '                                       
003540            WS-DTINILIS ' '                                       
003541            WS-DTFINLIS ' '                                       
003542            WS-CODDIVIS                                           
003543       DELIMITED BY SIZE       INTO WCOM-FILECTRL.                
003544     
      *EXEC SQL OPEN POINTER2 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 25 TO SQL-STMT-ID 
           MOVE 5 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-TIPSERVI
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CODCLIEN
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DTINILIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DTFINLIS
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CODDIVIS
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
003545     IF SQLCODE NOT = ZEROES                                      
003546        PERFORM Z00-ERRORE                                        
003547           THRU Z00-EX.                                           
003548 O20-EX. EXIT.                                                    
003549*----------------------------------------------------------------*
003550 O30-CLOSE-POINTER2.                                              
003551*----------------------------------------------------------------*
003552     MOVE 'O30-'                 TO WCOM-CODABEND.                
003553     MOVE 'CLOSE'                TO WCOM-FILEFUNZ                 
003554     MOVE 'POINTER2'             TO WCOM-FILENOME                 
003555     MOVE SPACES                 TO WCOM-FILECTRL.                
003556     
      *EXEC SQL CLOSE POINTER2 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
003557     IF SQLCODE NOT = ZEROES                                      
003558        PERFORM Z00-ERRORE                                        
003559           THRU Z00-EX.                                           
003560 O30-EX. EXIT.                                                    
003561*----------------------------------------------------------------*
003562 P00-ATTRIBUTI-RIGA.                                              
003563*----------------------------------------------------------------*
003564     IF WPAG-RCODCLIE (WINDRIGA) NOT > SPACES                     
003565        MOVE DFHBMASF            TO LO60-OPERAZIOA (WINDRIGA)     
003566                                    LO60-RDTFINLIA (WINDRIGA)     
003567        MOVE DFHBLUE             TO LO60-OPERAZIOC (WINDRIGA)     
003568                                    LO60-RDTFINLIC (WINDRIGA)     
003569        MOVE DFHDFHI             TO LO60-OPERAZIOH (WINDRIGA)     
003570                                    LO60-RDTFINLIH (WINDRIGA)     
003571     ELSE                                                         
003572        IF WINDRIGA > 1 AND                                       
003573           WPAG-RCODCLIE(WINDRIGA) = WPAG-RCODCLIE(WINDRIGA - 1)  
003574           MOVE DFHPSKDM         TO LO60-RCODCLIEA(WINDRIGA)      
003575                                    LO60-RRAGFATTA(WINDRIGA).     
003576 P00-EX. EXIT.                                                   
003577*----------------------------------------------------------------*
003578 P10-ATTRIBUTI-DUPLICAZIONE.                                      
003579*----------------------------------------------------------------*
003580     MOVE SPACES                 TO WCOM-RAGFATT3                 
003581                                    WCOM-XRAGFATT                 
003582                                    LO60-XCODCLIEO                
003583                                    LO60-XRAGFATTO                
003584                                    LO60-XDTINILIO                
003585                                    LO60-XDTFINLIO                
003586                                    LO60-XCODDIVIO                
003587                                    LO60-XSIGLADIO                
003588     MOVE DFHBMASF               TO LO60-XCODCLIEA                
003589                                    LO60-XRAGFATTA                
003590                                    LO60-XDTINILIA                
003591                                    LO60-XDTFINLIA                
003592     MOVE DFHBLUE                TO LO60-XCODCLIEC                
003593                                    LO60-XRAGFATTC                
003594                                    LO60-XDTINILIC                
003595                                    LO60-XDTFINLIC                
003596     MOVE DFHDFHI                TO LO60-XCODCLIEH                
003597                                    LO60-XRAGFATTH                
003598                                    LO60-XDTINILIH                
003599                                    LO60-XDTFINLIH.               
003600 P10-EX. EXIT.                                                   
003601*----------------------------------------------------------------*
003602 R00-READQ-WPAGCTRL.                                              
003603*----------------------------------------------------------------*
003604     MOVE SPACES                 TO WPAGREFE.                     
003605     INITIALIZE                     WPAGREFE.                     
003606                                                                  
003607* EXEC CICS HANDLE CONDITION ITEMERR (R00-EX)                     
003608*                               QIDERR  (R00-EX)                  
003609*    END-EXEC.                                                    
003610*    MOVE '"$<N                  ! $ #00003445' TO DFHEIV0        
003611     MOVE X'22243C4E2020202020202020' &                           
003612          X'202020202020202020202120' &                           
003613          X'2420233030303033343435' TO DFHEIV0                    
003614     CALL 'kxdfhei1' USING DFHEIV0                                
003615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003616                                                                  
003617                                                                  
003618* EXEC CICS READQ  TS QUEUE   (WPAGCTRL)                          
003619*                        INTO    (WPAGREFE)                       
003620*                        ITEM    (WNUMITEM)                       
003621*                        LENGTH  (WPAGLPAG)                       
003622*                        END-EXEC.                                
003623*    MOVE '*$II   L              ''   #00003448' TO DFHEIV0       
003624     MOVE X'2A2449492020204C20202020' &                           
003625          X'202020202020202020202720' &                           
003626          X'2020233030303033343438' TO DFHEIV0                    
003627     CALL 'kxdfhei1' USING DFHEIV0,                               
003628           WPAGCTRL,                                              
003629           WPAGREFE,                                              
003630           WPAGLPAG,                                              
003631           WNUMITEM,                                              
003632           DFHEIV99,                                              
003633           DFHEIV99                                               
003634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003635                                                                  
003636 R00-EX. EXIT.                                                    
003637*----------------------------------------------------------------*
003638 R20-WRITEQ-WPAG.                                                 
003639*----------------------------------------------------------------*
003640     ADD  1                      TO WCOM-PAGILIST.                
003641                                                                  
003642* EXEC CICS WRITEQ TS    QUEUE (WPAGCTRL)                         
003643*                           FROM  (WPAGREFE)                      
003644*                           LENGTH(WPAGLPAG)                      
003645*                           END-EXEC.                             
003646*    MOVE '*"     L              ''   #00003458' TO DFHEIV0       
003647     MOVE X'2A2220202020204C20202020' &                           
003648          X'202020202020202020202720' &                           
003649          X'2020233030303033343538' TO DFHEIV0                    
003650     CALL 'kxdfhei1' USING DFHEIV0,                               
003651           WPAGCTRL,                                              
003652           WPAGREFE,                                              
003653           WPAGLPAG,                                              
003654           DFHEIV99,                                              
003655           DFHEIV99,                                              
003656           DFHEIV99                                               
003657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003658                                                                  
003659 R20-EX. EXIT.                                                    
003660*----------------------------------------------------------------*
003661 U00-RETURN-TRAN.                                                 
003662*----------------------------------------------------------------*
003663                                                                  
003664* EXEC CICS RETURN TRANSID  (EIBTRNID)                            
003665*                     COMMAREA (WCOM-AREAXXXX)                    
003666*                     LENGTH   (WCOM-LUNGHEZZ)                    
003667*    END-EXEC.                                                    
003668*    MOVE '.(CT                  ''   #00003466' TO DFHEIV0       
003669     MOVE X'2E2843542020202020202020' &                           
003670          X'202020202020202020202720' &                           
003671          X'2020233030303033343636' TO DFHEIV0                    
003672     CALL 'kxdfhei1' USING DFHEIV0,                               
003673           EIBTRNID,                                              
003674           WCOM-AREAXXXX,                                         
003675           WCOM-LUNGHEZZ,                                         
003676           DFHEIV99,                                              
003677           DFHEIV99,                                              
003678           DFHEIV99                                               
003679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003680                                                                  
003681 U00-EX. EXIT.                                                    
003682*----------------------------------------------------------------*
003683 U02-NORESP.                                                      
003684*----------------------------------------------------------------*
003685                                                                  
003686* EXEC CICS SEND CONTROL                                          
003687*                   FREEKB                                        
003688*                   END-EXEC.                                     
003689*    MOVE '82      T    F        (   #00003474' TO DFHEIV0        
003690     MOVE X'383220202020202054202020' &                           
003691          X'204620202020202020202820' &                           
003692          X'2020233030303033343734' TO DFHEIV0                    
003693     CALL 'kxdfhei1' USING DFHEIV0,                               
003694           DFHEIV99,                                              
003695           DFHEIV99,                                              
003696           DFHEIV99,                                              
003697           DFHEIV99,                                              
003698           DFHEIV99,                                              
003699           DFHEIV99,                                              
003700           DFHEIV99                                               
003701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003702                                                                  
003703     PERFORM U00-RETURN-TRAN                                      
003704        THRU U00-EX.                                              
003705 U02-EX. EXIT.                                                    
003706*----------------------------------------------------------------*
003707 U05-START-TRANSID.                                               
003708*----------------------------------------------------------------*
003709                                                                  
003710* EXEC CICS START   TRANSID (WTRANSID)                            
003711*                      FROM    (WCOM-AREAXXXX)                    
003712*                      LENGTH  (WCOM-LUNGHEZZ)                    
003713*                      TERMID  (EIBTRMID)                         
003714*                      END-EXEC                                   
003715*    MOVE '0( LFT                1   #00003483' TO DFHEIV0        
003716     MOVE X'3028204C4654202020202020' &                           
003717          X'202020202020202020203120' &                           
003718          X'2020233030303033343833' TO DFHEIV0                    
003719     CALL 'kxdfhei1' USING DFHEIV0,                               
003720           DFHEIV99,                                              
003721           WTRANSID,                                              
003722           DFHEIV99,                                              
003723           WCOM-AREAXXXX,                                         
003724           WCOM-LUNGHEZZ,                                         
003725           EIBTRMID,                                              
003726           DFHEIV99,                                              
003727           DFHEIV99,                                              
003728           DFHEIV99,                                              
003729           DFHEIV99,                                              
003730           DFHEIV99,                                              
003731           DFHEIV99,                                              
003732           DFHEIV99,                                              
003733           DFHEIV99,                                              
003734           DFHEIV99,                                              
003735           DFHEIV99                                               
003736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
003737                                                                  
003738* EXEC CICS RETURN  END-EXEC.                                     
003739*    MOVE '.(                    ''   #00003488' TO DFHEIV0       
003740     MOVE X'2E2820202020202020202020' &                           
003741          X'202020202020202020202720' &                           
003742          X'2020233030303033343838' TO DFHEIV0                    
003743     CALL 'kxdfhei1' USING DFHEIV0,                               
003744           DFHEIV99,                                              
003745           DFHEIV99,                                              
003746           DFHEIV99,                                              
003747           DFHEIV99,                                              
003748           DFHEIV99,                                              
003749           DFHEIV99                                               
003750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003751                                                                  
003752 U05-EX. EXIT.                                                    
003753*----------------------------------------------------------------*
003754 U10-DECODIFICA-MESSAGGI.                                         
003755*----------------------------------------------------------------*
003756     MOVE WCOM-CODILING          TO MESS-CODILING.                
003757*    EXEC SQL  INCLUDE SRMESS  END-EXEC.                          
      *>>((file: SRMESS))
000001*-------------------------------------------------- SRMESS START* 
000002*-  AUTHOR: FEBBRAIOLA DOMENICO & GIUSEPPE RASPINO              * 
000003*---------------------------------------------------------------* 
000004*                                                               * 
000005*  SUBROUTINE PER LA RICERCA DEI MESSAGGI IN LINGUA             * 
000006*                                                               * 
000007*  N.B.  INSERIRE IN WORKING STORAGE :                          * 
000008*            EXEC SQL INCLUDE FDANA846 END-EXEC.                * 
000009*            COPY  DCMESS                                       * 
000010*                                                               * 
000011*  N.B.  IMPOSTARE DATI IN :                                    * 
000012*            MESS-CODERROR                                      * 
000013*            MESS-CODILING                                      * 
000014*                                                               * 
000015***************************************************************** 
000016                                                                  
000017     MOVE 'SELECT'             TO WCOM-FILEFUNZ                   
000018     MOVE 'FDANA846'           TO WCOM-FILENOME                   
000019     MOVE 'SRME'               TO WCOM-CODABEND                   
000020     MOVE MESS-CODERROR        TO WCOM-FILECTRL                   
000021                                                                  
000022     MOVE SPACES               TO MESS-CAMPI-OUTPUT.              
000023     MOVE MESS-CODERROR        TO A846-CODERROR.                  
000024     MOVE MESS-CODILING        TO A846-CODILING.                  
000025                                                                  
000027     
      *EXEC SQL 
      *SELECT MSGERROR                                         
000028*          INTO  :A846-MSGERROR                                    
000029*          FROM   DANAGRAF.TMESSAGGI                               
000030*          WHERE  CODERROR = :A846-CODERROR AND                    
000031*                 CODILING = :A846-CODILING                        
000032*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 26 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODERROR
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODILING
            BY VALUE 0
                     0

           MOVE 27 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 60 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-MSGERROR
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 15 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000033                                                                  
000034     IF SQLCODE NOT EQUAL ZEROS AND                               
000035        SQLCODE NOT EQUAL +100                                    
000036        PERFORM Z00-ERRORE                                        
000037           THRU Z00-EX                                            
000038     ELSE                                                         
000039        IF SQLCODE EQUAL ZEROS                                    
000040           MOVE MESS-CODERROR    TO MESS-COMCODER                 
000041           MOVE A846-MSGERROR    TO MESS-MESSAGGI                 
000042        ELSE                                                      
000043           MOVE '99999'          TO A846-CODERROR                 
000044           MOVE MESS-CODILING    TO A846-CODILING                 
000046           
      *EXEC SQL 
      *SELECT MSGERROR                                   
000047*                INTO  :A846-MSGERROR                              
000048*                FROM   DANAGRAF.TMESSAGGI                         
000049*                WHERE  CODERROR = :A846-CODERROR AND              
000050*                       CODILING = :A846-CODILING                  
000051*           END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 28 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODERROR
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODILING
            BY VALUE 0
                     0

           MOVE 29 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 60 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-MSGERROR
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 16 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000052           IF SQLCODE EQUAL ZEROS                                 
000053              MOVE MESS-CODERROR TO MESS-COMCODER                 
000054              MOVE A846-MSGERROR TO MESS-MESSAGGI                 
000055           ELSE                                                   
000056              IF SQLCODE = 100                                    
000057                 MOVE MESS-CODERROR   TO MESS-COMCODER            
000058                 MOVE '*** MESSAGGIO  NON  TROVATO ****'          
000059                                      TO MESS-MESSAGGI            
000060              ELSE                                                
000061                 PERFORM Z00-ERRORE                               
000062                     THRU Z00-EX.                                 
000063                                                                  
000064*------------------------------------------------- SRMESS    END* 
      *<<((file: SRMESS))
003758     MOVE MESS-MSGERROR          TO LO60-MESSAGGO.                
003759 U10-EX. EXIT.                                                    
003760*----------------------------------------------------------------*
003761 U20-DELETE-TS.                                                   
003762*----------------------------------------------------------------*
003763                                                                  
003764* EXEC CICS DELETEQ TS QUEUE   (WPAGCTRL)                         
003765*              NOHANDLE                                           
003766*              END-EXEC.                                          
003767*    MOVE '*&                    #  N#00003500' TO DFHEIV0        
003768     MOVE X'2A2620202020202020202020' &                           
003769          X'202020202020202020202320' &                           
003770          X'204E233030303033353030' TO DFHEIV0                    
003771     CALL 'kxdfhei1' USING DFHEIV0,                               
003772           WPAGCTRL,                                              
003773           DFHEIV99                                               
003774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003775                                                                  
003776 U20-EX. EXIT.                                                    
003777*----------------------------------------------------------------*
003778*    EXEC SQL INCLUDE SRDTGG END-EXEC.                            
      *>>((file: SRDTGG))
000001*---------------------------------------------------------------* 
000002*    RICERCA DATA DEL GIORNO SULLA TABELLA-DB2 ''TDATARIO''     * 
000003*    PER IL CORRETTO UTILIZZO VEDI IL DATA MANAGER.            *  
000004*---------------------------------------------------------------* 
000005* N.B.  INSERIRE IN WORKING STORAGE :                           * 
000006*                                                               * 
000007*    EXEC SQL INCLUDE FDANA973 END-EXEC.                        * 
000008*    EXEC SQL INCLUDE DCDTGG   END-EXEC.                        * 
000009*    COPY DCWCOMMA(PER PROGRAMMI TP)  X COMODI GESTIONE ERRORI  * 
000010*    COPY DCDB2ER(PER PROGRAMMI BATCH)X COMODI GESTIONE ERRORI  * 
000011*                                                               * 
000012*---------------------------------------------------------------* 
000013                                                                  
000014 SRDTGG.                                                          
000015                                                                  
000016     MOVE +0                     TO DTGG-PRGIORNO.                
000017                                                                  
000018     MOVE SPACES                 TO DTGG-NUMGIORN                 
000019                                    DTGG-DTGIORNO                 
000020                                    DTGG-NUMSETTI                 
000021                                    DTGG-NRGGSETT                 
000022                                    DTGG-DTINISET                 
000023                                    DTGG-DTFINSET                 
000024                                    DTGG-DTINIMES                 
000025                                    DTGG-DTFINMES                 
000026                                    DTGG-ANNOSETT                 
000027                                    DTGG-RETUCODE.                
000028                                                                  
000030     
      *EXEC SQL 
      *SELECT CURRENT DATE                                     
000031*          INTO :DTGG-DATAGIOR                                     
000032*          FROM DANAGRAF.VANAGRAF_082                              
000033*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 30 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE DTGG-DATAGIOR
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 17 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000034                                                                  
000035     MOVE DTGG-DATAGIOR(1:4)     TO DTGG-AACURREN.                
000036     MOVE DTGG-DATAGIOR(6:2)     TO DTGG-MMCURREN.                
000037     MOVE DTGG-DATAGIOR(9:2)     TO DTGG-GGCURREN.                
000038                                                                  
000039     MOVE DTGG-DTCURREN          TO DTGG-CURRENDT.                
000040                                                                  
000041     IF DTGG-DTRICHIE  NOT GREATER SPACES AND                     
000042        DTGG-PRRICHIE  NOT GREATER ZEROES                         
000043        PERFORM SRDTGG-A10-RICERCA-GIORNO                         
000044           THRU SRDTGG-A10-EX                                     
000045     ELSE                                                         
000046        IF DTGG-DTRICHIE   GREATER SPACES                         
000047           MOVE DTGG-DTRICHIE    TO A973-DTGIORNO                 
000048           PERFORM SRDTGG-A20-CALCOLO-DATARIC                     
000049              THRU SRDTGG-A20-EX                                  
000050        ELSE                                                      
000051           MOVE DTGG-PRRICHIE    TO A973-PRGIORNO                 
000052           PERFORM SRDTGG-A30-CALCOLO-PROGRES                     
000053              THRU SRDTGG-A30-EX.                                 
000054                                                                  
000055 SRDTGG-EX. EXIT.                                                 
000056                                                                  
000057*---------------------------------------------------------------* 
000058 SRDTGG-A10-RICERCA-GIORNO.                                       
000059*---------------------------------------------------------------* 
000060                                                                  
000061     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
000062     MOVE 'DATARIO'              TO WCOM-FILENOME.                
000063     MOVE 'DB2 '                 TO WCOM-CODABEND.                
000064     MOVE 'A10-RI'               TO WCOM-FILECTRL.                
000065     MOVE 'ERRORE IN SRDTGG-A10' TO WCOM-MESSAGES.                
000066                                                                  
000068     
      *EXEC SQL 
      *SELECT DTGIORNO, PRGIORNO, NUMGIORN                     
000069*                ,NUMSETTI, NRGGSETT, ANNOSETT                     
000070*                ,DTINISET, DTFINSET                               
000071*                ,DTINIMES, DTFINMES                               
000072*            INTO :A973-DTGIORNO, :A973-PRGIORNO, :A973-NUMGIORN   
000073*                ,:A973-NUMSETTI, :A973-NRGGSETT, :A973-ANNOSETT   
000074*                ,:A973-DTINISET, :A973-DTFINSET                   
000075*                ,:A973-DTINIMES, :A973-DTFINMES                   
000076*            FROM DANAGRAF.TDATARIO                                
000077*           WHERE DTGIORNO = :DTGG-CURRENDT                        
000078*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 31 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE DTGG-CURRENDT
            BY VALUE 0
                     0

           MOVE 32 TO SQL-STMT-ID 
           MOVE 10 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTGIORNO
            BY VALUE 0
                     0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-PRGIORNO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NUMGIORN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NUMSETTI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NRGGSETT
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-ANNOSETT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTINISET
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTFINSET
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTINIMES
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTFINMES
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 18 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000079                                                                  
000080     IF SQLCODE EQUAL 0                                           
000081        MOVE '****'              TO DTGG-RETUCODE                 
000082        MOVE A973-DTGIORNO       TO DTGG-DTGIORNO                 
000083        MOVE A973-PRGIORNO       TO DTGG-PRGIORNO                 
000084        MOVE A973-NUMSETTI       TO DTGG-NUMSETTI                 
000085        MOVE A973-NUMGIORN       TO DTGG-NUMGIORN                 
000086        MOVE A973-NRGGSETT       TO DTGG-NRGGSETT                 
000087        MOVE A973-DTINISET       TO DTGG-DTINISET                 
000088        MOVE A973-DTFINSET       TO DTGG-DTFINSET                 
000089        MOVE A973-DTINIMES       TO DTGG-DTINIMES                 
000090        MOVE A973-DTFINMES       TO DTGG-DTFINMES                 
000091        MOVE A973-ANNOSETT       TO DTGG-ANNOSETT                 
000092     ELSE                                                         
000093        IF SQLCODE EQUAL 100                                      
000094           MOVE 'MRNF'           TO DTGG-RETUCODE                 
000095        ELSE                                                      
000096           MOVE 'ERRO'           TO DTGG-RETUCODE.                
000097                                                                  
000098 SRDTGG-A10-EX. EXIT.                                            
000099                                                                  
000100*---------------------------------------------------------------* 
000101 SRDTGG-A20-CALCOLO-DATARIC.                                      
000102*---------------------------------------------------------------* 
000103                                                                  
000104     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
000105     MOVE 'DATARIO'              TO WCOM-FILENOME.                
000106     MOVE 'DB2 '                 TO WCOM-CODABEND.                
000107     MOVE  A973-DTGIORNO         TO WCOM-FILECTRL.                
000108     MOVE 'ERRORE IN SRDTGG-A20' TO WCOM-MESSAGES.                
000109                                                                  
000111     
      *EXEC SQL 
      *SELECT DTGIORNO, PRGIORNO, NUMGIORN                     
000112*                ,NUMSETTI, NRGGSETT, ANNOSETT                     
000113*                ,DTINISET, DTFINSET                               
000114*                ,DTINIMES, DTFINMES                               
000115*            INTO :A973-DTGIORNO, :A973-PRGIORNO, :A973-NUMGIORN   
000116*                ,:A973-NUMSETTI, :A973-NRGGSETT, :A973-ANNOSETT   
000117*                ,:A973-DTINISET, :A973-DTFINSET                   
000118*                ,:A973-DTINIMES, :A973-DTFINMES                   
000119*            FROM DANAGRAF.TDATARIO                                
000120*           WHERE DTGIORNO = :A973-DTGIORNO                        
000121*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 33 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTGIORNO
            BY VALUE 0
                     0

           MOVE 34 TO SQL-STMT-ID 
           MOVE 10 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTGIORNO
            BY VALUE 0
                     0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-PRGIORNO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NUMGIORN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NUMSETTI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NRGGSETT
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-ANNOSETT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTINISET
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTFINSET
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTINIMES
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTFINMES
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 19 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000122                                                                  
000123     IF SQLCODE EQUAL 0                                           
000124        MOVE '****'              TO DTGG-RETUCODE                 
000125        MOVE A973-DTGIORNO       TO DTGG-DTGIORNO                 
000126        MOVE A973-PRGIORNO       TO DTGG-PRGIORNO                 
000127        MOVE A973-NUMSETTI       TO DTGG-NUMSETTI                 
000128        MOVE A973-NUMGIORN       TO DTGG-NUMGIORN                 
000129        MOVE A973-NRGGSETT       TO DTGG-NRGGSETT                 
000130        MOVE A973-DTINISET       TO DTGG-DTINISET                 
000131        MOVE A973-DTFINSET       TO DTGG-DTFINSET                 
000132        MOVE A973-DTINIMES       TO DTGG-DTINIMES                 
000133        MOVE A973-DTFINMES       TO DTGG-DTFINMES                 
000134        MOVE A973-ANNOSETT       TO DTGG-ANNOSETT                 
000135     ELSE                                                         
000136        IF SQLCODE EQUAL 100                                      
000137           MOVE 'MRNF'           TO DTGG-RETUCODE                 
000138        ELSE                                                      
000139           MOVE 'ERRO'           TO DTGG-RETUCODE.                
000140                                                                  
000141 SRDTGG-A20-EX. EXIT.                                            
000142                                                                  
000143*---------------------------------------------------------------* 
000144 SRDTGG-A30-CALCOLO-PROGRES.                                      
000145*---------------------------------------------------------------* 
000146                                                                  
000147     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
000148     MOVE 'DATARIO'              TO WCOM-FILENOME.                
000149     MOVE 'DB2 '                 TO WCOM-CODABEND.                
000150     MOVE 'ERRORE IN SRDTGG-A30' TO WCOM-MESSAGES.                
000151                                                                  
000153     
      *EXEC SQL 
      *SELECT DTGIORNO, PRGIORNO, NUMGIORN                     
000154*                ,NUMSETTI, NRGGSETT, ANNOSETT                     
000155*                ,DTINISET, DTFINSET                               
000156*                ,DTINIMES, DTFINMES                               
000157*            INTO :A973-DTGIORNO, :A973-PRGIORNO, :A973-NUMGIORN   
000158*                ,:A973-NUMSETTI, :A973-NRGGSETT, :A973-ANNOSETT   
000159*                ,:A973-DTINISET, :A973-DTFINSET                   
000160*                ,:A973-DTINIMES, :A973-DTFINMES                   
000161*            FROM DANAGRAF.TDATARIO                                
000162*           WHERE PRGIORNO = :A973-PRGIORNO                        
000163*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 35 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-PRGIORNO
            BY VALUE 0
                     0

           MOVE 36 TO SQL-STMT-ID 
           MOVE 10 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTGIORNO
            BY VALUE 0
                     0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-PRGIORNO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NUMGIORN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NUMSETTI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NRGGSETT
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-ANNOSETT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTINISET
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTFINSET
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTINIMES
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTFINMES
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 20 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000164                                                                  
000165     IF SQLCODE EQUAL 0                                           
000166        MOVE '****'              TO DTGG-RETUCODE                 
000167        MOVE A973-DTGIORNO       TO DTGG-DTGIORNO                 
000168        MOVE A973-PRGIORNO       TO DTGG-PRGIORNO                 
000169        MOVE A973-NUMSETTI       TO DTGG-NUMSETTI                 
000170        MOVE A973-NUMGIORN       TO DTGG-NUMGIORN                 
000171        MOVE A973-NRGGSETT       TO DTGG-NRGGSETT                 
000172        MOVE A973-DTINISET       TO DTGG-DTINISET                 
000173        MOVE A973-DTFINSET       TO DTGG-DTFINSET                 
000174        MOVE A973-DTINIMES       TO DTGG-DTINIMES                 
000175        MOVE A973-DTFINMES       TO DTGG-DTFINMES                 
000176        MOVE A973-ANNOSETT       TO DTGG-ANNOSETT                 
000177     ELSE                                                         
000178        IF SQLCODE EQUAL 100                                      
000179           MOVE 'MRNF'           TO DTGG-RETUCODE                 
000180        ELSE                                                      
000181           MOVE 'ERRO'           TO DTGG-RETUCODE.                
000182                                                                  
000183 SRDTGG-A30-EX. EXIT.                                            
000184*--------------------------------------------------------------*  
      *<<((file: SRDTGG))
003779*----------------------------------------------------------------*
003780*COPY DCWTSTRP.                                                   
003781*------------------------------------- -------------------------* 
003782*                    --- DCWTSTRp ---                           * 
003783*                GESTIONE DATI PER RICICLO.                     * 
003784*---------------------------------------------------------------* 
003785 LEGGO-RICICLO.                                                   
003786                                                                  
003787* EXEC CICS HANDLE CONDITION ITEMERR (LEGGO-RICICLO-EX)           
003788*                           QIDERR  (LEGGO-RICICLO-EX)            
003789*END-EXEC.                                                        
003790*    MOVE '"$<N                  ! % #00003513' TO DFHEIV0        
003791     MOVE X'22243C4E2020202020202020' &                           
003792          X'202020202020202020202120' &                           
003793          X'2520233030303033353133' TO DFHEIV0                    
003794     CALL 'kxdfhei1' USING DFHEIV0                                
003795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003796                                                                  
003797*    CALL 'DFHEI1' USING DFHEIV0                                  
003798*     SERVICE LABEL                                               
003799*     GO TO  LEGGO-RICICLO-EX LEGGO-RICICLO-EX DEPENDING ON       
003800*    DFHEIGDI.                                                    
003801     MOVE  1                     TO TSTR-ITEMXXXX.                
003802     MOVE EIBTRNID               TO TSTR-NOMETRAN.                
003803     MOVE EIBTRMID               TO TSTR-NOMETERM.                
003804                                                                  
003805* EXEC CICS READQ  TS QUEUE   (TSTR-NOMECODA)                     
003806*                    INTO    (TSTR-AREATSTR)                      
003807*                    ITEM    (TSTR-ITEMXXXX)                      
003808*                    LENGTH  (TSTR-LENGCODA)                      
003809*END-EXEC.                                                        
003810*    MOVE '*$II   L              ''   #00003523' TO DFHEIV0       
003811     MOVE X'2A2449492020204C20202020' &                           
003812          X'202020202020202020202720' &                           
003813          X'2020233030303033353233' TO DFHEIV0                    
003814     CALL 'kxdfhei1' USING DFHEIV0,                               
003815           TSTR-NOMECODA,                                         
003816           TSTR-AREATSTR,                                         
003817           TSTR-LENGCODA,                                         
003818           TSTR-ITEMXXXX,                                         
003819           DFHEIV99,                                              
003820           DFHEIV99                                               
003821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003822                                                                  
003823*    CALL 'DFHEI1' USING DFHEIV0  TSTR-NOMECODA TSTR-AREATSTR     
003824*    TSTR-LENGCODA DFHDUMMY TSTR-ITEMXXXX.                        
003825     MOVE TSTR-AREATSTR          TO WCOM-AREAXXXX.                
003826                                                                  
003827* EXEC CICS DELETEQ TS QUEUE  (TSTR-NOMECODA)                     
003828*                     NOHANDLE                                    
003829*END-EXEC.                                                        
003830*    MOVE '*&                    #  N#00003531' TO DFHEIV0        
003831     MOVE X'2A2620202020202020202020' &                           
003832          X'202020202020202020202320' &                           
003833          X'204E233030303033353331' TO DFHEIV0                    
003834     CALL 'kxdfhei1' USING DFHEIV0,                               
003835           TSTR-NOMECODA,                                         
003836           DFHEIV99                                               
003837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003838                                                                  
003839*    CALL 'DFHEI1' USING DFHEIV0  TSTR-NOMECODA.                  
003840 LEGGO-RICICLO-EX. EXIT.                                          
003841 SCRIVO-RICICLO.                                                  
003842     MOVE WCOM-AREAXXXX          TO TSTR-AREATSTR.                
003843     MOVE  1                     TO TSTR-ITEMXXXX.                
003844     MOVE EIBTRNID               TO TSTR-NOMETRAN.                
003845     MOVE EIBTRMID               TO TSTR-NOMETERM.                
003846                                                                  
003847* EXEC CICS DELETEQ TS QUEUE  (TSTR-NOMECODA)                     
003848*                     NOHANDLE                                    
003849*END-EXEC.                                                        
003850*    MOVE '*&                    #  N#00003541' TO DFHEIV0        
003851     MOVE X'2A2620202020202020202020' &                           
003852          X'202020202020202020202320' &                           
003853          X'204E233030303033353431' TO DFHEIV0                    
003854     CALL 'kxdfhei1' USING DFHEIV0,                               
003855           TSTR-NOMECODA,                                         
003856           DFHEIV99                                               
003857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003858                                                                  
003859*    CALL 'DFHEI1' USING DFHEIV0  TSTR-NOMECODA.                  
003860                                                                  
003861* EXEC CICS WRITEQ TS  QUEUE  (TSTR-NOMECODA)                     
003862*                     FROM   (TSTR-AREATSTR)                      
003863*                     ITEM   (TSTR-ITEMXXXX)                      
003864*                     LENGTH (TSTR-LENGCODA)                      
003865*END-EXEC.                                                        
003866*    MOVE '*" I   L              ''   #00003545' TO DFHEIV0       
003867     MOVE X'2A2220492020204C20202020' &                           
003868          X'202020202020202020202720' &                           
003869          X'2020233030303033353435' TO DFHEIV0                    
003870     CALL 'kxdfhei1' USING DFHEIV0,                               
003871           TSTR-NOMECODA,                                         
003872           TSTR-AREATSTR,                                         
003873           TSTR-LENGCODA,                                         
003874           TSTR-ITEMXXXX,                                         
003875           DFHEIV99,                                              
003876           DFHEIV99                                               
003877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003878                                                                  
003879*    CALL 'DFHEI1' USING DFHEIV0  TSTR-NOMECODA TSTR-AREATSTR     
003880*    TSTR-LENGCODA DFHDUMMY TSTR-ITEMXXXX.                        
003881 SCRIVO-RICICLO-EX. EXIT.                                         
003882*---------------------------------------------------------------* 
003883*COPY DCPERDB2.                                                   
003884*SRERCICS/P---------S = SOURCE / P = PRECOMPILED ----------------*
003885*----*  ROUTINE INTERCETTA ERRORE CICS                      *----*
003886*----*                                                      *----*
003887*----------------------------------------------------------------*
003888*       QUESTA ROUTINE E' LA PRIMA DA DICHIARARE COME COPY        
003889*----*                                                      *----*
003890*----------------------------------------------------------------*
003891*    ES.    **                                                    
003892*    ES.         COPY SRERCICP.                                   
003893*    ES.    **   SE VOGLIO INTERCETTARE ERRORE DB2                
003894*    ES.         COPY SRERDB2P                                    
003895*    ES.    **   SE VOGLIO INTERCETTARE ERRORE TOTAL              
003896*    ES.         COPY SRERDB2P                                    
003897*    ES.    **  ETC.                                              
003898*    ES.                                                          
003899*    ES.    **   ULTIMA ROUTINE CHE RILASCIA TR-ERRE  PER DECODI  
003900*    ES.    **   ERRORE                                           
003901*    ES.         COPY SRERENDS                                    
003902*                                                                 
003903*----------------------------------------------------------------*
003904 Z00-ERRORE.                                                      
003905*----------------------------------------------------------------*
003906     MOVE DFHEIV0                TO T-COMLINE.                    
003907     PERFORM                                                      
003908        VARYING INDERR FROM 1 BY 1                                
003909            UNTIL INDERR GREATER 25                               
003910               OR EL-COMLINE (INDERR) EQUAL ZERO                  
003911     END-PERFORM.                                                 
003912     MOVE SPACES                 TO WLINEAXX.                     
003913     IF INDERR LESS 26                                            
003914        MOVE EL-COMLINE (INDERR) TO EL-LINE (1)                   
003915        ADD 1                    TO INDERR                        
003916        MOVE EL-COMLINE (INDERR) TO EL-LINE (2)                   
003917        ADD 1                    TO INDERR                        
003918        MOVE EL-COMLINE (INDERR) TO EL-LINE (3)                   
003919        ADD 1                    TO INDERR                        
003920        MOVE EL-COMLINE (INDERR) TO EL-LINE (4)                   
003921        ADD 1                    TO INDERR                        
003922        MOVE EL-COMLINE (INDERR) TO EL-LINE (5).                  
003923     MOVE WLINEAXX               TO WCOM-PRGMLINE.                
003924     MOVE EIBFN                  TO WCOM-CODEIBFN.                
003925     MOVE EIBRCODE               TO WCOM-CODERCOD.                
003926     MOVE SPACES                 TO WCOM-ABENCICS.                
003927     IF EIBRESP  NOT = ZERO OR                                    
003928        EIBRESP2 NOT = ZERO                                       
003929                                                                  
003930* EXEC CICS                                                       
003931*      ASSIGN ABCODE (WCOM-ABENCICS)                              
003932*END-EXEC.                                                        
003933*    MOVE '"((                   "   #00003600' TO DFHEIV0        
003934     MOVE X'222828202020202020202020' &                           
003935          X'202020202020202020202220' &                           
003936          X'2020233030303033363030' TO DFHEIV0                    
003937     CALL 'kxdfhei1' USING DFHEIV0,                               
003938           WCOM-ABENCICS                                          
003939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003940                                                                  
003941*       CALL 'DFHEI1' USING DFHEIV0  WCOM-ABENCICS.               
003942*SRERDB2S/P -----------------------------------------------------*
003943*----*  ROUTINE INTERCETTA ERRORE DB2                       *----*
003944*----*                                                      *----*
003945*----------------------------------------------------------------*
003946*       QUESTA ROUTINE E' DA DICHIARARE DOPO LA SRERCICS          
003947*                                                                 
003948     MOVE 'ABEN'                 TO WCOM-CODATSX1.                
003949     MOVE EIBTRMID               TO WCOM-CODATSX2.                
003950*    MOVE LENGTH OF SQLCA        TO WCOM-LUNGHERR.                
003951     MOVE 136                    TO WCOM-LUNGHERR.                
003952                                                                  
003953* EXEC CICS WRITEQ TS    QUEUE  (WCOM-CODATSXX)                   
003954*                       FROM   (SQLCA)                            
003955*                       LENGTH (WCOM-LUNGHERR)                    
003956*END-EXEC.                                                        
003957*    MOVE '*"     L              ''   #00003614' TO DFHEIV0       
003958     MOVE X'2A2220202020204C20202020' &                           
003959          X'202020202020202020202720' &                           
003960          X'2020233030303033363134' TO DFHEIV0                    
003961     CALL 'kxdfhei1' USING DFHEIV0,                               
003962           WCOM-CODATSXX,                                         
003963           SQLCA,                                                 
003964           WCOM-LUNGHERR,                                         
003965           DFHEIV99,                                              
003966           DFHEIV99,                                              
003967           DFHEIV99                                               
003968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003969                                                                  
003970*    CALL 'DFHEI1' USING DFHEIV0  WCOM-CODATSXX SQLCA             
003971*    WCOM-LUNGHERR.                                               
003972*SRERENDS/P------------------------------------------------------*
003973*----*  ROUTINE FINALE                                      *----*
003974*----*                                                      *----*
003975*----------------------------------------------------------------*
003976*       QUESTA ROUTINE DA DICHIARARE PER ULTIMA NELLA SEQUNZA     
003977*       DELLE COPY  PER INTERCETTARE L'ERRORE                     
003978*----------------------------------------------------------------*
003979*----------------------------------------------------------------*
003980      MOVE EIBTRNID              TO WCOM-TRANSAZI.                
003981                                                                  
003982* EXEC CICS SYNCPOINT ROLLBACK                                    
003983*END-EXEC.                                                        
003984*    MOVE '6"R                   !   #00003629' TO DFHEIV0        
003985     MOVE X'362252202020202020202020' &                           
003986          X'202020202020202020202120' &                           
003987          X'2020233030303033363239' TO DFHEIV0                    
003988     CALL 'kxdfhei1' USING DFHEIV0                                
003989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003990                                                                  
003991*     CALL 'DFHEI1' USING DFHEIV0.                                
003992                                                                  
003993* EXEC CICS ASSIGN SYSID (WCOM-SYSID)                             
003994*END-EXEC.                                                        
003995*    MOVE '"(         $          "   #00003632' TO DFHEIV0        
003996     MOVE X'222820202020202020202024' &                           
003997          X'202020202020202020202220' &                           
003998          X'2020233030303033363332' TO DFHEIV0                    
003999     CALL 'kxdfhei1' USING DFHEIV0,                               
004000           WCOM-SYSID                                             
004001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
004002                                                                  
004003*     CALL 'DFHEI1' USING DFHEIV0  WCOM-SYSID.                    
004004      MOVE 'ABEN'                    TO WCOM-CODATSX1.            
004005      MOVE EIBTRMID                  TO WCOM-CODATSX2.            
004006*     MOVE LENGTH OF WCOM-AREA-ERROR TO WCOM-LUNGHERR.            
004007      MOVE 200                       TO WCOM-LUNGHERR.            
004008*EXEC CICS WRITEQ TS QUEUE  (WCOM-CODATSXX)                       
004009                                                                  
004010* EXEC CICS WRITEQ TS                                             
004011*                    QUEUE  (WCOM-CODATSXX)                       
004012*                    FROM   (WCOM-AREA-ERROR)                     
004013*                    LENGTH (WCOM-LUNGHERR)                       
004014*END-EXEC.                                                        
004015*    MOVE '*"     L              ''   #00003640' TO DFHEIV0       
004016     MOVE X'2A2220202020204C20202020' &                           
004017          X'202020202020202020202720' &                           
004018          X'2020233030303033363430' TO DFHEIV0                    
004019     CALL 'kxdfhei1' USING DFHEIV0,                               
004020           WCOM-CODATSXX,                                         
004021           WCOM-AREA-ERROR,                                       
004022           WCOM-LUNGHERR,                                         
004023           DFHEIV99,                                              
004024           DFHEIV99,                                              
004025           DFHEIV99                                               
004026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
004027                                                                  
004028*     CALL 'DFHEI1' USING DFHEIV0  WCOM-CODATSXX WCOM-AREA-ERROR  
004029*    WCOM-LUNGHERR.                                               
004030                                                                  
004031* EXEC CICS START TRANSID ('ERRE')                                
004032*                FROM    (WCOM-AREAXXXX)                          
004033*                LENGTH  (WCOM-LUNGHEZZ)                          
004034*                TERMID  (EIBTRMID)                               
004035*END-EXEC.                                                        
004036     MOVE 'ERRE' TO DFHEIV5                                       
004037*    MOVE '0( LFT                1   #00003647' TO DFHEIV0        
004038     MOVE X'3028204C4654202020202020' &                           
004039          X'202020202020202020203120' &                           
004040          X'2020233030303033363437' TO DFHEIV0                    
004041     CALL 'kxdfhei1' USING DFHEIV0,                               
004042           DFHEIV99,                                              
004043           DFHEIV5,                                               
004044           DFHEIV99,                                              
004045           WCOM-AREAXXXX,                                         
004046           WCOM-LUNGHEZZ,                                         
004047           EIBTRMID,                                              
004048           DFHEIV99,                                              
004049           DFHEIV99,                                              
004050           DFHEIV99,                                              
004051           DFHEIV99,                                              
004052           DFHEIV99,                                              
004053           DFHEIV99,                                              
004054           DFHEIV99,                                              
004055           DFHEIV99,                                              
004056           DFHEIV99,                                              
004057           DFHEIV99                                               
004058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
004059                                                                  
004060*      MOVE 'ERRE' TO DFHC0040                                    
004061*     CALL 'DFHEI1' USING DFHEIV0  DFHEID0 DFHDUMMY DFHC0040      
004062*    WCOM-AREAXXXX WCOM-LUNGHEZZ EIBTRMID.                        
004063                                                                  
004064* EXEC CICS ABEND ABCODE (WCOM-ABENCICS)                          
004065*                CANCEL                                           
004066*END-EXEC.                                                        
004067*    MOVE '.,AC                  "   #00003655' TO DFHEIV0        
004068     MOVE X'2E2C41432020202020202020' &                           
004069          X'202020202020202020202220' &                           
004070          X'2020233030303033363535' TO DFHEIV0                    
004071     CALL 'kxdfhei1' USING DFHEIV0,                               
004072           WCOM-ABENCICS                                          
004073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
004074                                                                  
004075*     CALL 'DFHEI1' USING DFHEIV0  WCOM-ABENCICS.                 
004076 Z00-EX. EXIT.                                                    
004077*----------------------------------------------------------------*
004078                                                                  
004079 9999-DFHBACK SECTION.                                            
004080     MOVE '9%                    "   ' TO DFHEIV0                 
004081     MOVE 'AVTLO60' TO DFHEIV1                                    
004082     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1                        
004083     GOBACK.                                                      
004084 9999-DFHEXIT.                                                    
004085     IF DFHEIGDJ EQUAL 0001                                       
004086         NEXT SENTENCE                                            
004087     ELSE IF DFHEIGDJ EQUAL 2                                     
004088         GO TO Z00-ERRORE                                         
004089         DEPENDING ON DFHEIGDI                                    
004090     ELSE IF DFHEIGDJ EQUAL 3                                     
004091         GO TO B05-NORESP                                         
004092         DEPENDING ON DFHEIGDI                                    
004093     ELSE IF DFHEIGDJ EQUAL 4                                     
004094         GO TO R00-EX,                                            
004095               R00-EX                                             
004096         DEPENDING ON DFHEIGDI                                    
004097     ELSE IF DFHEIGDJ EQUAL 5                                     
004098         GO TO LEGGO-RICICLO-EX,                                  
004099               LEGGO-RICICLO-EX                                   
004100         DEPENDING ON DFHEIGDI.                                   
004101     MOVE '9%                    "   ' TO DFHEIV0                 
004102     MOVE 'AVTLO60' TO DFHEIV1                                    
004103     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1                        
004104     GOBACK.                                                      
