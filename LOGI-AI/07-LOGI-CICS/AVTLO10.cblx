      *((program: AVTLO10.cblx))
000001******************  PGM. - COBOL2 - TP - DB2  ********************
000002 ID  DIVISION.                                                    
000003 PROGRAM-ID. AVTLO10.                    
000004******************************************************************
000005* LISTINI DI TRASPORTO PER ADDEBITI INTERNI                      *
000006******************************************************************
000007 ENVIRONMENT DIVISION.                                            
000008 CONFIGURATION SECTION.                                           
000009 SPECIAL-NAMES.                                                   
000010     DECIMAL-POINT IS COMMA.                                      
000011 DATA DIVISION.                                                   
000012*--------------*                                                  
000013 WORKING-STORAGE SECTION.

       01  SQLDA-ID pic 9(4) comp-5.
       01  SQLDSIZE pic 9(4) comp-5.
       01  SQL-STMT-ID pic 9(4) comp-5.
       01  SQLVAR-INDEX pic 9(4) comp-5.
       01  SQL-DATA-TYPE pic 9(4) comp-5.
       01  SQL-HOST-VAR-LENGTH pic 9(9) comp-5.
       01  SQL-S-HOST-VAR-LENGTH pic 9(9) comp-5.
       01  SQL-S-LITERAL pic X(258).
       01  SQL-LITERAL1 pic X(130).
       01  SQL-LITERAL2 pic X(130).
       01  SQL-LITERAL3 pic X(130).
       01  SQL-LITERAL4 pic X(130).
       01  SQL-LITERAL5 pic X(130).
       01  SQL-LITERAL6 pic X(130).
       01  SQL-LITERAL7 pic X(130).
       01  SQL-LITERAL8 pic X(130).
       01  SQL-LITERAL9 pic X(130).
       01  SQL-LITERAL10 pic X(130).
       01  SQL-IS-LITERAL pic 9(4) comp-5 value 1.
       01  SQL-IS-INPUT-HVAR pic 9(4) comp-5 value 2.
       01  SQL-CALL-TYPE pic 9(4) comp-5.
       01  SQL-SECTIONUMBER pic 9(4) comp-5.
       01  SQL-INPUT-SQLDA-ID pic 9(4) comp-5.
       01  SQL-OUTPUT-SQLDA-ID pic 9(4) comp-5.
       01  SQLA-PROGRAM-ID.
           05 SQL-PART1 pic 9(4) COMP-5 value 172.
           05 SQL-PART2 pic X(6) value "AEAQAI".
           05 SQL-PART3 pic X(24) value "vAEDMfFn01111 2         ".
           05 SQL-PART4 pic 9(4) COMP-5 value 8.
           05 SQL-PART5 pic X(8) value "DB2XMT  ".
           05 SQL-PART6 pic X(120) value LOW-VALUES.
           05 SQL-PART7 pic 9(4) COMP-5 value 8.
           05 SQL-PART8 pic X(8) value "AVTLO10 ".
           05 SQL-PART9 pic X(120) value LOW-VALUES.
                                                                        
000014 01  DFH-START PIC X(04).                                         
000015*------------------------*                                        
000016 01  FILLER                      PIC X(08) VALUE 'DCWCOMMA'.      
000017*    COPY DCWCOMMA.                                               
000018*---------------------------------------------------------------* 
000019*----*            AREA DI PASSAGGIO DATI - WWTERRE         *----* 
000020*---------------------------------------------------------------* 
000021 01  WCOM-LUNGHERR                PIC S9(4) COMP VALUE +200.      
000022 01  WCOM-AREA-ERROR.                                             
000023     02 FILLER                    PIC X(8) VALUE 'CICSERRO'.      
000024     02 WCOM-FILEMESG.                                            
000025        04 WCOM-FILEFUNZ          PIC X(10).                      
000026        04 WCOM-FILESTAT          PIC X(5).                       
000027        04 WCOM-SQLCODEX REDEFINES WCOM-FILESTAT                  
000028                                  PIC -Z(4).                      
000029        04 WCOM-FILENOME          PIC X(30).                      
000030        04 WCOM-FILECTR1.                                         
000031           05 WCOM-FILECTRL       PIC X(35).                      
000032     02 WCOM-MESSAGE1 REDEFINES WCOM-FILEMESG.                    
000033        05 WCOM-MESSAGES          PIC X(80).                      
000034     02 WCOM-CODABEND             PIC X(4).                       
000035     02 WCOM-ABENCICS             PIC X(4).                       
000036     02 WCOM-PRGMLINE             PIC X(5)  VALUE SPACES.         
000037     02 WCOM-CODEIBFN             PIC X(2).                       
000038     02 WCOM-CODERCOD             PIC X(6).                       
000039     02 FILLER                    PIC X(91).                      
000040*---------------------------------------------------------------* 
000041*----*                AREA DI COMMAREA                     *----* 
000042*---------------------------------------------------------------* 
000043*---------------------- LUNGHEZZA WCOM-AREAXXXX                   
000044 01  WCOM-LUNGHEZZ                     PIC S9(4) COMP VALUE +300. 
000045*---------------------- NOME DEL PROGRAMMA                        
000046 01  WCOM-AREAXXXX.                                               
000047     05  WCOM-NOMEPRGM                 PIC X(8)  VALUE SPACES.    
000048*---------------------- PAGINA RICHIESTA                          
000049     05  WCOM-PAGIRICH                 PIC S9(5) COMP-3.          
000050*---------------------- PAGINA LISTATA                            
000051     05  WCOM-PAGILIST                 PIC S9(5) COMP-3.          
000052*---------------------- PAGINA ULTIMA                             
000053     05  WCOM-PAGIULTI                 PIC S9(5) COMP-3.          
000054*---------------------- FLAG PER MODULO GESTIONE FUNZIONI ESTERNE 
000055     05  WCOM-FLAGFUNZ.                                           
000056         10  WCOM-RETURNXX             PIC X(1).                  
000057         10  WCOM-DELETETS             PIC X(1).                  
000058         10  WCOM-CODILING             PIC X(1).                  
000059*---------------------- FLAG PER AGGIORNAMENTI                    
000060     05  WCOM-FLAGPRGM                 PIC X(1)  VALUE SPACES.    
000061*---------------------- SOTTOSISTEMA CICS                         
000062     05  WCOM-SYSID                    PIC X(4)  VALUE '????'.    
000063*---------------------- PRINTER ABBINATA CON 'P'                  
000064     05  WCOM-PRINTERX                 PIC X(4).                  
000065*---------------------- PRINTER ASSOCIATA MAG. FINITI             
000066     05  WCOM-PRINTERY                 PIC X(4).                  
000067*---------------------- PRINTER ASSOCIATA ALLA TRANSAZIONE        
000068     05  WCOM-PRINTERT                 PIC X(4).                  
000069*---------------------- PRINTER BAR-CODE O MODULI SPECIALI        
000070     05  WCOM-PRINTERB                 PIC X(4).                  
000071*---------------------- TRANSAZIONE                               
000072     05  WCOM-TRANSAZI                 PIC X(4).                  
000073*---------------------- DATA DEL GIORNO DA MENU'                  
000074     05  WCOM-DATAXXXX.                                           
000075         10  WCOM-DATAGGXX             PIC X(2).                  
000076         10  WCOM-DATAGGXN REDEFINES WCOM-DATAGGXX  PIC 9(2).     
000077         10  WCOM-BARRAUNO             PIC X(1).                  
000078         10  WCOM-DATAMMXX             PIC X(2).                  
000079         10  WCOM-DATAMMXN REDEFINES WCOM-DATAMMXX  PIC 9(2).     
000080         10  WCOM-BARRADUE             PIC X(1).                  
000081         10  WCOM-DATAAAXX.                                       
000082             15 WCOM-DATAAAX1          PIC 9(1).                  
000083             15 WCOM-DATAAAX2          PIC 9(1).                  
000084         10  WCOM-DATAAAXN REDEFINES WCOM-DATAAAXX  PIC 9(2).     
000085*---------------------- NOME DELLA CODA TS GENERICA               
000086     05  WCOM-CODATSXX.                                           
000087         10 WCOM-CODATSX1              PIC X(4)  VALUE SPACES.    
000088         10 WCOM-CODATSX2              PIC X(4)  VALUE SPACES.    
000089*---------------------- DATA DEL GIORNO                           
000090     05  WCOM-DTCREAZI.                                           
000091         10 WCOM-DTCREAZI-SY.                                     
000092            15 WCOM-DTCREAZI-SS        PIC X(2).                  
000093            15 WCOM-DTCREAZI-YY        PIC X(2).                  
000094         10 WCOM-DTCREAZI-SYN REDEFINES WCOM-DTCREAZI-SY PIC 9(4).
000095         10 WCOM-DTCREAZI-MM           PIC X(2).                  
000096         10 WCOM-DTCREAZI-DD           PIC X(2).                  
000097*---------------------- CODICE UTENTE                             
000098     05  WCOM-UTENCICS                 PIC X(6).                  
000099*---------------------- TRANSAZIONI NELL' AMBITO DELLA RICHIESTA  
000100     05  WCOM-INDITRAN                 PIC 9(2).                  
000101     05  WCOM-TABETRAN.                                           
000102         10  WCOM-MENUTRAN  OCCURS 10  PIC X(4).                  
000103         10  WCOM-PAGITRAN  OCCURS 10  PIC S9(5) COMP-3.          
000104*---------------------- FLAG AVVISI UTENTI/TRANSAZIONI DA SCTUTENT
000105     05  WCOM-FLAGUTEN                 PIC X(1).                  
000106     05  WCOM-FLAGTRAN                 PIC X(1).                  
000107*---------------------- FLAG UTENTI LIMITATI                      
000108     05  WCOM-FLAGLIMI                 PIC X(1).                  
000109*---------------------- LIBERI                                    
000110     05  FILLER                        PIC X(25).                 
000111*---------------------- RICHIESTA                                 
000112     05  WCOM-RIKIESTA.                                           
000113         10   WCOM-COMODOXX            PIC X(125).                
000114*    COPY DCLOGI.                                                 
000115******************************************************************
000116*                        *** DCLOGI ***                          *
000117*     DSECT RELATIVA ALLA COMMAREA DEGLI ORDINI DI LOGISTICA     *
000118*                    - LUNGHEZZA 175 BYTES -                     *
000119******************************************************************
000120         10  FILLER                           PIC X(200).         
000121     05  WORK-RICHIESTA REDEFINES WCOM-RIKIESTA.                  
000122         10  WCOM-DCLOGI.                                         
000123             15  WCOM-CODUTENT                PIC X(06).          
000124             15  WCOM-CODSOCIE                PIC X(02).          
000125             15  WCOM-CDDIVISI                PIC X(01).          
000126             15  WCOM-CODDEPOS                PIC X(02).          
000127             15  WCOM-CODCLIEN                PIC X(05).          
000128             15  WCOM-CLIFOCON                PIC X(05).          
000129             15  WCOM-CODSERVI                PIC X(06).          
000130             15  WCOM-TIPSERVI                PIC X(01).          
000131             15  WCOM-CODDIVIS                PIC X(02).          
000132             15  WCOM-UNMISURA                PIC X(02).          
000133             15  WCOM-AANUMORD                PIC X(08).          
000134             15  WCOM-NRRIGORD                PIC S9(3)  COMP-3.  
000135             15  WCOM-CONTODCE                PIC X(06).          
000136             15  WCOM-SALDATOX                PIC X(01).          
000137             15  WCOM-OPERAZIO                PIC X(01).          
000138             15  WCOM-DECIDIVI                PIC X(01).          
000139             15  WCOM-CONTOPER                PIC S9(5)  COMP-3.  
000140             15  WCOM-CODERROR                PIC X(05).          
000141             15  WCOM-FLAGAUTO                PIC X(01).          
000142             15  WCOM-SOCIEMER                PIC X(02).          
000143             15  WCOM-TIPOARTI                PIC X(01).          
000144             15  WCOM-PAESPROV                PIC X(03).          
000145             15  WCOM-PAESMERC                PIC X(03).          
000146             15  WCOM-DTCARORD                PIC X(08).          
000147             15  WCOM-FLAGMANU                PIC X(01).          
000148             15  WCOM-FLAGGIVA                PIC X(01).          
000149             15  WCOM-TIPORECO                PIC X(04).          
000150             15  WCOM-AANUMFAT                PIC X(08).          
000151             15  WCOM-DTFATTUR                PIC X(08).          
000152             15  WCOM-NRPREATT                PIC X(18).          
000153             15  WCOM-DTPREATT                PIC X(08).          
000154             15  WCOM-STATUSXX                PIC X(01).          
000155             15  WCOM-AAMMCOMP                PIC X(06).          
000156             15  WCOM-CENCOSTD                PIC X(05).          
000157             15  WCOM-CENCOSTA                PIC X(05).          
000158             15  WCOM-ESENTIVA                PIC X(01).          
000159             15  FILLER                       PIC X(32).          
000160*--------------------------------------------------------------*  
000161     10  WCOM-DESSERVI           PIC X(40).                       
000162     10  WCOM-CODALOGI           PIC X(4).                        
000163     10  FILLER                  PIC X(105).                      
000164     10  WCOM-TIPOPAGI           PIC X(1).                        
000165 01  FILLER                      PIC X(8) VALUE 'DCWWORK1'.       
000166*    COPY   DCWWORK1.                                             
000167***************************************************************** 
000168******            DATI DI USO GENERALE      (DCWWORK1)     ****** 
000169***************************************************************** 
000170 01  DCW-WORK1.                                                   
000171*----------------- NOME MAPPA CON GESTIONE CODICE LINGUA          
000172     05 WNOMEMAP.                                                 
000173        10  FILLER                     PIC X(2).                  
000174        10  WCODLING                   PIC X.                     
000175        10  FILLER                     PIC X(4).                  
000176*----------------- COMODO LINEA CONTENENTE L'ULTIMO EXEC CICS     
000177     05 WLINEAXX.                                                 
000178        10  EL-LINE    OCCURS 5        PIC X.                     
000179*----------------- COMODO CONTENENTE DFHEIV0                      
000180     05 T-COMLINE.                                                
000181        10  EL-COMLINE OCCURS 29       PIC X.                     
000182*----------------- INDICE PER SCORRERE LA T-COMLINE.              
000183     05 INDERR                         PIC S9(5) COMP-3 VALUE +0. 
000184*----------------- TRANSAZIONE IMPOSTATA AL MOMENTO DEL PF5 / PF4 
000185     05 WTRANSID                       PIC X(4) VALUE SPACES.     
000186*----------------- INDICE DELLA RIGA DI MAPPA                     
000187     05 WINDRIGA                       PIC S9(3) COMP-3 VALUE +0. 
000188*----------------- NUMERO MASSIMO DI RIGHE IN UNA MAPPA           
000189     05 WNUMRIGA                       PIC 9(2)        VALUE 0.   
000190*----------------- FLAG PER GLI ERRORI A LIVELLO DI DATI-MAPPA    
000191     05 WSWERROR                       PIC X      VALUE SPACES.   
000192        88 ERRORE                                 VALUE '*'.      
000193*----------------- NUMERO PAGINA RICHIESTO                        
000194     05 WPAGRICH                       PIC S9(5) COMP-3 VALUE +0. 
000195*----------------- NUMERO RECORD CODA-TS                          
000196     05 WNUMITEM                       PIC S9(4) COMP VALUE +0.   
000197*----------------- INDICE DELLA CODA DI PAGINAZIONE TS            
000198     05 WPAGIPAG                       PIC S9(4) COMP VALUE +0.   
000199*----------------- CHIAVE DELLA CODA DI PAGINAZIONE TS            
000200     05 WPAGCTRL.                                                 
000201        10  WPAGNOME                   PIC X(4)    VALUE 'PAGI'.  
000202        10  WPAGVIDE                   PIC X(4).                  
000203*----------------- LUNGHEZZA  CODA DI PAGINAZIONE TS              
000204     05 WPAGLPAG                       PIC S9(4) COMP VALUE +0.   
000205*----------------- ABSOLUTE TIME                                  
000206     05 WABSTIME                       PIC S9(15) COMP-3 VALUE +0.
000207*----------------- ABSOLUTE YEAR                                  
000208     05 WABSYEAR                       PIC S9(8) COMP VALUE +0.   
000209*----------------- FOR RESP OPTION                                
000210     05 WEIBRESP                       PIC S9(8) COMP VALUE +0.   
000211*----------------- FOR CVDA  (CICS VALUE DATA AREA)               
000212     05 WNOLOG                         PIC S9(8) COMP VALUE +0.   
000213     05 WCVDA                          PIC S9(8) COMP VALUE +0.   
000214     05 WCVDA-OPEN                     PIC S9(8) COMP VALUE +18.  
000215     05 WCVDA-CLOSED                   PIC S9(8) COMP VALUE +19.  
000216*----------------- FOR BIF DEEDIT                                 
000217     05 WWTWSNU                        PIC X(8) VALUE 'WWTWSNU'.  
000218     05 WLENGTH                        PIC S9(4) COMP.            
000219*----------------- AREA DELLA CODA TS DI PAGINAZIONE              
000220 01  WPAGREFE.                                                    
000221     05  FILLER                        PIC X    VALUE SPACES.     
000222     05  WPAGREF1 OCCURS 19.                                      
000223         10  WPAG-CODSERVI       PIC X(06).                       
000224         10  WPAG-DESSERVI       PIC X(40).                       
000225         10  WPAG-UNMISURA       PIC X(02).                       
000226         10  WPAG-TIPSERVI       PIC X(01).                       
000227         10  WPAG-FLAGORDI       PIC X(01).                       
000228         10  WPAG-CONTODCD       PIC X(06).                       
000229         10  WPAG-CONTODCA       PIC X(06).                       
000230         10  WPAG-CENCOSTA       PIC X(05).                       
000231         10  WPAG-CONTPROV       PIC X(06).                       
000232         10  WPAG-ESENTIVA       PIC X(01).                       
000233 01  WLO50-CODA.                                                  
000234     05 WLO50-TIPSERVI           PIC X(01).                       
000235     05 WLO50-CODSOCIE           PIC X(02).                       
000236     05 WLO50-WINDRIGA           PIC 9(02).                       
000237     05 WLO50-RIGA OCCURS 18.                                     
000238         10 WLO50-CODSERVI       PIC X(06).                       
000239         10 WLO50-DESSERVI       PIC X(40).                       
000240         10 WLO50-UNMISURA       PIC X(02).                       
000241         10 WLO50-PREZZLIS       PIC S9(07)V9(4) COMP-3.          
000242         10 WLO50-PERCLIST       PIC S9(03)V99   COMP-3.          
000243 01  WLO20-CODA.                                                  
000244     05 WLO20-CODCLIEN           PIC X(05).                       
000245     05 WLO20-NOMCLIEN           PIC X(24).                       
000246     05 WLO20-FLAGGIVA           PIC X(01).                       
000247     05 WLO20-ESENTIVA           PIC X(01).                       
000248     05 WLO20-AANUMORD           PIC X(08).                       
000249     05 WLO20-DTCARORD           PIC X(06).                       
000250     05 WLO20-AAMMCOMP           PIC X(06).                       
000251     05 WLO20-TIPSERVI           PIC X(01).                       
000252     05 WLO20-DESTIPSE           PIC X(09).                       
000253     05 WLO20-CONTODCE           PIC X(06).                       
000254     05 WLO20-DESCRDCE           PIC X(15).                       
000255     05 WLO20-CODDIVIS           PIC X(02).                       
000256     05 WLO20-SIGLADIV           PIC X(03).                       
000257     05 WLO20-AANUMFAT           PIC X(08).                       
000258     05 WLO20-DTFATTUR           PIC X(06).                       
000259     05 WLO20-NRPREATT           PIC X(10).                       
000260     05 WLO20-DTPREATT           PIC X(06).                       
000261     05 WLO20-FLAGAUTO           PIC X(01).                       
000262     05 WLO20-MESSWARN           PIC X(25).                       
000263     05 WLO20-CODSOCIE           PIC X(02).                       
000264     05 WLO20-WINDRIGA           PIC 9(02).                       
000265     05 WLO20-WNUMRIGA           PIC S9(5) COMP-3.                
000266     05 WLO20-CODCONSO           PIC X(02).                       
000267     05 WLO20-DTEVAORD           PIC X(06).                       
000268     05 WLO20-RIGA OCCURS 9.                                      
000269         10 WLO20-CODSERVI       PIC X(06).                       
000270         10 WLO20-DESSERVI       PIC X(40).                       
000271         10 WLO20-UNMISURA       PIC X(02).                       
000272 01  FILLER                      PIC X(8)  VALUE '*COMODI*'.      
000273 01  COMODI.                                                      
000274     05 WS-OPERAZIO              PIC X(01).                       
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000275     05 MIN-TIPSERVI             PIC X(01).                       
000276     05 MAX-TIPSERVI             PIC X(01).                       
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000277     05 IND1                     PIC S9(3) COMP-3.                
000278     05 WPAGLO50.                                                 
000279        10 FILLER                PIC X(04)  VALUE 'SERV'.         
000280        10 WLO50-TERMINAL        PIC X(04).                       
000281     05 WLO50-LENGTH             PIC S9(4) COMP.                  
000282     05 WLO50-ITEM               PIC S9(4) COMP.                  
000283     05 WLO50-WNUMRIGA           PIC S9(5) COMP-3.                
000284     05 WPAGLO20.                                                 
000285        10 FILLER                PIC X(04)  VALUE 'ORDI'.         
000286        10 WLO20-TERMINAL        PIC X(04).                       
000287     05 WLO20-LENGTH             PIC S9(4) COMP.                  
000288     05 WLO20-ITEM               PIC S9(4) COMP.                  
000289 01  FILLER                      PIC X(8) VALUE '*AVMLO10'.       
000290*    COPY AVMLO10.                                                
000291*   Micro Focus Enterprise Developer  2.2.01204                   
000292*   Micro Focus BMS Screen Painter (ver BMSIDE_2-2-20)            
000293*   MapSet Name   AVMLO10                                         
000294*   Date Created  05/15/2019                                      
000295*   Time Created  15:10:44                                        
000296*  Input Data For Map AVILO10                                     
000297   01 AVILO10I.                                                   
000298      03 FILLER                         PIC X(12).                
000299      03 LO10-MAPDATAL                  PIC S9(4) COMP.           
000300      03 LO10-MAPDATAF                  PIC X.                    
000301      03 FILLER REDEFINES LO10-MAPDATAF.                          
000302         05 LO10-MAPDATAA                  PIC X.                 
000303      03 FILLER                         PIC X(4).                 
000304      03 LO10-MAPDATAI                  PIC X(10).                
000305      03 LO10-MAPORAXL                  PIC S9(4) COMP.           
000306      03 LO10-MAPORAXF                  PIC X.                    
000307      03 FILLER REDEFINES LO10-MAPORAXF.                          
000308         05 LO10-MAPORAXA                  PIC X.                 
000309      03 FILLER                         PIC X(4).                 
000310      03 LO10-MAPORAXI                  PIC X(8).                 
000311      03 LO10-ICODSERVL                 PIC S9(4) COMP.           
000312      03 LO10-ICODSERVF                 PIC X.                    
000313      03 FILLER REDEFINES LO10-ICODSERVF.                         
000314         05 LO10-ICODSERVA                 PIC X.                 
000315      03 FILLER                         PIC X(4).                 
000316      03 LO10-ICODSERVI                 PIC X(6).                 
000317      03 LO10-IDESSERVL                 PIC S9(4) COMP.           
000318      03 LO10-IDESSERVF                 PIC X.                    
000319      03 FILLER REDEFINES LO10-IDESSERVF.                         
000320         05 LO10-IDESSERVA                 PIC X.                 
000321      03 FILLER                         PIC X(4).                 
000322      03 LO10-IDESSERVI                 PIC X(40).                
000323      03 LO10-ITIPSERVL                 PIC S9(4) COMP.           
000324      03 LO10-ITIPSERVF                 PIC X.                    
000325      03 FILLER REDEFINES LO10-ITIPSERVF.                         
000326         05 LO10-ITIPSERVA                 PIC X.                 
000327      03 FILLER                         PIC X(4).                 
000328      03 LO10-ITIPSERVI                 PIC X(1).                 
000329      03 LO10-ODESTIPSL                 PIC S9(4) COMP.           
000330      03 LO10-ODESTIPSF                 PIC X.                    
000331      03 FILLER REDEFINES LO10-ODESTIPSF.                         
000332         05 LO10-ODESTIPSA                 PIC X.                 
000333      03 FILLER                         PIC X(4).                 
000334      03 LO10-ODESTIPSI                 PIC X(10).                
000335      03 LO10-TESTATA1L                 PIC S9(4) COMP.           
000336      03 LO10-TESTATA1F                 PIC X.                    
000337      03 FILLER REDEFINES LO10-TESTATA1F.                         
000338         05 LO10-TESTATA1A                 PIC X.                 
000339      03 FILLER                         PIC X(4).                 
000340      03 LO10-TESTATA1I                 PIC X(13).                
000341      03 LO10-PF11PF12L                 PIC S9(4) COMP.           
000342      03 LO10-PF11PF12F                 PIC X.                    
000343      03 FILLER REDEFINES LO10-PF11PF12F.                         
000344         05 LO10-PF11PF12A                 PIC X.                 
000345      03 FILLER                         PIC X(4).                 
000346      03 LO10-PF11PF12I                 PIC X(5).                 
000347      03 LO10-TESTATA2L                 PIC S9(4) COMP.           
000348      03 LO10-TESTATA2F                 PIC X.                    
000349      03 FILLER REDEFINES LO10-TESTATA2F.                         
000350         05 LO10-TESTATA2A                 PIC X.                 
000351      03 FILLER                         PIC X(4).                 
000352      03 LO10-TESTATA2I                 PIC X(6).                 
000353      03 LO10-TESTATA3L                 PIC S9(4) COMP.           
000354      03 LO10-TESTATA3F                 PIC X.                    
000355      03 FILLER REDEFINES LO10-TESTATA3F.                         
000356         05 LO10-TESTATA3A                 PIC X.                 
000357      03 FILLER                         PIC X(4).                 
000358      03 LO10-TESTATA3I                 PIC X(6).                 
000359      03 LO10-RIGAI                     OCCURS 19 TIMES.          
000360         05 LO10-OPERAZIOL                 PIC S9(4) COMP.        
000361         05 LO10-OPERAZIOF                 PIC X.                 
000362         05 FILLER REDEFINES LO10-OPERAZIOF.                      
000363            07 LO10-OPERAZIOA                 PIC X.              
000364         05 FILLER                         PIC X(4).              
000365         05 LO10-OPERAZIOI                 PIC X(1).              
000366         05 LO10-CODSERVIL                 PIC S9(4) COMP.        
000367         05 LO10-CODSERVIF                 PIC X.                 
000368         05 FILLER REDEFINES LO10-CODSERVIF.                      
000369            07 LO10-CODSERVIA                 PIC X.              
000370         05 FILLER                         PIC X(4).              
000371         05 LO10-CODSERVII                 PIC X(6).              
000372         05 LO10-DESSERVIL                 PIC S9(4) COMP.        
000373         05 LO10-DESSERVIF                 PIC X.                 
000374         05 FILLER REDEFINES LO10-DESSERVIF.                      
000375            07 LO10-DESSERVIA                 PIC X.              
000376         05 FILLER                         PIC X(4).              
000377         05 LO10-DESSERVII                 PIC X(40).             
000378         05 LO10-UNMISURAL                 PIC S9(4) COMP.        
000379         05 LO10-UNMISURAF                 PIC X.                 
000380         05 FILLER REDEFINES LO10-UNMISURAF.                      
000381            07 LO10-UNMISURAA                 PIC X.              
000382         05 FILLER                         PIC X(4).              
000383         05 LO10-UNMISURAI                 PIC X(2).              
000384         05 LO10-TIPSERVIL                 PIC S9(4) COMP.        
000385         05 LO10-TIPSERVIF                 PIC X.                 
000386         05 FILLER REDEFINES LO10-TIPSERVIF.                      
000387            07 LO10-TIPSERVIA                 PIC X.              
000388         05 FILLER                         PIC X(4).              
000389         05 LO10-TIPSERVII                 PIC X(1).              
000390         05 LO10-ESENTIVAL                 PIC S9(4) COMP.        
000391         05 LO10-ESENTIVAF                 PIC X.                 
000392         05 FILLER REDEFINES LO10-ESENTIVAF.                      
000393            07 LO10-ESENTIVAA                 PIC X.              
000394         05 FILLER                         PIC X(4).              
000395         05 LO10-ESENTIVAI                 PIC X(1).              
000396         05 LO10-CONTPROVL                 PIC S9(4) COMP.        
000397         05 LO10-CONTPROVF                 PIC X.                 
000398         05 FILLER REDEFINES LO10-CONTPROVF.                      
000399            07 LO10-CONTPROVA                 PIC X.              
000400         05 FILLER                         PIC X(4).              
000401         05 LO10-CONTPROVI                 PIC X(6).              
000402         05 LO10-CENCOSTAL                 PIC S9(4) COMP.        
000403         05 LO10-CENCOSTAF                 PIC X.                 
000404         05 FILLER REDEFINES LO10-CENCOSTAF.                      
000405            07 LO10-CENCOSTAA                 PIC X.              
000406         05 FILLER                         PIC X(4).              
000407         05 LO10-CENCOSTAI                 PIC X(6).              
000408      03 LO10-MAPRPAGL                  PIC S9(4) COMP.           
000409      03 LO10-MAPRPAGF                  PIC X.                    
000410      03 FILLER REDEFINES LO10-MAPRPAGF.                          
000411         05 LO10-MAPRPAGA                  PIC X.                 
000412      03 FILLER                         PIC X(4).                 
000413      03 LO10-MAPRPAGI                  PIC X(3).                 
000414      03 LO10-MAPPPAGL                  PIC S9(4) COMP.           
000415      03 LO10-MAPPPAGF                  PIC X.                    
000416      03 FILLER REDEFINES LO10-MAPPPAGF.                          
000417         05 LO10-MAPPPAGA                  PIC X.                 
000418      03 FILLER                         PIC X(4).                 
000419      03 LO10-MAPPPAGI                  PIC X(3).                 
000420      03 LO10-MESSAGGL                  PIC S9(4) COMP.           
000421      03 LO10-MESSAGGF                  PIC X.                    
000422      03 FILLER REDEFINES LO10-MESSAGGF.                          
000423         05 LO10-MESSAGGA                  PIC X.                 
000424      03 FILLER                         PIC X(4).                 
000425      03 LO10-MESSAGGI                  PIC X(59).                
000426*  Output Data For Map AVILO10                                    
000427   01 AVILO10O REDEFINES AVILO10I.                                
000428      03 FILLER                         PIC X(12).                
000429      03 FILLER                         PIC X(3).                 
000430      03 LO10-MAPDATAC                  PIC X.                    
000431      03 LO10-MAPDATAP                  PIC X.                    
000432      03 LO10-MAPDATAH                  PIC X.                    
000433      03 LO10-MAPDATAV                  PIC X.                    
000434      03 LO10-MAPDATAO                  PIC X(10).                
000435      03 FILLER                         PIC X(3).                 
000436      03 LO10-MAPORAXC                  PIC X.                    
000437      03 LO10-MAPORAXP                  PIC X.                    
000438      03 LO10-MAPORAXH                  PIC X.                    
000439      03 LO10-MAPORAXV                  PIC X.                    
000440      03 LO10-MAPORAXO                  PIC 99.99.99.             
000441      03 FILLER                         PIC X(3).                 
000442      03 LO10-ICODSERVC                 PIC X.                    
000443      03 LO10-ICODSERVP                 PIC X.                    
000444      03 LO10-ICODSERVH                 PIC X.                    
000445      03 LO10-ICODSERVV                 PIC X.                    
000446      03 LO10-ICODSERVO                 PIC X(6).                 
000447      03 FILLER                         PIC X(3).                 
000448      03 LO10-IDESSERVC                 PIC X.                    
000449      03 LO10-IDESSERVP                 PIC X.                    
000450      03 LO10-IDESSERVH                 PIC X.                    
000451      03 LO10-IDESSERVV                 PIC X.                    
000452      03 LO10-IDESSERVO                 PIC X(40).                
000453      03 FILLER                         PIC X(3).                 
000454      03 LO10-ITIPSERVC                 PIC X.                    
000455      03 LO10-ITIPSERVP                 PIC X.                    
000456      03 LO10-ITIPSERVH                 PIC X.                    
000457      03 LO10-ITIPSERVV                 PIC X.                    
000458      03 LO10-ITIPSERVO                 PIC X(1).                 
000459      03 FILLER                         PIC X(3).                 
000460      03 LO10-ODESTIPSC                 PIC X.                    
000461      03 LO10-ODESTIPSP                 PIC X.                    
000462      03 LO10-ODESTIPSH                 PIC X.                    
000463      03 LO10-ODESTIPSV                 PIC X.                    
000464      03 LO10-ODESTIPSO                 PIC X(10).                
000465      03 FILLER                         PIC X(3).                 
000466      03 LO10-TESTATA1C                 PIC X.                    
000467      03 LO10-TESTATA1P                 PIC X.                    
000468      03 LO10-TESTATA1H                 PIC X.                    
000469      03 LO10-TESTATA1V                 PIC X.                    
000470      03 LO10-TESTATA1O                 PIC X(13).                
000471      03 FILLER                         PIC X(3).                 
000472      03 LO10-PF11PF12C                 PIC X.                    
000473      03 LO10-PF11PF12P                 PIC X.                    
000474      03 LO10-PF11PF12H                 PIC X.                    
000475      03 LO10-PF11PF12V                 PIC X.                    
000476      03 LO10-PF11PF12O                 PIC X(5).                 
000477      03 FILLER                         PIC X(3).                 
000478      03 LO10-TESTATA2C                 PIC X.                    
000479      03 LO10-TESTATA2P                 PIC X.                    
000480      03 LO10-TESTATA2H                 PIC X.                    
000481      03 LO10-TESTATA2V                 PIC X.                    
000482      03 LO10-TESTATA2O                 PIC X(6).                 
000483      03 FILLER                         PIC X(3).                 
000484      03 LO10-TESTATA3C                 PIC X.                    
000485      03 LO10-TESTATA3P                 PIC X.                    
000486      03 LO10-TESTATA3H                 PIC X.                    
000487      03 LO10-TESTATA3V                 PIC X.                    
000488      03 LO10-TESTATA3O                 PIC X(6).                 
000489      03 LO10-RIGAO OCCURS 19.                                    
000490         05 FILLER                         PIC X(3).              
000491         05 LO10-OPERAZIOC                 PIC X.                 
000492         05 LO10-OPERAZIOP                 PIC X.                 
000493         05 LO10-OPERAZIOH                 PIC X.                 
000494         05 LO10-OPERAZIOV                 PIC X.                 
000495         05 LO10-OPERAZIOO                 PIC X(1).              
000496         05 FILLER                         PIC X(3).              
000497         05 LO10-CODSERVIC                 PIC X.                 
000498         05 LO10-CODSERVIP                 PIC X.                 
000499         05 LO10-CODSERVIH                 PIC X.                 
000500         05 LO10-CODSERVIV                 PIC X.                 
000501         05 LO10-CODSERVIO                 PIC X(6).              
000502         05 FILLER                         PIC X(3).              
000503         05 LO10-DESSERVIC                 PIC X.                 
000504         05 LO10-DESSERVIP                 PIC X.                 
000505         05 LO10-DESSERVIH                 PIC X.                 
000506         05 LO10-DESSERVIV                 PIC X.                 
000507         05 LO10-DESSERVIO                 PIC X(40).             
000508         05 FILLER                         PIC X(3).              
000509         05 LO10-UNMISURAC                 PIC X.                 
000510         05 LO10-UNMISURAP                 PIC X.                 
000511         05 LO10-UNMISURAH                 PIC X.                 
000512         05 LO10-UNMISURAV                 PIC X.                 
000513         05 LO10-UNMISURAO                 PIC X(2).              
000514         05 FILLER                         PIC X(3).              
000515         05 LO10-TIPSERVIC                 PIC X.                 
000516         05 LO10-TIPSERVIP                 PIC X.                 
000517         05 LO10-TIPSERVIH                 PIC X.                 
000518         05 LO10-TIPSERVIV                 PIC X.                 
000519         05 LO10-TIPSERVIO                 PIC X(1).              
000520         05 FILLER                         PIC X(3).              
000521         05 LO10-ESENTIVAC                 PIC X.                 
000522         05 LO10-ESENTIVAP                 PIC X.                 
000523         05 LO10-ESENTIVAH                 PIC X.                 
000524         05 LO10-ESENTIVAV                 PIC X.                 
000525         05 LO10-ESENTIVAO                 PIC X(1).              
000526         05 FILLER                         PIC X(3).              
000527         05 LO10-CONTPROVC                 PIC X.                 
000528         05 LO10-CONTPROVP                 PIC X.                 
000529         05 LO10-CONTPROVH                 PIC X.                 
000530         05 LO10-CONTPROVV                 PIC X.                 
000531         05 LO10-CONTPROVO                 PIC X(6).              
000532         05 FILLER                         PIC X(3).              
000533         05 LO10-CENCOSTAC                 PIC X.                 
000534         05 LO10-CENCOSTAP                 PIC X.                 
000535         05 LO10-CENCOSTAH                 PIC X.                 
000536         05 LO10-CENCOSTAV                 PIC X.                 
000537         05 LO10-CENCOSTAO                 PIC X(6).              
000538      03 FILLER                         PIC X(3).                 
000539      03 LO10-MAPRPAGC                  PIC X.                    
000540      03 LO10-MAPRPAGP                  PIC X.                    
000541      03 LO10-MAPRPAGH                  PIC X.                    
000542      03 LO10-MAPRPAGV                  PIC X.                    
000543      03 LO10-MAPRPAGO                  PIC 999.                  
000544      03 FILLER                         PIC X(3).                 
000545      03 LO10-MAPPPAGC                  PIC X.                    
000546      03 LO10-MAPPPAGP                  PIC X.                    
000547      03 LO10-MAPPPAGH                  PIC X.                    
000548      03 LO10-MAPPPAGV                  PIC X.                    
000549      03 LO10-MAPPPAGO                  PIC 999.                  
000550      03 FILLER                         PIC X(3).                 
000551      03 LO10-MESSAGGC                  PIC X.                    
000552      03 LO10-MESSAGGP                  PIC X.                    
000553      03 LO10-MESSAGGH                  PIC X.                    
000554      03 LO10-MESSAGGV                  PIC X.                    
000555      03 LO10-MESSAGGO                  PIC X(59).                
000556 01  FILLER                      PIC X(8) VALUE '*DCMESS*'.       
000557*    COPY DCMESS.                                                 
000558********************     DCMESS           ************************
000559*********  COPY PER ESECUZIONE DELLA SUBROUTINE SRMESS     *******
000560*********  GESTIONE MESSAGGI DI ERRORE TP/BATCH            *******
000561******************************************************************
000562 01  DCMESS.                                                      
000563     05  MESS-CAMPI-INPUT.                                        
000564         10  MESS-CODERROR      PIC X(5)       VALUE SPACES.      
000565         10  MESS-CODILING      PIC X(1)       VALUE SPACES.      
000566     05  MESS-CAMPI-OUTPUT.                                       
000567         10  MESS-MSGERROR.                                       
000568             15  MESS-COMCODER  PIC X(5)       VALUE SPACES.      
000569             15  FILLER         PIC X          VALUE SPACES.      
000570             15  MESS-MESSAGGI  PIC X(66)      VALUE SPACES.      
000571 01  FILLER                      PIC X(8) VALUE '*DFHAID*'.       
000572*    COPY DFHAID   SUPPRESS.                                      
000573***************************************************************** 
000574*                                                               * 
000575* Copyright (c) 2016-2022 NTT DATA, Inc.                        * 
000576* All rights reserved.                                          * 
000577*                                                               * 
000578***************************************************************** 
000579 01  DFHAID.                                                      
000580     02  DFHNULL   PIC X VALUE "-".                               
000581     02  DFHENTER  PIC X VALUE "'".                               
000582     02  DFHCLEAR  PIC X VALUE "_".                               
000583     02  DFHCLRP   PIC X VALUE "|".                               
000584     02  DFHPEN    PIC X VALUE "=".                               
000585     02  DFHOPID   PIC X VALUE "W".                               
000586     02  DFHMSRE   PIC X VALUE "X".                               
000587     02  DFHSTRF   PIC X VALUE "h".                               
000588     02  DFHTRIG   PIC X VALUE '"'.                               
000589     02  DFHPA1    PIC X VALUE "%".                               
000590     02  DFHPA2    PIC X VALUE ">".                               
000591     02  DFHPA3    PIC X VALUE ",".                               
000592     02  DFHPF1    PIC X VALUE "1".                               
000593     02  DFHPF2    PIC X VALUE "2".                               
000594     02  DFHPF3    PIC X VALUE "3".                               
000595     02  DFHPF4    PIC X VALUE "4".                               
000596     02  DFHPF5    PIC X VALUE "5".                               
000597     02  DFHPF6    PIC X VALUE "6".                               
000598     02  DFHPF7    PIC X VALUE "7".                               
000599     02  DFHPF8    PIC X VALUE "8".                               
000600     02  DFHPF9    PIC X VALUE "9".                               
000601     02  DFHPF10   PIC X VALUE ":".                               
000602     02  DFHPF11   PIC X VALUE "#".                               
000603     02  DFHPF12   PIC X VALUE "@".                               
000604     02  DFHPF13   PIC X VALUE "A".                               
000605     02  DFHPF14   PIC X VALUE "B".                               
000606     02  DFHPF15   PIC X VALUE "C".                               
000607     02  DFHPF16   PIC X VALUE "D".                               
000608     02  DFHPF17   PIC X VALUE "E".                               
000609     02  DFHPF18   PIC X VALUE "F".                               
000610     02  DFHPF19   PIC X VALUE "G".                               
000611     02  DFHPF20   PIC X VALUE "H".                               
000612     02  DFHPF21   PIC X VALUE "I".                               
000613     02  DFHPF22   PIC X VALUE "[".                               
000614     02  DFHPF23   PIC X VALUE ".".                               
000615     02  DFHPF24   PIC X VALUE "<".                               
000616 01  FILLER                      PIC X(8) VALUE 'DCWATTRI'.       
000617*    COPY DCWATTRI SUPPRESS.                                      
000618******************************************************************
000619******       VALORI    DEGLI   ATTRIBUTI    (WCOPATTR)      ******
000620******************************************************************
000621 01       DFHBMSCA.                                               
000622   05     DFHBMEOF                    PIC X  VALUE ' '.           
000623*  X'80'  CC DI RITORNO DI UN CAMPO ANNULLATO CON CANCEL F.C.     
000624   05     DFHBMUNP                    PIC X  VALUE ' '.           
000625*  X'40'  NON PROTETTO                                            
000626   05     DFHBMFSE                    PIC X  VALUE 'A'.           
000627*  X'C1'  NON PROTETTO MDT                                        
000628   05     DFHUNPSP                    PIC X  VALUE 'D'.           
000629*  X'C4'  NON PROTETTO SELEZIONABILE                              
000630   05     DFHUNPSM                    PIC X  VALUE 'E'.           
000631*  X'C5'  NON PROTETTO SELEZIONABILE MDT                          
000632   05     DFHBMBRY                    PIC X  VALUE 'H'.           
000633*  X'C8'  NON PROTETTO LUMINOSO SELEZIONABILE                     
000634   05     DFHUNIMD                    PIC X  VALUE 'I'.           
000635*  X'C9'  NON PROTETTO LUMINOSO SELEZIONABILE MDT                 
000636   05     DFHBMDAR                    PIC X  VALUE '<'.           
000637*  X'4C'  NON PROTETTO NON VISIBILE                               
000638   05     DFHUNNOD                    PIC X  VALUE '('.           
000639*  X'4D'  NON PROTETTO NON VISIBILE MDT                           
000640   05     DFHBMUNN                    PIC X  VALUE '&'.           
000641*  X'50'  NON PROTETTO NUMERICO                                   
000642   05     DFHUNNUM                    PIC X  VALUE 'J'.           
000643*  X'D1'  NON PROTETTO NUMERICO MDT                               
000644   05     DFHUNPNS                    PIC X  VALUE 'M'.           
000645*  X'D4'  NON PROTETTO NUMERICO SELEZIONABILE                     
000646   05     DFHUNNSM                    PIC X  VALUE 'N'.           
000647*  X'D5'  NON PROTETTO NUMERICO SELEZIONABILE MDT                 
000648   05     DFHUNNBS                    PIC X  VALUE 'Q'.           
000649*  X'D8'  NON PROTETTO NUMERICO LUMINOSO SELEZIONABILE            
000650   05     DFHUNBSM                    PIC X  VALUE 'R'.           
000651*  X'D9'  NON PROTETTO NUMERICO LUMINOSO SELEZIONABILE MDT        
000652   05     DFHUNPND                    PIC X  VALUE '*'.           
000653*  X'5C'  NON PROTETTO NUMERICO NON VISIBILE                      
000654   05     DFHUNNON                    PIC X  VALUE ')'.           
000655*  X'5D'  NON PROTETTO NUMERICO NON VISIBILE MDT                  
000656   05     DFHBMPRO                    PIC X  VALUE '-'.           
000657*  X'60'  PROTETTO                                                
000658   05     DFHBMPRF                    PIC X  VALUE '/'.           
000659*  X'61'  PROTETTO MDT                                            
000660   05     DFHPROSP                    PIC X  VALUE 'U'.           
000661*  X'E4'  PROTETTO SELEZIONABILE                                  
000662   05     DFHPRSPM                    PIC X  VALUE 'V'.           
000663*  X'E5'  PROTETTO SELEZIONABILE MDT                              
000664   05     DFHPROTI                    PIC X  VALUE 'Y'.           
000665*  X'E8'  PROTETTO LUMINOSO SELEZIONABILE                         
000666   05     DFHPRLSM                    PIC X  VALUE 'Z'.           
000667*  X'E9'  PROTETTO LUMINOSO SELEZIONABILE MDT                     
000668   05     DFHPROTN                    PIC X  VALUE '%'.           
000669*  X'6C'  PROTETTO NON VISIBILE                                   
000670   05     DFHPRODM                    PIC X  VALUE '_'.           
000671*  X'6D'  PROTETTO NON VISIBILE MDT                               
000672   05     DFHBMASK                    PIC X  VALUE '0'.           
000673*  X'F0'  PROTETTO SKIP                                           
000674   05     DFHBMASF                    PIC X  VALUE '1'.           
000675*  X'F1'  PROTETTO SKIP  MDT                                      
000676   05     DFHPRSKS                    PIC X  VALUE '4'.           
000677*  X'F4'  PROTETTO SKIP  SELEZIONABILE                            
000678   05     DFHPSKSM                    PIC X  VALUE '5'.           
000679*  X'F5'  PROTETTO SKIP  SELEZIONABILE MDT                        
000680   05     DFHBMASB                    PIC X  VALUE '8'.           
000681*  X'F8'  PROTETTO SKIP  LUMINOSO SELEZIONABILE                   
000682   05     DFHPROIM                    PIC X  VALUE '9'.           
000683*  X'F9'  PROTETTO SKIP  LUMINOSO SELEZIONABILE MDT               
000684*  05     DFHPRSKD                    PIC X  VALUE ''.           
000685   05     DFHPRSKD                    PIC X  VALUE '@'.           
000686*  X'7C'  PROTETTO SKIP  NON VISIBILE                             
000687   05     DFHPSKDM                    PIC X  VALUE QUOTE.         
000688*  X'7D'  PROTETTO SKIP  NON VISIBILE MDT                         
000689   05     DFHBLUE                     PIC X  VALUE '1'.           
000690*  X'F1'  COLORE BLUE                                             
000691   05     DFHRED                      PIC X  VALUE '2'.           
000692*  X'F2'  COLORE ROSSO                                            
000693   05     DFHPINK                     PIC X  VALUE '3'.           
000694*  X'F3'  COLORE ROSA                                             
000695   05     DFHGREEN                    PIC X  VALUE '4'.           
000696*  X'F4'  COLORE VERDE                                            
000697   05     DFHTURQ                     PIC X  VALUE '5'.           
000698*  X'F5'  COLORE AZZURRO                                          
000699   05     DFHYELLO                    PIC X  VALUE '6'.           
000700*  X'F6'  COLORE GIALLO                                           
000701   05     DFHNEUTR                    PIC X  VALUE '7'.           
000702*  X'F7'  COLORE NEUTRO                                           
000703   05     DFHDFHI                     PIC X  VALUE HIGH-VALUE.    
000704*  X'FF'  TOGLIE LA SOTTOLINEATURA (UNDERLINE)                    
000705   05     DFHUNDLN                    PIC X  VALUE '4'.           
000706*  X'F4'  IMPOSTA LA SOTTOLINEATURA (UNDERLINE)                   
000707   05     DFHREVRS                    PIC X  VALUE '2'.           
000708*  X'F4'  IMPOSTA IL REVERSE                                      
000709   05     DFHALL                      PIC X  VALUE ' '.           
000710*  X'00'  PULISCE GLI ATTRIBUTI PRENDENDO QUELLI DI MAPPA         
000711*------------------------------- DANAGRAF.TSOCIETA                
000712 01  FILLER                      PIC X(8) VALUE 'FDANA531'.       
000713*    EXEC SQL INCLUDE FDANA531 END-EXEC.                          
      *>>((file: FDANA531))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TSOCIETA                  *
000003******************************************************************
000004 01  DCLTSOCIETA.                                                 
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 A531-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000006     10 A531-NOMSOCIE        PIC X(23).                           
000007     10 A531-CODFORNI        PIC X(5).                            
000008     10 A531-TASSINTE        PIC S9(3)V9(2) USAGE COMP-3.         
000009     10 A531-CODPAESE        PIC X(3).                            
000010     10 A531-NRGGRISC        PIC S9(3)V USAGE COMP-3.             
000011     10 A531-CODPIANO        PIC X(2).                            
000012     10 A531-CITTASOC        PIC X(18).                           
000013     10 A531-FLPAGIVA        PIC X(1).                            
000014     10 A531-FLFATACQ        PIC X(1).                            
000015     10 A531-CODAZIEN        PIC X(5).                            
000016     10 A531-FLIVATRA        PIC X(1).                            
000017     10 A531-CODDIVIS        PIC X(2).                            
000018     10 A531-COSTINTE        PIC S9(3)V9(2) USAGE COMP-3.         
000019     10 A531-FLCONTAB        PIC X(1).                            
000020     10 A531-FLAGMAGA        PIC X(1).                            
000021     10 A531-RAGSOCIE        PIC X(50).                           
000022     10 A531-SOCIECON        PIC X(2).                            
000023     10 A531-DTCREAZI        PIC X(8).                            
000024     10 A531-DTULTVAR        PIC X(8).                            
000025     10 A531-CODUTVAR        PIC X(6).                            
000026     10 A531-INDLEGAL        PIC X(35).                           
000027     10 A531-CAPLEGAL        PIC X(5).                            
000028     10 A531-CITLEGAL        PIC X(18).                           
000029     10 A531-CODFISCA        PIC X(16).                           
000030     10 A531-CODDIVRI        PIC X(2).                            
000031     10 A531-SOCIEGTM        PIC X(2).                            
000032     10 A531-GENEFATT        PIC X(1).                            
000033     10 A531-FLAGATTI        PIC X(1).                            
000034     10 A531-DIVISOLD        PIC X(2).                            
000035     10 A531-DTFINOLD        PIC X(8).                            
000036     10 A531-DIVRIOLD        PIC X(2).                            
000037     10 A531-DIVIRIFA        PIC X(2).                            
000038     10 A531-FLEURUSA        PIC X(1).                            
000039     10 A531-FLAGLIMI        PIC X(1).                            
000040     10 A531-FLFILIAL        PIC X(1).                            
000041     10 A531-FLPRESEN        PIC X(1).                            
000042     10 A531-CODSOCPA        PIC X(1).                            
000043     10 A531-FLBOLGVB        PIC X(1).                            
000044     10 A531-FLSTCART        PIC X(1).                            
000045     10 A531-FLDIPEST        PIC X(1).                            
000046     10 A531-CODFIRMA        PIC X(8).                            
000047     10 A531-DESFIRMA        PIC X(24).                           
000048     10 A531-CDSOCJDE        PIC X(5).                            
000049     10 A531-CODFORNV        PIC X(5).                            
000050     10 A531-CODFORNA        PIC X(5).                            
000051     10 A531-IMPCCASO        PIC S9(13) COMP-3.                   
000052     10 A531-TRIBCCIA        PIC X(10).                           
000053     10 A531-PROLEGAL        PIC X(2).                            
000054     10 A531-FLSOCSAP        PIC X(1).                            
000055     10 A531-DIVIXLAV        PIC X(2).                            
000056******************************************************************
000057* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 51      *
000058******************************************************************
      *<<((file: FDANA531))
000714*------------------------------- DANAGRAF.TMESSAGGI               
000715 01  FILLER                      PIC X(8) VALUE 'FDANA846'.       
000716*    EXEC SQL INCLUDE FDANA846 END-EXEC.                          
      *>>((file: FDANA846))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TMESSAGGI)                               *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA846))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        QUOTE                                                   *
000007* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000008******************************************************************
000009     
      *EXEC SQL DECLARE DANAGRAF.TMESSAGGI TABLE                    
000010*     ( CODERROR                       CHAR(5) NOT NULL,           
000011*       CODILING                       CHAR(1) NOT NULL,           
000012*       MSGERROR                       CHAR(60) NOT NULL,          
000013*       TIPOMESS                       CHAR(1) NOT NULL,           
000014*       DTCREAZI                       CHAR(8) NOT NULL,           
000015*       DTULTVAR                       CHAR(8) NOT NULL,           
000016*       CODUTVAR                       CHAR(6) NOT NULL            
000017*     ) END-EXEC
                                                                        
000018******************************************************************
000019* COBOL DECLARATION FOR TABLE DANAGRAF.TMESSAGGI                 *
000020******************************************************************
000021 01  DCLTMESSAGGI.                                                
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000022     10 A846-CODERROR        PIC X(5).                            
000023     10 A846-CODILING        PIC X(1).                            
000024     10 A846-MSGERROR        PIC X(60).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025     10 A846-TIPOMESS        PIC X(1).                            
000026     10 A846-DTCREAZI        PIC X(8).                            
000027     10 A846-DTULTVAR        PIC X(8).                            
000028     10 A846-CODUTVAR        PIC X(6).                            
000029******************************************************************
000030* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 7       *
000031******************************************************************
      *<<((file: FDANA846))
000717*------------------------------- DANAGRAF.TCENCOSTO               
000718 01  FILLER                      PIC X(8) VALUE 'FDANA982'.       
000719*    EXEC SQL INCLUDE FDANA982 END-EXEC.                          
      *>>((file: FDANA982))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TCENCOSTO)                               *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA982))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(A982-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DANAGRAF.TCENCOSTO TABLE                    
000012*     ( CODSOCIE                       CHAR(2) NOT NULL,           
000013*       CENCOSTO                       CHAR(5) NOT NULL,           
000014*       DESCENCO                       CHAR(30) NOT NULL,          
000015*       RAGCENCO                       CHAR(3) NOT NULL,           
000016*       ANNULLAM                       CHAR(1) NOT NULL,           
000017*       NEWCENCO                       CHAR(5) NOT NULL,           
000018*       CENCOLIS                       CHAR(5) NOT NULL,           
000019*       DTCREAZI                       CHAR(8) NOT NULL,           
000020*       DTULTVAR                       CHAR(8) NOT NULL,           
000021*       CODUTVAR                       CHAR(6) NOT NULL,           
000022*       CDMCAGTM                       CHAR(1) NOT NULL,           
000023*       CDAREGTM                       CHAR(2) NOT NULL,           
000024*       CDDIPGTM                       CHAR(1) NOT NULL,           
000025*       CDUBIGTM                       CHAR(2) NOT NULL,           
000026*       CDLINGTM                       CHAR(2) NOT NULL,           
000027*       SIGLCALE                       CHAR(3) NOT NULL,           
000028*       GRUPSIGE                       CHAR(1) NOT NULL,           
000029*       CDDIVISI                       CHAR(1) NOT NULL            
000030*     ) END-EXEC
                                                                        
000031******************************************************************
000032* COBOL DECLARATION FOR TABLE DANAGRAF.TCENCOSTO                 *
000033******************************************************************
000034 01  DCLTCENCOSTO.                                                
000035*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000036     10 A982-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000037*                       CENCOSTO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000038     10 A982-CENCOSTO        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000039*                       DESCENCO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000040     10 A982-DESCENCO        PIC X(30).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000041*                       RAGCENCO                                  
000042     10 A982-RAGCENCO        PIC X(3).                            
000043*                       ANNULLAM                                  
000044     10 A982-ANNULLAM        PIC X(1).                            
000045*                       NEWCENCO                                  
000046     10 A982-NEWCENCO        PIC X(5).                            
000047*                       CENCOLIS                                  
000048     10 A982-CENCOLIS        PIC X(5).                            
000049*                       DTCREAZI                                  
000050     10 A982-DTCREAZI        PIC X(8).                            
000051*                       DTULTVAR                                  
000052     10 A982-DTULTVAR        PIC X(8).                            
000053*                       CODUTVAR                                  
000054     10 A982-CODUTVAR        PIC X(6).                            
000055*                       CDMCAGTM                                  
000056     10 A982-CDMCAGTM        PIC X(1).                            
000057*                       CDAREGTM                                  
000058     10 A982-CDAREGTM        PIC X(2).                            
000059*                       CDDIPGTM                                  
000060     10 A982-CDDIPGTM        PIC X(1).                            
000061*                       CDUBIGTM                                  
000062     10 A982-CDUBIGTM        PIC X(2).                            
000063*                       CDLINGTM                                  
000064     10 A982-CDLINGTM        PIC X(2).                            
000065*                       SIGLCALE                                  
000066     10 A982-SIGLCALE        PIC X(3).                            
000067*                       GRUPSIGE                                  
000068     10 A982-GRUPSIGE        PIC X(1).                            
000069*                       CDDIVISI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000070     10 A982-CDDIVISI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000071******************************************************************
000072* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 18      *
000073******************************************************************
      *<<((file: FDANA982))
000720*------------------------------- DCONTCLI.TCONTIDCE               
000721 01  FILLER                      PIC X(8) VALUE 'FDCLI861'.       
000722*    EXEC SQL INCLUDE FDCLI861 END-EXEC.                          
      *>>((file: FDCLI861))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DCONTCLI.TCONTIDCE                 *
000003******************************************************************
000004 01  DCLTCONTIDCE.                                                
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 C861-CONTODCE        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000006     10 C861-CODPIANO        PIC X(2).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000007     10 C861-CONTPROV        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000008     10 C861-DESCRDCE        PIC X(25).                           
000009     10 C861-ANNULLAM        PIC X(1).                            
000010     10 C861-TIPCONTO        PIC X(2).                            
000011     10 C861-CONTGRUP        PIC X(6).                            
000012     10 C861-NOTECON1        PIC X(33).                           
000013     10 C861-NOTECON2        PIC X(33).                           
000014     10 C861-INDBILQU        PIC X(1).                            
000015     10 C861-FLCOMMES        PIC X(1).                            
000016******************************************************************
000017* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 11 C861- 
000018******************************************************************
      *<<((file: FDCLI861))
000723*------------------------------- DLOGISTI.TSERVIZI                
000724 01  FILLER                      PIC X(8) VALUE 'FDLOG651'.       
000725*    EXEC SQL INCLUDE FDLOG651 END-EXEC.                          
      *>>((file: FDLOG651))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TSERVIZI                  *
000003******************************************************************
000004 01  DCLTSERVIZI.                                                 
000005*                       CODSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006     10 L651-CODSERVI        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007*                       DESSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000008     10 L651-DESSERVI        PIC X(40).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000009*                       UNMISURA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000010     10 L651-UNMISURA        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000011*                       TIPSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000012     10 L651-TIPSERVI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000013*                       DTCREAZI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000014     10 L651-DTCREAZI        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000015*                       DTULTVAR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000016     10 L651-DTULTVAR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000017*                       CODUTVAR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000018     10 L651-CODUTVAR        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000019*                       CONTODCD                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000020     10 L651-CONTODCD        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000021*                       CONTODCA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000022     10 L651-CONTODCA        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000023*                       CENCOSTA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000024     10 L651-CENCOSTA        PIC X(5).                            
000025     10 L651-ESENTIVA        PIC X(1).                            
000026     10 L651-CONTPROV        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000027******************************************************************
000028* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 12      *
000029******************************************************************
      *<<((file: FDLOG651))
000726*------------------------------- DLOGISTI.TRIGORDILOGI            
000727 01  FILLER                      PIC X(8) VALUE 'FDLOG653'.       
000728*    EXEC SQL INCLUDE FDLOG653 END-EXEC.                          
      *>>((file: FDLOG653))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TRIGORDILOGI              *
000003******************************************************************
000004 01  DCLTRIGORDILOGI.                                             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 L653-AANUMORD        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000006     10 L653-NRRIGORD        PIC S9(5)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000007     10 L653-CODSERVI        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000008     10 L653-UNMISURA        PIC X(2).                            
000009     10 L653-QTAORDIN        PIC S9(7)V9(2) USAGE COMP-3.         
000010     10 L653-PREZZORD        PIC S9(7)V9(4) USAGE COMP-3.         
000011     10 L653-IMPORDIN        PIC S9(11)V9(2) USAGE COMP-3.        
000012     10 L653-NOTENOTE        PIC X(40).                           
000013     10 L653-CENCOSTD        PIC X(5).                            
000014     10 L653-CENCOSTA        PIC X(5).                            
000015     10 L653-RIFECLIE        PIC X(15).                           
000016     10 L653-DTCREAZI        PIC X(8).                            
000017     10 L653-DTULTVAR        PIC X(8).                            
000018     10 L653-CODUTVAR        PIC X(6).                            
000019     10 L653-DTANNULL        PIC X(8).                            
000020     10 L653-IMPORIVA        PIC S9(11)V9(2) USAGE COMP-3.        
000021******************************************************************
000022* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 16      *
000023******************************************************************
      *<<((file: FDLOG653))
000729*------------------------------- DSCORTE.TORDISCORN               
000730 01  FILLER                      PIC X(8) VALUE 'FDSCO478'.       
000731*    EXEC SQL INCLUDE FDSCO478 END-EXEC.                          
      *>>((file: FDSCO478))
000001******************************************************************
000002* DCLGEN TABLE(DSCORTE.TORDISCORN)                               *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDSCO478))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(S478-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011******************************************************************
000012* COBOL DECLARATION FOR TABLE DSCORTE.TORDISCORN                 *
000013******************************************************************
000014 01  DCLTORDISCORN.                                               
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000015     10 S478-AANUMORD        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000016     10 S478-CODSOCIE        PIC X(2).                            
000017     10 S478-CODFORNI        PIC X(5).                            
000018     10 S478-LETTAGEN        PIC X(1).                            
000019     10 S478-DTCARORD        PIC X(8).                            
000020     10 S478-CENCOSTO        PIC X(5).                            
000021     10 S478-CONTODCE        PIC X(6).                            
000022     10 S478-NRCOMMES        PIC X(24).                           
000023     10 S478-CODDIVIS        PIC X(2).                            
000024     10 S478-DATASALD        PIC X(8).                            
000025     10 S478-DTANNULL        PIC X(8).                            
000026     10 S478-CODUTENT        PIC X(6).                            
000027     10 S478-DESCORDI        PIC X(16).                           
000028     10 S478-AANUMRIC        PIC X(8).                            
000029     10 S478-NROFFORN        PIC X(5).                            
000030     10 S478-DTOFFORN        PIC X(8).                            
000031     10 S478-CONFERMA        PIC X(12).                           
000032     10 S478-DTCONFER        PIC X(8).                            
000033     10 S478-NOTEORDI        PIC X(40).                           
000034     10 S478-TIPOPAGA        PIC X(1).                            
000035     10 S478-SCADFORN        PIC X(12).                           
000036     10 S478-GGSCATRA        PIC X(2).                            
000037     10 S478-PERCSCON        PIC S9(3)V9(2) USAGE COMP-3.         
000038     10 S478-DEPDESTI        PIC X(2).                            
000039     10 S478-TIPSPEDI        PIC X(2).                            
000040     10 S478-CODIRESA        PIC X(2).                            
000041     10 S478-CODIMBAL        PIC X(2).                            
000042     10 S478-FLAGSTAM        PIC X(1).                            
000043     10 S478-FLORDPZA        PIC X(1).                            
000044     10 S478-FLAGMAGA        PIC X(1).                            
000045     10 S478-DTCREAZI        PIC X(8).                            
000046     10 S478-DTULTVAR        PIC X(8).                            
000047     10 S478-CODUTVAR        PIC X(6).                            
000048     10 S478-CDEVARIC        PIC X(2).                            
000049     10 S478-DATEMAIL        PIC X(8).                            
000050     10 S478-DTULTSOL        PIC X(8).                            
000051     10 S478-IMPSCONT        PIC S9(11)V9(4) USAGE COMP-3.        
000052     10 S478-PERSCOIM        PIC S9(3)V9(4) USAGE COMP-3.         
000053     10 S478-CATEARTI        PIC X(1).                            
000054     10 S478-TARGVETT        PIC X(9).                            
000055     10 S478-CDDIVISI        PIC X(1).                            
000056     10 S478-CODCLIEN        PIC X(5).                            
000057     10 S478-CENCOSTD        PIC X(5).                            
000058     10 S478-NUMAUTOR        PIC X(5).                            
000059******************************************************************
000060* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 44      *
000061******************************************************************
      *<<((file: FDSCO478))
000732*------------------------------- DSCORTE.TRIGORDISCORN            
000733 01  FILLER                      PIC X(8) VALUE 'FDSCO479'.       
000734*    EXEC SQL INCLUDE FDSCO479 END-EXEC.                          
      *>>((file: FDSCO479))
000001******************************************************************
000002* DCLGEN TABLE(DSCORTE.TRIGORDISCORN)                            *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDSCO479))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(S479-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DSCORTE.TRIGORDISCORN TABLE                 
000012*     ( AANUMORD                       CHAR(8) NOT NULL,           
000013*       CODARTSC                       CHAR(8) NOT NULL,           
000014*       NRRIGORD                       DECIMAL(3, 0) NOT NULL,     
000015*       DATACONS                       CHAR(8) NOT NULL,           
000016*       PREZZORD                       DECIMAL(15, 4) NOT NULL,    
000017*       PERCSCO1                       DECIMAL(3, 0) NOT NULL,     
000018*       PERCSCO2                       DECIMAL(3, 0) NOT NULL,     
000019*       PERCSCO3                       DECIMAL(3, 0) NOT NULL,     
000020*       UNMISURA                       CHAR(2) NOT NULL,           
000021*       QTAORDIN                       DECIMAL(9, 2) NOT NULL,     
000022*       QTARICEV                       DECIMAL(9, 2) NOT NULL,     
000023*       IMPRICEV                       DECIMAL(15, 4) NOT NULL,    
000024*       DATASALD                       CHAR(8) NOT NULL,           
000025*       DTANNULL                       CHAR(8) NOT NULL,           
000026*       FLAGSTAM                       CHAR(1) NOT NULL,           
000027*       DTCREAZI                       CHAR(8) NOT NULL,           
000028*       DTULTVAR                       CHAR(8) NOT NULL,           
000029*       CODUTVAR                       CHAR(6) NOT NULL,           
000030*       CONSORIG                       CHAR(8) NOT NULL,           
000031*       PREZORIG                       DECIMAL(15, 4) NOT NULL     
000032*     ) END-EXEC
                                                                        
000033******************************************************************
000034* COBOL DECLARATION FOR TABLE DSCORTE.TRIGORDISCORN              *
000035******************************************************************
000036 01  DCLTRIGORDISCORN.                                            
000037*                       AANUMORD                                  
000038     10 S479-AANUMORD        PIC X(8).                            
000039*                       CODARTSC                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000040     10 S479-CODARTSC        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000041*                       NRRIGORD                                  
000042     10 S479-NRRIGORD        PIC S9(3)V USAGE COMP-3.             
000043*                       DATACONS                                  
000044     10 S479-DATACONS        PIC X(8).                            
000045*                       PREZZORD                                  
000046     10 S479-PREZZORD        PIC S9(11)V9(4) USAGE COMP-3.        
000047*                       PERCSCO1                                  
000048     10 S479-PERCSCO1        PIC S9(3)V USAGE COMP-3.             
000049*                       PERCSCO2                                  
000050     10 S479-PERCSCO2        PIC S9(3)V USAGE COMP-3.             
000051*                       PERCSCO3                                  
000052     10 S479-PERCSCO3        PIC S9(3)V USAGE COMP-3.             
000053*                       UNMISURA                                  
000054     10 S479-UNMISURA        PIC X(2).                            
000055*                       QTAORDIN                                  
000056     10 S479-QTAORDIN        PIC S9(7)V9(2) USAGE COMP-3.         
000057*                       QTARICEV                                  
000058     10 S479-QTARICEV        PIC S9(7)V9(2) USAGE COMP-3.         
000059*                       IMPRICEV                                  
000060     10 S479-IMPRICEV        PIC S9(11)V9(4) USAGE COMP-3.        
000061*                       DATASALD                                  
000062     10 S479-DATASALD        PIC X(8).                            
000063*                       DTANNULL                                  
000064     10 S479-DTANNULL        PIC X(8).                            
000065*                       FLAGSTAM                                  
000066     10 S479-FLAGSTAM        PIC X(1).                            
000067*                       DTCREAZI                                  
000068     10 S479-DTCREAZI        PIC X(8).                            
000069*                       DTULTVAR                                  
000070     10 S479-DTULTVAR        PIC X(8).                            
000071*                       CODUTVAR                                  
000072     10 S479-CODUTVAR        PIC X(6).                            
000073*                       CONSORIG                                  
000074     10 S479-CONSORIG        PIC X(8).                            
000075*                       PREZORIG                                  
000076     10 S479-PREZORIG        PIC S9(11)V9(4) USAGE COMP-3.        
000077******************************************************************
000078* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 20      *
000079******************************************************************
      *<<((file: FDSCO479))
000735*------------------------------- DCONTCLI.TSOLLECITI              
000736 01  FILLER                      PIC X(8) VALUE 'FDCLI865'.       
000737*    EXEC SQL INCLUDE FDCLI865 END-EXEC.                          
      *>>((file: FDCLI865))
000001******************************************************************
000002* DCLGEN TABLE(DCONTCLI.TSOLLECITI)                              *
000003*        LIBRARY(TESTPO.LIB.DSECT(FDCLI865))                     *
000004*        QUOTE                                                   *
000005* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000006******************************************************************
000007     
      *EXEC SQL DECLARE DCONTCLI.TSOLLECITI TABLE                   
000008*     ( CODSOCIE                       CHAR(2) NOT NULL,           
000009*       GRUPSOLL                       CHAR(1) NOT NULL,           
000010*       TIPOSOLL                       CHAR(1) NOT NULL,           
000011*       CODILING                       CHAR(1) NOT NULL,           
000012*       NUMPROG5                       DECIMAL(5, 0) NOT NULL,     
000013*       RIGASOLL                       CHAR(80) NOT NULL           
000014*     ) END-EXEC
                                                                        
000015******************************************************************
000016* COBOL DECLARATION FOR TABLE DCONTCLI.TSOLLECITI                *
000017******************************************************************
000018 01  DCLTSOLLECITI.                                               
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000019     10 C865-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000020     10 C865-GRUPSOLL        PIC X(1).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000021     10 C865-TIPOSOLL        PIC X(1).                            
000022     10 C865-CODILING        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000023     10 C865-NUMPROG5        PIC S99999V USAGE COMP-3.            
000024     10 C865-RIGASOLL        PIC X(80).                           
000025******************************************************************
000026* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 6       *
000027******************************************************************
      *<<((file: FDCLI865))
000738*------------------------------- DANAGRAF.TSOLLECITI              
000739 01  FILLER                      PIC X(8) VALUE 'FDANA528'.       
000740*    EXEC SQL INCLUDE FDANA528 END-EXEC.                          
      *>>((file: FDANA528))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TPAESI                    *
000003******************************************************************
000004 01  DCLTPAESI.                                                   
000005     10 A528-CODPAESE        PIC X(3).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006     10 A528-CODILING        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007     10 A528-PAESBANC        PIC X(3).                            
000008     10 A528-PAESEISO        PIC X(2).                            
000009     10 A528-FLPAECEE        PIC X(1).                            
000010     10 A528-FLPAEORI        PIC X(1).                            
000011     10 A528-DTCREAZI        PIC X(8).                            
000012     10 A528-DTULTVAR        PIC X(8).                            
000013     10 A528-CODUTVAR        PIC X(6).                            
000014     10 A528-SLPAEGTM        PIC X(3).                            
000015     10 A528-PRFINTER        PIC X(5).                            
000016     10 A528-GRUPPAES        PIC X(2).                            
000017     10 A528-CDMCAREG        PIC X(2).                            
000018     10 A528-CDAREREG        PIC X(2).                            
000019     10 A528-CDRAGCEN        PIC X(2).                            
000020     10 A528-CDRAGTRA        PIC X(2).                            
000021     10 A528-CDRAGFOC        PIC X(2).                            
000022     10 A528-CODPAGVB        PIC X(3).                            
000023     10 A528-SIGPAGVB        PIC X(2).                            
000024     10 A528-CODPARUS        PIC X(3).                            
000025     10 A528-CDRAGLIS        PIC X(2).                            
000026     10 A528-CDRAGSTA        PIC X(2).                            
000027     10 A528-CDRAGLIC        PIC X(2).                            
000028     10 A528-CDRAGLIF        PIC X(2).                            
000029******************************************************************
000030* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 24      *
000031******************************************************************
      *<<((file: FDANA528))
000742     
      *EXEC SQL 
      *DECLARE POINTER1 CURSOR FOR                             
000743*           SELECT CODSERVI, DESSERVI, UNMISURA                    
000744*                 ,TIPSERVI, CONTODCD, CONTODCA                    
000745*                 ,CENCOSTA, ESENTIVA, CONTPROV                    
000746*             FROM DLOGISTI.TSERVIZI                               
000747*            WHERE TIPSERVI BETWEEN :MIN-TIPSERVI                  
000748*                               AND :MAX-TIPSERVI                  
000749*              AND CODSERVI    LIKE :L651-CODSERVI                 
000750*              AND DESSERVI    LIKE :L651-DESSERVI                 
000751*            ORDER BY CODSERVI                                     
000752*     END-EXEC
                                                                        
000753*    EXEC SQL INCLUDE SQLCA END-EXEC.                             
      *>>((file: SQLCA))
000001****************************************************************<*
000002* Copyright (c) 2016-2023 NTT DATA, Inc. All rights reserved.  *<*
000003* Users of NTT DATA Enterprise COBOL may freely                *<*
000004* redistribute this copybook.                                  *<*
000005****************************************************************<*
000006                                                                  
000007 01  SQLCA GLOBAL.                                                
000008     05  SQLCAID                PIC X(8).                         
000009     05  SQLCABC                PIC S9(9) COMP-5.                 
000010     05  SQLCODE                PIC S9(9) COMP-5.                 
000011     05  SQLERRM.                                                 
000012         49  SQLERRML           PIC S9(4) COMP-5.                 
000013         49  SQLERRMC           PIC X(254).                       
000014     05  SQLERRP                PIC X(8).                         
000015     05  SQLERRD OCCURS 6 TIMES PIC S9(9) COMP-5.                 
000016     05  SQLWARN.                                                 
000017         10 SQLWARN0            PIC X(1).                         
000018         10 SQLWARN1            PIC X(1).                         
000019         10 SQLWARN2            PIC X(1).                         
000020         10 SQLWARN3            PIC X(1).                         
000021         10 SQLWARN4            PIC X(1).                         
000022         10 SQLWARN5            PIC X(1).                         
000023         10 SQLWARN6            PIC X(1).                         
000024         10 SQLWARN7            PIC X(1).                         
000025     05  SQLSTATE               PIC X(5).                         
000026     05  SQLEXT                 PIC S9(5) COMP-3 VALUE 1.         
      *<<((file: SQLCA))
000754****************************************************************  
000755*                                                                 
000756* Copyright (c) 2016-2022 NTT DATA, Inc.                          
000757* All rights reserved.                                            
000758*                                                                 
000759****************************************************************  
000760 01  DFHEIV.                                                      
000761   02  DFHEIV0               PIC X(35).                           
000762   02  DFHEIV1               PIC X(08).                           
000763   02  DFHEIV2               PIC X(08).                           
000764   02  DFHEIV3               PIC X(08).                           
000765   02  DFHEIV4               PIC X(06).                           
000766   02  DFHEIV5               PIC X(04).                           
000767   02  DFHEIV6               PIC X(04).                           
000768   02  DFHEIV7               PIC X(02).                           
000769   02  DFHEIV8               PIC X(02).                           
000770   02  DFHEIV9               PIC X(01).                           
000771   02  DFHEIV10              PIC S9(7) COMP-3.                    
000772   02  DFHEIV11              PIC S9(4) COMP SYNC.                 
000773   02  DFHEIV12              PIC S9(4) COMP SYNC.                 
000774   02  DFHEIV13              PIC S9(4) COMP SYNC.                 
000775   02  DFHEIV14              PIC S9(4) COMP SYNC.                 
000776   02  DFHEIV15              PIC S9(4) COMP SYNC.                 
000777   02  DFHEIV16              PIC S9(9) COMP SYNC.                 
000778   02  DFHEIV17              PIC X(04).                           
000779   02  DFHEIV18              PIC X(04).                           
000780   02  DFHEIV19              PIC X(04).                           
000781   02  DFHEIV20              USAGE IS POINTER.                    
000782   02  DFHEIV21              USAGE IS POINTER.                    
000783   02  DFHEIV22              USAGE IS POINTER.                    
000784   02  DFHEIV23              USAGE IS POINTER.                    
000785   02  DFHEIV24              USAGE IS POINTER.                    
000786   02  DFHEIV25              PIC S9(9) COMP SYNC.                 
000787   02  DFHEIV26              PIC S9(9) COMP SYNC.                 
000788   02  DFHEIV27              PIC S9(9) COMP SYNC.                 
000789   02  DFHEIV28              PIC S9(9) COMP SYNC.                 
000790   02  DFHEIV29              PIC S9(9) COMP SYNC.                 
000791   02  DFHEIV30              PIC S9(9) COMP SYNC.                 
000792   02  DFHEIV31              PIC S9(9) COMP SYNC.                 
000793   02  DFHEIV32              PIC S9(4) COMP SYNC.                 
000794   02  DFHEIV33              PIC S9(4) COMP SYNC.                 
000795   02  DFHEIV34              PIC S9(4) COMP SYNC.                 
000796   02  DFHEIV35              PIC S9(4) COMP SYNC.                 
000797   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.         
000798   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.      
000799   02  FILLER                PIC X(02).                           
000800   02  DFHEIV99              PIC X(08) VALUE SPACE.               
000801   02  DFHEIVL0              PIC X(48) VALUE SPACE.               
000802   02  DFHEIVL1              PIC X(48) VALUE SPACE.               
000803   02  DFHEIVL2              PIC X(48) VALUE SPACE.               
000804   02  DFHEIVL3              PIC X(48) VALUE SPACE.               
000805   02  DFHEIVL4              PIC X(255) VALUE SPACE.              
000806   02  DFHEIVL5              PIC X(255) VALUE SPACE.              
000807 LINKAGE  SECTION.                                                
000808***************************************************************** 
000809*                                                               * 
000810* Copyright (c) 2016-2022 NTT DATA, Inc.                        * 
000811* All rights reserved.                                          * 
000812*                                                               * 
000813***************************************************************** 
000814 01  dfheiblk.                                                    
000815     02  eibtime          pic s9(7) comp-3.                       
000816     02  eibdate          pic s9(7) comp-3.                       
000817     02  eibtrnid         pic x(4).                               
000818     02  eibtaskn         pic s9(7) comp-3.                       
000819     02  eibtrmid         pic x(4).                               
000820     02  dfheigdi         pic s9(4) comp.                         
000821     02  eibcposn         pic s9(4) comp.                         
000822     02  eibcalen         pic s9(4) comp.                         
000823     02  eibaid           pic x(1).                               
000824     02  eibfiller1       pic x(1).                               
000825     02  eibfn            pic x(2).                               
000826     02  eibfiller2       pic x(2).                               
000827     02  eibrcode         pic x(6).                               
000828     02  eibfiller3       pic x(2).                               
000829     02  eibds            pic x(8).                               
000830     02  eibreqid         pic x(8).                               
000831     02  eibrsrce         pic x(8).                               
000832     02  eibsync          pic x(1).                               
000833     02  eibfree          pic x(1).                               
000834     02  eibrecv          pic x(1).                               
000835     02  eibsend          pic x(1).                               
000836     02  eibatt           pic x(1).                               
000837     02  eibeoc           pic x(1).                               
000838     02  eibfmh           pic x(1).                               
000839     02  eibcompl         pic x(1).                               
000840     02  eibsig           pic x(1).                               
000841     02  eibconf          pic x(1).                               
000842     02  eiberr           pic x(1).                               
000843     02  eibrldbk         pic x(1).                               
000844     02  eiberrcd         pic x(4).                               
000845     02  eibsynrb         pic x(1).                               
000846     02  eibnodat         pic x(1).                               
000847     02  eibfiller5       pic x(2).                               
000848     02  eibresp          pic s9(8) comp.                         
000849     02  eibresp2         pic s9(8) comp.                         
000850     02  dfheigdj         pic s9(4) comp.                         
000851     02  dfheigdk         pic s9(4) comp.                         
000852*-----------------*                                               
000853 01  DFHCOMMAREA.                                                 
000854*    COPY DCLCOMMA.                                               
000855     02 LK-AREABYTE PIC X OCCURS 0 TO 4096 TIMES                  
000856                       DEPENDING ON EIBCALEN OF DFHEIBLK.         
000857*********************                                             
000858 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.                   
000858 VCOBOL-DUMMY-PROCEDURE.
000859 0000-DFHENTRY SECTION.                                           
000860     MOVE FUNCTION WHEN-COMPILED TO DFHEIVL0(1:21).               
000861     MOVE SPACES TO DFHEIV2.                                      
000862     MOVE '9#                    &   ' TO DFHEIV0.                
000863     MOVE 'AVTLO10' TO DFHEIV1.                                   
000864     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1       
000865          DFHEIVL0 DFHEIV2.                                       
000866*********************                                             
000867     
      *EXEC SQL WHENEVER SQLERROR   GO TO Z00-ERRORE END-EXEC
                                                                        
000868                                                                  
000869* EXEC CICS HANDLE ABEND LABEL(Z00-ERRORE)       END-EXEC.        
000870*    MOVE '..L                   " " #00000861' TO DFHEIV0        
000871     MOVE X'2E2E4C202020202020202020' &                           
000872          X'202020202020202020202220' &                           
000873          X'2220233030303030383631' TO DFHEIV0                    
000874     CALL 'kxdfhei1' USING DFHEIV0,                               
000875           DFHEIV99                                               
000876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
000877                                                                  
000878     PERFORM A00-INIZIALIZZAZIONE                                 
000879        THRU A00-EX.                                              
000880     IF EIBCALEN NOT GREATER ZERO                                 
000881        PERFORM B00-ARRIVO-DA-START                               
000882           THRU B00-EX                                            
000883     ELSE                                                         
000884        MOVE DFHCOMMAREA         TO WCOM-AREAXXXX                 
000885        MOVE 'AVMLO10'           TO WNOMEMAP                      
000886        MOVE WCOM-CODILING       TO WCODLING                      
000887        IF EIBAID EQUAL DFHENTER OR                               
000888           EIBAID EQUAL DFHPF10                                   
000889           PERFORM C00-RICEVI-MAPPA                               
000890              THRU C00-EX                                         
000891        ELSE                                                      
000892           PERFORM D00-GESTIONE-PF                                
000893              THRU D00-EX.                                        
000894     PERFORM E00-INVIA-MAPPA                                      
000895        THRU E00-EX.                                              
000896     PERFORM U00-RETURN-TRAN                                      
000897        THRU U00-EX.                                              
000898*---------------------------------------------------------------- 
000899 A00-INIZIALIZZAZIONE.                                            
000900*---------------------------------------------------------------- 
000901     MOVE +500                   TO WCOM-LUNGHEZZ.                
000902     MOVE EIBTRMID               TO WPAGVIDE                      
000903                                    WLO50-TERMINAL                
000904                                    WLO20-TERMINAL                
000905     MOVE 19                     TO WNUMRIGA.                     
000906     MOVE LENGTH OF WPAGREFE     TO WPAGLPAG.                     
000907     MOVE LOW-VALUE              TO AVILO10O.                     
000908     MOVE LENGTH OF WLO50-CODA   TO WLO50-LENGTH.                 
000909     MOVE 18                     TO WLO50-WNUMRIGA.               
000910     MOVE LENGTH OF WLO20-CODA   TO WLO20-LENGTH.                 
000911 A00-EX. EXIT.                                                    
000912*----------------------------------------------------------------*
000913 B00-ARRIVO-DA-START.                                             
000914*----------------------------------------------------------------*
000915                                                                  
000916* EXEC CICS  HANDLE CONDITION ENDDATA (B05-NORESP)                
000917*    END-EXEC.                                                    
000918*    MOVE '"$&                   ! # #00000899' TO DFHEIV0        
000919     MOVE X'222426202020202020202020' &                           
000920          X'202020202020202020202120' &                           
000921          X'2320233030303030383939' TO DFHEIV0                    
000922     CALL 'kxdfhei1' USING DFHEIV0                                
000923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
000924                                                                  
000925                                                                  
000926* EXEC CICS  RETRIEVE INTO   (WCOM-AREAXXXX)                      
000927*                        LENGTH (WCOM-LUNGHEZZ)                   
000928*    END-EXEC.                                                    
000929*    MOVE '0*I L                 &   #00000901' TO DFHEIV0        
000930     MOVE X'302A49204C20202020202020' &                           
000931          X'202020202020202020202620' &                           
000932          X'2020233030303030393031' TO DFHEIV0                    
000933     CALL 'kxdfhei1' USING DFHEIV0,                               
000934           WCOM-AREAXXXX,                                         
000935           WCOM-LUNGHEZZ,                                         
000936           DFHEIV99,                                              
000937           DFHEIV99,                                              
000938           DFHEIV99                                               
000939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
000940                                                                  
000941     PERFORM B10-PRIMA-VOLTA                                      
000942        THRU B10-EX.                                              
000943     MOVE SPACES                 TO WCOM-CODALOGI                 
000944     IF WCOM-MENUTRAN(WCOM-INDITRAN - 1) = 'LO50'                 
000945        MOVE 1                   TO WLO50-ITEM                    
000946        PERFORM R00-READQ-WPAGLO50                                
000947           THRU R00-EX                                            
000948        MOVE WLO50-CODSOCIE      TO LO10-ICODSERVI(1:2)           
000949        MOVE WLO50-TIPSERVI      TO LO10-ITIPSERVI                
000950     ELSE                                                         
000951        IF WCOM-MENUTRAN(WCOM-INDITRAN - 1) = 'LO20'              
000952           MOVE 1                TO WLO20-ITEM                    
000953           PERFORM R05-READQ-WPAGLO20                             
000954              THRU R05-EX                                         
000955           MOVE WLO20-CODCONSO   TO LO10-ICODSERVI(1:2)           
000956           MOVE WLO20-TIPSERVI   TO LO10-ITIPSERVI                
000957        ELSE                                                      
000958           MOVE WCOM-CODSERVI    TO LO10-ICODSERVI                
000959           MOVE WCOM-DESSERVI    TO LO10-IDESSERVI                
000960           MOVE WCOM-TIPSERVI    TO LO10-ITIPSERVI.               
000961     INSPECT LO10-ICODSERVI REPLACING ALL LOW-VALUE BY SPACES     
000962     INSPECT LO10-IDESSERVI REPLACING ALL LOW-VALUE BY SPACES     
000963     IF LO10-ICODSERVI > SPACES OR                                
000964        LO10-ITIPSERVI > SPACES                                   
000965        PERFORM C10-GESTIONE-RICICLO                              
000966           THRU C10-EX.                                           
000967 B00-EX. EXIT.                                                    
000968*-----------------------------------------------------------------
000969 B05-NORESP.                                                      
000970*-----------------------------------------------------------------
000971                                                                  
000972* EXEC CICS   SEND CONTROL ERASE FREEKB   END-EXEC.               
000973*    MOVE '82      T  E F        (   #00000934' TO DFHEIV0        
000974     MOVE X'383220202020202054202045' &                           
000975          X'204620202020202020202820' &                           
000976          X'2020233030303030393334' TO DFHEIV0                    
000977     CALL 'kxdfhei1' USING DFHEIV0,                               
000978           DFHEIV99,                                              
000979           DFHEIV99,                                              
000980           DFHEIV99,                                              
000981           DFHEIV99,                                              
000982           DFHEIV99,                                              
000983           DFHEIV99,                                              
000984           DFHEIV99                                               
000985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
000986                                                                  
000987                                                                  
000988* EXEC CICS RETURN  END-EXEC.                                     
000989*    MOVE '.(                    ''   #00000935' TO DFHEIV0       
000990     MOVE X'2E2820202020202020202020' &                           
000991          X'202020202020202020202720' &                           
000992          X'2020233030303030393335' TO DFHEIV0                    
000993     CALL 'kxdfhei1' USING DFHEIV0,                               
000994           DFHEIV99,                                              
000995           DFHEIV99,                                              
000996           DFHEIV99,                                              
000997           DFHEIV99,                                              
000998           DFHEIV99,                                              
000999           DFHEIV99                                               
001000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001001                                                                  
001002                                                                  
001003* GOBACK.                                                         
001004     MOVE '9%                    "   ' TO DFHEIV0                 
001005     MOVE 'AVTLO10' TO DFHEIV1                                    
001006     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1                        
001007     GOBACK.                                                      
001008 B05-EX. EXIT.                                                    
001009*-----------------------------------------------------------------
001010 B10-PRIMA-VOLTA.                                                 
001011*-----------------------------------------------------------------
001012     PERFORM U20-DELETE-TS                                        
001013        THRU U20-EX.                                              
001014     MOVE 'AVTLO10'              TO WCOM-NOMEPRGM.                
001015     MOVE EIBTRNID               TO WCOM-TRANSAZI.                
001016     MOVE ZEROS                  TO WCOM-PAGIRICH                 
001017                                    WCOM-PAGILIST                 
001018                                    WPAGRICH.                     
001019     MOVE 99999                  TO WCOM-PAGIULTI.                
001020     MOVE 'AVMLO10'              TO WNOMEMAP.                     
001021     MOVE WCOM-CODILING          TO WCODLING.                     
001022     IF WCOM-MENUTRAN (WCOM-INDITRAN) NOT = WCOM-TRANSAZI         
001023        ADD  1                   TO WCOM-INDITRAN                 
001024        MOVE WCOM-TRANSAZI       TO WCOM-MENUTRAN(WCOM-INDITRAN)  
001025        MOVE ZEROES              TO WCOM-PAGITRAN(WCOM-INDITRAN). 
001026     IF WCOM-INDITRAN GREATER 10                                  
001027        MOVE 'TRTR'              TO WCOM-CODABEND                 
001028        PERFORM Z00-ERRORE                                        
001029           THRU Z00-EX.                                           
001030 B10-EX. EXIT.                                                    
001031*-----------------------------------------------------------------
001032 C00-RICEVI-MAPPA.                                                
001033*-----------------------------------------------------------------
001034     PERFORM C01-RECEIVE                                          
001035        THRU C01-EX.                                              
001036     MOVE LOW-VALUE              TO LO10-MESSAGGO.                
001037     IF LO10-MAPRPAGO IS NUMERIC                                  
001038        MOVE LO10-MAPRPAGO       TO WPAGRICH                      
001039     ELSE                                                         
001040        MOVE WCOM-PAGIRICH       TO WPAGRICH.                     
001041     IF WPAGRICH NOT EQUAL WCOM-PAGIRICH                          
001042        MOVE SPACES              TO WCOM-FLAGPRGM                 
001043        PERFORM E20-PAGINA-PRONTA                                 
001044           THRU E20-EX                                            
001045     ELSE                                                         
001046        INSPECT LO10-ICODSERVI REPLACING ALL LOW-VALUE BY SPACES  
001047        INSPECT LO10-IDESSERVI REPLACING ALL LOW-VALUE BY SPACES  
001048        INSPECT LO10-ITIPSERVI REPLACING ALL LOW-VALUE BY SPACES  
001049        IF WCOM-CODSERVI NOT = LO10-ICODSERVI OR                  
001050           WCOM-DESSERVI NOT = LO10-IDESSERVI OR                  
001051           WCOM-TIPSERVI NOT = LO10-ITIPSERVI                     
001052           PERFORM C10-GESTIONE-RICICLO                           
001053              THRU C10-EX                                         
001054        ELSE                                                      
001055           PERFORM C40-GESTIONE-RICEVI                            
001056              THRU C40-EX.                                        
001057 C00-EX. EXIT.                                                    
001058*--------------------------------------------------------------*  
001059 C01-RECEIVE.                                                     
001060*--------------------------------------------------------------*  
001061                                                                  
001062* EXEC CICS RECEIVE MAP    (WNOMEMAP)                             
001063*                      MAPSET ('AVMLO10')                         
001064*                      INTO   (AVILO10I)                          
001065*    END-EXEC.                                                    
001066     MOVE LENGTH OF                                               
001067      AVILO10I                                                    
001068       TO DFHEIV11                                                
001069     MOVE 'AVMLO10' TO DFHEIV1                                    
001070*    MOVE '8"T I  L              ''   #00000990' TO DFHEIV0       
001071     MOVE X'382254204920204C20202020' &                           
001072          X'202020202020202020202720' &                           
001073          X'2020233030303030393930' TO DFHEIV0                    
001074     CALL 'kxdfhei1' USING DFHEIV0,                               
001075           WNOMEMAP,                                              
001076           AVILO10I,                                              
001077           DFHEIV11,                                              
001078           DFHEIV1,                                               
001079           DFHEIV99,                                              
001080           DFHEIV99                                               
001081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001082                                                                  
001083 C01-EX. EXIT.                                                    
001084*--------------------------------------------------------------*  
001085 C10-GESTIONE-RICICLO.                                            
001086*--------------------------------------------------------------*  
001087     MOVE '1'                    TO WCOM-TIPOPAGI                 
001088     MOVE SPACES                 TO WCOM-FLAGPRGM                 
001089     MOVE LOW-VALUE              TO WCOM-CODSERVI                 
001090                                    WCOM-DESSERVI                 
001091                                    WCOM-TIPSERVI                 
001092     PERFORM C12-CONTROLLA-RICHIESTA                              
001093        THRU C12-EX                                               
001094     PERFORM E99-CLEAR                                            
001095        THRU E99-EX                                               
001096     PERFORM U20-DELETE-TS                                        
001097        THRU U20-EX.                                              
001098     MOVE ZEROES                 TO WCOM-PAGIRICH                 
001099                                    WCOM-PAGILIST                 
001100                                    WPAGRICH.                     
001101     MOVE 99999                  TO WCOM-PAGIULTI.                
001102     IF ERRORE                                                    
001103        GO TO C10-EX.                                             
001104     MOVE LO10-ICODSERVI          TO WCOM-CODSERVI.               
001105     MOVE LO10-IDESSERVI          TO WCOM-DESSERVI.               
001106     MOVE LO10-ITIPSERVI          TO WCOM-TIPSERVI.               
001107     PERFORM E10-PREPARA-PAGINE                                   
001108        THRU E10-EX.                                              
001109     PERFORM E20-PAGINA-PRONTA                                    
001110        THRU E20-EX.                                              
001111 C10-EX. EXIT.                                                    
001112*-----------------------------------------------------------*     
001113 C12-CONTROLLA-RICHIESTA.                                         
001114*-----------------------------------------------------------*     
001115     IF LO10-ICODSERVI > ' '                                      
001116        MOVE SPACES              TO LO10-IDESSERVO                
001117        IF LO10-ICODSERVI(1:1) > ' ' AND                          
001118           LO10-ICODSERVI(2:1) > ' ' AND                          
001119           LO10-ICODSERVI(3:1) > ' ' AND                          
001120           LO10-ICODSERVI(4:1) > ' ' AND                          
001121           LO10-ICODSERVI(5:1) > ' ' AND                          
001122           LO10-ICODSERVI(6:1) > ' '                              
001123           MOVE LO10-ICODSERVI   TO L651-CODSERVI                 
001124           PERFORM L00-SELECT-SERVIZI                             
001125              THRU L00-EX                                         
001126           MOVE L651-DESSERVI    TO LO10-IDESSERVO.               
001127     IF LO10-ITIPSERVI > SPACES                                   
001128        IF (WCOM-MENUTRAN(1)     = 'LOGI' AND                     
001129            LO10-ITIPSERVI NOT = 'T' AND 'M' ) OR                 
001130           (WCOM-MENUTRAN(1) NOT = 'LOGI' AND                     
001131            LO10-ITIPSERVI NOT = 'L' )                            
001132           MOVE '*'               TO WSWERROR                     
001133           MOVE '00920'           TO MESS-CODERROR                
001134           MOVE DFHRED            TO LO10-ITIPSERVC               
001135           MOVE DFHUNIMD          TO LO10-ITIPSERVA               
001136           MOVE -1                TO LO10-ITIPSERVL.              
001137 C12-EX. EXIT.                                                    
001138*---------------------------------------------------------------* 
001139 C40-GESTIONE-RICEVI.                                             
001140*---------------------------------------------------------------* 
001141     PERFORM F00-CONTROLLI                                        
001142        THRU F00-EX.                                              
001143     IF WS-OPERAZIO > ' '                                         
001144        IF NOT ERRORE                                             
001145           IF EIBAID = DFHENTER                                   
001146              MOVE '00030'        TO MESS-CODERROR                
001147            ELSE                                                  
001148               PERFORM G00-AGGIORNAMENTI                          
001149                  THRU G00-EX.                                    
001150 C40-EX. EXIT.                                                    
001151*---------------------------------------------------------------* 
001152 D00-GESTIONE-PF.                                                 
001153*---------------------------------------------------------------* 
001154     IF EIBAID NOT = DFHPF1  AND                                  
001155        EIBAID NOT = DFHPF2  AND                                  
001156        EIBAID NOT = DFHPF7  AND                                  
001157        EIBAID NOT = DFHPF8  AND                                  
001158        EIBAID NOT = DFHPF9  AND                                  
001159        EIBAID NOT = DFHPF11 AND                                  
001160        EIBAID NOT = DFHPF12                                      
001161        PERFORM D30-FUNZIONI-ESTERNE                              
001162           THRU D30-EX                                            
001163     ELSE                                                         
001164        IF EIBAID = DFHPF9                                        
001165           IF WCOM-CODALOGI > SPACES                              
001166              PERFORM U02-NORESP                                  
001167                 THRU U02-EX                                      
001168           ELSE                                                   
001169              PERFORM D20-INSERIMENTO                             
001170                 THRU D20-EX                                      
001171           END-IF                                                 
001172        ELSE                                                      
001173           IF WCOM-PAGIRICH GREATER ZERO                          
001174              PERFORM D10-IMPOSTA-PAGINA                          
001175                 THRU D10-EX                                      
001176              PERFORM E20-PAGINA-PRONTA                           
001177                 THRU E20-EX                                      
001178           ELSE                                                   
001179              PERFORM U00-RETURN-TRAN                             
001180                 THRU U00-EX.                                     
001181 D00-EX. EXIT.                                                    
001182*----------------------------------------------------------------*
001183 D10-IMPOSTA-PAGINA.                                              
001184*----------------------------------------------------------------*
001185     IF EIBAID        NOT = DFHPF7 AND                            
001186        WCOM-FLAGPRGM     = 'I'                                   
001187        PERFORM U02-NORESP                                        
001188           THRU U02-EX.                                           
001189     MOVE SPACES                 TO WCOM-FLAGPRGM                 
001190     PERFORM C01-RECEIVE                                          
001191        THRU C01-EX.                                              
001192     IF EIBAID = DFHPF1                                           
001193        COMPUTE WPAGRICH = WCOM-PAGIRICH + 1                      
001194     ELSE                                                         
001195        IF EIBAID = DFHPF2                                        
001196           COMPUTE WPAGRICH = WCOM-PAGIRICH - 1                   
001197        ELSE                                                      
001198           IF EIBAID = DFHPF7                                     
001199              MOVE 1                TO WPAGRICH                   
001200           ELSE                                                   
001201              IF EIBAID = DFHPF8                                  
001202                 MOVE WCOM-PAGIULTI TO WPAGRICH                   
001203              ELSE                                                
001204                 IF EIBAID = DFHPF11                              
001205                    MOVE WCOM-PAGIRICH TO WPAGRICH                
001206                    MOVE '1'           TO WCOM-TIPOPAGI           
001207                 ELSE                                             
001208                    IF EIBAID = DFHPF12                           
001209                       MOVE WCOM-PAGIRICH TO WPAGRICH             
001210                       MOVE '2'           TO WCOM-TIPOPAGI.       
001211 D10-EX. EXIT.                                                    
001212*----------------------------------------------------------------*
001213 D20-INSERIMENTO.                                                 
001214*----------------------------------------------------------------*
001215     PERFORM C01-RECEIVE                                          
001216        THRU C01-EX.                                              
001217     MOVE '1'                       TO WCOM-TIPOPAGI              
001218     MOVE 'I'                       TO WCOM-FLAGPRGM              
001219     IF WCOM-PAGILIST > 0                                         
001220        MOVE WCOM-PAGIULTI          TO WNUMITEM                   
001221        PERFORM R20-READQ-WPAG                                    
001222           THRU R20-EX                                            
001223     ELSE                                                         
001224        MOVE ALL 'X'                TO WPAG-CODSERVI (1)          
001225                                       WPAG-DESSERVI (1)          
001226                                       WPAG-UNMISURA (1)          
001227                                       WPAG-TIPSERVI (1)          
001228                                       WPAG-CONTODCD (1)          
001229                                       WPAG-CONTODCA (1)          
001230                                       WPAG-CONTPROV (1)          
001231                                       WPAG-CENCOSTA (1).         
001232     PERFORM E99-CLEAR                                            
001233        THRU E99-EX                                               
001234     PERFORM D21-SPOSTA-IN-MAPPA                                  
001235        THRU D21-EX                                               
001236        VARYING WINDRIGA FROM 1 BY 1                              
001237          UNTIL WINDRIGA GREATER WNUMRIGA                         
001238             OR WPAG-CODSERVI(WINDRIGA) NOT GREATER SPACES.       
001239     PERFORM VARYING WINDRIGA FROM 2 BY 1                         
001240       UNTIL WINDRIGA GREATER WNUMRIGA                            
001241             MOVE 'I'             TO LO10-OPERAZIOO(WINDRIGA)     
001242     END-PERFORM.                                                 
001243 D20-EX. EXIT.                                                    
001244*----------------------------------------------------------------*
001245 D21-SPOSTA-IN-MAPPA.                                             
001246*----------------------------------------------------------------*
001247     MOVE WPAG-CODSERVI(WINDRIGA) TO LO10-CODSERVIO(1).           
001248     MOVE WPAG-DESSERVI(WINDRIGA) TO LO10-DESSERVIO(1).           
001249     MOVE WPAG-UNMISURA(WINDRIGA) TO LO10-UNMISURAO(1).           
001250     MOVE WPAG-TIPSERVI(WINDRIGA) TO LO10-TIPSERVIO(1).           
001251     MOVE WPAG-CONTPROV(WINDRIGA) TO LO10-CONTPROVO(1).           
001252     MOVE WPAG-CENCOSTA(WINDRIGA) TO LO10-CENCOSTAO(1).           
001253 D21-EX. EXIT.                                                    
001254*----------------------------------------------------------------*
001255 D30-FUNZIONI-ESTERNE.                                            
001256*----------------------------------------------------------------*
001257     MOVE '*'              TO WCOM-DELETETS.                      
001258                                                                  
001259* EXEC CICS LINK PROGRAM  ('WWTTIM15')                            
001260*                   COMMAREA (WCOM-AREAXXXX)                      
001261*                   LENGTH   (WCOM-LUNGHEZZ)                      
001262*                   END-EXEC.                                     
001263     MOVE 'WWTTIM15' TO DFHEIV1                                   
001264*    MOVE '."C                   (   #00001169' TO DFHEIV0        
001265     MOVE X'2E2243202020202020202020' &                           
001266          X'202020202020202020202820' &                           
001267          X'2020233030303031313639' TO DFHEIV0                    
001268     CALL 'kxdfhei1' USING DFHEIV0,                               
001269           DFHEIV1,                                               
001270           WCOM-AREAXXXX,                                         
001271           WCOM-LUNGHEZZ,                                         
001272           DFHEIV99,                                              
001273           DFHEIV99,                                              
001274           DFHEIV99,                                              
001275           DFHEIV99                                               
001276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001277                                                                  
001278     IF WCOM-RETURNXX = '*'                                       
001279                                                                  
001280* EXEC CICS RETURN END-EXEC                                       
001281*    MOVE '.(                    ''   #00001174' TO DFHEIV0       
001282     MOVE X'2E2820202020202020202020' &                           
001283          X'202020202020202020202720' &                           
001284          X'2020233030303031313734' TO DFHEIV0                    
001285     CALL 'kxdfhei1' USING DFHEIV0,                               
001286           DFHEIV99,                                              
001287           DFHEIV99,                                              
001288           DFHEIV99,                                              
001289           DFHEIV99,                                              
001290           DFHEIV99,                                              
001291           DFHEIV99                                               
001292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
001293     ELSE                                                         
001294        PERFORM U00-RETURN-TRAN                                   
001295           THRU U00-EX.                                           
001296 D30-EX. EXIT.                                                    
001297*----------------------------------------------------------------*
001298 E00-INVIA-MAPPA.                                                 
001299*----------------------------------------------------------------*
001300     MOVE EIBTIME                 TO LO10-MAPORAXO.               
001301     STRING WCOM-DTCREAZI(7:2) '/'                                
001302            WCOM-DTCREAZI(5:2) '/'                                
001303            WCOM-DTCREAZI(1:4)                                    
001304     DELIMITED BY SIZE          INTO LO10-MAPDATAO.               
001305     PERFORM E001-PROTEGGI                                        
001306        THRU E001-EX                                              
001307        VARYING WINDRIGA FROM 1 BY 1                              
001308          UNTIL WINDRIGA GREATER WNUMRIGA                         
001309     IF WCOM-PAGIULTI NOT = 99999                                 
001310        MOVE WCOM-PAGIULTI       TO LO10-MAPPPAGO                 
001311     ELSE                                                         
001312        MOVE ALL '*'             TO LO10-MAPPPAGI.                
001313     MOVE WCOM-PAGIRICH          TO LO10-MAPRPAGO.                
001314     IF MESS-CODERROR NOT GREATER SPACES                          
001315        MOVE '00003'             TO MESS-CODERROR.                
001316     PERFORM U10-DECODIFICA-MESSAGGIO                             
001317        THRU U10-EX.                                              
001318     IF NOT ERRORE                                                
001319        IF WCOM-FLAGPRGM = 'I'                                    
001320           MOVE -1               TO LO10-CODSERVIL(2)             
001321        ELSE                                                      
001322           IF WCOM-PAGILIST > 0                                   
001323              MOVE -1            TO LO10-OPERAZIOL(1)             
001324           ELSE                                                   
001325              MOVE -1            TO LO10-ICODSERVL.               
001326     IF WCOM-TIPOPAGI = '1'                                       
001327        IF WCOM-FLAGPRGM = 'I'                                    
001328           MOVE SPACES           TO LO10-PF11PF12O                
001329        ELSE                                                      
001330           MOVE '>>F12'          TO LO10-PF11PF12O                
001331        END-IF                                                    
001332        MOVE SPACES              TO LO10-TESTATA1O                
001333        MOVE 'CPROV'             TO LO10-TESTATA2O                
001334        MOVE 'CCOSA'             TO LO10-TESTATA3O                
001335     ELSE                                                         
001336        IF WCOM-FLAGPRGM = 'I'                                    
001337           MOVE SPACES           TO LO10-PF11PF12O                
001338        ELSE                                                      
001339           MOVE '<<F11'          TO LO10-PF11PF12O                
001340        END-IF                                                    
001341        MOVE '-ADDEB.GEST.-'     TO LO10-TESTATA1O                
001342        MOVE 'DCE DA'            TO LO10-TESTATA2O                
001343        MOVE 'DCE A'             TO LO10-TESTATA3O                
001344     END-IF                                                       
001345                                                                  
001346* EXEC CICS SEND MAP    (WNOMEMAP)                                
001347*                   MAPSET ('AVMLO10')                            
001348*                   FROM   (AVILO10O)                             
001349*                   ERASE                                         
001350*                   CURSOR                                        
001351*    END-EXEC.                                                    
001352     MOVE LENGTH OF                                               
001353      AVILO10O                                                    
001354       TO DFHEIV12                                                
001355     MOVE -1                                                      
001356       TO DFHEIV11                                                
001357     MOVE 'AVMLO10' TO DFHEIV1                                    
001358*    MOVE '8$     CT  E      L F ,   #00001227' TO DFHEIV0        
001359     MOVE X'382420202020204354202045' &                           
001360          X'2020202020204C2046202C20' &                           
001361          X'2020233030303031323237' TO DFHEIV0                    
001362     CALL 'kxdfhei1' USING DFHEIV0,                               
001363           WNOMEMAP,                                              
001364           AVILO10O,                                              
001365           DFHEIV12,                                              
001366           DFHEIV1,                                               
001367           DFHEIV99,                                              
001368           DFHEIV99,                                              
001369           DFHEIV99,                                              
001370           DFHEIV11,                                              
001371           DFHEIV99,                                              
001372           DFHEIV99,                                              
001373           DFHEIV99                                               
001374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001375                                                                  
001376 E00-EX. EXIT.                                                    
001377*-------------------------------------------------------------*   
001378 E001-PROTEGGI.                                                   
001379*-------------------------------------------------------------*   
001380     IF WCOM-FLAGPRGM = 'I'                                       
001381        MOVE DFHBMASF          TO LO10-OPERAZIOA (WINDRIGA)       
001382        MOVE DFHBLUE           TO LO10-OPERAZIOC (WINDRIGA)       
001383        MOVE DFHDFHI           TO LO10-OPERAZIOH (WINDRIGA)       
001384        IF WINDRIGA = 1                                           
001385           MOVE DFHBMASF       TO LO10-CODSERVIA (WINDRIGA)       
001386                                  LO10-DESSERVIA (WINDRIGA)       
001387                                  LO10-UNMISURAA (WINDRIGA)       
001388                                  LO10-TIPSERVIA (WINDRIGA)       
001389                                  LO10-CONTPROVA (WINDRIGA)       
001390                                  LO10-CENCOSTAA (WINDRIGA)       
001391                                  LO10-ESENTIVAA (WINDRIGA)       
001392           MOVE DFHBLUE        TO LO10-CODSERVIC (WINDRIGA)       
001393                                  LO10-DESSERVIC (WINDRIGA)       
001394                                  LO10-UNMISURAC (WINDRIGA)       
001395                                  LO10-TIPSERVIC (WINDRIGA)       
001396                                  LO10-CONTPROVC (WINDRIGA)       
001397                                  LO10-CENCOSTAC (WINDRIGA)       
001398                                  LO10-ESENTIVAC (WINDRIGA)       
001399           MOVE DFHDFHI        TO LO10-CODSERVIH (WINDRIGA)       
001400                                  LO10-DESSERVIH (WINDRIGA)       
001401                                  LO10-UNMISURAH (WINDRIGA)       
001402                                  LO10-TIPSERVIH (WINDRIGA)       
001403                                  LO10-CONTPROVH (WINDRIGA)       
001404                                  LO10-CENCOSTAH (WINDRIGA)       
001405                                  LO10-ESENTIVAH (WINDRIGA).      
001406     IF WCOM-FLAGPRGM NOT = 'I'                                   
001407        MOVE DFHBMASF          TO LO10-CODSERVIA (WINDRIGA)       
001408        MOVE DFHBLUE           TO LO10-CODSERVIC (WINDRIGA)       
001409        MOVE DFHDFHI           TO LO10-CODSERVIH (WINDRIGA)       
001410        IF WPAG-CODSERVI(WINDRIGA) NOT > ' '                      
001411           MOVE DFHBMASF       TO LO10-DESSERVIA (WINDRIGA)       
001412                                  LO10-OPERAZIOA (WINDRIGA)       
001413                                  LO10-CONTPROVA (WINDRIGA)       
001414                                  LO10-CENCOSTAA (WINDRIGA)       
001415                                  LO10-ESENTIVAA (WINDRIGA)       
001416           MOVE DFHBLUE        TO LO10-DESSERVIC (WINDRIGA)       
001417                                  LO10-OPERAZIOC (WINDRIGA)       
001418                                  LO10-CONTPROVC (WINDRIGA)       
001419                                  LO10-CENCOSTAC (WINDRIGA)       
001420                                  LO10-ESENTIVAC (WINDRIGA)       
001421           MOVE DFHDFHI        TO LO10-DESSERVIH (WINDRIGA)       
001422                                  LO10-OPERAZIOH (WINDRIGA)       
001423                                  LO10-CONTPROVH (WINDRIGA)       
001424                                  LO10-CENCOSTAH (WINDRIGA)       
001425                                  LO10-ESENTIVAH (WINDRIGA)       
001426        END-IF                                                    
001427        IF WPAG-FLAGORDI(WINDRIGA)     = 'S' OR                   
001428           WPAG-CODSERVI(WINDRIGA) NOT > ' '                      
001429           MOVE DFHBMASF       TO LO10-UNMISURAA (WINDRIGA)       
001430                                  LO10-TIPSERVIA (WINDRIGA)       
001431           MOVE DFHBLUE        TO LO10-UNMISURAC (WINDRIGA)       
001432                                  LO10-TIPSERVIC (WINDRIGA)       
001433           MOVE DFHDFHI        TO LO10-UNMISURAH (WINDRIGA)       
001434                                  LO10-TIPSERVIH (WINDRIGA).      
001435 E001-EX. EXIT.                                                   
001436*----------------------------------------------------------------*
001437 E10-PREPARA-PAGINE.                                              
001438*----------------------------------------------------------------*
001439     PERFORM O10-OPEN-POINTER1                                    
001440        THRU O10-EX.                                              
001441     PERFORM L10-FETCH-POINTER1                                   
001442        THRU L10-EX.                                              
001443     PERFORM E12-PREPARA-DATI                                     
001444        THRU E12-EX                                               
001445        UNTIL SQLCODE = 100.                                      
001446     PERFORM O11-CLOSE-POINTER1                                   
001447        THRU O11-EX.                                              
001448     IF WCOM-PAGILIST GREATER ZEROES                              
001449        MOVE WCOM-PAGILIST       TO WCOM-PAGIULTI                 
001450        IF WCOM-PAGITRAN (WCOM-INDITRAN) GREATER ZERO             
001451           MOVE WCOM-PAGITRAN (WCOM-INDITRAN)                     
001452                                 TO WPAGRICH                      
001453           MOVE ZEROES           TO WCOM-PAGITRAN(WCOM-INDITRAN)  
001454        ELSE                                                      
001455           MOVE 1                TO WPAGRICH                      
001456     ELSE                                                         
001457        PERFORM E99-CLEAR                                         
001458           THRU E99-EX                                            
001459        MOVE '00002'             TO MESS-CODERROR.                
001460 E10-EX. EXIT.                                                    
001461*----------------------------------------------------------------*
001462 E12-PREPARA-DATI.                                                
001463*----------------------------------------------------------------*
001464     MOVE SPACES                 TO WPAGREFE.                     
001465     INITIALIZE WPAGREFE.                                         
001466     PERFORM E14-RIGA-TS                                          
001467        THRU E14-EX                                               
001468             VARYING WINDRIGA FROM 1 BY 1                         
001469               UNTIL WINDRIGA > WNUMRIGA                          
001470                  OR SQLCODE  = 100.                              
001471     ADD 1                       TO WCOM-PAGILIST                 
001472     PERFORM R10-WRITEQ-WPAG                                      
001473        THRU R10-EX.                                              
001474 E12-EX. EXIT.                                                    
001475*----------------------------------------------------------------*
001476 E14-RIGA-TS.                                                     
001477*----------------------------------------------------------------*
001478     MOVE L651-CODSERVI          TO WPAG-CODSERVI(WINDRIGA)       
001479                                    L653-CODSERVI                 
001480     PERFORM L05-SELECT-RIGORDILOGI                               
001481        THRU L05-EX                                               
001482     IF SQLCODE = 0                                               
001483        MOVE 'S'                 TO WPAG-FLAGORDI(WINDRIGA)       
001484     ELSE                                                         
001485        MOVE L651-CODSERVI       TO S479-CODARTSC(1:6)            
001486        MOVE '00'                TO S479-CODARTSC(7:2)            
001487        PERFORM L06-SELECT-RIGORDISCORN                           
001488           THRU L06-EX                                            
001489        IF SQLCODE = 0                                            
001490           MOVE 'S'              TO WPAG-FLAGORDI(WINDRIGA).      
001491     MOVE L651-CODSERVI          TO WPAG-CODSERVI(WINDRIGA)       
001492     MOVE L651-DESSERVI          TO WPAG-DESSERVI(WINDRIGA).      
001493     MOVE L651-UNMISURA          TO WPAG-UNMISURA(WINDRIGA).      
001494     MOVE L651-TIPSERVI          TO WPAG-TIPSERVI(WINDRIGA).      
001495     MOVE L651-CONTODCD          TO WPAG-CONTODCD(WINDRIGA).      
001496     MOVE L651-CONTODCA          TO WPAG-CONTODCA(WINDRIGA).      
001497     MOVE L651-CENCOSTA          TO WPAG-CENCOSTA(WINDRIGA).      
001498     MOVE L651-ESENTIVA          TO WPAG-ESENTIVA(WINDRIGA).      
001499     MOVE L651-CONTPROV          TO WPAG-CONTPROV(WINDRIGA).      
001500     PERFORM L10-FETCH-POINTER1                                   
001501        THRU L10-EX.                                              
001502 E14-EX. EXIT.                                                    
001503*----------------------------------------------------------------*
001504 E20-PAGINA-PRONTA.                                               
001505*----------------------------------------------------------------*
001506     IF WCOM-PAGILIST EQUAL ZEROES                                
001507        GO TO E20-EX.                                             
001508     IF WPAGRICH LESS 1                                           
001509        MOVE 1                   TO WPAGRICH.                     
001510     IF WPAGRICH GREATER WCOM-PAGIULTI                            
001511        MOVE WCOM-PAGIULTI       TO WPAGRICH.                     
001512     MOVE WPAGRICH               TO WCOM-PAGIRICH                 
001513                                    WNUMITEM.                     
001514     PERFORM E99-CLEAR                                            
001515        THRU E99-EX                                               
001516     PERFORM R20-READQ-WPAG                                       
001517        THRU R20-EX.                                              
001518     PERFORM E22-SPOSTA-IN-MAPPA                                  
001519        THRU E22-EX                                               
001520        VARYING WINDRIGA FROM 1 BY 1                              
001521          UNTIL WINDRIGA GREATER WNUMRIGA                         
001522             OR WPAG-CODSERVI(WINDRIGA) NOT GREATER SPACES.       
001523 E20-EX. EXIT.                                                    
001524*--------------------------------------------------------------*  
001525 E22-SPOSTA-IN-MAPPA.                                             
001526*--------------------------------------------------------------*  
001527     MOVE WPAG-CODSERVI(WINDRIGA) TO LO10-CODSERVIO(WINDRIGA).    
001528     MOVE WPAG-DESSERVI(WINDRIGA) TO LO10-DESSERVIO(WINDRIGA).    
001529     MOVE WPAG-UNMISURA(WINDRIGA) TO LO10-UNMISURAO(WINDRIGA).    
001530     MOVE WPAG-TIPSERVI(WINDRIGA) TO LO10-TIPSERVIO(WINDRIGA).    
001531     MOVE WPAG-ESENTIVA(WINDRIGA) TO LO10-ESENTIVAO(WINDRIGA).    
001532     IF WCOM-TIPOPAGI = '1'                                       
001533        MOVE WPAG-CONTPROV(WINDRIGA) TO LO10-CONTPROVO(WINDRIGA)  
001534        MOVE WPAG-CENCOSTA(WINDRIGA) TO LO10-CENCOSTAO(WINDRIGA)  
001535     ELSE                                                         
001536        MOVE WPAG-CONTODCD(WINDRIGA) TO LO10-CONTPROVO(WINDRIGA)  
001537        MOVE WPAG-CONTODCA(WINDRIGA) TO LO10-CENCOSTAO(WINDRIGA). 
001538 E22-EX. EXIT.                                                    
001539*-------------------------------------------------------*         
001540 E99-CLEAR.                                                       
001541*-------------------------------------------------------*         
001542     PERFORM VARYING WINDRIGA FROM 1 BY 1                         
001543       UNTIL WINDRIGA > WNUMRIGA                                  
001544          MOVE LOW-VALUE         TO LO10-RIGAO(WINDRIGA)          
001545     END-PERFORM.                                                 
001546 E99-EX. EXIT.                                                    
001547*----------------------------------------------------------------*
001548 F00-CONTROLLI.                                                   
001549*----------------------------------------------------------------*
001550     MOVE WPAGRICH               TO WNUMITEM.                     
001551     PERFORM R20-READQ-WPAG                                       
001552        THRU R20-EX.                                              
001553     IF WCOM-CODALOGI = 'LO50'                                    
001554        MOVE 1                TO WLO50-ITEM                       
001555        PERFORM R00-READQ-WPAGLO50                                
001556           THRU R00-EX                                            
001557     ELSE                                                         
001558        IF WCOM-CODALOGI = 'LO20'                                 
001559           MOVE 1             TO WLO20-ITEM                       
001560           MOVE ZEROES        TO WLO20-WINDRIGA                   
001561           PERFORM R05-READQ-WPAGLO20                             
001562              THRU R05-EX.                                        
001563     MOVE SPACES                 TO WS-OPERAZIO                   
001564     PERFORM F10-CONTROLLO-OPERAZIONE                             
001565        THRU F10-EX                                               
001566             VARYING WINDRIGA FROM 1 BY 1                         
001567               UNTIL WINDRIGA > WNUMRIGA.                         
001568     PERFORM F20-CONTROLLO-SELEZIONE                              
001569        THRU F20-EX                                               
001570             VARYING WINDRIGA FROM 1 BY 1                         
001571               UNTIL WINDRIGA > WNUMRIGA                          
001572                  OR ERRORE.                                      
001573     IF NOT ERRORE AND                                            
001574        WS-OPERAZIO = '*'                                         
001575        IF WCOM-CODALOGI = 'LO50'                                 
001576           PERFORM R30-REWRITE-WPAGLO50                           
001577              THRU R30-EX                                         
001578        ELSE                                                      
001579           PERFORM R40-REWRITE-WPAGLO20                           
001580              THRU R40-EX                                         
001581        END-IF                                                    
001582        MOVE DFHPF5               TO EIBAID                       
001583        PERFORM D00-GESTIONE-PF                                   
001584           THRU D00-EX.                                           
001585 F00-EX. EXIT.                                                    
001586*----------------------------------------------------------------*
001587 F10-CONTROLLO-OPERAZIONE.                                        
001588*----------------------------------------------------------------*
001589     IF LO10-OPERAZIOI(WINDRIGA) NOT > SPACES                     
001590        GO TO F10-EX.                                             
001591     IF LO10-OPERAZIOI(WINDRIGA) NOT EQUAL 'V' AND 'I' AND '/'    
001592                                       AND '*'                    
001593        MOVE '*'                  TO WSWERROR                     
001594        MOVE '00004'              TO MESS-CODERROR                
001595        MOVE DFHUNIMD             TO LO10-OPERAZIOA(WINDRIGA)     
001596        MOVE DFHRED               TO LO10-OPERAZIOC(WINDRIGA)     
001597        MOVE -1                   TO LO10-OPERAZIOL(WINDRIGA)     
001598        GO TO F10-EX                                              
001599     ELSE                                                         
001600        IF (LO10-OPERAZIOI(WINDRIGA)     = 'I'  AND               
001601            WCOM-FLAGPRGM            NOT = 'I') OR                
001602           (LO10-OPERAZIOI(WINDRIGA)     = '*'  AND               
001603            WCOM-CODALOGI NOT > SPACES)         OR                
001604           (LO10-OPERAZIOI(WINDRIGA) NOT = '*'  AND               
001605            WCOM-CODALOGI > SPACES)                               
001606           MOVE '*'               TO WSWERROR                     
001607           MOVE '00319'           TO MESS-CODERROR                
001608           MOVE DFHUNIMD          TO LO10-OPERAZIOA(WINDRIGA)     
001609           MOVE DFHRED            TO LO10-OPERAZIOC(WINDRIGA)     
001610           MOVE -1                TO LO10-OPERAZIOL(WINDRIGA)     
001611           GO TO F10-EX                                           
001612        ELSE                                                      
001613           IF WCOM-FLAGPRGM                = 'I' AND              
001614              LO10-CODSERVII(WINDRIGA) NOT > ' ' AND              
001615              LO10-DESSERVII(WINDRIGA) NOT > ' ' AND              
001616              LO10-UNMISURAI(WINDRIGA) NOT > ' ' AND              
001617              LO10-TIPSERVII(WINDRIGA) NOT > ' ' AND              
001618              LO10-CONTPROVI(WINDRIGA) NOT > ' ' AND              
001619              LO10-CENCOSTAI(WINDRIGA) NOT > ' ' AND              
001620              LO10-ESENTIVAI(WINDRIGA) NOT > ' '                  
001621              CONTINUE                                            
001622           ELSE                                                   
001623              IF WS-OPERAZIO NOT > ' '                            
001624                 MOVE LO10-OPERAZIOI(WINDRIGA) TO WS-OPERAZIO     
001625              ELSE                                                
001626                 IF WS-OPERAZIO NOT = LO10-OPERAZIOI(WINDRIGA)    
001627                    MOVE '*'      TO WSWERROR                     
001628                    MOVE '00037'  TO MESS-CODERROR                
001629                    MOVE DFHUNIMD TO LO10-OPERAZIOA(WINDRIGA)     
001630                    MOVE DFHRED   TO LO10-OPERAZIOC(WINDRIGA)     
001631                    MOVE -1       TO LO10-OPERAZIOL(WINDRIGA)     
001632                    GO TO F10-EX.                                 
001633 F10-EX. EXIT.                                                    
001634*----------------------------------------------------------------*
001635 F20-CONTROLLO-SELEZIONE.                                         
001636*----------------------------------------------------------------*
001637     IF WCOM-FLAGPRGM            NOT = 'I' AND                    
001638        LO10-OPERAZIOI(WINDRIGA) NOT = 'V' AND                    
001639        WPAG-CODSERVI (WINDRIGA)     > ' '                        
001640        PERFORM E22-SPOSTA-IN-MAPPA                               
001641           THRU E22-EX.                                           
001642     IF WCOM-FLAGPRGM                = 'I' AND                    
001643        LO10-CODSERVII(WINDRIGA) NOT > ' ' AND                    
001644        LO10-DESSERVII(WINDRIGA) NOT > ' ' AND                    
001645        LO10-UNMISURAI(WINDRIGA) NOT > ' ' AND                    
001646        LO10-TIPSERVII(WINDRIGA) NOT > ' ' AND                    
001647        LO10-CONTPROVI(WINDRIGA) NOT > ' ' AND                    
001648        LO10-CENCOSTAI(WINDRIGA) NOT > ' ' AND                    
001649        LO10-ESENTIVAI(WINDRIGA) NOT > ' '                        
001650        GO TO F20-EX.                                             
001651     IF LO10-OPERAZIOI(WINDRIGA) = '/'                            
001652        IF WPAG-FLAGORDI(WINDRIGA) = 'S'                          
001653           MOVE '*'               TO WSWERROR                     
001654           MOVE '00029'           TO MESS-CODERROR                
001655           MOVE DFHUNIMD          TO LO10-OPERAZIOA(WINDRIGA)     
001656           MOVE DFHRED            TO LO10-OPERAZIOC(WINDRIGA)     
001657           MOVE -1                TO LO10-OPERAZIOL(WINDRIGA)     
001658           GO TO F20-EX.                                          
001659     IF LO10-OPERAZIOI(WINDRIGA) = 'I'                            
001660        PERFORM F21-CTRL-INSE                                     
001661           THRU F21-EX                                            
001662        IF ERRORE                                                 
001663           GO TO F20-EX.                                          
001664     IF LO10-OPERAZIOI(WINDRIGA) = 'I' OR 'V'                     
001665        PERFORM F22-CTRL-INSE-VAR                                 
001666           THRU F22-EX                                            
001667        IF ERRORE                                                 
001668           GO TO F20-EX.                                          
001669     IF LO10-OPERAZIOI(WINDRIGA) = '*'                            
001670        IF WCOM-CODALOGI = 'LO50'                                 
001671           PERFORM F23-CTRL-SCELTA-LO50                           
001672              THRU F23-EX                                         
001673        ELSE                                                      
001674           PERFORM F24-CTRL-SCELTA-LO20                           
001675              THRU F24-EX                                         
001676        END-IF                                                    
001677        IF ERRORE                                                 
001678           GO TO F20-EX.                                          
001679 F20-EX. EXIT.                                                    
001680*----------------------------------------------------------------*
001681 F21-CTRL-INSE.                                                   
001682*----------------------------------------------------------------*
001683*--- CODICE SERVIZIO                                              
001684     IF LO10-CODSERVII(WINDRIGA)(1:1) NOT > ' ' OR                
001685        LO10-CODSERVII(WINDRIGA)(2:1) NOT > ' ' OR                
001686        LO10-CODSERVII(WINDRIGA)(3:1) NOT > ' ' OR                
001687        LO10-CODSERVII(WINDRIGA)(4:1) NOT > ' ' OR                
001688        LO10-CODSERVII(WINDRIGA)(5:1) NOT > ' ' OR                
001689        LO10-CODSERVII(WINDRIGA)(6:1) NOT > ' '                   
001690        MOVE '*'                  TO WSWERROR                     
001691        MOVE '00053'              TO MESS-CODERROR                
001692        MOVE DFHRED               TO LO10-CODSERVIC(WINDRIGA)     
001693        MOVE DFHUNIMD             TO LO10-CODSERVIA(WINDRIGA)     
001694        MOVE -1                   TO LO10-CODSERVIL(WINDRIGA)     
001695        GO TO F21-EX.                                             
001696     MOVE LO10-CODSERVII(WINDRIGA)(1:2) TO A531-CODSOCIE          
001697     PERFORM L15-SELECT-TSOCIETA                                  
001698        THRU L15-EX                                               
001699     IF SQLCODE = 100                                             
001700        MOVE '*'                  TO WSWERROR                     
001701        MOVE '02478'              TO MESS-CODERROR                
001702        MOVE DFHRED               TO LO10-CODSERVIC(WINDRIGA)     
001703        MOVE DFHUNIMD             TO LO10-CODSERVIA(WINDRIGA)     
001704        MOVE -1                   TO LO10-CODSERVIL(WINDRIGA)     
001705        GO TO F21-EX.                                             
001706*--- DOPPIONI VIDEATA                                             
001707     PERFORM VARYING IND1 FROM 1 BY 1                             
001708       UNTIL IND1 > WNUMRIGA                                      
001709          OR ERRORE                                               
001710             IF IND1 NOT = WINDRIGA                               
001711                IF LO10-CODSERVII(IND1) =                         
001712                   LO10-CODSERVII(WINDRIGA)                       
001713                   MOVE '*'       TO WSWERROR                     
001714                   MOVE '00110'   TO MESS-CODERROR                
001715                   MOVE DFHRED    TO LO10-CODSERVIC(WINDRIGA)     
001716                   MOVE DFHUNIMD  TO LO10-CODSERVIA(WINDRIGA)     
001717                   MOVE -1        TO LO10-CODSERVIL(WINDRIGA)     
001718                   GO TO F21-EX                                   
001719                END-IF                                            
001720             END-IF                                               
001721     END-PERFORM.                                                 
001722*--- DOPPIONI TABELLA                                             
001723     MOVE LO10-CODSERVII(WINDRIGA)   TO L651-CODSERVI             
001724     PERFORM L00-SELECT-SERVIZI                                   
001725        THRU L00-EX                                               
001726     IF SQLCODE = 0                                               
001727        MOVE '*'                  TO WSWERROR                     
001728        MOVE '00110'              TO MESS-CODERROR                
001729        MOVE DFHRED               TO LO10-CODSERVIC(WINDRIGA)     
001730        MOVE DFHUNIMD             TO LO10-CODSERVIA(WINDRIGA)     
001731        MOVE -1                   TO LO10-CODSERVIL(WINDRIGA)     
001732        GO TO F21-EX.                                             
001733 F21-EX. EXIT.                                                    
001734*----------------------------------------------------------------*
001735 F22-CTRL-INSE-VAR.                                               
001736*----------------------------------------------------------------*
001737     INSPECT LO10-CONTPROVI(WINDRIGA) REPLACING ALL LOW-VALUE     
001738                                                BY SPACES         
001739     INSPECT LO10-CENCOSTAI(WINDRIGA) REPLACING ALL LOW-VALUE     
001740                                                BY SPACES         
001741     INSPECT LO10-ESENTIVAI(WINDRIGA) REPLACING ALL LOW-VALUE     
001742                                                BY SPACES         
001743*--- DESCRIZIONE                                                  
001744     IF LO10-DESSERVII(WINDRIGA) NOT > ' '                        
001745        MOVE '*'                  TO WSWERROR                     
001746        MOVE '00024'              TO MESS-CODERROR                
001747        MOVE DFHRED               TO LO10-DESSERVIC(WINDRIGA)     
001748        MOVE DFHUNIMD             TO LO10-DESSERVIA(WINDRIGA)     
001749        MOVE -1                   TO LO10-DESSERVIL(WINDRIGA)     
001750        GO TO F22-EX.                                             
001751*--- UNITA MISURA                                                 
001752     IF LO10-UNMISURAI(WINDRIGA) NOT = 'KG' AND 'MT' AND 'NR' AND 
001753                                       'FF' AND '% ' AND 'NC' AND 
001754                                       'M3'                       
001755        MOVE '*'                  TO WSWERROR                     
001756        MOVE '00392'              TO MESS-CODERROR                
001757        MOVE DFHRED               TO LO10-UNMISURAC(WINDRIGA)     
001758        MOVE DFHUNIMD             TO LO10-UNMISURAA(WINDRIGA)     
001759        MOVE -1                   TO LO10-UNMISURAL(WINDRIGA)     
001760        GO TO F22-EX.                                             
001761*--- TIPO SERVIZIIO                                               
001762     IF LO10-TIPSERVII(WINDRIGA) NOT = 'T' AND 'M' AND 'L'        
001763        MOVE '*'                  TO WSWERROR                     
001764        MOVE '00920'              TO MESS-CODERROR                
001765        MOVE DFHRED               TO LO10-TIPSERVIC(WINDRIGA)     
001766        MOVE DFHUNIMD             TO LO10-TIPSERVIA(WINDRIGA)     
001767        MOVE -1                   TO LO10-TIPSERVIL(WINDRIGA)     
001768        GO TO F22-EX.                                             
001769*--- CODICE ESENZIONE IVA                                         
001770     IF LO10-ESENTIVAI(WINDRIGA) > SPACES                         
001771        IF WCOM-MENUTRAN(WCOM-INDITRAN - 1) = 'LOGI'              
001772           MOVE '22'                  TO A531-CODSOCIE            
001773        ELSE                                                      
001774           IF WCOM-MENUTRAN(WCOM-INDITRAN - 1) = 'NKOF'           
001775              MOVE '24'               TO A531-CODSOCIE            
001776           ELSE                                                   
001777              MOVE '25'               TO A531-CODSOCIE            
001778           END-IF                                                 
001779        END-IF                                                    
001780        PERFORM L50-SELECT-CODILING                               
001781           THRU L50-EX                                            
001782        MOVE A531-CODSOCIE            TO C865-CODSOCIE            
001783        MOVE LO10-ESENTIVAI(WINDRIGA) TO C865-TIPOSOLL            
001784        MOVE A528-CODILING            TO C865-CODILING            
001785        PERFORM L40-CTRL-ESENTIVA                                 
001786           THRU L40-EX                                            
001787        IF SQLCODE = +100                                         
001788           MOVE '*'                   TO WSWERROR                 
001789           MOVE '00984'               TO MESS-CODERROR            
001790           MOVE DFHRED                TO LO10-ESENTIVAC(WINDRIGA) 
001791           MOVE DFHUNIMD              TO LO10-ESENTIVAA(WINDRIGA) 
001792           MOVE -1                    TO LO10-ESENTIVAL(WINDRIGA) 
001793           GO TO F22-EX.                                          
001794*--- CONTO DCE DA                                                 
001795     IF WCOM-TIPOPAGI = '2'                                       
001796        IF LO10-CONTPROVI(WINDRIGA) > SPACES                      
001797           MOVE LO10-CODSERVII(WINDRIGA)(1:2)                     
001798                                  TO A531-CODSOCIE                
001799           MOVE LO10-CONTPROVI(WINDRIGA)                          
001800                                  TO C861-CONTODCE                
001801           PERFORM L20-SELECT-CONTIDCE                            
001802              THRU L20-EX                                         
001803           IF SQLCODE = +100                                      
001804              MOVE '*'            TO WSWERROR                     
001805              MOVE '00213'        TO MESS-CODERROR                
001806              MOVE DFHRED         TO LO10-CONTPROVC(WINDRIGA)     
001807              MOVE DFHUNIMD       TO LO10-CONTPROVA(WINDRIGA)     
001808              MOVE -1             TO LO10-CONTPROVL(WINDRIGA)     
001809              GO TO F22-EX.                                       
001810*--- CONTO DCE A                                                  
001811     IF WCOM-TIPOPAGI = '2'                                       
001812        IF LO10-CENCOSTAI(WINDRIGA) > SPACES                      
001813           MOVE LO10-CODSERVII(WINDRIGA)(1:2)                     
001814                                  TO A531-CODSOCIE                
001815           MOVE LO10-CENCOSTAI(WINDRIGA)                          
001816                                  TO C861-CONTODCE                
001817           PERFORM L20-SELECT-CONTIDCE                            
001818              THRU L20-EX                                         
001819           IF SQLCODE = +100                                      
001820              MOVE '*'            TO WSWERROR                     
001821              MOVE '00213'        TO MESS-CODERROR                
001822              MOVE DFHRED         TO LO10-CENCOSTAC(WINDRIGA)     
001823              MOVE DFHUNIMD       TO LO10-CENCOSTAA(WINDRIGA)     
001824              MOVE -1             TO LO10-CENCOSTAL(WINDRIGA)     
001825              GO TO F22-EX.                                       
001826*--- CONTPROV                                                     
001827     IF WCOM-TIPOPAGI = '1'                                       
001828        IF LO10-CONTPROVI(WINDRIGA) > SPACES                      
001829           MOVE LO10-CONTPROVI(WINDRIGA) TO C861-CONTPROV         
001830           PERFORM L21-SELECT-CONTIDCE                            
001831              THRU L21-EX                                         
001832           IF SQLCODE = +100                                      
001833              MOVE '*'            TO WSWERROR                     
001834              MOVE '00213'        TO MESS-CODERROR                
001835              MOVE DFHRED         TO LO10-CONTPROVC(WINDRIGA)     
001836              MOVE DFHUNIMD       TO LO10-CONTPROVA(WINDRIGA)     
001837              MOVE -1             TO LO10-CONTPROVL(WINDRIGA)     
001838              GO TO F22-EX.                                       
001839*--- CENTRO DI COSTO DA                                           
001840     IF WCOM-TIPOPAGI = '1'                                       
001841        MOVE SPACES               TO LO10-CENCOSTAO(WINDRIGA)(6:1)
001842        IF LO10-CENCOSTAI(WINDRIGA) > SPACES                      
001843           IF WCOM-MENUTRAN(1) = 'LOGI'                           
001844              MOVE '22'               TO A982-CODSOCIE            
001845              MOVE 'A'                TO A982-CDDIVISI            
001846           ELSE                                                   
001847              IF WCOM-MENUTRAN(1) = 'NKOF'                        
001848                 MOVE '24'            TO A982-CODSOCIE            
001849                 MOVE 'T'             TO A982-CDDIVISI            
001850              ELSE                                                
001851                 MOVE '25'            TO A982-CODSOCIE            
001852                 MOVE 'T'             TO A982-CDDIVISI            
001853              END-IF                                              
001854          END-IF                                                  
001855          MOVE LO10-CENCOSTAI(WINDRIGA) TO A982-CENCOSTO          
001856           PERFORM L30-SELECT-CENCOSTO                            
001857              THRU L30-EX                                         
001858           IF SQLCODE = +100                                      
001859              MOVE '*'            TO WSWERROR                     
001860              MOVE '00058'        TO MESS-CODERROR                
001861              MOVE DFHRED         TO LO10-CENCOSTAC(WINDRIGA)     
001862              MOVE DFHUNIMD       TO LO10-CENCOSTAA(WINDRIGA)     
001863              MOVE -1             TO LO10-CENCOSTAL(WINDRIGA)     
001864              GO TO F22-EX.                                       
001865 F22-EX. EXIT.                                                    
001866*----------------------------------------------------------------*
001867 F23-CTRL-SCELTA-LO50.                                            
001868*----------------------------------------------------------------*
001869     ADD 1                    TO WLO50-WINDRIGA.                  
001870     IF WLO50-WINDRIGA > WLO50-WNUMRIGA                           
001871        MOVE '*'              TO WSWERROR                         
001872        MOVE '00170'          TO MESS-CODERROR                    
001873        MOVE DFHRED           TO LO10-OPERAZIOC(WINDRIGA)         
001874        MOVE DFHUNIMD         TO LO10-OPERAZIOA(WINDRIGA)         
001875        MOVE -1               TO LO10-OPERAZIOL(WINDRIGA)         
001876        GO TO F23-EX.                                             
001877     MOVE LO10-CODSERVII(WINDRIGA)                                
001878                              TO WLO50-CODSERVI(WLO50-WINDRIGA)   
001879     MOVE LO10-DESSERVII(WINDRIGA)                                
001880                              TO WLO50-DESSERVI(WLO50-WINDRIGA)   
001881     MOVE LO10-UNMISURAI(WINDRIGA)                                
001882                              TO WLO50-UNMISURA(WLO50-WINDRIGA)   
001883     MOVE ZEROES              TO WLO50-PREZZLIS(WLO50-WINDRIGA)   
001884                                 WLO50-PERCLIST(WLO50-WINDRIGA).  
001885 F23-EX. EXIT.                                                    
001886*----------------------------------------------------------------*
001887 F24-CTRL-SCELTA-LO20.                                            
001888*----------------------------------------------------------------*
001889     ADD 1                    TO WLO20-WINDRIGA.                  
001890     IF WLO20-WINDRIGA > WLO20-WNUMRIGA                           
001891        MOVE '*'              TO WSWERROR                         
001892        MOVE '00170'          TO MESS-CODERROR                    
001893        MOVE DFHRED           TO LO10-OPERAZIOC(WINDRIGA)         
001894        MOVE DFHUNIMD         TO LO10-OPERAZIOA(WINDRIGA)         
001895        MOVE -1               TO LO10-OPERAZIOL(WINDRIGA)         
001896        GO TO F24-EX.                                             
001897     MOVE LO10-CODSERVII(WINDRIGA)                                
001898                              TO WLO20-CODSERVI(WLO20-WINDRIGA)   
001899     MOVE LO10-DESSERVII(WINDRIGA)                                
001900                              TO WLO20-DESSERVI(WLO20-WINDRIGA)   
001901     MOVE LO10-UNMISURAI(WINDRIGA)                                
001902                              TO WLO20-UNMISURA(WLO20-WINDRIGA).  
001903 F24-EX. EXIT.                                                    
001904*----------------------------------------------------------------*
001905 G00-AGGIORNAMENTI.                                               
001906*----------------------------------------------------------------*
001907     PERFORM G10-SCORRI-RIGHE                                     
001908        THRU G10-EX                                               
001909             VARYING WINDRIGA FROM 1 BY 1                         
001910               UNTIL WINDRIGA > WNUMRIGA                          
001911     MOVE WCOM-PAGIRICH          TO WCOM-PAGITRAN(WCOM-INDITRAN)  
001912     PERFORM C10-GESTIONE-RICICLO                                 
001913        THRU C10-EX                                               
001914     MOVE '00005'                TO MESS-CODERROR.                
001915 G00-EX. EXIT.                                                    
001916*----------------------------------------------------------------*
001917 G10-SCORRI-RIGHE.                                                
001918*----------------------------------------------------------------*
001919     IF LO10-OPERAZIOI(WINDRIGA) = '/'                            
001920        PERFORM G11-VALORIZZA                                     
001921           THRU G11-EX                                            
001922        PERFORM W00-DELETE-SERVIZI                                
001923           THRU W00-EX.                                           
001924     IF LO10-OPERAZIOI(WINDRIGA) = 'V'                            
001925        PERFORM G11-VALORIZZA                                     
001926           THRU G11-EX                                            
001927        PERFORM W20-UPDATE-SERVIZI                                
001928           THRU W20-EX.                                           
001929     IF (LO10-OPERAZIOI(WINDRIGA) = 'I' AND                       
001930         LO10-CODSERVII(WINDRIGA) > ' ')                          
001931        PERFORM G11-VALORIZZA                                     
001932           THRU G11-EX                                            
001933        PERFORM W10-INSERT-SERVIZI                                
001934           THRU W10-EX.                                           
001935 G10-EX. EXIT.                                                    
001936*----------------------------------------------------------------*
001937 G11-VALORIZZA.                                                   
001938*----------------------------------------------------------------*
001939     MOVE LO10-CODSERVII(WINDRIGA)   TO L651-CODSERVI             
001940     MOVE LO10-DESSERVII(WINDRIGA)   TO L651-DESSERVI             
001941     MOVE LO10-UNMISURAI(WINDRIGA)   TO L651-UNMISURA             
001942     MOVE LO10-TIPSERVII(WINDRIGA)   TO L651-TIPSERVI             
001943     MOVE LO10-ESENTIVAI(WINDRIGA)   TO L651-ESENTIVA             
001944     MOVE WCOM-DTCREAZI              TO L651-DTCREAZI             
001945                                        L651-DTULTVAR             
001946     MOVE WCOM-UTENCICS              TO L651-CODUTVAR.            
001947     IF LO10-OPERAZIOI(WINDRIGA)     = 'I' OR                     
001948       (LO10-OPERAZIOI(WINDRIGA) NOT = 'I' AND                    
001949        WCOM-TIPOPAGI                = '1')                       
001950        MOVE LO10-CONTPROVI(WINDRIGA)   TO L651-CONTPROV          
001951        MOVE LO10-CENCOSTAI(WINDRIGA)   TO L651-CENCOSTA          
001952        IF LO10-OPERAZIOI(WINDRIGA) = 'I'                         
001953           MOVE SPACES                  TO L651-CONTODCD          
001954                                           L651-CONTODCA          
001955        ELSE                                                      
001956           MOVE WPAG-CONTODCD(WINDRIGA) TO L651-CONTODCD          
001957           MOVE WPAG-CONTODCA(WINDRIGA) TO L651-CONTODCA          
001958        END-IF                                                    
001959     END-IF                                                       
001960     IF WCOM-TIPOPAGI                = '2'                        
001961        MOVE WPAG-CONTPROV (WINDRIGA)   TO L651-CONTPROV          
001962        MOVE WPAG-CENCOSTA (WINDRIGA)   TO L651-CENCOSTA          
001963        MOVE LO10-CONTPROVI(WINDRIGA)   TO L651-CONTODCD          
001964        MOVE LO10-CENCOSTAI(WINDRIGA)   TO L651-CONTODCA.         
001965 G11-EX. EXIT.                                                    
001966*----------------------------------------------------------------*
001967 L00-SELECT-SERVIZI.                                              
001968*----------------------------------------------------------------*
001969     MOVE 'L00-'                 TO WCOM-CODABEND.                
001970     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001971     MOVE 'SERVIZI'              TO WCOM-FILENOME.                
001972     MOVE L651-CODSERVI          TO WCOM-FILECTRL.                
001973     MOVE SPACES                 TO L651-DESSERVI                 
001975     
      *EXEC SQL 
      *SELECT DESSERVI                                         
001976*            INTO :L651-DESSERVI                                   
001977*            FROM DLOGISTI.TSERVIZI                                
001978*           WHERE CODSERVI = :L651-CODSERVI                        
001979*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 1 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CODSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-DESSERVI
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001980 L00-EX. EXIT.                                                    
001981*----------------------------------------------------------------*
001982 L05-SELECT-RIGORDILOGI.                                          
001983*----------------------------------------------------------------*
001984     MOVE 'L05-'                 TO WCOM-CODABEND.                
001985     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001986     MOVE 'RIGORDILOGI'          TO WCOM-FILENOME.                
001987     MOVE L653-CODSERVI          TO WCOM-FILECTRL.                
001989     
      *EXEC SQL 
      *SELECT AANUMORD                                         
001990*            INTO :L653-AANUMORD                                   
001991*            FROM DLOGISTI.TRIGORDILOGI                            
001992*           WHERE CODSERVI = :L653-CODSERVI                        
001993*             AND DTANNULL = ' '                                   
001994*           FETCH FIRST 1 ROWS ONLY                                
001995*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 3 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CODSERVI
            BY VALUE 0
                     0

           MOVE 4 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-AANUMORD
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001996 L05-EX. EXIT.                                                    
001997*----------------------------------------------------------------*
001998 L06-SELECT-RIGORDISCORN.                                         
001999*----------------------------------------------------------------*
002000     MOVE 'L06-'                 TO WCOM-CODABEND.                
002001     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002002     MOVE 'RIGORDISCORN'         TO WCOM-FILENOME.                
002003     MOVE S479-CODARTSC          TO WCOM-FILECTRL.                
002005     
      *EXEC SQL 
      *SELECT T.AANUMORD                                       
002006*            INTO :S478-AANUMORD                                   
002007*            FROM DSCORTE.TORDISCORN    T                          
002008*                ,DSCORTE.TRIGORDISCORN R                          
002009*           WHERE T.AANUMORD = R.AANUMORD                          
002010*             AND T.FLORDPZA = 'L'                                 
002011*             AND R.DTANNULL = ' '                                 
002012*             AND R.CODARTSC = :S479-CODARTSC                      
002013*           FETCH FIRST 1 ROWS ONLY                                
002014*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 5 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S479-CODARTSC
            BY VALUE 0
                     0

           MOVE 6 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE S478-AANUMORD
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 4 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002015 L06-EX. EXIT.                                                    
002016*----------------------------------------------------------------*
002017 L10-FETCH-POINTER1.                                              
002018*----------------------------------------------------------------*
002019     MOVE 'L10-'                 TO WCOM-CODABEND.                
002020     MOVE 'FETCH'                TO WCOM-FILEFUNZ.                
002021     MOVE 'POINTER1'             TO WCOM-FILEFUNZ.                
002023     
      *EXEC SQL 
      *FETCH POINTER1                                          
002024*           INTO :L651-CODSERVI, :L651-DESSERVI, :L651-UNMISURA    
002025*               ,:L651-TIPSERVI, :L651-CONTODCD, :L651-CONTODCA    
002026*               ,:L651-CENCOSTA, :L651-ESENTIVA, :L651-CONTPROV    
002027*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 7 TO SQL-STMT-ID 
           MOVE 9 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CODSERVI
            BY VALUE 0
                     0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-DESSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-UNMISURA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-TIPSERVI
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CONTODCD
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CONTODCA
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CENCOSTA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-ESENTIVA
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CONTPROV
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002028 L10-EX. EXIT.                                                    
002029*----------------------------------------------------------------*
002030 L15-SELECT-TSOCIETA.                                             
002031*----------------------------------------------------------------*
002032     IF A531-CODSOCIE = '15'                                      
002033        MOVE '09'                TO A531-CODSOCIE.                
002034     MOVE 'L15-'                 TO WCOM-CODABEND.                
002035     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002036     MOVE 'TSOCIETA'             TO WCOM-FILENOME.                
002037     MOVE A531-CODSOCIE          TO WCOM-FILECTRL.                
002039     
      *EXEC SQL 
      *SELECT CODSOCIE                                         
002040*            INTO :A531-CODSOCIE                                   
002041*            FROM DANAGRAF.TSOCIETA                                
002042*           WHERE CODSOCIE = :A531-CODSOCIE                        
002043*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 8 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 9 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 5 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002044 L15-EX. EXIT.                                                    
002045*----------------------------------------------------------------*
002046 L20-SELECT-CONTIDCE.                                             
002047*----------------------------------------------------------------*
002048     IF A531-CODSOCIE = '15'                                      
002049        MOVE '09'                TO A531-CODSOCIE.                
002050     MOVE 'L20-'                 TO WCOM-CODABEND.                
002051     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002052     MOVE 'CONTIDCE'             TO WCOM-FILENOME.                
002053     MOVE SPACES                 TO WCOM-FILECTRL.                
002054     STRING A531-CODSOCIE ' ' C861-CONTODCE                       
002055        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
002057     
      *EXEC SQL 
      *SELECT CONTODCE                                         
002058*            INTO :C861-CONTODCE                                   
002059*            FROM DCONTCLI.TCONTIDCE A                             
002060*                ,DANAGRAF.TSOCIETA  B                             
002061*           WHERE B.CODSOCIE = :A531-CODSOCIE                      
002062*             AND A.CODPIANO = B.CODPIANO                          
002063*             AND A.CONTODCE = :C861-CONTODCE                      
002064*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 10 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTODCE
            BY VALUE 0
                     0

           MOVE 11 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTODCE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 6 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002065 L20-EX. EXIT.                                                    
002066*----------------------------------------------------------------*
002067 L21-SELECT-CONTIDCE.                                             
002068*----------------------------------------------------------------*
002069     MOVE 'L21-'                 TO WCOM-CODABEND.                
002070     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002071     MOVE 'CONTIDCE'             TO WCOM-FILENOME.                
002072     MOVE C861-CONTPROV          TO WCOM-FILECTRL.                
002074     
      *EXEC SQL 
      *SELECT CONTODCE                                         
002075*            INTO :C861-CONTODCE                                   
002076*            FROM DCONTCLI.TCONTIDCE                               
002077*           WHERE CONTPROV = :C861-CONTPROV                        
002078*           FETCH FIRST 1 ROWS ONLY                                
002079*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 12 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTPROV
            BY VALUE 0
                     0

           MOVE 13 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTODCE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 7 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002080 L21-EX. EXIT.                                                    
002081*----------------------------------------------------------------*
002082 L30-SELECT-CENCOSTO.                                             
002083*----------------------------------------------------------------*
002084     MOVE 'L30-'                 TO WCOM-CODABEND.                
002085     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002086     MOVE 'CENCOSTO'             TO WCOM-FILENOME.                
002087     MOVE SPACES                 TO WCOM-FILECTRL.                
002088     STRING A982-CODSOCIE ' ' A982-CDDIVISI ' '                   
002089            A982-CENCOSTO                                         
002090        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
002092     
      *EXEC SQL 
      *SELECT DESCENCO                                         
002093*            INTO :A982-DESCENCO                                   
002094*            FROM DANAGRAF.TCENCOSTO                               
002095*           WHERE CODSOCIE = :A982-CODSOCIE                        
002096*             AND CDDIVISI = :A982-CDDIVISI                        
002097*             AND CENCOSTO = :A982-CENCOSTO                        
002098*             AND ANNULLAM <= ' '                                  
002099*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 14 TO SQL-STMT-ID 
           MOVE 3 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A982-CODSOCIE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A982-CDDIVISI
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A982-CENCOSTO
            BY VALUE 0
                     0

           MOVE 15 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 30 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A982-DESCENCO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 8 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002100     IF SQLCODE = 100                                             
002101        IF A982-CODSOCIE = '25'                                   
002102           MOVE '24'              TO A982-CODSOCIE                
002104           
      *EXEC SQL 
      *SELECT DESCENCO                                   
002105*                  INTO :A982-DESCENCO                             
002106*                  FROM DANAGRAF.TCENCOSTO                         
002107*                 WHERE CODSOCIE = :A982-CODSOCIE                  
002108*                   AND CDDIVISI = :A982-CDDIVISI                  
002109*                   AND CENCOSTO = :A982-CENCOSTO                  
002110*                   AND ANNULLAM <= ' '                            
002111*           END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 16 TO SQL-STMT-ID 
           MOVE 3 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A982-CODSOCIE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A982-CDDIVISI
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A982-CENCOSTO
            BY VALUE 0
                     0

           MOVE 17 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 30 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A982-DESCENCO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 9 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                         .                                              
002112 L30-EX. EXIT.                                                    
002113*---------------------------------------------------------------  
002114 L40-CTRL-ESENTIVA.                                               
002115*---------------------------------------------------------------  
002116      MOVE 'L40-'                 TO WCOM-CODABEND.               
002117      MOVE 'SELECT'               TO WCOM-FILEFUNZ.               
002118      MOVE 'SOLLECITI'            TO WCOM-FILENOME.               
002119      MOVE SPACES                 TO WCOM-FILECTRL                
002120      STRING C865-CODSOCIE ' S ' C865-TIPOSOLL ' '                
002121             C865-CODILING                                        
002122          DELIMITED BY SIZE     INTO WCOM-FILECTRL.               
002124      
      *EXEC SQL 
      *SELECT DISTINCT TIPOSOLL                               
002125*             INTO :C865-TIPOSOLL                                  
002126*             FROM DCONTCLI.TSOLLECITI                             
002127*            WHERE CODSOCIE = :C865-CODSOCIE                       
002128*              AND GRUPSOLL = 'S'                                  
002129*              AND TIPOSOLL = :C865-TIPOSOLL                       
002130*              AND CODILING = :C865-CODILING                       
002131*      END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 18 TO SQL-STMT-ID 
           MOVE 3 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C865-CODSOCIE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C865-TIPOSOLL
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C865-CODILING
            BY VALUE 0
                     0

           MOVE 19 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C865-TIPOSOLL
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 10 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                    .                                                   
002132 L40-EX. EXIT.                                                    
002133*--------------------------------------------------------------*  
002134 L50-SELECT-CODILING.                                             
002135*--------------------------------------------------------------*  
002136     MOVE 'L50-'                 TO WCOM-CODABEND                 
002137     MOVE 'SELECT'               TO WCOM-FILEFUNZ                 
002138     MOVE 'TPAESI'               TO WCOM-FILENOME                 
002139     MOVE A531-CODSOCIE          TO WCOM-FILECTRL                 
002141     
      *EXEC SQL 
      *SELECT B.CODILING                                       
002142*            INTO :A528-CODILING                                   
002143*            FROM DANAGRAF.TSOCIETA A                              
002144*                ,DANAGRAF.TPAESI   B                              
002145*           WHERE A.CODSOCIE = :A531-CODSOCIE                      
002146*             AND A.CODPAESE = B.CODPAESE                          
002147*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 20 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 21 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A528-CODILING
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 11 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
002148     IF SQLCODE NOT = ZEROES                                      
002149        PERFORM Z00-ERRORE                                        
002150           THRU Z00-EX.                                           
002151 L50-EX. EXIT.                                                    
002152*---------------------------------------------------------------  
002153 O10-OPEN-POINTER1.                                               
002154*---------------------------------------------------------------  
002155     MOVE LOW-VALUE              TO MIN-TIPSERVI                  
002156*    MOVE ALL '9'                TO MAX-TIPSERVI                  
002157     MOVE ALL 'Z'                TO MAX-TIPSERVI                  
002158     IF WCOM-TIPSERVI > ' '                                       
002159        MOVE WCOM-TIPSERVI       TO MIN-TIPSERVI MAX-TIPSERVI.    
002160     IF WCOM-MENUTRAN(1) NOT = 'LOGI'                             
002161        MOVE 'L'                 TO MIN-TIPSERVI MAX-TIPSERVI.    
002162     MOVE WCOM-CODSERVI          TO L651-CODSERVI                 
002163     INSPECT L651-CODSERVI REPLACING ALL SPACES BY '%'            
002164     MOVE '%'                    TO L651-DESSERVI(1:1)            
002165     MOVE WCOM-DESSERVI          TO L651-DESSERVI(2:)             
002166     INSPECT L651-DESSERVI REPLACING ALL SPACES BY '%'            
002167     MOVE '%'                    TO L651-DESSERVI(40:1)           
002168     MOVE 'O10-'                 TO WCOM-CODABEND.                
002169     MOVE 'OPEN'                 TO WCOM-FILEFUNZ.                
002170     MOVE 'POINTER1'             TO WCOM-FILENOME                 
002171     MOVE SPACES                 TO WCOM-FILECTRL                 
002172     STRING WCOM-CODSERVI ' '                                     
002173            WCOM-TIPSERVI ' '                                     
002174            WCOM-DESSERVI ' '                                     
002175     DELIMITED BY SIZE         INTO WCOM-FILECTRL.                
002176     
      *EXEC SQL OPEN POINTER1   END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 22 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-TIPSERVI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-TIPSERVI
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CODSERVI
            BY VALUE 0
                     0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-DESSERVI
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                              .                         
002177 O10-EX. EXIT.                                                    
002178*---------------------------------------------------------------  
002179 O11-CLOSE-POINTER1.                                              
002180*---------------------------------------------------------------  
002181     MOVE 'O11-'                 TO WCOM-CODABEND.                
002182     MOVE 'CLOSE'                TO WCOM-FILEFUNZ.                
002183     MOVE 'POINTER1'             TO WCOM-FILENOME.                
002184     MOVE SPACES                 TO WCOM-FILECTRL                 
002185     STRING WCOM-CODSERVI ' '                                     
002186            WCOM-TIPSERVI ' '                                     
002187            WCOM-DESSERVI ' '                                     
002188     DELIMITED BY SIZE         INTO WCOM-FILECTRL.                
002189     
      *EXEC SQL CLOSE POINTER1   END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                               .                        
002190 O11-EX. EXIT.                                                    
002191*----------------------------------------------------------------*
002192 R00-READQ-WPAGLO50.                                              
002193*----------------------------------------------------------------*
002194     MOVE SPACES                 TO WLO50-CODA.                   
002195     INITIALIZE                     WLO50-CODA.                   
002196                                                                  
002197* EXEC CICS HANDLE CONDITION ITEMERR (R00-EX)                     
002198*                               QIDERR  (R00-EX)                  
002199*    END-EXEC.                                                    
002200*    MOVE '"$<N                  ! $ #00002053' TO DFHEIV0        
002201     MOVE X'22243C4E2020202020202020' &                           
002202          X'202020202020202020202120' &                           
002203          X'2420233030303032303533' TO DFHEIV0                    
002204     CALL 'kxdfhei1' USING DFHEIV0                                
002205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002206                                                                  
002207                                                                  
002208* EXEC CICS READQ  TS QUEUE   (WPAGLO50)                          
002209*                        INTO    (WLO50-CODA)                     
002210*                        ITEM    (WLO50-ITEM)                     
002211*                        LENGTH  (WLO50-LENGTH)                   
002212*                        END-EXEC.                                
002213*    MOVE '*$II   L              ''   #00002056' TO DFHEIV0       
002214     MOVE X'2A2449492020204C20202020' &                           
002215          X'202020202020202020202720' &                           
002216          X'2020233030303032303536' TO DFHEIV0                    
002217     CALL 'kxdfhei1' USING DFHEIV0,                               
002218           WPAGLO50,                                              
002219           WLO50-CODA,                                            
002220           WLO50-LENGTH,                                          
002221           WLO50-ITEM,                                            
002222           DFHEIV99,                                              
002223           DFHEIV99                                               
002224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002225                                                                  
002226     MOVE 'LO50'                 TO WCOM-CODALOGI.                
002227 R00-EX. EXIT.                                                    
002228*----------------------------------------------------------------*
002229 R05-READQ-WPAGLO20.                                              
002230*----------------------------------------------------------------*
002231     MOVE SPACES                 TO WLO20-CODA.                   
002232     INITIALIZE                     WLO20-CODA.                   
002233                                                                  
002234* EXEC CICS HANDLE CONDITION ITEMERR (R05-EX)                     
002235*                               QIDERR  (R05-EX)                  
002236*    END-EXEC.                                                    
002237*    MOVE '"$<N                  ! % #00002068' TO DFHEIV0        
002238     MOVE X'22243C4E2020202020202020' &                           
002239          X'202020202020202020202120' &                           
002240          X'2520233030303032303638' TO DFHEIV0                    
002241     CALL 'kxdfhei1' USING DFHEIV0                                
002242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002243                                                                  
002244                                                                  
002245* EXEC CICS READQ  TS QUEUE   (WPAGLO20)                          
002246*                        INTO    (WLO20-CODA)                     
002247*                        ITEM    (WLO20-ITEM)                     
002248*                        LENGTH  (WLO20-LENGTH)                   
002249*                        END-EXEC.                                
002250*    MOVE '*$II   L              ''   #00002071' TO DFHEIV0       
002251     MOVE X'2A2449492020204C20202020' &                           
002252          X'202020202020202020202720' &                           
002253          X'2020233030303032303731' TO DFHEIV0                    
002254     CALL 'kxdfhei1' USING DFHEIV0,                               
002255           WPAGLO20,                                              
002256           WLO20-CODA,                                            
002257           WLO20-LENGTH,                                          
002258           WLO20-ITEM,                                            
002259           DFHEIV99,                                              
002260           DFHEIV99                                               
002261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002262                                                                  
002263     MOVE 'LO20'                 TO WCOM-CODALOGI.                
002264 R05-EX. EXIT.                                                    
002265*----------------------------------------------------------------*
002266 R10-WRITEQ-WPAG.                                                 
002267*----------------------------------------------------------------*
002268                                                                  
002269* EXEC CICS WRITEQ TS  QUEUE  (WPAGCTRL)                          
002270*                         FROM   (WPAGREFE)                       
002271*                         ITEM   (WNUMITEM)                       
002272*                         LENGTH (WPAGLPAG)                       
002273*                         END-EXEC.                               
002274*    MOVE '*" I   L              ''   #00002081' TO DFHEIV0       
002275     MOVE X'2A2220492020204C20202020' &                           
002276          X'202020202020202020202720' &                           
002277          X'2020233030303032303831' TO DFHEIV0                    
002278     CALL 'kxdfhei1' USING DFHEIV0,                               
002279           WPAGCTRL,                                              
002280           WPAGREFE,                                              
002281           WPAGLPAG,                                              
002282           WNUMITEM,                                              
002283           DFHEIV99,                                              
002284           DFHEIV99                                               
002285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002286                                                                  
002287 R10-EX. EXIT.                                                    
002288*----------------------------------------------------------------*
002289 R20-READQ-WPAG.                                                  
002290*----------------------------------------------------------------*
002291     INITIALIZE WPAGREFE                                          
002292                                                                  
002293* EXEC CICS HANDLE CONDITION ITEMERR(R20-EX)                      
002294*                               QIDERR (R20-EX)                   
002295*                               END-EXEC.                         
002296*    MOVE '"$<N                  ! & #00002091' TO DFHEIV0        
002297     MOVE X'22243C4E2020202020202020' &                           
002298          X'202020202020202020202120' &                           
002299          X'2620233030303032303931' TO DFHEIV0                    
002300     CALL 'kxdfhei1' USING DFHEIV0                                
002301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002302                                                                  
002303                                                                  
002304* EXEC CICS READQ  TS  QUEUE   (WPAGCTRL)                         
002305*                         INTO    (WPAGREFE)                      
002306*                         ITEM    (WNUMITEM)                      
002307*                         LENGTH  (WPAGLPAG)                      
002308*                         END-EXEC.                               
002309*    MOVE '*$II   L              ''   #00002094' TO DFHEIV0       
002310     MOVE X'2A2449492020204C20202020' &                           
002311          X'202020202020202020202720' &                           
002312          X'2020233030303032303934' TO DFHEIV0                    
002313     CALL 'kxdfhei1' USING DFHEIV0,                               
002314           WPAGCTRL,                                              
002315           WPAGREFE,                                              
002316           WPAGLPAG,                                              
002317           WNUMITEM,                                              
002318           DFHEIV99,                                              
002319           DFHEIV99                                               
002320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002321                                                                  
002322 R20-EX. EXIT.                                                    
002323*-----------------------------------------------------------*     
002324 R30-REWRITE-WPAGLO50.                                            
002325*-----------------------------------------------------------*     
002326                                                                  
002327* EXEC CICS WRITEQ TS QUEUE (WPAGLO50)                            
002328*                        FROM  (WLO50-CODA)                       
002329*                        LENGTH(WLO50-LENGTH)                     
002330*                        ITEM  (WLO50-ITEM)                       
002331*                        REWRITE                                  
002332*    END-EXEC.                                                    
002333*    MOVE '*" IR  L              ''   #00002103' TO DFHEIV0       
002334     MOVE X'2A2220495220204C20202020' &                           
002335          X'202020202020202020202720' &                           
002336          X'2020233030303032313033' TO DFHEIV0                    
002337     CALL 'kxdfhei1' USING DFHEIV0,                               
002338           WPAGLO50,                                              
002339           WLO50-CODA,                                            
002340           WLO50-LENGTH,                                          
002341           WLO50-ITEM,                                            
002342           DFHEIV99,                                              
002343           DFHEIV99                                               
002344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002345                                                                  
002346 R30-EX. EXIT.                                                    
002347*-----------------------------------------------------------*     
002348 R40-REWRITE-WPAGLO20.                                            
002349*-----------------------------------------------------------*     
002350                                                                  
002351* EXEC CICS WRITEQ TS QUEUE (WPAGLO20)                            
002352*                        FROM  (WLO20-CODA)                       
002353*                        LENGTH(WLO20-LENGTH)                     
002354*                        ITEM  (WLO20-ITEM)                       
002355*                        REWRITE                                  
002356*    END-EXEC.                                                    
002357*    MOVE '*" IR  L              ''   #00002113' TO DFHEIV0       
002358     MOVE X'2A2220495220204C20202020' &                           
002359          X'202020202020202020202720' &                           
002360          X'2020233030303032313133' TO DFHEIV0                    
002361     CALL 'kxdfhei1' USING DFHEIV0,                               
002362           WPAGLO20,                                              
002363           WLO20-CODA,                                            
002364           WLO20-LENGTH,                                          
002365           WLO20-ITEM,                                            
002366           DFHEIV99,                                              
002367           DFHEIV99                                               
002368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002369                                                                  
002370 R40-EX. EXIT.                                                    
002371*----------------------------------------------------------------*
002372 W00-DELETE-SERVIZI.                                              
002373*----------------------------------------------------------------*
002374     MOVE 'W00-'               TO WCOM-CODABEND                   
002375     MOVE 'DELETE'             TO WCOM-FILEFUNZ                   
002376     MOVE 'SERVIZI'            TO WCOM-FILENOME                   
002377     MOVE L651-CODSERVI        TO WCOM-FILECTRL                   
002379     
      *EXEC SQL 
      *DELETE FROM DLOGISTI.TSERVIZI                           
002380*           WHERE CODSERVI = :L651-CODSERVI                        
002381*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 23 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CODSERVI
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 12 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
002382     IF SQLCODE NOT = 0                                           
002383        PERFORM Z00-ERRORE                                        
002384           THRU Z00-EX.                                           
002385 W00-EX. EXIT.                                                    
002386*----------------------------------------------------------------*
002387 W10-INSERT-SERVIZI.                                              
002388*----------------------------------------------------------------*
002389     MOVE 'W10-'               TO WCOM-CODABEND                   
002390     MOVE 'INSERT'             TO WCOM-FILEFUNZ                   
002391     MOVE 'SERVIZI'            TO WCOM-FILENOME                   
002392     MOVE L651-CODSERVI        TO WCOM-FILECTRL                   
002394     
      *EXEC SQL 
      *INSERT INTO DLOGISTI.TSERVIZI                           
002395*                (CODSERVI                                         
002396*                ,DESSERVI                                         
002397*                ,UNMISURA                                         
002398*                ,TIPSERVI                                         
002399*                ,CENCOSTA                                         
002400*                ,ESENTIVA                                         
002401*                ,DTCREAZI                                         
002402*                ,DTULTVAR                                         
002403*                ,CODUTVAR                                         
002404*                ,CONTPROV)                                        
002405*          VALUES                                                  
002406*                (:L651-CODSERVI                                   
002407*                ,:L651-DESSERVI                                   
002408*                ,:L651-UNMISURA                                   
002409*                ,:L651-TIPSERVI                                   
002410*                ,:L651-CENCOSTA                                   
002411*                ,:L651-ESENTIVA                                   
002412*                ,:L651-DTCREAZI                                   
002413*                ,:L651-DTULTVAR                                   
002414*                ,:L651-CODUTVAR                                   
002415*                ,:L651-CONTPROV)                                  
002416*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 24 TO SQL-STMT-ID 
           MOVE 10 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CODSERVI
            BY VALUE 0
                     0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-DESSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-UNMISURA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-TIPSERVI
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CENCOSTA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-ESENTIVA
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-DTCREAZI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CODUTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CONTPROV
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 13 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002417 W10-EX. EXIT.                                                    
002418*----------------------------------------------------------------*
002419 W20-UPDATE-SERVIZI.                                              
002420*----------------------------------------------------------------*
002421     MOVE 'W20-'               TO WCOM-CODABEND                   
002422     MOVE 'UPDATE'             TO WCOM-FILEFUNZ                   
002423     MOVE 'SERVIZI'            TO WCOM-FILENOME                   
002424     MOVE L651-CODSERVI        TO WCOM-FILECTRL                   
002426     
      *EXEC SQL 
      *UPDATE DLOGISTI.TSERVIZI                                
002427*             SET DESSERVI = :L651-DESSERVI                        
002428*                ,UNMISURA = :L651-UNMISURA                        
002429*                ,TIPSERVI = :L651-TIPSERVI                        
002430*                ,CONTODCD = :L651-CONTODCD                        
002431*                ,CONTODCA = :L651-CONTODCA                        
002432*                ,CENCOSTA = :L651-CENCOSTA                        
002433*                ,ESENTIVA = :L651-ESENTIVA                        
002434*                ,DTULTVAR = :L651-DTULTVAR                        
002435*                ,CODUTVAR = :L651-CODUTVAR                        
002436*                ,CONTPROV = :L651-CONTPROV                        
002437*           WHERE CODSERVI = :L651-CODSERVI                        
002438*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 25 TO SQL-STMT-ID 
           MOVE 11 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-DESSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-UNMISURA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-TIPSERVI
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CONTODCD
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CONTODCA
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CENCOSTA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-ESENTIVA
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CODUTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CONTPROV
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CODSERVI
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 14 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
002439     IF SQLCODE NOT = 0                                           
002440        PERFORM Z00-ERRORE                                        
002441           THRU Z00-EX.                                           
002442 W20-EX. EXIT.                                                    
002443*----------------------------------------------------------------*
002444 U00-RETURN-TRAN.                                                 
002445*----------------------------------------------------------------*
002446                                                                  
002447* EXEC CICS RETURN TRANSID  (EIBTRNID)                            
002448*                     COMMAREA (WCOM-AREAXXXX)                    
002449*                     LENGTH   (WCOM-LUNGHEZZ)                    
002450*                     END-EXEC.                                   
002451*    MOVE '.(CT                  ''   #00002195' TO DFHEIV0       
002452     MOVE X'2E2843542020202020202020' &                           
002453          X'202020202020202020202720' &                           
002454          X'2020233030303032313935' TO DFHEIV0                    
002455     CALL 'kxdfhei1' USING DFHEIV0,                               
002456           EIBTRNID,                                              
002457           WCOM-AREAXXXX,                                         
002458           WCOM-LUNGHEZZ,                                         
002459           DFHEIV99,                                              
002460           DFHEIV99,                                              
002461           DFHEIV99                                               
002462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002463                                                                  
002464 U00-EX. EXIT.                                                    
002465*----------------------------------------------------------------*
002466 U02-NORESP.                                                      
002467*----------------------------------------------------------------*
002468                                                                  
002469* EXEC CICS SEND CONTROL                                          
002470*                   FREEKB                                        
002471*                   END-EXEC.                                     
002472*    MOVE '82      T    F        (   #00002203' TO DFHEIV0        
002473     MOVE X'383220202020202054202020' &                           
002474          X'204620202020202020202820' &                           
002475          X'2020233030303032323033' TO DFHEIV0                    
002476     CALL 'kxdfhei1' USING DFHEIV0,                               
002477           DFHEIV99,                                              
002478           DFHEIV99,                                              
002479           DFHEIV99,                                              
002480           DFHEIV99,                                              
002481           DFHEIV99,                                              
002482           DFHEIV99,                                              
002483           DFHEIV99                                               
002484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002485                                                                  
002486     PERFORM U00-RETURN-TRAN                                      
002487        THRU U00-EX.                                              
002488 U02-EX. EXIT.                                                    
002489*----------------------------------------------------------------*
002490 U10-DECODIFICA-MESSAGGIO.                                        
002491*----------------------------------------------------------------*
002492     MOVE WCOM-CODILING        TO MESS-CODILING.                  
002493*    EXEC SQL INCLUDE SRMESS END-EXEC.                            
      *>>((file: SRMESS))
000001*-------------------------------------------------- SRMESS START* 
000002*-  AUTHOR: FEBBRAIOLA DOMENICO & GIUSEPPE RASPINO              * 
000003*---------------------------------------------------------------* 
000004*                                                               * 
000005*  SUBROUTINE PER LA RICERCA DEI MESSAGGI IN LINGUA             * 
000006*                                                               * 
000007*  N.B.  INSERIRE IN WORKING STORAGE :                          * 
000008*            EXEC SQL INCLUDE FDANA846 END-EXEC.                * 
000009*            COPY  DCMESS                                       * 
000010*                                                               * 
000011*  N.B.  IMPOSTARE DATI IN :                                    * 
000012*            MESS-CODERROR                                      * 
000013*            MESS-CODILING                                      * 
000014*                                                               * 
000015***************************************************************** 
000016                                                                  
000017     MOVE 'SELECT'             TO WCOM-FILEFUNZ                   
000018     MOVE 'FDANA846'           TO WCOM-FILENOME                   
000019     MOVE 'SRME'               TO WCOM-CODABEND                   
000020     MOVE MESS-CODERROR        TO WCOM-FILECTRL                   
000021                                                                  
000022     MOVE SPACES               TO MESS-CAMPI-OUTPUT.              
000023     MOVE MESS-CODERROR        TO A846-CODERROR.                  
000024     MOVE MESS-CODILING        TO A846-CODILING.                  
000025                                                                  
000027     
      *EXEC SQL 
      *SELECT MSGERROR                                         
000028*          INTO  :A846-MSGERROR                                    
000029*          FROM   DANAGRAF.TMESSAGGI                               
000030*          WHERE  CODERROR = :A846-CODERROR AND                    
000031*                 CODILING = :A846-CODILING                        
000032*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 26 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODERROR
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODILING
            BY VALUE 0
                     0

           MOVE 27 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 60 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-MSGERROR
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 15 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000033                                                                  
000034     IF SQLCODE NOT EQUAL ZEROS AND                               
000035        SQLCODE NOT EQUAL +100                                    
000036        PERFORM Z00-ERRORE                                        
000037           THRU Z00-EX                                            
000038     ELSE                                                         
000039        IF SQLCODE EQUAL ZEROS                                    
000040           MOVE MESS-CODERROR    TO MESS-COMCODER                 
000041           MOVE A846-MSGERROR    TO MESS-MESSAGGI                 
000042        ELSE                                                      
000043           MOVE '99999'          TO A846-CODERROR                 
000044           MOVE MESS-CODILING    TO A846-CODILING                 
000046           
      *EXEC SQL 
      *SELECT MSGERROR                                   
000047*                INTO  :A846-MSGERROR                              
000048*                FROM   DANAGRAF.TMESSAGGI                         
000049*                WHERE  CODERROR = :A846-CODERROR AND              
000050*                       CODILING = :A846-CODILING                  
000051*           END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 28 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODERROR
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODILING
            BY VALUE 0
                     0

           MOVE 29 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 60 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-MSGERROR
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 16 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000052           IF SQLCODE EQUAL ZEROS                                 
000053              MOVE MESS-CODERROR TO MESS-COMCODER                 
000054              MOVE A846-MSGERROR TO MESS-MESSAGGI                 
000055           ELSE                                                   
000056              IF SQLCODE = 100                                    
000057                 MOVE MESS-CODERROR   TO MESS-COMCODER            
000058                 MOVE '*** MESSAGGIO  NON  TROVATO ****'          
000059                                      TO MESS-MESSAGGI            
000060              ELSE                                                
000061                 PERFORM Z00-ERRORE                               
000062                     THRU Z00-EX.                                 
000063                                                                  
000064*------------------------------------------------- SRMESS    END* 
      *<<((file: SRMESS))
002494     MOVE MESS-MSGERROR        TO LO10-MESSAGGO.                  
002495 U10-EX. EXIT.                                                    
002496*----------------------------------------------------------------*
002497 U20-DELETE-TS.                                                   
002498*----------------------------------------------------------------*
002499                                                                  
002500* EXEC CICS DELETEQ TS QUEUE  (WPAGCTRL)                          
002501*                         NOHANDLE                                
002502*                         END-EXEC.                               
002503*    MOVE '*&                    #  N#00002219' TO DFHEIV0        
002504     MOVE X'2A2620202020202020202020' &                           
002505          X'202020202020202020202320' &                           
002506          X'204E233030303032323139' TO DFHEIV0                    
002507     CALL 'kxdfhei1' USING DFHEIV0,                               
002508           WPAGCTRL,                                              
002509           DFHEIV99                                               
002510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002511                                                                  
002512 U20-EX. EXIT.                                                    
002513*----------------------------------------------------------------*
002514*COPY DCPERDB2.                                                   
002515*SRERCICS/P---------S = SOURCE / P = PRECOMPILED ----------------*
002516*----*  ROUTINE INTERCETTA ERRORE CICS                      *----*
002517*----*                                                      *----*
002518*----------------------------------------------------------------*
002519*       QUESTA ROUTINE E' LA PRIMA DA DICHIARARE COME COPY        
002520*----*                                                      *----*
002521*----------------------------------------------------------------*
002522*    ES.    **                                                    
002523*    ES.         COPY SRERCICP.                                   
002524*    ES.    **   SE VOGLIO INTERCETTARE ERRORE DB2                
002525*    ES.         COPY SRERDB2P                                    
002526*    ES.    **   SE VOGLIO INTERCETTARE ERRORE TOTAL              
002527*    ES.         COPY SRERDB2P                                    
002528*    ES.    **  ETC.                                              
002529*    ES.                                                          
002530*    ES.    **   ULTIMA ROUTINE CHE RILASCIA TR-ERRE  PER DECODI  
002531*    ES.    **   ERRORE                                           
002532*    ES.         COPY SRERENDS                                    
002533*                                                                 
002534*----------------------------------------------------------------*
002535 Z00-ERRORE.                                                      
002536*----------------------------------------------------------------*
002537     MOVE DFHEIV0                TO T-COMLINE.                    
002538     PERFORM                                                      
002539        VARYING INDERR FROM 1 BY 1                                
002540            UNTIL INDERR GREATER 25                               
002541               OR EL-COMLINE (INDERR) EQUAL ZERO                  
002542     END-PERFORM.                                                 
002543     MOVE SPACES                 TO WLINEAXX.                     
002544     IF INDERR LESS 26                                            
002545        MOVE EL-COMLINE (INDERR) TO EL-LINE (1)                   
002546        ADD 1                    TO INDERR                        
002547        MOVE EL-COMLINE (INDERR) TO EL-LINE (2)                   
002548        ADD 1                    TO INDERR                        
002549        MOVE EL-COMLINE (INDERR) TO EL-LINE (3)                   
002550        ADD 1                    TO INDERR                        
002551        MOVE EL-COMLINE (INDERR) TO EL-LINE (4)                   
002552        ADD 1                    TO INDERR                        
002553        MOVE EL-COMLINE (INDERR) TO EL-LINE (5).                  
002554     MOVE WLINEAXX               TO WCOM-PRGMLINE.                
002555     MOVE EIBFN                  TO WCOM-CODEIBFN.                
002556     MOVE EIBRCODE               TO WCOM-CODERCOD.                
002557     MOVE SPACES                 TO WCOM-ABENCICS.                
002558     IF EIBRESP  NOT = ZERO OR                                    
002559        EIBRESP2 NOT = ZERO                                       
002560                                                                  
002561* EXEC CICS                                                       
002562*      ASSIGN ABCODE (WCOM-ABENCICS)                              
002563*END-EXEC.                                                        
002564*    MOVE '"((                   "   #00002270' TO DFHEIV0        
002565     MOVE X'222828202020202020202020' &                           
002566          X'202020202020202020202220' &                           
002567          X'2020233030303032323730' TO DFHEIV0                    
002568     CALL 'kxdfhei1' USING DFHEIV0,                               
002569           WCOM-ABENCICS                                          
002570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002571                                                                  
002572*       CALL 'DFHEI1' USING DFHEIV0  WCOM-ABENCICS.               
002573*SRERDB2S/P -----------------------------------------------------*
002574*----*  ROUTINE INTERCETTA ERRORE DB2                       *----*
002575*----*                                                      *----*
002576*----------------------------------------------------------------*
002577*       QUESTA ROUTINE E' DA DICHIARARE DOPO LA SRERCICS          
002578*                                                                 
002579     MOVE 'ABEN'                 TO WCOM-CODATSX1.                
002580     MOVE EIBTRMID               TO WCOM-CODATSX2.                
002581*    MOVE LENGTH OF SQLCA        TO WCOM-LUNGHERR.                
002582     MOVE 136                    TO WCOM-LUNGHERR.                
002583                                                                  
002584* EXEC CICS WRITEQ TS    QUEUE  (WCOM-CODATSXX)                   
002585*                       FROM   (SQLCA)                            
002586*                       LENGTH (WCOM-LUNGHERR)                    
002587*END-EXEC.                                                        
002588*    MOVE '*"     L              ''   #00002284' TO DFHEIV0       
002589     MOVE X'2A2220202020204C20202020' &                           
002590          X'202020202020202020202720' &                           
002591          X'2020233030303032323834' TO DFHEIV0                    
002592     CALL 'kxdfhei1' USING DFHEIV0,                               
002593           WCOM-CODATSXX,                                         
002594           SQLCA,                                                 
002595           WCOM-LUNGHERR,                                         
002596           DFHEIV99,                                              
002597           DFHEIV99,                                              
002598           DFHEIV99                                               
002599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002600                                                                  
002601*    CALL 'DFHEI1' USING DFHEIV0  WCOM-CODATSXX SQLCA             
002602*    WCOM-LUNGHERR.                                               
002603*SRERENDS/P------------------------------------------------------*
002604*----*  ROUTINE FINALE                                      *----*
002605*----*                                                      *----*
002606*----------------------------------------------------------------*
002607*       QUESTA ROUTINE DA DICHIARARE PER ULTIMA NELLA SEQUNZA     
002608*       DELLE COPY  PER INTERCETTARE L'ERRORE                     
002609*----------------------------------------------------------------*
002610*----------------------------------------------------------------*
002611      MOVE EIBTRNID              TO WCOM-TRANSAZI.                
002612                                                                  
002613* EXEC CICS SYNCPOINT ROLLBACK                                    
002614*END-EXEC.                                                        
002615*    MOVE '6"R                   !   #00002299' TO DFHEIV0        
002616     MOVE X'362252202020202020202020' &                           
002617          X'202020202020202020202120' &                           
002618          X'2020233030303032323939' TO DFHEIV0                    
002619     CALL 'kxdfhei1' USING DFHEIV0                                
002620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002621                                                                  
002622*     CALL 'DFHEI1' USING DFHEIV0.                                
002623                                                                  
002624* EXEC CICS ASSIGN SYSID (WCOM-SYSID)                             
002625*END-EXEC.                                                        
002626*    MOVE '"(         $          "   #00002302' TO DFHEIV0        
002627     MOVE X'222820202020202020202024' &                           
002628          X'202020202020202020202220' &                           
002629          X'2020233030303032333032' TO DFHEIV0                    
002630     CALL 'kxdfhei1' USING DFHEIV0,                               
002631           WCOM-SYSID                                             
002632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002633                                                                  
002634*     CALL 'DFHEI1' USING DFHEIV0  WCOM-SYSID.                    
002635      MOVE 'ABEN'                    TO WCOM-CODATSX1.            
002636      MOVE EIBTRMID                  TO WCOM-CODATSX2.            
002637*     MOVE LENGTH OF WCOM-AREA-ERROR TO WCOM-LUNGHERR.            
002638      MOVE 200                       TO WCOM-LUNGHERR.            
002639*EXEC CICS WRITEQ TS QUEUE  (WCOM-CODATSXX)                       
002640                                                                  
002641* EXEC CICS WRITEQ TS                                             
002642*                    QUEUE  (WCOM-CODATSXX)                       
002643*                    FROM   (WCOM-AREA-ERROR)                     
002644*                    LENGTH (WCOM-LUNGHERR)                       
002645*END-EXEC.                                                        
002646*    MOVE '*"     L              ''   #00002310' TO DFHEIV0       
002647     MOVE X'2A2220202020204C20202020' &                           
002648          X'202020202020202020202720' &                           
002649          X'2020233030303032333130' TO DFHEIV0                    
002650     CALL 'kxdfhei1' USING DFHEIV0,                               
002651           WCOM-CODATSXX,                                         
002652           WCOM-AREA-ERROR,                                       
002653           WCOM-LUNGHERR,                                         
002654           DFHEIV99,                                              
002655           DFHEIV99,                                              
002656           DFHEIV99                                               
002657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002658                                                                  
002659*     CALL 'DFHEI1' USING DFHEIV0  WCOM-CODATSXX WCOM-AREA-ERROR  
002660*    WCOM-LUNGHERR.                                               
002661                                                                  
002662* EXEC CICS START TRANSID ('ERRE')                                
002663*                FROM    (WCOM-AREAXXXX)                          
002664*                LENGTH  (WCOM-LUNGHEZZ)                          
002665*                TERMID  (EIBTRMID)                               
002666*END-EXEC.                                                        
002667     MOVE 'ERRE' TO DFHEIV5                                       
002668*    MOVE '0( LFT                1   #00002317' TO DFHEIV0        
002669     MOVE X'3028204C4654202020202020' &                           
002670          X'202020202020202020203120' &                           
002671          X'2020233030303032333137' TO DFHEIV0                    
002672     CALL 'kxdfhei1' USING DFHEIV0,                               
002673           DFHEIV99,                                              
002674           DFHEIV5,                                               
002675           DFHEIV99,                                              
002676           WCOM-AREAXXXX,                                         
002677           WCOM-LUNGHEZZ,                                         
002678           EIBTRMID,                                              
002679           DFHEIV99,                                              
002680           DFHEIV99,                                              
002681           DFHEIV99,                                              
002682           DFHEIV99,                                              
002683           DFHEIV99,                                              
002684           DFHEIV99,                                              
002685           DFHEIV99,                                              
002686           DFHEIV99,                                              
002687           DFHEIV99,                                              
002688           DFHEIV99                                               
002689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002690                                                                  
002691*      MOVE 'ERRE' TO DFHC0040                                    
002692*     CALL 'DFHEI1' USING DFHEIV0  DFHEID0 DFHDUMMY DFHC0040      
002693*    WCOM-AREAXXXX WCOM-LUNGHEZZ EIBTRMID.                        
002694                                                                  
002695* EXEC CICS ABEND ABCODE (WCOM-ABENCICS)                          
002696*                CANCEL                                           
002697*END-EXEC.                                                        
002698*    MOVE '.,AC                  "   #00002325' TO DFHEIV0        
002699     MOVE X'2E2C41432020202020202020' &                           
002700          X'202020202020202020202220' &                           
002701          X'2020233030303032333235' TO DFHEIV0                    
002702     CALL 'kxdfhei1' USING DFHEIV0,                               
002703           WCOM-ABENCICS                                          
002704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002705                                                                  
002706*     CALL 'DFHEI1' USING DFHEIV0  WCOM-ABENCICS.                 
002707 Z00-EX. EXIT.                                                    
002708                                                                  
002709 9999-DFHBACK SECTION.                                            
002710     MOVE '9%                    "   ' TO DFHEIV0                 
002711     MOVE 'AVTLO10' TO DFHEIV1                                    
002712     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1                        
002713     GOBACK.                                                      
002714 9999-DFHEXIT.                                                    
002715     IF DFHEIGDJ EQUAL 0001                                       
002716         NEXT SENTENCE                                            
002717     ELSE IF DFHEIGDJ EQUAL 2                                     
002718         GO TO Z00-ERRORE                                         
002719         DEPENDING ON DFHEIGDI                                    
002720     ELSE IF DFHEIGDJ EQUAL 3                                     
002721         GO TO B05-NORESP                                         
002722         DEPENDING ON DFHEIGDI                                    
002723     ELSE IF DFHEIGDJ EQUAL 4                                     
002724         GO TO R00-EX,                                            
002725               R00-EX                                             
002726         DEPENDING ON DFHEIGDI                                    
002727     ELSE IF DFHEIGDJ EQUAL 5                                     
002728         GO TO R05-EX,                                            
002729               R05-EX                                             
002730         DEPENDING ON DFHEIGDI                                    
002731     ELSE IF DFHEIGDJ EQUAL 6                                     
002732         GO TO R20-EX,                                            
002733               R20-EX                                             
002734         DEPENDING ON DFHEIGDI.                                   
002735     MOVE '9%                    "   ' TO DFHEIV0                 
002736     MOVE 'AVTLO10' TO DFHEIV1                                    
002737     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1                        
002738     GOBACK.                                                      
