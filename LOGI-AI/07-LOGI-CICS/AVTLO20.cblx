      *((program: AVTLO20.cblx))
000001*-------------* PROGRAMMA  CICS/DB2 COBOL2 *--------------------* 
000002 ID  DIVISION.                                                    
000003*-------------*                                                   
000004 PROGRAM-ID. AVTLO20.                             
000005*---------------------------------------------------------------* 
000006*                CARICO ORDINE DI LOGISTICA                     * 
000007*---------------------------------------------------------------* 
000008*  IL PROGRAMMA GESTISCE IL CARICO E LA VARIAZIONE DEGLI        * 
000009*  ORDINI PER SERVIZI DI LOGISTICA.                             * 
000010*---------------------------------------------------------------* 
000011 ENVIRONMENT DIVISION.                                            
000012*---------------------*                                           
000013 CONFIGURATION SECTION.                                           
000014 SPECIAL-NAMES.                                                   
000015     DECIMAL-POINT IS COMMA.                                      
000016 DATA DIVISION.                                                   
000017*--------------*                                                  
000018 WORKING-STORAGE SECTION.

       01  SQLDA-ID pic 9(4) comp-5.
       01  SQLDSIZE pic 9(4) comp-5.
       01  SQL-STMT-ID pic 9(4) comp-5.
       01  SQLVAR-INDEX pic 9(4) comp-5.
       01  SQL-DATA-TYPE pic 9(4) comp-5.
       01  SQL-HOST-VAR-LENGTH pic 9(9) comp-5.
       01  SQL-S-HOST-VAR-LENGTH pic 9(9) comp-5.
       01  SQL-S-LITERAL pic X(258).
       01  SQL-LITERAL1 pic X(130).
       01  SQL-LITERAL2 pic X(130).
       01  SQL-LITERAL3 pic X(130).
       01  SQL-LITERAL4 pic X(130).
       01  SQL-LITERAL5 pic X(130).
       01  SQL-LITERAL6 pic X(130).
       01  SQL-LITERAL7 pic X(130).
       01  SQL-LITERAL8 pic X(130).
       01  SQL-LITERAL9 pic X(130).
       01  SQL-LITERAL10 pic X(130).
       01  SQL-IS-LITERAL pic 9(4) comp-5 value 1.
       01  SQL-IS-INPUT-HVAR pic 9(4) comp-5 value 2.
       01  SQL-CALL-TYPE pic 9(4) comp-5.
       01  SQL-SECTIONUMBER pic 9(4) comp-5.
       01  SQL-INPUT-SQLDA-ID pic 9(4) comp-5.
       01  SQL-OUTPUT-SQLDA-ID pic 9(4) comp-5.
       01  SQLA-PROGRAM-ID.
           05 SQL-PART1 pic 9(4) COMP-5 value 172.
           05 SQL-PART2 pic X(6) value "AEAQAI".
           05 SQL-PART3 pic X(24) value "aBdiQEBo01111 2         ".
           05 SQL-PART4 pic 9(4) COMP-5 value 8.
           05 SQL-PART5 pic X(8) value "DB2XMT  ".
           05 SQL-PART6 pic X(120) value LOW-VALUES.
           05 SQL-PART7 pic 9(4) COMP-5 value 8.
           05 SQL-PART8 pic X(8) value "AVTLO20 ".
           05 SQL-PART9 pic X(120) value LOW-VALUES.
                                                                        
000019 01  DFH-START PIC X(04).                                         
000020 01  FILLER                      PIC X(8) VALUE 'DCWCOMMA'.       
000021*    COPY DCWCOMMA.                                               
000022*---------------------------------------------------------------* 
000023*----*            AREA DI PASSAGGIO DATI - WWTERRE         *----* 
000024*---------------------------------------------------------------* 
000025 01  WCOM-LUNGHERR                PIC S9(4) COMP VALUE +200.      
000026 01  WCOM-AREA-ERROR.                                             
000027     02 FILLER                    PIC X(8) VALUE 'CICSERRO'.      
000028     02 WCOM-FILEMESG.                                            
000029        04 WCOM-FILEFUNZ          PIC X(10).                      
000030        04 WCOM-FILESTAT          PIC X(5).                       
000031        04 WCOM-SQLCODEX REDEFINES WCOM-FILESTAT                  
000032                                  PIC -Z(4).                      
000033        04 WCOM-FILENOME          PIC X(30).                      
000034        04 WCOM-FILECTR1.                                         
000035           05 WCOM-FILECTRL       PIC X(35).                      
000036     02 WCOM-MESSAGE1 REDEFINES WCOM-FILEMESG.                    
000037        05 WCOM-MESSAGES          PIC X(80).                      
000038     02 WCOM-CODABEND             PIC X(4).                       
000039     02 WCOM-ABENCICS             PIC X(4).                       
000040     02 WCOM-PRGMLINE             PIC X(5)  VALUE SPACES.         
000041     02 WCOM-CODEIBFN             PIC X(2).                       
000042     02 WCOM-CODERCOD             PIC X(6).                       
000043     02 FILLER                    PIC X(91).                      
000044*---------------------------------------------------------------* 
000045*----*                AREA DI COMMAREA                     *----* 
000046*---------------------------------------------------------------* 
000047*---------------------- LUNGHEZZA WCOM-AREAXXXX                   
000048 01  WCOM-LUNGHEZZ                     PIC S9(4) COMP VALUE +300. 
000049*---------------------- NOME DEL PROGRAMMA                        
000050 01  WCOM-AREAXXXX.                                               
000051     05  WCOM-NOMEPRGM                 PIC X(8)  VALUE SPACES.    
000052*---------------------- PAGINA RICHIESTA                          
000053     05  WCOM-PAGIRICH                 PIC S9(5) COMP-3.          
000054*---------------------- PAGINA LISTATA                            
000055     05  WCOM-PAGILIST                 PIC S9(5) COMP-3.          
000056*---------------------- PAGINA ULTIMA                             
000057     05  WCOM-PAGIULTI                 PIC S9(5) COMP-3.          
000058*---------------------- FLAG PER MODULO GESTIONE FUNZIONI ESTERNE 
000059     05  WCOM-FLAGFUNZ.                                           
000060         10  WCOM-RETURNXX             PIC X(1).                  
000061         10  WCOM-DELETETS             PIC X(1).                  
000062         10  WCOM-CODILING             PIC X(1).                  
000063*---------------------- FLAG PER AGGIORNAMENTI                    
000064     05  WCOM-FLAGPRGM                 PIC X(1)  VALUE SPACES.    
000065*---------------------- SOTTOSISTEMA CICS                         
000066     05  WCOM-SYSID                    PIC X(4)  VALUE '????'.    
000067*---------------------- PRINTER ABBINATA CON 'P'                  
000068     05  WCOM-PRINTERX                 PIC X(4).                  
000069*---------------------- PRINTER ASSOCIATA MAG. FINITI             
000070     05  WCOM-PRINTERY                 PIC X(4).                  
000071*---------------------- PRINTER ASSOCIATA ALLA TRANSAZIONE        
000072     05  WCOM-PRINTERT                 PIC X(4).                  
000073*---------------------- PRINTER BAR-CODE O MODULI SPECIALI        
000074     05  WCOM-PRINTERB                 PIC X(4).                  
000075*---------------------- TRANSAZIONE                               
000076     05  WCOM-TRANSAZI                 PIC X(4).                  
000077*---------------------- DATA DEL GIORNO DA MENU'                  
000078     05  WCOM-DATAXXXX.                                           
000079         10  WCOM-DATAGGXX             PIC X(2).                  
000080         10  WCOM-DATAGGXN REDEFINES WCOM-DATAGGXX  PIC 9(2).     
000081         10  WCOM-BARRAUNO             PIC X(1).                  
000082         10  WCOM-DATAMMXX             PIC X(2).                  
000083         10  WCOM-DATAMMXN REDEFINES WCOM-DATAMMXX  PIC 9(2).     
000084         10  WCOM-BARRADUE             PIC X(1).                  
000085         10  WCOM-DATAAAXX.                                       
000086             15 WCOM-DATAAAX1          PIC 9(1).                  
000087             15 WCOM-DATAAAX2          PIC 9(1).                  
000088         10  WCOM-DATAAAXN REDEFINES WCOM-DATAAAXX  PIC 9(2).     
000089*---------------------- NOME DELLA CODA TS GENERICA               
000090     05  WCOM-CODATSXX.                                           
000091         10 WCOM-CODATSX1              PIC X(4)  VALUE SPACES.    
000092         10 WCOM-CODATSX2              PIC X(4)  VALUE SPACES.    
000093*---------------------- DATA DEL GIORNO                           
000094     05  WCOM-DTCREAZI.                                           
000095         10 WCOM-DTCREAZI-SY.                                     
000096            15 WCOM-DTCREAZI-SS        PIC X(2).                  
000097            15 WCOM-DTCREAZI-YY        PIC X(2).                  
000098         10 WCOM-DTCREAZI-SYN REDEFINES WCOM-DTCREAZI-SY PIC 9(4).
000099         10 WCOM-DTCREAZI-MM           PIC X(2).                  
000100         10 WCOM-DTCREAZI-DD           PIC X(2).                  
000101*---------------------- CODICE UTENTE                             
000102     05  WCOM-UTENCICS                 PIC X(6).                  
000103*---------------------- TRANSAZIONI NELL' AMBITO DELLA RICHIESTA  
000104     05  WCOM-INDITRAN                 PIC 9(2).                  
000105     05  WCOM-TABETRAN.                                           
000106         10  WCOM-MENUTRAN  OCCURS 10  PIC X(4).                  
000107         10  WCOM-PAGITRAN  OCCURS 10  PIC S9(5) COMP-3.          
000108*---------------------- FLAG AVVISI UTENTI/TRANSAZIONI DA SCTUTENT
000109     05  WCOM-FLAGUTEN                 PIC X(1).                  
000110     05  WCOM-FLAGTRAN                 PIC X(1).                  
000111*---------------------- FLAG UTENTI LIMITATI                      
000112     05  WCOM-FLAGLIMI                 PIC X(1).                  
000113*---------------------- LIBERI                                    
000114     05  FILLER                        PIC X(25).                 
000115*---------------------- RICHIESTA                                 
000116     05  WCOM-RIKIESTA.                                           
000117         10   WCOM-COMODOXX            PIC X(125).                
000118*    COPY DCLOGI.                                                 
000119******************************************************************
000120*                        *** DCLOGI ***                          *
000121*     DSECT RELATIVA ALLA COMMAREA DEGLI ORDINI DI LOGISTICA     *
000122*                    - LUNGHEZZA 175 BYTES -                     *
000123******************************************************************
000124         10  FILLER                           PIC X(200).         
000125     05  WORK-RICHIESTA REDEFINES WCOM-RIKIESTA.                  
000126         10  WCOM-DCLOGI.                                         
000127             15  WCOM-CODUTENT                PIC X(06).          
000128             15  WCOM-CODSOCIE                PIC X(02).          
000129             15  WCOM-CDDIVISI                PIC X(01).          
000130             15  WCOM-CODDEPOS                PIC X(02).          
000131             15  WCOM-CODCLIEN                PIC X(05).          
000132             15  WCOM-CLIFOCON                PIC X(05).          
000133             15  WCOM-CODSERVI                PIC X(06).          
000134             15  WCOM-TIPSERVI                PIC X(01).          
000135             15  WCOM-CODDIVIS                PIC X(02).          
000136             15  WCOM-UNMISURA                PIC X(02).          
000137             15  WCOM-AANUMORD                PIC X(08).          
000138             15  WCOM-NRRIGORD                PIC S9(3)  COMP-3.  
000139             15  WCOM-CONTODCE                PIC X(06).          
000140             15  WCOM-SALDATOX                PIC X(01).          
000141             15  WCOM-OPERAZIO                PIC X(01).          
000142             15  WCOM-DECIDIVI                PIC X(01).          
000143             15  WCOM-CONTOPER                PIC S9(5)  COMP-3.  
000144             15  WCOM-CODERROR                PIC X(05).          
000145             15  WCOM-FLAGAUTO                PIC X(01).          
000146             15  WCOM-SOCIEMER                PIC X(02).          
000147             15  WCOM-TIPOARTI                PIC X(01).          
000148             15  WCOM-PAESPROV                PIC X(03).          
000149             15  WCOM-PAESMERC                PIC X(03).          
000150             15  WCOM-DTCARORD                PIC X(08).          
000151             15  WCOM-FLAGMANU                PIC X(01).          
000152             15  WCOM-FLAGGIVA                PIC X(01).          
000153             15  WCOM-TIPORECO                PIC X(04).          
000154             15  WCOM-AANUMFAT                PIC X(08).          
000155             15  WCOM-DTFATTUR                PIC X(08).          
000156             15  WCOM-NRPREATT                PIC X(18).          
000157             15  WCOM-DTPREATT                PIC X(08).          
000158             15  WCOM-STATUSXX                PIC X(01).          
000159             15  WCOM-AAMMCOMP                PIC X(06).          
000160             15  WCOM-CENCOSTD                PIC X(05).          
000161             15  WCOM-CENCOSTA                PIC X(05).          
000162             15  WCOM-ESENTIVA                PIC X(01).          
000163             15  FILLER                       PIC X(32).          
000164*--------------------------------------------------------------*  
000165     10  WCOM-DATIPROG.                                           
000166         15 WCOM-RCODSERV        PIC X(006).                      
000167         15 WCOM-RCENCOSD        PIC X(005).                      
000168         15 WCOM-RCENCOSA        PIC X(005).                      
000169         15 WCOM-INDESENZ        PIC S9(05) COMP-3.               
000170         15 WCOM-PAGESENZ        PIC S9(05) COMP-3.               
000171         15 WCOM-CONTPROV        PIC X(006).                      
000172         15 FILLER               PIC X(122).                      
000173 01  FILLER                      PIC X(8) VALUE 'DCWWORK1'.       
000174*    COPY  DCWWORK1.                                              
000175***************************************************************** 
000176******            DATI DI USO GENERALE      (DCWWORK1)     ****** 
000177***************************************************************** 
000178 01  DCW-WORK1.                                                   
000179*----------------- NOME MAPPA CON GESTIONE CODICE LINGUA          
000180     05 WNOMEMAP.                                                 
000181        10  FILLER                     PIC X(2).                  
000182        10  WCODLING                   PIC X.                     
000183        10  FILLER                     PIC X(4).                  
000184*----------------- COMODO LINEA CONTENENTE L'ULTIMO EXEC CICS     
000185     05 WLINEAXX.                                                 
000186        10  EL-LINE    OCCURS 5        PIC X.                     
000187*----------------- COMODO CONTENENTE DFHEIV0                      
000188     05 T-COMLINE.                                                
000189        10  EL-COMLINE OCCURS 29       PIC X.                     
000190*----------------- INDICE PER SCORRERE LA T-COMLINE.              
000191     05 INDERR                         PIC S9(5) COMP-3 VALUE +0. 
000192*----------------- TRANSAZIONE IMPOSTATA AL MOMENTO DEL PF5 / PF4 
000193     05 WTRANSID                       PIC X(4) VALUE SPACES.     
000194*----------------- INDICE DELLA RIGA DI MAPPA                     
000195     05 WINDRIGA                       PIC S9(3) COMP-3 VALUE +0. 
000196*----------------- NUMERO MASSIMO DI RIGHE IN UNA MAPPA           
000197     05 WNUMRIGA                       PIC 9(2)        VALUE 0.   
000198*----------------- FLAG PER GLI ERRORI A LIVELLO DI DATI-MAPPA    
000199     05 WSWERROR                       PIC X      VALUE SPACES.   
000200        88 ERRORE                                 VALUE '*'.      
000201*----------------- NUMERO PAGINA RICHIESTO                        
000202     05 WPAGRICH                       PIC S9(5) COMP-3 VALUE +0. 
000203*----------------- NUMERO RECORD CODA-TS                          
000204     05 WNUMITEM                       PIC S9(4) COMP VALUE +0.   
000205*----------------- INDICE DELLA CODA DI PAGINAZIONE TS            
000206     05 WPAGIPAG                       PIC S9(4) COMP VALUE +0.   
000207*----------------- CHIAVE DELLA CODA DI PAGINAZIONE TS            
000208     05 WPAGCTRL.                                                 
000209        10  WPAGNOME                   PIC X(4)    VALUE 'PAGI'.  
000210        10  WPAGVIDE                   PIC X(4).                  
000211*----------------- LUNGHEZZA  CODA DI PAGINAZIONE TS              
000212     05 WPAGLPAG                       PIC S9(4) COMP VALUE +0.   
000213*----------------- ABSOLUTE TIME                                  
000214     05 WABSTIME                       PIC S9(15) COMP-3 VALUE +0.
000215*----------------- ABSOLUTE YEAR                                  
000216     05 WABSYEAR                       PIC S9(8) COMP VALUE +0.   
000217*----------------- FOR RESP OPTION                                
000218     05 WEIBRESP                       PIC S9(8) COMP VALUE +0.   
000219*----------------- FOR CVDA  (CICS VALUE DATA AREA)               
000220     05 WNOLOG                         PIC S9(8) COMP VALUE +0.   
000221     05 WCVDA                          PIC S9(8) COMP VALUE +0.   
000222     05 WCVDA-OPEN                     PIC S9(8) COMP VALUE +18.  
000223     05 WCVDA-CLOSED                   PIC S9(8) COMP VALUE +19.  
000224*----------------- FOR BIF DEEDIT                                 
000225     05 WWTWSNU                        PIC X(8) VALUE 'WWTWSNU'.  
000226     05 WLENGTH                        PIC S9(4) COMP.            
000227*----------------- AREA DELLA CODA TS DI PAGINAZIONE              
000228 01  WPAGREFE.                                                    
000229     05  FILLER                        PIC X    VALUE SPACES.     
000230     05 WPAGREF1.                                                 
000231        10 WPAG-ELEMRIGA OCCURS 8.                                
000232           15 WPAG-OPERAZIO      PIC X(01).                       
000233           15 WPAG-CODSERVI      PIC X(06).                       
000234           15 WPAG-DESSERVI      PIC X(40).                       
000235           15 WPAG-UNMISURA      PIC X(02).                       
000236           15 WPAG-QTAORDIN      PIC S9(07)V9(02).                
000237           15 WPAG-QTAORDIN-O    PIC S9(07)V9(02).                
000238           15 WPAG-PREZZORD      PIC X(12).                       
000239           15 WPAG-PREZZORD-N    PIC S9(07)V9(04).                
000240           15 WPAG-PREZZORD-O    PIC S9(07)V9(04).                
000241           15 WPAG-IMPORDIN      PIC X(14).                       
000242           15 WPAG-IMPORDIN-N    PIC S9(11)V9(02).                
000243           15 WPAG-IMPORDIN-O    PIC S9(11)V9(02).                
000244           15 WPAG-CENCOSTD      PIC X(05).                       
000245           15 WPAG-CENCOSTA      PIC X(05).                       
000246           15 WPAG-ESENTIVR      PIC X(01).                       
000247           15 WPAG-NOTENOTE      PIC X(40).                       
000248           15 WPAG-NRRIGORD      PIC S9(5)  COMP-3.               
000249           15 WPAG-DTEVAORD      PIC X(08).                       
000250           15 WPAG-AANUMFAT      PIC X(08).                       
000251           15 WPAG-RIFECLIE      PIC X(15).                       
000252 01  WLO20-CODA.                                                  
000253     05 WLO20-CODCLIEN           PIC X(05).                       
000254     05 WLO20-NOMCLIEN           PIC X(24).                       
000255     05 WLO20-FLAGGIVA           PIC X(01).                       
000256     05 WLO20-ESENTIVA           PIC X(01).                       
000257     05 WLO20-AANUMORD           PIC X(08).                       
000258     05 WLO20-DTCARORD           PIC X(06).                       
000259     05 WLO20-AAMMCOMP           PIC X(06).                       
000260     05 WLO20-TIPSERVI           PIC X(01).                       
000261     05 WLO20-DESTIPSE           PIC X(09).                       
000262     05 WLO20-CONTODCE           PIC X(06).                       
000263     05 WLO20-DESCRDCE           PIC X(15).                       
000264     05 WLO20-CODDIVIS           PIC X(02).                       
000265     05 WLO20-SIGLADIV           PIC X(03).                       
000266     05 WLO20-AANUMFAT           PIC X(08).                       
000267     05 WLO20-DTFATTUR           PIC X(06).                       
000268     05 WLO20-NRPREATT           PIC X(10).                       
000269     05 WLO20-DTPREATT           PIC X(06).                       
000270     05 WLO20-FLAGAUTO           PIC X(01).                       
000271     05 WLO20-MESSWARN           PIC X(25).                       
000272     05 WLO20-CODSOCIE           PIC X(02).                       
000273     05 WLO20-WINDRIGA           PIC 9(02).                       
000274     05 WLO20-WNUMRIGA           PIC S9(5) COMP-3.                
000275     05 WLO20-CODCONSO           PIC X(02).                       
000276     05 WLO20-DTEVAORD           PIC X(06).                       
000277     05 WLO20-RIGA OCCURS 9.                                      
000278         10 WLO20-CODSERVI       PIC X(06).                       
000279         10 WLO20-DESSERVI       PIC X(40).                       
000280         10 WLO20-UNMISURA       PIC X(02).                       
000281 01  FILLER                      PIC X(08) VALUE 'AVMLO20*'.      
000282*    COPY AVMLO20.                                                
000283*   Micro Focus Enterprise Developer  2.2.01204                   
000284*   Micro Focus BMS Screen Painter (ver BMSIDE_2-2-20)            
000285*   MapSet Name   AVMLO20                                         
000286*   Date Created  01/23/2019                                      
000287*   Time Created  16:07:40                                        
000288*  Input Data For Map AVILO20                                     
000289   01 AVILO20I.                                                   
000290      03 FILLER                         PIC X(12).                
000291      03 LO20-TITOLOXXL                 PIC S9(4) COMP.           
000292      03 LO20-TITOLOXXF                 PIC X.                    
000293      03 FILLER REDEFINES LO20-TITOLOXXF.                         
000294         05 LO20-TITOLOXXA                 PIC X.                 
000295      03 FILLER                         PIC X(4).                 
000296      03 LO20-TITOLOXXI                 PIC X(27).                
000297      03 LO20-AANUMORDL                 PIC S9(4) COMP.           
000298      03 LO20-AANUMORDF                 PIC X.                    
000299      03 FILLER REDEFINES LO20-AANUMORDF.                         
000300         05 LO20-AANUMORDA                 PIC X.                 
000301      03 FILLER                         PIC X(4).                 
000302      03 LO20-AANUMORDI                 PIC X(8).                 
000303      03 LO20-DTCARORDL                 PIC S9(4) COMP.           
000304      03 LO20-DTCARORDF                 PIC X.                    
000305      03 FILLER REDEFINES LO20-DTCARORDF.                         
000306         05 LO20-DTCARORDA                 PIC X.                 
000307      03 FILLER                         PIC X(4).                 
000308      03 LO20-DTCARORDI                 PIC X(6).                 
000309      03 LO20-MAPDATAL                  PIC S9(4) COMP.           
000310      03 LO20-MAPDATAF                  PIC X.                    
000311      03 FILLER REDEFINES LO20-MAPDATAF.                          
000312         05 LO20-MAPDATAA                  PIC X.                 
000313      03 FILLER                         PIC X(4).                 
000314      03 LO20-MAPDATAI                  PIC X(8).                 
000315      03 LO20-MAPORAXL                  PIC S9(4) COMP.           
000316      03 LO20-MAPORAXF                  PIC X.                    
000317      03 FILLER REDEFINES LO20-MAPORAXF.                          
000318         05 LO20-MAPORAXA                  PIC X.                 
000319      03 FILLER                         PIC X(4).                 
000320      03 LO20-MAPORAXI                  PIC X(8).                 
000321      03 LO20-CODSOCIEL                 PIC S9(4) COMP.           
000322      03 LO20-CODSOCIEF                 PIC X.                    
000323      03 FILLER REDEFINES LO20-CODSOCIEF.                         
000324         05 LO20-CODSOCIEA                 PIC X.                 
000325      03 FILLER                         PIC X(4).                 
000326      03 LO20-CODSOCIEI                 PIC X(2).                 
000327      03 LO20-CDDIVISIL                 PIC S9(4) COMP.           
000328      03 LO20-CDDIVISIF                 PIC X.                    
000329      03 FILLER REDEFINES LO20-CDDIVISIF.                         
000330         05 LO20-CDDIVISIA                 PIC X.                 
000331      03 FILLER                         PIC X(4).                 
000332      03 LO20-CDDIVISII                 PIC X(1).                 
000333      03 LO20-NOMSOCIEL                 PIC S9(4) COMP.           
000334      03 LO20-NOMSOCIEF                 PIC X.                    
000335      03 FILLER REDEFINES LO20-NOMSOCIEF.                         
000336         05 LO20-NOMSOCIEA                 PIC X.                 
000337      03 FILLER                         PIC X(4).                 
000338      03 LO20-NOMSOCIEI                 PIC X(19).                
000339      03 LO20-MESSWARNL                 PIC S9(4) COMP.           
000340      03 LO20-MESSWARNF                 PIC X.                    
000341      03 FILLER REDEFINES LO20-MESSWARNF.                         
000342         05 LO20-MESSWARNA                 PIC X.                 
000343      03 FILLER                         PIC X(4).                 
000344      03 LO20-MESSWARNI                 PIC X(25).                
000345      03 LO20-CODUTEVBL                 PIC S9(4) COMP.           
000346      03 LO20-CODUTEVBF                 PIC X.                    
000347      03 FILLER REDEFINES LO20-CODUTEVBF.                         
000348         05 LO20-CODUTEVBA                 PIC X.                 
000349      03 FILLER                         PIC X(4).                 
000350      03 LO20-CODUTEVBI                 PIC X(6).                 
000351      03 LO20-CODCLIENL                 PIC S9(4) COMP.           
000352      03 LO20-CODCLIENF                 PIC X.                    
000353      03 FILLER REDEFINES LO20-CODCLIENF.                         
000354         05 LO20-CODCLIENA                 PIC X.                 
000355      03 FILLER                         PIC X(4).                 
000356      03 LO20-CODCLIENI                 PIC X(5).                 
000357      03 LO20-NOMCLIENL                 PIC S9(4) COMP.           
000358      03 LO20-NOMCLIENF                 PIC X.                    
000359      03 FILLER REDEFINES LO20-NOMCLIENF.                         
000360         05 LO20-NOMCLIENA                 PIC X.                 
000361      03 FILLER                         PIC X(4).                 
000362      03 LO20-NOMCLIENI                 PIC X(24).                
000363      03 LO20-CODCONSOL                 PIC S9(4) COMP.           
000364      03 LO20-CODCONSOF                 PIC X.                    
000365      03 FILLER REDEFINES LO20-CODCONSOF.                         
000366         05 LO20-CODCONSOA                 PIC X.                 
000367      03 FILLER                         PIC X(4).                 
000368      03 LO20-CODCONSOI                 PIC X(2).                 
000369      03 LO20-FLAGGIVAL                 PIC S9(4) COMP.           
000370      03 LO20-FLAGGIVAF                 PIC X.                    
000371      03 FILLER REDEFINES LO20-FLAGGIVAF.                         
000372         05 LO20-FLAGGIVAA                 PIC X.                 
000373      03 FILLER                         PIC X(4).                 
000374      03 LO20-FLAGGIVAI                 PIC X(1).                 
000375      03 LO20-ESENTIVAL                 PIC S9(4) COMP.           
000376      03 LO20-ESENTIVAF                 PIC X.                    
000377      03 FILLER REDEFINES LO20-ESENTIVAF.                         
000378         05 LO20-ESENTIVAA                 PIC X.                 
000379      03 FILLER                         PIC X(4).                 
000380      03 LO20-ESENTIVAI                 PIC X(1).                 
000381      03 LO20-CODDIVISL                 PIC S9(4) COMP.           
000382      03 LO20-CODDIVISF                 PIC X.                    
000383      03 FILLER REDEFINES LO20-CODDIVISF.                         
000384         05 LO20-CODDIVISA                 PIC X.                 
000385      03 FILLER                         PIC X(4).                 
000386      03 LO20-CODDIVISI                 PIC X(2).                 
000387      03 LO20-SIGLADIVL                 PIC S9(4) COMP.           
000388      03 LO20-SIGLADIVF                 PIC X.                    
000389      03 FILLER REDEFINES LO20-SIGLADIVF.                         
000390         05 LO20-SIGLADIVA                 PIC X.                 
000391      03 FILLER                         PIC X(4).                 
000392      03 LO20-SIGLADIVI                 PIC X(3).                 
000393      03 LO20-TIPSERVIL                 PIC S9(4) COMP.           
000394      03 LO20-TIPSERVIF                 PIC X.                    
000395      03 FILLER REDEFINES LO20-TIPSERVIF.                         
000396         05 LO20-TIPSERVIA                 PIC X.                 
000397      03 FILLER                         PIC X(4).                 
000398      03 LO20-TIPSERVII                 PIC X(1).                 
000399      03 LO20-DESTIPSEL                 PIC S9(4) COMP.           
000400      03 LO20-DESTIPSEF                 PIC X.                    
000401      03 FILLER REDEFINES LO20-DESTIPSEF.                         
000402         05 LO20-DESTIPSEA                 PIC X.                 
000403      03 FILLER                         PIC X(4).                 
000404      03 LO20-DESTIPSEI                 PIC X(9).                 
000405      03 LO20-CONTODCEL                 PIC S9(4) COMP.           
000406      03 LO20-CONTODCEF                 PIC X.                    
000407      03 FILLER REDEFINES LO20-CONTODCEF.                         
000408         05 LO20-CONTODCEA                 PIC X.                 
000409      03 FILLER                         PIC X(4).                 
000410      03 LO20-CONTODCEI                 PIC X(6).                 
000411      03 LO20-DESCRDCEL                 PIC S9(4) COMP.           
000412      03 LO20-DESCRDCEF                 PIC X.                    
000413      03 FILLER REDEFINES LO20-DESCRDCEF.                         
000414         05 LO20-DESCRDCEA                 PIC X.                 
000415      03 FILLER                         PIC X(4).                 
000416      03 LO20-DESCRDCEI                 PIC X(13).                
000417      03 LO20-AAMMCOMPL                 PIC S9(4) COMP.           
000418      03 LO20-AAMMCOMPF                 PIC X.                    
000419      03 FILLER REDEFINES LO20-AAMMCOMPF.                         
000420         05 LO20-AAMMCOMPA                 PIC X.                 
000421      03 FILLER                         PIC X(4).                 
000422      03 LO20-AAMMCOMPI                 PIC X(6).                 
000423      03 LO20-AANUMFATL                 PIC S9(4) COMP.           
000424      03 LO20-AANUMFATF                 PIC X.                    
000425      03 FILLER REDEFINES LO20-AANUMFATF.                         
000426         05 LO20-AANUMFATA                 PIC X.                 
000427      03 FILLER                         PIC X(4).                 
000428      03 LO20-AANUMFATI                 PIC X(8).                 
000429      03 LO20-DTFATTURL                 PIC S9(4) COMP.           
000430      03 LO20-DTFATTURF                 PIC X.                    
000431      03 FILLER REDEFINES LO20-DTFATTURF.                         
000432         05 LO20-DTFATTURA                 PIC X.                 
000433      03 FILLER                         PIC X(4).                 
000434      03 LO20-DTFATTURI                 PIC X(6).                 
000435      03 LO20-NRPREATTL                 PIC S9(4) COMP.           
000436      03 LO20-NRPREATTF                 PIC X.                    
000437      03 FILLER REDEFINES LO20-NRPREATTF.                         
000438         05 LO20-NRPREATTA                 PIC X.                 
000439      03 FILLER                         PIC X(4).                 
000440      03 LO20-NRPREATTI                 PIC X(10).                
000441      03 LO20-DTPREATTL                 PIC S9(4) COMP.           
000442      03 LO20-DTPREATTF                 PIC X.                    
000443      03 FILLER REDEFINES LO20-DTPREATTF.                         
000444         05 LO20-DTPREATTA                 PIC X.                 
000445      03 FILLER                         PIC X(4).                 
000446      03 LO20-DTPREATTI                 PIC X(6).                 
000447      03 LO20-FLAGAUTOL                 PIC S9(4) COMP.           
000448      03 LO20-FLAGAUTOF                 PIC X.                    
000449      03 FILLER REDEFINES LO20-FLAGAUTOF.                         
000450         05 LO20-FLAGAUTOA                 PIC X.                 
000451      03 FILLER                         PIC X(4).                 
000452      03 LO20-FLAGAUTOI                 PIC X(1).                 
000453      03 LO20-DTEVAORDL                 PIC S9(4) COMP.           
000454      03 LO20-DTEVAORDF                 PIC X.                    
000455      03 FILLER REDEFINES LO20-DTEVAORDF.                         
000456         05 LO20-DTEVAORDA                 PIC X.                 
000457      03 FILLER                         PIC X(4).                 
000458      03 LO20-DTEVAORDI                 PIC X(6).                 
000459      03 LO20-RCODSERVL                 PIC S9(4) COMP.           
000460      03 LO20-RCODSERVF                 PIC X.                    
000461      03 FILLER REDEFINES LO20-RCODSERVF.                         
000462         05 LO20-RCODSERVA                 PIC X.                 
000463      03 FILLER                         PIC X(4).                 
000464      03 LO20-RCODSERVI                 PIC X(6).                 
000465      03 LO20-RCENCOSDL                 PIC S9(4) COMP.           
000466      03 LO20-RCENCOSDF                 PIC X.                    
000467      03 FILLER REDEFINES LO20-RCENCOSDF.                         
000468         05 LO20-RCENCOSDA                 PIC X.                 
000469      03 FILLER                         PIC X(4).                 
000470      03 LO20-RCENCOSDI                 PIC X(5).                 
000471      03 LO20-RCENCOSAL                 PIC S9(4) COMP.           
000472      03 LO20-RCENCOSAF                 PIC X.                    
000473      03 FILLER REDEFINES LO20-RCENCOSAF.                         
000474         05 LO20-RCENCOSAA                 PIC X.                 
000475      03 FILLER                         PIC X(4).                 
000476      03 LO20-RCENCOSAI                 PIC X(5).                 
000477      03 LO20-SOSPESOXL                 PIC S9(4) COMP.           
000478      03 LO20-SOSPESOXF                 PIC X.                    
000479      03 FILLER REDEFINES LO20-SOSPESOXF.                         
000480         05 LO20-SOSPESOXA                 PIC X.                 
000481      03 FILLER                         PIC X(4).                 
000482      03 LO20-SOSPESOXI                 PIC X(13).                
000483      03 LO20-RIGAI                     OCCURS 8 TIMES.           
000484         05 LO20-OPERAZIOL                 PIC S9(4) COMP.        
000485         05 LO20-OPERAZIOF                 PIC X.                 
000486         05 FILLER REDEFINES LO20-OPERAZIOF.                      
000487            07 LO20-OPERAZIOA                 PIC X.              
000488         05 FILLER                         PIC X(4).              
000489         05 LO20-OPERAZIOI                 PIC X(1).              
000490         05 LO20-CODSERVIL                 PIC S9(4) COMP.        
000491         05 LO20-CODSERVIF                 PIC X.                 
000492         05 FILLER REDEFINES LO20-CODSERVIF.                      
000493            07 LO20-CODSERVIA                 PIC X.              
000494         05 FILLER                         PIC X(4).              
000495         05 LO20-CODSERVII                 PIC X(6).              
000496         05 LO20-UNMISURAL                 PIC S9(4) COMP.        
000497         05 LO20-UNMISURAF                 PIC X.                 
000498         05 FILLER REDEFINES LO20-UNMISURAF.                      
000499            07 LO20-UNMISURAA                 PIC X.              
000500         05 FILLER                         PIC X(4).              
000501         05 LO20-UNMISURAI                 PIC X(2).              
000502         05 LO20-QTAORDINL                 PIC S9(4) COMP.        
000503         05 LO20-QTAORDINF                 PIC X.                 
000504         05 FILLER REDEFINES LO20-QTAORDINF.                      
000505            07 LO20-QTAORDINA                 PIC X.              
000506         05 FILLER                         PIC X(4).              
000507         05 LO20-QTAORDINI                 PIC X(10).             
000508         05 LO20-PREZZORDL                 PIC S9(4) COMP.        
000509         05 LO20-PREZZORDF                 PIC X.                 
000510         05 FILLER REDEFINES LO20-PREZZORDF.                      
000511            07 LO20-PREZZORDA                 PIC X.              
000512         05 FILLER                         PIC X(4).              
000513         05 LO20-PREZZORDI                 PIC X(12).             
000514         05 LO20-IMPORDINL                 PIC S9(4) COMP.        
000515         05 LO20-IMPORDINF                 PIC X.                 
000516         05 FILLER REDEFINES LO20-IMPORDINF.                      
000517            07 LO20-IMPORDINA                 PIC X.              
000518         05 FILLER                         PIC X(4).              
000519         05 LO20-IMPORDINI                 PIC X(14).             
000520         05 LO20-CENCOSTDL                 PIC S9(4) COMP.        
000521         05 LO20-CENCOSTDF                 PIC X.                 
000522         05 FILLER REDEFINES LO20-CENCOSTDF.                      
000523            07 LO20-CENCOSTDA                 PIC X.              
000524         05 FILLER                         PIC X(4).              
000525         05 LO20-CENCOSTDI                 PIC X(5).              
000526         05 LO20-CENCOSTAL                 PIC S9(4) COMP.        
000527         05 LO20-CENCOSTAF                 PIC X.                 
000528         05 FILLER REDEFINES LO20-CENCOSTAF.                      
000529            07 LO20-CENCOSTAA                 PIC X.              
000530         05 FILLER                         PIC X(4).              
000531         05 LO20-CENCOSTAI                 PIC X(5).              
000532         05 LO20-ESENTIVRL                 PIC S9(4) COMP.        
000533         05 LO20-ESENTIVRF                 PIC X.                 
000534         05 FILLER REDEFINES LO20-ESENTIVRF.                      
000535            07 LO20-ESENTIVRA                 PIC X.              
000536         05 FILLER                         PIC X(4).              
000537         05 LO20-ESENTIVRI                 PIC X(1).              
000538         05 LO20-RIFECLIEL                 PIC S9(4) COMP.        
000539         05 LO20-RIFECLIEF                 PIC X.                 
000540         05 FILLER REDEFINES LO20-RIFECLIEF.                      
000541            07 LO20-RIFECLIEA                 PIC X.              
000542         05 FILLER                         PIC X(4).              
000543         05 LO20-RIFECLIEI                 PIC X(14).             
000544         05 LO20-DESSERVIL                 PIC S9(4) COMP.        
000545         05 LO20-DESSERVIF                 PIC X.                 
000546         05 FILLER REDEFINES LO20-DESSERVIF.                      
000547            07 LO20-DESSERVIA                 PIC X.              
000548         05 FILLER                         PIC X(4).              
000549         05 LO20-DESSERVII                 PIC X(35).             
000550         05 LO20-NOTENOTEL                 PIC S9(4) COMP.        
000551         05 LO20-NOTENOTEF                 PIC X.                 
000552         05 FILLER REDEFINES LO20-NOTENOTEF.                      
000553            07 LO20-NOTENOTEA                 PIC X.              
000554         05 FILLER                         PIC X(4).              
000555         05 LO20-NOTENOTEI                 PIC X(40).             
000556      03 LO20-MAPRPAGL                  PIC S9(4) COMP.           
000557      03 LO20-MAPRPAGF                  PIC X.                    
000558      03 FILLER REDEFINES LO20-MAPRPAGF.                          
000559         05 LO20-MAPRPAGA                  PIC X.                 
000560      03 FILLER                         PIC X(4).                 
000561      03 LO20-MAPRPAGI                  PIC X(3).                 
000562      03 LO20-MAPPPAGL                  PIC S9(4) COMP.           
000563      03 LO20-MAPPPAGF                  PIC X.                    
000564      03 FILLER REDEFINES LO20-MAPPPAGF.                          
000565         05 LO20-MAPPPAGA                  PIC X.                 
000566      03 FILLER                         PIC X(4).                 
000567      03 LO20-MAPPPAGI                  PIC X(3).                 
000568      03 LO20-MESSAGGL                  PIC S9(4) COMP.           
000569      03 LO20-MESSAGGF                  PIC X.                    
000570      03 FILLER REDEFINES LO20-MESSAGGF.                          
000571         05 LO20-MESSAGGA                  PIC X.                 
000572      03 FILLER                         PIC X(4).                 
000573      03 LO20-MESSAGGI                  PIC X(58).                
000574*  Output Data For Map AVILO20                                    
000575   01 AVILO20O REDEFINES AVILO20I.                                
000576      03 FILLER                         PIC X(12).                
000577      03 FILLER                         PIC X(3).                 
000578      03 LO20-TITOLOXXC                 PIC X.                    
000579      03 LO20-TITOLOXXP                 PIC X.                    
000580      03 LO20-TITOLOXXH                 PIC X.                    
000581      03 LO20-TITOLOXXV                 PIC X.                    
000582      03 LO20-TITOLOXXO                 PIC X(27).                
000583      03 FILLER                         PIC X(3).                 
000584      03 LO20-AANUMORDC                 PIC X.                    
000585      03 LO20-AANUMORDP                 PIC X.                    
000586      03 LO20-AANUMORDH                 PIC X.                    
000587      03 LO20-AANUMORDV                 PIC X.                    
000588      03 LO20-AANUMORDO                 PIC X(8).                 
000589      03 FILLER                         PIC X(3).                 
000590      03 LO20-DTCARORDC                 PIC X.                    
000591      03 LO20-DTCARORDP                 PIC X.                    
000592      03 LO20-DTCARORDH                 PIC X.                    
000593      03 LO20-DTCARORDV                 PIC X.                    
000594      03 LO20-DTCARORDO                 PIC X(6).                 
000595      03 FILLER                         PIC X(3).                 
000596      03 LO20-MAPDATAC                  PIC X.                    
000597      03 LO20-MAPDATAP                  PIC X.                    
000598      03 LO20-MAPDATAH                  PIC X.                    
000599      03 LO20-MAPDATAV                  PIC X.                    
000600      03 LO20-MAPDATAO                  PIC X(8).                 
000601      03 FILLER                         PIC X(3).                 
000602      03 LO20-MAPORAXC                  PIC X.                    
000603      03 LO20-MAPORAXP                  PIC X.                    
000604      03 LO20-MAPORAXH                  PIC X.                    
000605      03 LO20-MAPORAXV                  PIC X.                    
000606      03 LO20-MAPORAXO                  PIC 99.99.99.             
000607      03 FILLER                         PIC X(3).                 
000608      03 LO20-CODSOCIEC                 PIC X.                    
000609      03 LO20-CODSOCIEP                 PIC X.                    
000610      03 LO20-CODSOCIEH                 PIC X.                    
000611      03 LO20-CODSOCIEV                 PIC X.                    
000612      03 LO20-CODSOCIEO                 PIC X(2).                 
000613      03 FILLER                         PIC X(3).                 
000614      03 LO20-CDDIVISIC                 PIC X.                    
000615      03 LO20-CDDIVISIP                 PIC X.                    
000616      03 LO20-CDDIVISIH                 PIC X.                    
000617      03 LO20-CDDIVISIV                 PIC X.                    
000618      03 LO20-CDDIVISIO                 PIC X(1).                 
000619      03 FILLER                         PIC X(3).                 
000620      03 LO20-NOMSOCIEC                 PIC X.                    
000621      03 LO20-NOMSOCIEP                 PIC X.                    
000622      03 LO20-NOMSOCIEH                 PIC X.                    
000623      03 LO20-NOMSOCIEV                 PIC X.                    
000624      03 LO20-NOMSOCIEO                 PIC X(19).                
000625      03 FILLER                         PIC X(3).                 
000626      03 LO20-MESSWARNC                 PIC X.                    
000627      03 LO20-MESSWARNP                 PIC X.                    
000628      03 LO20-MESSWARNH                 PIC X.                    
000629      03 LO20-MESSWARNV                 PIC X.                    
000630      03 LO20-MESSWARNO                 PIC X(25).                
000631      03 FILLER                         PIC X(3).                 
000632      03 LO20-CODUTEVBC                 PIC X.                    
000633      03 LO20-CODUTEVBP                 PIC X.                    
000634      03 LO20-CODUTEVBH                 PIC X.                    
000635      03 LO20-CODUTEVBV                 PIC X.                    
000636      03 LO20-CODUTEVBO                 PIC X(6).                 
000637      03 FILLER                         PIC X(3).                 
000638      03 LO20-CODCLIENC                 PIC X.                    
000639      03 LO20-CODCLIENP                 PIC X.                    
000640      03 LO20-CODCLIENH                 PIC X.                    
000641      03 LO20-CODCLIENV                 PIC X.                    
000642      03 LO20-CODCLIENO                 PIC X(5).                 
000643      03 FILLER                         PIC X(3).                 
000644      03 LO20-NOMCLIENC                 PIC X.                    
000645      03 LO20-NOMCLIENP                 PIC X.                    
000646      03 LO20-NOMCLIENH                 PIC X.                    
000647      03 LO20-NOMCLIENV                 PIC X.                    
000648      03 LO20-NOMCLIENO                 PIC X(24).                
000649      03 FILLER                         PIC X(3).                 
000650      03 LO20-CODCONSOC                 PIC X.                    
000651      03 LO20-CODCONSOP                 PIC X.                    
000652      03 LO20-CODCONSOH                 PIC X.                    
000653      03 LO20-CODCONSOV                 PIC X.                    
000654      03 LO20-CODCONSOO                 PIC X(2).                 
000655      03 FILLER                         PIC X(3).                 
000656      03 LO20-FLAGGIVAC                 PIC X.                    
000657      03 LO20-FLAGGIVAP                 PIC X.                    
000658      03 LO20-FLAGGIVAH                 PIC X.                    
000659      03 LO20-FLAGGIVAV                 PIC X.                    
000660      03 LO20-FLAGGIVAO                 PIC X(1).                 
000661      03 FILLER                         PIC X(3).                 
000662      03 LO20-ESENTIVAC                 PIC X.                    
000663      03 LO20-ESENTIVAP                 PIC X.                    
000664      03 LO20-ESENTIVAH                 PIC X.                    
000665      03 LO20-ESENTIVAV                 PIC X.                    
000666      03 LO20-ESENTIVAO                 PIC X(1).                 
000667      03 FILLER                         PIC X(3).                 
000668      03 LO20-CODDIVISC                 PIC X.                    
000669      03 LO20-CODDIVISP                 PIC X.                    
000670      03 LO20-CODDIVISH                 PIC X.                    
000671      03 LO20-CODDIVISV                 PIC X.                    
000672      03 LO20-CODDIVISO                 PIC X(2).                 
000673      03 FILLER                         PIC X(3).                 
000674      03 LO20-SIGLADIVC                 PIC X.                    
000675      03 LO20-SIGLADIVP                 PIC X.                    
000676      03 LO20-SIGLADIVH                 PIC X.                    
000677      03 LO20-SIGLADIVV                 PIC X.                    
000678      03 LO20-SIGLADIVO                 PIC X(3).                 
000679      03 FILLER                         PIC X(3).                 
000680      03 LO20-TIPSERVIC                 PIC X.                    
000681      03 LO20-TIPSERVIP                 PIC X.                    
000682      03 LO20-TIPSERVIH                 PIC X.                    
000683      03 LO20-TIPSERVIV                 PIC X.                    
000684      03 LO20-TIPSERVIO                 PIC X(1).                 
000685      03 FILLER                         PIC X(3).                 
000686      03 LO20-DESTIPSEC                 PIC X.                    
000687      03 LO20-DESTIPSEP                 PIC X.                    
000688      03 LO20-DESTIPSEH                 PIC X.                    
000689      03 LO20-DESTIPSEV                 PIC X.                    
000690      03 LO20-DESTIPSEO                 PIC X(9).                 
000691      03 FILLER                         PIC X(3).                 
000692      03 LO20-CONTODCEC                 PIC X.                    
000693      03 LO20-CONTODCEP                 PIC X.                    
000694      03 LO20-CONTODCEH                 PIC X.                    
000695      03 LO20-CONTODCEV                 PIC X.                    
000696      03 LO20-CONTODCEO                 PIC X(6).                 
000697      03 FILLER                         PIC X(3).                 
000698      03 LO20-DESCRDCEC                 PIC X.                    
000699      03 LO20-DESCRDCEP                 PIC X.                    
000700      03 LO20-DESCRDCEH                 PIC X.                    
000701      03 LO20-DESCRDCEV                 PIC X.                    
000702      03 LO20-DESCRDCEO                 PIC X(13).                
000703      03 FILLER                         PIC X(3).                 
000704      03 LO20-AAMMCOMPC                 PIC X.                    
000705      03 LO20-AAMMCOMPP                 PIC X.                    
000706      03 LO20-AAMMCOMPH                 PIC X.                    
000707      03 LO20-AAMMCOMPV                 PIC X.                    
000708      03 LO20-AAMMCOMPO                 PIC X(6).                 
000709      03 FILLER                         PIC X(3).                 
000710      03 LO20-AANUMFATC                 PIC X.                    
000711      03 LO20-AANUMFATP                 PIC X.                    
000712      03 LO20-AANUMFATH                 PIC X.                    
000713      03 LO20-AANUMFATV                 PIC X.                    
000714      03 LO20-AANUMFATO                 PIC X(8).                 
000715      03 FILLER                         PIC X(3).                 
000716      03 LO20-DTFATTURC                 PIC X.                    
000717      03 LO20-DTFATTURP                 PIC X.                    
000718      03 LO20-DTFATTURH                 PIC X.                    
000719      03 LO20-DTFATTURV                 PIC X.                    
000720      03 LO20-DTFATTURO                 PIC X(6).                 
000721      03 FILLER                         PIC X(3).                 
000722      03 LO20-NRPREATTC                 PIC X.                    
000723      03 LO20-NRPREATTP                 PIC X.                    
000724      03 LO20-NRPREATTH                 PIC X.                    
000725      03 LO20-NRPREATTV                 PIC X.                    
000726      03 LO20-NRPREATTO                 PIC X(10).                
000727      03 FILLER                         PIC X(3).                 
000728      03 LO20-DTPREATTC                 PIC X.                    
000729      03 LO20-DTPREATTP                 PIC X.                    
000730      03 LO20-DTPREATTH                 PIC X.                    
000731      03 LO20-DTPREATTV                 PIC X.                    
000732      03 LO20-DTPREATTO                 PIC X(6).                 
000733      03 FILLER                         PIC X(3).                 
000734      03 LO20-FLAGAUTOC                 PIC X.                    
000735      03 LO20-FLAGAUTOP                 PIC X.                    
000736      03 LO20-FLAGAUTOH                 PIC X.                    
000737      03 LO20-FLAGAUTOV                 PIC X.                    
000738      03 LO20-FLAGAUTOO                 PIC X(1).                 
000739      03 FILLER                         PIC X(3).                 
000740      03 LO20-DTEVAORDC                 PIC X.                    
000741      03 LO20-DTEVAORDP                 PIC X.                    
000742      03 LO20-DTEVAORDH                 PIC X.                    
000743      03 LO20-DTEVAORDV                 PIC X.                    
000744      03 LO20-DTEVAORDO                 PIC X(6).                 
000745      03 FILLER                         PIC X(3).                 
000746      03 LO20-RCODSERVC                 PIC X.                    
000747      03 LO20-RCODSERVP                 PIC X.                    
000748      03 LO20-RCODSERVH                 PIC X.                    
000749      03 LO20-RCODSERVV                 PIC X.                    
000750      03 LO20-RCODSERVO                 PIC X(6).                 
000751      03 FILLER                         PIC X(3).                 
000752      03 LO20-RCENCOSDC                 PIC X.                    
000753      03 LO20-RCENCOSDP                 PIC X.                    
000754      03 LO20-RCENCOSDH                 PIC X.                    
000755      03 LO20-RCENCOSDV                 PIC X.                    
000756      03 LO20-RCENCOSDO                 PIC X(5).                 
000757      03 FILLER                         PIC X(3).                 
000758      03 LO20-RCENCOSAC                 PIC X.                    
000759      03 LO20-RCENCOSAP                 PIC X.                    
000760      03 LO20-RCENCOSAH                 PIC X.                    
000761      03 LO20-RCENCOSAV                 PIC X.                    
000762      03 LO20-RCENCOSAO                 PIC X(5).                 
000763      03 FILLER                         PIC X(3).                 
000764      03 LO20-SOSPESOXC                 PIC X.                    
000765      03 LO20-SOSPESOXP                 PIC X.                    
000766      03 LO20-SOSPESOXH                 PIC X.                    
000767      03 LO20-SOSPESOXV                 PIC X.                    
000768      03 LO20-SOSPESOXO                 PIC X(13).                
000769      03 LO20-RIGAO OCCURS 8.                                     
000770         05 FILLER                         PIC X(3).              
000771         05 LO20-OPERAZIOC                 PIC X.                 
000772         05 LO20-OPERAZIOP                 PIC X.                 
000773         05 LO20-OPERAZIOH                 PIC X.                 
000774         05 LO20-OPERAZIOV                 PIC X.                 
000775         05 LO20-OPERAZIOO                 PIC X(1).              
000776         05 FILLER                         PIC X(3).              
000777         05 LO20-CODSERVIC                 PIC X.                 
000778         05 LO20-CODSERVIP                 PIC X.                 
000779         05 LO20-CODSERVIH                 PIC X.                 
000780         05 LO20-CODSERVIV                 PIC X.                 
000781         05 LO20-CODSERVIO                 PIC X(6).              
000782         05 FILLER                         PIC X(3).              
000783         05 LO20-UNMISURAC                 PIC X.                 
000784         05 LO20-UNMISURAP                 PIC X.                 
000785         05 LO20-UNMISURAH                 PIC X.                 
000786         05 LO20-UNMISURAV                 PIC X.                 
000787         05 LO20-UNMISURAO                 PIC X(2).              
000788         05 FILLER                         PIC X(3).              
000789         05 LO20-QTAORDINC                 PIC X.                 
000790         05 LO20-QTAORDINP                 PIC X.                 
000791         05 LO20-QTAORDINH                 PIC X.                 
000792         05 LO20-QTAORDINV                 PIC X.                 
000793         05 LO20-QTAORDINO                 PIC Z(6)9,99.          
000794         05 FILLER                         PIC X(3).              
000795         05 LO20-PREZZORDC                 PIC X.                 
000796         05 LO20-PREZZORDP                 PIC X.                 
000797         05 LO20-PREZZORDH                 PIC X.                 
000798         05 LO20-PREZZORDV                 PIC X.                 
000799         05 LO20-PREZZORDO                 PIC X(12).             
000800         05 FILLER                         PIC X(3).              
000801         05 LO20-IMPORDINC                 PIC X.                 
000802         05 LO20-IMPORDINP                 PIC X.                 
000803         05 LO20-IMPORDINH                 PIC X.                 
000804         05 LO20-IMPORDINV                 PIC X.                 
000805         05 LO20-IMPORDINO                 PIC X(14).             
000806         05 FILLER                         PIC X(3).              
000807         05 LO20-CENCOSTDC                 PIC X.                 
000808         05 LO20-CENCOSTDP                 PIC X.                 
000809         05 LO20-CENCOSTDH                 PIC X.                 
000810         05 LO20-CENCOSTDV                 PIC X.                 
000811         05 LO20-CENCOSTDO                 PIC X(5).              
000812         05 FILLER                         PIC X(3).              
000813         05 LO20-CENCOSTAC                 PIC X.                 
000814         05 LO20-CENCOSTAP                 PIC X.                 
000815         05 LO20-CENCOSTAH                 PIC X.                 
000816         05 LO20-CENCOSTAV                 PIC X.                 
000817         05 LO20-CENCOSTAO                 PIC X(5).              
000818         05 FILLER                         PIC X(3).              
000819         05 LO20-ESENTIVRC                 PIC X.                 
000820         05 LO20-ESENTIVRP                 PIC X.                 
000821         05 LO20-ESENTIVRH                 PIC X.                 
000822         05 LO20-ESENTIVRV                 PIC X.                 
000823         05 LO20-ESENTIVRO                 PIC X(1).              
000824         05 FILLER                         PIC X(3).              
000825         05 LO20-RIFECLIEC                 PIC X.                 
000826         05 LO20-RIFECLIEP                 PIC X.                 
000827         05 LO20-RIFECLIEH                 PIC X.                 
000828         05 LO20-RIFECLIEV                 PIC X.                 
000829         05 LO20-RIFECLIEO                 PIC X(14).             
000830         05 FILLER                         PIC X(3).              
000831         05 LO20-DESSERVIC                 PIC X.                 
000832         05 LO20-DESSERVIP                 PIC X.                 
000833         05 LO20-DESSERVIH                 PIC X.                 
000834         05 LO20-DESSERVIV                 PIC X.                 
000835         05 LO20-DESSERVIO                 PIC X(35).             
000836         05 FILLER                         PIC X(3).              
000837         05 LO20-NOTENOTEC                 PIC X.                 
000838         05 LO20-NOTENOTEP                 PIC X.                 
000839         05 LO20-NOTENOTEH                 PIC X.                 
000840         05 LO20-NOTENOTEV                 PIC X.                 
000841         05 LO20-NOTENOTEO                 PIC X(40).             
000842      03 FILLER                         PIC X(3).                 
000843      03 LO20-MAPRPAGC                  PIC X.                    
000844      03 LO20-MAPRPAGP                  PIC X.                    
000845      03 LO20-MAPRPAGH                  PIC X.                    
000846      03 LO20-MAPRPAGV                  PIC X.                    
000847      03 LO20-MAPRPAGO                  PIC 999.                  
000848      03 FILLER                         PIC X(3).                 
000849      03 LO20-MAPPPAGC                  PIC X.                    
000850      03 LO20-MAPPPAGP                  PIC X.                    
000851      03 LO20-MAPPPAGH                  PIC X.                    
000852      03 LO20-MAPPPAGV                  PIC X.                    
000853      03 LO20-MAPPPAGO                  PIC 999.                  
000854      03 FILLER                         PIC X(3).                 
000855      03 LO20-MESSAGGC                  PIC X.                    
000856      03 LO20-MESSAGGP                  PIC X.                    
000857      03 LO20-MESSAGGH                  PIC X.                    
000858      03 LO20-MESSAGGV                  PIC X.                    
000859      03 LO20-MESSAGGO                  PIC X(58).                
000860 01  FILLER                      PIC X(08) VALUE 'DCMESS**'.      
000861*    COPY DCMESS.                                                 
000862********************     DCMESS           ************************
000863*********  COPY PER ESECUZIONE DELLA SUBROUTINE SRMESS     *******
000864*********  GESTIONE MESSAGGI DI ERRORE TP/BATCH            *******
000865******************************************************************
000866 01  DCMESS.                                                      
000867     05  MESS-CAMPI-INPUT.                                        
000868         10  MESS-CODERROR      PIC X(5)       VALUE SPACES.      
000869         10  MESS-CODILING      PIC X(1)       VALUE SPACES.      
000870     05  MESS-CAMPI-OUTPUT.                                       
000871         10  MESS-MSGERROR.                                       
000872             15  MESS-COMCODER  PIC X(5)       VALUE SPACES.      
000873             15  FILLER         PIC X          VALUE SPACES.      
000874             15  MESS-MESSAGGI  PIC X(66)      VALUE SPACES.      
000875 01  FILLER                      PIC X(08) VALUE 'DCNUME**'.      
000876*    COPY DCNUME.                                                 
000877******************************************************************
000878*                       ***  DCNUME  ***                         *
000879*   PARAMETRI PER LA LETTURA E L'AGGIORNAMENTO DELLA TABELLA     *
000880*   DB2   'TNUMEAUTO'.                                           *
000881*   LUNGHEZZA = 100                                              *
000882******************************************************************
000883*                                                                *
000884 01  DCNUME.                                                      
000885     05  DCNU-RISPOSTA                    PIC X(04).              
000886     05  DCNU-FLAGOPER                    PIC X(01).              
000887*                                                                *
000888     05  DCNU-SIGLNUME                    PIC X(08).              
000889     05  DCNU-NUMEAUTO                    PIC X(09).              
000890     05  DCNU-NUMERIPR                    PIC X(09).              
000891     05  DCNU-DESCNUME                    PIC X(21).              
000892     05  DCNU-NUMERIP1                    PIC X(09).              
000893     05  DCNU-FILLER39                    PIC X(39).              
000894******************************************************************
000895 01  FILLER                      PIC X(08) VALUE 'DCWTESTN'.      
000896*    COPY DCWTESTN.                                               
000897 01  DCWTESTN.                                                    
000898     05 WSNU-INTEGERS       PIC 9(2).                             
000899     05 WSNU-DECIMALS       PIC 9(2).                             
000900     05 WSNU-SPACE1         PIC X(20).                            
000901     05 WSNU-NUMBER         PIC X(20).                            
000902     05 WSNU-FILLER1 REDEFINES WSNU-NUMBER.                       
000903        10 WSNU-BYTE OCCURS 20 TIMES PIC X.                       
000904     05 WSNU-SPACE2         PIC X(20).                            
000905     05 WSNU-FILLER0.                                             
000906       10 WSNU-MAXINTE        PIC 9(14).                          
000907       10 WSNU-MAXDECI        PIC S9(4).                          
000908     05 WSNU-MAXVALUE REDEFINES WSNU-FILLER0  PIC S9(14)V9(4).    
000909     05 WSNU-COMAXDECI      PIC S9(5)V9(5).                       
000910     05 WSNU-FILLER01 REDEFINES WSNU-COMAXDECI.                   
000911        10 WSNU-COMAXDEC15     PIC 9(5).                          
000912        10 WSNU-COMAXDEC25     PIC S9(5).                         
000913     05 WSNU-PLUSMINU       PIC X.                                
000914     05 WSNU-MAX            PIC S9(2).                            
000915     05 WSNU-IND            PIC S9(2).                            
000916     05 WSNU-INDN           PIC S9(2).                            
000917     05 WSNU-INDX           PIC S9(2).                            
000918     05 WSNU-NUMEOUTX       PIC X(20).                            
000919     05 WSNU-FILLER2 REDEFINES WSNU-NUMEOUTX.                     
000920        10 WSNU-PICX OCCURS 20 TIMES PIC X.                       
000921     05 WSNU-NUMEOUTN       PIC S9(14)V9(4).                      
000922     05 WSNU-FILLER3 REDEFINES WSNU-NUMEOUTN.                     
000923        10 WSNU-INT OCCURS 14 TIMES PIC 9.                        
000924        10 WSNU-DEC0.                                             
000925           15 WSNU-DEC OCCURS 4 TIMES PIC 9.                      
000926     05 WSNU-FORMAT.                                              
000927        10 WSNU-FORMATX OCCURS 20 TIMES PIC X.                    
000928     05 WSNU-WSWERROR          PIC X.                             
000929 01  FILLER                      PIC X(8) VALUE 'DCARR0*'.        
000930*    COPY DCARR0.                                                 
000931******************************************************************
000932******              AREA PER SUBROUTINE SRARR0              ******
000933******************************************************************
000934 01  DCARR0.                                                      
000935     05  ARR0-INPUT.                                              
000936         10  ARR0-DECIDIVI            PIC X.                      
000937     05  ARR0-INPUT-OUTPUT.                                       
000938         10  ARR0-IMPORTOX            PIC S9(11)V9(4) COMP-3.     
000939     05  ARR0-COMODI.                                             
000940         10  ARR0-INTEROXX            PIC S9(11)    COMP-3.       
000941         10  ARR0-DECIMA1X            PIC S9(11)V9  COMP-3.       
000942         10  ARR0-DECIMA2X            PIC S9(11)V99 COMP-3.       
000943 01  FILLER                      PIC X(8) VALUE 'DCNMFA*'.        
000944*    COPY DCNMFA.                                                 
000945*===============================================================* 
000946*  COPY PER CHIAMATE AI MODULI SCBNMFA / SCTNMFA                * 
000947*===============================================================* 
000948******************************************************************
000949*                                                                *
000950*                    ***   DCNMFA   ***                          *
000951*                                                                *
000952*         STATUS RISPOSTA :  '****' SE TUTTO OK.                 *
000953*                            'NTRO' SE COMBINAZIONE NON TROVATA  *
000954*                                   SU MULTITABLE 'NORMEFAT'.    *
000955*                            'DATI' SE MANCANO DATI IN INPUT     *
000956*                                                                *
000957*         DATI IN  INPUT  :  CODICE PAESE SOCIETA'               *
000958*                            CODICE PAESE FATTURA                *
000959*                            CODICE PAESE MERCE                  *
000960*                            CODICE SOCIETA'                     *
000961*                            NUMERO FATTURA PROFORMA             *
000962*                                                                *
000963*         DATI IN OUTPUT  :  INDICATORE SI/NO I.V.A.             *
000964*                            CODICE ESENZIONE I.V.A.             *
000965*                            TIPO PART.IVA DA USARE              *
000966*                            INDICATORE SI/NO INTRASTAT          *
000967*                            INDICATORE SI/NO TRANSAZIONE        *
000968*                                       TRIANGOLARE              *
000969*   LUNGHEZZA = 100                                              *
000970******************************************************************
000971 01  DCNMFA.                                                      
000972     05  NMFA-RISPOSTA           PIC X(4)   VALUE SPACES.         
000973     05  NMFA-PAESOCIE           PIC X(3)   VALUE SPACES.         
000974     05  NMFA-PAEFATTU           PIC X(3)   VALUE SPACES.         
000975     05  NMFA-PAEMERCE           PIC X(3)   VALUE SPACES.         
000976     05  NMFA-CODSOCIE           PIC XX     VALUE SPACES.         
000977     05  NMFA-FLAGGIVA           PIC X      VALUE SPACES.         
000978     05  NMFA-ESENTIVA           PIC X      VALUE SPACES.         
000979     05  NMFA-FLPARIVA           PIC X      VALUE SPACES.         
000980     05  NMFA-FLAGINTR           PIC X      VALUE SPACES.         
000981     05  NMFA-FLDESFAT           PIC X      VALUE SPACES.         
000982     05  NMFA-CDIVACEE           PIC X(14)  VALUE SPACES.         
000983     05  NMFA-NRFATPRO           PIC X(6)   VALUE SPACES.         
000984     05  NMFA-COMBINAZ           PIC X(7)   VALUE SPACES.         
000985     05  NMFA-CTRLXIVA           PIC X      VALUE SPACES.         
000986     05  NMFA-CODCLIEN           PIC X(5)   VALUE SPACES.         
000987     05  NMFA-FILLER             PIC X(47)  VALUE SPACES.         
000988******************************************************************
000989 EJECT                                                            
000990 01  FILLER                      PIC X(08) VALUE 'DCWTSTR0'.      
000991*    COPY DCWTSTR0.                                               
000992*------------------------------------- -------------------------* 
000993*                    --- DCWTSTR0 ---                           * 
000994*              DSECT PER SALVATAGGIO COMMAREA.                  * 
000995*---------------------------------------------------------------* 
000996 01  DCWTSTR0.                                                    
000997     05  TSTR-LENGCODA               PIC S9(4)  COMP VALUE +4096. 
000998     05  TSTR-ITEMXXXX               PIC S9(4)  COMP VALUE +0.    
000999     05  TSTR-NOMECODA.                                           
001000         10  TSTR-NOMETRAN           PIC X(4)   VALUE SPACES.     
001001         10  TSTR-NOMETERM           PIC X(4)   VALUE SPACES.     
001002     05  TSTR-AREATSTR               PIC X(4096) VALUE SPACES.    
001003*---------------------------------------------------------------* 
001004 01  FILLER                      PIC X(08) VALUE 'DFHAID**'.      
001005*    COPY DFHAID SUPPRESS.                                        
001006***************************************************************** 
001007*                                                               * 
001008* Copyright (c) 2016-2022 NTT DATA, Inc.                        * 
001009* All rights reserved.                                          * 
001010*                                                               * 
001011***************************************************************** 
001012 01  DFHAID.                                                      
001013     02  DFHNULL   PIC X VALUE "-".                               
001014     02  DFHENTER  PIC X VALUE "'".                               
001015     02  DFHCLEAR  PIC X VALUE "_".                               
001016     02  DFHCLRP   PIC X VALUE "|".                               
001017     02  DFHPEN    PIC X VALUE "=".                               
001018     02  DFHOPID   PIC X VALUE "W".                               
001019     02  DFHMSRE   PIC X VALUE "X".                               
001020     02  DFHSTRF   PIC X VALUE "h".                               
001021     02  DFHTRIG   PIC X VALUE '"'.                               
001022     02  DFHPA1    PIC X VALUE "%".                               
001023     02  DFHPA2    PIC X VALUE ">".                               
001024     02  DFHPA3    PIC X VALUE ",".                               
001025     02  DFHPF1    PIC X VALUE "1".                               
001026     02  DFHPF2    PIC X VALUE "2".                               
001027     02  DFHPF3    PIC X VALUE "3".                               
001028     02  DFHPF4    PIC X VALUE "4".                               
001029     02  DFHPF5    PIC X VALUE "5".                               
001030     02  DFHPF6    PIC X VALUE "6".                               
001031     02  DFHPF7    PIC X VALUE "7".                               
001032     02  DFHPF8    PIC X VALUE "8".                               
001033     02  DFHPF9    PIC X VALUE "9".                               
001034     02  DFHPF10   PIC X VALUE ":".                               
001035     02  DFHPF11   PIC X VALUE "#".                               
001036     02  DFHPF12   PIC X VALUE "@".                               
001037     02  DFHPF13   PIC X VALUE "A".                               
001038     02  DFHPF14   PIC X VALUE "B".                               
001039     02  DFHPF15   PIC X VALUE "C".                               
001040     02  DFHPF16   PIC X VALUE "D".                               
001041     02  DFHPF17   PIC X VALUE "E".                               
001042     02  DFHPF18   PIC X VALUE "F".                               
001043     02  DFHPF19   PIC X VALUE "G".                               
001044     02  DFHPF20   PIC X VALUE "H".                               
001045     02  DFHPF21   PIC X VALUE "I".                               
001046     02  DFHPF22   PIC X VALUE "[".                               
001047     02  DFHPF23   PIC X VALUE ".".                               
001048     02  DFHPF24   PIC X VALUE "<".                               
001049 01  FILLER                      PIC X(08) VALUE 'DCWATTRI'.      
001050*    COPY DCWATTRI SUPPRESS.                                      
001051******************************************************************
001052******       VALORI    DEGLI   ATTRIBUTI    (WCOPATTR)      ******
001053******************************************************************
001054 01       DFHBMSCA.                                               
001055   05     DFHBMEOF                    PIC X  VALUE ' '.           
001056*  X'80'  CC DI RITORNO DI UN CAMPO ANNULLATO CON CANCEL F.C.     
001057   05     DFHBMUNP                    PIC X  VALUE ' '.           
001058*  X'40'  NON PROTETTO                                            
001059   05     DFHBMFSE                    PIC X  VALUE 'A'.           
001060*  X'C1'  NON PROTETTO MDT                                        
001061   05     DFHUNPSP                    PIC X  VALUE 'D'.           
001062*  X'C4'  NON PROTETTO SELEZIONABILE                              
001063   05     DFHUNPSM                    PIC X  VALUE 'E'.           
001064*  X'C5'  NON PROTETTO SELEZIONABILE MDT                          
001065   05     DFHBMBRY                    PIC X  VALUE 'H'.           
001066*  X'C8'  NON PROTETTO LUMINOSO SELEZIONABILE                     
001067   05     DFHUNIMD                    PIC X  VALUE 'I'.           
001068*  X'C9'  NON PROTETTO LUMINOSO SELEZIONABILE MDT                 
001069   05     DFHBMDAR                    PIC X  VALUE '<'.           
001070*  X'4C'  NON PROTETTO NON VISIBILE                               
001071   05     DFHUNNOD                    PIC X  VALUE '('.           
001072*  X'4D'  NON PROTETTO NON VISIBILE MDT                           
001073   05     DFHBMUNN                    PIC X  VALUE '&'.           
001074*  X'50'  NON PROTETTO NUMERICO                                   
001075   05     DFHUNNUM                    PIC X  VALUE 'J'.           
001076*  X'D1'  NON PROTETTO NUMERICO MDT                               
001077   05     DFHUNPNS                    PIC X  VALUE 'M'.           
001078*  X'D4'  NON PROTETTO NUMERICO SELEZIONABILE                     
001079   05     DFHUNNSM                    PIC X  VALUE 'N'.           
001080*  X'D5'  NON PROTETTO NUMERICO SELEZIONABILE MDT                 
001081   05     DFHUNNBS                    PIC X  VALUE 'Q'.           
001082*  X'D8'  NON PROTETTO NUMERICO LUMINOSO SELEZIONABILE            
001083   05     DFHUNBSM                    PIC X  VALUE 'R'.           
001084*  X'D9'  NON PROTETTO NUMERICO LUMINOSO SELEZIONABILE MDT        
001085   05     DFHUNPND                    PIC X  VALUE '*'.           
001086*  X'5C'  NON PROTETTO NUMERICO NON VISIBILE                      
001087   05     DFHUNNON                    PIC X  VALUE ')'.           
001088*  X'5D'  NON PROTETTO NUMERICO NON VISIBILE MDT                  
001089   05     DFHBMPRO                    PIC X  VALUE '-'.           
001090*  X'60'  PROTETTO                                                
001091   05     DFHBMPRF                    PIC X  VALUE '/'.           
001092*  X'61'  PROTETTO MDT                                            
001093   05     DFHPROSP                    PIC X  VALUE 'U'.           
001094*  X'E4'  PROTETTO SELEZIONABILE                                  
001095   05     DFHPRSPM                    PIC X  VALUE 'V'.           
001096*  X'E5'  PROTETTO SELEZIONABILE MDT                              
001097   05     DFHPROTI                    PIC X  VALUE 'Y'.           
001098*  X'E8'  PROTETTO LUMINOSO SELEZIONABILE                         
001099   05     DFHPRLSM                    PIC X  VALUE 'Z'.           
001100*  X'E9'  PROTETTO LUMINOSO SELEZIONABILE MDT                     
001101   05     DFHPROTN                    PIC X  VALUE '%'.           
001102*  X'6C'  PROTETTO NON VISIBILE                                   
001103   05     DFHPRODM                    PIC X  VALUE '_'.           
001104*  X'6D'  PROTETTO NON VISIBILE MDT                               
001105   05     DFHBMASK                    PIC X  VALUE '0'.           
001106*  X'F0'  PROTETTO SKIP                                           
001107   05     DFHBMASF                    PIC X  VALUE '1'.           
001108*  X'F1'  PROTETTO SKIP  MDT                                      
001109   05     DFHPRSKS                    PIC X  VALUE '4'.           
001110*  X'F4'  PROTETTO SKIP  SELEZIONABILE                            
001111   05     DFHPSKSM                    PIC X  VALUE '5'.           
001112*  X'F5'  PROTETTO SKIP  SELEZIONABILE MDT                        
001113   05     DFHBMASB                    PIC X  VALUE '8'.           
001114*  X'F8'  PROTETTO SKIP  LUMINOSO SELEZIONABILE                   
001115   05     DFHPROIM                    PIC X  VALUE '9'.           
001116*  X'F9'  PROTETTO SKIP  LUMINOSO SELEZIONABILE MDT               
001117*  05     DFHPRSKD                    PIC X  VALUE ''.           
001118   05     DFHPRSKD                    PIC X  VALUE '@'.           
001119*  X'7C'  PROTETTO SKIP  NON VISIBILE                             
001120   05     DFHPSKDM                    PIC X  VALUE QUOTE.         
001121*  X'7D'  PROTETTO SKIP  NON VISIBILE MDT                         
001122   05     DFHBLUE                     PIC X  VALUE '1'.           
001123*  X'F1'  COLORE BLUE                                             
001124   05     DFHRED                      PIC X  VALUE '2'.           
001125*  X'F2'  COLORE ROSSO                                            
001126   05     DFHPINK                     PIC X  VALUE '3'.           
001127*  X'F3'  COLORE ROSA                                             
001128   05     DFHGREEN                    PIC X  VALUE '4'.           
001129*  X'F4'  COLORE VERDE                                            
001130   05     DFHTURQ                     PIC X  VALUE '5'.           
001131*  X'F5'  COLORE AZZURRO                                          
001132   05     DFHYELLO                    PIC X  VALUE '6'.           
001133*  X'F6'  COLORE GIALLO                                           
001134   05     DFHNEUTR                    PIC X  VALUE '7'.           
001135*  X'F7'  COLORE NEUTRO                                           
001136   05     DFHDFHI                     PIC X  VALUE HIGH-VALUE.    
001137*  X'FF'  TOGLIE LA SOTTOLINEATURA (UNDERLINE)                    
001138   05     DFHUNDLN                    PIC X  VALUE '4'.           
001139*  X'F4'  IMPOSTA LA SOTTOLINEATURA (UNDERLINE)                   
001140   05     DFHREVRS                    PIC X  VALUE '2'.           
001141*  X'F4'  IMPOSTA IL REVERSE                                      
001142   05     DFHALL                      PIC X  VALUE ' '.           
001143*  X'00'  PULISCE GLI ATTRIBUTI PRENDENDO QUELLI DI MAPPA         
001144 01  FILLER                      PIC X(08) VALUE 'COMODI**'.      
001145 01  COMODI.                                                      
001146     05 WS-NUMEAUT2.                                              
001147        10 WS-FATTURA.                                            
001148           15 WS-FILLER          PIC X(01).                       
001149           15 WS-FATTUR7         PIC 9(07).                       
001150        10 WS-FILLER             PIC X(01).                       
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
001151     05 WS-ANNOMESE              PIC X(06).                       
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
001152     05 SW-TROVATO               PIC X(01).                       
001153     05 TABELLA1.                                                 
001154        10 T1-ELEMENTO           OCCURS 8.                        
001155           15 T1-CODSERVI        PIC X.                           
001156           15 T1-CENCOSTD        PIC X.                           
001157           15 T1-CENCOSTA        PIC X.                           
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
001158     05 WS-ORDINE-PREC           PIC X(8).                        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
001159     05 WS-ORDINE-NEW            PIC X(8).                        
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
001160     05 WS-RIGA-PREC             PIC S9(3) COMP-3.                
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
001161     05 WS-ERROSOSP              PIC X.                           
001162     05 WS-SQLCODE               PIC S9(5) COMP-3.                
001163     05 EOQ                      PIC X(01) VALUE SPACES.          
001164     05 WS-OPERAZIO              PIC X(01) VALUE SPACES.          
001165     05 WS-FLAGSALV              PIC X(01) VALUE SPACES.          
001166     05 WS-ESENTIVA-K            PIC X(01) VALUE SPACES.          
001167     05 WS-CTRLESEN-CODA         PIC X(01) VALUE SPACES.          
001168     05 WS-FLAGDELE              PIC X(01) VALUE SPACES.          
001169     05 WS-FLAGDATA              PIC X(01) VALUE SPACES.          
001170     05 WS-TIPOPERA              PIC X(01) VALUE SPACES.          
001171     05 WS-TIPOPERA-IVA          PIC X(01) VALUE SPACES.          
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
001172     05 WS-CODSOCIE              PIC X(02) VALUE SPACES.          
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
001173     05 WS-CODSOCI1              PIC X(02) VALUE SPACES.          
001174     05 WS-NRRIGORD              PIC S9(5) COMP-3 VALUE +0.       
001175     05 WS-NRRIGORD-N            PIC  9(5).                       
001176     05 WS-NRRIGORD-X REDEFINES WS-NRRIGORD-N PIC X(05).          
001177     05 WS-CONTOPER              PIC S9(5)     COMP-3 VALUE +0.   
001178     05 WS-PREZZOR9              PIC 9(9)V9(4).                   
001179     05 WS-PREZZORX              PIC X(12).                       
001180     05 WS-PREZZORD0 REDEFINES WS-PREZZORX PIC Z(12).             
001181     05 WS-PREZZORD1 REDEFINES WS-PREZZORX PIC Z(10),Z.           
001182     05 WS-PREZZORD2 REDEFINES WS-PREZZORX PIC Z(09),ZZ.          
001183     05 WS-PREZZORD3 REDEFINES WS-PREZZORX PIC Z(08),ZZZ.         
001184     05 WS-PREZZORD4 REDEFINES WS-PREZZORX PIC Z(07),ZZZZ.        
001185     05 WS-IMPORDI9              PIC 9(11)V9(2).                  
001186     05 WS-IMPORDIX              PIC X(14).                       
001187     05 WS-IMPORDIN0 REDEFINES WS-IMPORDIX PIC Z(14).             
001188     05 WS-IMPORDIN1 REDEFINES WS-IMPORDIX PIC Z(12),Z.           
001189     05 WS-IMPORDIN2 REDEFINES WS-IMPORDIX PIC Z(11),ZZ.          
001190     05 WS-IMPO0                 PIC 9(11).                       
001191     05 WS-IMPO1                 PIC 9(11)V9.                     
001192     05 WS-IMPO2                 PIC 9(11)V99.                    
001193     05 WS-DECIDIVI              PIC S9(1) VALUE +0.              
001194     05 WS-CODERROR              PIC X(5).                        
001195     05 WS-NUMEAUTO              PIC 9(9).                        
001196     05 WS-PROGPREC              PIC X(08)  VALUE SPACES.         
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
001197     05 WS-AAMMCOMP              PIC X(06)  VALUE SPACES.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
001198     05 WPAGLO20.                                                 
001199        10 FILLER                PIC X(04)  VALUE 'ORDI'.         
001200        10 WLO20-TERMINAL        PIC X(04).                       
001201     05 WLO20-LENGTH             PIC S9(4) COMP.                  
001202     05 WLO20-ITEM               PIC S9(4) COMP.                  
001203     05 WS-WPAGREFE              PIC X(1745).                     
001204*--------------------------------DLOGISTI.TSERVIZI                
001205 01  FILLER                      PIC X(8) VALUE 'FDLOG651'.       
001206*    EXEC SQL INCLUDE FDLOG651 END-EXEC.                          
      *>>((file: FDLOG651))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TSERVIZI                  *
000003******************************************************************
000004 01  DCLTSERVIZI.                                                 
000005*                       CODSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006     10 L651-CODSERVI        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007*                       DESSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000008     10 L651-DESSERVI        PIC X(40).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000009*                       UNMISURA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000010     10 L651-UNMISURA        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000011*                       TIPSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000012     10 L651-TIPSERVI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000013*                       DTCREAZI                                  
000014     10 L651-DTCREAZI        PIC X(8).                            
000015*                       DTULTVAR                                  
000016     10 L651-DTULTVAR        PIC X(8).                            
000017*                       CODUTVAR                                  
000018     10 L651-CODUTVAR        PIC X(6).                            
000019*                       CONTODCD                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000020     10 L651-CONTODCD        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000021*                       CONTODCA                                  
000022     10 L651-CONTODCA        PIC X(6).                            
000023*                       CENCOSTA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000024     10 L651-CENCOSTA        PIC X(5).                            
000025     10 L651-ESENTIVA        PIC X(1).                            
000026     10 L651-CONTPROV        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000027******************************************************************
000028* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 12      *
000029******************************************************************
      *<<((file: FDLOG651))
001207*--------------------------------DLOGISTI.TORDILOGI               
001208 01  FILLER                      PIC X(8) VALUE 'FDLOG652'.       
001209*    EXEC SQL INCLUDE FDLOG652 END-EXEC.                          
      *>>((file: FDLOG652))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TORDILOGI                 *
000003******************************************************************
000004 01  DCLTORDILOGI.                                                
000005*                       AANUMORD                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006     10 L652-AANUMORD        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007*                       CODCLIEN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000008     10 L652-CODCLIEN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000009*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000010     10 L652-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000011*                       CDDIVISI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000012     10 L652-CDDIVISI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000013*                       DTCARORD                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000014     10 L652-DTCARORD        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000015*                       CODDIVIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000016     10 L652-CODDIVIS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000017*                       TIPSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000018     10 L652-TIPSERVI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000019*                       FLAGAUTO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000020     10 L652-FLAGAUTO        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000021*                       FLAGGIVA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000022     10 L652-FLAGGIVA        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000023*                       CONTODCE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000024     10 L652-CONTODCE        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025*                       DTEVAORD                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000026     10 L652-DTEVAORD        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000027*                       AANUMFAT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000028     10 L652-AANUMFAT        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000029*                       DTFATTUR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000030     10 L652-DTFATTUR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000031*                       NRPREATT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000032     10 L652-NRPREATT        PIC X(10).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000033*                       DTPREATT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000034     10 L652-DTPREATT        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000035*                       DTCREAZI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000036     10 L652-DTCREAZI        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000037*                       DTULTVAR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000038     10 L652-DTULTVAR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000039*                       CODUTVAR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000040     10 L652-CODUTVAR        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000041*                       DTANNULL                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000042     10 L652-DTANNULL        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000043*                       SOCIEMER                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000044     10 L652-SOCIEMER        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000045*                       DATAESTR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000046     10 L652-DATAESTR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000047*                       AAMMCOMP                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000048     10 L652-AAMMCOMP        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000049*                       FLAGSOSP                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000050     10 L652-FLAGSOSP        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000051*                       CODUTEVB                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000052     10 L652-CODUTEVB        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000053*                       ESENTIVA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000054     10 L652-ESENTIVA        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000055*                       FLORDIVB                                  
000056     10 L652-FLORDIVB        PIC X(1).                            
000057******************************************************************
000058* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 26      *
000059******************************************************************
      *<<((file: FDLOG652))
001210*--------------------------------DLOGISTI.TRIGORDILOGI            
001211 01  FILLER                      PIC X(8) VALUE 'FDLOG653'.       
001212*    EXEC SQL INCLUDE FDLOG653 END-EXEC.                          
      *>>((file: FDLOG653))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TRIGORDILOGI              *
000003******************************************************************
000004 01  DCLTRIGORDILOGI.                                             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 L653-AANUMORD        PIC X(8).                            
000006     10 L653-NRRIGORD        PIC S9(5)V USAGE COMP-3.             
000007     10 L653-CODSERVI        PIC X(6).                            
000008     10 L653-UNMISURA        PIC X(2).                            
000009     10 L653-QTAORDIN        PIC S9(7)V9(2) USAGE COMP-3.         
000010     10 L653-PREZZORD        PIC S9(7)V9(4) USAGE COMP-3.         
000011     10 L653-IMPORDIN        PIC S9(11)V9(2) USAGE COMP-3.        
000012     10 L653-NOTENOTE        PIC X(40).                           
000013     10 L653-CENCOSTD        PIC X(5).                            
000014     10 L653-CENCOSTA        PIC X(5).                            
000015     10 L653-RIFECLIE        PIC X(15).                           
000016     10 L653-DTCREAZI        PIC X(8).                            
000017     10 L653-DTULTVAR        PIC X(8).                            
000018     10 L653-CODUTVAR        PIC X(6).                            
000019     10 L653-DTANNULL        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000020     10 L653-IMPORIVA        PIC S9(11)V9(2) USAGE COMP-3.        
000021******************************************************************
000022* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 16      *
000023******************************************************************
      *<<((file: FDLOG653))
001213*--------------------------------DLOGISTI.TLISTILOGI              
001214 01  FILLER                      PIC X(8) VALUE 'FDLOG654'.       
001215*    EXEC SQL INCLUDE FDLOG654 END-EXEC.                          
      *>>((file: FDLOG654))
000001******************************************************************
000002* DCLGEN TABLE(DLOGISTI.TLISTILOGI)                              *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDLOG654))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(L654-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DLOGISTI.TLISTILOGI TABLE                   
000012*     ( CODCLIEN                       CHAR(5) NOT NULL,           
000013*       DTINILIS                       CHAR(6) NOT NULL,           
000014*       DTFINLIS                       CHAR(6) NOT NULL,           
000015*       CODSERVI                       CHAR(6) NOT NULL,           
000016*       TIPSERVI                       CHAR(1) NOT NULL,           
000017*       CODDIVIS                       CHAR(2) NOT NULL,           
000018*       PREZZLIS                       DECIMAL(11, 4) NOT NULL,    
000019*       PERCLIST                       DECIMAL(5, 2) NOT NULL,     
000020*       DTCREAZI                       CHAR(8) NOT NULL,           
000021*       DTULTVAR                       CHAR(8) NOT NULL,           
000022*       CODUTVAR                       CHAR(8) NOT NULL            
000023*     ) END-EXEC
                                                                        
000024******************************************************************
000025* COBOL DECLARATION FOR TABLE DLOGISTI.TLISTILOGI                *
000026******************************************************************
000027 01  DCLTLISTILOGI.                                               
000028*                       CODCLIEN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000029     10 L654-CODCLIEN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000030*                       DTINILIS                                  
000031     10 L654-DTINILIS        PIC X(6).                            
000032*                       DTFINLIS                                  
000033     10 L654-DTFINLIS        PIC X(6).                            
000034*                       CODSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000035     10 L654-CODSERVI        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000036*                       TIPSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000037     10 L654-TIPSERVI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000038*                       CODDIVIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000039     10 L654-CODDIVIS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000040*                       PREZZLIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000041     10 L654-PREZZLIS        PIC S9(7)V9(4) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000042*                       PERCLIST                                  
000043     10 L654-PERCLIST        PIC S9(3)V9(2) USAGE COMP-3.         
000044*                       DTCREAZI                                  
000045     10 L654-DTCREAZI        PIC X(8).                            
000046*                       DTULTVAR                                  
000047     10 L654-DTULTVAR        PIC X(8).                            
000048*                       CODUTVAR                                  
000049     10 L654-CODUTVAR        PIC X(8).                            
000050******************************************************************
000051* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 11      *
000052******************************************************************
      *<<((file: FDLOG654))
001216*--------------------------------DLOGISTI.TDETTORDILOGI           
001217 01  FILLER                      PIC X(8) VALUE 'FDLOG655'.       
001218*    EXEC SQL INCLUDE FDLOG655 END-EXEC.                          
      *>>((file: FDLOG655))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TDETTORDILOGI             *
000003******************************************************************
000004 01  DCLTDETTORDILOGI.                                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 L655-AANUMORD        PIC X(8).                            
000006     10 L655-NRRIGORD        PIC S9(5)V USAGE COMP-3.             
000007     10 L655-NUMPROG7        PIC S9(7)V USAGE COMP-3.             
000008     10 L655-CDMCAGTM        PIC X(1).                            
000009     10 L655-CDAREGTM        PIC X(2).                            
000010     10 L655-CDDIPGTM        PIC X(1).                            
000011     10 L655-TIPOADDE        PIC X(2).                            
000012     10 L655-KEYADDE1        PIC X(5).                            
000013     10 L655-KEYADDE2        PIC X(3).                            
000014     10 L655-KEYADDE3        PIC X(3).                            
000015     10 L655-KEYADDE4        PIC X(5).                            
000016     10 L655-CODSOCID        PIC X(2).                            
000017     10 L655-CDDIVISD        PIC X(1).                            
000018     10 L655-CENCOSTD        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000019     10 L655-CONTODCD        PIC X(6).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000020     10 L655-CODSOCIA        PIC X(2).                            
000021     10 L655-CDDIVISA        PIC X(1).                            
000022     10 L655-CENCOSTA        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000023     10 L655-CONTODCA        PIC X(6).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000024     10 L655-UNMISURA        PIC X(2).                            
000025     10 L655-QTAORDIN        PIC S9(7)V9(2) USAGE COMP-3.         
000026     10 L655-IMPORDIN        PIC S9(11)V9(2) USAGE COMP-3.        
000027     10 L655-CODSOCIE        PIC X(2).                            
000028     10 L655-AANUMFAT        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000029     10 L655-CENCOSTO        PIC X(5).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000030     10 L655-SOCIEMER        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000031     10 L655-PROLOMER        PIC X(2).                            
000032     10 L655-CODLINEA        PIC X(2).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000033     10 L655-TIPOARTI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000034     10 L655-MERCEMAG        PIC X(2).                            
000035     10 L655-CODARTIC        PIC X(5).                            
000036     10 L655-CODDISEG        PIC X(5).                            
000037     10 L655-CODVARIA        PIC X(3).                            
000038     10 L655-STAGIONE        PIC X(2).                            
000039     10 L655-CAUSAMOV        PIC X(2).                            
000040     10 L655-CLIEFORN        PIC X(5).                            
000041     10 L655-INCLIFOR        PIC X(1).                            
000042     10 L655-STABILIM        PIC X(2).                            
000043     10 L655-NRDISPOS        PIC X(6).                            
000044     10 L655-SIGLCICL        PIC X(2).                            
000045     10 L655-TIPOAPPA        PIC X(1).                            
000046     10 L655-AANRRECL        PIC X(8).                            
000047     10 L655-NUMERIFE        PIC X(5).                            
000048     10 L655-FLTAGSCA        PIC X(1).                            
000049     10 L655-CAUSACON        PIC X(1).                            
000050     10 L655-QUALIFIN        PIC X(4).                            
000051     10 L655-QTAMTMOV        PIC S9(7)V9(2) USAGE COMP-3.         
000052     10 L655-QTAKGMOV        PIC S9(7)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000053     10 L655-DTCREAZI        PIC X(8).                            
000054     10 L655-DTULTVAR        PIC X(8).                            
000055     10 L655-CODUTVAR        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000056     10 L655-IMPTRPAG        PIC S9(7)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000057     10 L655-PAESMERC        PIC X(3).                            
000058     10 L655-TIPORECO        PIC X(4).                            
000059     10 L655-DTFATTUR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000060     10 L655-TIPOSTAG        PIC X(1).                            
000061     10 L655-MTDISPOS        PIC S9(7)       COMP-3.              
000062     10 L655-PERC2SCE        PIC S9(2)V9     COMP-3.              
000063     10 L655-MTDIFMAX        PIC S9(7)V99    COMP-3.              
000064     10 L655-MTDIFTOT        PIC S9(7)V99    COMP-3.              
000065     10 L655-MTDIFMES        PIC S9(7)V99    COMP-3.              
000066     10 L655-PARTLAVO        PIC X(6).                            
000067     10 L655-MTDISPAR        PIC S9(7)       COMP-3.              
000068     10 L655-SERIECIL        PIC X(2).                            
000069     10 L655-TPLAVMES        PIC X(1).                            
000070     10 L655-FLAGRICH        PIC X(1).                            
000071     10 L655-NRCILLAV        PIC S9(3)       COMP-3.              
000072     10 L655-SLLAVMES        PIC X(2).                            
000073     10 L655-MTMATEFF        PIC S9(7)V99    COMP-3.              
000074     10 L655-MTCONSUM        PIC S9(7)V99    COMP-3.              
000075     10 L655-QTORDPRE        PIC S9(7)V99    COMP-3.              
000076     10 L655-PREZZORD        PIC S9(7)V9(4)  COMP-3.              
000077     10 L655-CODFORVI        PIC X(5).                            
000078     10 L655-CODIMBAL        PIC X(2).                            
000079     10 L655-CODCOLLO        PIC X(5).                            
000080     10 L655-MTRAGDIS        PIC S9(7) COMP-3.                    
000081     10 L655-NUMDISTI        PIC X(6).                            
000082******************************************************************
000083* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 77      *
000084******************************************************************
      *<<((file: FDLOG655))
001219*--------------------------------DANAGRAF.TCLIENTI                
001220 01  FILLER                      PIC X(8) VALUE 'FDANA901'.       
001221*    EXEC SQL INCLUDE FDANA901 END-EXEC.                          
      *>>((file: FDANA901))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TCLIENTI                  *
000003******************************************************************
000004 01  DCLTCLIENTI.                                                 
000005*                       CODCLIEN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006     10 A901-CODCLIEN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007*                       STATCLIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000008     10 A901-STATCLIE        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000009*                       GENECLIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000010     10 A901-GENECLIE        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000011*                       TIPOCLIE                                  
000012     10 A901-TIPOCLIE        PIC X(1).                            
000013*                       TIPOCONS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000014     10 A901-TIPOCONS        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000015*                       CLIFOCON                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000016     10 A901-CLIFOCON        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000017*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000018     10 A901-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000019*                       CAPOCONT                                  
000020     10 A901-CAPOCONT        PIC X(5).                            
000021*                       CODFISCA                                  
000022     10 A901-CODFISCA        PIC X(16).                           
000023*                       ESENTIVA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000024     10 A901-ESENTIVA        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025*                       NUMESIVA                                  
000026     10 A901-NUMESIVA        PIC X(5).                            
000027*                       DATESIVA                                  
000028     10 A901-DATESIVA        PIC X(8).                            
000029*                       UFFICIVA                                  
000030     10 A901-UFFICIVA        PIC X(18).                           
000031*                       IMPESIVA                                  
000032     10 A901-IMPESIVA        PIC S9(4)V USAGE COMP-3.             
000033*                       BANCAPPO                                  
000034     10 A901-BANCAPPO        PIC X(3).                            
000035*                       NOMBANCL                                  
000036     10 A901-NOMBANCL        PIC X(114).                          
000037*                       CONTOCOR                                  
000038     10 A901-CONTOCOR        PIC X(13).                           
000039*                       ASSOBANC                                  
000040     10 A901-ASSOBANC        PIC X(5).                            
000041*                       AVVIBANC                                  
000042     10 A901-AVVIBANC        PIC X(5).                            
000043*                       CLIEFATT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000044     10 A901-CLIEFATT        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000045*                       PAESFATT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000046     10 A901-PAESFATT        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000047*                       RAGFATTU                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000048     10 A901-RAGFATTU        PIC X(24).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000049*                       ESRAGFAT                                  
000050     10 A901-ESRAGFAT        PIC X(24).                           
000051*                       INDFATTU                                  
000052     10 A901-INDFATTU        PIC X(24).                           
000053*                       ESINDFAT                                  
000054     10 A901-ESINDFAT        PIC X(24).                           
000055*                       CITFATTU                                  
000056     10 A901-CITFATTU        PIC X(18).                           
000057*                       ESCITFAT                                  
000058     10 A901-ESCITFAT        PIC X(18).                           
000059*                       CAPFATTU                                  
000060     10 A901-CAPFATTU        PIC X(5).                            
000061*                       PAESMERC                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000062     10 A901-PAESMERC        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000063*                       RAGMERCE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000064     10 A901-RAGMERCE        PIC X(24).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000065*                       ESRAGMER                                  
000066     10 A901-ESRAGMER        PIC X(24).                           
000067*                       INDMERCE                                  
000068     10 A901-INDMERCE        PIC X(24).                           
000069*                       ESINDMER                                  
000070     10 A901-ESINDMER        PIC X(24).                           
000071*                       CITMERCE                                  
000072     10 A901-CITMERCE        PIC X(18).                           
000073*                       ESCITMER                                  
000074     10 A901-ESCITMER        PIC X(18).                           
000075*                       CAPMERCE                                  
000076     10 A901-CAPMERCE        PIC X(5).                            
000077*                       ZONAMERC                                  
000078     10 A901-ZONAMERC        PIC X(2).                            
000079*                       TELCLIEN                                  
000080     10 A901-TELCLIEN        PIC X(20).                           
000081*                       TLXCLIEN                                  
000082     10 A901-TLXCLIEN        PIC X(20).                           
000083*                       FAXCLIEN                                  
000084     10 A901-FAXCLIEN        PIC X(20).                           
000085*                       RIFEMIRO                                  
000086     10 A901-RIFEMIRO        PIC X(11).                           
000087*                       PAESORDI                                  
000088     10 A901-PAESORDI        PIC X(3).                            
000089*                       ZONAORDI                                  
000090     10 A901-ZONAORDI        PIC X(2).                            
000091*                       DATVASTA                                  
000092     10 A901-DATVASTA        PIC X(8).                            
000093*                       ATTENZDI                                  
000094     10 A901-ATTENZDI        PIC X(24).                           
000095*                       CONDPAGA                                  
000096     10 A901-CONDPAGA        PIC X(3).                            
000097*                       MMESCLU1                                  
000098     10 A901-MMESCLU1        PIC S9(2)V USAGE COMP-3.             
000099*                       MMESCLU2                                  
000100     10 A901-MMESCLU2        PIC S9(2)V USAGE COMP-3.             
000101*                       GGSCATRA                                  
000102     10 A901-GGSCATRA        PIC S9(2)V USAGE COMP-3.             
000103*                       NUMGGVIA                                  
000104     10 A901-NUMGGVIA        PIC S9(2)V USAGE COMP-3.             
000105*                       TIPOTRAT                                  
000106     10 A901-TIPOTRAT        PIC X(1).                            
000107*                       ALTERSPE                                  
000108     10 A901-ALTERSPE        PIC X(1).                            
000109*                       CODILING                                  
000110     10 A901-CODILING        PIC X(1).                            
000111*                       DTULTVAR                                  
000112     10 A901-DTULTVAR        PIC X(8).                            
000113*                       TIPCLCAR                                  
000114     10 A901-TIPCLCAR        PIC X(1).                            
000115*                       SPETRASP                                  
000116     10 A901-SPETRASP        PIC X(1).                            
000117*                       DTCREAZI                                  
000118     10 A901-DTCREAZI        PIC X(8).                            
000119*                       CODDIVIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000120     10 A901-CODDIVIS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000121*                       CDIVACEE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000122     10 A901-CDIVACEE        PIC X(14).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000123*                       ZONAFATT                                  
000124     10 A901-ZONAFATT        PIC X(2).                            
000125*                       CLASDOGA                                  
000126     10 A901-CLASDOGA        PIC X(1).                            
000127*                       INTNCLIE                                  
000128     10 A901-INTNCLIE        PIC X(50).                           
000129*                       CAPOCOMM                                  
000130     10 A901-CAPOCOMM        PIC X(5).                            
000131*                       PRIORITA                                  
000132     10 A901-PRIORITA        PIC X(1).                            
000133*                       BULSTATX                                  
000134     10 A901-BULSTATX        PIC X(13).                           
000135*                       CODUTVAR                                  
000136     10 A901-CODUTVAR        PIC X(6).                            
000137*                       CODUTCRE                                  
000138     10 A901-CODUTCRE        PIC X(6).                            
000139*                       CDRESCON                                  
000140     10 A901-CDRESCON        PIC X(2).                            
000141*                       CENCOACQ                                  
000142     10 A901-CENCOACQ        PIC X(5).                            
000143*                       CAPOSOCI                                  
000144     10 A901-CAPOSOCI        PIC X(5).                            
000145*                       CDFISCAL                                  
000146     10 A901-CDFISCAL        PIC X(16).                           
000147*                       CONDPACA                                  
000148     10 A901-CONDPACA        PIC X(3).                            
000149*                       CODXIBAN                                  
000150     10 A901-CODXIBAN        PIC X(4).                            
000151*                       CODXXCIN                                  
000152     10 A901-CODXXCIN        PIC X(2).                            
000153*                       ZIPFATTU                                  
000154     10 A901-ZIPFATTU        PIC X(15).                           
000155*                       ZIPMERCE                                  
000156     10 A901-ZIPMERCE        PIC X(15).                           
000157*                       TIPOLIST                                  
000158     10 A901-TIPOLIST        PIC X(1).                            
000159*                       SWIFTCOD                                  
000160     10 A901-SWIFTCOD        PIC X(11).                           
000161*                       PERCEIVA                                  
000162     10 A901-PERCEIVA        PIC S9(3)V9(2) USAGE COMP-3.         
000163*                       DTVALIVA                                  
000164     10 A901-DTVALIVA        PIC X(8).                            
000165*                       CLASSCLI                                  
000166     10 A901-CLASSCLI        PIC X(1).                            
000167*                       RATINGCO                                  
000168     10 A901-RATINGCO        PIC X(3).                            
000169*                       RISCHCLI                                  
000170     10 A901-RISCHCLI        PIC X(1).                            
000171*                                                                 
000172     10 A901-NRPROIVA        PIC X(30).                           
000173*                                                                 
000174     10 A901-IMPESNEW        PIC S9(9)V9(2) USAGE COMP-3.         
000175     10 A901-TIPOSTAG        PIC X(1).                            
000176     10 A901-FLFATELE        PIC X(1).                            
000177     10 A901-CDDESTFE        PIC X(7).                            
000178     10 A901-INPECCLI        PIC X(50).                           
000179******************************************************************
000180* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 88      *
000181******************************************************************
      *<<((file: FDANA901))
001222*--------------------------------DANAGRAF.TPAESI                  
001223 01  FILLER                      PIC X(8) VALUE 'FDANA528'.       
001224*    EXEC SQL INCLUDE FDANA528 END-EXEC.                          
      *>>((file: FDANA528))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TPAESI                    *
000003******************************************************************
000004 01  DCLTPAESI.                                                   
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 A528-CODPAESE        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000006     10 A528-CODILING        PIC X(1).                            
000007     10 A528-PAESBANC        PIC X(3).                            
000008     10 A528-PAESEISO        PIC X(2).                            
000009     10 A528-FLPAECEE        PIC X(1).                            
000010     10 A528-FLPAEORI        PIC X(1).                            
000011     10 A528-DTCREAZI        PIC X(8).                            
000012     10 A528-DTULTVAR        PIC X(8).                            
000013     10 A528-CODUTVAR        PIC X(6).                            
000014     10 A528-SLPAEGTM        PIC X(3).                            
000015     10 A528-PRFINTER        PIC X(5).                            
000016     10 A528-GRUPPAES        PIC X(2).                            
000017     10 A528-CDMCAREG        PIC X(2).                            
000018     10 A528-CDAREREG        PIC X(2).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000019     10 A528-CDRAGCEN        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000020     10 A528-CDRAGTRA        PIC X(2).                            
000021     10 A528-CDRAGFOC        PIC X(2).                            
000022     10 A528-CODPAGVB        PIC X(3).                            
000023     10 A528-SIGPAGVB        PIC X(2).                            
000024     10 A528-CODPARUS        PIC X(3).                            
000025     10 A528-CDRAGLIS        PIC X(2).                            
000026     10 A528-CDRAGSTA        PIC X(2).                            
000027     10 A528-CDRAGLIC        PIC X(2).                            
000028     10 A528-CDRAGLIF        PIC X(2).                            
000029******************************************************************
000030* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 24      *
000031******************************************************************
      *<<((file: FDANA528))
001225*--------------------------------DANAGRAF.TSOCIETA                
001226 01  FILLER                      PIC X(8) VALUE 'FDANA531'.       
001227*    EXEC SQL INCLUDE FDANA531 END-EXEC.                          
      *>>((file: FDANA531))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TSOCIETA                  *
000003******************************************************************
000004 01  DCLTSOCIETA.                                                 
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 A531-CODSOCIE        PIC X(2).                            
000006     10 A531-NOMSOCIE        PIC X(23).                           
000007     10 A531-CODFORNI        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000008     10 A531-TASSINTE        PIC S9(3)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000009     10 A531-CODPAESE        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000010     10 A531-NRGGRISC        PIC S9(3)V USAGE COMP-3.             
000011     10 A531-CODPIANO        PIC X(2).                            
000012     10 A531-CITTASOC        PIC X(18).                           
000013     10 A531-FLPAGIVA        PIC X(1).                            
000014     10 A531-FLFATACQ        PIC X(1).                            
000015     10 A531-CODAZIEN        PIC X(5).                            
000016     10 A531-FLIVATRA        PIC X(1).                            
000017     10 A531-CODDIVIS        PIC X(2).                            
000018     10 A531-COSTINTE        PIC S9(3)V9(2) USAGE COMP-3.         
000019     10 A531-FLCONTAB        PIC X(1).                            
000020     10 A531-FLAGMAGA        PIC X(1).                            
000021     10 A531-RAGSOCIE        PIC X(50).                           
000022     10 A531-SOCIECON        PIC X(2).                            
000023     10 A531-DTCREAZI        PIC X(8).                            
000024     10 A531-DTULTVAR        PIC X(8).                            
000025     10 A531-CODUTVAR        PIC X(6).                            
000026     10 A531-INDLEGAL        PIC X(35).                           
000027     10 A531-CAPLEGAL        PIC X(5).                            
000028     10 A531-CITLEGAL        PIC X(18).                           
000029     10 A531-CODFISCA        PIC X(16).                           
000030     10 A531-CODDIVRI        PIC X(2).                            
000031     10 A531-SOCIEGTM        PIC X(2).                            
000032     10 A531-GENEFATT        PIC X(1).                            
000033     10 A531-FLAGATTI        PIC X(1).                            
000034     10 A531-DIVISOLD        PIC X(2).                            
000035     10 A531-DTFINOLD        PIC X(8).                            
000036     10 A531-DIVRIOLD        PIC X(2).                            
000037     10 A531-DIVIRIFA        PIC X(2).                            
000038     10 A531-FLEURUSA        PIC X(1).                            
000039     10 A531-FLAGLIMI        PIC X(1).                            
000040     10 A531-FLFILIAL        PIC X(1).                            
000041     10 A531-FLPRESEN        PIC X(1).                            
000042     10 A531-CODSOCPA        PIC X(1).                            
000043     10 A531-FLBOLGVB        PIC X(1).                            
000044     10 A531-FLSTCART        PIC X(1).                            
000045     10 A531-FLDIPEST        PIC X(1).                            
000046     10 A531-CODFIRMA        PIC X(8).                            
000047     10 A531-DESFIRMA        PIC X(24).                           
000048     10 A531-CDSOCJDE        PIC X(5).                            
000049     10 A531-CODFORNV        PIC X(5).                            
000050     10 A531-CODFORNA        PIC X(5).                            
000051     10 A531-IMPCCASO        PIC S9(13) COMP-3.                   
000052     10 A531-TRIBCCIA        PIC X(10).                           
000053     10 A531-PROLEGAL        PIC X(2).                            
000054     10 A531-FLSOCSAP        PIC X(1).                            
000055     10 A531-DIVIXLAV        PIC X(2).                            
000056******************************************************************
000057* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 51      *
000058******************************************************************
      *<<((file: FDANA531))
001228*--------------------------------DANAGRAF.TCENCOSTO               
001229 01  FILLER                      PIC X(8) VALUE 'FDANA982'.       
001230*    EXEC SQL INCLUDE FDANA982 END-EXEC.                          
      *>>((file: FDANA982))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TCENCOSTO)                               *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA982))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(A982-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DANAGRAF.TCENCOSTO TABLE                    
000012*     ( CODSOCIE                       CHAR(2) NOT NULL,           
000013*       CENCOSTO                       CHAR(5) NOT NULL,           
000014*       DESCENCO                       CHAR(30) NOT NULL,          
000015*       RAGCENCO                       CHAR(3) NOT NULL,           
000016*       ANNULLAM                       CHAR(1) NOT NULL,           
000017*       NEWCENCO                       CHAR(5) NOT NULL,           
000018*       CENCOLIS                       CHAR(5) NOT NULL,           
000019*       DTCREAZI                       CHAR(8) NOT NULL,           
000020*       DTULTVAR                       CHAR(8) NOT NULL,           
000021*       CODUTVAR                       CHAR(6) NOT NULL,           
000022*       CDMCAGTM                       CHAR(1) NOT NULL,           
000023*       CDAREGTM                       CHAR(2) NOT NULL,           
000024*       CDDIPGTM                       CHAR(1) NOT NULL,           
000025*       CDUBIGTM                       CHAR(2) NOT NULL,           
000026*       CDLINGTM                       CHAR(2) NOT NULL,           
000027*       SIGLCALE                       CHAR(3) NOT NULL,           
000028*       GRUPSIGE                       CHAR(1) NOT NULL,           
000029*       CDDIVISI                       CHAR(1) NOT NULL            
000030*     ) END-EXEC
                                                                        
000031******************************************************************
000032* COBOL DECLARATION FOR TABLE DANAGRAF.TCENCOSTO                 *
000033******************************************************************
000034 01  DCLTCENCOSTO.                                                
000035*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000036     10 A982-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000037*                       CENCOSTO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000038     10 A982-CENCOSTO        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000039*                       DESCENCO                                  
000040     10 A982-DESCENCO        PIC X(30).                           
000041*                       RAGCENCO                                  
000042     10 A982-RAGCENCO        PIC X(3).                            
000043*                       ANNULLAM                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000044     10 A982-ANNULLAM        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000045*                       NEWCENCO                                  
000046     10 A982-NEWCENCO        PIC X(5).                            
000047*                       CENCOLIS                                  
000048     10 A982-CENCOLIS        PIC X(5).                            
000049*                       DTCREAZI                                  
000050     10 A982-DTCREAZI        PIC X(8).                            
000051*                       DTULTVAR                                  
000052     10 A982-DTULTVAR        PIC X(8).                            
000053*                       CODUTVAR                                  
000054     10 A982-CODUTVAR        PIC X(6).                            
000055*                       CDMCAGTM                                  
000056     10 A982-CDMCAGTM        PIC X(1).                            
000057*                       CDAREGTM                                  
000058     10 A982-CDAREGTM        PIC X(2).                            
000059*                       CDDIPGTM                                  
000060     10 A982-CDDIPGTM        PIC X(1).                            
000061*                       CDUBIGTM                                  
000062     10 A982-CDUBIGTM        PIC X(2).                            
000063*                       CDLINGTM                                  
000064     10 A982-CDLINGTM        PIC X(2).                            
000065*                       SIGLCALE                                  
000066     10 A982-SIGLCALE        PIC X(3).                            
000067*                       GRUPSIGE                                  
000068     10 A982-GRUPSIGE        PIC X(1).                            
000069*                       CDDIVISI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000070     10 A982-CDDIVISI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000071******************************************************************
000072* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 18      *
000073******************************************************************
      *<<((file: FDANA982))
001231*--------------------------------DANAGRAF.TDIVISE                 
001232 01  FILLER                      PIC X(8) VALUE 'FDANA963'.       
001233*    EXEC SQL INCLUDE FDANA963 END-EXEC.                          
      *>>((file: FDANA963))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TDIVISE                   *
000003******************************************************************
000004 01  DCLTDIVISE.                                                  
000005*                       SIGLADIV                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006     10 A963-SIGLADIV        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007*                       CAMBIODV                                  
000008     10 A963-CAMBIODV        PIC S9(5)V9(6) USAGE COMP-3.         
000009*                       DESCDIVI                                  
000010     10 A963-DESCDIVI        PIC X(20).                           
000011*                       CODDIVIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000012     10 A963-CODDIVIS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000013*                       DECIDIVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000014     10 A963-DECIDIVI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000015*                       DIVIBANC                                  
000016     10 A963-DIVIBANC        PIC X(3).                            
000017*                       DIVIPREZ                                  
000018     10 A963-DIVIPREZ        PIC X(1).                            
000019*                       CODDIVRI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000020     10 A963-CODDIVRI        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000021*                       RAPPCAMB                                  
000022     10 A963-RAPPCAMB        PIC S9(5)V USAGE COMP-3.             
000023*                       CODDIGTM                                  
000024     10 A963-CODDIGTM        PIC X(2).                            
000025*                       FLAGEURO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000026     10 A963-FLAGEURO        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000027*                       SLDIVBAN                                  
000028     10 A963-SLDIVBAN        PIC X(3).                            
000029*                       CDDIVSCA                                  
000030     10 A963-CDDIVSCA        PIC X(2).                            
000031*                       FLDIVINT                                  
000032     10 A963-FLDIVINT        PIC X(1).                            
000033     10 A963-VBDIVSCA        PIC X(2).                            
000034******************************************************************
000035* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 15      *
000036******************************************************************
      *<<((file: FDANA963))
001234*--------------------------------DCONTCLI.TCONTIDCE               
001235 01  FILLER                      PIC X(8) VALUE 'FDCLI861'.       
001236*    EXEC SQL INCLUDE FDCLI861 END-EXEC.                          
      *>>((file: FDCLI861))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DCONTCLI.TCONTIDCE                 *
000003******************************************************************
000004 01  DCLTCONTIDCE.                                                
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 C861-CONTODCE        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000006     10 C861-CODPIANO        PIC X(2).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000007     10 C861-CONTPROV        PIC X(6).                            
000008     10 C861-DESCRDCE        PIC X(25).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000009     10 C861-ANNULLAM        PIC X(1).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000010     10 C861-TIPCONTO        PIC X(2).                            
000011     10 C861-CONTGRUP        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000012     10 C861-NOTECON1        PIC X(33).                           
000013     10 C861-NOTECON2        PIC X(33).                           
000014     10 C861-INDBILQU        PIC X(1).                            
000015     10 C861-FLCOMMES        PIC X(1).                            
000016******************************************************************
000017* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 11 C861- 
000018******************************************************************
      *<<((file: FDCLI861))
001237*--------------------------------DANAGRAF.TMESSAGGI               
001238 01  FILLER                      PIC X(8) VALUE 'FDANA846'.       
001239*    EXEC SQL INCLUDE FDANA846 END-EXEC.                          
      *>>((file: FDANA846))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TMESSAGGI)                               *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA846))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        QUOTE                                                   *
000007* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000008******************************************************************
000009     
      *EXEC SQL DECLARE DANAGRAF.TMESSAGGI TABLE                    
000010*     ( CODERROR                       CHAR(5) NOT NULL,           
000011*       CODILING                       CHAR(1) NOT NULL,           
000012*       MSGERROR                       CHAR(60) NOT NULL,          
000013*       TIPOMESS                       CHAR(1) NOT NULL,           
000014*       DTCREAZI                       CHAR(8) NOT NULL,           
000015*       DTULTVAR                       CHAR(8) NOT NULL,           
000016*       CODUTVAR                       CHAR(6) NOT NULL            
000017*     ) END-EXEC
                                                                        
000018******************************************************************
000019* COBOL DECLARATION FOR TABLE DANAGRAF.TMESSAGGI                 *
000020******************************************************************
000021 01  DCLTMESSAGGI.                                                
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000022     10 A846-CODERROR        PIC X(5).                            
000023     10 A846-CODILING        PIC X(1).                            
000024     10 A846-MSGERROR        PIC X(60).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025     10 A846-TIPOMESS        PIC X(1).                            
000026     10 A846-DTCREAZI        PIC X(8).                            
000027     10 A846-DTULTVAR        PIC X(8).                            
000028     10 A846-CODUTVAR        PIC X(6).                            
000029******************************************************************
000030* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 7       *
000031******************************************************************
      *<<((file: FDANA846))
001240*--------------------------------DANAGRAF.TDATARIO                
001241 01  FILLER                      PIC X(8) VALUE 'FDANA973'.       
001242*    EXEC SQL INCLUDE FDANA973 END-EXEC.                          
      *>>((file: FDANA973))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TDATARIO)                                *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA973))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(A973-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DANAGRAF.TDATARIO TABLE                     
000012*     ( DTGIORNO                       CHAR(8) NOT NULL,           
000013*       PRGIORNO                       DECIMAL(7, 0) NOT NULL,     
000014*       NUMGIORN                       CHAR(3) NOT NULL,           
000015*       NUMSETTI                       CHAR(2) NOT NULL,           
000016*       NRGGSETT                       CHAR(1) NOT NULL,           
000017*       DTINISET                       CHAR(8) NOT NULL,           
000018*       DTFINSET                       CHAR(8) NOT NULL,           
000019*       DTINIMES                       CHAR(8) NOT NULL,           
000020*       DTFINMES                       CHAR(8) NOT NULL,           
000021*       ANNOSETT                       CHAR(6) NOT NULL,           
000022*       FLAGFEST                       CHAR(1) NOT NULL            
000023*     ) END-EXEC
                                                                        
000024******************************************************************
000025* COBOL DECLARATION FOR TABLE DANAGRAF.TDATARIO                  *
000026******************************************************************
000027 01  DCLTDATARIO.                                                 
000028*                       DTGIORNO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000029     10 A973-DTGIORNO        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000030*                       PRGIORNO                                  
000031     10 A973-PRGIORNO        PIC S9(7)V USAGE COMP-3.             
000032*                       NUMGIORN                                  
000033     10 A973-NUMGIORN        PIC X(3).                            
000034*                       NUMSETTI                                  
000035     10 A973-NUMSETTI        PIC X(2).                            
000036*                       NRGGSETT                                  
000037     10 A973-NRGGSETT        PIC X(1).                            
000038*                       DTINISET                                  
000039     10 A973-DTINISET        PIC X(8).                            
000040*                       DTFINSET                                  
000041     10 A973-DTFINSET        PIC X(8).                            
000042*                       DTINIMES                                  
000043     10 A973-DTINIMES        PIC X(8).                            
000044*                       DTFINMES                                  
000045     10 A973-DTFINMES        PIC X(8).                            
000046*                       ANNOSETT                                  
000047     10 A973-ANNOSETT        PIC X(6).                            
000048*                       FLAGFEST                                  
000049     10 A973-FLAGFEST        PIC X(1).                            
000050******************************************************************
000051* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 11      *
000052******************************************************************
      *<<((file: FDANA973))
001243*--------------------------------DTRASP.TNETMOVEREXPO             
001244 01  FILLER                      PIC X(8) VALUE 'FDTRA358'.       
001245*    EXEC SQL INCLUDE FDTRA358 END-EXEC.                          
      *>>((file: FDTRA358))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DTRASP.TNETMOVEREXPO               *
000003******************************************************************
000004 01  DCLTNETMOVEREXPO.                                            
000005     10 T358-SOCIEFAT        PIC X(2).                            
000006     10 T358-NRPREFAT        PIC X(10).                           
000007     10 T358-DTPREFAT        PIC X(8).                            
000008     10 T358-CODFORNI        PIC X(5).                            
000009     10 T358-CODSOCIE        PIC X(2).                            
000010     10 T358-AANUMFAT        PIC X(20).                           
000011     10 T358-DTFATTUR        PIC X(8).                            
000012     10 T358-NUMPROG5        PIC S9(5)V USAGE COMP-3.             
000013     10 T358-MERCEMAG        PIC X(2).                            
000014     10 T358-PROLOMER        PIC X(2).                            
000015     10 T358-CODLINEA        PIC X(2).                            
000016     10 T358-CENCOSTO        PIC X(5).                            
000017     10 T358-CDTPCOST        PIC X(10).                           
000018     10 T358-CODDIVIS        PIC X(2).                            
000019     10 T358-IMPCOSTO        PIC S9(9)V9(2) USAGE COMP-3.         
000020     10 T358-DTCREAZI        PIC X(8).                            
000021     10 T358-DTULTVAR        PIC X(8).                            
000022     10 T358-CODUTVAR        PIC X(6).                            
000023     10 T358-TIPORECO        PIC X(4).                            
000024     10 T358-CONTODCE        PIC X(6).                            
000025     10 T358-STPREFAT        PIC X(3).                            
000026     10 T358-DTSPEDIZ        PIC X(8).                            
000027     10 T358-DATATRAS        PIC X(8).                            
000028     10 T358-CENCOTRA        PIC X(5).                            
000029     10 T358-NRPREATT        PIC X(10).                           
000030     10 T358-DTPREATT        PIC X(8).                            
000031     10 T358-STPREATT        PIC X(3).                            
000032     10 T358-IMCOSATT        PIC S9(9)V9(2) USAGE COMP-3.         
000033     10 T358-NRDOCCOT        PIC X(10).                           
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000034     10 T358-NRRIGORD        PIC S9(3)V USAGE COMP-3.             
000035     10 T358-AANUMORD        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000036******************************************************************
000037* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 31      *
000038******************************************************************
      *<<((file: FDTRA358))
001247     
      *EXEC SQL 
      *DECLARE POINTORDI CURSOR FOR                            
001248*           SELECT O.CODCLIEN, O.CODSOCIE                          
001249*                 ,O.CDDIVISI, O.DTCARORD                          
001250*                 ,O.CODDIVIS, O.TIPSERVI                          
001251*                 ,O.CONTODCE, O.DTEVAORD                          
001252*                 ,O.FLAGAUTO, O.FLAGGIVA                          
001253*                 ,O.AANUMFAT, O.DTFATTUR                          
001254*                 ,O.NRPREATT, O.DTPREATT                          
001255*                 ,R.NRRIGORD, R.CODSERVI                          
001256*                 ,R.UNMISURA, R.QTAORDIN                          
001257*                 ,R.PREZZORD, R.IMPORDIN                          
001258*                 ,R.NOTENOTE                                      
001259*                 ,R.CENCOSTD, R.CENCOSTA                          
001260*                 ,O.AAMMCOMP, R.RIFECLIE                          
001261*                 ,O.FLAGSOSP, O.CODUTEVB                          
001262*                 ,O.ESENTIVA                                      
001263*             FROM DLOGISTI.TORDILOGI    O                         
001264*                 ,DLOGISTI.TRIGORDILOGI R                         
001265*            WHERE O.AANUMORD = :L652-AANUMORD                     
001266*              AND O.AANUMORD = R.AANUMORD                         
001267*              AND O.DTANNULL = ' '                                
001268*              AND R.DTANNULL = ' '                                
001269*            ORDER BY R.NRRIGORD                                   
001270**           ORDER BY R.CENCOSTA, R.CENCOSTD, R.CODSERVI           
001271*     END-EXEC
                                                                        
001272*    EXEC SQL INCLUDE SQLCA    END-EXEC.                          
      *>>((file: SQLCA))
000001****************************************************************<*
000002* Copyright (c) 2016-2023 NTT DATA, Inc. All rights reserved.  *<*
000003* Users of NTT DATA Enterprise COBOL may freely                *<*
000004* redistribute this copybook.                                  *<*
000005****************************************************************<*
000006                                                                  
000007 01  SQLCA GLOBAL.                                                
000008     05  SQLCAID                PIC X(8).                         
000009     05  SQLCABC                PIC S9(9) COMP-5.                 
000010     05  SQLCODE                PIC S9(9) COMP-5.                 
000011     05  SQLERRM.                                                 
000012         49  SQLERRML           PIC S9(4) COMP-5.                 
000013         49  SQLERRMC           PIC X(254).                       
000014     05  SQLERRP                PIC X(8).                         
000015     05  SQLERRD OCCURS 6 TIMES PIC S9(9) COMP-5.                 
000016     05  SQLWARN.                                                 
000017         10 SQLWARN0            PIC X(1).                         
000018         10 SQLWARN1            PIC X(1).                         
000019         10 SQLWARN2            PIC X(1).                         
000020         10 SQLWARN3            PIC X(1).                         
000021         10 SQLWARN4            PIC X(1).                         
000022         10 SQLWARN5            PIC X(1).                         
000023         10 SQLWARN6            PIC X(1).                         
000024         10 SQLWARN7            PIC X(1).                         
000025     05  SQLSTATE               PIC X(5).                         
000026     05  SQLEXT                 PIC S9(5) COMP-3 VALUE 1.         
      *<<((file: SQLCA))
001273****************************************************************  
001274*                                                                 
001275* Copyright (c) 2016-2022 NTT DATA, Inc.                          
001276* All rights reserved.                                            
001277*                                                                 
001278****************************************************************  
001279 01  DFHEIV.                                                      
001280   02  DFHEIV0               PIC X(35).                           
001281   02  DFHEIV1               PIC X(08).                           
001282   02  DFHEIV2               PIC X(08).                           
001283   02  DFHEIV3               PIC X(08).                           
001284   02  DFHEIV4               PIC X(06).                           
001285   02  DFHEIV5               PIC X(04).                           
001286   02  DFHEIV6               PIC X(04).                           
001287   02  DFHEIV7               PIC X(02).                           
001288   02  DFHEIV8               PIC X(02).                           
001289   02  DFHEIV9               PIC X(01).                           
001290   02  DFHEIV10              PIC S9(7) COMP-3.                    
001291   02  DFHEIV11              PIC S9(4) COMP SYNC.                 
001292   02  DFHEIV12              PIC S9(4) COMP SYNC.                 
001293   02  DFHEIV13              PIC S9(4) COMP SYNC.                 
001294   02  DFHEIV14              PIC S9(4) COMP SYNC.                 
001295   02  DFHEIV15              PIC S9(4) COMP SYNC.                 
001296   02  DFHEIV16              PIC S9(9) COMP SYNC.                 
001297   02  DFHEIV17              PIC X(04).                           
001298   02  DFHEIV18              PIC X(04).                           
001299   02  DFHEIV19              PIC X(04).                           
001300   02  DFHEIV20              USAGE IS POINTER.                    
001301   02  DFHEIV21              USAGE IS POINTER.                    
001302   02  DFHEIV22              USAGE IS POINTER.                    
001303   02  DFHEIV23              USAGE IS POINTER.                    
001304   02  DFHEIV24              USAGE IS POINTER.                    
001305   02  DFHEIV25              PIC S9(9) COMP SYNC.                 
001306   02  DFHEIV26              PIC S9(9) COMP SYNC.                 
001307   02  DFHEIV27              PIC S9(9) COMP SYNC.                 
001308   02  DFHEIV28              PIC S9(9) COMP SYNC.                 
001309   02  DFHEIV29              PIC S9(9) COMP SYNC.                 
001310   02  DFHEIV30              PIC S9(9) COMP SYNC.                 
001311   02  DFHEIV31              PIC S9(9) COMP SYNC.                 
001312   02  DFHEIV32              PIC S9(4) COMP SYNC.                 
001313   02  DFHEIV33              PIC S9(4) COMP SYNC.                 
001314   02  DFHEIV34              PIC S9(4) COMP SYNC.                 
001315   02  DFHEIV35              PIC S9(4) COMP SYNC.                 
001316   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.         
001317   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.      
001318   02  FILLER                PIC X(02).                           
001319   02  DFHEIV99              PIC X(08) VALUE SPACE.               
001320   02  DFHEIVL0              PIC X(48) VALUE SPACE.               
001321   02  DFHEIVL1              PIC X(48) VALUE SPACE.               
001322   02  DFHEIVL2              PIC X(48) VALUE SPACE.               
001323   02  DFHEIVL3              PIC X(48) VALUE SPACE.               
001324   02  DFHEIVL4              PIC X(255) VALUE SPACE.              
001325   02  DFHEIVL5              PIC X(255) VALUE SPACE.              
001326 LINKAGE  SECTION.                                                
001327***************************************************************** 
001328*                                                               * 
001329* Copyright (c) 2016-2022 NTT DATA, Inc.                        * 
001330* All rights reserved.                                          * 
001331*                                                               * 
001332***************************************************************** 
001333 01  dfheiblk.                                                    
001334     02  eibtime          pic s9(7) comp-3.                       
001335     02  eibdate          pic s9(7) comp-3.                       
001336     02  eibtrnid         pic x(4).                               
001337     02  eibtaskn         pic s9(7) comp-3.                       
001338     02  eibtrmid         pic x(4).                               
001339     02  dfheigdi         pic s9(4) comp.                         
001340     02  eibcposn         pic s9(4) comp.                         
001341     02  eibcalen         pic s9(4) comp.                         
001342     02  eibaid           pic x(1).                               
001343     02  eibfiller1       pic x(1).                               
001344     02  eibfn            pic x(2).                               
001345     02  eibfiller2       pic x(2).                               
001346     02  eibrcode         pic x(6).                               
001347     02  eibfiller3       pic x(2).                               
001348     02  eibds            pic x(8).                               
001349     02  eibreqid         pic x(8).                               
001350     02  eibrsrce         pic x(8).                               
001351     02  eibsync          pic x(1).                               
001352     02  eibfree          pic x(1).                               
001353     02  eibrecv          pic x(1).                               
001354     02  eibsend          pic x(1).                               
001355     02  eibatt           pic x(1).                               
001356     02  eibeoc           pic x(1).                               
001357     02  eibfmh           pic x(1).                               
001358     02  eibcompl         pic x(1).                               
001359     02  eibsig           pic x(1).                               
001360     02  eibconf          pic x(1).                               
001361     02  eiberr           pic x(1).                               
001362     02  eibrldbk         pic x(1).                               
001363     02  eiberrcd         pic x(4).                               
001364     02  eibsynrb         pic x(1).                               
001365     02  eibnodat         pic x(1).                               
001366     02  eibfiller5       pic x(2).                               
001367     02  eibresp          pic s9(8) comp.                         
001368     02  eibresp2         pic s9(8) comp.                         
001369     02  dfheigdj         pic s9(4) comp.                         
001370     02  dfheigdk         pic s9(4) comp.                         
001371 01  DFHCOMMAREA.                                                 
001372*    COPY DCLCOMMA.                                               
001373     02 LK-AREABYTE PIC X OCCURS 0 TO 4096 TIMES                  
001374                       DEPENDING ON EIBCALEN OF DFHEIBLK.         
001375*----------------------------------------------------------------*
001376 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.                   
001376 VCOBOL-DUMMY-PROCEDURE.
001377 0000-DFHENTRY SECTION.                                           
001378     MOVE FUNCTION WHEN-COMPILED TO DFHEIVL0(1:21).               
001379     MOVE SPACES TO DFHEIV2.                                      
001380     MOVE '9#                    &   ' TO DFHEIV0.                
001381     MOVE 'AVTLO20' TO DFHEIV1.                                   
001382     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1       
001383          DFHEIVL0 DFHEIV2.                                       
001384*----------------------------------------------------------------*
001385                                                                  
001386* EXEC CICS HANDLE ABEND LABEL(Z00-ERRORE)      END-EXEC.         
001387*    MOVE '..L                   " " #00001378' TO DFHEIV0        
001388     MOVE X'2E2E4C202020202020202020' &                           
001389          X'202020202020202020202220' &                           
001390          X'2220233030303031333738' TO DFHEIV0                    
001391     CALL 'kxdfhei1' USING DFHEIV0,                               
001392           DFHEIV99                                               
001393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001394                                                                  
001395     
      *EXEC SQL WHENEVER SQLERROR   GO TO Z00-ERRORE END-EXEC
                                                                        
001396     PERFORM A00-INIZIALIZZAZIONE                                 
001397        THRU A00-EX.                                              
001398     IF EIBCALEN NOT > ZERO                                       
001399        PERFORM B00-ARRIVO-DA-START                               
001400           THRU B00-EX                                            
001401     ELSE                                                         
001402        MOVE DFHCOMMAREA         TO WCOM-AREAXXXX                 
001403        MOVE 'AVMLO20'           TO WNOMEMAP                      
001404        MOVE WCOM-CODILING       TO WCODLING                      
001405        IF EIBAID = DFHENTER OR                                   
001406           EIBAID = DFHPF10                                       
001407           PERFORM C00-RICEVI-MAPPA                               
001408              THRU C00-EX                                         
001409        ELSE                                                      
001410           PERFORM D00-GESTIONE-PF                                
001411              THRU D00-EX.                                        
001412     PERFORM E30-INVIA-MAPPA                                      
001413        THRU E30-EX.                                              
001414     PERFORM U00-RETURN-TRAN                                      
001415        THRU U00-EX.                                              
001416*----------------------------------------------------------------*
001417 A00-INIZIALIZZAZIONE.                                            
001418*----------------------------------------------------------------*
001419     MOVE +500                   TO WCOM-LUNGHEZZ.                
001420     MOVE 'LOOR'                 TO WPAGNOME                      
001421     MOVE EIBTRMID               TO WPAGVIDE                      
001422                                    WLO20-TERMINAL.               
001423     MOVE LOW-VALUE              TO AVILO20O.                     
001424     MOVE 8                      TO WNUMRIGA                      
001425                                    WLO20-WNUMRIGA.               
001426     MOVE LENGTH OF WPAGREFE     TO WPAGLPAG.                     
001427     MOVE LENGTH OF WLO20-CODA   TO WLO20-LENGTH.                 
001428     MOVE 'N'                    TO WS-CTRLESEN-CODA.             
001429 A00-EX. EXIT.                                                    
001430*----------------------------------------------------------------*
001431 B00-ARRIVO-DA-START.                                             
001432*----------------------------------------------------------------*
001433                                                                  
001434* EXEC CICS HANDLE CONDITION ENDDATA (B05-NORESP)                 
001435*    END-EXEC.                                                    
001436*    MOVE '"$&                   ! # #00001417' TO DFHEIV0        
001437     MOVE X'222426202020202020202020' &                           
001438          X'202020202020202020202120' &                           
001439          X'2320233030303031343137' TO DFHEIV0                    
001440     CALL 'kxdfhei1' USING DFHEIV0                                
001441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001442                                                                  
001443                                                                  
001444* EXEC CICS RETRIEVE INTO   (WCOM-AREAXXXX)                       
001445*                       LENGTH (WCOM-LUNGHEZZ)                    
001446*    END-EXEC.                                                    
001447*    MOVE '0*I L                 &   #00001419' TO DFHEIV0        
001448     MOVE X'302A49204C20202020202020' &                           
001449          X'202020202020202020202620' &                           
001450          X'2020233030303031343139' TO DFHEIV0                    
001451     CALL 'kxdfhei1' USING DFHEIV0,                               
001452           WCOM-AREAXXXX,                                         
001453           WCOM-LUNGHEZZ,                                         
001454           DFHEIV99,                                              
001455           DFHEIV99,                                              
001456           DFHEIV99                                               
001457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001458                                                                  
001459     MOVE WCOM-NOMEPRGM          TO WS-PROGPREC.                  
001460     PERFORM LEGGO-RICICLO                                        
001461        THRU LEGGO-RICICLO-EX.                                    
001462     PERFORM B10-PRIMA-VOLTA                                      
001463        THRU B10-EX.                                              
001464     MOVE SPACES                 TO WCOM-DATIPROG.                
001465     INITIALIZE                     WCOM-DATIPROG.                
001466     MOVE SPACES                 TO WCOM-SALDATOX.                
001467     MOVE SPACES                 TO WCOM-FLAGAUTO.                
001468     MOVE ZEROES                 TO WCOM-INDESENZ.                
001469     MOVE ZEROES                 TO WCOM-PAGESENZ.                
001470     MOVE ZEROES                 TO WCOM-CONTOPER.                
001471     MOVE SPACES                 TO WCOM-OPERAZIO.                
001472     IF WCOM-FLAGPRGM NOT > SPACES                                
001473        IF WCOM-AANUMORD NOT > SPACES                             
001474           MOVE 'I'              TO WCOM-FLAGPRGM                 
001475        ELSE                                                      
001476           MOVE 'V'              TO WCOM-FLAGPRGM.                
001477     MOVE LOW-VALUE              TO AVILO20O.                     
001478     MOVE WCOM-CDDIVISI          TO LO20-CDDIVISIO.               
001479     MOVE WCOM-CODSOCIE          TO LO20-CODSOCIEO.               
001480     MOVE WCOM-CODSOCIE          TO A531-CODSOCIE.                
001481     PERFORM L00-SELECT-SOCIETA                                   
001482        THRU L00-EX.                                              
001483     MOVE A531-NOMSOCIE          TO LO20-NOMSOCIEO.               
001484     MOVE EIBTRNID               TO WCOM-TRANSAZI.                
001485     IF WCOM-MENUTRAN(1) NOT = 'LOGI'                             
001486        MOVE 'L'                 TO LO20-TIPSERVIO.               
001487     IF WS-PROGPREC = 'AVTLO10'                                   
001488        PERFORM B20-PROPONI-DATI                                  
001489           THRU B20-EX                                            
001490        MOVE WCOM-PAGIULTI       TO LO20-MAPPPAGO                 
001491        GO TO B00-EX.                                             
001492     MOVE SPACES                 TO WPAGREFE.                     
001493     INITIALIZE                     WPAGREFE.                     
001494     PERFORM U20-DELETE-TS                                        
001495        THRU U20-EX.                                              
001496     IF WCOM-FLAGPRGM = 'I'                                       
001497        MOVE 1                   TO WCOM-PAGILIST                 
001498        MOVE 1                   TO WCOM-PAGIULTI                 
001499        MOVE 1                   TO WCOM-PAGIRICH                 
001500        MOVE 1                   TO WPAGRICH                      
001501        MOVE WCOM-PAGIULTI       TO LO20-MAPPPAGO                 
001502        MOVE 1                   TO WNUMITEM                      
001503        MOVE SPACES              TO WPAGREFE                      
001504        INITIALIZE WPAGREFE                                       
001505        PERFORM R10-WRITEQ-TS                                     
001506           THRU R10-EX                                            
001507     ELSE                                                         
001508        MOVE WCOM-AANUMORD       TO LO20-AANUMORDO                
001509        PERFORM C20-GESTIONE-RICICLO                              
001510           THRU C20-EX.                                           
001511 B00-EX. EXIT.                                                    
001512*----------------------------------------------------------------*
001513 B05-NORESP.                                                      
001514*----------------------------------------------------------------*
001515                                                                  
001516* EXEC CICS SEND CONTROL                                          
001517*                   ERASE                                         
001518*                   FREEKB                                        
001519*    END-EXEC.                                                    
001520*    MOVE '82      T  E F        (   #00001478' TO DFHEIV0        
001521     MOVE X'383220202020202054202045' &                           
001522          X'204620202020202020202820' &                           
001523          X'2020233030303031343738' TO DFHEIV0                    
001524     CALL 'kxdfhei1' USING DFHEIV0,                               
001525           DFHEIV99,                                              
001526           DFHEIV99,                                              
001527           DFHEIV99,                                              
001528           DFHEIV99,                                              
001529           DFHEIV99,                                              
001530           DFHEIV99,                                              
001531           DFHEIV99                                               
001532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001533                                                                  
001534                                                                  
001535* EXEC CICS RETURN END-EXEC.                                      
001536*    MOVE '.(                    ''   #00001482' TO DFHEIV0       
001537     MOVE X'2E2820202020202020202020' &                           
001538          X'202020202020202020202720' &                           
001539          X'2020233030303031343832' TO DFHEIV0                    
001540     CALL 'kxdfhei1' USING DFHEIV0,                               
001541           DFHEIV99,                                              
001542           DFHEIV99,                                              
001543           DFHEIV99,                                              
001544           DFHEIV99,                                              
001545           DFHEIV99,                                              
001546           DFHEIV99                                               
001547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001548                                                                  
001549 B05-EX. EXIT.                                                    
001550*----------------------------------------------------------------*
001551 B10-PRIMA-VOLTA.                                                 
001552*----------------------------------------------------------------*
001553     MOVE 'AVTLO20'              TO WCOM-NOMEPRGM.                
001554     MOVE EIBTRNID               TO WCOM-TRANSAZI.                
001555     IF WS-PROGPREC NOT = 'AVTLO10'                               
001556        MOVE ZEROES              TO WCOM-PAGIRICH                 
001557                                    WCOM-PAGILIST                 
001558                                    WPAGRICH                      
001559        MOVE 99999               TO WCOM-PAGIULTI.                
001560     MOVE 'AVMLO20'              TO WNOMEMAP.                     
001561     MOVE WCOM-CODILING          TO WCODLING.                     
001562     IF WCOM-MENUTRAN (WCOM-INDITRAN) NOT = WCOM-TRANSAZI         
001563        ADD  1                   TO WCOM-INDITRAN                 
001564        MOVE WCOM-TRANSAZI       TO WCOM-MENUTRAN (WCOM-INDITRAN) 
001565        MOVE ZEROES              TO WCOM-PAGITRAN (WCOM-INDITRAN).
001566     IF WCOM-INDITRAN GREATER 10                                  
001567        MOVE 'TRTR'              TO WCOM-CODABEND                 
001568        PERFORM Z00-ERRORE                                        
001569           THRU Z00-EX.                                           
001570 B10-EX. EXIT.                                                    
001571*----------------------------------------------------------------*
001572 B20-PROPONI-DATI.                                                
001573*----------------------------------------------------------------*
001574     MOVE 1                            TO WLO20-ITEM              
001575     PERFORM R25-READQ-WPAGLO20                                   
001576        THRU R25-EX.                                              
001577     PERFORM B25-SPOSTA-TESTATA                                   
001578        THRU B25-EX                                               
001579     MOVE WCOM-PAGITRAN(WCOM-INDITRAN) TO WCOM-PAGIRICH           
001580                                          WNUMITEM                
001581     PERFORM R20-READQ-TS                                         
001582        THRU R20-EX.                                              
001583     PERFORM E22-SPOSTA-IN-MAPPA                                  
001584        THRU E22-EX                                               
001585             VARYING WINDRIGA FROM 1 BY 1                         
001586               UNTIL WINDRIGA > WNUMRIGA                          
001587                  OR WPAG-CODSERVI (WINDRIGA) NOT > SPACES.       
001588     PERFORM B30-SCARICA-CODA                                     
001589        THRU B30-EX                                               
001590             VARYING WLO20-WINDRIGA FROM 1 BY 1                   
001591               UNTIL WLO20-WINDRIGA > WLO20-WNUMRIGA              
001592                  OR WLO20-CODSERVI (WLO20-WINDRIGA) NOT > ' '    
001593                  OR WINDRIGA > WNUMRIGA                          
001594     PERFORM R30-REWRITE-TS                                       
001595        THRU R30-EX.                                              
001596     PERFORM U30-DELETE-WPAGLO20                                  
001597        THRU U30-EX.                                              
001598 B20-EX. EXIT.                                                    
001599*----------------------------------------------------------------*
001600 B25-SPOSTA-TESTATA.                                              
001601*----------------------------------------------------------------*
001602     MOVE WLO20-CODCLIEN         TO LO20-CODCLIENO                
001603     MOVE WLO20-NOMCLIEN         TO LO20-NOMCLIENO                
001604     MOVE WLO20-FLAGGIVA         TO LO20-FLAGGIVAO                
001605     MOVE WLO20-ESENTIVA         TO LO20-ESENTIVAO                
001606     MOVE WLO20-AANUMORD         TO LO20-AANUMORDO                
001607     MOVE WLO20-DTCARORD         TO LO20-DTCARORDO                
001608     MOVE WLO20-AAMMCOMP         TO LO20-AAMMCOMPO                
001609     MOVE WLO20-TIPSERVI         TO LO20-TIPSERVIO                
001610     MOVE WLO20-DESTIPSE         TO LO20-DESTIPSEO                
001611     MOVE WLO20-CONTODCE         TO LO20-CONTODCEO                
001612     MOVE WLO20-DESCRDCE         TO LO20-DESCRDCEO                
001613     MOVE WLO20-CODDIVIS         TO LO20-CODDIVISO                
001614     MOVE WLO20-SIGLADIV         TO LO20-SIGLADIVO                
001615     MOVE WLO20-AANUMFAT         TO LO20-AANUMFATO                
001616     MOVE WLO20-DTFATTUR         TO LO20-DTFATTURO                
001617     MOVE WLO20-NRPREATT         TO LO20-NRPREATTO                
001618     MOVE WLO20-DTPREATT         TO LO20-DTPREATTO                
001619     MOVE WLO20-FLAGAUTO         TO LO20-FLAGAUTOO                
001620     MOVE WLO20-MESSWARN         TO LO20-MESSWARNO.               
001621     MOVE WLO20-CODCONSO         TO LO20-CODCONSOO.               
001622 B25-EX. EXIT.                                                    
001623*----------------------------------------------------------------*
001624 B30-SCARICA-CODA.                                                
001625*----------------------------------------------------------------*
001626     ADD 1                         TO WCOM-CONTOPER               
001627     MOVE 'I'                      TO LO20-OPERAZIOO(WINDRIGA)    
001628                                      WPAG-OPERAZIO (WINDRIGA).   
001629     MOVE WLO20-CODSERVI(WLO20-WINDRIGA)                          
001630                                   TO LO20-CODSERVIO(WINDRIGA).   
001631     MOVE WLO20-DESSERVI(WLO20-WINDRIGA)                          
001632                                   TO LO20-DESSERVIO(WINDRIGA).   
001633     MOVE WLO20-UNMISURA(WLO20-WINDRIGA)                          
001634                                   TO LO20-UNMISURAO(WINDRIGA).   
001635     ADD 1                         TO WINDRIGA.                   
001636 B30-EX. EXIT.                                                    
001637*----------------------------------------------------------------*
001638 C00-RICEVI-MAPPA.                                                
001639*----------------------------------------------------------------*
001640     PERFORM C01-RECEIVE-MAP                                      
001641        THRU C01-EX.                                              
001642     MOVE SPACES                 TO WCOM-RCODSERV                 
001643     MOVE SPACES                 TO WCOM-RCENCOSA                 
001644     MOVE SPACES                 TO WCOM-RCENCOSD                 
001645     INSPECT LO20-AANUMORDI REPLACING ALL LOW-VALUE BY SPACES.    
001646     IF LO20-MAPRPAGO IS NUMERIC                                  
001647        MOVE LO20-MAPRPAGO       TO WPAGRICH                      
001648     ELSE                                                         
001649        MOVE WCOM-PAGIRICH       TO WPAGRICH.                     
001650     IF WPAGRICH NOT EQUAL WCOM-PAGIRICH                          
001651        PERFORM E20-PAGINA-PRONTA                                 
001652           THRU E20-EX                                            
001653     ELSE                                                         
001654        IF WCOM-FLAGPRGM  NOT = 'I' AND                           
001655          (LO20-AANUMORDI NOT = WCOM-AANUMORD OR                  
001656           LO20-AANUMORDI NOT > SPACES)                           
001657           PERFORM C20-GESTIONE-RICICLO                           
001658              THRU C20-EX                                         
001659        ELSE                                                      
001660           IF WCOM-PAGILIST > ZEROES                              
001661              PERFORM C40-GESTIONE-RICEVI                         
001662                 THRU C40-EX.                                     
001663 C00-EX. EXIT.                                                    
001664*----------------------------------------------------------------*
001665 C01-RECEIVE-MAP.                                                 
001666*----------------------------------------------------------------*
001667                                                                  
001668* EXEC CICS RECEIVE MAPSET ('AVMLO20')                            
001669*                      MAP    (WNOMEMAP)                          
001670*                      INTO   (AVILO20I)                          
001671*                      END-EXEC.                                  
001672     MOVE LENGTH OF                                               
001673      AVILO20I                                                    
001674       TO DFHEIV11                                                
001675     MOVE 'AVMLO20' TO DFHEIV1                                    
001676*    MOVE '8"T I  L              ''   #00001601' TO DFHEIV0       
001677     MOVE X'382254204920204C20202020' &                           
001678          X'202020202020202020202720' &                           
001679          X'2020233030303031363031' TO DFHEIV0                    
001680     CALL 'kxdfhei1' USING DFHEIV0,                               
001681           WNOMEMAP,                                              
001682           AVILO20I,                                              
001683           DFHEIV11,                                              
001684           DFHEIV1,                                               
001685           DFHEIV99,                                              
001686           DFHEIV99                                               
001687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001688                                                                  
001689     MOVE LOW-VALUE              TO LO20-MESSAGGI.                
001690     MOVE SPACES                 TO MESS-CODERROR.                
001691 C01-EX. EXIT.                                                    
001692*----------------------------------------------------------------*
001693 C20-GESTIONE-RICICLO.                                            
001694*----------------------------------------------------------------*
001695     PERFORM C25-CTRL-RICHIESTA                                   
001696        THRU C25-EX.                                              
001697     IF ERRORE                                                    
001698        GO TO C20-EX.                                             
001699     MOVE 'S'                    TO WS-CTRLESEN-CODA.             
001700     MOVE L652-AANUMORD          TO WCOM-AANUMORD.                
001701     MOVE ZEROES                 TO WCOM-PAGIRICH                 
001702                                    WCOM-PAGILIST                 
001703                                    WPAGRICH.                     
001704     MOVE 99999                  TO WCOM-PAGIULTI.                
001705     MOVE ZEROES                 TO WCOM-INDESENZ.                
001706     MOVE ZEROES                 TO WCOM-PAGESENZ.                
001707     PERFORM U20-DELETE-TS                                        
001708        THRU U20-EX.                                              
001709     PERFORM U30-DELETE-WPAGLO20                                  
001710        THRU U30-EX.                                              
001711     PERFORM E10-PREPARA-PAGINE                                   
001712        THRU E10-EX.                                              
001713     PERFORM E20-PAGINA-PRONTA                                    
001714        THRU E20-EX.                                              
001715 C20-EX. EXIT.                                                    
001716*----------------------------------------------------------------*
001717 C25-CTRL-RICHIESTA.                                              
001718*----------------------------------------------------------------*
001719     MOVE SPACES                 TO WCOM-SALDATOX.                
001720     INSPECT LO20-AANUMORDI REPLACING ALL LOW-VALUE BY SPACES.    
001721     IF LO20-AANUMORDI NOT > SPACES                               
001722        MOVE '*'                 TO WSWERROR                      
001723        MOVE '02482'             TO MESS-CODERROR                 
001724        MOVE DFHUNIMD            TO LO20-AANUMORDA                
001725        MOVE DFHRED              TO LO20-AANUMORDC                
001726        MOVE -1                  TO LO20-AANUMORDL                
001727        GO TO C25-EX.                                             
001728     MOVE LO20-AANUMORDI         TO L652-AANUMORD.                
001729     PERFORM L20-SELECT-ORDILOGI                                  
001730        THRU L20-EX.                                              
001731     IF SQLCODE NOT = ZEROES                                      
001732        MOVE '*'                 TO WSWERROR                      
001733        MOVE '00048'             TO MESS-CODERROR                 
001734        MOVE DFHUNIMD            TO LO20-AANUMORDA                
001735        MOVE DFHRED              TO LO20-AANUMORDC                
001736        MOVE -1                  TO LO20-AANUMORDL                
001737        GO TO C25-EX                                              
001738     ELSE                                                         
001739        IF L652-DTEVAORD > SPACES OR                              
001740           L652-AANUMFAT > SPACES                                 
001741           MOVE 'S'              TO WCOM-SALDATOX.                
001742 C25-EX. EXIT.                                                    
001743*----------------------------------------------------------------*
001744 C40-GESTIONE-RICEVI.                                             
001745*----------------------------------------------------------------*
001746     PERFORM F00-CONTROLLI                                        
001747        THRU F00-EX.                                              
001748     IF ERRORE                                                    
001749        GO TO C40-EX.                                             
001750     IF EIBAID EQUAL DFHPF10                                      
001751        IF WCOM-AANUMORD NOT > SPACES                             
001752           PERFORM H00-CERCA-NUM-ORDINE                           
001753              THRU H00-EX                                         
001754           IF ERRORE                                              
001755              GO TO C40-EX                                        
001756           END-IF                                                 
001757        END-IF                                                    
001758        PERFORM G00-AGGIORNAMENTI                                 
001759           THRU G00-EX.                                           
001760 C40-EX. EXIT.                                                    
001761*----------------------------------------------------------------*
001762 D00-GESTIONE-PF.                                                 
001763*----------------------------------------------------------------*
001764     IF EIBAID NOT EQUAL DFHPF1 AND                               
001765        EIBAID NOT EQUAL DFHPF2 AND                               
001766        EIBAID NOT EQUAL DFHPF7 AND                               
001767        EIBAID NOT EQUAL DFHPF8 AND                               
001768        EIBAID NOT EQUAL DFHPF9 AND                               
001769        EIBAID NOT EQUAL DFHPF11                                  
001770        MOVE SPACES              TO WCOM-RCODSERV                 
001771        MOVE SPACES              TO WCOM-RCENCOSA                 
001772        MOVE SPACES              TO WCOM-RCENCOSD                 
001773        PERFORM D30-FUNZIONI-ESTERNE                              
001774           THRU D30-EX                                            
001775     ELSE                                                         
001776        IF EIBAID = DFHPF11                                       
001777           IF WCOM-FLAGPRGM NOT = 'I'                             
001778              PERFORM D40-CERCA                                   
001779                 THRU D40-EX                                      
001780           ELSE                                                   
001781              PERFORM D30-FUNZIONI-ESTERNE                        
001782                 THRU D30-EX                                      
001783           END-IF                                                 
001784        ELSE                                                      
001785           MOVE SPACES           TO WCOM-RCODSERV                 
001786           MOVE SPACES           TO WCOM-RCENCOSA                 
001787           MOVE SPACES           TO WCOM-RCENCOSD                 
001788           PERFORM C01-RECEIVE-MAP                                
001789              THRU C01-EX                                         
001790           PERFORM D20-IMPOSTA-PAGINA                             
001791              THRU D20-EX                                         
001792           IF NOT ERRORE                                          
001793              PERFORM E20-PAGINA-PRONTA                           
001794                 THRU E20-EX.                                     
001795 D00-EX. EXIT.                                                    
001796*----------------------------------------------------------------*
001797 D20-IMPOSTA-PAGINA.                                              
001798*----------------------------------------------------------------*
001799     MOVE 'N'                   TO WS-CTRLESEN-CODA.              
001800     IF EIBAID = DFHPF1                                           
001801        COMPUTE WPAGRICH = WCOM-PAGIRICH + 1                      
001802        IF WCOM-FLAGPRGM = 'I'                                    
001803           PERFORM D21-APRI-PAGINA-VUOTA                          
001804              THRU D21-EX                                         
001805        ELSE                                                      
001806           MOVE 'S'              TO WS-CTRLESEN-CODA              
001807        END-IF                                                    
001808     ELSE                                                         
001809        IF EIBAID = DFHPF9                                        
001810           IF WCOM-FLAGPRGM NOT = 'I' AND                         
001811              WCOM-SALDATOX NOT > SPACES                          
001812              COMPUTE WPAGRICH = WCOM-PAGIULTI                    
001813              PERFORM D22-ALTRI-INSERIMENTI                       
001814                 THRU D22-EX                                      
001815           END-IF                                                 
001816        ELSE                                                      
001817           IF EIBAID = DFHPF2                                     
001818              COMPUTE WPAGRICH = WCOM-PAGIRICH - 1                
001819              MOVE 'S'           TO WS-CTRLESEN-CODA              
001820           ELSE                                                   
001821              IF EIBAID = DFHPF7                                  
001822                 MOVE 1          TO WPAGRICH                      
001823                 MOVE 'S'        TO WS-CTRLESEN-CODA              
001824              ELSE                                                
001825                 IF EIBAID = DFHPF8                               
001826                    MOVE WCOM-PAGIULTI TO WPAGRICH .              
001827                    MOVE 'S'     TO WS-CTRLESEN-CODA.             
001828 D20-EX. EXIT.                                                    
001829*----------------------------------------------------------------*
001830 D21-APRI-PAGINA-VUOTA.                                           
001831*----------------------------------------------------------------*
001832     IF WPAGRICH > WCOM-PAGIULTI                                  
001833        PERFORM                                                   
001834           VARYING WINDRIGA FROM 1 BY 1                           
001835             UNTIL WINDRIGA > WNUMRIGA                            
001836                OR LO20-CODSERVII(WINDRIGA) NOT > SPACES          
001837        END-PERFORM                                               
001838        IF WINDRIGA > WNUMRIGA                                    
001839           ADD 1                 TO WCOM-PAGIULTI                 
001840           MOVE WCOM-PAGIULTI    TO WCOM-PAGILIST                 
001841           MOVE WCOM-PAGIULTI    TO WNUMITEM                      
001842           MOVE SPACES           TO WPAGREFE                      
001843           INITIALIZE WPAGREFE                                    
001844           PERFORM R10-WRITEQ-TS                                  
001845              THRU R10-EX                                         
001846           MOVE '00038'          TO MESS-CODERROR                 
001847           MOVE -1               TO LO20-OPERAZIOL(1)             
001848        ELSE                                                      
001849           MOVE '*'              TO WSWERROR                      
001850           MOVE '00038'          TO MESS-CODERROR                 
001851           MOVE -1               TO LO20-OPERAZIOL(WINDRIGA)      
001852        END-IF                                                    
001853     END-IF.                                                      
001854 D21-EX. EXIT.                                                    
001855*----------------------------------------------------------------*
001856 D22-ALTRI-INSERIMENTI.                                           
001857*----------------------------------------------------------------*
001858     MOVE WPAGRICH               TO WNUMITEM                      
001859     PERFORM R20-READQ-TS                                         
001860        THRU R20-EX.                                              
001861     PERFORM                                                      
001862        VARYING WINDRIGA FROM 1 BY 1                              
001863          UNTIL WINDRIGA                     > WNUMRIGA           
001864             OR WPAG-CODSERVI (WINDRIGA) NOT > SPACES             
001865     END-PERFORM                                                  
001866     IF WINDRIGA > WNUMRIGA                                       
001867        ADD 1                    TO WCOM-PAGIULTI                 
001868        MOVE WCOM-PAGIULTI       TO WCOM-PAGILIST                 
001869        MOVE WCOM-PAGIULTI       TO WNUMITEM                      
001870                                    WPAGRICH                      
001871        MOVE SPACES              TO WPAGREFE                      
001872        INITIALIZE WPAGREFE                                       
001873        PERFORM R10-WRITEQ-TS                                     
001874           THRU R10-EX                                            
001875        MOVE '00038'             TO MESS-CODERROR                 
001876        MOVE -1                  TO LO20-OPERAZIOL(1)             
001877     ELSE                                                         
001878        MOVE '00038'             TO MESS-CODERROR                 
001879        MOVE -1                  TO LO20-OPERAZIOL(WINDRIGA)      
001880     END-IF.                                                      
001881 D22-EX. EXIT.                                                    
001882*----------------------------------------------------------------*
001883 D30-FUNZIONI-ESTERNE.                                            
001884*----------------------------------------------------------------*
001885     PERFORM U30-DELETE-WPAGLO20                                  
001886        THRU U30-EX.                                              
001887                                                                  
001888* EXEC CICS HANDLE ABEND CANCEL                                   
001889*                     END-EXEC.                                   
001890*    MOVE '..C                   " $ #00001803' TO DFHEIV0        
001891     MOVE X'2E2E43202020202020202020' &                           
001892          X'202020202020202020202220' &                           
001893          X'2420233030303031383033' TO DFHEIV0                    
001894     CALL 'kxdfhei1' USING DFHEIV0,                               
001895           DFHEIV99                                               
001896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001897                                                                  
001898     MOVE '*'                    TO WCOM-DELETETS.                
001899                                                                  
001900* EXEC CICS LINK PROGRAM  ('WWTTIM15')                            
001901*                   COMMAREA (WCOM-AREAXXXX)                      
001902*                   LENGTH   (WCOM-LUNGHEZZ)                      
001903*                   END-EXEC.                                     
001904     MOVE 'WWTTIM15' TO DFHEIV1                                   
001905*    MOVE '."C                   (   #00001806' TO DFHEIV0        
001906     MOVE X'2E2243202020202020202020' &                           
001907          X'202020202020202020202820' &                           
001908          X'2020233030303031383036' TO DFHEIV0                    
001909     CALL 'kxdfhei1' USING DFHEIV0,                               
001910           DFHEIV1,                                               
001911           WCOM-AREAXXXX,                                         
001912           WCOM-LUNGHEZZ,                                         
001913           DFHEIV99,                                              
001914           DFHEIV99,                                              
001915           DFHEIV99,                                              
001916           DFHEIV99                                               
001917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001918                                                                  
001919                                                                  
001920* EXEC CICS HANDLE ABEND RESET                                    
001921*                     END-EXEC.                                   
001922*    MOVE '..R                   " % #00001810' TO DFHEIV0        
001923     MOVE X'2E2E52202020202020202020' &                           
001924          X'202020202020202020202220' &                           
001925          X'2520233030303031383130' TO DFHEIV0                    
001926     CALL 'kxdfhei1' USING DFHEIV0,                               
001927           DFHEIV99                                               
001928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001929                                                                  
001930     MOVE 'AVTLO20'               TO WCOM-NOMEPRGM                
001931     IF WCOM-RETURNXX = '*'                                       
001932                                                                  
001933* EXEC CICS RETURN END-EXEC                                       
001934*    MOVE '.(                    ''   #00001814' TO DFHEIV0       
001935     MOVE X'2E2820202020202020202020' &                           
001936          X'202020202020202020202720' &                           
001937          X'2020233030303031383134' TO DFHEIV0                    
001938     CALL 'kxdfhei1' USING DFHEIV0,                               
001939           DFHEIV99,                                              
001940           DFHEIV99,                                              
001941           DFHEIV99,                                              
001942           DFHEIV99,                                              
001943           DFHEIV99,                                              
001944           DFHEIV99                                               
001945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
001946     ELSE                                                         
001947         PERFORM U00-RETURN-TRAN                                  
001948            THRU U00-EX.                                          
001949 D30-EX. EXIT.                                                    
001950*----------------------------------------------------------------*
001951 D40-CERCA.                                                       
001952*----------------------------------------------------------------*
001953     PERFORM C01-RECEIVE-MAP                                      
001954        THRU C01-EX                                               
001955     IF LO20-RCODSERVI NOT > ' ' AND                              
001956        LO20-RCENCOSDI NOT > ' ' AND                              
001957        LO20-RCENCOSAI NOT > ' '                                  
001958        MOVE '*'                 TO WSWERROR                      
001959        MOVE '01976'             TO MESS-CODERROR                 
001960        MOVE DFHRED              TO LO20-RCODSERVC                
001961                                    LO20-RCENCOSDC                
001962                                    LO20-RCENCOSAC                
001963        MOVE DFHUNIMD            TO LO20-RCODSERVA                
001964                                    LO20-RCENCOSDA                
001965                                    LO20-RCENCOSAA                
001966        MOVE -1                  TO LO20-RCODSERVL                
001967        GO TO D40-EX.                                             
001968     IF (LO20-RCODSERVI > ' ' AND                                 
001969        (LO20-RCENCOSDI > ' ' OR                                  
001970         LO20-RCENCOSAI > ' ')) OR                                
001971        (LO20-RCENCOSDI > ' ' AND                                 
001972         LO20-RCENCOSAI > ' ')                                    
001973        MOVE '*'                 TO WSWERROR                      
001974        MOVE '00037'             TO MESS-CODERROR                 
001975        MOVE DFHRED              TO LO20-RCODSERVC                
001976                                    LO20-RCENCOSDC                
001977                                    LO20-RCENCOSAC                
001978        MOVE DFHUNIMD            TO LO20-RCODSERVA                
001979                                    LO20-RCENCOSDA                
001980                                    LO20-RCENCOSAA                
001981        MOVE -1                  TO LO20-RCODSERVL                
001982        GO TO D40-EX.                                             
001983     INITIALIZE                     TABELLA1                      
001984     IF WCOM-RCODSERV NOT = LO20-RCODSERVI OR                     
001985        WCOM-RCENCOSD NOT = LO20-RCENCOSDI OR                     
001986        WCOM-RCENCOSA NOT = LO20-RCENCOSAI                        
001987        MOVE LO20-RCODSERVI      TO WCOM-RCODSERV                 
001988        MOVE LO20-RCENCOSDI      TO WCOM-RCENCOSD                 
001989        MOVE LO20-RCENCOSAI      TO WCOM-RCENCOSA                 
001990        MOVE 1                   TO WNUMITEM                      
001991     ELSE                                                         
001992        COMPUTE WNUMITEM = WCOM-PAGIRICH + 1                      
001993        IF WNUMITEM > WCOM-PAGIULTI                               
001994           MOVE 1                TO WNUMITEM.                     
001995     PERFORM R20-READQ-TS                                         
001996        THRU R20-EX.                                              
001997     MOVE 'N'                    TO SW-TROVATO                    
001998     PERFORM D41-SCORRI-WPAG                                      
001999        THRU D41-EX                                               
002000             UNTIL EOQ        = 'S'                               
002001                OR SW-TROVATO = 'S'                               
002002     MOVE WNUMITEM               TO WPAGRICH                      
002003     PERFORM E20-PAGINA-PRONTA                                    
002004        THRU E20-EX.                                              
002005     IF SW-TROVATO = 'N'                                          
002006        MOVE '00215'             TO MESS-CODERROR.                
002007 D40-EX. EXIT.                                                    
002008*----------------------------------------------------------------*
002009 D41-SCORRI-WPAG.                                                 
002010*----------------------------------------------------------------*
002011     PERFORM VARYING WINDRIGA FROM 1 BY 1                         
002012       UNTIL WINDRIGA > WNUMRIGA                                  
002013             IF LO20-RCODSERVI > ' ' AND                          
002014                LO20-RCODSERVI = WPAG-CODSERVI(WINDRIGA)          
002015                MOVE 'S'         TO SW-TROVATO                    
002016                                    T1-CODSERVI(WINDRIGA)         
002017             END-IF                                               
002018             IF LO20-RCENCOSDI > ' ' AND                          
002019                LO20-RCENCOSDI = WPAG-CENCOSTD(WINDRIGA)          
002020                MOVE 'S'         TO SW-TROVATO                    
002021                                    T1-CENCOSTD(WINDRIGA)         
002022             END-IF                                               
002023             IF LO20-RCENCOSAI > ' ' AND                          
002024                LO20-RCENCOSAI = WPAG-CENCOSTA(WINDRIGA)          
002025                MOVE 'S'         TO SW-TROVATO                    
002026                                    T1-CENCOSTA(WINDRIGA)         
002027             END-IF                                               
002028     END-PERFORM                                                  
002029     IF SW-TROVATO NOT = 'S'                                      
002030        ADD 1                    TO WNUMITEM                      
002031        PERFORM R20-READQ-TS                                      
002032           THRU R20-EX.                                           
002033 D41-EX. EXIT.                                                    
002034*----------------------------------------------------------------*
002035 E10-PREPARA-PAGINE.                                              
002036*----------------------------------------------------------------*
002037     MOVE SPACES                 TO L651-CODSERVI.                
002038     MOVE SPACES                 TO WCOM-CONTPROV.                
002039     MOVE SPACES                 TO WPAGREFE.                     
002040     INITIALIZE                     WPAGREFE.                     
002041     PERFORM O00-OPEN-POINTORDI                                   
002042        THRU O00-EX                                               
002043     PERFORM L30-FETCH-POINTORDI                                  
002044        THRU L30-EX.                                              
002045     IF WS-SQLCODE NOT = 100                                      
002046        PERFORM E15-PREPARA-TESTATA                               
002047           THRU E15-EX                                            
002048        MOVE 'T'                 TO WS-TIPOPERA                   
002049        MOVE 'T'                 TO WS-TIPOPERA-IVA               
002050        PERFORM F05-CTRL-DATI-TESTATA                             
002051           THRU F05-EX                                            
002052        IF NOT ERRORE                                             
002053           PERFORM F40-CONTROLLO-CONTODCE                         
002054              THRU F40-EX.                                        
002055     PERFORM E16-PREPARA-PAGINE                                   
002056        THRU E16-EX                                               
002057             UNTIL WS-SQLCODE EQUAL +100.                         
002058     PERFORM O10-CLOSE-POINTORDI                                  
002059        THRU O10-EX.                                              
002060     IF WCOM-PAGILIST > ZEROES                                    
002061        MOVE WCOM-PAGILIST       TO WCOM-PAGIULTI                 
002062        IF WCOM-PAGITRAN (WCOM-INDITRAN)  > ZEROES                
002063           MOVE WCOM-PAGITRAN (WCOM-INDITRAN) TO WPAGRICH         
002064           MOVE ZEROES           TO WCOM-PAGITRAN (WCOM-INDITRAN) 
002065        ELSE                                                      
002066           MOVE 1                TO WPAGRICH                      
002067     ELSE                                                         
002068        PERFORM E21-PULISCI-RIGHE                                 
002069           THRU E21-EX                                            
002070         IF MESS-CODERROR NOT > SPACES                            
002071            MOVE '00002'         TO MESS-CODERROR.                
002072 E10-EX. EXIT.                                                    
002073*----------------------------------------------------------------*
002074 E15-PREPARA-TESTATA.                                             
002075*----------------------------------------------------------------*
002076     MOVE L652-AANUMORD          TO LO20-AANUMORDO.               
002077     MOVE L652-CODSOCIE          TO LO20-CODSOCIEO.               
002078     MOVE L652-CODSOCIE          TO WCOM-CODSOCIE.                
002079     MOVE L652-CDDIVISI          TO LO20-CDDIVISIO.               
002080     MOVE L652-CDDIVISI          TO WCOM-CDDIVISI.                
002081     MOVE L652-CODCLIEN          TO LO20-CODCLIENO                
002082     MOVE L652-CODCLIEN          TO WCOM-CODCLIEN.                
002083     STRING L652-DTCARORD(7:2)                                    
002084            L652-DTCARORD(5:2)                                    
002085            L652-DTCARORD(3:2)                                    
002086             DELIMITED BY SIZE INTO LO20-DTCARORDO.               
002087     MOVE L652-FLAGGIVA          TO LO20-FLAGGIVAO.               
002088     MOVE L652-FLAGGIVA          TO WCOM-FLAGGIVA.                
002089     MOVE L652-ESENTIVA          TO LO20-ESENTIVAO.               
002090     MOVE L652-ESENTIVA          TO WCOM-ESENTIVA.                
002091     IF WCOM-INDESENZ NOT > ZEROES                                
002092        MOVE 1                   TO WCOM-INDESENZ                 
002093        MOVE 1                   TO WCOM-PAGESENZ.                
002094     MOVE L652-TIPSERVI          TO LO20-TIPSERVIO.               
002095     MOVE L652-TIPSERVI          TO WCOM-TIPSERVI.                
002096     MOVE L652-AAMMCOMP          TO LO20-AAMMCOMPO.               
002097     MOVE L652-AAMMCOMP          TO WCOM-AAMMCOMP.                
002098     MOVE L652-CONTODCE          TO LO20-CONTODCEO.               
002099     MOVE L652-CONTODCE          TO WCOM-CONTODCE.                
002100     MOVE L652-CODDIVIS          TO LO20-CODDIVISO.               
002101     MOVE L652-CODDIVIS          TO WCOM-CODDIVIS.                
002102     MOVE L652-FLAGAUTO          TO LO20-FLAGAUTOO.               
002103     MOVE L652-FLAGAUTO          TO WCOM-FLAGAUTO.                
002104     MOVE L652-NRPREATT          TO LO20-NRPREATTO.               
002105     STRING L652-DTPREATT(7:2)                                    
002106            L652-DTPREATT(5:2)                                    
002107            L652-DTPREATT(3:2)                                    
002108             DELIMITED BY SIZE INTO LO20-DTPREATTO.               
002109     IF L652-AANUMFAT > SPACES                                    
002110        MOVE L652-AANUMFAT       TO LO20-AANUMFATO                
002111        STRING L652-DTFATTUR(7:2)                                 
002112               L652-DTFATTUR(5:2)                                 
002113               L652-DTFATTUR(3:2)                                 
002114        DELIMITED BY SIZE      INTO LO20-DTFATTURO.               
002115     IF L652-DTEVAORD > SPACES                                    
002116        STRING L652-DTEVAORD(7:2)                                 
002117               L652-DTEVAORD(5:2)                                 
002118               L652-DTEVAORD(3:2)                                 
002119        DELIMITED BY SIZE      INTO LO20-DTEVAORDO.               
002120     MOVE L652-CODUTEVB          TO LO20-CODUTEVBO                
002121     MOVE SPACES                 TO LO20-SOSPESOXO                
002122     IF L652-FLAGSOSP > ' '                                       
002123        MOVE MESS-CODERROR       TO WS-CODERROR                   
002124        MOVE '00752'             TO MESS-CODERROR                 
002125        PERFORM U10-DECODIFICA-MESSAGGI                           
002126           THRU U10-EX                                            
002127        MOVE MESS-MESSAGGI       TO LO20-SOSPESOXO                
002128        MOVE WS-CODERROR         TO MESS-CODERROR.                
002129 E15-EX. EXIT.                                                    
002130*------------------------------------------------------------*    
002131 E16-PREPARA-PAGINE.                                              
002132*------------------------------------------------------------*    
002133     MOVE SPACES                 TO WPAGREFE.                     
002134     INITIALIZE                     WPAGREFE.                     
002135     PERFORM E17-CARICA-DETTAGLIO                                 
002136        THRU E17-EX                                               
002137             VARYING WINDRIGA FROM 1 BY 1                         
002138               UNTIL WINDRIGA   > WNUMRIGA                        
002139                  OR WS-SQLCODE = +100.                           
002140     ADD  1                      TO WCOM-PAGILIST.                
002141     PERFORM R10-WRITEQ-TS                                        
002142        THRU R10-EX.                                              
002143 E16-EX. EXIT.                                                    
002144*------------------------------------------------------------*    
002145 E17-CARICA-DETTAGLIO.                                            
002146*------------------------------------------------------------*    
002147     MOVE SPACES                 TO WPAG-OPERAZIO  (WINDRIGA).    
002148     MOVE L653-NRRIGORD          TO WPAG-NRRIGORD  (WINDRIGA).    
002149     MOVE L653-CODSERVI          TO WPAG-CODSERVI  (WINDRIGA).    
002150     IF L653-CODSERVI NOT = L651-CODSERVI                         
002151        MOVE L653-CODSERVI       TO L651-CODSERVI                 
002152        PERFORM L15-SELECT-SERVIZIO                               
002153           THRU L15-EX.                                           
002154     MOVE L651-DESSERVI          TO WPAG-DESSERVI  (WINDRIGA).    
002155     IF WCOM-CONTPROV NOT > SPACES                                
002156        MOVE L651-CONTPROV       TO WCOM-CONTPROV.                
002157     MOVE L651-ESENTIVA          TO WPAG-ESENTIVR  (WINDRIGA).    
002158     MOVE L653-UNMISURA          TO WPAG-UNMISURA  (WINDRIGA).    
002159     MOVE L653-QTAORDIN          TO WPAG-QTAORDIN  (WINDRIGA)     
002160                                    WPAG-QTAORDIN-O(WINDRIGA)     
002161     MOVE L653-PREZZORD          TO WPAG-PREZZORD-N(WINDRIGA)     
002162                                    WPAG-PREZZORD-O(WINDRIGA)     
002163     MOVE L653-PREZZORD          TO WS-PREZZOR9.                  
002164     PERFORM U99-VISUALIZZA-PREZZO                                
002165        THRU U99-EX.                                              
002166     MOVE WS-PREZZORX            TO WPAG-PREZZORD   (WINDRIGA)    
002167     MOVE L653-IMPORDIN          TO WPAG-IMPORDIN-N(WINDRIGA)     
002168                                    WPAG-IMPORDIN-O(WINDRIGA).    
002169     MOVE L653-IMPORDIN          TO WS-IMPORDI9.                  
002170     PERFORM U98-VISUALIZZA-IMPORTO                               
002171        THRU U98-EX                                               
002172     MOVE WS-IMPORDIX            TO WPAG-IMPORDIN   (WINDRIGA)    
002173     MOVE L653-CENCOSTD          TO WPAG-CENCOSTD  (WINDRIGA).    
002174     MOVE L653-CENCOSTA          TO WPAG-CENCOSTA  (WINDRIGA).    
002175     MOVE L653-NOTENOTE          TO WPAG-NOTENOTE  (WINDRIGA).    
002176     MOVE L652-DTEVAORD          TO WPAG-DTEVAORD  (WINDRIGA).    
002177     MOVE L652-AANUMFAT          TO WPAG-AANUMFAT  (WINDRIGA).    
002178     MOVE L653-RIFECLIE          TO WPAG-RIFECLIE  (WINDRIGA).    
002179     PERFORM L30-FETCH-POINTORDI                                  
002180        THRU L30-EX.                                              
002181 E17-EX. EXIT.                                                    
002182*----------------------------------------------------------------*
002183 E20-PAGINA-PRONTA.                                               
002184*----------------------------------------------------------------*
002185     IF WCOM-PAGILIST NOT > ZEROES                                
002186        GO TO E20-EX.                                             
002187     IF WPAGRICH < 1                                              
002188        MOVE 1                   TO WPAGRICH.                     
002189     IF WPAGRICH > WCOM-PAGIULTI                                  
002190        MOVE WCOM-PAGIULTI       TO WPAGRICH.                     
002191     MOVE WPAGRICH               TO WCOM-PAGIRICH.                
002192     MOVE WCOM-PAGIRICH          TO WNUMITEM                      
002193                                    LO20-MAPRPAGO.                
002194     MOVE WCOM-PAGIULTI          TO LO20-MAPPPAGO.                
002195     PERFORM E21-PULISCI-RIGHE                                    
002196        THRU E21-EX.                                              
002197     MOVE WPAGRICH               TO WCOM-PAGIRICH.                
002198     PERFORM R20-READQ-TS                                         
002199        THRU R20-EX.                                              
002200     PERFORM E22-SPOSTA-IN-MAPPA                                  
002201        THRU E22-EX                                               
002202             VARYING WINDRIGA FROM 1 BY 1                         
002203               UNTIL WINDRIGA > WNUMRIGA.                         
002204     IF WS-CTRLESEN-CODA = 'S'                                    
002205        PERFORM F70-CTRL-ESENTIVA-CODA                            
002206           THRU F70-EX.                                           
002207 E20-EX. EXIT.                                                    
002208*------------------------------------------------------------*    
002209 E21-PULISCI-RIGHE.                                               
002210*------------------------------------------------------------*    
002211      PERFORM VARYING WINDRIGA FROM 1 BY 1                        
002212        UNTIL WINDRIGA > WNUMRIGA                                 
002213            MOVE LOW-VALUE       TO LO20-RIGAO(WINDRIGA)          
002214      END-PERFORM.                                                
002215 E21-EX. EXIT.                                                    
002216*----------------------------------------------------------------*
002217 E22-SPOSTA-IN-MAPPA.                                             
002218*----------------------------------------------------------------*
002219     IF WPAG-CODSERVI (WINDRIGA) NOT > SPACES AND                 
002220        WPAG-RIFECLIE (WINDRIGA) NOT > SPACES                     
002221        GO TO E22-EX.                                             
002222     MOVE WPAG-OPERAZIO (WINDRIGA)  TO LO20-OPERAZIOO (WINDRIGA). 
002223     IF WPAG-OPERAZIO (WINDRIGA) = 'I'                            
002224        ADD 1                      TO WCOM-CONTOPER.              
002225     PERFORM E23-SPOSTA-CAMPI-IN-MAPPA                            
002226        THRU E23-EX.                                              
002227 E22-EX. EXIT.                                                    
002228*----------------------------------------------------------------*
002229 E23-SPOSTA-CAMPI-IN-MAPPA.                                       
002230*----------------------------------------------------------------*
002231     MOVE WPAG-CODSERVI (WINDRIGA)  TO LO20-CODSERVIO (WINDRIGA). 
002232     MOVE WPAG-DESSERVI (WINDRIGA)  TO LO20-DESSERVIO (WINDRIGA). 
002233     MOVE WPAG-UNMISURA (WINDRIGA)  TO LO20-UNMISURAO (WINDRIGA). 
002234     MOVE WPAG-CENCOSTD (WINDRIGA)  TO LO20-CENCOSTDO (WINDRIGA). 
002235     MOVE WPAG-CENCOSTA (WINDRIGA)  TO LO20-CENCOSTAO (WINDRIGA). 
002236     MOVE WPAG-ESENTIVR (WINDRIGA)  TO LO20-ESENTIVRO (WINDRIGA). 
002237     MOVE WPAG-NOTENOTE (WINDRIGA)  TO LO20-NOTENOTEO (WINDRIGA). 
002238     MOVE WPAG-RIFECLIE (WINDRIGA)  TO LO20-RIFECLIEO (WINDRIGA). 
002239     IF WPAG-QTAORDIN   (WINDRIGA) > ZEROES                       
002240        MOVE WPAG-QTAORDIN (WINDRIGA)                             
002241                                    TO LO20-QTAORDINO (WINDRIGA)  
002242     ELSE                                                         
002243        MOVE SPACES                 TO LO20-QTAORDINI (WINDRIGA). 
002244     IF WPAG-PREZZORD-N (WINDRIGA) > ZEROES                       
002245        MOVE WPAG-PREZZORD (WINDRIGA)                             
002246                                    TO LO20-PREZZORDI (WINDRIGA)  
002247     ELSE                                                         
002248        MOVE SPACES                 TO LO20-PREZZORDI (WINDRIGA). 
002249     IF WPAG-IMPORDIN-N (WINDRIGA) > ZEROES                       
002250        MOVE WPAG-IMPORDIN (WINDRIGA)                             
002251                                    TO LO20-IMPORDINI (WINDRIGA)  
002252     ELSE                                                         
002253        MOVE SPACES                 TO LO20-IMPORDINI (WINDRIGA). 
002254 E23-EX. EXIT.                                                    
002255*----------------------------------------------------------------*
002256 E30-INVIA-MAPPA.                                                 
002257*----------------------------------------------------------------*
002258     MOVE WCOM-DATAXXXX          TO LO20-MAPDATAO.                
002259     MOVE EIBTIME                TO LO20-MAPORAXO.                
002260     MOVE WCOM-PAGIRICH          TO LO20-MAPRPAGO.                
002261     IF WCOM-FLAGPRGM = 'I'                                       
002262        MOVE MESS-CODERROR       TO WS-CODERROR                   
002263        MOVE '02480'             TO MESS-CODERROR                 
002264        PERFORM U10-DECODIFICA-MESSAGGI                           
002265           THRU U10-EX                                            
002266        STRING '   ' MESS-MESSAGGI(1:21) '   '                    
002267             DELIMITED BY SIZE INTO LO20-TITOLOXXO                
002268        MOVE WS-CODERROR         TO MESS-CODERROR                 
002269     ELSE                                                         
002270        MOVE MESS-CODERROR       TO WS-CODERROR                   
002271        MOVE '02481'             TO MESS-CODERROR                 
002272        PERFORM U10-DECODIFICA-MESSAGGI                           
002273           THRU U10-EX                                            
002274        STRING ' ' MESS-MESSAGGI(1:25) ' '                        
002275             DELIMITED BY SIZE INTO LO20-TITOLOXXO                
002276        MOVE WS-CODERROR         TO MESS-CODERROR.                
002277     MOVE SPACES                 TO MESS-MSGERROR.                
002278     MOVE SPACES                 TO WS-CODERROR.                  
002279     PERFORM P00-PROTEGGI                                         
002280        THRU P00-EX.                                              
002281     IF NOT ERRORE                                                
002282        IF WCOM-CONTOPER = 0                                      
002283           IF WCOM-FLAGPRGM = 'I'                                 
002284              IF LO20-CODCLIENO > SPACES                          
002285                 MOVE -1            TO LO20-OPERAZIOL (1)         
002286              ELSE                                                
002287                 MOVE -1            TO LO20-CODCLIENL             
002288              END-IF                                              
002289           ELSE                                                   
002290              IF WCOM-SALDATOX > SPACES                           
002291                 MOVE -1            TO LO20-AANUMORDL             
002292              ELSE                                                
002293                 IF WCOM-FLAGAUTO = 'A'                           
002294                    MOVE -1         TO LO20-OPERAZIOL (1)         
002295                 ELSE                                             
002296                    MOVE -1         TO LO20-CODCLIENL             
002297                 END-IF                                           
002298              END-IF                                              
002299           END-IF                                                 
002300        ELSE                                                      
002301           MOVE -1                  TO LO20-OPERAZIOL (1).        
002302     IF MESS-CODERROR NOT > SPACES                                
002303        IF WCOM-CONTOPER = 0                                      
002304           IF WCOM-FLAGPRGM = 'I'                                 
002305              MOVE '00038'       TO MESS-CODERROR                 
002306           ELSE                                                   
002307              MOVE '00003'       TO MESS-CODERROR                 
002308           END-IF                                                 
002309        ELSE                                                      
002310           MOVE '00030'          TO MESS-CODERROR.                
002311     PERFORM U10-DECODIFICA-MESSAGGI                              
002312        THRU U10-EX.                                              
002313     MOVE MESS-MSGERROR          TO LO20-MESSAGGO.                
002314                                                                  
002315* EXEC CICS SEND MAPSET    ('AVMLO20')                            
002316*                   MAP       (WNOMEMAP)                          
002317*                   FROM      (AVILO20O)                          
002318*                   ERASE                                         
002319*                   CURSOR                                        
002320*                   END-EXEC.                                     
002321     MOVE LENGTH OF                                               
002322      AVILO20O                                                    
002323       TO DFHEIV12                                                
002324     MOVE -1                                                      
002325       TO DFHEIV11                                                
002326     MOVE 'AVMLO20' TO DFHEIV1                                    
002327*    MOVE '8$     CT  E      L F ,   #00002183' TO DFHEIV0        
002328     MOVE X'382420202020204354202045' &                           
002329          X'2020202020204C2046202C20' &                           
002330          X'2020233030303032313833' TO DFHEIV0                    
002331     CALL 'kxdfhei1' USING DFHEIV0,                               
002332           WNOMEMAP,                                              
002333           AVILO20O,                                              
002334           DFHEIV12,                                              
002335           DFHEIV1,                                               
002336           DFHEIV99,                                              
002337           DFHEIV99,                                              
002338           DFHEIV99,                                              
002339           DFHEIV11,                                              
002340           DFHEIV99,                                              
002341           DFHEIV99,                                              
002342           DFHEIV99                                               
002343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002344                                                                  
002345 E30-EX. EXIT.                                                    
002346*----------------------------------------------------------------*
002347 F00-CONTROLLI.                                                   
002348*----------------------------------------------------------------*
002349     MOVE WCOM-PAGIRICH          TO WNUMITEM.                     
002350     PERFORM R20-READQ-TS                                         
002351        THRU R20-EX.                                              
002352     MOVE 'C'                    TO WS-TIPOPERA                   
002353     MOVE 'C'                    TO WS-TIPOPERA-IVA.              
002354     IF LO20-SOSPESOXO NOT > ' '                                  
002355        IF WCOM-SALDATOX > SPACES                                 
002356           MOVE 'T'              TO WS-TIPOPERA                   
002357           MOVE 'T'              TO WS-TIPOPERA-IVA               
002358        ELSE                                                      
002359           IF WCOM-FLAGAUTO = 'A'                                 
002360              MOVE 'T'           TO WS-TIPOPERA                   
002361              MOVE 'C'           TO WS-TIPOPERA-IVA.              
002362     PERFORM F05-CTRL-DATI-TESTATA                                
002363        THRU F05-EX                                               
002364     IF ERRORE                                                    
002365        GO TO F00-EX.                                             
002366     MOVE WCOM-CONTOPER          TO WS-CONTOPER.                  
002367     PERFORM F06-CONTO-OPER                                       
002368        THRU F06-EX                                               
002369             VARYING WINDRIGA FROM 1 BY 1                         
002370               UNTIL WINDRIGA GREATER WNUMRIGA                    
002371                  OR ERRORE.                                      
002372     PERFORM F07-SALVA-TESTATA                                    
002373        THRU F07-EX                                               
002374     MOVE 1                      TO WLO20-ITEM                    
002375     PERFORM R40-REWRITE-WPAGLO20                                 
002376        THRU R40-EX                                               
002377*    CONTROLLO OPERAZIONE                                         
002378     MOVE SPACES                 TO WS-OPERAZIO.                  
002379     PERFORM F50-CTRL-OPERAZIONE                                  
002380        THRU F50-EX                                               
002381             VARYING WINDRIGA FROM 1 BY 1                         
002382               UNTIL WINDRIGA > WNUMRIGA                          
002383                  OR ERRORE.                                      
002384     IF ERRORE                                                    
002385        GO TO F00-EX.                                             
002386     PERFORM F55-CTRL-OPERAZIONE-CODA                             
002387        THRU F55-EX.                                              
002388     MOVE WS-OPERAZIO            TO WCOM-OPERAZIO.                
002389     IF ERRORE                                                    
002390        GO TO F00-EX.                                             
002391*    CONTROLLO RIGHE DETTAGLIO                                    
002392     PERFORM F60-CONTROLLO-RIGHE                                  
002393        THRU F60-EX                                               
002394             VARYING WINDRIGA FROM 1 BY 1                         
002395               UNTIL WINDRIGA > WNUMRIGA                          
002396                  OR ERRORE.                                      
002397     IF ERRORE                                                    
002398        GO TO F00-EX.                                             
002399     IF WCOM-FLAGPRGM   = 'I' AND                                 
002400        WS-OPERAZIO NOT = 'I'                                     
002401        CONTINUE                                                  
002402     ELSE                                                         
002403        PERFORM F40-CONTROLLO-CONTODCE                            
002404           THRU F40-EX.                                           
002405     IF ERRORE                                                    
002406        GO TO F00-EX.                                             
002407*    AGGANCIO PGM DI DETTAGLIO                                    
002408     IF WS-OPERAZIO = '*'                                         
002409        PERFORM F80-GESTIONE-AGGANCIO                             
002410           THRU F80-EX                                            
002411                VARYING WINDRIGA FROM 1 BY 1                      
002412                  UNTIL WINDRIGA > WNUMRIGA                       
002413                     OR ERRORE                                    
002414        IF ERRORE                                                 
002415           GO TO F00-EX.                                          
002416     MOVE WCOM-PAGIRICH          TO WNUMITEM.                     
002417     PERFORM R30-REWRITE-TS                                       
002418        THRU R30-EX.                                              
002419     IF WCOM-OPERAZIO = '?'                                       
002420        MOVE 'LO10'              TO WTRANSID                      
002421        PERFORM U05-START-TRANSID                                 
002422           THRU U05-EX.                                           
002423     MOVE WS-CONTOPER            TO WCOM-CONTOPER.                
002424     IF WCOM-CONTOPER = ZEROES                                    
002425        MOVE SPACES              TO WCOM-OPERAZIO.                
002426     PERFORM F70-CTRL-ESENTIVA-CODA                               
002427        THRU F70-EX                                               
002428     MOVE 'N'                    TO WS-CTRLESEN-CODA.             
002429     IF ERRORE                                                    
002430        GO TO F00-EX.                                             
002431     IF WCOM-CONTOPER NOT > ZEROES AND                            
002432        WCOM-FLAGPRGM = 'I'                                       
002433        MOVE '*'                 TO WSWERROR                      
002434        MOVE -1                  TO LO20-OPERAZIOL (1)            
002435        MOVE '00038'             TO MESS-CODERROR                 
002436        GO TO F00-EX.                                             
002437     IF WCOM-CONTOPER NOT > ZEROES AND                            
002438        WCOM-FLAGPRGM NOT = 'I'                                   
002439        IF WCOM-CODCLIEN NOT = LO20-CODCLIENI      OR             
002440           WCOM-TIPSERVI NOT = LO20-TIPSERVII      OR             
002441           WCOM-AAMMCOMP NOT = LO20-AAMMCOMPI      OR             
002442           WCOM-FLAGGIVA NOT = LO20-FLAGGIVAI      OR             
002443           WCOM-ESENTIVA NOT = LO20-ESENTIVAI      OR             
002444           WCOM-CONTODCE NOT = LO20-CONTODCEI      OR             
002445           WCOM-CODDIVIS NOT = LO20-CODDIVISI                     
002446           MOVE 1                TO WCOM-CONTOPER.                
002447 F00-EX. EXIT.                                                    
002448*----------------------------------------------------------------*
002449 F05-CTRL-DATI-TESTATA.                                           
002450*----------------------------------------------------------------*
002451*    CONTROLLO CLIENTE                                            
002452     INSPECT LO20-CODCLIENI REPLACING ALL LOW-VALUE BY SPACES.    
002453     IF WS-TIPOPERA = 'C'                                         
002454        IF LO20-CODCLIENI NOT > SPACES                            
002455           MOVE '*'              TO WSWERROR                      
002456           MOVE '00112'          TO MESS-CODERROR                 
002457           MOVE DFHUNIMD         TO LO20-CODCLIENA                
002458           MOVE DFHRED           TO LO20-CODCLIENC                
002459           MOVE -1               TO LO20-CODCLIENL                
002460           MOVE SPACES           TO LO20-NOMCLIENO                
002461           GO TO F05-EX.                                          
002462     PERFORM F15-CONTROLLO-CLIENTE                                
002463        THRU F15-EX.                                              
002464     IF ERRORE                                                    
002465        GO TO F05-EX.                                             
002466*    CONTROLLO SOCIETA'                                           
002467     INSPECT LO20-CODSOCIEI REPLACING ALL LOW-VALUE BY SPACES.    
002468     MOVE LO20-CODSOCIEI         TO A531-CODSOCIE.                
002469     PERFORM L00-SELECT-SOCIETA                                   
002470        THRU L00-EX.                                              
002471     MOVE A531-NOMSOCIE          TO LO20-NOMSOCIEO.               
002472*    CONTROLLO TIPO SERVIZIO                                      
002473     PERFORM F30-CONTROLLO-TIPSERVI                               
002474        THRU F30-EX.                                              
002475     IF ERRORE                                                    
002476        GO TO F05-EX.                                             
002477*    CONTROLLO FLAG IVA                                           
002478     PERFORM F31-CONTROLLO-FLAGGIVA                               
002479        THRU F31-EX.                                              
002480     IF ERRORE                                                    
002481        GO TO F05-EX.                                             
002482*    CONTROLLO DIVISA                                             
002483     PERFORM F35-CONTROLLO-DIVISA                                 
002484        THRU F35-EX.                                              
002485     IF ERRORE                                                    
002486        GO TO F05-EX.                                             
002487*    CONTROLLO ANNOMESE COMPETENZA                                
002488     PERFORM F37-CONTROLLO-COMPE                                  
002489        THRU F37-EX.                                              
002490     IF ERRORE                                                    
002491        GO TO F05-EX.                                             
002492 F05-EX. EXIT.                                                    
002493*----------------------------------------------------------------*
002494 F06-CONTO-OPER.                                                  
002495*----------------------------------------------------------------*
002496     INSPECT LO20-OPERAZIOI(WINDRIGA)                             
002497             REPLACING ALL LOW-VALUE BY SPACES.                   
002498     IF WPAG-OPERAZIO(WINDRIGA) > SPACES                          
002499        SUBTRACT 1                   FROM WS-CONTOPER.            
002500     IF LO20-OPERAZIOI(WINDRIGA) > SPACES                         
002501        ADD 1                          TO WS-CONTOPER.            
002502 F06-EX. EXIT.                                                    
002503*----------------------------------------------------------------*
002504 F07-SALVA-TESTATA.                                               
002505*----------------------------------------------------------------*
002506     MOVE LO20-CODCLIENO         TO WLO20-CODCLIEN                
002507     MOVE LO20-NOMCLIENO         TO WLO20-NOMCLIEN                
002508     MOVE LO20-FLAGGIVAO         TO WLO20-FLAGGIVA                
002509     MOVE LO20-ESENTIVAO         TO WLO20-ESENTIVA                
002510     MOVE LO20-AANUMORDO         TO WLO20-AANUMORD                
002511     MOVE LO20-DTCARORDO         TO WLO20-DTCARORD                
002512     MOVE LO20-TIPSERVIO         TO WLO20-TIPSERVI                
002513     MOVE LO20-AAMMCOMPO         TO WLO20-AAMMCOMP                
002514     MOVE LO20-DESTIPSEO         TO WLO20-DESTIPSE                
002515     MOVE LO20-CONTODCEO         TO WLO20-CONTODCE                
002516     MOVE LO20-DESCRDCEO         TO WLO20-DESCRDCE                
002517     MOVE LO20-CODDIVISO         TO WLO20-CODDIVIS                
002518     MOVE LO20-SIGLADIVO         TO WLO20-SIGLADIV                
002519     MOVE LO20-AANUMFATO         TO WLO20-AANUMFAT                
002520     MOVE LO20-DTFATTURO         TO WLO20-DTFATTUR                
002521     MOVE LO20-NRPREATTO         TO WLO20-NRPREATT                
002522     MOVE LO20-DTPREATTO         TO WLO20-DTPREATT                
002523     MOVE LO20-FLAGAUTOO         TO WLO20-FLAGAUTO                
002524     MOVE LO20-MESSWARNO         TO WLO20-MESSWARN.               
002525     MOVE LO20-CODCONSOO         TO WLO20-CODCONSO.               
002526 F07-EX. EXIT.                                                    
002527*----------------------------------------------------------------*
002528 F15-CONTROLLO-CLIENTE.                                           
002529*----------------------------------------------------------------*
002530     MOVE 5                      TO WLENGTH.                      
002531     CALL WWTWSNU USING WLENGTH                                   
002532                        LO20-CODCLIENI.                           
002533     MOVE LO20-CODCLIENI         TO A901-CODCLIEN.                
002534     PERFORM L40-LEGGI-CLIENTE                                    
002535        THRU L40-EX.                                              
002536     IF WS-TIPOPERA = 'C'                                         
002537        IF SQLCODE NOT = 0                                        
002538           MOVE '*'              TO WSWERROR                      
002539           MOVE '00112'          TO MESS-CODERROR                 
002540           MOVE DFHUNIMD         TO LO20-CODCLIENA                
002541           MOVE DFHRED           TO LO20-CODCLIENC                
002542           MOVE -1               TO LO20-CODCLIENL                
002543           MOVE SPACES           TO LO20-NOMCLIENO                
002544           GO TO F15-EX.                                          
002545     IF WS-TIPOPERA = 'C'                                         
002546        IF A901-GENECLIE = 'M' AND                                
002547           A901-CLIEFATT > SPACES                                 
002548           MOVE '*'              TO WSWERROR                      
002549           MOVE '00806'          TO MESS-CODERROR                 
002550           MOVE DFHUNIMD         TO LO20-CODCLIENA                
002551           MOVE DFHRED           TO LO20-CODCLIENC                
002552           MOVE -1               TO LO20-CODCLIENL                
002553           GO TO F15-EX.                                          
002554     IF WS-TIPOPERA = 'C'                                         
002555        IF A901-STATCLIE NOT = 'T' AND 'S'                        
002556           MOVE '*'              TO WSWERROR                      
002557           MOVE '00541'          TO MESS-CODERROR                 
002558           MOVE DFHUNIMD         TO LO20-CODCLIENA                
002559           MOVE DFHRED           TO LO20-CODCLIENC                
002560           MOVE -1               TO LO20-CODCLIENL                
002561           GO TO F15-EX.                                          
002562     IF WS-TIPOPERA = 'C'                                         
002563        MOVE A901-CODSOCIE       TO LO20-CODSOCIEO                
002564        MOVE A901-CODSOCIE       TO WCOM-CODSOCIE                 
002565        MOVE 'A'                 TO LO20-CDDIVISII                
002566        IF WCOM-CODSOCIE = '09' OR '24' OR '25'                   
002567           MOVE 'T'              TO LO20-CDDIVISII                
002568        ELSE                                                      
002569           IF WCOM-CODSOCIE = '16'                                
002570              MOVE 'V'           TO LO20-CDDIVISII.               
002571        MOVE LO20-CDDIVISII      TO WCOM-CDDIVISI.                
002572     IF A901-RAGFATTU > SPACES                                    
002573        MOVE A901-RAGFATTU       TO LO20-NOMCLIENO                
002574     ELSE                                                         
002575        MOVE A901-RAGMERCE       TO LO20-NOMCLIENO.               
002576     MOVE SPACES                 TO WS-CODSOCIE.                  
002577     IF A901-CLIFOCON > SPACES AND                                
002578        A901-TIPOCONS > SPACES                                    
002579        MOVE A901-CLIFOCON       TO A531-CODFORNI                 
002580        PERFORM L95-SELECT-CLIFOCON                               
002581           THRU L95-EX                                            
002582        IF WS-TIPOPERA = 'C' AND                                  
002583           SQLCODE = 100                                          
002584           MOVE DFHUNIMD         TO LO20-CENCOSTAA(WINDRIGA)      
002585           MOVE DFHRED           TO LO20-CENCOSTAC(WINDRIGA)      
002586           MOVE -1               TO LO20-CENCOSTAL(WINDRIGA)      
002587           MOVE '*'              TO WSWERROR                      
002588           MOVE '00759'          TO MESS-CODERROR                 
002589           GO TO F15-EX.                                          
002590     IF WS-CODSOCIE NOT > SPACES                                  
002591        MOVE LO20-CODSOCIEI     TO WS-CODSOCIE.                   
002592     MOVE WS-CODSOCIE           TO WS-CODSOCI1                    
002593     IF WS-CODSOCI1 = '08'                                        
002594        MOVE '16'               TO WS-CODSOCI1                    
002595     ELSE                                                         
002596        IF A901-TIPOCONS = 'T'                                    
002597           MOVE '15'            TO WS-CODSOCI1.                   
002598     MOVE WS-CODSOCI1           TO LO20-CODCONSOO.                
002599 F15-EX. EXIT.                                                    
002600*----------------------------------------------------------------*
002601 F30-CONTROLLO-TIPSERVI.                                          
002602*----------------------------------------------------------------*
002603     INSPECT LO20-TIPSERVII                                       
002604             REPLACING ALL LOW-VALUE BY SPACES.                   
002605     IF WCOM-MENUTRAN(1) NOT = 'LOGI'                             
002606        IF LO20-TIPSERVII NOT = 'L'                               
002607           MOVE 'L'              TO LO20-TIPSERVII                
002608        END-IF                                                    
002609     ELSE                                                         
002610        IF WS-TIPOPERA = 'C'                                      
002611           IF LO20-TIPSERVII NOT > SPACES                         
002612              MOVE 'M'           TO LO20-TIPSERVII                
002613           ELSE                                                   
002614              IF LO20-TIPSERVII NOT = 'T' AND 'M'                 
002615                 MOVE '*'        TO WSWERROR                      
002616                 MOVE DFHUNIMD   TO LO20-TIPSERVIA                
002617                 MOVE DFHRED     TO LO20-TIPSERVIC                
002618                 MOVE -1         TO LO20-TIPSERVIL                
002619                 MOVE '01678'    TO MESS-CODERROR                 
002620                 GO TO F30-EX.                                    
002621     IF LO20-TIPSERVII = 'T'                                      
002622        MOVE MESS-CODERROR       TO WS-CODERROR                   
002623        MOVE '02476'             TO MESS-CODERROR                 
002624        PERFORM U10-DECODIFICA-MESSAGGI                           
002625           THRU U10-EX                                            
002626        MOVE MESS-MESSAGGI       TO LO20-DESTIPSEO                
002627        MOVE WS-CODERROR         TO MESS-CODERROR                 
002628     ELSE                                                         
002629        IF LO20-TIPSERVII = 'M'                                   
002630           MOVE MESS-CODERROR    TO WS-CODERROR                   
002631           MOVE '02477'          TO MESS-CODERROR                 
002632           PERFORM U10-DECODIFICA-MESSAGGI                        
002633              THRU U10-EX                                         
002634           MOVE MESS-MESSAGGI    TO LO20-DESTIPSEO                
002635           MOVE WS-CODERROR      TO MESS-CODERROR                 
002636        ELSE                                                      
002637           IF LO20-TIPSERVII = 'L'                                
002638              MOVE MESS-CODERROR    TO WS-CODERROR                
002639              MOVE '02733'          TO MESS-CODERROR              
002640              PERFORM U10-DECODIFICA-MESSAGGI                     
002641                 THRU U10-EX                                      
002642              MOVE MESS-MESSAGGI    TO LO20-DESTIPSEO             
002643              MOVE WS-CODERROR      TO MESS-CODERROR.             
002644     MOVE SPACES                 TO MESS-MSGERROR.                
002645     MOVE SPACES                 TO WS-CODERROR.                  
002646 F30-EX. EXIT.                                                    
002647*----------------------------------------------------------------*
002648 F31-CONTROLLO-FLAGGIVA.                                          
002649*----------------------------------------------------------------*
002650     INSPECT LO20-FLAGGIVAI REPLACING ALL LOW-VALUE BY SPACES.    
002651     INSPECT LO20-ESENTIVAI REPLACING ALL LOW-VALUE BY SPACES.    
002652*    IF LO20-TIPSERVIO = 'L' AND                                  
002653     IF WS-TIPOPERA-IVA = 'C'                                     
002654        IF A901-ESENTIVA = '1' AND                                
002655           A531-CODPAESE = '000' AND                              
002656           A901-PAESFATT = '000'                                  
002657           MOVE '1'                   TO LO20-ESENTIVAO           
002658        ELSE                                                      
002659           MOVE SPACES                TO DCNMFA                   
002660           INITIALIZE                    DCNMFA                   
002661           MOVE A531-CODPAESE         TO NMFA-PAESOCIE            
002662           MOVE LO20-CODSOCIEO        TO NMFA-CODSOCIE            
002663           MOVE A901-PAESMERC         TO NMFA-PAEMERCE            
002664           MOVE A901-PAESFATT         TO NMFA-PAEFATTU            
002665           MOVE A901-CDIVACEE         TO NMFA-CDIVACEE            
002666           MOVE LO20-CODCLIENI        TO NMFA-CODCLIEN            
002667           PERFORM W10-SCTNMFA                                    
002668              THRU W10-EX                                         
002669           IF NMFA-FLAGGIVA  EQUAL 'S'                            
002670              MOVE 'S'                TO LO20-FLAGGIVAO           
002671           ELSE                                                   
002672              MOVE 'N'                TO LO20-FLAGGIVAO.          
002673     IF WS-TIPOPERA-IVA = 'C'                                     
002674        IF LO20-FLAGGIVAI NOT > SPACES                            
002675           IF LO20-ESENTIVAI > SPACES                             
002676              MOVE 'N'           TO LO20-FLAGGIVAI                
002677           ELSE                                                   
002678              MOVE 'S'           TO LO20-FLAGGIVAI.               
002679     IF WS-TIPOPERA-IVA = 'C'                                     
002680        IF LO20-FLAGGIVAI NOT = 'S' AND 'N'                       
002681           MOVE '*'              TO WSWERROR                      
002682           MOVE '02483'          TO MESS-CODERROR                 
002683           MOVE DFHUNDLN         TO LO20-FLAGGIVAH                
002684           MOVE DFHUNIMD         TO LO20-FLAGGIVAA                
002685           MOVE DFHRED           TO LO20-FLAGGIVAC                
002686           MOVE -1               TO LO20-FLAGGIVAL                
002687           GO TO F31-EX.                                          
002688     IF WS-TIPOPERA-IVA = 'C'                                     
002689        IF LO20-FLAGGIVAI     = 'S' AND                           
002690           A901-PAESFATT  NOT = '000'                             
002691           MOVE '*'              TO WSWERROR                      
002692           MOVE '02483'          TO MESS-CODERROR                 
002693           MOVE DFHUNDLN         TO LO20-FLAGGIVAH                
002694           MOVE DFHUNIMD         TO LO20-FLAGGIVAA                
002695           MOVE DFHRED           TO LO20-FLAGGIVAC                
002696           MOVE -1               TO LO20-FLAGGIVAL                
002697           GO TO F31-EX.                                          
002698*    CONTROLLO CONGRUENZA TRA FLAG IVA (S/N) E CODICE ESENZIONE   
002699*    SOLO PER GESTIONE VARIAZIONE                                 
002700     IF WS-TIPOPERA-IVA = 'C'   AND                               
002701        WCOM-FLAGPRGM NOT = 'I' AND                               
002702        LO20-FLAGGIVAI = 'S'    AND                               
002703        LO20-ESENTIVAI > SPACES                                   
002704        MOVE '*'                 TO WSWERROR                      
002705        MOVE '02620'             TO MESS-CODERROR                 
002706        MOVE DFHUNDLN            TO LO20-FLAGGIVAH                
002707        MOVE DFHUNIMD            TO LO20-FLAGGIVAA                
002708        MOVE DFHRED              TO LO20-FLAGGIVAC                
002709        MOVE -1                  TO LO20-FLAGGIVAL                
002710        MOVE DFHPROIM            TO LO20-ESENTIVAA                
002711        MOVE DFHRED              TO LO20-ESENTIVAC                
002712        GO TO F31-EX.                                             
002713 F31-EX. EXIT.                                                    
002714*----------------------------------------------------------------*
002715 F35-CONTROLLO-DIVISA.                                            
002716*----------------------------------------------------------------*
002717     INSPECT LO20-CODDIVISI                                       
002718             REPLACING ALL LOW-VALUE BY SPACES.                   
002719     IF WS-TIPOPERA = 'C'                                         
002720        IF LO20-CODDIVISI NOT > SPACES                            
002721           MOVE A901-CODDIVIS    TO LO20-CODDIVISO.               
002722     IF LO20-CODDIVISI > SPACES                                   
002723        IF LO20-CODDIVISI NOT = A901-CODDIVIS                     
002724           MOVE MESS-CODERROR    TO WS-CODERROR                   
002725           MOVE '02484'          TO MESS-CODERROR                 
002726           PERFORM U10-DECODIFICA-MESSAGGI                        
002727              THRU U10-EX                                         
002728           MOVE MESS-MESSAGGI    TO LO20-MESSWARNO                
002729           MOVE WS-CODERROR      TO MESS-CODERROR                 
002730           MOVE SPACES           TO MESS-MSGERROR                 
002731           MOVE SPACES           TO WS-CODERROR                   
002732        ELSE                                                      
002733           MOVE LOW-VALUE        TO LO20-MESSWARNO.               
002734     MOVE LO20-CODDIVISI         TO A963-CODDIVIS.                
002735     MOVE LO20-CODSOCIEI         TO A531-CODSOCIE.                
002736     PERFORM L16-SELECT-DIVISE                                    
002737        THRU L16-EX.                                              
002738     IF WS-TIPOPERA = 'C'                                         
002739        IF SQLCODE = 100                                          
002740           MOVE '*'              TO WSWERROR                      
002741           MOVE '00117'          TO MESS-CODERROR                 
002742           MOVE DFHUNIMD         TO LO20-CODDIVISA                
002743           MOVE DFHRED           TO LO20-CODDIVISC                
002744           MOVE -1               TO LO20-CODDIVISL                
002745           GO TO F35-EX.                                          
002746     MOVE A963-SIGLADIV          TO LO20-SIGLADIVO.               
002747     MOVE A963-DECIDIVI          TO WCOM-DECIDIVI.                
002748 F35-EX. EXIT.                                                    
002749*----------------------------------------------------------------*
002750 F37-CONTROLLO-COMPE.                                             
002751*----------------------------------------------------------------*
002752     INSPECT LO20-AAMMCOMPI                                       
002753             REPLACING ALL LOW-VALUE BY SPACES.                   
002754     MOVE LO20-AAMMCOMPI         TO WS-ANNOMESE                   
002755     PERFORM L05-SELECT-DATARIO                                   
002756        THRU L05-EX                                               
002757     IF A973-DTGIORNO NOT > ' '                                   
002758        MOVE '*'                 TO WSWERROR                      
002759        MOVE '00006'             TO MESS-CODERROR                 
002760        MOVE DFHUNIMD            TO LO20-AAMMCOMPA                
002761        MOVE DFHRED              TO LO20-AAMMCOMPC                
002762        MOVE -1                  TO LO20-AAMMCOMPL                
002763        GO TO F37-EX.                                             
002764 F37-EX. EXIT.                                                    
002765*------------------------------------------------------------*    
002766 F40-CONTROLLO-CONTODCE.                                          
002767*------------------------------------------------------------*    
002768*    IL CONTODCE DEVE ESSERE DIGITATO SOLO PER LE CONSOCIATE.     
002769*    PERO' ANDREBBE IN DUMP IL PGM CHE CARICA LA FATTURA          
002770*    CHE CONTROLLA L'ESISTENZA DEL CONTODCE E PER NON TROVATO     
002771*    VA IN ERRORE (AVALO90-L95).                                  
002772     INSPECT LO20-CONTODCEI                                       
002773             REPLACING ALL LOW-VALUE BY SPACES.                   
002774*    IF A901-TIPOCONS > SPACES AND                                
002775*       A901-CLIFOCON > SPACES                                    
002776*       CONTINUE                                                  
002777*    ELSE                                                         
002778*       MOVE SPACES              TO LO20-CONTODCEI                
002779*       GO TO F40-EX.                                             
002780     MOVE SPACES                 TO LO20-DESCRDCEO.               
002781*    IF WS-TIPOPERA        = 'C' AND                              
002782*       LO20-TIPSERVII     = 'M' AND                              
002783*       MOVE 'MAGAXX'            TO C861-CONTPROV                 
002784*       MOVE WS-CODSOCIE         TO A531-CODSOCIE                 
002785*       PERFORM L70-SELECT-CONTPROV                               
002786*          THRU L70-EX                                            
002787*       MOVE C861-CONTODCE       TO LO20-CONTODCEO.               
002788     IF WS-TIPOPERA = 'C'                                         
002789        IF LO20-CONTODCEI NOT > SPACES                            
002790           MOVE '00213'          TO MESS-CODERROR                 
002791           MOVE '*'              TO WSWERROR                      
002792           MOVE -1               TO LO20-CONTODCEL                
002793           MOVE DFHUNIMD         TO LO20-CONTODCEA                
002794           MOVE DFHRED           TO LO20-CONTODCEC                
002795           GO TO F40-EX.                                          
002796     MOVE LO20-CONTODCEI         TO C861-CONTODCE                 
002797     MOVE WS-CODSOCIE            TO A531-CODSOCIE                 
002798     PERFORM L71-SELECT-CONTODCE                                  
002799        THRU L71-EX                                               
002800     IF WS-TIPOPERA = 'C'                                         
002801        IF SQLCODE = +100                              OR         
002802          (LO20-TIPSERVII    = 'T'                     AND        
002803          (C861-CONTPROV NOT = 'TRASXX' AND 'TRASAC')) OR         
002804          (LO20-TIPSERVII    = 'M'                     AND        
002805           C861-CONTPROV(1:4) NOT = 'MAGA')            OR         
002806          (LO20-CODCLIENO         = '33020'            AND        
002807           C861-CONTODCE(1:1) NOT = 'G')               OR         
002808          (LO20-CODCLIENO     NOT = '33020'            AND        
002809           C861-CONTODCE(1:1)     = 'G')                          
002810           MOVE '*'              TO WSWERROR                      
002811           MOVE -1               TO LO20-CONTODCEL                
002812           MOVE DFHUNIMD         TO LO20-CONTODCEA                
002813           MOVE DFHRED           TO LO20-CONTODCEC                
002814           MOVE '00213'          TO MESS-CODERROR                 
002815           GO TO F40-EX.                                          
002816     MOVE C861-DESCRDCE          TO LO20-DESCRDCEO.               
002817 F40-EX. EXIT.                                                    
002818*----------------------------------------------------------------*
002819 F50-CTRL-OPERAZIONE.                                             
002820*----------------------------------------------------------------*
002821     INSPECT LO20-OPERAZIOI (WINDRIGA)                            
002822             REPLACING ALL LOW-VALUE BY SPACES.                   
002823     IF LO20-OPERAZIOI (WINDRIGA) NOT > SPACES                    
002824        GO TO F50-EX.                                             
002825     IF LO20-OPERAZIOI (WINDRIGA) NOT EQUAL 'I' AND '/' AND       
002826                                            'V' AND '*' AND 'K'   
002827        MOVE '*'                 TO WSWERROR                      
002828        MOVE '00004'             TO MESS-CODERROR                 
002829        MOVE DFHUNIMD            TO LO20-OPERAZIOA(WINDRIGA)      
002830        MOVE DFHRED              TO LO20-OPERAZIOC(WINDRIGA)      
002831        MOVE -1                  TO LO20-OPERAZIOL(WINDRIGA)      
002832        GO TO F50-EX.                                             
002833     IF LO20-OPERAZIOI (WINDRIGA) EQUAL 'I'                       
002834        IF WCOM-AANUMORD > SPACES AND                             
002835           WPAG-NRRIGORD(WINDRIGA) > ZEROES                       
002836           MOVE '*'              TO WSWERROR                      
002837           MOVE '00004'          TO MESS-CODERROR                 
002838           MOVE DFHUNIMD         TO LO20-OPERAZIOA(WINDRIGA)      
002839           MOVE DFHRED           TO LO20-OPERAZIOC(WINDRIGA)      
002840           MOVE -1               TO LO20-OPERAZIOL(WINDRIGA)      
002841           GO TO F50-EX.                                          
002842     IF LO20-OPERAZIOI (WINDRIGA) EQUAL 'V' OR '/' OR '*' OR 'K'  
002843        IF WCOM-AANUMORD NOT > SPACES OR                          
002844           WPAG-NRRIGORD (WINDRIGA) NOT > ZEROES                  
002845           MOVE '*'              TO WSWERROR                      
002846           MOVE '00004'          TO MESS-CODERROR                 
002847           MOVE DFHUNIMD         TO LO20-OPERAZIOA(WINDRIGA)      
002848           MOVE DFHRED           TO LO20-OPERAZIOC(WINDRIGA)      
002849           MOVE -1               TO LO20-OPERAZIOL(WINDRIGA)      
002850           GO TO F50-EX.                                          
002851     IF WPAG-DTEVAORD (WINDRIGA) > SPACES OR                      
002852        WPAG-AANUMFAT (WINDRIGA) > SPACES OR                      
002853        WCOM-SALDATOX > SPACES                                    
002854        IF LO20-OPERAZIOI (WINDRIGA) EQUAL 'V' OR 'I' OR 'K'      
002855           MOVE '*'              TO WSWERROR                      
002856           MOVE '02489'          TO MESS-CODERROR                 
002857           MOVE DFHUNIMD         TO LO20-OPERAZIOA(WINDRIGA)      
002858           MOVE DFHRED           TO LO20-OPERAZIOC(WINDRIGA)      
002859           MOVE -1               TO LO20-OPERAZIOL(WINDRIGA)      
002860           GO TO F50-EX                                           
002861        ELSE                                                      
002862           IF LO20-OPERAZIOI (WINDRIGA) EQUAL '/'                 
002863              MOVE '*'           TO WSWERROR                      
002864              MOVE '02486'       TO MESS-CODERROR                 
002865              MOVE DFHUNIMD      TO LO20-OPERAZIOA(WINDRIGA)      
002866              MOVE DFHRED        TO LO20-OPERAZIOC(WINDRIGA)      
002867              MOVE -1            TO LO20-OPERAZIOL(WINDRIGA)      
002868              GO TO F50-EX.                                       
002869 F50-EX. EXIT.                                                    
002870*----------------------------------------------------------------*
002871 F55-CTRL-OPERAZIONE-CODA.                                        
002872*----------------------------------------------------------------*
002873     MOVE 1                     TO WNUMITEM                       
002874     PERFORM R20-READQ-TS                                         
002875        THRU R20-EX.                                              
002876     PERFORM F551-SCORRI-TS-OPER                                  
002877        THRU F551-EX                                              
002878             UNTIL EOQ = 'S'.                                     
002879*    RILEGGE LA TS DELLA PAGINA VISUALIZZATA                      
002880     MOVE WCOM-PAGIRICH          TO WNUMITEM.                     
002881     PERFORM R20-READQ-TS                                         
002882        THRU R20-EX.                                              
002883 F55-EX. EXIT.                                                    
002884*----------------------------------------------------------------*
002885 F551-SCORRI-TS-OPER.                                             
002886*----------------------------------------------------------------*
002887     PERFORM F552-SCORRI-RIGA-OPER                                
002888        THRU F552-EX                                              
002889             VARYING WINDRIGA FROM 1 BY 1                         
002890               UNTIL WINDRIGA > WNUMRIGA.                         
002891     ADD 1                       TO WNUMITEM.                     
002892     PERFORM R20-READQ-TS                                         
002893        THRU R20-EX.                                              
002894 F551-EX. EXIT.                                                   
002895*----------------------------------------------------------------*
002896 F552-SCORRI-RIGA-OPER.                                           
002897*----------------------------------------------------------------*
002898     IF WCOM-PAGIRICH = WNUMITEM                                  
002899        IF LO20-OPERAZIOI(WINDRIGA) NOT > SPACES                  
002900           GO TO F552-EX                                          
002901        END-IF                                                    
002902     ELSE                                                         
002903        IF WPAG-OPERAZIO (WINDRIGA) NOT > SPACES                  
002904           GO TO F552-EX.                                         
002905     IF WS-OPERAZIO NOT GREATER SPACES                            
002906        IF WCOM-PAGIRICH = WNUMITEM                               
002907           MOVE LO20-OPERAZIOI(WINDRIGA) TO WS-OPERAZIO           
002908        ELSE                                                      
002909           MOVE WPAG-OPERAZIO (WINDRIGA) TO WS-OPERAZIO           
002910        END-IF                                                    
002911     ELSE                                                         
002912        IF WCOM-PAGIRICH = WNUMITEM                               
002913           IF WS-OPERAZIO NOT = LO20-OPERAZIOI (WINDRIGA) OR      
002914             (LO20-OPERAZIOI (WINDRIGA) = '*' AND                 
002915              WS-OPERAZIO               = '*')                    
002916              MOVE '*'           TO WSWERROR                      
002917              MOVE '00037'       TO MESS-CODERROR                 
002918              MOVE DFHUNIMD      TO LO20-OPERAZIOA (WINDRIGA)     
002919              MOVE DFHRED        TO LO20-OPERAZIOC (WINDRIGA)     
002920              MOVE -1            TO LO20-OPERAZIOL (WINDRIGA)     
002921              GO TO F552-EX                                       
002922           END-IF                                                 
002923        ELSE                                                      
002924           IF WS-OPERAZIO NOT = WPAG-OPERAZIO (WINDRIGA) OR       
002925             (WPAG-OPERAZIO (WINDRIGA) = '*' AND                  
002926              WS-OPERAZIO              = '*')                     
002927              MOVE '*'           TO WSWERROR                      
002928              MOVE '00037'       TO MESS-CODERROR                 
002929              MOVE -1            TO LO20-CODCLIENL.               
002930 F552-EX. EXIT.                                                   
002931*----------------------------------------------------------------*
002932 F60-CONTROLLO-RIGHE.                                             
002933*----------------------------------------------------------------*
002934     IF LO20-OPERAZIOI (WINDRIGA) NOT > SPACES                    
002935        IF WCOM-FLAGPRGM = 'I'                                    
002936           MOVE SPACES           TO WPAG-ELEMRIGA (WINDRIGA)      
002937           INITIALIZE WPAG-ELEMRIGA (WINDRIGA)                    
002938           MOVE LOW-VALUE        TO LO20-RIGAO(WINDRIGA)          
002939        ELSE                                                      
002940           IF WPAG-OPERAZIO(WINDRIGA) = 'I'                       
002941              MOVE SPACES        TO WPAG-ELEMRIGA (WINDRIGA)      
002942              INITIALIZE WPAG-ELEMRIGA (WINDRIGA)                 
002943              MOVE LOW-VALUE     TO LO20-RIGAO(WINDRIGA)          
002944           ELSE                                                   
002945              PERFORM E23-SPOSTA-CAMPI-IN-MAPPA                   
002946                 THRU E23-EX                                      
002947           END-IF                                                 
002948        END-IF                                                    
002949        MOVE LO20-OPERAZIOI(WINDRIGA) TO WPAG-OPERAZIO(WINDRIGA)  
002950        GO TO F60-EX.                                             
002951     IF LO20-OPERAZIOI (WINDRIGA) = '/' OR '*'                    
002952        PERFORM E23-SPOSTA-CAMPI-IN-MAPPA                         
002953           THRU E23-EX                                            
002954        MOVE LO20-OPERAZIOI(WINDRIGA) TO WPAG-OPERAZIO(WINDRIGA)  
002955        GO TO F60-EX.                                             
002956     PERFORM F601-CTRL-SERVIZIO                                   
002957        THRU F601-EX.                                             
002958     IF ERRORE OR                                                 
002959        WCOM-OPERAZIO = '?'                                       
002960        GO TO F60-EX.                                             
002961     PERFORM F602-CTRL-QUANTITA                                   
002962        THRU F602-EX.                                             
002963     IF ERRORE                                                    
002964         GO TO F60-EX.                                            
002965     PERFORM F603-CTRL-DATI-NUM                                   
002966        THRU F603-EX.                                             
002967     IF ERRORE                                                    
002968         GO TO F60-EX.                                            
002969     PERFORM F604-CTRL-PREZZO                                     
002970        THRU F604-EX.                                             
002971     IF ERRORE                                                    
002972         GO TO F60-EX.                                            
002973     PERFORM F605-CTRL-IMPORTO                                    
002974        THRU F605-EX.                                             
002975     IF ERRORE                                                    
002976         GO TO F60-EX.                                            
002977     PERFORM F606-CTRL-E-CALCOLA                                  
002978        THRU F606-EX.                                             
002979     IF ERRORE                                                    
002980         GO TO F60-EX.                                            
002981     PERFORM F607-CTRL-CENCOSTD                                   
002982        THRU F607-EX.                                             
002983     IF ERRORE                                                    
002984         GO TO F60-EX.                                            
002985     PERFORM F608-CTRL-CENCOSTA                                   
002986        THRU F608-EX.                                             
002987     IF ERRORE                                                    
002988         GO TO F60-EX.                                            
002989     INSPECT LO20-NOTENOTEI (WINDRIGA)                            
002990             REPLACING ALL LOW-VALUE BY SPACES.                   
002991     MOVE LO20-NOTENOTEI (WINDRIGA) TO WPAG-NOTENOTE (WINDRIGA).  
002992     MOVE LO20-OPERAZIOI (WINDRIGA) TO WPAG-OPERAZIO (WINDRIGA).  
002993 F60-EX. EXIT.                                                    
002994*----------------------------------------------------------------*
002995 F601-CTRL-SERVIZIO.                                              
002996*----------------------------------------------------------------*
002997     INSPECT LO20-CODSERVII(WINDRIGA)                             
002998             REPLACING ALL LOW-VALUE BY SPACES.                   
002999     IF LO20-CODSERVII(WINDRIGA) NOT > SPACES                     
003000        MOVE '*'                   TO WSWERROR                    
003001        MOVE '02478'               TO MESS-CODERROR               
003002        MOVE  DFHUNIMD             TO LO20-CODSERVIA (WINDRIGA)   
003003        MOVE  DFHRED               TO LO20-CODSERVIC (WINDRIGA)   
003004        MOVE  -1                   TO LO20-CODSERVIL (WINDRIGA)   
003005        MOVE SPACES                TO LO20-DESSERVIO (WINDRIGA)   
003006        GO TO F601-EX.                                            
003007     IF LO20-CODSERVII(WINDRIGA)(1:1) = '?' AND                   
003008        LO20-OPERAZIOI(WINDRIGA) = 'I'                            
003009        COMPUTE WLO20-WNUMRIGA = (WLO20-WNUMRIGA - WINDRIGA) + 1  
003010        MOVE 1                     TO WLO20-ITEM                  
003011        PERFORM R40-REWRITE-WPAGLO20                              
003012           THRU R40-EX                                            
003013        MOVE WCOM-PAGIRICH         TO WCOM-PAGITRAN(WCOM-INDITRAN)
003014        PERFORM SCRIVO-RICICLO                                    
003015           THRU SCRIVO-RICICLO-EX                                 
003016        MOVE '?'                   TO WS-OPERAZIO                 
003017        MOVE '?'                   TO WCOM-OPERAZIO               
003018        GO TO F601-EX.                                            
003019     MOVE LO20-CODSERVII(WINDRIGA) TO L651-CODSERVI.              
003020     PERFORM L15-SELECT-SERVIZIO                                  
003021        THRU L15-EX.                                              
003022     IF SQLCODE = +100                                            
003023        MOVE '*'                   TO WSWERROR                    
003024        MOVE '02478'               TO MESS-CODERROR               
003025        MOVE  DFHUNIMD             TO LO20-CODSERVIA (WINDRIGA)   
003026        MOVE  DFHRED               TO LO20-CODSERVIC (WINDRIGA)   
003027        MOVE  -1                   TO LO20-CODSERVIL (WINDRIGA)   
003028        MOVE SPACES                TO LO20-DESSERVIO (WINDRIGA)   
003029        GO TO F601-EX.                                            
003030     IF L651-TIPSERVI NOT = LO20-TIPSERVII                        
003031        MOVE '*'                   TO WSWERROR                    
003032        MOVE '02479'               TO MESS-CODERROR               
003033        MOVE  DFHUNIMD             TO LO20-CODSERVIA (WINDRIGA)   
003034        MOVE  DFHRED               TO LO20-CODSERVIC (WINDRIGA)   
003035        MOVE  -1                   TO LO20-CODSERVIL (WINDRIGA)   
003036        GO TO F601-EX.                                            
003037     IF WCOM-FLAGPRGM = 'I'                                       
003038        IF WCOM-CONTPROV NOT > SPACES                             
003039           MOVE L651-CONTPROV      TO WCOM-CONTPROV.              
003040     IF L651-CONTPROV NOT = WCOM-CONTPROV                         
003041        MOVE '*'                   TO WSWERROR                    
003042        MOVE '02734'               TO MESS-CODERROR               
003043        MOVE DFHUNIMD              TO LO20-CODSERVIA (WINDRIGA)   
003044        MOVE DFHRED                TO LO20-CODSERVIC (WINDRIGA)   
003045        MOVE -1                    TO LO20-CODSERVIL (WINDRIGA)   
003046        GO TO F601-EX.                                            
003047     IF LO20-CONTODCEI                NOT > ' ' AND               
003048        LO20-TIPSERVII                    = 'M' AND               
003049        LO20-CODSERVII(WINDRIGA)(1:2)     = '16'                  
003050        MOVE L651-CONTODCD         TO LO20-CONTODCEO              
003051     END-IF                                                       
003052*    SE SIAMO IN INSERIMENTO,                                     
003053*    SALVO IL CODICE ESENZIONE DEL PRIMO SERVIZIO PER IMPOSTARLO  
003054*    SULL'ORDINE E PER CONTROLLI DI CONGRUENZA SUCCESSIVI         
003055     IF WCOM-FLAGPRGM = 'I'                                       
003056        IF WCOM-INDESENZ NOT > ZEROES OR                          
003057          (WCOM-INDESENZ > ZEROES     AND                         
003058           WCOM-INDESENZ = WINDRIGA AND                           
003059           WCOM-PAGIRICH = WCOM-PAGESENZ)                         
003060           MOVE WINDRIGA          TO WCOM-INDESENZ                
003061           MOVE WCOM-PAGIRICH     TO WCOM-PAGESENZ                
003062           MOVE L651-ESENTIVA     TO LO20-ESENTIVAI               
003063           IF LO20-ESENTIVAI > SPACES                             
003064              MOVE 'N'            TO LO20-FLAGGIVAI.              
003065     IF LO20-FLAGGIVAI = 'N'   AND                                
003066        WINDRIGA       =  1    AND                                
003067        L651-ESENTIVA  > SPACES AND                               
003068        LO20-ESENTIVAI = SPACES                                   
003069        MOVE L651-ESENTIVA       TO LO20-ESENTIVAI.               
003070*    CONTROLLO CONGRUENZA TRA IL CODICE ESENZIONE DEL SERVIZIO    
003071*    E QUELLO DELL'ORDINE                                         
003072     IF LO20-OPERAZIOI(WINDRIGA) NOT > SPACES OR                  
003073       (LO20-OPERAZIOI(WINDRIGA)     > SPACES AND                 
003074       (LO20-OPERAZIOI(WINDRIGA) NOT = 'K' AND '/'))              
003075        IF L651-ESENTIVA NOT = LO20-ESENTIVAI                     
003076           MOVE '*'              TO WSWERROR                      
003077           MOVE '02619'          TO MESS-CODERROR                 
003078           MOVE DFHUNIMD         TO LO20-CODSERVIA (WINDRIGA)     
003079           MOVE DFHRED           TO LO20-CODSERVIC (WINDRIGA)     
003080           IF LO20-OPERAZIOI(WINDRIGA) NOT > SPACES               
003081              MOVE -1            TO LO20-OPERAZIOL (WINDRIGA)     
003082           ELSE                                                   
003083              MOVE -1            TO LO20-CODSERVIL (WINDRIGA)     
003084           END-IF                                                 
003085           MOVE DFHPROIM         TO LO20-ESENTIVAA                
003086           MOVE DFHRED           TO LO20-ESENTIVAC                
003087           MOVE DFHPROIM         TO LO20-ESENTIVRA (WINDRIGA)     
003088           MOVE DFHRED           TO LO20-ESENTIVRC (WINDRIGA)     
003089           MOVE L651-ESENTIVA TO LO20-ESENTIVRI(WINDRIGA)         
003090           IF LO20-ESENTIVRI(WINDRIGA) NOT > SPACES               
003091              MOVE DFHREVRS      TO LO20-ESENTIVRH (WINDRIGA)     
003092           END-IF                                                 
003093           GO TO F601-EX.                                         
003094     MOVE LO20-CODSERVII(WINDRIGA) TO WPAG-CODSERVI (WINDRIGA).   
003095     MOVE L651-DESSERVI            TO LO20-DESSERVII(WINDRIGA)    
003096                                      WPAG-DESSERVI (WINDRIGA).   
003097     MOVE L651-ESENTIVA            TO LO20-ESENTIVRI(WINDRIGA)    
003098                                      WPAG-ESENTIVR (WINDRIGA).   
003099     MOVE L651-UNMISURA            TO LO20-UNMISURAI(WINDRIGA)    
003100                                      WPAG-UNMISURA (WINDRIGA).   
003101*    PROPOSTA PREZZO                                              
003102     IF LO20-TIPSERVII               = 'M'  AND                   
003103        LO20-CODSOCIEI               = '22' AND                   
003104        LO20-PREZZORDI(WINDRIGA) NOT > ' ' AND                    
003105        LO20-IMPORDINI(WINDRIGA) NOT > ' '                        
003106        PERFORM F610-PROPONI-PREZZO                               
003107           THRU F610-EX.                                          
003108 F601-EX. EXIT.                                                   
003109*----------------------------------------------------------------*
003110 F602-CTRL-QUANTITA.                                              
003111*----------------------------------------------------------------*
003112     INSPECT LO20-QTAORDINI (WINDRIGA)                            
003113             REPLACING ALL LOW-VALUE BY SPACES.                   
003114     MOVE LO20-QTAORDINI (WINDRIGA) TO WSNU-NUMBER.               
003115     MOVE 2                         TO WSNU-DECIMALS.             
003116     MOVE 7                         TO WSNU-INTEGERS.             
003117     PERFORM SRWTESTN                                             
003118        THRU SRWTESTN-EX.                                         
003119     IF WSNU-WSWERROR = '*'                                       
003120        MOVE '*'                 TO WSWERROR                      
003121        MOVE DFHUNIMD            TO LO20-QTAORDINA(WINDRIGA)      
003122        MOVE DFHRED              TO LO20-QTAORDINC(WINDRIGA)      
003123        MOVE -1                  TO LO20-QTAORDINL(WINDRIGA)      
003124        MOVE '00104'             TO MESS-CODERROR                 
003125     ELSE                                                         
003126        IF WSNU-NUMEOUTN NOT > ZERO                               
003127           MOVE 1                TO WSNU-NUMEOUTN                 
003128        END-IF                                                    
003129        MOVE WSNU-NUMEOUTN       TO LO20-QTAORDINO(WINDRIGA)      
003130        MOVE WSNU-NUMEOUTN       TO WPAG-QTAORDIN (WINDRIGA).     
003131 F602-EX. EXIT.                                                   
003132*----------------------------------------------------------------*
003133 F603-CTRL-DATI-NUM.                                              
003134*----------------------------------------------------------------*
003135     INSPECT LO20-PREZZORDI (WINDRIGA)                            
003136             REPLACING ALL LOW-VALUE BY SPACES.                   
003137     INSPECT LO20-IMPORDINI (WINDRIGA)                            
003138             REPLACING ALL LOW-VALUE BY SPACES.                   
003139     IF LO20-PREZZORDI (WINDRIGA) NOT > SPACES AND                
003140        LO20-IMPORDINI (WINDRIGA) NOT > SPACES                    
003141        MOVE '*'                 TO WSWERROR                      
003142        MOVE DFHUNIMD            TO LO20-PREZZORDA(WINDRIGA)      
003143        MOVE DFHRED              TO LO20-PREZZORDC(WINDRIGA)      
003144        MOVE -1                  TO LO20-PREZZORDL(WINDRIGA)      
003145        MOVE DFHUNIMD            TO LO20-IMPORDINA(WINDRIGA)      
003146        MOVE DFHRED              TO LO20-IMPORDINC(WINDRIGA)      
003147        MOVE '01976'             TO MESS-CODERROR.                
003148 F603-EX. EXIT.                                                   
003149*----------------------------------------------------------------*
003150 F604-CTRL-PREZZO.                                                
003151*----------------------------------------------------------------*
003152     IF LO20-PREZZORDI (WINDRIGA) NOT > SPACES                    
003153        MOVE SPACES              TO WPAG-PREZZORD   (WINDRIGA)    
003154        MOVE ZEROES              TO WPAG-PREZZORD-N (WINDRIGA)    
003155        GO TO F604-EX.                                            
003156     MOVE '4'                       TO WS-DECIDIVI.               
003157     MOVE LO20-PREZZORDI(WINDRIGA)  TO WSNU-NUMBER.               
003158     MOVE 7                         TO WSNU-INTEGERS.             
003159     MOVE 4                         TO WSNU-DECIMALS.             
003160     PERFORM SRWTESTN                                             
003161        THRU SRWTESTN-EX.                                         
003162     IF WSNU-WSWERROR = '*'                                       
003163        MOVE DFHUNIMD            TO LO20-PREZZORDA(WINDRIGA)      
003164        MOVE DFHRED              TO LO20-PREZZORDC(WINDRIGA)      
003165        MOVE -1                  TO LO20-PREZZORDL(WINDRIGA)      
003166        MOVE '*'                 TO WSWERROR                      
003167        MOVE '00059'             TO MESS-CODERROR                 
003168        GO TO F604-EX                                             
003169     ELSE                                                         
003170        MOVE WSNU-NUMEOUTN        TO WS-PREZZOR9                  
003171        PERFORM U99-VISUALIZZA-PREZZO                             
003172           THRU U99-EX                                            
003173        MOVE WS-PREZZORX         TO LO20-PREZZORDO(WINDRIGA)      
003174        MOVE WS-PREZZORX         TO WPAG-PREZZORD   (WINDRIGA)    
003175        MOVE WSNU-NUMEOUTN       TO WPAG-PREZZORD-N (WINDRIGA).   
003176 F604-EX. EXIT.                                                   
003177*----------------------------------------------------------------*
003178 F605-CTRL-IMPORTO.                                               
003179*----------------------------------------------------------------*
003180     IF LO20-IMPORDINI (WINDRIGA) NOT > SPACES                    
003181        MOVE SPACES              TO WPAG-IMPORDIN   (WINDRIGA)    
003182        MOVE ZEROES              TO WPAG-IMPORDIN-N (WINDRIGA)    
003183        GO TO F605-EX.                                            
003184     MOVE LO20-IMPORDINI(WINDRIGA) TO WSNU-NUMBER.                
003185     MOVE 14                       TO WSNU-INTEGERS.              
003186     MOVE WCOM-DECIDIVI            TO WSNU-DECIMALS.              
003187     IF WCOM-DECIDIVI NOT EQUAL '0'                               
003188        MOVE 13                  TO WSNU-INTEGERS.                
003189     COMPUTE WSNU-INTEGERS = WSNU-INTEGERS - WSNU-DECIMALS.       
003190     PERFORM SRWTESTN                                             
003191        THRU SRWTESTN-EX.                                         
003192     IF WSNU-WSWERROR = '*'                                       
003193        MOVE DFHUNIMD            TO LO20-IMPORDINA(WINDRIGA)      
003194        MOVE DFHRED              TO LO20-IMPORDINC(WINDRIGA)      
003195        MOVE -1                  TO LO20-IMPORDINL(WINDRIGA)      
003196        MOVE '*'                 TO WSWERROR                      
003197        MOVE '00208'             TO MESS-CODERROR                 
003198        GO TO F605-EX                                             
003199     ELSE                                                         
003200        MOVE WSNU-NUMEOUTN       TO WS-IMPORDI9                   
003201        PERFORM U98-VISUALIZZA-IMPORTO                            
003202           THRU U98-EX                                            
003203        MOVE WS-IMPORDIX         TO LO20-IMPORDINO(WINDRIGA).     
003204        MOVE WS-IMPORDIX         TO WPAG-IMPORDIN   (WINDRIGA)    
003205        MOVE WSNU-NUMEOUTN       TO WPAG-IMPORDIN-N (WINDRIGA).   
003206 F605-EX. EXIT.                                                   
003207*----------------------------------------------------------------*
003208 F606-CTRL-E-CALCOLA.                                             
003209*----------------------------------------------------------------*
003210     IF WPAG-PREZZORD-N (WINDRIGA) NOT > ZEROES AND               
003211        WPAG-IMPORDIN-N (WINDRIGA) NOT > ZEROES                   
003212        MOVE '*'                 TO WSWERROR                      
003213        MOVE DFHUNIMD            TO LO20-PREZZORDA(WINDRIGA)      
003214        MOVE DFHRED              TO LO20-PREZZORDC(WINDRIGA)      
003215        MOVE -1                  TO LO20-PREZZORDL(WINDRIGA)      
003216        MOVE DFHUNIMD            TO LO20-IMPORDINA(WINDRIGA)      
003217        MOVE DFHRED              TO LO20-IMPORDINC(WINDRIGA)      
003218        MOVE '01976'             TO MESS-CODERROR                 
003219        GO TO F606-EX.                                            
003220     IF WPAG-PREZZORD-N (WINDRIGA) > 0                            
003221        IF WPAG-PREZZORD-N(WINDRIGA) = WPAG-PREZZORD-O(WINDRIGA)  
003222       AND WPAG-QTAORDIN  (WINDRIGA) = WPAG-QTAORDIN-O(WINDRIGA)  
003223           MOVE WPAG-IMPORDIN-O(WINDRIGA)                         
003224                                 TO WPAG-IMPORDIN-N(WINDRIGA)     
003225        ELSE                                                      
003226           COMPUTE ARR0-IMPORTOX = WPAG-QTAORDIN (WINDRIGA)       
003227                                 * WPAG-PREZZORD-N (WINDRIGA)     
003228           PERFORM U90-INCLUDE-SRARR0                             
003229              THRU U90-EX                                         
003230           EVALUATE WCOM-DECIDIVI                                 
003231            WHEN '0'                                              
003232               MOVE ARR0-IMPORTOX TO WS-IMPO0                     
003233               MOVE WS-IMPO0     TO WPAG-IMPORDIN-N (WINDRIGA)    
003234            WHEN '1'                                              
003235               MOVE ARR0-IMPORTOX TO WS-IMPO1                     
003236               MOVE WS-IMPO1     TO WPAG-IMPORDIN-N (WINDRIGA)    
003237            WHEN '2'                                              
003238               MOVE ARR0-IMPORTOX TO WS-IMPO2                     
003239               MOVE WS-IMPO2     TO WPAG-IMPORDIN-N (WINDRIGA)    
003240           END-EVALUATE                                           
003241        END-IF                                                    
003242        MOVE WPAG-IMPORDIN-N (WINDRIGA) TO WS-IMPORDI9            
003243        PERFORM U98-VISUALIZZA-IMPORTO                            
003244           THRU U98-EX                                            
003245        MOVE WS-IMPORDIX         TO WPAG-IMPORDIN  (WINDRIGA)     
003246        MOVE WS-IMPORDIX         TO LO20-IMPORDINO (WINDRIGA).    
003247 F606-EX. EXIT.                                                   
003248*----------------------------------------------------------------*
003249 F607-CTRL-CENCOSTD.                                              
003250*----------------------------------------------------------------*
003251     INSPECT LO20-CENCOSTDI (WINDRIGA)                            
003252             REPLACING ALL LOW-VALUE BY SPACES.                   
003253     IF A901-TIPOCONS > SPACES AND                                
003254        A901-CLIFOCON > SPACES                                    
003255        CONTINUE                                                  
003256     ELSE                                                         
003257        MOVE SPACES              TO LO20-CENCOSTDI(WINDRIGA)      
003258        MOVE SPACES              TO WPAG-CENCOSTD (WINDRIGA)      
003259        GO TO F607-EX.                                            
003260     IF LO20-CENCOSTDI (WINDRIGA) NOT > SPACES                    
003261        MOVE DFHUNIMD            TO LO20-CENCOSTDA(WINDRIGA)      
003262        MOVE DFHRED              TO LO20-CENCOSTDC(WINDRIGA)      
003263        MOVE -1                  TO LO20-CENCOSTDL(WINDRIGA)      
003264        MOVE '*'                 TO WSWERROR                      
003265        MOVE '00058'             TO MESS-CODERROR                 
003266        GO TO F607-EX.                                            
003267     MOVE A901-CLIFOCON          TO A531-CODFORNI.                
003268     PERFORM L95-SELECT-CLIFOCON                                  
003269        THRU L95-EX.                                              
003270     IF SQLCODE = 100                                             
003271        MOVE DFHUNIMD            TO LO20-CENCOSTDA(WINDRIGA)      
003272        MOVE DFHRED              TO LO20-CENCOSTDC(WINDRIGA)      
003273        MOVE -1                  TO LO20-CENCOSTDL(WINDRIGA)      
003274        MOVE '*'                 TO WSWERROR                      
003275        MOVE '00759'             TO MESS-CODERROR                 
003276        GO TO F607-EX.                                            
003277     MOVE LO20-CENCOSTDI (WINDRIGA) TO A982-CENCOSTO.             
003278     MOVE WS-CODSOCIE               TO A982-CODSOCIE.             
003279     MOVE A901-TIPOCONS             TO A982-CDDIVISI.             
003280     PERFORM L25-SELECT-TCENCOSTO                                 
003281        THRU L25-EX.                                              
003282     IF SQLCODE = 100 OR                                          
003283        A982-ANNULLAM > SPACES                                    
003284        MOVE DFHUNIMD            TO LO20-CENCOSTDA(WINDRIGA)      
003285        MOVE DFHRED              TO LO20-CENCOSTDC(WINDRIGA)      
003286        MOVE -1                  TO LO20-CENCOSTDL(WINDRIGA)      
003287        MOVE '*'                 TO WSWERROR                      
003288        MOVE '00058'             TO MESS-CODERROR                 
003289        GO TO F607-EX.                                            
003290     MOVE LO20-CENCOSTDI(WINDRIGA) TO WPAG-CENCOSTD (WINDRIGA).   
003291 F607-EX. EXIT.                                                   
003292*----------------------------------------------------------------*
003293 F608-CTRL-CENCOSTA.                                              
003294*----------------------------------------------------------------*
003295     INSPECT LO20-CENCOSTAI (WINDRIGA)                            
003296             REPLACING ALL LOW-VALUE BY SPACES.                   
003297**   IF A901-TIPOCONS > SPACES AND                                
003298**      A901-CLIFOCON > SPACES                                    
003299**      CONTINUE                                                  
003300**   ELSE                                                         
003301**      MOVE SPACES              TO LO20-CENCOSTAI(WINDRIGA)      
003302**      MOVE SPACES              TO WPAG-CENCOSTA (WINDRIGA)      
003303**      GO TO F608-EX.                                            
003304     IF LO20-CENCOSTAI (WINDRIGA) NOT > SPACES                    
003305        MOVE L651-CENCOSTA       TO LO20-CENCOSTAO(WINDRIGA).     
003306     IF LO20-CENCOSTAI (WINDRIGA) NOT > SPACES                    
003307        MOVE DFHUNIMD            TO LO20-CENCOSTAA(WINDRIGA)      
003308        MOVE DFHRED              TO LO20-CENCOSTAC(WINDRIGA)      
003309        MOVE -1                  TO LO20-CENCOSTAL(WINDRIGA)      
003310        MOVE '*'                 TO WSWERROR                      
003311        MOVE '00058'             TO MESS-CODERROR                 
003312        GO TO F608-EX.                                            
003313     MOVE LO20-CENCOSTAI (WINDRIGA) TO A982-CENCOSTO.             
003314     MOVE LO20-CODSOCIEI            TO A982-CODSOCIE.             
003315     MOVE WCOM-CDDIVISI             TO A982-CDDIVISI.             
003316     PERFORM L25-SELECT-TCENCOSTO                                 
003317        THRU L25-EX.                                              
003318     IF SQLCODE = 100 OR                                          
003319        A982-ANNULLAM > SPACES                                    
003320        MOVE DFHUNIMD            TO LO20-CENCOSTAA(WINDRIGA)      
003321        MOVE DFHRED              TO LO20-CENCOSTAC(WINDRIGA)      
003322        MOVE -1                  TO LO20-CENCOSTAL(WINDRIGA)      
003323        MOVE '*'                 TO WSWERROR                      
003324        MOVE '00058'             TO MESS-CODERROR                 
003325        GO TO F608-EX.                                            
003326     MOVE LO20-CENCOSTAI(WINDRIGA) TO WPAG-CENCOSTA (WINDRIGA).   
003327 F608-EX. EXIT.                                                   
003328*----------------------------------------------------------------*
003329 F610-PROPONI-PREZZO.                                             
003330*----------------------------------------------------------------*
003331     MOVE LO20-CODCLIENO           TO L654-CODCLIEN.              
003332     MOVE LO20-TIPSERVIO           TO L654-TIPSERVI.              
003333     MOVE LO20-CODDIVISO           TO L654-CODDIVIS.              
003334     MOVE LO20-AAMMCOMPO           TO WS-AAMMCOMP.                
003335     MOVE LO20-CODSERVIO(WINDRIGA) TO L654-CODSERVI.              
003336     PERFORM L55-SELECT-LISTILOGI                                 
003337        THRU L55-EX.                                              
003338     IF SQLCODE = ZEROES                                          
003339        MOVE L654-PREZZLIS         TO WS-PREZZOR9                 
003340        PERFORM U99-VISUALIZZA-PREZZO                             
003341           THRU U99-EX                                            
003342        MOVE WS-PREZZORX           TO LO20-PREZZORDO(WINDRIGA).   
003343 F610-EX. EXIT.                                                   
003344*----------------------------------------------------------------*
003345 F70-CTRL-ESENTIVA-CODA.                                          
003346*----------------------------------------------------------------*
003347     MOVE SPACES                 TO WSWERROR.                     
003348     MOVE SPACES                 TO WS-FLAGSALV.                  
003349*    CONTROLLI ESENTIVA SU TUTTA LA CODA                          
003350     MOVE 1                      TO WNUMITEM.                     
003351     PERFORM R20-READQ-TS                                         
003352        THRU R20-EX.                                              
003353     PERFORM F73-SCORRI-TS-ESENTIVA                               
003354        THRU F73-EX                                               
003355             UNTIL EOQ = 'S'.                                     
003356     IF ERRORE                                                    
003357        IF (WCOM-OPERAZIO = 'K' OR '/') AND                       
003358           (MESS-CODERROR = '02619' OR '02621')                   
003359           MOVE SPACES           TO WSWERROR                      
003360           MOVE SPACES           TO MESS-CODERROR.                
003361*    RILEGGE LA TS DELLA PAGINA VISUALIZZATA                      
003362     MOVE WCOM-PAGIRICH          TO WNUMITEM.                     
003363     PERFORM R20-READQ-TS                                         
003364        THRU R20-EX.                                              
003365     IF ERRORE                                                    
003366        GO TO F70-EX.                                             
003367*    CONTROLLO CONGRUENZA TRA FLAG IVA (S/N) E CODICE ESENZIONE   
003368     IF LO20-FLAGGIVAI = 'S' AND                                  
003369        LO20-ESENTIVAI > SPACES                                   
003370        MOVE '*'                 TO WSWERROR                      
003371        MOVE '02620'             TO MESS-CODERROR                 
003372        MOVE DFHUNDLN            TO LO20-FLAGGIVAH                
003373        MOVE DFHUNIMD            TO LO20-FLAGGIVAA                
003374        MOVE DFHRED              TO LO20-FLAGGIVAC                
003375        MOVE -1                  TO LO20-FLAGGIVAL                
003376        MOVE DFHPROIM            TO LO20-ESENTIVAA                
003377        MOVE DFHRED              TO LO20-ESENTIVAC.               
003378 F70-EX. EXIT.                                                    
003379*----------------------------------------------------------------*
003380 F73-SCORRI-TS-ESENTIVA.                                          
003381*----------------------------------------------------------------*
003382     PERFORM F74-SCORRI-RIGA-ESENTIVA                             
003383        THRU F74-EX                                               
003384             VARYING WINDRIGA FROM 1 BY 1                         
003385               UNTIL WINDRIGA > WNUMRIGA.                         
003386     PERFORM R30-REWRITE-TS                                       
003387        THRU R30-EX.                                              
003388     ADD 1                       TO WNUMITEM.                     
003389     PERFORM R20-READQ-TS                                         
003390        THRU R20-EX.                                              
003391 F73-EX. EXIT.                                                    
003392*----------------------------------------------------------------*
003393 F74-SCORRI-RIGA-ESENTIVA.                                        
003394*----------------------------------------------------------------*
003395     IF WPAG-CODSERVI (WINDRIGA) NOT > SPACES                     
003396        GO TO F74-EX.                                             
003397     MOVE WPAG-CODSERVI (WINDRIGA) TO L651-CODSERVI               
003398     PERFORM L15-SELECT-SERVIZIO                                  
003399        THRU L15-EX                                               
003400     MOVE L651-ESENTIVA          TO WPAG-ESENTIVR(WINDRIGA)       
003401     IF WCOM-PAGIRICH = WNUMITEM                                  
003402        MOVE L651-ESENTIVA       TO LO20-ESENTIVRI(WINDRIGA).     
003403     IF WCOM-FLAGPRGM = 'I'                                       
003404        IF WCOM-INDESENZ NOT > ZEROES OR                          
003405          (WCOM-INDESENZ > ZEROES   AND                           
003406           WCOM-INDESENZ = WINDRIGA AND                           
003407           WNUMITEM      = WCOM-PAGESENZ)                         
003408           MOVE WINDRIGA         TO WCOM-INDESENZ                 
003409           MOVE WNUMITEM         TO WCOM-PAGESENZ                 
003410           MOVE L651-ESENTIVA    TO LO20-ESENTIVAI                
003411           IF LO20-ESENTIVAI > SPACES                             
003412              MOVE 'N'           TO LO20-FLAGGIVAI.               
003413*    CONTROLLO CONGRUENZA TRA IL CODICE ESENZIONE DEL SERVIZIO    
003414*    E QUELLO DELL'ORDINE                                         
003415     IF WPAG-OPERAZIO (WINDRIGA) NOT > SPACES OR                  
003416       (WPAG-OPERAZIO (WINDRIGA)     > SPACES AND                 
003417       (WPAG-OPERAZIO (WINDRIGA) NOT = 'K' AND '/'))              
003418        IF WPAG-ESENTIVR(WINDRIGA) NOT = LO20-ESENTIVAI           
003419           MOVE '*'              TO WSWERROR                      
003420           IF WCOM-PAGIRICH = WNUMITEM                            
003421              MOVE '02619'       TO MESS-CODERROR                 
003422              MOVE DFHUNIMD      TO LO20-CODSERVIA (WINDRIGA)     
003423              MOVE DFHRED        TO LO20-CODSERVIC (WINDRIGA)     
003424              IF WPAG-OPERAZIO (WINDRIGA) NOT > SPACES            
003425                 MOVE -1         TO LO20-OPERAZIOL (WINDRIGA)     
003426              ELSE                                                
003427                 MOVE -1         TO LO20-CODSERVIL (WINDRIGA)     
003428              END-IF                                              
003429              MOVE DFHPROIM      TO LO20-ESENTIVAA                
003430              MOVE DFHRED        TO LO20-ESENTIVAC                
003431              MOVE DFHPROIM      TO LO20-ESENTIVRA (WINDRIGA)     
003432              MOVE DFHRED        TO LO20-ESENTIVRC (WINDRIGA)     
003433              IF LO20-ESENTIVRI(WINDRIGA) NOT > SPACES            
003434                 MOVE DFHREVRS TO LO20-ESENTIVRH (WINDRIGA)       
003435              END-IF                                              
003436           ELSE                                                   
003437              MOVE '02621'       TO MESS-CODERROR                 
003438              MOVE DFHPROIM      TO LO20-ESENTIVAA                
003439              MOVE DFHRED        TO LO20-ESENTIVAC                
003440              MOVE -1            TO LO20-OPERAZIOL(1)             
003441           END-IF                                                 
003442           GO TO F74-EX.                                          
003443*    CONTROLLO CONGRUENZA TRA I CODICI ESENZIONE DEI SERVIZI      
003444*    SCELTI CON OPERAZIONE 'K'                                    
003445     IF WPAG-OPERAZIO (WINDRIGA) = 'K'                            
003446        IF WS-FLAGSALV NOT > SPACES                               
003447           MOVE 'S'                     TO WS-FLAGSALV            
003448           MOVE WPAG-ESENTIVR(WINDRIGA) TO WS-ESENTIVA-K          
003449        ELSE                                                      
003450           IF WS-ESENTIVA-K NOT = WPAG-ESENTIVR(WINDRIGA)         
003451              MOVE '*'            TO WSWERROR                     
003452              IF WCOM-PAGIRICH = WNUMITEM                         
003453                 MOVE '02618'     TO MESS-CODERROR                
003454                 MOVE DFHUNIMD    TO LO20-CODSERVIA (WINDRIGA)    
003455                 MOVE DFHRED      TO LO20-CODSERVIC (WINDRIGA)    
003456                 MOVE -1          TO LO20-CODSERVIL (WINDRIGA)    
003457                 MOVE DFHPROIM    TO LO20-ESENTIVRA (WINDRIGA)    
003458                 MOVE DFHRED      TO LO20-ESENTIVRC (WINDRIGA)    
003459                 IF LO20-ESENTIVRI(WINDRIGA) NOT > SPACES         
003460                    MOVE DFHREVRS TO LO20-ESENTIVRH (WINDRIGA)    
003461                 END-IF                                           
003462              ELSE                                                
003463                 MOVE '02622'     TO MESS-CODERROR                
003464                 MOVE -1          TO LO20-OPERAZIOL(1)            
003465              END-IF                                              
003466              GO TO F74-EX.                                       
003467 F74-EX. EXIT.                                                    
003468*----------------------------------------------------------------*
003469 F80-GESTIONE-AGGANCIO.                                           
003470*----------------------------------------------------------------*
003471     IF LO20-OPERAZIOI (WINDRIGA) NOT GREATER SPACES              
003472        GO TO F80-EX.                                             
003473     IF LO20-OPERAZIOI (WINDRIGA) = '*'                           
003474        MOVE WCOM-PAGIRICH       TO WCOM-PAGITRAN(WCOM-INDITRAN)  
003475        PERFORM SCRIVO-RICICLO                                    
003476           THRU SCRIVO-RICICLO-EX                                 
003477        MOVE WPAG-NRRIGORD (WINDRIGA) TO WCOM-NRRIGORD            
003478        IF LO20-TIPSERVII = 'M' OR 'L'                            
003479           MOVE 'LO45'           TO WTRANSID                      
003480        ELSE                                                      
003481           MOVE SPACES                  TO WCOM-CODSOCIE          
003482                                           WCOM-SOCIEMER          
003483                                           WCOM-TIPOARTI          
003484                                           WCOM-TIPORECO          
003485                                           WCOM-DTFATTUR          
003486                                           WCOM-PAESPROV          
003487                                           WCOM-PAESMERC          
003488                                           WCOM-CENCOSTA          
003489                                           WCOM-CENCOSTD          
003490           MOVE 'LO40'           TO WTRANSID                      
003491        END-IF                                                    
003492        PERFORM U05-START-TRANSID                                 
003493           THRU U05-EX.                                           
003494 F80-EX. EXIT.                                                    
003495*----------------------------------------------------------------*
003496 G00-AGGIORNAMENTI.                                               
003497*----------------------------------------------------------------*
003498     MOVE SPACES                 TO WS-ESENTIVA-K.                
003499     MOVE SPACES                 TO WS-FLAGDELE.                  
003500     MOVE SPACES                 TO WS-FLAGDATA.                  
003501     MOVE WCOM-AANUMORD          TO WS-ORDINE-PREC                
003502     MOVE 1                      TO WNUMITEM.                     
003503     PERFORM R20-READQ-TS                                         
003504        THRU R20-EX.                                              
003505     IF WCOM-FLAGPRGM = 'I' OR                                    
003506        WCOM-OPERAZIO = 'K'                                       
003507        PERFORM G10-INSERIMENTO-TESTATA                           
003508           THRU G10-EX                                            
003509        MOVE ZEROES              TO WS-NRRIGORD                   
003510        PERFORM G20-INSERIMENTO-DETTAGLIO                         
003511           THRU G20-EX                                            
003512                UNTIL EOQ = 'S'                                   
003513        IF WCOM-OPERAZIO = 'K'                                    
003514           PERFORM G35-UPDATE-ORDILOGI-K                          
003515              THRU G35-EX.                                        
003516     IF WCOM-FLAGPRGM NOT = 'I'                                   
003517        IF WCOM-OPERAZIO = 'K'                                    
003518           MOVE WCOM-AANUMORD    TO WS-ORDINE-NEW                 
003519           MOVE WS-ORDINE-PREC   TO WCOM-AANUMORD                 
003520                                    LO20-AANUMORDI                
003521        END-IF                                                    
003522        IF WCOM-CODCLIEN NOT = LO20-CODCLIENI      OR             
003523           WCOM-TIPSERVI NOT = LO20-TIPSERVII      OR             
003524           WCOM-AAMMCOMP NOT = LO20-AAMMCOMPI      OR             
003525           WCOM-FLAGGIVA NOT = LO20-FLAGGIVAI      OR             
003526           WCOM-ESENTIVA NOT = LO20-ESENTIVAI      OR             
003527           WCOM-CONTODCE NOT = LO20-CONTODCEI      OR             
003528           WCOM-CODDIVIS NOT = LO20-CODDIVISI                     
003529           PERFORM G40-AGGIORNA-TESTATA                           
003530              THRU G40-EX                                         
003531        END-IF                                                    
003532        PERFORM G50-AGGIORNA-DETTAGLIO                            
003533           THRU G50-EX                                            
003534                UNTIL EOQ = 'S'                                   
003535        IF WS-FLAGDELE = 'S'                                      
003536           PERFORM G70-ANNULLA-ORDINE                             
003537              THRU G70-EX                                         
003538        END-IF                                                    
003539        IF WS-FLAGDATA = 'S'                                      
003540           PERFORM G80-AGGIORNA-DATA                              
003541              THRU G80-EX                                         
003542        END-IF                                                    
003543        IF LO20-SOSPESOXI > ' ' AND                               
003544           WCOM-OPERAZIO NOT = 'K'                                
003545           PERFORM G90-CTRL-SOSPESO                               
003546              THRU G90-EX                                         
003547        END-IF                                                    
003548        MOVE WCOM-PAGIRICH       TO WCOM-PAGITRAN(WCOM-INDITRAN). 
003549     IF WCOM-OPERAZIO = 'K'                                       
003550        MOVE WS-ORDINE-NEW       TO WCOM-AANUMORD                 
003551                                    LO20-AANUMORDO.               
003552     MOVE SPACES                 TO WCOM-DATIPROG.                
003553     INITIALIZE                     WCOM-DATIPROG.                
003554     MOVE SPACES                 TO WCOM-FLAGPRGM.                
003555     MOVE SPACES                 TO WCOM-SALDATOX.                
003556     MOVE SPACES                 TO WCOM-FLAGAUTO.                
003557     MOVE SPACES                 TO WCOM-OPERAZIO.                
003558     MOVE ZEROES                 TO WCOM-CONTOPER.                
003559     PERFORM C20-GESTIONE-RICICLO                                 
003560        THRU C20-EX.                                              
003561     IF WS-FLAGDELE = 'S' AND                                     
003562        L653-NRRIGORD = ZEROES                                    
003563        CONTINUE                                                  
003564     ELSE                                                         
003565        MOVE '00005'             TO MESS-CODERROR                 
003566        IF WS-ERROSOSP > ' '                                      
003567           MOVE '02496'          TO MESS-CODERROR.                
003568 G00-EX. EXIT.                                                    
003569*----------------------------------------------------------------*
003570 G10-INSERIMENTO-TESTATA.                                         
003571*----------------------------------------------------------------*
003572     MOVE SPACES                 TO DCLTORDILOGI.                 
003573     INITIALIZE                     DCLTORDILOGI.                 
003574     IF WCOM-OPERAZIO = 'K'                                       
003575        PERFORM H00-CERCA-NUM-ORDINE                              
003576           THRU H00-EX.                                           
003577     MOVE WCOM-AANUMORD          TO L652-AANUMORD.                
003578     MOVE LO20-CODCLIENI         TO L652-CODCLIEN.                
003579     MOVE LO20-CODSOCIEI         TO L652-CODSOCIE.                
003580     MOVE LO20-CDDIVISII         TO L652-CDDIVISI.                
003581     MOVE WCOM-DTCREAZI          TO L652-DTCARORD                 
003582     MOVE LO20-CODDIVISI         TO L652-CODDIVIS.                
003583     MOVE LO20-TIPSERVII         TO L652-TIPSERVI.                
003584     MOVE LO20-AAMMCOMPI         TO L652-AAMMCOMP.                
003585     MOVE 'M'                    TO L652-FLAGAUTO.                
003586     IF WCOM-OPERAZIO = 'K'                                       
003587        MOVE LO20-FLAGAUTOI      TO L652-FLAGAUTO                 
003588        IF LO20-NRPREATTI > ' '                                   
003589           MOVE LO20-NRPREATTI   TO L652-NRPREATT                 
003590        END-IF                                                    
003591        IF LO20-DTPREATTI > ' '                                   
003592           STRING '20'                                            
003593                  LO20-DTPREATTI(5:2)                             
003594                  LO20-DTPREATTI(3:2)                             
003595                  LO20-DTPREATTI(1:2)                             
003596           DELIMITED BY SIZE   INTO L652-DTPREATT                 
003597        END-IF                                                    
003598     END-IF                                                       
003599     MOVE LO20-FLAGGIVAI         TO L652-FLAGGIVA.                
003600     MOVE LO20-ESENTIVAI         TO L652-ESENTIVA.                
003601     MOVE LO20-CONTODCEI         TO L652-CONTODCE.                
003602     MOVE WS-CODSOCIE            TO L652-SOCIEMER.                
003603     MOVE WCOM-DTCREAZI          TO L652-DTCREAZI.                
003604     MOVE WCOM-DTCREAZI          TO L652-DTULTVAR.                
003605     MOVE WCOM-UTENCICS          TO L652-CODUTVAR.                
003606     MOVE SPACES                 TO L652-FLAGSOSP                 
003607     IF WCOM-OPERAZIO = 'K'                                       
003608        MOVE 'S'                 TO L652-FLAGSOSP.                
003609     MOVE 'G10-'                 TO WCOM-CODABEND.                
003610     MOVE 'INSERT'               TO WCOM-FILEFUNZ.                
003611     MOVE 'ORDILOGI'             TO WCOM-FILENOME                 
003612     MOVE L652-AANUMORD          TO WCOM-FILECTRL                 
003613     
      *EXEC SQL INSERT INTO DLOGISTI.TORDILOGI                      
003614*            ( AANUMORD, CODCLIEN                                  
003615*             ,CODSOCIE, CDDIVISI                                  
003616*             ,DTCARORD, CODDIVIS                                  
003617*             ,TIPSERVI, FLAGAUTO                                  
003618*             ,FLAGGIVA, CONTODCE                                  
003619*             ,DTEVAORD, AANUMFAT                                  
003620*             ,DTFATTUR, NRPREATT                                  
003621*             ,DTPREATT, DTCREAZI                                  
003622*             ,DTULTVAR, CODUTVAR                                  
003623*             ,DTANNULL, AAMMCOMP                                  
003624*             ,FLAGSOSP, SOCIEMER                                  
003625*             ,ESENTIVA)                                           
003626*     VALUES                                                       
003627*            ( :L652-AANUMORD, :L652-CODCLIEN                      
003628*            , :L652-CODSOCIE, :L652-CDDIVISI                      
003629*            , :L652-DTCARORD, :L652-CODDIVIS                      
003630*            , :L652-TIPSERVI, :L652-FLAGAUTO                      
003631*            , :L652-FLAGGIVA, :L652-CONTODCE                      
003632*            , :L652-DTEVAORD, :L652-AANUMFAT                      
003633*            , :L652-DTFATTUR, :L652-NRPREATT                      
003634*            , :L652-DTPREATT, :L652-DTCREAZI                      
003635*            , :L652-DTULTVAR, :L652-CODUTVAR                      
003636*            , :L652-DTANNULL, :L652-AAMMCOMP                      
003637*            , :L652-FLAGSOSP, :L652-SOCIEMER                      
003638*            , :L652-ESENTIVA)                                     
003639*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 1 TO SQL-STMT-ID 
           MOVE 23 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMORD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODCLIEN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODSOCIE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CDDIVISI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTCARORD
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODDIVIS
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-TIPSERVI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-FLAGAUTO
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-FLAGGIVA
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CONTODCE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTEVAORD
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMFAT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTFATTUR
            BY VALUE 0
                     0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-NRPREATT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTPREATT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTCREAZI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 17 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODUTVAR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 18 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTANNULL
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 19 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AAMMCOMP
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 20 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-FLAGSOSP
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 21 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-SOCIEMER
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 22 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-ESENTIVA
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003640 G10-EX. EXIT.                                                    
003641*----------------------------------------------------------------*
003642 G20-INSERIMENTO-DETTAGLIO.                                       
003643*----------------------------------------------------------------*
003644     PERFORM G30-INSERISCI-RIGA                                   
003645        THRU G30-EX                                               
003646             VARYING WINDRIGA FROM 1 BY 1                         
003647               UNTIL WINDRIGA > WNUMRIGA.                         
003648     ADD 1                       TO WNUMITEM.                     
003649     PERFORM R20-READQ-TS                                         
003650        THRU R20-EX.                                              
003651 G20-EX. EXIT.                                                    
003652*----------------------------------------------------------------*
003653 G30-INSERISCI-RIGA.                                              
003654*----------------------------------------------------------------*
003655     IF WPAG-OPERAZIO (WINDRIGA) NOT = 'I' AND                    
003656        WPAG-OPERAZIO (WINDRIGA) NOT = 'K'                        
003657        GO TO G30-EX.                                             
003658     MOVE SPACES                    TO DCLTRIGORDILOGI.           
003659     INITIALIZE DCLTRIGORDILOGI.                                  
003660     ADD 1                          TO WS-NRRIGORD.               
003661     MOVE WCOM-AANUMORD             TO L653-AANUMORD.             
003662     MOVE WS-NRRIGORD               TO L653-NRRIGORD.             
003663     MOVE WPAG-CODSERVI  (WINDRIGA) TO L653-CODSERVI.             
003664     MOVE WPAG-UNMISURA  (WINDRIGA) TO L653-UNMISURA.             
003665     MOVE WPAG-QTAORDIN  (WINDRIGA) TO L653-QTAORDIN.             
003666     MOVE WPAG-PREZZORD-N(WINDRIGA) TO L653-PREZZORD.             
003667     MOVE WPAG-IMPORDIN-N(WINDRIGA) TO L653-IMPORDIN.             
003668     MOVE WPAG-NOTENOTE  (WINDRIGA) TO L653-NOTENOTE.             
003669     MOVE WPAG-CENCOSTD  (WINDRIGA) TO L653-CENCOSTD.             
003670     MOVE WPAG-CENCOSTA  (WINDRIGA) TO L653-CENCOSTA.             
003671     MOVE WPAG-RIFECLIE  (WINDRIGA) TO L653-RIFECLIE.             
003672     MOVE WCOM-DTCREAZI             TO L653-DTCREAZI              
003673                                       L653-DTULTVAR.             
003674     MOVE WCOM-UTENCICS             TO L653-CODUTVAR.             
003675     MOVE 'G30-'                 TO WCOM-CODABEND.                
003676     MOVE 'RIGORDILOGI'          TO WCOM-FILENOME.                
003677     MOVE 'INSERT'               TO WCOM-FILEFUNZ.                
003678     MOVE L653-AANUMORD          TO WCOM-FILECTRL.                
003680     
      *EXEC SQL 
      *INSERT INTO DLOGISTI.TRIGORDILOGI                       
003681*                  (AANUMORD, NRRIGORD                             
003682*                  ,CODSERVI, UNMISURA                             
003683*                  ,QTAORDIN, PREZZORD                             
003684*                  ,IMPORDIN, NOTENOTE                             
003685*                  ,CENCOSTD, CENCOSTA                             
003686*                  ,RIFECLIE, DTCREAZI                             
003687*                  ,DTULTVAR, CODUTVAR                             
003688*                  ,DTANNULL)                                      
003689*          VALUES (:L653-AANUMORD, :L653-NRRIGORD                  
003690*                 ,:L653-CODSERVI, :L653-UNMISURA                  
003691*                 ,:L653-QTAORDIN, :L653-PREZZORD                  
003692*                 ,:L653-IMPORDIN, :L653-NOTENOTE                  
003693*                 ,:L653-CENCOSTD, :L653-CENCOSTA                  
003694*                 ,:L653-RIFECLIE, :L653-DTCREAZI                  
003695*                 ,:L653-DTULTVAR, :L653-CODUTVAR                  
003696*                 ,:L653-DTANNULL)                                 
003697*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 2 TO SQL-STMT-ID 
           MOVE 15 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-AANUMORD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-NRRIGORD
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CODSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-UNMISURA
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-QTAORDIN
            BY VALUE 0
                     0

           MOVE 1035 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-PREZZORD
            BY VALUE 0
                     0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-IMPORDIN
            BY VALUE 0
                     0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-NOTENOTE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CENCOSTD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CENCOSTA
            BY VALUE 0
                     0

           MOVE 15 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-RIFECLIE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-DTCREAZI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CODUTVAR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-DTANNULL
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003698     IF WCOM-OPERAZIO = 'K'                                       
003699        PERFORM G31-UPDATE-DETTORDILOGI                           
003700           THRU G31-EX                                            
003701        MOVE WS-ORDINE-PREC             TO L653-AANUMORD          
003702        MOVE 'S'                        TO WS-FLAGDATA            
003703        MOVE 'S'                        TO WS-FLAGDELE            
003704        MOVE WPAG-NRRIGORD (WINDRIGA)   TO L653-NRRIGORD          
003705        PERFORM G602-ANNULLA-RIGA                                 
003706           THRU G602-EX                                           
003707        MOVE WPAG-ESENTIVR (WINDRIGA)   TO WS-ESENTIVA-K.         
003708     IF WPAG-OPERAZIO(WINDRIGA) = 'I' AND                         
003709        LO20-TIPSERVII          = 'T' AND                         
003710        A901-TIPOCONS           = 'T'                             
003711        PERFORM G32-INSERT-DETTORDILOGI                           
003712           THRU G32-EX.                                           
003713     MOVE SPACES                 TO WPAG-OPERAZIO (WINDRIGA).     
003714 G30-EX. EXIT.                                                    
003715*----------------------------------------------------------------*
003716 G31-UPDATE-DETTORDILOGI.                                         
003717*----------------------------------------------------------------*
003718     MOVE WPAG-NRRIGORD (WINDRIGA)   TO WS-RIGA-PREC.             
003719     MOVE 'G31-'                  TO WCOM-CODABEND                
003720     MOVE 'UPDATE'                TO WCOM-FILECTRL                
003721     MOVE 'DETTORDILOGI'          TO WCOM-FILENOME                
003722     MOVE WS-ORDINE-PREC          TO WCOM-FILECTRL                
003724     
      *EXEC SQL 
      *UPDATE DLOGISTI.TDETTORDILOGI                           
003725*             SET AANUMORD = :L653-AANUMORD                        
003726*                ,NRRIGORD = :L653-NRRIGORD                        
003727*           WHERE AANUMORD = :WS-ORDINE-PREC                       
003728*             AND NRRIGORD = :WS-RIGA-PREC                         
003729*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 3 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-AANUMORD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-NRRIGORD
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-ORDINE-PREC
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-RIGA-PREC
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 4 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003730     MOVE 'NETMOVEREXPO'          TO WCOM-FILENOME                
003732     
      *EXEC SQL 
      *UPDATE DTRASP.TNETMOVEREXPO                             
003733*             SET AANUMORD = :L653-AANUMORD                        
003734*                ,NRRIGORD = :L653-NRRIGORD                        
003735*           WHERE AANUMORD = :WS-ORDINE-PREC                       
003736*             AND NRRIGORD = :WS-RIGA-PREC                         
003737*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 4 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-AANUMORD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-NRRIGORD
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-ORDINE-PREC
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-RIGA-PREC
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 5 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003738 G31-EX. EXIT.                                                    
003739*----------------------------------------------------------------*
003740 G32-INSERT-DETTORDILOGI.                                         
003741*----------------------------------------------------------------*
003742     INITIALIZE                      DCLTDETTORDILOGI             
003743     MOVE L653-AANUMORD              TO L655-AANUMORD             
003744     MOVE L653-NRRIGORD              TO L655-NRRIGORD             
003745     MOVE 1                          TO L655-NUMPROG7             
003746     MOVE WS-CODSOCIE                TO L655-CODSOCID             
003747     MOVE 'T'                        TO L655-CDDIVISD.            
003748     MOVE WPAG-CENCOSTD(WINDRIGA)    TO L655-CENCOSTD             
003749     MOVE LO20-CODSOCIEI             TO L655-CODSOCIA             
003750     MOVE WPAG-CENCOSTA(WINDRIGA)    TO L655-CENCOSTA             
003751     MOVE 'A'                        TO L655-CDDIVISA             
003752     MOVE L653-UNMISURA              TO L655-UNMISURA             
003753     MOVE L653-QTAORDIN              TO L655-QTAORDIN             
003754     MOVE L653-IMPORDIN              TO L655-IMPORDIN             
003755     MOVE A973-DTGIORNO              TO L655-DTFATTUR             
003756     IF L655-CENCOSTD(1:1) = '1'                                  
003757        MOVE 'F'                     TO L655-TIPOARTI             
003758     ELSE                                                         
003759        IF L655-CENCOSTD(1:1) = '3'                               
003760           MOVE 'C'                  TO L655-TIPOARTI             
003761        ELSE                                                      
003762           MOVE 'T'                  TO L655-TIPOARTI.            
003763     MOVE L655-CENCOSTD(4:2)         TO A528-CDRAGCEN             
003764     PERFORM L35-SELECT-PAESI                                     
003765        THRU L35-EX                                               
003766     MOVE A528-CODPAESE              TO L655-PAESMERC             
003767     MOVE 'LOGI'                     TO L655-TIPORECO             
003768     MOVE WCOM-DTCREAZI              TO L655-DTCREAZI             
003769     MOVE WCOM-DTCREAZI              TO L655-DTULTVAR             
003770     MOVE WCOM-UTENCICS              TO L655-CODUTVAR             
003771     PERFORM G33-CERCA-NUMERO                                     
003772        THRU G33-EX                                               
003773     MOVE WS-FATTURA                 TO L655-AANUMFAT             
003774     MOVE WS-CODSOCIE                TO L655-SOCIEMER             
003775                                        L655-CODSOCIE             
003776     MOVE 'G32-'                         TO WCOM-CODABEND         
003777     MOVE 'INSERT'                       TO WCOM-FILECTRL         
003778     MOVE 'DETTORDILOGI'             TO WCOM-FILENOME             
003779     MOVE SPACES                         TO WCOM-FILECTRL         
003780     STRING L655-CODSOCIE ' ' L655-AANUMFAT ' '                   
003781            L655-CENCOSTD ' ' L655-CENCOSTA                       
003782     DELIMITED BY SIZE                 INTO WCOM-FILECTRL         
003784     
      *EXEC SQL 
      *INSERT INTO DLOGISTI.TDETTORDILOGI                      
003785*                (AANUMORD                                         
003786*                ,NRRIGORD                                         
003787*                ,NUMPROG7                                         
003788*                ,CDMCAGTM                                         
003789*                ,CDAREGTM                                         
003790*                ,CDDIPGTM                                         
003791*                ,TIPOADDE                                         
003792*                ,KEYADDE1                                         
003793*                ,KEYADDE2                                         
003794*                ,KEYADDE3                                         
003795*                ,KEYADDE4                                         
003796*                ,CODSOCID                                         
003797*                ,CDDIVISD                                         
003798*                ,CENCOSTD                                         
003799*                ,CODSOCIA                                         
003800*                ,CDDIVISA                                         
003801*                ,CENCOSTA                                         
003802*                ,UNMISURA                                         
003803*                ,TIPOARTI                                         
003804*                ,QTAORDIN                                         
003805*                ,DTCREAZI                                         
003806*                ,DTULTVAR                                         
003807*                ,CODUTVAR                                         
003808*                ,CODSOCIE                                         
003809*                ,AANUMFAT                                         
003810*                ,IMPORDIN                                         
003811*                ,SOCIEMER                                         
003812*                ,PAESMERC                                         
003813*                ,TIPORECO                                         
003814*                ,DTFATTUR)                                        
003815*          VALUES                                                  
003816*                (:L655-AANUMORD                                   
003817*                ,:L655-NRRIGORD                                   
003818*                ,:L655-NUMPROG7                                   
003819*                ,:L655-CDMCAGTM                                   
003820*                ,:L655-CDAREGTM                                   
003821*                ,:L655-CDDIPGTM                                   
003822*                ,:L655-TIPOADDE                                   
003823*                ,:L655-KEYADDE1                                   
003824*                ,:L655-KEYADDE2                                   
003825*                ,:L655-KEYADDE3                                   
003826*                ,:L655-KEYADDE4                                   
003827*                ,:L655-CODSOCID                                   
003828*                ,:L655-CDDIVISD                                   
003829*                ,:L655-CENCOSTD                                   
003830*                ,:L655-CODSOCIA                                   
003831*                ,:L655-CDDIVISA                                   
003832*                ,:L655-CENCOSTA                                   
003833*                ,:L655-UNMISURA                                   
003834*                ,:L655-TIPOARTI                                   
003835*                ,:L655-QTAORDIN                                   
003836*                ,:L655-DTCREAZI                                   
003837*                ,:L655-DTULTVAR                                   
003838*                ,:L655-CODUTVAR                                   
003839*                ,:L655-CODSOCIE                                   
003840*                ,:L655-AANUMFAT                                   
003841*                ,:L655-IMPORDIN                                   
003842*                ,:L655-SOCIEMER                                   
003843*                ,:L655-PAESMERC                                   
003844*                ,:L655-TIPORECO                                   
003845*                ,:L655-DTFATTUR)                                  
003846*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 5 TO SQL-STMT-ID 
           MOVE 30 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-AANUMORD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-NRRIGORD
            BY VALUE 0
                     0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-NUMPROG7
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CDMCAGTM
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CDAREGTM
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CDDIPGTM
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-TIPOADDE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-KEYADDE1
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-KEYADDE2
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-KEYADDE3
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-KEYADDE4
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CODSOCID
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CDDIVISD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CENCOSTD
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CODSOCIA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CDDIVISA
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CENCOSTA
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 17 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-UNMISURA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 18 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-TIPOARTI
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 19 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-QTAORDIN
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 20 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-DTCREAZI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 21 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 22 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CODUTVAR
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 23 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CODSOCIE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 24 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-AANUMFAT
            BY VALUE 0
                     0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 25 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-IMPORDIN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 26 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-SOCIEMER
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 27 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-PAESMERC
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 28 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-TIPORECO
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 29 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-DTFATTUR
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 6 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003847 G32-EX. EXIT.                                                    
003848*----------------------------------------------------------------*
003849 G33-CERCA-NUMERO.                                                
003850*----------------------------------------------------------------*
003851     MOVE SPACES                 TO  DCNUME.                      
003852     MOVE 'R'                    TO  DCNU-FLAGOPER.               
003853     MOVE 'NETMCOST'             TO  DCNU-SIGLNUME.               
003854     PERFORM W00-SCTNUME                                          
003855        THRU W00-EX.                                              
003856     MOVE DCNU-NUMEAUTO          TO  WS-NUMEAUT2.                 
003857     ADD 1                       TO  WS-FATTUR7 .                 
003858     MOVE WS-NUMEAUT2            TO  DCNU-NUMEAUTO.               
003859     MOVE 'U'                    TO  DCNU-FLAGOPER.               
003860     MOVE 'NETMCOST'             TO  DCNU-SIGLNUME.               
003861     PERFORM W00-SCTNUME                                          
003862        THRU W00-EX.                                              
003863 G33-EX. EXIT.                                                    
003864*----------------------------------------------------------------*
003865 G35-UPDATE-ORDILOGI-K.                                           
003866*----------------------------------------------------------------*
003867     MOVE WCOM-AANUMORD           TO L652-AANUMORD.               
003868     MOVE WS-ESENTIVA-K           TO L652-ESENTIVA.               
003869     MOVE 'G35-'                  TO WCOM-CODABEND.               
003870     MOVE 'UPDATE'                TO WCOM-FILECTRL.               
003871     MOVE 'ORDILOGI'              TO WCOM-FILENOME.               
003872     MOVE L652-AANUMORD           TO WCOM-FILECTRL.               
003874     
      *EXEC SQL 
      *UPDATE DLOGISTI.TORDILOGI                               
003875*             SET ESENTIVA = :L652-ESENTIVA                        
003876*           WHERE AANUMORD = :L652-AANUMORD                        
003877*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 6 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-ESENTIVA
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMORD
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 7 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003878 G35-EX. EXIT.                                                    
003879*----------------------------------------------------------------*
003880 G40-AGGIORNA-TESTATA.                                            
003881*----------------------------------------------------------------*
003882     MOVE SPACES                 TO DCLTORDILOGI.                 
003883     INITIALIZE                     DCLTORDILOGI.                 
003884     MOVE WCOM-AANUMORD          TO L652-AANUMORD.                
003885     MOVE LO20-CODCLIENI         TO L652-CODCLIEN.                
003886     MOVE LO20-CODDIVISI         TO L652-CODDIVIS.                
003887     MOVE LO20-TIPSERVII         TO L652-TIPSERVI.                
003888     MOVE LO20-AAMMCOMPI         TO L652-AAMMCOMP.                
003889     MOVE LO20-FLAGGIVAI         TO L652-FLAGGIVA.                
003890     MOVE LO20-ESENTIVAI         TO L652-ESENTIVA.                
003891     MOVE LO20-CONTODCEI         TO L652-CONTODCE.                
003892     MOVE WS-CODSOCIE            TO L652-SOCIEMER.                
003893     MOVE WCOM-DTCREAZI          TO L652-DTULTVAR.                
003894     MOVE WCOM-UTENCICS          TO L652-CODUTVAR.                
003895     MOVE 'S'                    TO WS-FLAGDATA                   
003896     MOVE 'G40-'                 TO WCOM-CODABEND.                
003897     MOVE 'UPDATE'               TO WCOM-FILEFUNZ.                
003898     MOVE 'ORDILOGI'             TO WCOM-FILENOME                 
003899     MOVE L652-AANUMORD          TO WCOM-FILECTRL                 
003900     
      *EXEC SQL UPDATE DLOGISTI.TORDILOGI                           
003901*                 SET CODCLIEN = :L652-CODCLIEN                    
003902*                    ,CODDIVIS = :L652-CODDIVIS                    
003903*                    ,TIPSERVI = :L652-TIPSERVI                    
003904*                    ,AAMMCOMP = :L652-AAMMCOMP                    
003905*                    ,FLAGGIVA = :L652-FLAGGIVA                    
003906*                    ,ESENTIVA = :L652-ESENTIVA                    
003907*                    ,CONTODCE = :L652-CONTODCE                    
003908*                    ,SOCIEMER = :L652-SOCIEMER                    
003909*                    ,DTULTVAR = :L652-DTULTVAR                    
003910*                    ,CODUTVAR = :L652-CODUTVAR                    
003911*               WHERE AANUMORD = :L652-AANUMORD                    
003912*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 7 TO SQL-STMT-ID 
           MOVE 11 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODCLIEN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODDIVIS
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-TIPSERVI
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AAMMCOMP
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-FLAGGIVA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-ESENTIVA
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CONTODCE
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-SOCIEMER
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODUTVAR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMORD
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 8 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003913     IF SQLCODE NOT = ZEROES                                      
003914        PERFORM Z00-ERRORE                                        
003915           THRU Z00-EX.                                           
003916 G40-EX. EXIT.                                                    
003917*----------------------------------------------------------------*
003918 G50-AGGIORNA-DETTAGLIO.                                          
003919*----------------------------------------------------------------*
003920     PERFORM G60-AGGIORNA-RIGA                                    
003921        THRU G60-EX                                               
003922             VARYING WINDRIGA FROM 1 BY 1                         
003923               UNTIL WINDRIGA > WNUMRIGA.                         
003924     ADD 1                       TO WNUMITEM.                     
003925     PERFORM R20-READQ-TS                                         
003926        THRU R20-EX.                                              
003927 G50-EX. EXIT.                                                    
003928*----------------------------------------------------------------*
003929 G60-AGGIORNA-RIGA.                                               
003930*----------------------------------------------------------------*
003931     IF WPAG-OPERAZIO (WINDRIGA) NOT > SPACES                     
003932        GO TO G60-EX.                                             
003933     MOVE WCOM-AANUMORD          TO L653-AANUMORD.                
003934     IF WPAG-OPERAZIO (WINDRIGA) = 'I'                            
003935        PERFORM L10-SELECT-MAX-NRRIGORD                           
003936           THRU L10-EX                                            
003937        MOVE L653-NRRIGORD       TO WS-NRRIGORD                   
003938        PERFORM G30-INSERISCI-RIGA                                
003939           THRU G30-EX                                            
003940     ELSE                                                         
003941        IF WPAG-OPERAZIO (WINDRIGA) = 'V'                         
003942           MOVE 'S'                         TO WS-FLAGDATA        
003943           MOVE WPAG-NRRIGORD (WINDRIGA)    TO L653-NRRIGORD      
003944           PERFORM G601-UPDATE-RIGA                               
003945              THRU G601-EX                                        
003946           IF LO20-TIPSERVII = 'T' AND                            
003947              A901-TIPOCONS  = 'T'                                
003948              PERFORM G604-UPDATE-DETTORDILOGI                    
003949                 THRU G604-EX                                     
003950           END-IF                                                 
003951        ELSE                                                      
003952           IF WPAG-OPERAZIO (WINDRIGA) = '/'                      
003953              MOVE 'S'                      TO WS-FLAGDATA        
003954              MOVE 'S'                      TO WS-FLAGDELE        
003955              MOVE WPAG-NRRIGORD (WINDRIGA) TO L653-NRRIGORD      
003956              PERFORM G602-ANNULLA-RIGA                           
003957                 THRU G602-EX                                     
003958              IF LO20-TIPSERVII = 'T'                             
003959                 PERFORM G603-AGG-NETMOVEREXPO                    
003960                    THRU G603-EX.                                 
003961     MOVE SPACES                 TO WPAG-OPERAZIO (WINDRIGA).     
003962 G60-EX. EXIT.                                                    
003963*----------------------------------------------------------------*
003964 G601-UPDATE-RIGA.                                                
003965*----------------------------------------------------------------*
003966     MOVE WPAG-CODSERVI  (WINDRIGA) TO L653-CODSERVI.             
003967     MOVE WPAG-UNMISURA  (WINDRIGA) TO L653-UNMISURA.             
003968     MOVE WPAG-QTAORDIN  (WINDRIGA) TO L653-QTAORDIN.             
003969     MOVE WPAG-PREZZORD-N(WINDRIGA) TO L653-PREZZORD.             
003970     MOVE WPAG-IMPORDIN-N(WINDRIGA) TO L653-IMPORDIN.             
003971     MOVE WPAG-NOTENOTE  (WINDRIGA) TO L653-NOTENOTE.             
003972     MOVE WPAG-CENCOSTD  (WINDRIGA) TO L653-CENCOSTD.             
003973     MOVE WPAG-CENCOSTA  (WINDRIGA) TO L653-CENCOSTA.             
003974     MOVE WCOM-DTCREAZI             TO L653-DTULTVAR.             
003975     MOVE WCOM-UTENCICS             TO L653-CODUTVAR.             
003976     MOVE 'G601'                 TO WCOM-CODABEND.                
003977     MOVE 'UPDATE'               TO WCOM-FILEFUNZ.                
003978     MOVE 'RIGORDILOGI'          TO WCOM-FILENOME.                
003979     MOVE SPACES                 TO WCOM-FILECTRL.                
003980     MOVE L653-NRRIGORD          TO WS-NRRIGORD-N.                
003981     STRING L653-AANUMORD ' ' WS-NRRIGORD-X                       
003982             DELIMITED BY SIZE INTO WCOM-FILECTRL.                
003983     
      *EXEC SQL UPDATE DLOGISTI.TRIGORDILOGI                        
003984*                 SET CODSERVI = :L653-CODSERVI                    
003985*                    ,UNMISURA = :L653-UNMISURA                    
003986*                    ,QTAORDIN = :L653-QTAORDIN                    
003987*                    ,PREZZORD = :L653-PREZZORD                    
003988*                    ,IMPORDIN = :L653-IMPORDIN                    
003989*                    ,NOTENOTE = :L653-NOTENOTE                    
003990*                    ,CENCOSTD = :L653-CENCOSTD                    
003991*                    ,CENCOSTA = :L653-CENCOSTA                    
003992*                    ,DTULTVAR = :L653-DTULTVAR                    
003993*                    ,CODUTVAR = :L653-CODUTVAR                    
003994*               WHERE AANUMORD = :L653-AANUMORD                    
003995*                 AND NRRIGORD = :L653-NRRIGORD                    
003996*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 8 TO SQL-STMT-ID 
           MOVE 12 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CODSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-UNMISURA
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-QTAORDIN
            BY VALUE 0
                     0

           MOVE 1035 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-PREZZORD
            BY VALUE 0
                     0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-IMPORDIN
            BY VALUE 0
                     0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-NOTENOTE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CENCOSTD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CENCOSTA
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CODUTVAR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-AANUMORD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-NRRIGORD
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 9 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
003997     IF SQLCODE NOT = ZEROES                                      
003998        PERFORM Z00-ERRORE                                        
003999           THRU Z00-EX.                                           
004000 G601-EX. EXIT.                                                   
004001*----------------------------------------------------------------*
004002 G602-ANNULLA-RIGA.                                               
004003*----------------------------------------------------------------*
004004     MOVE 'G602'                 TO WCOM-CODABEND.                
004005     MOVE 'UPDANN'               TO WCOM-FILEFUNZ.                
004006     MOVE 'RIGORDILOGI'          TO WCOM-FILENOME.                
004007     MOVE SPACES                 TO WCOM-FILECTRL.                
004008     MOVE L653-NRRIGORD          TO WS-NRRIGORD-N.                
004009     STRING L653-AANUMORD ' ' WS-NRRIGORD-X                       
004010             DELIMITED BY SIZE INTO WCOM-FILECTRL.                
004011     MOVE WCOM-DTCREAZI          TO L653-DTANNULL.                
004012     MOVE WCOM-DTCREAZI          TO L653-DTULTVAR.                
004013     MOVE WCOM-UTENCICS          TO L653-CODUTVAR.                
004014     
      *EXEC SQL UPDATE DLOGISTI.TRIGORDILOGI                        
004015*                 SET DTANNULL = :L653-DTANNULL                    
004016*                    ,DTULTVAR = :L653-DTULTVAR                    
004017*                    ,CODUTVAR = :L653-CODUTVAR                    
004018*               WHERE AANUMORD = :L653-AANUMORD                    
004019*                 AND NRRIGORD = :L653-NRRIGORD                    
004020*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 9 TO SQL-STMT-ID 
           MOVE 5 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-DTANNULL
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CODUTVAR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-AANUMORD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-NRRIGORD
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 10 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
004021     IF SQLCODE NOT = ZEROES                                      
004022        PERFORM Z00-ERRORE                                        
004023           THRU Z00-EX.                                           
004024 G602-EX. EXIT.                                                   
004025*----------------------------------------------------------------*
004026 G603-AGG-NETMOVEREXPO.                                           
004027*----------------------------------------------------------------*
004028     MOVE L653-AANUMORD          TO T358-AANUMORD                 
004029     MOVE L653-NRRIGORD          TO T358-NRRIGORD                 
004030     MOVE 'G603-'                TO WCOM-CODABEND                 
004031     MOVE 'UPDATE'               TO WCOM-FILEFUNZ                 
004032     MOVE 'NETMOVEREXPO'         TO WCOM-FILENOME                 
004033     MOVE T358-AANUMORD          TO WCOM-FILECTRL                 
004035     
      *EXEC SQL 
      *UPDATE DTRASP.TNETMOVEREXPO                             
004036*             SET AANUMORD = ' '                                   
004037*                ,NRRIGORD = 0                                     
004038*           WHERE AANUMORD = :T358-AANUMORD                        
004039*             AND NRRIGORD = :T358-NRRIGORD                        
004040*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 10 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-AANUMORD
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE T358-NRRIGORD
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 11 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
004041 G603-EX. EXIT.                                                   
004042*----------------------------------------------------------------*
004043 G604-UPDATE-DETTORDILOGI.                                        
004044*----------------------------------------------------------------*
004045     MOVE L653-AANUMORD              TO L655-AANUMORD             
004046     MOVE L653-NRRIGORD              TO L655-NRRIGORD             
004047     MOVE 1                          TO L655-NUMPROG7             
004048     MOVE L653-QTAORDIN              TO L655-QTAORDIN             
004049     MOVE L653-IMPORDIN              TO L655-IMPORDIN             
004050     MOVE 'LOGI'                     TO L655-TIPORECO             
004051     MOVE WCOM-DTCREAZI              TO L655-DTULTVAR             
004052     MOVE WCOM-UTENCICS              TO L655-CODUTVAR             
004053     MOVE 'G604-'                    TO WCOM-CODABEND             
004054     MOVE 'UPDATE'                   TO WCOM-FILECTRL             
004055     MOVE 'DETTORDILOGI'             TO WCOM-FILENOME             
004056     MOVE L655-AANUMORD              TO WCOM-FILECTRL             
004058     
      *EXEC SQL 
      *UPDATE DLOGISTI.TDETTORDILOGI                           
004059*             SET QTAORDIN = :L655-QTAORDIN                        
004060*                ,IMPORDIN = :L655-IMPORDIN                        
004061*                ,DTULTVAR = :L655-DTULTVAR                        
004062*                ,CODUTVAR = :L655-CODUTVAR                        
004063*           WHERE AANUMORD = :L655-AANUMORD                        
004064*             AND NRRIGORD = :L655-NRRIGORD                        
004065*             AND NUMPROG7 = :L655-NUMPROG7                        
004066*             AND TIPORECO = :L655-TIPORECO                        
004067*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 11 TO SQL-STMT-ID 
           MOVE 8 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-QTAORDIN
            BY VALUE 0
                     0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-IMPORDIN
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-CODUTVAR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-AANUMORD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-NRRIGORD
            BY VALUE 0
                     0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-NUMPROG7
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L655-TIPORECO
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 12 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
004068 G604-EX. EXIT.                                                   
004069*----------------------------------------------------------------*
004070 G70-ANNULLA-ORDINE.                                              
004071*----------------------------------------------------------------*
004072     MOVE WCOM-AANUMORD          TO L653-AANUMORD.                
004073     PERFORM L50-SELECT-RIGA-ANN                                  
004074        THRU L50-EX.                                              
004075     IF L653-NRRIGORD > ZEROES                                    
004076        GO TO G70-EX.                                             
004077     MOVE WCOM-AANUMORD          TO L652-AANUMORD.                
004078     MOVE 'G70-'                 TO WCOM-CODABEND.                
004079     MOVE 'UPDANN'               TO WCOM-FILEFUNZ.                
004080     MOVE 'ORDILOGI'             TO WCOM-FILENOME.                
004081     MOVE L652-AANUMORD          TO WCOM-FILECTRL.                
004082     MOVE WCOM-DTCREAZI          TO L652-DTANNULL.                
004083     MOVE WCOM-DTCREAZI          TO L652-DTULTVAR.                
004084     MOVE WCOM-UTENCICS          TO L652-CODUTVAR.                
004085     MOVE SPACES                 TO L652-DATAESTR.                
004086     
      *EXEC SQL UPDATE DLOGISTI.TORDILOGI                           
004087*                 SET DTANNULL = :L652-DTANNULL                    
004088*                    ,DATAESTR = :L652-DATAESTR                    
004089*                    ,DTULTVAR = :L652-DTULTVAR                    
004090*                    ,CODUTVAR = :L652-CODUTVAR                    
004091*               WHERE AANUMORD = :L652-AANUMORD                    
004092*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 12 TO SQL-STMT-ID 
           MOVE 5 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTANNULL
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DATAESTR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODUTVAR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMORD
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 13 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
004093     IF SQLCODE NOT = ZEROES                                      
004094        PERFORM Z00-ERRORE                                        
004095           THRU Z00-EX.                                           
004096     PERFORM G95-AGGIORNA-DATAESTR                                
004097        THRU G95-EX.                                              
004098     MOVE LOW-VALUE              TO AVILO20O.                     
004099     MOVE WCOM-AANUMORD          TO L653-AANUMORD.                
004100 G70-EX. EXIT.                                                    
004101*----------------------------------------------------------------*
004102 G80-AGGIORNA-DATA.                                               
004103*----------------------------------------------------------------*
004104     MOVE WCOM-AANUMORD          TO L652-AANUMORD.                
004105     MOVE 'G80-'                 TO WCOM-CODABEND.                
004106     MOVE 'UPDANN'               TO WCOM-FILEFUNZ.                
004107     MOVE 'ORDILOGI'             TO WCOM-FILENOME.                
004108     MOVE L652-AANUMORD          TO WCOM-FILECTRL.                
004109     MOVE WCOM-DTCREAZI          TO L652-DTULTVAR.                
004110     MOVE WCOM-UTENCICS          TO L652-CODUTVAR.                
004111     MOVE SPACES                 TO L652-DATAESTR.                
004112     
      *EXEC SQL UPDATE DLOGISTI.TORDILOGI                           
004113*                 SET DATAESTR = :L652-DATAESTR                    
004114*                    ,DTULTVAR = :L652-DTULTVAR                    
004115*                    ,CODUTVAR = :L652-CODUTVAR                    
004116*               WHERE AANUMORD = :L652-AANUMORD                    
004117*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 13 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DATAESTR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODUTVAR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMORD
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 14 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
004118     IF SQLCODE NOT = ZEROES                                      
004119        PERFORM Z00-ERRORE                                        
004120           THRU Z00-EX.                                           
004121     PERFORM G95-AGGIORNA-DATAESTR                                
004122        THRU G95-EX.                                              
004123 G80-EX. EXIT.                                                    
004124*----------------------------------------------------------------*
004125 G90-CTRL-SOSPESO.                                                
004126*----------------------------------------------------------------*
004127     MOVE SPACES               TO WS-ERROSOSP                     
004128     PERFORM O00-OPEN-POINTORDI                                   
004129        THRU O00-EX                                               
004130     PERFORM L30-FETCH-POINTORDI                                  
004131        THRU L30-EX.                                              
004132     PERFORM G91-SCORRI-POINTORDI                                 
004133        THRU G91-EX                                               
004134             UNTIL WS-SQLCODE  = +100                             
004135                OR WS-ERROSOSP > ' '.                             
004136     PERFORM O10-CLOSE-POINTORDI                                  
004137        THRU O10-EX.                                              
004138     IF WS-ERROSOSP NOT > ' '                                     
004139        PERFORM G92-UPDATE-ORDILOGI-FLAGSOSP                      
004140           THRU G92-EX.                                           
004141 G90-EX. EXIT.                                                    
004142*----------------------------------------------------------------*
004143 G91-SCORRI-POINTORDI.                                            
004144*----------------------------------------------------------------*
004145     IF WS-ERROSOSP NOT > ' '                                     
004146        MOVE L653-CODSERVI        TO L651-CODSERVI                
004147        PERFORM L15-SELECT-SERVIZIO                               
004148           THRU L15-EX                                            
004149        IF SQLCODE = 100                                          
004150           MOVE '*'               TO WS-ERROSOSP.                 
004151     IF WS-ERROSOSP NOT > ' '                                     
004152        IF L652-TIPSERVI NOT = L651-TIPSERVI                      
004153           MOVE '*'               TO WS-ERROSOSP.                 
004154     IF WS-ERROSOSP NOT > ' '                                     
004155        IF L653-QTAORDIN NOT > 0                                  
004156           MOVE '*'               TO WS-ERROSOSP.                 
004157     IF WS-ERROSOSP NOT > ' '                                     
004158        IF L653-IMPORDIN NOT > 0                                  
004159           MOVE '*'               TO WS-ERROSOSP.                 
004160     IF WS-ERROSOSP NOT > ' '                                     
004161        IF A901-TIPOCONS > SPACES AND                             
004162           A901-CLIFOCON > SPACES                                 
004163           IF L653-CENCOSTD NOT > ' '                             
004164              MOVE '*'            TO WS-ERROSOSP                  
004165           ELSE                                                   
004166              MOVE L653-CENCOSTD  TO A982-CENCOSTO                
004167              MOVE WS-CODSOCIE    TO A982-CODSOCIE                
004168              MOVE A901-TIPOCONS  TO A982-CDDIVISI                
004169              PERFORM L25-SELECT-TCENCOSTO                        
004170                 THRU L25-EX                                      
004171              IF SQLCODE = 100 OR                                 
004172                 A982-ANNULLAM > SPACES                           
004173                 MOVE '*'         TO WS-ERROSOSP.                 
004174     IF WS-ERROSOSP NOT > ' '                                     
004175        IF L653-CENCOSTA NOT > ' '                                
004176           MOVE '*'               TO WS-ERROSOSP                  
004177        ELSE                                                      
004178           MOVE L653-CENCOSTA     TO A982-CENCOSTO                
004179           MOVE LO20-CODSOCIEI    TO A982-CODSOCIE                
004180           MOVE LO20-CDDIVISII    TO A982-CDDIVISI                
004181           PERFORM L25-SELECT-TCENCOSTO                           
004182              THRU L25-EX                                         
004183           IF SQLCODE = 100 OR                                    
004184              A982-ANNULLAM > SPACES                              
004185              MOVE '*'            TO WS-ERROSOSP.                 
004186     IF WS-ERROSOSP NOT > ' '                                     
004187        IF L652-CONTODCE NOT > ' '                                
004188           MOVE '*'               TO WS-ERROSOSP                  
004189        ELSE                                                      
004190           MOVE WS-CODSOCIE       TO A531-CODSOCIE                
004191           MOVE L652-CONTODCE     TO C861-CONTODCE                
004192           PERFORM L71-SELECT-CONTODCE                            
004193              THRU L71-EX                                         
004194           IF SQLCODE = 100                                       
004195              MOVE '*'            TO WS-ERROSOSP                  
004196           ELSE                                                   
004197              IF L652-TIPSERVI     = 'M' AND                      
004198                 C861-CONTPROV(1:4) NOT = 'MAGA'                  
004199                 MOVE '*'         TO WS-ERROSOSP                  
004200              ELSE                                                
004201                 IF L652-TIPSERVI     = 'T'      AND              
004202                    C861-CONTPROV NOT = 'TRASXX' AND              
004203                    C861-CONTPROV NOT = 'TRASAC'                  
004204                    MOVE '*'      TO WS-ERROSOSP                  
004205                 ELSE                                             
004206                    IF LO20-CODCLIENO         = '33020' AND       
004207                       C861-CONTODCE(1:1) NOT = 'G'               
004208                       MOVE '*'      TO WS-ERROSOSP               
004209                    ELSE                                          
004210                       IF LO20-CODCLIENO NOT = '33020'  AND       
004211                          C861-CONTODCE(1:1) = 'G'                
004212                          MOVE '*'      TO WS-ERROSOSP.           
004213     PERFORM L30-FETCH-POINTORDI                                  
004214        THRU L30-EX.                                              
004215 G91-EX. EXIT.                                                    
004216*----------------------------------------------------------------*
004217 G92-UPDATE-ORDILOGI-FLAGSOSP.                                    
004218*----------------------------------------------------------------*
004219     MOVE 'G92-'                 TO WCOM-CODABEND.                
004220     MOVE 'UPDATE'               TO WCOM-FILEFUNZ.                
004221     MOVE 'ORDILOGI'             TO WCOM-FILENOME.                
004222     MOVE L652-AANUMORD          TO WCOM-FILECTRL.                
004223     MOVE WCOM-DTCREAZI          TO L652-DTULTVAR                 
004224     MOVE WCOM-UTENCICS          TO L652-CODUTVAR.                
004225     MOVE SPACES                 TO L652-FLAGSOSP                 
004226                                    L652-DATAESTR.                
004227     
      *EXEC SQL UPDATE DLOGISTI.TORDILOGI                           
004228*                 SET FLAGSOSP = :L652-FLAGSOSP                    
004229*                    ,DATAESTR = :L652-DATAESTR                    
004230*                    ,DTULTVAR = :L652-DTULTVAR                    
004231*                    ,CODUTVAR = :L652-CODUTVAR                    
004232*               WHERE AANUMORD = :L652-AANUMORD                    
004233*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 14 TO SQL-STMT-ID 
           MOVE 5 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-FLAGSOSP
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DATAESTR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODUTVAR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMORD
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 15 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
004234     IF SQLCODE NOT = ZEROES                                      
004235        PERFORM Z00-ERRORE                                        
004236           THRU Z00-EX.                                           
004237     PERFORM G95-AGGIORNA-DATAESTR                                
004238        THRU G95-EX.                                              
004239 G92-EX. EXIT.                                                    
004240*---------------------------------------------------------------* 
004241 G95-AGGIORNA-DATAESTR.                                           
004242*---------------------------------------------------------------* 
004243*--- AGGIORNA DATA ESTRAZIONE SU TUTTI GLI ORDINI CHE HANNO UN    
004244*--- RIFERIMENTO ORDINE VESTEBENE UGUALE A QUELLO DELL'ORDINE     
004245*--- PUNTATO                                                      
004246     MOVE WCOM-DTCREAZI            TO L652-DTULTVAR               
004247                                      L652-DTANNULL.              
004248     MOVE WCOM-UTENCICS            TO L652-CODUTVAR.              
004249     MOVE SPACES                   TO L652-DATAESTR.              
004250     MOVE 'G95-'                   TO WCOM-CODABEND.              
004251     MOVE 'UPDATE'                 TO WCOM-FILEFUNZ.              
004252     MOVE 'ORDISCOR'               TO WCOM-FILENOME.              
004253     MOVE L652-AANUMORD            TO WCOM-FILECTRL.              
004255     
      *EXEC SQL 
      *UPDATE DLOGISTI.TORDILOGI A                             
004256*             SET DTULTVAR = :L652-DTULTVAR                        
004257*                ,CODUTVAR = :L652-CODUTVAR                        
004258*                ,DATAESTR = :L652-DATAESTR                        
004259*           WHERE A.AANUMORD IN                                    
004260*         (SELECT B.AANUMORD                                       
004261*            FROM DLOGISTI.TRIGORDILOGI B                          
004262*                ,DLOGISTI.TRIGORDILOGI C                          
004263*                ,DLOGISTI.TORDILOGI    D                          
004264*           WHERE D.AANUMORD = :L652-AANUMORD                      
004265*             AND D.AANUMORD = C.AANUMORD                          
004266*             AND C.RIFECLIE > ' '                                 
004267*             AND C.RIFECLIE = B.RIFECLIE)                         
004268*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 15 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTULTVAR
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODUTVAR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DATAESTR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMORD
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 16 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
004269 G95-EX. EXIT.                                                    
004270*----------------------------------------------------------------*
004271 H00-CERCA-NUM-ORDINE.                                            
004272*----------------------------------------------------------------*
004273     MOVE SPACES                 TO DCNUME.                       
004274     MOVE 'ORDILOGI'             TO DCNU-SIGLNUME.                
004275     MOVE 'R'                    TO DCNU-FLAGOPER.                
004276     PERFORM W00-SCTNUME                                          
004277        THRU W00-EX.                                              
004278     MOVE DCNU-NUMEAUTO          TO WS-NUMEAUTO                   
004279     ADD     1                   TO WS-NUMEAUTO                   
004280     MOVE WS-NUMEAUTO(2:8)       TO LO20-AANUMORDO                
004281     MOVE WS-NUMEAUTO(2:8)       TO WCOM-AANUMORD                 
004282     MOVE WS-NUMEAUTO            TO DCNU-NUMEAUTO                 
004283     MOVE 'ORDILOGI'             TO DCNU-SIGLNUME                 
004284     MOVE 'U'                    TO DCNU-FLAGOPER                 
004285     PERFORM W00-SCTNUME                                          
004286        THRU W00-EX.                                              
004287 H00-EX. EXIT.                                                   
004288*----------------------------------------------------------------*
004289 L00-SELECT-SOCIETA.                                              
004290*----------------------------------------------------------------*
004291     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
004292     MOVE 'SOCIETA'              TO WCOM-FILENOME.                
004293     MOVE 'L00-'                 TO WCOM-CODABEND.                
004294     MOVE A531-CODSOCIE          TO WCOM-FILECTRL.                
004295     MOVE SPACES                 TO A531-NOMSOCIE.                
004296     MOVE SPACES                 TO A531-CODPAESE.                
004298     
      *EXEC SQL 
      *SELECT NOMSOCIE, CODPAESE                               
004299*            INTO :A531-NOMSOCIE, :A531-CODPAESE                   
004300*            FROM DANAGRAF.TSOCIETA                                
004301*           WHERE CODSOCIE = :A531-CODSOCIE                        
004302*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 16 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 17 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 23 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-NOMSOCIE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODPAESE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 17 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
004303 L00-EX. EXIT.                                                    
004304*----------------------------------------------------------------*
004305 L05-SELECT-DATARIO.                                              
004306*----------------------------------------------------------------*
004307     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
004308     MOVE 'DATARIO'              TO WCOM-FILENOME.                
004309     MOVE 'L05-'                 TO WCOM-CODABEND.                
004310     MOVE WS-ANNOMESE            TO WCOM-FILECTRL.                
004311     MOVE SPACES                 TO A973-DTGIORNO.                
004313     
      *EXEC SQL 
      *SELECT VALUE (MAX(DTGIORNO) , ' ')                      
004314*            INTO :A973-DTGIORNO                                   
004315*            FROM DANAGRAF.TDATARIO                                
004316*           WHERE LEFT(DTGIORNO, 6) = :WS-ANNOMESE                 
004317*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 18 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-ANNOMESE
            BY VALUE 0
                     0

           MOVE 19 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTGIORNO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 18 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
004318 L05-EX. EXIT.                                                    
004319*----------------------------------------------------------------*
004320 L10-SELECT-MAX-NRRIGORD.                                         
004321*----------------------------------------------------------------*
004322     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
004323     MOVE 'TRIGORDILOGI'         TO WCOM-FILENOME.                
004324     MOVE 'L10-'                 TO WCOM-CODABEND.                
004325     MOVE L653-AANUMORD          TO WCOM-FILECTRL.                
004326     MOVE ZEROES                 TO L653-NRRIGORD.                
004328     
      *EXEC SQL 
      *SELECT VALUE(MAX(NRRIGORD), 0)                          
004329*            INTO :L653-NRRIGORD                                   
004330*            FROM DLOGISTI.TRIGORDILOGI                            
004331*           WHERE AANUMORD = :L653-AANUMORD                        
004332*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 20 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-AANUMORD
            BY VALUE 0
                     0

           MOVE 21 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-NRRIGORD
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 19 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
004333 L10-EX. EXIT.                                                    
004334*----------------------------------------------------------------*
004335 L15-SELECT-SERVIZIO.                                             
004336*----------------------------------------------------------------*
004337     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
004338     MOVE 'SERVIZIO'             TO WCOM-FILENOME.                
004339     MOVE 'L15'                  TO WCOM-CODABEND.                
004340     MOVE L651-CODSERVI          TO WCOM-FILECTRL.                
004341     MOVE SPACES                 TO L651-DESSERVI                 
004342                                    L651-TIPSERVI                 
004343                                    L651-UNMISURA                 
004344                                    L651-CENCOSTA                 
004345                                    L651-ESENTIVA                 
004346                                    L651-CONTODCD                 
004347                                    L651-CONTPROV                 
004349     
      *EXEC SQL 
      *SELECT DESSERVI, TIPSERVI                               
004350*                ,UNMISURA, CENCOSTA                               
004351*                ,ESENTIVA, CONTODCD                               
004352*                ,CONTPROV                                         
004353*            INTO :L651-DESSERVI, :L651-TIPSERVI                   
004354*                ,:L651-UNMISURA, :L651-CENCOSTA                   
004355*                ,:L651-ESENTIVA, :L651-CONTODCD                   
004356*                ,:L651-CONTPROV                                   
004357*            FROM DLOGISTI.TSERVIZI                                
004358*           WHERE CODSERVI = :L651-CODSERVI                        
004359*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 22 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CODSERVI
            BY VALUE 0
                     0

           MOVE 23 TO SQL-STMT-ID 
           MOVE 7 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-DESSERVI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-TIPSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-UNMISURA
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CENCOSTA
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-ESENTIVA
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CONTODCD
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CONTPROV
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 20 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
004360     IF L651-CONTPROV NOT > SPACES                                
004361        MOVE ALL '9'             TO L651-CONTPROV.                
004362*    IF LO20-TIPSERVIO = 'L'  AND                                 
004363     IF A901-ESENTIVA = '1'   AND                                 
004364        A531-CODPAESE = '000' AND                                 
004365        A901-PAESFATT = '000' AND                                 
004366        L651-ESENTIVA NOT > SPACES                                
004367        MOVE '1'                 TO L651-ESENTIVA.                
004368 L15-EX. EXIT.                                                    
004369*----------------------------------------------------------------*
004370 L16-SELECT-DIVISE.                                               
004371*----------------------------------------------------------------*
004372     MOVE 'L16-'                 TO WCOM-CODABEND.                
004373     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
004374     MOVE 'DIVISE'               TO WCOM-FILENOME.                
004375     MOVE SPACES                 TO WCOM-FILECTRL.                
004376     STRING A963-CODDIVIS ' ' A531-CODSOCIE                       
004377        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
004378     MOVE SPACES                 TO A963-SIGLADIV                 
004379     MOVE SPACES                 TO A963-DECIDIVI                 
004380     MOVE SPACES                 TO A963-CODDIVRI                 
004381     MOVE SPACES                 TO A963-FLAGEURO                 
004383     
      *EXEC SQL 
      *SELECT D.SIGLADIV                                       
004384*                ,D.DECIDIVI, D.CODDIVRI                           
004385*                ,D.FLAGEURO                                       
004386*            INTO :A963-SIGLADIV                                   
004387*                ,:A963-DECIDIVI, :A963-CODDIVRI                   
004388*                ,:A963-FLAGEURO                                   
004389*            FROM DANAGRAF.TDIVISE  D                              
004390*                ,DANAGRAF.TSOCIETA S                              
004391*           WHERE D.CODDIVIS = :A963-CODDIVIS                      
004392*             AND S.CODSOCIE = :A531-CODSOCIE                      
004393*             AND D.CODDIVRI = S.CODDIVRI                          
004394*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 24 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A963-CODDIVIS
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 25 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A963-SIGLADIV
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A963-DECIDIVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A963-CODDIVRI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A963-FLAGEURO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 21 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
004395 L16-EX. EXIT.                                                    
004396*----------------------------------------------------------------*
004397 L20-SELECT-ORDILOGI.                                             
004398*----------------------------------------------------------------*
004399     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
004400     MOVE 'ORDILOGI'             TO WCOM-FILENOME.                
004401     MOVE 'L20'                  TO WCOM-CODABEND.                
004402     MOVE L652-AANUMORD          TO WCOM-FILECTRL.                
004404     
      *EXEC SQL 
      *SELECT CODCLIEN, CODSOCIE                               
004405*                ,CDDIVISI, DTCARORD                               
004406*                ,CODDIVIS, TIPSERVI                               
004407*                ,FLAGAUTO, FLAGGIVA                               
004408*                ,CONTODCE, DTEVAORD                               
004409*                ,AANUMFAT, AAMMCOMP                               
004410*                ,ESENTIVA                                         
004411*            INTO :L652-CODCLIEN, :L652-CODSOCIE                   
004412*                ,:L652-CDDIVISI, :L652-DTCARORD                   
004413*                ,:L652-CODDIVIS, :L652-TIPSERVI                   
004414*                ,:L652-FLAGAUTO, :L652-FLAGGIVA                   
004415*                ,:L652-CONTODCE, :L652-DTEVAORD                   
004416*                ,:L652-AANUMFAT, :L652-AAMMCOMP                   
004417*                ,:L652-ESENTIVA                                   
004418*            FROM DLOGISTI.TORDILOGI                               
004419*           WHERE AANUMORD = :L652-AANUMORD                        
004420*             AND DTANNULL = ' '                                   
004421*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 26 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMORD
            BY VALUE 0
                     0

           MOVE 27 TO SQL-STMT-ID 
           MOVE 13 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODCLIEN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODSOCIE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CDDIVISI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTCARORD
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODDIVIS
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-TIPSERVI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-FLAGAUTO
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-FLAGGIVA
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CONTODCE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTEVAORD
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMFAT
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AAMMCOMP
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-ESENTIVA
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 22 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
004422 L20-EX. EXIT.                                                    
004423*----------------------------------------------------------------*
004424 L25-SELECT-TCENCOSTO.                                            
004425*----------------------------------------------------------------*
004426     MOVE 'L25-'              TO WCOM-CODABEND.                   
004427     MOVE 'TCENCOSTO'         TO WCOM-FILENOME.                   
004428     MOVE 'SELECT'            TO WCOM-FILEFUNZ.                   
004429     MOVE SPACES              TO WCOM-FILECTRL.                   
004430     STRING A982-CENCOSTO ' ' A982-CODSOCIE ' ' A982-CDDIVISI     
004431          DELIMITED BY SIZE INTO WCOM-FILECTRL.                   
004432     MOVE SPACES                 TO A982-ANNULLAM.                
004433     IF A982-CODSOCIE ='08'                                       
004434        MOVE 'A'                 TO A982-CDDIVISI.                
004436     
      *EXEC SQL 
      *SELECT ANNULLAM                                         
004437*            INTO :A982-ANNULLAM                                   
004438*            FROM DANAGRAF.TCENCOSTO                               
004439*           WHERE CENCOSTO = :A982-CENCOSTO                        
004440*             AND CODSOCIE = :A982-CODSOCIE                        
004441*             AND CDDIVISI = :A982-CDDIVISI                        
004442*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 28 TO SQL-STMT-ID 
           MOVE 3 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A982-CENCOSTO
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A982-CODSOCIE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A982-CDDIVISI
            BY VALUE 0
                     0

           MOVE 29 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A982-ANNULLAM
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 23 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
004443 L25-EX. EXIT.                                                    
004444*---------------------------------------------------------------* 
004445 L30-FETCH-POINTORDI.                                             
004446*---------------------------------------------------------------* 
004447     MOVE 'FETCH'                TO WCOM-FILEFUNZ.                
004448     MOVE 'POINTORDINI'          TO WCOM-FILENOME.                
004449     MOVE 'L30-'                 TO WCOM-CODABEND.                
004451     
      *EXEC SQL 
      *FETCH POINTORDI                                         
004452*           INTO :L652-CODCLIEN, :L652-CODSOCIE                    
004453*               ,:L652-CDDIVISI, :L652-DTCARORD                    
004454*               ,:L652-CODDIVIS, :L652-TIPSERVI                    
004455*               ,:L652-CONTODCE, :L652-DTEVAORD                    
004456*               ,:L652-FLAGAUTO, :L652-FLAGGIVA                    
004457*               ,:L652-AANUMFAT, :L652-DTFATTUR                    
004458*               ,:L652-NRPREATT, :L652-DTPREATT                    
004459*               ,:L653-NRRIGORD, :L653-CODSERVI                    
004460*               ,:L653-UNMISURA, :L653-QTAORDIN                    
004461*               ,:L653-PREZZORD, :L653-IMPORDIN                    
004462*               ,:L653-NOTENOTE                                    
004463*               ,:L653-CENCOSTD, :L653-CENCOSTA                    
004464*               ,:L652-AAMMCOMP, :L653-RIFECLIE                    
004465*               ,:L652-FLAGSOSP, :L652-CODUTEVB                    
004466*               ,:L652-ESENTIVA                                    
004467*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 30 TO SQL-STMT-ID 
           MOVE 28 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODCLIEN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODSOCIE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CDDIVISI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTCARORD
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODDIVIS
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-TIPSERVI
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CONTODCE
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTEVAORD
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-FLAGAUTO
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-FLAGGIVA
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMFAT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTFATTUR
            BY VALUE 0
                     0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-NRPREATT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-DTPREATT
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-NRRIGORD
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CODSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-UNMISURA
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 17 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-QTAORDIN
            BY VALUE 0
                     0

           MOVE 1035 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 18 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-PREZZORD
            BY VALUE 0
                     0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 19 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-IMPORDIN
            BY VALUE 0
                     0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 20 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-NOTENOTE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 21 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CENCOSTD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 22 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CENCOSTA
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 23 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AAMMCOMP
            BY VALUE 0
                     0

           MOVE 15 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 24 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-RIFECLIE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 25 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-FLAGSOSP
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 26 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODUTEVB
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 27 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-ESENTIVA
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
004468     MOVE SQLCODE                TO WS-SQLCODE.                   
004469 L30-EX. EXIT.                                                    
004470*----------------------------------------------------------------*
004471 L35-SELECT-PAESI.                                                
004472*----------------------------------------------------------------*
004473     MOVE 'L35-'                 TO WCOM-CODABEND.                
004474     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
004475     MOVE 'PAESI'                TO WCOM-FILENOME.                
004476     MOVE A528-CDRAGCEN          TO WCOM-FILECTRL                 
004477     MOVE SPACES                 TO A528-CODPAESE                 
004479     
      *EXEC SQL 
      *SELECT CODPAESE                                         
004480*            INTO :A528-CODPAESE                                   
004481*            FROM DANAGRAF.TPAESI                                  
004482*           WHERE CDRAGCEN = :A528-CDRAGCEN                        
004483*           FETCH FIRST 1 ROWS ONLY                                
004484*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 31 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A528-CDRAGCEN
            BY VALUE 0
                     0

           MOVE 32 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A528-CODPAESE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 24 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
004485 L35-EX. EXIT.                                                    
004486*----------------------------------------------------------------*
004487 L40-LEGGI-CLIENTE.                                               
004488*----------------------------------------------------------------*
004489     MOVE 'L40-'                 TO WCOM-CODABEND.                
004490     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
004491     MOVE 'CLIENTI'              TO WCOM-FILENOME.                
004492     MOVE  A901-CODCLIEN         TO WCOM-FILECTRL.                
004493     MOVE SPACES                 TO A901-STATCLIE                 
004494                                    A901-CODSOCIE                 
004495                                    A901-RAGFATTU                 
004496                                    A901-RAGMERCE                 
004497                                    A901-GENECLIE                 
004498                                    A901-CLIEFATT                 
004499                                    A901-TIPOCONS                 
004500                                    A901-CLIFOCON                 
004501                                    A901-CODDIVIS                 
004502                                    A901-PAESMERC                 
004503                                    A901-CDIVACEE                 
004504                                    A901-PAESFATT                 
004505                                    A901-ESENTIVA.                
004507     
      *EXEC SQL 
      *SELECT STATCLIE, CODSOCIE                               
004508*                ,RAGFATTU, RAGMERCE                               
004509*                ,GENECLIE, CLIEFATT                               
004510*                ,TIPOCONS, CLIFOCON                               
004511*                ,CODDIVIS, PAESMERC                               
004512*                ,PAESFATT, CDIVACEE                               
004513*                ,ESENTIVA                                         
004514*            INTO :A901-STATCLIE, :A901-CODSOCIE                   
004515*                ,:A901-RAGFATTU, :A901-RAGMERCE                   
004516*                ,:A901-GENECLIE, :A901-CLIEFATT                   
004517*                ,:A901-TIPOCONS, :A901-CLIFOCON                   
004518*                ,:A901-CODDIVIS, :A901-PAESMERC                   
004519*                ,:A901-PAESFATT, :A901-CDIVACEE                   
004520*                ,:A901-ESENTIVA                                   
004521*            FROM DANAGRAF.TCLIENTI                                
004522*           WHERE CODCLIEN = :A901-CODCLIEN                        
004523*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 33 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODCLIEN
            BY VALUE 0
                     0

           MOVE 34 TO SQL-STMT-ID 
           MOVE 13 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-STATCLIE
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODSOCIE
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-RAGFATTU
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-RAGMERCE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-GENECLIE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CLIEFATT
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-TIPOCONS
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CLIFOCON
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODDIVIS
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-PAESMERC
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-PAESFATT
            BY VALUE 0
                     0

           MOVE 14 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CDIVACEE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-ESENTIVA
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 25 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
004524 L40-EX. EXIT.                                                    
004525*----------------------------------------------------------------*
004526 L50-SELECT-RIGA-ANN.                                             
004527*----------------------------------------------------------------*
004528     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
004529     MOVE 'TRIGORDILOGI'         TO WCOM-FILENOME.                
004530     MOVE 'L50-'                 TO WCOM-CODABEND.                
004531     MOVE L653-AANUMORD          TO WCOM-FILECTRL.                
004532     MOVE ZEROES                 TO L653-NRRIGORD.                
004534     
      *EXEC SQL 
      *SELECT VALUE(MAX(NRRIGORD), 0)                          
004535*            INTO :L653-NRRIGORD                                   
004536*            FROM DLOGISTI.TRIGORDILOGI                            
004537*           WHERE AANUMORD = :L653-AANUMORD                        
004538*             AND DTANNULL = ' '                                   
004539*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 35 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-AANUMORD
            BY VALUE 0
                     0

           MOVE 36 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-NRRIGORD
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 26 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
004540 L50-EX. EXIT.                                                    
004541*---------------------------------------------------------------* 
004542 L55-SELECT-LISTILOGI.                                            
004543*---------------------------------------------------------------* 
004544     MOVE 'L55-'                 TO WCOM-CODABEND.                
004545     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
004546     MOVE 'LISTILOGI'            TO WCOM-FILENOME.                
004547     MOVE SPACES                 TO WCOM-FILECTRL.                
004548     STRING L654-CODCLIEN ' ' L654-TIPSERVI ' '                   
004549            L654-CODDIVIS ' ' L654-CODSERVI ' '                   
004550            WS-AAMMCOMP                                           
004551     DELIMITED BY SIZE         INTO WCOM-FILECTRL.                
004553     
      *EXEC SQL 
      *SELECT PREZZLIS                                         
004554*            INTO :L654-PREZZLIS                                   
004555*            FROM DLOGISTI.TLISTILOGI                              
004556*           WHERE CODCLIEN = :L654-CODCLIEN                        
004557*             AND CODDIVIS = :L654-CODDIVIS                        
004558*             AND TIPSERVI = :L654-TIPSERVI                        
004559*             AND CODSERVI = :L654-CODSERVI                        
004560*             AND DTINILIS <= :WS-AAMMCOMP                         
004561*             AND DTFINLIS >= :WS-AAMMCOMP                         
004562*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 37 TO SQL-STMT-ID 
           MOVE 6 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODCLIEN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODDIVIS
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-TIPSERVI
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODSERVI
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-AAMMCOMP
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-AAMMCOMP
            BY VALUE 0
                     0

           MOVE 38 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1035 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-PREZZLIS
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 27 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
004563 L55-EX. EXIT.                                                    
004564*----------------------------------------------------------------*
004565 L70-SELECT-CONTPROV.                                             
004566*----------------------------------------------------------------*
004567     MOVE 'L70-'                 TO WCOM-CODABEND.                
004568     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
004569     MOVE 'CONTODCE'             TO WCOM-FILENOME.                
004570     MOVE SPACES                 TO WCOM-FILECTRL.                
004571     STRING A531-CODSOCIE ' ' C861-CONTPROV                       
004572        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
004573     MOVE SPACES                 TO C861-CONTODCE.                
004574     MOVE SPACES                 TO C861-DESCRDCE.                
004575     MOVE SPACES                 TO C861-TIPCONTO.                
004576     MOVE SPACES                 TO C861-CONTGRUP.                
004578     
      *EXEC SQL 
      *SELECT T.CONTODCE, T.DESCRDCE                           
004579*                ,T.TIPCONTO, T.CONTGRUP                           
004580*            INTO :C861-CONTODCE, :C861-DESCRDCE                   
004581*                ,:C861-TIPCONTO, :C861-CONTGRUP                   
004582*            FROM DCONTCLI.TCONTIDCE    T                          
004583*                ,DANAGRAF.TSOCIETA     S                          
004584*           WHERE S.CODSOCIE = :A531-CODSOCIE                      
004585*             AND T.CODPIANO = S.CODPIANO                          
004586*             AND T.CONTPROV = :C861-CONTPROV                      
004587*           FETCH FIRST ROW ONLY                                   
004588*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 39 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTPROV
            BY VALUE 0
                     0

           MOVE 40 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTODCE
            BY VALUE 0
                     0

           MOVE 25 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-DESCRDCE
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-TIPCONTO
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTGRUP
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 28 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
004589 L70-EX. EXIT.                                                    
004590*----------------------------------------------------------------*
004591 L71-SELECT-CONTODCE.                                             
004592*----------------------------------------------------------------*
004593     MOVE 'L71-'                 TO WCOM-CODABEND.                
004594     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
004595     MOVE 'CONTODCE'             TO WCOM-FILENOME.                
004596     MOVE SPACES                 TO WCOM-FILECTRL.                
004597     STRING A531-CODSOCIE ' ' C861-CONTODCE ' '                   
004598        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
004599     MOVE SPACES                 TO C861-CONTPROV.                
004600     MOVE SPACES                 TO C861-DESCRDCE.                
004601     MOVE SPACES                 TO C861-TIPCONTO.                
004602     MOVE SPACES                 TO C861-CONTGRUP.                
004604     
      *EXEC SQL 
      *SELECT T.CONTPROV, T.DESCRDCE                           
004605*                ,T.TIPCONTO, T.CONTGRUP                           
004606*            INTO :C861-CONTPROV, :C861-DESCRDCE                   
004607*                ,:C861-TIPCONTO, :C861-CONTGRUP                   
004608*            FROM DCONTCLI.TCONTIDCE    T                          
004609*                ,DANAGRAF.TSOCIETA     S                          
004610*           WHERE S.CODSOCIE = :A531-CODSOCIE                      
004611*             AND T.CODPIANO = S.CODPIANO                          
004612*             AND T.CONTODCE = :C861-CONTODCE                      
004613*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 41 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTODCE
            BY VALUE 0
                     0

           MOVE 42 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTPROV
            BY VALUE 0
                     0

           MOVE 25 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-DESCRDCE
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-TIPCONTO
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE C861-CONTGRUP
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 29 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
004614 L71-EX. EXIT.                                                    
004615*--------------------------------------------------------------*  
004616 L95-SELECT-CLIFOCON.                                             
004617*--------------------------------------------------------------*  
004618     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
004619     MOVE 'SOCIETA-'             TO WCOM-FILENOME.                
004620     MOVE 'L95-'                 TO WCOM-CODABEND.                
004621     MOVE A531-CODFORNI          TO WCOM-FILECTRL.                
004622     MOVE SPACES                 TO WS-CODSOCIE.                  
004623     
      *EXEC SQL SELECT CODSOCIE                                     
004624*                INTO :WS-CODSOCIE                                 
004625*                FROM DANAGRAF.TSOCIETA                            
004626*               WHERE CODFORNI = :A531-CODFORNI                    
004627*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 43 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODFORNI
            BY VALUE 0
                     0

           MOVE 44 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CODSOCIE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 30 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
004628 L95-EX. EXIT.                                                   
004629*----------------------------------------------------------------*
004630 O00-OPEN-POINTORDI.                                              
004631*----------------------------------------------------------------*
004632     MOVE WCOM-AANUMORD          TO L652-AANUMORD.                
004633     MOVE 'OPEN'                 TO WCOM-FILEFUNZ.                
004634     MOVE 'POINTORDI'            TO WCOM-FILENOME.                
004635     MOVE 'O00-'                 TO WCOM-CODABEND.                
004636     MOVE L652-AANUMORD          TO WCOM-FILECTRL.                
004637     
      *EXEC SQL OPEN POINTORDI END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 45 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMORD
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                           .                            
004638 O00-EX. EXIT.                                                   
004639*----------------------------------------------------------------*
004640 O10-CLOSE-POINTORDI.                                             
004641*----------------------------------------------------------------*
004642     MOVE 'CLOSE'                TO WCOM-FILEFUNZ.                
004643     MOVE 'POINTORDI'            TO WCOM-FILENOME.                
004644     MOVE 'O10-'                 TO WCOM-CODABEND.                
004645     MOVE SPACES                 TO WCOM-FILECTRL.                
004646     
      *EXEC SQL CLOSE POINTORDI END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                            .                           
004647 O10-EX. EXIT.                                                   
004648*----------------------------------------------------------------*
004649 P00-PROTEGGI.                                                    
004650*----------------------------------------------------------------*
004651     IF LO20-SOSPESOXI NOT > ' '    AND                           
004652       (WCOM-SALDATOX      > SPACES OR                            
004653        WCOM-FLAGAUTO      = 'A')                                 
004654        MOVE DFHPSKSM            TO LO20-CODCLIENA                
004655        MOVE DFHDFHI             TO LO20-CODCLIENH                
004656        MOVE DFHBLUE             TO LO20-CODCLIENC                
004657        MOVE DFHPSKSM            TO LO20-TIPSERVIA                
004658        MOVE DFHDFHI             TO LO20-TIPSERVIH                
004659        MOVE DFHBLUE             TO LO20-TIPSERVIC                
004660        MOVE DFHPSKSM            TO LO20-CONTODCEA                
004661        MOVE DFHDFHI             TO LO20-CONTODCEH                
004662        MOVE DFHBLUE             TO LO20-CONTODCEC                
004663        MOVE DFHPSKSM            TO LO20-CODDIVISA                
004664        MOVE DFHDFHI             TO LO20-CODDIVISH                
004665        MOVE DFHBLUE             TO LO20-CODDIVISC.               
004666     IF LO20-SOSPESOXI NOT > ' '    AND                           
004667        WCOM-SALDATOX      > SPACES                               
004668        MOVE DFHPSKSM            TO LO20-FLAGGIVAA                
004669        MOVE DFHDFHI             TO LO20-FLAGGIVAH                
004670        MOVE DFHBLUE             TO LO20-FLAGGIVAC                
004671        MOVE DFHPSKSM            TO LO20-AAMMCOMPA                
004672        MOVE DFHDFHI             TO LO20-AAMMCOMPH                
004673        MOVE DFHBLUE             TO LO20-AAMMCOMPC.               
004674     IF LO20-SOSPESOXI NOT > ' '    AND                           
004675        WCOM-AANUMORD      > SPACES                               
004676        MOVE DFHPSKSM            TO LO20-TIPSERVIA                
004677        MOVE DFHDFHI             TO LO20-TIPSERVIH                
004678        MOVE DFHBLUE             TO LO20-TIPSERVIC.               
004679     IF WCOM-FLAGPRGM = 'I'                                       
004680        MOVE DFHPSKSM            TO LO20-RCODSERVA                
004681                                    LO20-RCENCOSDA                
004682                                    LO20-RCENCOSAA                
004683        MOVE DFHBLUE             TO LO20-RCODSERVC                
004684                                    LO20-RCENCOSDC                
004685                                    LO20-RCENCOSAC.               
004686     IF WCOM-FLAGPRGM NOT = 'I'                                   
004687        MOVE DFHPSKSM            TO LO20-FLAGAUTOA                
004688        MOVE DFHDFHI             TO LO20-FLAGAUTOH                
004689        MOVE DFHBLUE             TO LO20-FLAGAUTOC                
004690        IF ERRORE AND MESS-CODERROR = '00048'                     
004691           CONTINUE                                               
004692        ELSE                                                      
004693           MOVE DFHUNPSM         TO LO20-AANUMORDA                
004694           MOVE DFHUNDLN         TO LO20-AANUMORDH                
004695           MOVE DFHGREEN         TO LO20-AANUMORDC.               
004696     PERFORM P10-PROTEGGI-RIGA                                    
004697        THRU P10-EX                                               
004698             VARYING WINDRIGA FROM 1 BY 1                         
004699               UNTIL WINDRIGA > WNUMRIGA.                         
004700 P00-EX. EXIT.                                                   
004701*----------------------------------------------------------------*
004702 P10-PROTEGGI-RIGA.                                               
004703*----------------------------------------------------------------*
004704     IF WCOM-SALDATOX > SPACES                                    
004705        MOVE DFHPSKSM            TO LO20-CODSERVIA(WINDRIGA)      
004706        MOVE DFHDFHI             TO LO20-CODSERVIH(WINDRIGA)      
004707        MOVE DFHBLUE             TO LO20-CODSERVIC(WINDRIGA)      
004708        MOVE DFHPSKSM            TO LO20-QTAORDINA(WINDRIGA)      
004709        MOVE DFHDFHI             TO LO20-QTAORDINH(WINDRIGA)      
004710        MOVE DFHBLUE             TO LO20-QTAORDINC(WINDRIGA)      
004711        MOVE DFHPSKSM            TO LO20-PREZZORDA(WINDRIGA)      
004712        MOVE DFHDFHI             TO LO20-PREZZORDH(WINDRIGA)      
004713        MOVE DFHBLUE             TO LO20-PREZZORDC(WINDRIGA)      
004714        MOVE DFHPSKSM            TO LO20-IMPORDINA(WINDRIGA)      
004715        MOVE DFHDFHI             TO LO20-IMPORDINH(WINDRIGA)      
004716        MOVE DFHBLUE             TO LO20-IMPORDINC(WINDRIGA)      
004717        MOVE DFHPSKSM            TO LO20-CENCOSTDA(WINDRIGA)      
004718        MOVE DFHDFHI             TO LO20-CENCOSTDH(WINDRIGA)      
004719        MOVE DFHBLUE             TO LO20-CENCOSTDC(WINDRIGA)      
004720        MOVE DFHPSKSM            TO LO20-CENCOSTAA(WINDRIGA)      
004721        MOVE DFHDFHI             TO LO20-CENCOSTAH(WINDRIGA)      
004722        MOVE DFHBLUE             TO LO20-CENCOSTAC(WINDRIGA)      
004723        MOVE DFHPSKSM            TO LO20-NOTENOTEA(WINDRIGA)      
004724        MOVE DFHDFHI             TO LO20-NOTENOTEH(WINDRIGA)      
004725        MOVE DFHBLUE             TO LO20-NOTENOTEC(WINDRIGA).     
004726     IF EIBAID = DFHPF11                                          
004727        IF T1-CODSERVI(WINDRIGA) = 'S'                            
004728           MOVE DFHREVRS         TO LO20-CODSERVIH(WINDRIGA)      
004729           MOVE DFHPINK          TO LO20-CODSERVIC(WINDRIGA)      
004730        END-IF                                                    
004731        IF T1-CENCOSTD(WINDRIGA) = 'S'                            
004732           MOVE DFHREVRS         TO LO20-CENCOSTDH(WINDRIGA)      
004733           MOVE DFHPINK          TO LO20-CENCOSTDC(WINDRIGA)      
004734        END-IF                                                    
004735        IF T1-CENCOSTA(WINDRIGA) = 'S'                            
004736           MOVE DFHREVRS         TO LO20-CENCOSTAH(WINDRIGA)      
004737           MOVE DFHPINK          TO LO20-CENCOSTAC(WINDRIGA).     
004738 P10-EX. EXIT.                                                   
004739*----------------------------------------------------------------*
004740 R10-WRITEQ-TS.                                                   
004741*----------------------------------------------------------------*
004742                                                                  
004743* EXEC CICS WRITEQ TS QUEUE (WPAGCTRL)                            
004744*                         FROM (WPAGREFE)                         
004745*                       LENGTH (WPAGLPAG)                         
004746*                         ITEM (WNUMITEM)                         
004747*                     END-EXEC.                                   
004748*    MOVE '*" I   L              ''   #00004587' TO DFHEIV0       
004749     MOVE X'2A2220492020204C20202020' &                           
004750          X'202020202020202020202720' &                           
004751          X'2020233030303034353837' TO DFHEIV0                    
004752     CALL 'kxdfhei1' USING DFHEIV0,                               
004753           WPAGCTRL,                                              
004754           WPAGREFE,                                              
004755           WPAGLPAG,                                              
004756           WNUMITEM,                                              
004757           DFHEIV99,                                              
004758           DFHEIV99                                               
004759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
004760                                                                  
004761 R10-EX. EXIT.                                                    
004762*----------------------------------------------------------------*
004763 R20-READQ-TS.                                                    
004764*----------------------------------------------------------------*
004765     MOVE 'N'                    TO EOQ                           
004766     MOVE SPACES                 TO WPAGREFE.                     
004767     INITIALIZE                     WPAGREFE.                     
004768                                                                  
004769* EXEC CICS HANDLE CONDITION ITEMERR (R20-FINE)                   
004770*                               QIDERR  (R20-FINE)                
004771*    END-EXEC.                                                    
004772*    MOVE '"$<N                  ! & #00004599' TO DFHEIV0        
004773     MOVE X'22243C4E2020202020202020' &                           
004774          X'202020202020202020202120' &                           
004775          X'2620233030303034353939' TO DFHEIV0                    
004776     CALL 'kxdfhei1' USING DFHEIV0                                
004777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
004778                                                                  
004779                                                                  
004780* EXEC CICS READQ TS QUEUE (WPAGCTRL)                             
004781*                        INTO (WPAGREFE)                          
004782*                        ITEM (WNUMITEM)                          
004783*                      LENGTH (WPAGLPAG)                          
004784*                    END-EXEC.                                    
004785*    MOVE '*$II   L              ''   #00004602' TO DFHEIV0       
004786     MOVE X'2A2449492020204C20202020' &                           
004787          X'202020202020202020202720' &                           
004788          X'2020233030303034363032' TO DFHEIV0                    
004789     CALL 'kxdfhei1' USING DFHEIV0,                               
004790           WPAGCTRL,                                              
004791           WPAGREFE,                                              
004792           WPAGLPAG,                                              
004793           WNUMITEM,                                              
004794           DFHEIV99,                                              
004795           DFHEIV99                                               
004796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
004797                                                                  
004798     GO TO R20-EX.                                                
004799 R20-FINE.                                                        
004800     MOVE 'S'                    TO EOQ.                          
004801 R20-EX. EXIT.                                                    
004802*----------------------------------------------------------------*
004803 R25-READQ-WPAGLO20.                                              
004804*----------------------------------------------------------------*
004805     MOVE SPACES                 TO WLO20-CODA.                   
004806     INITIALIZE                     WLO20-CODA.                   
004807                                                                  
004808* EXEC CICS HANDLE CONDITION ITEMERR (R25-EX)                     
004809*                               QIDERR  (R25-EX)                  
004810*    END-EXEC.                                                    
004811*    MOVE '"$<N                  ! '' #00004616' TO DFHEIV0       
004812     MOVE X'22243C4E2020202020202020' &                           
004813          X'202020202020202020202120' &                           
004814          X'2720233030303034363136' TO DFHEIV0                    
004815     CALL 'kxdfhei1' USING DFHEIV0                                
004816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
004817                                                                  
004818                                                                  
004819* EXEC CICS READQ  TS QUEUE   (WPAGLO20)                          
004820*                        INTO    (WLO20-CODA)                     
004821*                        ITEM    (WLO20-ITEM)                     
004822*                        LENGTH  (WLO20-LENGTH)                   
004823*                        END-EXEC.                                
004824*    MOVE '*$II   L              ''   #00004619' TO DFHEIV0       
004825     MOVE X'2A2449492020204C20202020' &                           
004826          X'202020202020202020202720' &                           
004827          X'2020233030303034363139' TO DFHEIV0                    
004828     CALL 'kxdfhei1' USING DFHEIV0,                               
004829           WPAGLO20,                                              
004830           WLO20-CODA,                                            
004831           WLO20-LENGTH,                                          
004832           WLO20-ITEM,                                            
004833           DFHEIV99,                                              
004834           DFHEIV99                                               
004835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
004836                                                                  
004837 R25-EX. EXIT.                                                    
004838*----------------------------------------------------------------*
004839 R30-REWRITE-TS.                                                  
004840*----------------------------------------------------------------*
004841***  MOVE WNUMITEM               TO WPAGRICH.                     
004842                                                                  
004843* EXEC CICS WRITEQ TS QUEUE (WPAGCTRL)                            
004844*                         FROM (WPAGREFE)                         
004845*                       LENGTH (WPAGLPAG)                         
004846*                         ITEM (WNUMITEM) REWRITE                 
004847*                     END-EXEC.                                   
004848*    MOVE '*" IR  L              ''   #00004629' TO DFHEIV0       
004849     MOVE X'2A2220495220204C20202020' &                           
004850          X'202020202020202020202720' &                           
004851          X'2020233030303034363239' TO DFHEIV0                    
004852     CALL 'kxdfhei1' USING DFHEIV0,                               
004853           WPAGCTRL,                                              
004854           WPAGREFE,                                              
004855           WPAGLPAG,                                              
004856           WNUMITEM,                                              
004857           DFHEIV99,                                              
004858           DFHEIV99                                               
004859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
004860                                                                  
004861 R30-EX. EXIT.                                                    
004862*-----------------------------------------------------------*     
004863 R40-REWRITE-WPAGLO20.                                            
004864*-----------------------------------------------------------*     
004865                                                                  
004866* EXEC CICS HANDLE CONDITION ITEMERR(R40-FINE)                    
004867*                               QIDERR (R40-FINE)                 
004868*    END-EXEC.                                                    
004869*    MOVE '"$<N                  ! ( #00004638' TO DFHEIV0        
004870     MOVE X'22243C4E2020202020202020' &                           
004871          X'202020202020202020202120' &                           
004872          X'2820233030303034363338' TO DFHEIV0                    
004873     CALL 'kxdfhei1' USING DFHEIV0                                
004874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
004875                                                                  
004876                                                                  
004877* EXEC CICS WRITEQ TS QUEUE (WPAGLO20)                            
004878*                        FROM  (WLO20-CODA)                       
004879*                        LENGTH(WLO20-LENGTH)                     
004880*                        ITEM  (WLO20-ITEM)                       
004881*                        REWRITE                                  
004882*    END-EXEC.                                                    
004883*    MOVE '*" IR  L              ''   #00004641' TO DFHEIV0       
004884     MOVE X'2A2220495220204C20202020' &                           
004885          X'202020202020202020202720' &                           
004886          X'2020233030303034363431' TO DFHEIV0                    
004887     CALL 'kxdfhei1' USING DFHEIV0,                               
004888           WPAGLO20,                                              
004889           WLO20-CODA,                                            
004890           WLO20-LENGTH,                                          
004891           WLO20-ITEM,                                            
004892           DFHEIV99,                                              
004893           DFHEIV99                                               
004894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
004895                                                                  
004896     GO TO R40-EX.                                                
004897 R40-FINE.                                                        
004898     PERFORM R50-WRITEQ-WPAGLO20                                  
004899        THRU R50-EX.                                              
004900 R40-EX. EXIT.                                                    
004901*----------------------------------------------------------------*
004902 R50-WRITEQ-WPAGLO20.                                             
004903*----------------------------------------------------------------*
004904                                                                  
004905* EXEC CICS WRITEQ TS    QUEUE (WPAGLO20)                         
004906*                           FROM  (WLO20-CODA)                    
004907*                           LENGTH(WLO20-LENGTH)                  
004908*                           END-EXEC.                             
004909*    MOVE '*"     L              ''   #00004655' TO DFHEIV0       
004910     MOVE X'2A2220202020204C20202020' &                           
004911          X'202020202020202020202720' &                           
004912          X'2020233030303034363535' TO DFHEIV0                    
004913     CALL 'kxdfhei1' USING DFHEIV0,                               
004914           WPAGLO20,                                              
004915           WLO20-CODA,                                            
004916           WLO20-LENGTH,                                          
004917           DFHEIV99,                                              
004918           DFHEIV99,                                              
004919           DFHEIV99                                               
004920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
004921                                                                  
004922 R50-EX. EXIT.                                                    
004923*----------------------------------------------------------------*
004924 U00-RETURN-TRAN.                                                 
004925*----------------------------------------------------------------*
004926                                                                  
004927* EXEC CICS RETURN TRANSID (EIBTRNID)                             
004928*                    COMMAREA (WCOM-AREAXXXX)                     
004929*                      LENGTH (WCOM-LUNGHEZZ)                     
004930*                    END-EXEC.                                    
004931*    MOVE '.(CT                  ''   #00004663' TO DFHEIV0       
004932     MOVE X'2E2843542020202020202020' &                           
004933          X'202020202020202020202720' &                           
004934          X'2020233030303034363633' TO DFHEIV0                    
004935     CALL 'kxdfhei1' USING DFHEIV0,                               
004936           EIBTRNID,                                              
004937           WCOM-AREAXXXX,                                         
004938           WCOM-LUNGHEZZ,                                         
004939           DFHEIV99,                                              
004940           DFHEIV99,                                              
004941           DFHEIV99                                               
004942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
004943                                                                  
004944 U00-EX. EXIT.                                                    
004945*----------------------------------------------------------------*
004946 U05-START-TRANSID.                                               
004947*----------------------------------------------------------------*
004948                                                                  
004949* EXEC CICS START   TRANSID (WTRANSID)                            
004950*                      FROM    (WCOM-AREAXXXX)                    
004951*                      LENGTH  (WCOM-LUNGHEZZ)                    
004952*                      TERMID  (EIBTRMID)                         
004953*    END-EXEC                                                     
004954*    MOVE '0( LFT                1   #00004671' TO DFHEIV0        
004955     MOVE X'3028204C4654202020202020' &                           
004956          X'202020202020202020203120' &                           
004957          X'2020233030303034363731' TO DFHEIV0                    
004958     CALL 'kxdfhei1' USING DFHEIV0,                               
004959           DFHEIV99,                                              
004960           WTRANSID,                                              
004961           DFHEIV99,                                              
004962           WCOM-AREAXXXX,                                         
004963           WCOM-LUNGHEZZ,                                         
004964           EIBTRMID,                                              
004965           DFHEIV99,                                              
004966           DFHEIV99,                                              
004967           DFHEIV99,                                              
004968           DFHEIV99,                                              
004969           DFHEIV99,                                              
004970           DFHEIV99,                                              
004971           DFHEIV99,                                              
004972           DFHEIV99,                                              
004973           DFHEIV99,                                              
004974           DFHEIV99                                               
004975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
004976                                                                  
004977* EXEC CICS RETURN  END-EXEC.                                     
004978*    MOVE '.(                    ''   #00004676' TO DFHEIV0       
004979     MOVE X'2E2820202020202020202020' &                           
004980          X'202020202020202020202720' &                           
004981          X'2020233030303034363736' TO DFHEIV0                    
004982     CALL 'kxdfhei1' USING DFHEIV0,                               
004983           DFHEIV99,                                              
004984           DFHEIV99,                                              
004985           DFHEIV99,                                              
004986           DFHEIV99,                                              
004987           DFHEIV99,                                              
004988           DFHEIV99                                               
004989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
004990                                                                  
004991 U05-EX. EXIT.                                                    
004992*----------------------------------------------------------------*
004993 U10-DECODIFICA-MESSAGGI.                                         
004994*----------------------------------------------------------------*
004995     MOVE WCOM-CODILING          TO MESS-CODILING.                
004996*    EXEC SQL INCLUDE SRMESS END-EXEC.                            
      *>>((file: SRMESS))
000001*-------------------------------------------------- SRMESS START* 
000002*-  AUTHOR: FEBBRAIOLA DOMENICO & GIUSEPPE RASPINO              * 
000003*---------------------------------------------------------------* 
000004*                                                               * 
000005*  SUBROUTINE PER LA RICERCA DEI MESSAGGI IN LINGUA             * 
000006*                                                               * 
000007*  N.B.  INSERIRE IN WORKING STORAGE :                          * 
000008*            EXEC SQL INCLUDE FDANA846 END-EXEC.                * 
000009*            COPY  DCMESS                                       * 
000010*                                                               * 
000011*  N.B.  IMPOSTARE DATI IN :                                    * 
000012*            MESS-CODERROR                                      * 
000013*            MESS-CODILING                                      * 
000014*                                                               * 
000015***************************************************************** 
000016                                                                  
000017     MOVE 'SELECT'             TO WCOM-FILEFUNZ                   
000018     MOVE 'FDANA846'           TO WCOM-FILENOME                   
000019     MOVE 'SRME'               TO WCOM-CODABEND                   
000020     MOVE MESS-CODERROR        TO WCOM-FILECTRL                   
000021                                                                  
000022     MOVE SPACES               TO MESS-CAMPI-OUTPUT.              
000023     MOVE MESS-CODERROR        TO A846-CODERROR.                  
000024     MOVE MESS-CODILING        TO A846-CODILING.                  
000025                                                                  
000027     
      *EXEC SQL 
      *SELECT MSGERROR                                         
000028*          INTO  :A846-MSGERROR                                    
000029*          FROM   DANAGRAF.TMESSAGGI                               
000030*          WHERE  CODERROR = :A846-CODERROR AND                    
000031*                 CODILING = :A846-CODILING                        
000032*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 46 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODERROR
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODILING
            BY VALUE 0
                     0

           MOVE 47 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 60 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-MSGERROR
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 31 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000033                                                                  
000034     IF SQLCODE NOT EQUAL ZEROS AND                               
000035        SQLCODE NOT EQUAL +100                                    
000036        PERFORM Z00-ERRORE                                        
000037           THRU Z00-EX                                            
000038     ELSE                                                         
000039        IF SQLCODE EQUAL ZEROS                                    
000040           MOVE MESS-CODERROR    TO MESS-COMCODER                 
000041           MOVE A846-MSGERROR    TO MESS-MESSAGGI                 
000042        ELSE                                                      
000043           MOVE '99999'          TO A846-CODERROR                 
000044           MOVE MESS-CODILING    TO A846-CODILING                 
000046           
      *EXEC SQL 
      *SELECT MSGERROR                                   
000047*                INTO  :A846-MSGERROR                              
000048*                FROM   DANAGRAF.TMESSAGGI                         
000049*                WHERE  CODERROR = :A846-CODERROR AND              
000050*                       CODILING = :A846-CODILING                  
000051*           END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 48 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODERROR
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODILING
            BY VALUE 0
                     0

           MOVE 49 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 60 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-MSGERROR
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 32 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000052           IF SQLCODE EQUAL ZEROS                                 
000053              MOVE MESS-CODERROR TO MESS-COMCODER                 
000054              MOVE A846-MSGERROR TO MESS-MESSAGGI                 
000055           ELSE                                                   
000056              IF SQLCODE = 100                                    
000057                 MOVE MESS-CODERROR   TO MESS-COMCODER            
000058                 MOVE '*** MESSAGGIO  NON  TROVATO ****'          
000059                                      TO MESS-MESSAGGI            
000060              ELSE                                                
000061                 PERFORM Z00-ERRORE                               
000062                     THRU Z00-EX.                                 
000063                                                                  
000064*------------------------------------------------- SRMESS    END* 
      *<<((file: SRMESS))
004997 U10-EX. EXIT.                                                    
004998*----------------------------------------------------------------*
004999 U20-DELETE-TS.                                                   
005000*----------------------------------------------------------------*
005001                                                                  
005002* EXEC CICS DELETEQ TS QUEUE  (WPAGCTRL)                          
005003*                      NOHANDLE                                   
005004*                      END-EXEC.                                  
005005*    MOVE '*&                    #  N#00004687' TO DFHEIV0        
005006     MOVE X'2A2620202020202020202020' &                           
005007          X'202020202020202020202320' &                           
005008          X'204E233030303034363837' TO DFHEIV0                    
005009     CALL 'kxdfhei1' USING DFHEIV0,                               
005010           WPAGCTRL,                                              
005011           DFHEIV99                                               
005012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
005013                                                                  
005014     INITIALIZE WPAGREFE.                                         
005015 U20-EX. EXIT.                                                    
005016*----------------------------------------------------------------*
005017 U30-DELETE-WPAGLO20.                                             
005018*----------------------------------------------------------------*
005019                                                                  
005020* EXEC CICS DELETEQ TS QUEUE   (WPAGLO20)                         
005021*              NOHANDLE                                           
005022*              END-EXEC.                                          
005023*    MOVE '*&                    #  N#00004695' TO DFHEIV0        
005024     MOVE X'2A2620202020202020202020' &                           
005025          X'202020202020202020202320' &                           
005026          X'204E233030303034363935' TO DFHEIV0                    
005027     CALL 'kxdfhei1' USING DFHEIV0,                               
005028           WPAGLO20,                                              
005029           DFHEIV99                                               
005030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
005031                                                                  
005032 U30-EX. EXIT.                                                    
005033*------------------------------------------------------------*    
005034 U90-INCLUDE-SRARR0.                                              
005035*------------------------------------------------------------*    
005036     MOVE WCOM-DECIDIVI          TO ARR0-DECIDIVI                 
005039*    EXEC SQL                                                     
      *         INCLUDE SRARR0                                          
      *    END-EXEC.                                                    
      *>>((file: SRARR0))
000001*----------------------------------------------------------------*
000002*                                                                *
000003*    GESTIONE RIGHE DI FATTURA.                                  *
000004*                                                                *
000005*    CALCOLA IMPORTO ARROTONDATO IN BASE AL NUMERO DI DECIMALI   *
000006*    DELLA DIVISA.                                               *
000007*                                                                *
000008*    N.B.  INSERIRE IN WORKING STORAGE :                         *
000009*                                                                *
000010*    COPY DCARR0.                                                *
000011*                                                                *
000012*----------------------------------------------------------------*
000013                                                                  
000014     MOVE ZERO                   TO ARR0-INTEROXX                 
000015                                    ARR0-DECIMA1X                 
000016                                    ARR0-DECIMA2X.                
000017                                                                  
000018     IF  ARR0-DECIDIVI = '0'                                      
000019         COMPUTE ARR0-IMPORTOX = ARR0-IMPORTOX + 0,5000           
000020         MOVE ARR0-IMPORTOX      TO ARR0-INTEROXX                 
000021         MOVE ARR0-INTEROXX      TO ARR0-IMPORTOX                 
000022     ELSE                                                         
000023         IF  ARR0-DECIDIVI = '1'                                  
000024             COMPUTE ARR0-IMPORTOX = ARR0-IMPORTOX + 0,0500       
000025             MOVE ARR0-IMPORTOX  TO ARR0-DECIMA1X                 
000026             MOVE ARR0-DECIMA1X  TO ARR0-IMPORTOX                 
000027         ELSE                                                     
000028             COMPUTE ARR0-IMPORTOX = ARR0-IMPORTOX + 0,0050       
000029             MOVE ARR0-IMPORTOX  TO ARR0-DECIMA2X                 
000030             MOVE ARR0-DECIMA2X  TO ARR0-IMPORTOX.                
000031                                                                  
      *<<((file: SRARR0))
005040 U90-EX. EXIT.                                                    
005041*------------------------------------------------------------*    
005042 U98-VISUALIZZA-IMPORTO.                                          
005043*------------------------------------------------------------*    
005044     EVALUATE WCOM-DECIDIVI                                       
005045         WHEN '0'                                                 
005046            MOVE WS-IMPORDI9     TO WS-IMPORDIN0                  
005047         WHEN '1'                                                 
005048            MOVE WS-IMPORDI9     TO WS-IMPORDIN1                  
005049         WHEN '2'                                                 
005050            MOVE WS-IMPORDI9     TO WS-IMPORDIN2                  
005051     END-EVALUATE.                                                
005052 U98-EX. EXIT.                                                    
005053*------------------------------------------------------------*    
005054 U99-VISUALIZZA-PREZZO.                                           
005055*------------------------------------------------------------*    
005056     MOVE '4'                    TO WS-DECIDIVI.                  
005057     EVALUATE WS-DECIDIVI                                         
005058         WHEN '0'                                                 
005059            MOVE WS-PREZZOR9     TO WS-PREZZORD0                  
005060         WHEN '1'                                                 
005061            MOVE WS-PREZZOR9     TO WS-PREZZORD1                  
005062         WHEN '2'                                                 
005063            MOVE WS-PREZZOR9     TO WS-PREZZORD2                  
005064         WHEN '3'                                                 
005065            MOVE WS-PREZZOR9     TO WS-PREZZORD3                  
005066         WHEN '4'                                                 
005067            MOVE WS-PREZZOR9     TO WS-PREZZORD4                  
005068     END-EVALUATE.                                                
005069 U99-EX. EXIT.                                                    
005070*---------------------------------------------------------------* 
005071 W00-SCTNUME.                                                     
005072*---------------------------------------------------------------* 
005073     MOVE  'W00'             TO WCOM-CODABEND.                    
005074     MOVE  'SCTNUME'         TO WCOM-FILENOME.                    
005075     MOVE  'LINK'            TO WCOM-FILEFUNZ.                    
005076     MOVE   DCNU-SIGLNUME    TO WCOM-FILECTRL.                    
005077                                                                  
005078* EXEC CICS HANDLE ABEND CANCEL END-EXEC.                         
005079*    MOVE '..C                   " ) #00004743' TO DFHEIV0        
005080     MOVE X'2E2E43202020202020202020' &                           
005081          X'202020202020202020202220' &                           
005082          X'2920233030303034373433' TO DFHEIV0                    
005083     CALL 'kxdfhei1' USING DFHEIV0,                               
005084           DFHEIV99                                               
005085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
005086                                                                  
005087                                                                  
005088* EXEC CICS LINK PROGRAM ('SCTNUME')                              
005089*                   COMMAREA(DCNUME)                              
005090*                   LENGTH  (100)                                 
005091*    END-EXEC.                                                    
005092     MOVE 'SCTNUME' TO DFHEIV1                                    
005093     MOVE 100                                                     
005094       TO DFHEIV11                                                
005095*    MOVE '."C                   (   #00004744' TO DFHEIV0        
005096     MOVE X'2E2243202020202020202020' &                           
005097          X'202020202020202020202820' &                           
005098          X'2020233030303034373434' TO DFHEIV0                    
005099     CALL 'kxdfhei1' USING DFHEIV0,                               
005100           DFHEIV1,                                               
005101           DCNUME,                                                
005102           DFHEIV11,                                              
005103           DFHEIV99,                                              
005104           DFHEIV99,                                              
005105           DFHEIV99,                                              
005106           DFHEIV99                                               
005107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
005108                                                                  
005109                                                                  
005110* EXEC CICS HANDLE ABEND RESET END-EXEC.                          
005111*    MOVE '..R                   " * #00004748' TO DFHEIV0        
005112     MOVE X'2E2E52202020202020202020' &                           
005113          X'202020202020202020202220' &                           
005114          X'2A20233030303034373438' TO DFHEIV0                    
005115     CALL 'kxdfhei1' USING DFHEIV0,                               
005116           DFHEIV99                                               
005117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
005118                                                                  
005119     IF DCNU-RISPOSTA     NOT = '****'                            
005120        PERFORM Z00-ERRORE                                        
005121           THRU Z00-EX.                                           
005122 W00-EX. EXIT.                                                   
005123*---------------------------------------------------------------* 
005124 W10-SCTNMFA.                                                     
005125*---------------------------------------------------------------* 
005126     MOVE  'W10'                    TO WCOM-CODABEND.             
005127     MOVE  'SCTNMFA'                TO WCOM-FILENOME.             
005128     MOVE  'LINK'                   TO WCOM-FILEFUNZ.             
005129     MOVE   DCNU-SIGLNUME           TO WCOM-FILECTRL.             
005130     STRING NMFA-CODSOCIE ' ' NMFA-PAESOCIE ' '                   
005131            NMFA-PAEMERCE ' ' NMFA-PAEFATTU ' '                   
005132            NMFA-CDIVACEE                                         
005133        DELIMITED BY SIZE         INTO WCOM-FILECTRL.             
005134                                                                  
005135* EXEC CICS HANDLE ABEND CANCEL END-EXEC                          
005136*    MOVE '..C                   " + #00004764' TO DFHEIV0        
005137     MOVE X'2E2E43202020202020202020' &                           
005138          X'202020202020202020202220' &                           
005139          X'2B20233030303034373634' TO DFHEIV0                    
005140     CALL 'kxdfhei1' USING DFHEIV0,                               
005141           DFHEIV99                                               
005142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
005143                                                                  
005144* EXEC CICS LINK PROGRAM ('SCTNMFA')                              
005145*                   COMMAREA(DCNMFA)                              
005146*                   LENGTH     (100)                              
005147*    END-EXEC                                                     
005148     MOVE 'SCTNMFA' TO DFHEIV1                                    
005149     MOVE 100                                                     
005150       TO DFHEIV11                                                
005151*    MOVE '."C                   (   #00004765' TO DFHEIV0        
005152     MOVE X'2E2243202020202020202020' &                           
005153          X'202020202020202020202820' &                           
005154          X'2020233030303034373635' TO DFHEIV0                    
005155     CALL 'kxdfhei1' USING DFHEIV0,                               
005156           DFHEIV1,                                               
005157           DCNMFA,                                                
005158           DFHEIV11,                                              
005159           DFHEIV99,                                              
005160           DFHEIV99,                                              
005161           DFHEIV99,                                              
005162           DFHEIV99                                               
005163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
005164                                                                  
005165* EXEC CICS HANDLE ABEND RESET     END-EXEC                       
005166*    MOVE '..R                   " , #00004769' TO DFHEIV0        
005167     MOVE X'2E2E52202020202020202020' &                           
005168          X'202020202020202020202220' &                           
005169          X'2C20233030303034373639' TO DFHEIV0                    
005170     CALL 'kxdfhei1' USING DFHEIV0,                               
005171           DFHEIV99                                               
005172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
005173     IF NMFA-RISPOSTA NOT = '****'                                
005174        MOVE NMFA-RISPOSTA          TO WCOM-CODABEND              
005175        PERFORM Z00-ERRORE                                        
005176           THRU Z00-EX                                            
005177     ELSE                                                         
005178        IF NMFA-FLPARIVA = 'C' AND                                
005179           A901-CDIVACEE NOT > SPACES                             
005180           MOVE '*'                 TO WSWERROR                   
005181           MOVE '00700'             TO MESS-CODERROR              
005182           MOVE DFHUNIMD            TO LO20-CODCLIENA             
005183           MOVE DFHRED              TO LO20-CODCLIENC             
005184           MOVE -1                  TO LO20-CODCLIENL.            
005185 W10-EX. EXIT.                                                   
005186*----------------------------------------------------------------*
005187*COPY SRWTESTN.                                                   
005188*----------------------------------------------------------------*
005189 SRWTESTN.                                                        
005190     PERFORM WTESTN0-TEST-NUMERIC                                 
005191        THRU WTESTN0-EX.                                          
005192 SRWTESTN-EX. EXIT.                                               
005193 WTESTN0-TEST-NUMERIC.                                            
005194     MOVE SPACE          TO WSNU-WSWERROR.                        
005195     MOVE ZERO           TO WSNU-NUMEOUTN                         
005196                            WSNU-MAX                              
005197                            WSNU-NUMEOUTX.                        
005198     MOVE SPACE          TO WSNU-SPACE1                           
005199                            WSNU-SPACE2                           
005200                            WSNU-PLUSMINU.                        
005201     PERFORM VARYING WSNU-IND FROM 1 BY 1                         
005202             UNTIL WSNU-BYTE (WSNU-IND) = '+' OR '-'              
005203                OR WSNU-IND GREATER 18                            
005204     END-PERFORM.                                                 
005205     IF WSNU-BYTE (WSNU-IND) = '+' OR '-'                         
005206        MOVE WSNU-BYTE (WSNU-IND) TO WSNU-PLUSMINU.               
005207     PERFORM VARYING WSNU-MAX FROM 1 BY 1                         
005208             UNTIL WSNU-BYTE (WSNU-MAX) = ','                     
005209                OR WSNU-MAX GREATER 18                            
005210     END-PERFORM.                                                 
005211     IF WSNU-BYTE (WSNU-MAX) = ',' AND                            
005212        WSNU-DECIMALS = ZERO                                      
005213        MOVE '*' TO WSNU-WSWERROR.                                
005214     IF WSNU-BYTE (WSNU-MAX)  = ',' AND                           
005215        WSNU-DECIMALS GREATER ZERO                                
005216        COMPUTE WSNU-INDX = WSNU-INTEGERS + 1                     
005217        MOVE ',' TO WSNU-PICX (WSNU-INDX)                         
005218        MOVE WSNU-MAX TO WSNU-IND                                 
005219        MOVE ZERO     TO WSNU-INDN                                
005220        PERFORM WTEST101-MOVE-BYTE THRU WTEST101-EX               
005221                UNTIL WSNU-IND GREATER 18.                        
005222     IF WSNU-DECIMALS = ZERO                                      
005223        MOVE WSNU-INTEGERS TO WSNU-MAX                            
005224     ELSE                                                         
005225        IF WSNU-BYTE (WSNU-MAX) NOT = ','                         
005226           COMPUTE WSNU-MAX = WSNU-INTEGERS +  1                  
005227           MOVE ',' TO WSNU-PICX (WSNU-MAX)                       
005228           MOVE 18  TO WSNU-MAX                                   
005229        ELSE                                                      
005230           ADD -1 TO WSNU-MAX.                                    
005231     MOVE      14       TO WSNU-INDN                              
005232     MOVE WSNU-INTEGERS TO WSNU-INDX                              
005233     PERFORM WTEST102-MOVE-BYTE THRU WTEST102-EX                  
005234                                     18 TIMES.                    
005235     PERFORM WTEST104-LOOP THRU WTEST104-EX                       
005236             VARYING WSNU-IND  FROM 1 BY 1                        
005237             UNTIL (WSNU-PICX(WSNU-IND) GREATER '0'  AND          
005238                    WSNU-PICX(WSNU-IND) IS NUMERIC) OR            
005239                   WSNU-IND GREATER WSNU-INTEGERS                 
005240     IF WSNU-PLUSMINU GREATER SPACE AND WSNU-NUMEOUTN NOT = 0     
005241        ADD -1             TO WSNU-IND                            
005242        MOVE WSNU-PLUSMINU TO WSNU-PICX(WSNU-IND)                 
005243        IF WSNU-PLUSMINU = '-'                                    
005244           COMPUTE WSNU-NUMEOUTN = WSNU-NUMEOUTN * -1             
005245        ELSE                                                      
005246           IF WSNU-PLUSMINU = '+'                                 
005247              COMPUTE WSNU-NUMEOUTN = WSNU-NUMEOUTN * +1.         
005248     MOVE ZERO  TO WSNU-IND                                       
005249     MOVE SPACE TO WSNU-FORMAT                                    
005250     PERFORM WTEST105-LOOP THRU WTEST105-EX                       
005251                                WSNU-INTEGERS  TIMES              
005252     IF WSNU-DECIMALS GREATER ZERO                                
005253        ADD 1        TO WSNU-IND                                  
005254        MOVE ','     TO WSNU-FORMATX (WSNU-IND)                   
005255        PERFORM WTEST105-LOOP THRU WTEST105-EX                    
005256                                   WSNU-DECIMALS TIMES.           
005257 WTESTN0-EX. EXIT.                                                
005258 WTEST101-MOVE-BYTE.                                              
005259     ADD 1        TO WSNU-IND                                     
005260     IF WSNU-BYTE (WSNU-IND) IS NUMERIC                           
005261        ADD    1  TO WSNU-INDN                                    
005262        MOVE WSNU-BYTE (WSNU-IND) TO WSNU-DEC (WSNU-INDN)         
005263        ADD    1  TO WSNU-INDX                                    
005264        MOVE WSNU-BYTE (WSNU-IND) TO WSNU-PICX(WSNU-INDX)         
005265     ELSE                                                         
005266        IF WSNU-BYTE (WSNU-IND) GREATER SPACE AND                 
005267           WSNU-BYTE (WSNU-IND) NOT = WSNU-PLUSMINU               
005268           MOVE '*' TO WSNU-WSWERROR.                             
005269 WTEST101-EX. EXIT.                                               
005270 WTEST102-MOVE-BYTE.                                              
005271     IF WSNU-BYTE (WSNU-MAX) IS NUMERIC                           
005272        MOVE WSNU-BYTE (WSNU-MAX) TO WSNU-INT  (WSNU-INDN)        
005273        IF WSNU-INDX GREATER ZEROS                                
005274           MOVE WSNU-BYTE (WSNU-MAX) TO WSNU-PICX (WSNU-INDX)     
005275        END-IF                                                    
005276        ADD -1 TO WSNU-INDX WSNU-INDN                             
005277     ELSE                                                         
005278        IF WSNU-BYTE (WSNU-MAX) GREATER SPACE AND                 
005279           WSNU-BYTE (WSNU-MAX) NOT = WSNU-PLUSMINU               
005280           MOVE '*' TO WSNU-WSWERROR.                             
005281     ADD -1 TO WSNU-MAX.                                          
005282 WTEST102-EX. EXIT.                                               
005283 WTEST104-LOOP.                                                   
005284     MOVE SPACE TO WSNU-PICX(WSNU-IND).                           
005285 WTEST104-EX. EXIT.                                               
005286 WTEST105-LOOP.                                                   
005287     ADD 1      TO WSNU-IND.                                      
005288     MOVE ''   TO WSNU-FORMATX(WSNU-IND).                        
005289 WTEST105-EX. EXIT.                                               
005290*----------------------------------------------------------------*
005291*----------------------------------------------------------------*
005292*COPY DCWTSTRP.                                                   
005293*------------------------------------- -------------------------* 
005294*                    --- DCWTSTRp ---                           * 
005295*                GESTIONE DATI PER RICICLO.                     * 
005296*---------------------------------------------------------------* 
005297 LEGGO-RICICLO.                                                   
005298                                                                  
005299* EXEC CICS HANDLE CONDITION ITEMERR (LEGGO-RICICLO-EX)           
005300*                           QIDERR  (LEGGO-RICICLO-EX)            
005301*END-EXEC.                                                        
005302*    MOVE '"$<N                  ! - #00004895' TO DFHEIV0        
005303     MOVE X'22243C4E2020202020202020' &                           
005304          X'202020202020202020202120' &                           
005305          X'2D20233030303034383935' TO DFHEIV0                    
005306     CALL 'kxdfhei1' USING DFHEIV0                                
005307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
005308                                                                  
005309*    CALL 'DFHEI1' USING DFHEIV0                                  
005310*     SERVICE LABEL                                               
005311*     GO TO  LEGGO-RICICLO-EX LEGGO-RICICLO-EX DEPENDING ON       
005312*    DFHEIGDI.                                                    
005313     MOVE  1                     TO TSTR-ITEMXXXX.                
005314     MOVE EIBTRNID               TO TSTR-NOMETRAN.                
005315     MOVE EIBTRMID               TO TSTR-NOMETERM.                
005316                                                                  
005317* EXEC CICS READQ  TS QUEUE   (TSTR-NOMECODA)                     
005318*                    INTO    (TSTR-AREATSTR)                      
005319*                    ITEM    (TSTR-ITEMXXXX)                      
005320*                    LENGTH  (TSTR-LENGCODA)                      
005321*END-EXEC.                                                        
005322*    MOVE '*$II   L              ''   #00004905' TO DFHEIV0       
005323     MOVE X'2A2449492020204C20202020' &                           
005324          X'202020202020202020202720' &                           
005325          X'2020233030303034393035' TO DFHEIV0                    
005326     CALL 'kxdfhei1' USING DFHEIV0,                               
005327           TSTR-NOMECODA,                                         
005328           TSTR-AREATSTR,                                         
005329           TSTR-LENGCODA,                                         
005330           TSTR-ITEMXXXX,                                         
005331           DFHEIV99,                                              
005332           DFHEIV99                                               
005333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
005334                                                                  
005335*    CALL 'DFHEI1' USING DFHEIV0  TSTR-NOMECODA TSTR-AREATSTR     
005336*    TSTR-LENGCODA DFHDUMMY TSTR-ITEMXXXX.                        
005337     MOVE TSTR-AREATSTR          TO WCOM-AREAXXXX.                
005338                                                                  
005339* EXEC CICS DELETEQ TS QUEUE  (TSTR-NOMECODA)                     
005340*                     NOHANDLE                                    
005341*END-EXEC.                                                        
005342*    MOVE '*&                    #  N#00004913' TO DFHEIV0        
005343     MOVE X'2A2620202020202020202020' &                           
005344          X'202020202020202020202320' &                           
005345          X'204E233030303034393133' TO DFHEIV0                    
005346     CALL 'kxdfhei1' USING DFHEIV0,                               
005347           TSTR-NOMECODA,                                         
005348           DFHEIV99                                               
005349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
005350                                                                  
005351*    CALL 'DFHEI1' USING DFHEIV0  TSTR-NOMECODA.                  
005352 LEGGO-RICICLO-EX. EXIT.                                          
005353 SCRIVO-RICICLO.                                                  
005354     MOVE WCOM-AREAXXXX          TO TSTR-AREATSTR.                
005355     MOVE  1                     TO TSTR-ITEMXXXX.                
005356     MOVE EIBTRNID               TO TSTR-NOMETRAN.                
005357     MOVE EIBTRMID               TO TSTR-NOMETERM.                
005358                                                                  
005359* EXEC CICS DELETEQ TS QUEUE  (TSTR-NOMECODA)                     
005360*                     NOHANDLE                                    
005361*END-EXEC.                                                        
005362*    MOVE '*&                    #  N#00004923' TO DFHEIV0        
005363     MOVE X'2A2620202020202020202020' &                           
005364          X'202020202020202020202320' &                           
005365          X'204E233030303034393233' TO DFHEIV0                    
005366     CALL 'kxdfhei1' USING DFHEIV0,                               
005367           TSTR-NOMECODA,                                         
005368           DFHEIV99                                               
005369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
005370                                                                  
005371*    CALL 'DFHEI1' USING DFHEIV0  TSTR-NOMECODA.                  
005372                                                                  
005373* EXEC CICS WRITEQ TS  QUEUE  (TSTR-NOMECODA)                     
005374*                     FROM   (TSTR-AREATSTR)                      
005375*                     ITEM   (TSTR-ITEMXXXX)                      
005376*                     LENGTH (TSTR-LENGCODA)                      
005377*END-EXEC.                                                        
005378*    MOVE '*" I   L              ''   #00004927' TO DFHEIV0       
005379     MOVE X'2A2220492020204C20202020' &                           
005380          X'202020202020202020202720' &                           
005381          X'2020233030303034393237' TO DFHEIV0                    
005382     CALL 'kxdfhei1' USING DFHEIV0,                               
005383           TSTR-NOMECODA,                                         
005384           TSTR-AREATSTR,                                         
005385           TSTR-LENGCODA,                                         
005386           TSTR-ITEMXXXX,                                         
005387           DFHEIV99,                                              
005388           DFHEIV99                                               
005389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
005390                                                                  
005391*    CALL 'DFHEI1' USING DFHEIV0  TSTR-NOMECODA TSTR-AREATSTR     
005392*    TSTR-LENGCODA DFHDUMMY TSTR-ITEMXXXX.                        
005393 SCRIVO-RICICLO-EX. EXIT.                                         
005394*---------------------------------------------------------------* 
005395*----------------------------------------------------------------*
005396*COPY DCPERDB2.                                                   
005397*SRERCICS/P---------S = SOURCE / P = PRECOMPILED ----------------*
005398*----*  ROUTINE INTERCETTA ERRORE CICS                      *----*
005399*----*                                                      *----*
005400*----------------------------------------------------------------*
005401*       QUESTA ROUTINE E' LA PRIMA DA DICHIARARE COME COPY        
005402*----*                                                      *----*
005403*----------------------------------------------------------------*
005404*    ES.    **                                                    
005405*    ES.         COPY SRERCICP.                                   
005406*    ES.    **   SE VOGLIO INTERCETTARE ERRORE DB2                
005407*    ES.         COPY SRERDB2P                                    
005408*    ES.    **   SE VOGLIO INTERCETTARE ERRORE TOTAL              
005409*    ES.         COPY SRERDB2P                                    
005410*    ES.    **  ETC.                                              
005411*    ES.                                                          
005412*    ES.    **   ULTIMA ROUTINE CHE RILASCIA TR-ERRE  PER DECODI  
005413*    ES.    **   ERRORE                                           
005414*    ES.         COPY SRERENDS                                    
005415*                                                                 
005416*----------------------------------------------------------------*
005417 Z00-ERRORE.                                                      
005418*----------------------------------------------------------------*
005419     MOVE DFHEIV0                TO T-COMLINE.                    
005420     PERFORM                                                      
005421        VARYING INDERR FROM 1 BY 1                                
005422            UNTIL INDERR GREATER 25                               
005423               OR EL-COMLINE (INDERR) EQUAL ZERO                  
005424     END-PERFORM.                                                 
005425     MOVE SPACES                 TO WLINEAXX.                     
005426     IF INDERR LESS 26                                            
005427        MOVE EL-COMLINE (INDERR) TO EL-LINE (1)                   
005428        ADD 1                    TO INDERR                        
005429        MOVE EL-COMLINE (INDERR) TO EL-LINE (2)                   
005430        ADD 1                    TO INDERR                        
005431        MOVE EL-COMLINE (INDERR) TO EL-LINE (3)                   
005432        ADD 1                    TO INDERR                        
005433        MOVE EL-COMLINE (INDERR) TO EL-LINE (4)                   
005434        ADD 1                    TO INDERR                        
005435        MOVE EL-COMLINE (INDERR) TO EL-LINE (5).                  
005436     MOVE WLINEAXX               TO WCOM-PRGMLINE.                
005437     MOVE EIBFN                  TO WCOM-CODEIBFN.                
005438     MOVE EIBRCODE               TO WCOM-CODERCOD.                
005439     MOVE SPACES                 TO WCOM-ABENCICS.                
005440     IF EIBRESP  NOT = ZERO OR                                    
005441        EIBRESP2 NOT = ZERO                                       
005442                                                                  
005443* EXEC CICS                                                       
005444*      ASSIGN ABCODE (WCOM-ABENCICS)                              
005445*END-EXEC.                                                        
005446*    MOVE '"((                   "   #00004983' TO DFHEIV0        
005447     MOVE X'222828202020202020202020' &                           
005448          X'202020202020202020202220' &                           
005449          X'2020233030303034393833' TO DFHEIV0                    
005450     CALL 'kxdfhei1' USING DFHEIV0,                               
005451           WCOM-ABENCICS                                          
005452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
005453                                                                  
005454*       CALL 'DFHEI1' USING DFHEIV0  WCOM-ABENCICS.               
005455*SRERDB2S/P -----------------------------------------------------*
005456*----*  ROUTINE INTERCETTA ERRORE DB2                       *----*
005457*----*                                                      *----*
005458*----------------------------------------------------------------*
005459*       QUESTA ROUTINE E' DA DICHIARARE DOPO LA SRERCICS          
005460*                                                                 
005461     MOVE 'ABEN'                 TO WCOM-CODATSX1.                
005462     MOVE EIBTRMID               TO WCOM-CODATSX2.                
005463*    MOVE LENGTH OF SQLCA        TO WCOM-LUNGHERR.                
005464     MOVE 136                    TO WCOM-LUNGHERR.                
005465                                                                  
005466* EXEC CICS WRITEQ TS    QUEUE  (WCOM-CODATSXX)                   
005467*                       FROM   (SQLCA)                            
005468*                       LENGTH (WCOM-LUNGHERR)                    
005469*END-EXEC.                                                        
005470*    MOVE '*"     L              ''   #00004997' TO DFHEIV0       
005471     MOVE X'2A2220202020204C20202020' &                           
005472          X'202020202020202020202720' &                           
005473          X'2020233030303034393937' TO DFHEIV0                    
005474     CALL 'kxdfhei1' USING DFHEIV0,                               
005475           WCOM-CODATSXX,                                         
005476           SQLCA,                                                 
005477           WCOM-LUNGHERR,                                         
005478           DFHEIV99,                                              
005479           DFHEIV99,                                              
005480           DFHEIV99                                               
005481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
005482                                                                  
005483*    CALL 'DFHEI1' USING DFHEIV0  WCOM-CODATSXX SQLCA             
005484*    WCOM-LUNGHERR.                                               
005485*SRERENDS/P------------------------------------------------------*
005486*----*  ROUTINE FINALE                                      *----*
005487*----*                                                      *----*
005488*----------------------------------------------------------------*
005489*       QUESTA ROUTINE DA DICHIARARE PER ULTIMA NELLA SEQUNZA     
005490*       DELLE COPY  PER INTERCETTARE L'ERRORE                     
005491*----------------------------------------------------------------*
005492*----------------------------------------------------------------*
005493      MOVE EIBTRNID              TO WCOM-TRANSAZI.                
005494                                                                  
005495* EXEC CICS SYNCPOINT ROLLBACK                                    
005496*END-EXEC.                                                        
005497*    MOVE '6"R                   !   #00005012' TO DFHEIV0        
005498     MOVE X'362252202020202020202020' &                           
005499          X'202020202020202020202120' &                           
005500          X'2020233030303035303132' TO DFHEIV0                    
005501     CALL 'kxdfhei1' USING DFHEIV0                                
005502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
005503                                                                  
005504*     CALL 'DFHEI1' USING DFHEIV0.                                
005505                                                                  
005506* EXEC CICS ASSIGN SYSID (WCOM-SYSID)                             
005507*END-EXEC.                                                        
005508*    MOVE '"(         $          "   #00005015' TO DFHEIV0        
005509     MOVE X'222820202020202020202024' &                           
005510          X'202020202020202020202220' &                           
005511          X'2020233030303035303135' TO DFHEIV0                    
005512     CALL 'kxdfhei1' USING DFHEIV0,                               
005513           WCOM-SYSID                                             
005514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
005515                                                                  
005516*     CALL 'DFHEI1' USING DFHEIV0  WCOM-SYSID.                    
005517      MOVE 'ABEN'                    TO WCOM-CODATSX1.            
005518      MOVE EIBTRMID                  TO WCOM-CODATSX2.            
005519*     MOVE LENGTH OF WCOM-AREA-ERROR TO WCOM-LUNGHERR.            
005520      MOVE 200                       TO WCOM-LUNGHERR.            
005521*EXEC CICS WRITEQ TS QUEUE  (WCOM-CODATSXX)                       
005522                                                                  
005523* EXEC CICS WRITEQ TS                                             
005524*                    QUEUE  (WCOM-CODATSXX)                       
005525*                    FROM   (WCOM-AREA-ERROR)                     
005526*                    LENGTH (WCOM-LUNGHERR)                       
005527*END-EXEC.                                                        
005528*    MOVE '*"     L              ''   #00005023' TO DFHEIV0       
005529     MOVE X'2A2220202020204C20202020' &                           
005530          X'202020202020202020202720' &                           
005531          X'2020233030303035303233' TO DFHEIV0                    
005532     CALL 'kxdfhei1' USING DFHEIV0,                               
005533           WCOM-CODATSXX,                                         
005534           WCOM-AREA-ERROR,                                       
005535           WCOM-LUNGHERR,                                         
005536           DFHEIV99,                                              
005537           DFHEIV99,                                              
005538           DFHEIV99                                               
005539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
005540                                                                  
005541*     CALL 'DFHEI1' USING DFHEIV0  WCOM-CODATSXX WCOM-AREA-ERROR  
005542*    WCOM-LUNGHERR.                                               
005543                                                                  
005544* EXEC CICS START TRANSID ('ERRE')                                
005545*                FROM    (WCOM-AREAXXXX)                          
005546*                LENGTH  (WCOM-LUNGHEZZ)                          
005547*                TERMID  (EIBTRMID)                               
005548*END-EXEC.                                                        
005549     MOVE 'ERRE' TO DFHEIV5                                       
005550*    MOVE '0( LFT                1   #00005030' TO DFHEIV0        
005551     MOVE X'3028204C4654202020202020' &                           
005552          X'202020202020202020203120' &                           
005553          X'2020233030303035303330' TO DFHEIV0                    
005554     CALL 'kxdfhei1' USING DFHEIV0,                               
005555           DFHEIV99,                                              
005556           DFHEIV5,                                               
005557           DFHEIV99,                                              
005558           WCOM-AREAXXXX,                                         
005559           WCOM-LUNGHEZZ,                                         
005560           EIBTRMID,                                              
005561           DFHEIV99,                                              
005562           DFHEIV99,                                              
005563           DFHEIV99,                                              
005564           DFHEIV99,                                              
005565           DFHEIV99,                                              
005566           DFHEIV99,                                              
005567           DFHEIV99,                                              
005568           DFHEIV99,                                              
005569           DFHEIV99,                                              
005570           DFHEIV99                                               
005571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
005572                                                                  
005573*      MOVE 'ERRE' TO DFHC0040                                    
005574*     CALL 'DFHEI1' USING DFHEIV0  DFHEID0 DFHDUMMY DFHC0040      
005575*    WCOM-AREAXXXX WCOM-LUNGHEZZ EIBTRMID.                        
005576                                                                  
005577* EXEC CICS ABEND ABCODE (WCOM-ABENCICS)                          
005578*                CANCEL                                           
005579*END-EXEC.                                                        
005580*    MOVE '.,AC                  "   #00005038' TO DFHEIV0        
005581     MOVE X'2E2C41432020202020202020' &                           
005582          X'202020202020202020202220' &                           
005583          X'2020233030303035303338' TO DFHEIV0                    
005584     CALL 'kxdfhei1' USING DFHEIV0,                               
005585           WCOM-ABENCICS                                          
005586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
005587                                                                  
005588*     CALL 'DFHEI1' USING DFHEIV0  WCOM-ABENCICS.                 
005589 Z00-EX. EXIT.                                                    
005590*----------------------------------------------------------------*
005591                                                                  
005592 9999-DFHBACK SECTION.                                            
005593     MOVE '9%                    "   ' TO DFHEIV0                 
005594     MOVE 'AVTLO20' TO DFHEIV1                                    
005595     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1                        
005596     GOBACK.                                                      
005597 9999-DFHEXIT.                                                    
005598     IF DFHEIGDJ EQUAL 0001                                       
005599         NEXT SENTENCE                                            
005600     ELSE IF DFHEIGDJ EQUAL 2                                     
005601         GO TO Z00-ERRORE                                         
005602         DEPENDING ON DFHEIGDI                                    
005603     ELSE IF DFHEIGDJ EQUAL 3                                     
005604         GO TO B05-NORESP                                         
005605         DEPENDING ON DFHEIGDI                                    
005606     ELSE IF DFHEIGDJ EQUAL 6                                     
005607         GO TO R20-FINE,                                          
005608               R20-FINE                                           
005609         DEPENDING ON DFHEIGDI                                    
005610     ELSE IF DFHEIGDJ EQUAL 7                                     
005611         GO TO R25-EX,                                            
005612               R25-EX                                             
005613         DEPENDING ON DFHEIGDI                                    
005614     ELSE IF DFHEIGDJ EQUAL 8                                     
005615         GO TO R40-FINE,                                          
005616               R40-FINE                                           
005617         DEPENDING ON DFHEIGDI                                    
005618     ELSE IF DFHEIGDJ EQUAL 13                                    
005619         GO TO LEGGO-RICICLO-EX,                                  
005620               LEGGO-RICICLO-EX                                   
005621         DEPENDING ON DFHEIGDI.                                   
005622     MOVE '9%                    "   ' TO DFHEIV0                 
005623     MOVE 'AVTLO20' TO DFHEIV1                                    
005624     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1                        
005625     GOBACK.                                                      
