      *((program: AVTLO24.cblx))
000001*-------------* PROGRAMMA  CICS/DB2 COBOL2 *--------------------* 
000002 ID  DIVISION.                                                    
000003*-------------*                                                   
000004 PROGRAM-ID. AVTLO24.                             
000005*---------------------------------------------------------------* 
000006*                ELENCO ORDINI LOGISTICA                        * 
000007*---------------------------------------------------------------* 
000008*  IL PROGRAMMA GESTISCE L'ELENCO DEGLI ORDINI PER SERVIZI      * 
000009*  DI LOGISTICA.                                                * 
000010*  OPERAZIONI POSSIBILI:                                        * 
000011*                                                               * 
000012*  - * -   PER AGGANCIARE LO22 (ELENCO ORDINI NORMALE)          * 
000013*---------------------------------------------------------------* 
000014 ENVIRONMENT DIVISION.                                            
000015*---------------------*                                           
000016 CONFIGURATION SECTION.                                           
000017 SPECIAL-NAMES.                                                   
000018     DECIMAL-POINT IS COMMA.                                      
000019 DATA DIVISION.                                                   
000020*--------------*                                                  
000021 WORKING-STORAGE SECTION.

       01  SQLDA-ID pic 9(4) comp-5.
       01  SQLDSIZE pic 9(4) comp-5.
       01  SQL-STMT-ID pic 9(4) comp-5.
       01  SQLVAR-INDEX pic 9(4) comp-5.
       01  SQL-DATA-TYPE pic 9(4) comp-5.
       01  SQL-HOST-VAR-LENGTH pic 9(9) comp-5.
       01  SQL-S-HOST-VAR-LENGTH pic 9(9) comp-5.
       01  SQL-S-LITERAL pic X(258).
       01  SQL-LITERAL1 pic X(130).
       01  SQL-LITERAL2 pic X(130).
       01  SQL-LITERAL3 pic X(130).
       01  SQL-LITERAL4 pic X(130).
       01  SQL-LITERAL5 pic X(130).
       01  SQL-LITERAL6 pic X(130).
       01  SQL-LITERAL7 pic X(130).
       01  SQL-LITERAL8 pic X(130).
       01  SQL-LITERAL9 pic X(130).
       01  SQL-LITERAL10 pic X(130).
       01  SQL-IS-LITERAL pic 9(4) comp-5 value 1.
       01  SQL-IS-INPUT-HVAR pic 9(4) comp-5 value 2.
       01  SQL-CALL-TYPE pic 9(4) comp-5.
       01  SQL-SECTIONUMBER pic 9(4) comp-5.
       01  SQL-INPUT-SQLDA-ID pic 9(4) comp-5.
       01  SQL-OUTPUT-SQLDA-ID pic 9(4) comp-5.
       01  SQLA-PROGRAM-ID.
           05 SQL-PART1 pic 9(4) COMP-5 value 172.
           05 SQL-PART2 pic X(6) value "AEAQAI".
           05 SQL-PART3 pic X(24) value "QAlDMfFn01111 2         ".
           05 SQL-PART4 pic 9(4) COMP-5 value 8.
           05 SQL-PART5 pic X(8) value "DB2XMT  ".
           05 SQL-PART6 pic X(120) value LOW-VALUES.
           05 SQL-PART7 pic 9(4) COMP-5 value 8.
           05 SQL-PART8 pic X(8) value "AVTLO24 ".
           05 SQL-PART9 pic X(120) value LOW-VALUES.
                                                                        
000022 01  DFH-START PIC X(04).                                         
000023 01  FILLER                      PIC X(08) VALUE 'DCWCOMMA'.      
000024*    COPY DCWCOMMA.                                               
000025*---------------------------------------------------------------* 
000026*----*            AREA DI PASSAGGIO DATI - WWTERRE         *----* 
000027*---------------------------------------------------------------* 
000028 01  WCOM-LUNGHERR                PIC S9(4) COMP VALUE +200.      
000029 01  WCOM-AREA-ERROR.                                             
000030     02 FILLER                    PIC X(8) VALUE 'CICSERRO'.      
000031     02 WCOM-FILEMESG.                                            
000032        04 WCOM-FILEFUNZ          PIC X(10).                      
000033        04 WCOM-FILESTAT          PIC X(5).                       
000034        04 WCOM-SQLCODEX REDEFINES WCOM-FILESTAT                  
000035                                  PIC -Z(4).                      
000036        04 WCOM-FILENOME          PIC X(30).                      
000037        04 WCOM-FILECTR1.                                         
000038           05 WCOM-FILECTRL       PIC X(35).                      
000039     02 WCOM-MESSAGE1 REDEFINES WCOM-FILEMESG.                    
000040        05 WCOM-MESSAGES          PIC X(80).                      
000041     02 WCOM-CODABEND             PIC X(4).                       
000042     02 WCOM-ABENCICS             PIC X(4).                       
000043     02 WCOM-PRGMLINE             PIC X(5)  VALUE SPACES.         
000044     02 WCOM-CODEIBFN             PIC X(2).                       
000045     02 WCOM-CODERCOD             PIC X(6).                       
000046     02 FILLER                    PIC X(91).                      
000047*---------------------------------------------------------------* 
000048*----*                AREA DI COMMAREA                     *----* 
000049*---------------------------------------------------------------* 
000050*---------------------- LUNGHEZZA WCOM-AREAXXXX                   
000051 01  WCOM-LUNGHEZZ                     PIC S9(4) COMP VALUE +300. 
000052*---------------------- NOME DEL PROGRAMMA                        
000053 01  WCOM-AREAXXXX.                                               
000054     05  WCOM-NOMEPRGM                 PIC X(8)  VALUE SPACES.    
000055*---------------------- PAGINA RICHIESTA                          
000056     05  WCOM-PAGIRICH                 PIC S9(5) COMP-3.          
000057*---------------------- PAGINA LISTATA                            
000058     05  WCOM-PAGILIST                 PIC S9(5) COMP-3.          
000059*---------------------- PAGINA ULTIMA                             
000060     05  WCOM-PAGIULTI                 PIC S9(5) COMP-3.          
000061*---------------------- FLAG PER MODULO GESTIONE FUNZIONI ESTERNE 
000062     05  WCOM-FLAGFUNZ.                                           
000063         10  WCOM-RETURNXX             PIC X(1).                  
000064         10  WCOM-DELETETS             PIC X(1).                  
000065         10  WCOM-CODILING             PIC X(1).                  
000066*---------------------- FLAG PER AGGIORNAMENTI                    
000067     05  WCOM-FLAGPRGM                 PIC X(1)  VALUE SPACES.    
000068*---------------------- SOTTOSISTEMA CICS                         
000069     05  WCOM-SYSID                    PIC X(4)  VALUE '????'.    
000070*---------------------- PRINTER ABBINATA CON 'P'                  
000071     05  WCOM-PRINTERX                 PIC X(4).                  
000072*---------------------- PRINTER ASSOCIATA MAG. FINITI             
000073     05  WCOM-PRINTERY                 PIC X(4).                  
000074*---------------------- PRINTER ASSOCIATA ALLA TRANSAZIONE        
000075     05  WCOM-PRINTERT                 PIC X(4).                  
000076*---------------------- PRINTER BAR-CODE O MODULI SPECIALI        
000077     05  WCOM-PRINTERB                 PIC X(4).                  
000078*---------------------- TRANSAZIONE                               
000079     05  WCOM-TRANSAZI                 PIC X(4).                  
000080*---------------------- DATA DEL GIORNO DA MENU'                  
000081     05  WCOM-DATAXXXX.                                           
000082         10  WCOM-DATAGGXX             PIC X(2).                  
000083         10  WCOM-DATAGGXN REDEFINES WCOM-DATAGGXX  PIC 9(2).     
000084         10  WCOM-BARRAUNO             PIC X(1).                  
000085         10  WCOM-DATAMMXX             PIC X(2).                  
000086         10  WCOM-DATAMMXN REDEFINES WCOM-DATAMMXX  PIC 9(2).     
000087         10  WCOM-BARRADUE             PIC X(1).                  
000088         10  WCOM-DATAAAXX.                                       
000089             15 WCOM-DATAAAX1          PIC 9(1).                  
000090             15 WCOM-DATAAAX2          PIC 9(1).                  
000091         10  WCOM-DATAAAXN REDEFINES WCOM-DATAAAXX  PIC 9(2).     
000092*---------------------- NOME DELLA CODA TS GENERICA               
000093     05  WCOM-CODATSXX.                                           
000094         10 WCOM-CODATSX1              PIC X(4)  VALUE SPACES.    
000095         10 WCOM-CODATSX2              PIC X(4)  VALUE SPACES.    
000096*---------------------- DATA DEL GIORNO                           
000097     05  WCOM-DTCREAZI.                                           
000098         10 WCOM-DTCREAZI-SY.                                     
000099            15 WCOM-DTCREAZI-SS        PIC X(2).                  
000100            15 WCOM-DTCREAZI-YY        PIC X(2).                  
000101         10 WCOM-DTCREAZI-SYN REDEFINES WCOM-DTCREAZI-SY PIC 9(4).
000102         10 WCOM-DTCREAZI-MM           PIC X(2).                  
000103         10 WCOM-DTCREAZI-DD           PIC X(2).                  
000104*---------------------- CODICE UTENTE                             
000105     05  WCOM-UTENCICS                 PIC X(6).                  
000106*---------------------- TRANSAZIONI NELL' AMBITO DELLA RICHIESTA  
000107     05  WCOM-INDITRAN                 PIC 9(2).                  
000108     05  WCOM-TABETRAN.                                           
000109         10  WCOM-MENUTRAN  OCCURS 10  PIC X(4).                  
000110         10  WCOM-PAGITRAN  OCCURS 10  PIC S9(5) COMP-3.          
000111*---------------------- FLAG AVVISI UTENTI/TRANSAZIONI DA SCTUTENT
000112     05  WCOM-FLAGUTEN                 PIC X(1).                  
000113     05  WCOM-FLAGTRAN                 PIC X(1).                  
000114*---------------------- FLAG UTENTI LIMITATI                      
000115     05  WCOM-FLAGLIMI                 PIC X(1).                  
000116*---------------------- LIBERI                                    
000117     05  FILLER                        PIC X(25).                 
000118*---------------------- RICHIESTA                                 
000119     05  WCOM-RIKIESTA.                                           
000120         10   WCOM-COMODOXX            PIC X(125).                
000121*    COPY DCLOGI.                                                 
000122******************************************************************
000123*                        *** DCLOGI ***                          *
000124*     DSECT RELATIVA ALLA COMMAREA DEGLI ORDINI DI LOGISTICA     *
000125*                    - LUNGHEZZA 175 BYTES -                     *
000126******************************************************************
000127         10  FILLER                           PIC X(200).         
000128     05  WORK-RICHIESTA REDEFINES WCOM-RIKIESTA.                  
000129         10  WCOM-DCLOGI.                                         
000130             15  WCOM-CODUTENT                PIC X(06).          
000131             15  WCOM-CODSOCIE                PIC X(02).          
000132             15  WCOM-CDDIVISI                PIC X(01).          
000133             15  WCOM-CODDEPOS                PIC X(02).          
000134             15  WCOM-CODCLIEN                PIC X(05).          
000135             15  WCOM-CLIFOCON                PIC X(05).          
000136             15  WCOM-CODSERVI                PIC X(06).          
000137             15  WCOM-TIPSERVI                PIC X(01).          
000138             15  WCOM-CODDIVIS                PIC X(02).          
000139             15  WCOM-UNMISURA                PIC X(02).          
000140             15  WCOM-AANUMORD                PIC X(08).          
000141             15  WCOM-NRRIGORD                PIC S9(3)  COMP-3.  
000142             15  WCOM-CONTODCE                PIC X(06).          
000143             15  WCOM-SALDATOX                PIC X(01).          
000144             15  WCOM-OPERAZIO                PIC X(01).          
000145             15  WCOM-DECIDIVI                PIC X(01).          
000146             15  WCOM-CONTOPER                PIC S9(5)  COMP-3.  
000147             15  WCOM-CODERROR                PIC X(05).          
000148             15  WCOM-FLAGAUTO                PIC X(01).          
000149             15  WCOM-SOCIEMER                PIC X(02).          
000150             15  WCOM-TIPOARTI                PIC X(01).          
000151             15  WCOM-PAESPROV                PIC X(03).          
000152             15  WCOM-PAESMERC                PIC X(03).          
000153             15  WCOM-DTCARORD                PIC X(08).          
000154             15  WCOM-FLAGMANU                PIC X(01).          
000155             15  WCOM-FLAGGIVA                PIC X(01).          
000156             15  WCOM-TIPORECO                PIC X(04).          
000157             15  WCOM-AANUMFAT                PIC X(08).          
000158             15  WCOM-DTFATTUR                PIC X(08).          
000159             15  WCOM-NRPREATT                PIC X(18).          
000160             15  WCOM-DTPREATT                PIC X(08).          
000161             15  WCOM-STATUSXX                PIC X(01).          
000162             15  WCOM-AAMMCOMP                PIC X(06).          
000163             15  WCOM-CENCOSTD                PIC X(05).          
000164             15  WCOM-CENCOSTA                PIC X(05).          
000165             15  WCOM-ESENTIVA                PIC X(01).          
000166             15  FILLER                       PIC X(32).          
000167*--------------------------------------------------------------*  
000168     10  WCOM-DATIPROG.                                           
000169         15 WCOM-RAGFATTU        PIC X(24).                       
000170         15 WCOM-RAGFATT2        PIC X(24).                       
000171         15 WCOM-DESSERVI        PIC X(40).                       
000172         15 FILLER               PIC X(62).                       
000173 01  FILLER                      PIC X(08)  VALUE 'DCWWORK1'.     
000174*    COPY DCWWORK1.                                               
000175***************************************************************** 
000176******            DATI DI USO GENERALE      (DCWWORK1)     ****** 
000177***************************************************************** 
000178 01  DCW-WORK1.                                                   
000179*----------------- NOME MAPPA CON GESTIONE CODICE LINGUA          
000180     05 WNOMEMAP.                                                 
000181        10  FILLER                     PIC X(2).                  
000182        10  WCODLING                   PIC X.                     
000183        10  FILLER                     PIC X(4).                  
000184*----------------- COMODO LINEA CONTENENTE L'ULTIMO EXEC CICS     
000185     05 WLINEAXX.                                                 
000186        10  EL-LINE    OCCURS 5        PIC X.                     
000187*----------------- COMODO CONTENENTE DFHEIV0                      
000188     05 T-COMLINE.                                                
000189        10  EL-COMLINE OCCURS 29       PIC X.                     
000190*----------------- INDICE PER SCORRERE LA T-COMLINE.              
000191     05 INDERR                         PIC S9(5) COMP-3 VALUE +0. 
000192*----------------- TRANSAZIONE IMPOSTATA AL MOMENTO DEL PF5 / PF4 
000193     05 WTRANSID                       PIC X(4) VALUE SPACES.     
000194*----------------- INDICE DELLA RIGA DI MAPPA                     
000195     05 WINDRIGA                       PIC S9(3) COMP-3 VALUE +0. 
000196*----------------- NUMERO MASSIMO DI RIGHE IN UNA MAPPA           
000197     05 WNUMRIGA                       PIC 9(2)        VALUE 0.   
000198*----------------- FLAG PER GLI ERRORI A LIVELLO DI DATI-MAPPA    
000199     05 WSWERROR                       PIC X      VALUE SPACES.   
000200        88 ERRORE                                 VALUE '*'.      
000201*----------------- NUMERO PAGINA RICHIESTO                        
000202     05 WPAGRICH                       PIC S9(5) COMP-3 VALUE +0. 
000203*----------------- NUMERO RECORD CODA-TS                          
000204     05 WNUMITEM                       PIC S9(4) COMP VALUE +0.   
000205*----------------- INDICE DELLA CODA DI PAGINAZIONE TS            
000206     05 WPAGIPAG                       PIC S9(4) COMP VALUE +0.   
000207*----------------- CHIAVE DELLA CODA DI PAGINAZIONE TS            
000208     05 WPAGCTRL.                                                 
000209        10  WPAGNOME                   PIC X(4)    VALUE 'PAGI'.  
000210        10  WPAGVIDE                   PIC X(4).                  
000211*----------------- LUNGHEZZA  CODA DI PAGINAZIONE TS              
000212     05 WPAGLPAG                       PIC S9(4) COMP VALUE +0.   
000213*----------------- ABSOLUTE TIME                                  
000214     05 WABSTIME                       PIC S9(15) COMP-3 VALUE +0.
000215*----------------- ABSOLUTE YEAR                                  
000216     05 WABSYEAR                       PIC S9(8) COMP VALUE +0.   
000217*----------------- FOR RESP OPTION                                
000218     05 WEIBRESP                       PIC S9(8) COMP VALUE +0.   
000219*----------------- FOR CVDA  (CICS VALUE DATA AREA)               
000220     05 WNOLOG                         PIC S9(8) COMP VALUE +0.   
000221     05 WCVDA                          PIC S9(8) COMP VALUE +0.   
000222     05 WCVDA-OPEN                     PIC S9(8) COMP VALUE +18.  
000223     05 WCVDA-CLOSED                   PIC S9(8) COMP VALUE +19.  
000224*----------------- FOR BIF DEEDIT                                 
000225     05 WWTWSNU                        PIC X(8) VALUE 'WWTWSNU'.  
000226     05 WLENGTH                        PIC S9(4) COMP.            
000227*----------------- AREA DELLA CODA TS DI PAGINAZIONE              
000228 01  WPAGREFE.                                                    
000229     05  FILLER                        PIC X    VALUE SPACES.     
000230     05  WPAG-OCODCLIE           PIC X(05).                       
000231     05  WPAG-ORAGFATT           PIC X(24).                       
000232     05  WPAGREF1 OCCURS 17.                                      
000233         15  WPAG-RAAMMCOM       PIC X(06).                       
000234         15  WPAG-RTIPSERV       PIC X(01).                       
000235         15  WPAG-RCODSERV       PIC X(06).                       
000236         15  WPAG-RDESSERV       PIC X(40).                       
000237         15  WPAG-RCODDIVI       PIC X(02).                       
000238         15  WPAG-RQTAORDI       PIC S9(11)V99   COMP-3.          
000239         15  WPAG-RIMPORDI       PIC S9(11)V99   COMP-3.          
000240 01  FILLER                      PIC X(08) VALUE 'COMODI**'.      
000241 01  COMODI.                                                      
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000242     05  WSWS-ORDINAME           PIC X(01)  VALUE SPACES.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000243     05  WS-CODERROR             PIC X(05)  VALUE SPACES.         
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000244     05  MIN-AANUMFAT            PIC X(08)  VALUE SPACES.         
000245     05  MAX-AANUMFAT            PIC X(08)  VALUE SPACES.         
000246     05  MIN-CODCLIEN            PIC X(05)  VALUE SPACES.         
000247     05  MAX-CODCLIEN            PIC X(05)  VALUE SPACES.         
000248     05  MIN-FLAGSOSP            PIC X(01)  VALUE SPACES.         
000249     05  MAX-FLAGSOSP            PIC X(01)  VALUE SPACES.         
000250     05  MIN-TIPSERVI            PIC X(01)  VALUE SPACES.         
000251     05  MAX-TIPSERVI            PIC X(01)  VALUE SPACES.         
000252     05  MIN-AAMMCOMP            PIC X(08)  VALUE SPACES.         
000253     05  MAX-AAMMCOMP            PIC X(08)  VALUE SPACES.         
000254     05  MIN-DTEVAORD            PIC X(08)  VALUE SPACES.         
000255     05  MAX-DTEVAORD            PIC X(08)  VALUE SPACES.         
000256     05  MIN-DTFATTUR            PIC X(08)  VALUE SPACES.         
000257     05  MAX-DTFATTUR            PIC X(08)  VALUE SPACES.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000258     05  WS-SQLCODE              PIC S9(5) COMP-3 VALUE +0.       
000259     05  WS-SQLCODE2             PIC S9(5) COMP-3 VALUE +0.       
000260     05  WS-OPERAZIO             PIC X(01)  VALUE SPACES.         
000261     05  WS-IND1                 PIC S9(3) COMP-3 VALUE +0.       
000262     05  WS-IND2                 PIC S9(3) COMP-3 VALUE +0.       
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000263     05  WS-CODCLIEN             PIC X(05)  VALUE SPACES.         
000264     05  WS-RAGFATTU             PIC X(24)  VALUE SPACES.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000265     05  WS-RAGFATT2.                                             
000266         10 WS-BYTE2             PIC X OCCURS 24.                 
000267     05  WS-RAGFATT3.                                             
000268         10 WS-BYTE3             PIC X OCCURS 24.                 
000269 01  WPAGCTR2.                                                    
000270     10  WPAGNOM2                PIC X(4)    VALUE 'CLIE'.        
000271     10  WPAGVID2                PIC X(4).                        
000272 01  WPAGLPA2                    PIC S9(4) COMP VALUE +0.         
000273 01  WPAGREF2.                                                    
000274     05 WPA2-ELEMENTO            OCCURS 100.                      
000275        10 WPA2-CODCLIEN         PIC X(05).                       
000276        10 WPA2-TOTQUANT         PIC S9(11)V99.                   
000277        10 WPA2-TOTIMPOR         PIC S9(11)V99.                   
000278*---------------------------------------------------------------- 
000279 01  FILLER                      PIC X(08) VALUE '*DFHAID*'.      
000280*    COPY DFHAID   SUPPRESS.                                      
000281***************************************************************** 
000282*                                                               * 
000283* Copyright (c) 2016-2022 NTT DATA, Inc.                        * 
000284* All rights reserved.                                          * 
000285*                                                               * 
000286***************************************************************** 
000287 01  DFHAID.                                                      
000288     02  DFHNULL   PIC X VALUE "-".                               
000289     02  DFHENTER  PIC X VALUE "'".                               
000290     02  DFHCLEAR  PIC X VALUE "_".                               
000291     02  DFHCLRP   PIC X VALUE "|".                               
000292     02  DFHPEN    PIC X VALUE "=".                               
000293     02  DFHOPID   PIC X VALUE "W".                               
000294     02  DFHMSRE   PIC X VALUE "X".                               
000295     02  DFHSTRF   PIC X VALUE "h".                               
000296     02  DFHTRIG   PIC X VALUE '"'.                               
000297     02  DFHPA1    PIC X VALUE "%".                               
000298     02  DFHPA2    PIC X VALUE ">".                               
000299     02  DFHPA3    PIC X VALUE ",".                               
000300     02  DFHPF1    PIC X VALUE "1".                               
000301     02  DFHPF2    PIC X VALUE "2".                               
000302     02  DFHPF3    PIC X VALUE "3".                               
000303     02  DFHPF4    PIC X VALUE "4".                               
000304     02  DFHPF5    PIC X VALUE "5".                               
000305     02  DFHPF6    PIC X VALUE "6".                               
000306     02  DFHPF7    PIC X VALUE "7".                               
000307     02  DFHPF8    PIC X VALUE "8".                               
000308     02  DFHPF9    PIC X VALUE "9".                               
000309     02  DFHPF10   PIC X VALUE ":".                               
000310     02  DFHPF11   PIC X VALUE "#".                               
000311     02  DFHPF12   PIC X VALUE "@".                               
000312     02  DFHPF13   PIC X VALUE "A".                               
000313     02  DFHPF14   PIC X VALUE "B".                               
000314     02  DFHPF15   PIC X VALUE "C".                               
000315     02  DFHPF16   PIC X VALUE "D".                               
000316     02  DFHPF17   PIC X VALUE "E".                               
000317     02  DFHPF18   PIC X VALUE "F".                               
000318     02  DFHPF19   PIC X VALUE "G".                               
000319     02  DFHPF20   PIC X VALUE "H".                               
000320     02  DFHPF21   PIC X VALUE "I".                               
000321     02  DFHPF22   PIC X VALUE "[".                               
000322     02  DFHPF23   PIC X VALUE ".".                               
000323     02  DFHPF24   PIC X VALUE "<".                               
000324 01  FILLER                      PIC X(08) VALUE 'DCWATTRI'.      
000325*    COPY DCWATTRI SUPPRESS.                                      
000326******************************************************************
000327******       VALORI    DEGLI   ATTRIBUTI    (WCOPATTR)      ******
000328******************************************************************
000329 01       DFHBMSCA.                                               
000330   05     DFHBMEOF                    PIC X  VALUE ' '.           
000331*  X'80'  CC DI RITORNO DI UN CAMPO ANNULLATO CON CANCEL F.C.     
000332   05     DFHBMUNP                    PIC X  VALUE ' '.           
000333*  X'40'  NON PROTETTO                                            
000334   05     DFHBMFSE                    PIC X  VALUE 'A'.           
000335*  X'C1'  NON PROTETTO MDT                                        
000336   05     DFHUNPSP                    PIC X  VALUE 'D'.           
000337*  X'C4'  NON PROTETTO SELEZIONABILE                              
000338   05     DFHUNPSM                    PIC X  VALUE 'E'.           
000339*  X'C5'  NON PROTETTO SELEZIONABILE MDT                          
000340   05     DFHBMBRY                    PIC X  VALUE 'H'.           
000341*  X'C8'  NON PROTETTO LUMINOSO SELEZIONABILE                     
000342   05     DFHUNIMD                    PIC X  VALUE 'I'.           
000343*  X'C9'  NON PROTETTO LUMINOSO SELEZIONABILE MDT                 
000344   05     DFHBMDAR                    PIC X  VALUE '<'.           
000345*  X'4C'  NON PROTETTO NON VISIBILE                               
000346   05     DFHUNNOD                    PIC X  VALUE '('.           
000347*  X'4D'  NON PROTETTO NON VISIBILE MDT                           
000348   05     DFHBMUNN                    PIC X  VALUE '&'.           
000349*  X'50'  NON PROTETTO NUMERICO                                   
000350   05     DFHUNNUM                    PIC X  VALUE 'J'.           
000351*  X'D1'  NON PROTETTO NUMERICO MDT                               
000352   05     DFHUNPNS                    PIC X  VALUE 'M'.           
000353*  X'D4'  NON PROTETTO NUMERICO SELEZIONABILE                     
000354   05     DFHUNNSM                    PIC X  VALUE 'N'.           
000355*  X'D5'  NON PROTETTO NUMERICO SELEZIONABILE MDT                 
000356   05     DFHUNNBS                    PIC X  VALUE 'Q'.           
000357*  X'D8'  NON PROTETTO NUMERICO LUMINOSO SELEZIONABILE            
000358   05     DFHUNBSM                    PIC X  VALUE 'R'.           
000359*  X'D9'  NON PROTETTO NUMERICO LUMINOSO SELEZIONABILE MDT        
000360   05     DFHUNPND                    PIC X  VALUE '*'.           
000361*  X'5C'  NON PROTETTO NUMERICO NON VISIBILE                      
000362   05     DFHUNNON                    PIC X  VALUE ')'.           
000363*  X'5D'  NON PROTETTO NUMERICO NON VISIBILE MDT                  
000364   05     DFHBMPRO                    PIC X  VALUE '-'.           
000365*  X'60'  PROTETTO                                                
000366   05     DFHBMPRF                    PIC X  VALUE '/'.           
000367*  X'61'  PROTETTO MDT                                            
000368   05     DFHPROSP                    PIC X  VALUE 'U'.           
000369*  X'E4'  PROTETTO SELEZIONABILE                                  
000370   05     DFHPRSPM                    PIC X  VALUE 'V'.           
000371*  X'E5'  PROTETTO SELEZIONABILE MDT                              
000372   05     DFHPROTI                    PIC X  VALUE 'Y'.           
000373*  X'E8'  PROTETTO LUMINOSO SELEZIONABILE                         
000374   05     DFHPRLSM                    PIC X  VALUE 'Z'.           
000375*  X'E9'  PROTETTO LUMINOSO SELEZIONABILE MDT                     
000376   05     DFHPROTN                    PIC X  VALUE '%'.           
000377*  X'6C'  PROTETTO NON VISIBILE                                   
000378   05     DFHPRODM                    PIC X  VALUE '_'.           
000379*  X'6D'  PROTETTO NON VISIBILE MDT                               
000380   05     DFHBMASK                    PIC X  VALUE '0'.           
000381*  X'F0'  PROTETTO SKIP                                           
000382   05     DFHBMASF                    PIC X  VALUE '1'.           
000383*  X'F1'  PROTETTO SKIP  MDT                                      
000384   05     DFHPRSKS                    PIC X  VALUE '4'.           
000385*  X'F4'  PROTETTO SKIP  SELEZIONABILE                            
000386   05     DFHPSKSM                    PIC X  VALUE '5'.           
000387*  X'F5'  PROTETTO SKIP  SELEZIONABILE MDT                        
000388   05     DFHBMASB                    PIC X  VALUE '8'.           
000389*  X'F8'  PROTETTO SKIP  LUMINOSO SELEZIONABILE                   
000390   05     DFHPROIM                    PIC X  VALUE '9'.           
000391*  X'F9'  PROTETTO SKIP  LUMINOSO SELEZIONABILE MDT               
000392*  05     DFHPRSKD                    PIC X  VALUE '§'.           
000393   05     DFHPRSKD                    PIC X  VALUE '@'.           
000394*  X'7C'  PROTETTO SKIP  NON VISIBILE                             
000395   05     DFHPSKDM                    PIC X  VALUE QUOTE.         
000396*  X'7D'  PROTETTO SKIP  NON VISIBILE MDT                         
000397   05     DFHBLUE                     PIC X  VALUE '1'.           
000398*  X'F1'  COLORE BLUE                                             
000399   05     DFHRED                      PIC X  VALUE '2'.           
000400*  X'F2'  COLORE ROSSO                                            
000401   05     DFHPINK                     PIC X  VALUE '3'.           
000402*  X'F3'  COLORE ROSA                                             
000403   05     DFHGREEN                    PIC X  VALUE '4'.           
000404*  X'F4'  COLORE VERDE                                            
000405   05     DFHTURQ                     PIC X  VALUE '5'.           
000406*  X'F5'  COLORE AZZURRO                                          
000407   05     DFHYELLO                    PIC X  VALUE '6'.           
000408*  X'F6'  COLORE GIALLO                                           
000409   05     DFHNEUTR                    PIC X  VALUE '7'.           
000410*  X'F7'  COLORE NEUTRO                                           
000411   05     DFHDFHI                     PIC X  VALUE HIGH-VALUE.    
000412*  X'FF'  TOGLIE LA SOTTOLINEATURA (UNDERLINE)                    
000413   05     DFHUNDLN                    PIC X  VALUE '4'.           
000414*  X'F4'  IMPOSTA LA SOTTOLINEATURA (UNDERLINE)                   
000415   05     DFHREVRS                    PIC X  VALUE '2'.           
000416*  X'F4'  IMPOSTA IL REVERSE                                      
000417   05     DFHALL                      PIC X  VALUE ' '.           
000418*  X'00'  PULISCE GLI ATTRIBUTI PRENDENDO QUELLI DI MAPPA         
000419 01  FILLER                      PIC X(08) VALUE '*DCMESS*'.      
000420*    COPY DCMESS.                                                 
000421********************     DCMESS           ************************
000422*********  COPY PER ESECUZIONE DELLA SUBROUTINE SRMESS     *******
000423*********  GESTIONE MESSAGGI DI ERRORE TP/BATCH            *******
000424******************************************************************
000425 01  DCMESS.                                                      
000426     05  MESS-CAMPI-INPUT.                                        
000427         10  MESS-CODERROR      PIC X(5)       VALUE SPACES.      
000428         10  MESS-CODILING      PIC X(1)       VALUE SPACES.      
000429     05  MESS-CAMPI-OUTPUT.                                       
000430         10  MESS-MSGERROR.                                       
000431             15  MESS-COMCODER  PIC X(5)       VALUE SPACES.      
000432             15  FILLER         PIC X          VALUE SPACES.      
000433             15  MESS-MESSAGGI  PIC X(66)      VALUE SPACES.      
000434 01  FILLER                      PIC X(08)  VALUE 'DCWTSTR0'.     
000435*    COPY DCWTSTR0.                                               
000436*------------------------------------- -------------------------* 
000437*                    --- DCWTSTR0 ---                           * 
000438*              DSECT PER SALVATAGGIO COMMAREA.                  * 
000439*---------------------------------------------------------------* 
000440 01  DCWTSTR0.                                                    
000441     05  TSTR-LENGCODA               PIC S9(4)  COMP VALUE +4096. 
000442     05  TSTR-ITEMXXXX               PIC S9(4)  COMP VALUE +0.    
000443     05  TSTR-NOMECODA.                                           
000444         10  TSTR-NOMETRAN           PIC X(4)   VALUE SPACES.     
000445         10  TSTR-NOMETERM           PIC X(4)   VALUE SPACES.     
000446     05  TSTR-AREATSTR               PIC X(4096) VALUE SPACES.    
000447*---------------------------------------------------------------* 
000448 01  FILLER                      PIC X(08) VALUE '*AVMLO24'.      
000449*    COPY AVMLO24.                                                
000450***************************************************************** 
000451* SDF: AVMLO24 AVILO24                                            
000452***************************************************************** 
000453 01   AVILO24I.                                                   
000454     05 FILLER    PIC X(12).                                      
000455     05 LO24-CODSOCIEL      COMP PIC S9(4).                       
000456     05 LO24-CODSOCIEF      PIC X.                                
000457     05 FILLER    PIC X(4).                                       
000458     05 LO24-CODSOCIEI      PIC X(2).                             
000459     05 LO24-NOMSOCIEL      COMP PIC S9(4).                       
000460     05 LO24-NOMSOCIEF      PIC X.                                
000461     05 FILLER    PIC X(4).                                       
000462     05 LO24-NOMSOCIEI      PIC X(21).                            
000463     05 LO24-FLAGSOSPL      COMP PIC S9(4).                       
000464     05 LO24-FLAGSOSPF      PIC X.                                
000465     05 FILLER    PIC X(4).                                       
000466     05 LO24-FLAGSOSPI      PIC X.                                
000467     05 LO24-CODCLIENL      COMP PIC S9(4).                       
000468     05 LO24-CODCLIENF      PIC X.                                
000469     05 FILLER    PIC X(4).                                       
000470     05 LO24-CODCLIENI      PIC X(5).                             
000471     05 LO24-RAGFATTUL      COMP PIC S9(4).                       
000472     05 LO24-RAGFATTUF      PIC X.                                
000473     05 FILLER    PIC X(4).                                       
000474     05 LO24-RAGFATTUI      PIC X(23).                            
000475     05 LO24-AAAACOMPL      COMP PIC S9(4).                       
000476     05 LO24-AAAACOMPF      PIC X.                                
000477     05 FILLER    PIC X(4).                                       
000478     05 LO24-AAAACOMPI      PIC X(4).                             
000479     05 LO24-MMMMCOMPL      COMP PIC S9(4).                       
000480     05 LO24-MMMMCOMPF      PIC X.                                
000481     05 FILLER    PIC X(4).                                       
000482     05 LO24-MMMMCOMPI      PIC X(2).                             
000483     05 LO24-STATUSXXL      COMP PIC S9(4).                       
000484     05 LO24-STATUSXXF      PIC X.                                
000485     05 FILLER    PIC X(4).                                       
000486     05 LO24-STATUSXXI      PIC X.                                
000487     05 LO24-CODSERVIL      COMP PIC S9(4).                       
000488     05 LO24-CODSERVIF      PIC X.                                
000489     05 FILLER    PIC X(4).                                       
000490     05 LO24-CODSERVII      PIC X(6).                             
000491     05 LO24-DESSERVIL      COMP PIC S9(4).                       
000492     05 LO24-DESSERVIF      PIC X.                                
000493     05 FILLER    PIC X(4).                                       
000494     05 LO24-DESSERVII      PIC X(35).                            
000495     05 LO24-TIPSERVIL      COMP PIC S9(4).                       
000496     05 LO24-TIPSERVIF      PIC X.                                
000497     05 FILLER    PIC X(4).                                       
000498     05 LO24-TIPSERVII      PIC X.                                
000499     05 LO24-DESTIPSEL      COMP PIC S9(4).                       
000500     05 LO24-DESTIPSEF      PIC X.                                
000501     05 FILLER    PIC X(4).                                       
000502     05 LO24-DESTIPSEI      PIC X(9).                             
000503     05 LO24-CENCOSTDL      COMP PIC S9(4).                       
000504     05 LO24-CENCOSTDF      PIC X.                                
000505     05 FILLER    PIC X(4).                                       
000506     05 LO24-CENCOSTDI      PIC X(5).                             
000507     05 LO24-CENCOSTAL      COMP PIC S9(4).                       
000508     05 LO24-CENCOSTAF      PIC X.                                
000509     05 FILLER    PIC X(4).                                       
000510     05 LO24-CENCOSTAI      PIC X(5).                             
000511     05 LO24-CONTODCEL      COMP PIC S9(4).                       
000512     05 LO24-CONTODCEF      PIC X.                                
000513     05 FILLER    PIC X(4).                                       
000514     05 LO24-CONTODCEI      PIC X(6).                             
000515     05 LO24-AANUMFATL      COMP PIC S9(4).                       
000516     05 LO24-AANUMFATF      PIC X.                                
000517     05 FILLER    PIC X(4).                                       
000518     05 LO24-AANUMFATI      PIC X(8).                             
000519     05 LO24-OCODCLIEL      COMP PIC S9(4).                       
000520     05 LO24-OCODCLIEF      PIC X.                                
000521     05 FILLER    PIC X(4).                                       
000522     05 LO24-OCODCLIEI      PIC X(5).                             
000523     05 LO24-ORAGFATTL      COMP PIC S9(4).                       
000524     05 LO24-ORAGFATTF      PIC X.                                
000525     05 FILLER    PIC X(4).                                       
000526     05 LO24-ORAGFATTI      PIC X(24).                            
000527     05 LO24-TOTIMPORL      COMP PIC S9(4).                       
000528     05 LO24-TOTIMPORF      PIC X.                                
000529     05 FILLER    PIC X(4).                                       
000530     05 LO24-TOTIMPORI      PIC X(14).                            
000531     05 LO24-TOTQUANTL      COMP PIC S9(4).                       
000532     05 LO24-TOTQUANTF      PIC X.                                
000533     05 FILLER    PIC X(4).                                       
000534     05 LO24-TOTQUANTI      PIC X(14).                            
000535     05 LO24-RIGAI OCCURS   17 TIMES .                            
000536       09 LO24-OPERAZIOL    COMP PIC S9(4).                       
000537       09 LO24-OPERAZIOF    PIC X.                                
000538       09 FILLER  PIC X(4).                                       
000539       09 LO24-OPERAZIOI    PIC X.                                
000540       09 LO24-RAAMMCOML    COMP PIC S9(4).                       
000541       09 LO24-RAAMMCOMF    PIC X.                                
000542       09 FILLER  PIC X(4).                                       
000543       09 LO24-RAAMMCOMI    PIC X(6).                             
000544       09 LO24-RTIPSERVL    COMP PIC S9(4).                       
000545       09 LO24-RTIPSERVF    PIC X.                                
000546       09 FILLER  PIC X(4).                                       
000547       09 LO24-RTIPSERVI    PIC X.                                
000548       09 LO24-RCODSERVL    COMP PIC S9(4).                       
000549       09 LO24-RCODSERVF    PIC X.                                
000550       09 FILLER  PIC X(4).                                       
000551       09 LO24-RCODSERVI    PIC X(6).                             
000552       09 LO24-RDESSERVL    COMP PIC S9(4).                       
000553       09 LO24-RDESSERVF    PIC X.                                
000554       09 FILLER  PIC X(4).                                       
000555       09 LO24-RDESSERVI    PIC X(28).                            
000556       09 LO24-RCODDIVIL    COMP PIC S9(4).                       
000557       09 LO24-RCODDIVIF    PIC X.                                
000558       09 FILLER  PIC X(4).                                       
000559       09 LO24-RCODDIVII    PIC X(2).                             
000560       09 LO24-RIMPORDIL    COMP PIC S9(4).                       
000561       09 LO24-RIMPORDIF    PIC X.                                
000562       09 FILLER  PIC X(4).                                       
000563       09 LO24-RIMPORDII    PIC X(14).                            
000564       09 LO24-RQTAORDIL    COMP PIC S9(4).                       
000565       09 LO24-RQTAORDIF    PIC X.                                
000566       09 FILLER  PIC X(4).                                       
000567       09 LO24-RQTAORDII    PIC X(14).                            
000568     05 LO24-MAPRPAGL  COMP PIC S9(4).                            
000569     05 LO24-MAPRPAGF  PIC X.                                     
000570     05 FILLER    PIC X(4).                                       
000571     05 LO24-MAPRPAGI  PIC X(4).                                  
000572     05 LO24-MAPPPAGL  COMP PIC S9(4).                            
000573     05 LO24-MAPPPAGF  PIC X.                                     
000574     05 FILLER    PIC X(4).                                       
000575     05 LO24-MAPPPAGI  PIC X(4).                                  
000576     05 LO24-MESSAGGL  COMP PIC S9(4).                            
000577     05 LO24-MESSAGGF  PIC X.                                     
000578     05 FILLER    PIC X(4).                                       
000579     05 LO24-MESSAGGI  PIC X(56).                                 
000580***************************************************************** 
000581* SDF: AVMLO24 AVILO24                                            
000582***************************************************************** 
000583 01   AVILO24O REDEFINES AVILO24I.                                
000584     05 FILLER    PIC X(12).                                      
000585     05 FILLER    PIC X(2).                                       
000586     05 LO24-CODSOCIEA      PIC X.                                
000587     05 LO24-CODSOCIEC PIC X.                                     
000588     05 LO24-CODSOCIEP PIC X.                                     
000589     05 LO24-CODSOCIEH PIC X.                                     
000590     05 LO24-CODSOCIEV PIC X.                                     
000591     05 LO24-CODSOCIEO      PIC X(2).                             
000592     05 FILLER    PIC X(2).                                       
000593     05 LO24-NOMSOCIEA      PIC X.                                
000594     05 LO24-NOMSOCIEC PIC X.                                     
000595     05 LO24-NOMSOCIEP PIC X.                                     
000596     05 LO24-NOMSOCIEH PIC X.                                     
000597     05 LO24-NOMSOCIEV PIC X.                                     
000598     05 LO24-NOMSOCIEO      PIC X(21).                            
000599     05 FILLER    PIC X(2).                                       
000600     05 LO24-FLAGSOSPA      PIC X.                                
000601     05 LO24-FLAGSOSPC PIC X.                                     
000602     05 LO24-FLAGSOSPP PIC X.                                     
000603     05 LO24-FLAGSOSPH PIC X.                                     
000604     05 LO24-FLAGSOSPV PIC X.                                     
000605     05 LO24-FLAGSOSPO      PIC X.                                
000606     05 FILLER    PIC X(2).                                       
000607     05 LO24-CODCLIENA      PIC X.                                
000608     05 LO24-CODCLIENC PIC X.                                     
000609     05 LO24-CODCLIENP PIC X.                                     
000610     05 LO24-CODCLIENH PIC X.                                     
000611     05 LO24-CODCLIENV PIC X.                                     
000612     05 LO24-CODCLIENO      PIC X(5).                             
000613     05 FILLER    PIC X(2).                                       
000614     05 LO24-RAGFATTUA      PIC X.                                
000615     05 LO24-RAGFATTUC PIC X.                                     
000616     05 LO24-RAGFATTUP PIC X.                                     
000617     05 LO24-RAGFATTUH PIC X.                                     
000618     05 LO24-RAGFATTUV PIC X.                                     
000619     05 LO24-RAGFATTUO      PIC X(23).                            
000620     05 FILLER    PIC X(2).                                       
000621     05 LO24-AAAACOMPA      PIC X.                                
000622     05 LO24-AAAACOMPC PIC X.                                     
000623     05 LO24-AAAACOMPP PIC X.                                     
000624     05 LO24-AAAACOMPH PIC X.                                     
000625     05 LO24-AAAACOMPV PIC X.                                     
000626     05 LO24-AAAACOMPO      PIC X(4).                             
000627     05 FILLER    PIC X(2).                                       
000628     05 LO24-MMMMCOMPA      PIC X.                                
000629     05 LO24-MMMMCOMPC PIC X.                                     
000630     05 LO24-MMMMCOMPP PIC X.                                     
000631     05 LO24-MMMMCOMPH PIC X.                                     
000632     05 LO24-MMMMCOMPV PIC X.                                     
000633     05 LO24-MMMMCOMPO      PIC X(2).                             
000634     05 FILLER    PIC X(2).                                       
000635     05 LO24-STATUSXXA      PIC X.                                
000636     05 LO24-STATUSXXC PIC X.                                     
000637     05 LO24-STATUSXXP PIC X.                                     
000638     05 LO24-STATUSXXH PIC X.                                     
000639     05 LO24-STATUSXXV PIC X.                                     
000640     05 LO24-STATUSXXO      PIC X.                                
000641     05 FILLER    PIC X(2).                                       
000642     05 LO24-CODSERVIA      PIC X.                                
000643     05 LO24-CODSERVIC PIC X.                                     
000644     05 LO24-CODSERVIP PIC X.                                     
000645     05 LO24-CODSERVIH PIC X.                                     
000646     05 LO24-CODSERVIV PIC X.                                     
000647     05 LO24-CODSERVIO      PIC X(6).                             
000648     05 FILLER    PIC X(2).                                       
000649     05 LO24-DESSERVIA      PIC X.                                
000650     05 LO24-DESSERVIC PIC X.                                     
000651     05 LO24-DESSERVIP PIC X.                                     
000652     05 LO24-DESSERVIH PIC X.                                     
000653     05 LO24-DESSERVIV PIC X.                                     
000654     05 LO24-DESSERVIO      PIC X(35).                            
000655     05 FILLER    PIC X(2).                                       
000656     05 LO24-TIPSERVIA      PIC X.                                
000657     05 LO24-TIPSERVIC PIC X.                                     
000658     05 LO24-TIPSERVIP PIC X.                                     
000659     05 LO24-TIPSERVIH PIC X.                                     
000660     05 LO24-TIPSERVIV PIC X.                                     
000661     05 LO24-TIPSERVIO      PIC X.                                
000662     05 FILLER    PIC X(2).                                       
000663     05 LO24-DESTIPSEA      PIC X.                                
000664     05 LO24-DESTIPSEC PIC X.                                     
000665     05 LO24-DESTIPSEP PIC X.                                     
000666     05 LO24-DESTIPSEH PIC X.                                     
000667     05 LO24-DESTIPSEV PIC X.                                     
000668     05 LO24-DESTIPSEO      PIC X(9).                             
000669     05 FILLER    PIC X(2).                                       
000670     05 LO24-CENCOSTDA      PIC X.                                
000671     05 LO24-CENCOSTDC PIC X.                                     
000672     05 LO24-CENCOSTDP PIC X.                                     
000673     05 LO24-CENCOSTDH PIC X.                                     
000674     05 LO24-CENCOSTDV PIC X.                                     
000675     05 LO24-CENCOSTDO      PIC X(5).                             
000676     05 FILLER    PIC X(2).                                       
000677     05 LO24-CENCOSTAA      PIC X.                                
000678     05 LO24-CENCOSTAC PIC X.                                     
000679     05 LO24-CENCOSTAP PIC X.                                     
000680     05 LO24-CENCOSTAH PIC X.                                     
000681     05 LO24-CENCOSTAV PIC X.                                     
000682     05 LO24-CENCOSTAO      PIC X(5).                             
000683     05 FILLER    PIC X(2).                                       
000684     05 LO24-CONTODCEA      PIC X.                                
000685     05 LO24-CONTODCEC PIC X.                                     
000686     05 LO24-CONTODCEP PIC X.                                     
000687     05 LO24-CONTODCEH PIC X.                                     
000688     05 LO24-CONTODCEV PIC X.                                     
000689     05 LO24-CONTODCEO      PIC X(6).                             
000690     05 FILLER    PIC X(2).                                       
000691     05 LO24-AANUMFATA      PIC X.                                
000692     05 LO24-AANUMFATC PIC X.                                     
000693     05 LO24-AANUMFATP PIC X.                                     
000694     05 LO24-AANUMFATH PIC X.                                     
000695     05 LO24-AANUMFATV PIC X.                                     
000696     05 LO24-AANUMFATO      PIC X(8).                             
000697     05 FILLER    PIC X(2).                                       
000698     05 LO24-OCODCLIEA      PIC X.                                
000699     05 LO24-OCODCLIEC PIC X.                                     
000700     05 LO24-OCODCLIEP PIC X.                                     
000701     05 LO24-OCODCLIEH PIC X.                                     
000702     05 LO24-OCODCLIEV PIC X.                                     
000703     05 LO24-OCODCLIEO      PIC X(5).                             
000704     05 FILLER    PIC X(2).                                       
000705     05 LO24-ORAGFATTA      PIC X.                                
000706     05 LO24-ORAGFATTC PIC X.                                     
000707     05 LO24-ORAGFATTP PIC X.                                     
000708     05 LO24-ORAGFATTH PIC X.                                     
000709     05 LO24-ORAGFATTV PIC X.                                     
000710     05 LO24-ORAGFATTO      PIC X(24).                            
000711     05 FILLER    PIC X(2).                                       
000712     05 LO24-TOTIMPORA      PIC X.                                
000713     05 LO24-TOTIMPORC PIC X.                                     
000714     05 LO24-TOTIMPORP PIC X.                                     
000715     05 LO24-TOTIMPORH PIC X.                                     
000716     05 LO24-TOTIMPORV PIC X.                                     
000717     05 LO24-TOTIMPORO      PIC Z(10)9,99.                        
000718     05 FILLER    PIC X(2).                                       
000719     05 LO24-TOTQUANTA      PIC X.                                
000720     05 LO24-TOTQUANTC PIC X.                                     
000721     05 LO24-TOTQUANTP PIC X.                                     
000722     05 LO24-TOTQUANTH PIC X.                                     
000723     05 LO24-TOTQUANTV PIC X.                                     
000724     05 LO24-TOTQUANTO      PIC Z(10)9,99.                        
000725     05 LO24-RIGAO OCCURS   17 TIMES .                            
000726       09 FILLER       PIC X(2).                                  
000727       09 LO24-OPERAZIOA    PIC X.                                
000728       09 LO24-OPERAZIOC    PIC X.                                
000729       09 LO24-OPERAZIOP    PIC X.                                
000730       09 LO24-OPERAZIOH    PIC X.                                
000731       09 LO24-OPERAZIOV    PIC X.                                
000732       09 LO24-OPERAZIOO    PIC X.                                
000733       09 FILLER       PIC X(2).                                  
000734       09 LO24-RAAMMCOMA    PIC X.                                
000735       09 LO24-RAAMMCOMC    PIC X.                                
000736       09 LO24-RAAMMCOMP    PIC X.                                
000737       09 LO24-RAAMMCOMH    PIC X.                                
000738       09 LO24-RAAMMCOMV    PIC X.                                
000739       09 LO24-RAAMMCOMO    PIC X(6).                             
000740       09 FILLER       PIC X(2).                                  
000741       09 LO24-RTIPSERVA    PIC X.                                
000742       09 LO24-RTIPSERVC    PIC X.                                
000743       09 LO24-RTIPSERVP    PIC X.                                
000744       09 LO24-RTIPSERVH    PIC X.                                
000745       09 LO24-RTIPSERVV    PIC X.                                
000746       09 LO24-RTIPSERVO    PIC X.                                
000747       09 FILLER       PIC X(2).                                  
000748       09 LO24-RCODSERVA    PIC X.                                
000749       09 LO24-RCODSERVC    PIC X.                                
000750       09 LO24-RCODSERVP    PIC X.                                
000751       09 LO24-RCODSERVH    PIC X.                                
000752       09 LO24-RCODSERVV    PIC X.                                
000753       09 LO24-RCODSERVO    PIC X(6).                             
000754       09 FILLER       PIC X(2).                                  
000755       09 LO24-RDESSERVA    PIC X.                                
000756       09 LO24-RDESSERVC    PIC X.                                
000757       09 LO24-RDESSERVP    PIC X.                                
000758       09 LO24-RDESSERVH    PIC X.                                
000759       09 LO24-RDESSERVV    PIC X.                                
000760       09 LO24-RDESSERVO    PIC X(28).                            
000761       09 FILLER       PIC X(2).                                  
000762       09 LO24-RCODDIVIA    PIC X.                                
000763       09 LO24-RCODDIVIC    PIC X.                                
000764       09 LO24-RCODDIVIP    PIC X.                                
000765       09 LO24-RCODDIVIH    PIC X.                                
000766       09 LO24-RCODDIVIV    PIC X.                                
000767       09 LO24-RCODDIVIO    PIC X(2).                             
000768       09 FILLER       PIC X(2).                                  
000769       09 LO24-RIMPORDIA    PIC X.                                
000770       09 LO24-RIMPORDIC    PIC X.                                
000771       09 LO24-RIMPORDIP    PIC X.                                
000772       09 LO24-RIMPORDIH    PIC X.                                
000773       09 LO24-RIMPORDIV    PIC X.                                
000774       09 LO24-RIMPORDIO    PIC Z(10)9,99.                        
000775       09 FILLER       PIC X(2).                                  
000776       09 LO24-RQTAORDIA    PIC X.                                
000777       09 LO24-RQTAORDIC    PIC X.                                
000778       09 LO24-RQTAORDIP    PIC X.                                
000779       09 LO24-RQTAORDIH    PIC X.                                
000780       09 LO24-RQTAORDIV    PIC X.                                
000781       09 LO24-RQTAORDIO    PIC Z(10)9,99.                        
000782     05 FILLER    PIC X(2).                                       
000783     05 LO24-MAPRPAGA  PIC X.                                     
000784     05 LO24-MAPRPAGC  PIC X.                                     
000785     05 LO24-MAPRPAGP  PIC X.                                     
000786     05 LO24-MAPRPAGH  PIC X.                                     
000787     05 LO24-MAPRPAGV  PIC X.                                     
000788     05 LO24-MAPRPAGO  PIC 9(4).                                  
000789     05 FILLER    PIC X(2).                                       
000790     05 LO24-MAPPPAGA  PIC X.                                     
000791     05 LO24-MAPPPAGC  PIC X.                                     
000792     05 LO24-MAPPPAGP  PIC X.                                     
000793     05 LO24-MAPPPAGH  PIC X.                                     
000794     05 LO24-MAPPPAGV  PIC X.                                     
000795     05 LO24-MAPPPAGO  PIC 9(4).                                  
000796     05 FILLER    PIC X(2).                                       
000797     05 LO24-MESSAGGA  PIC X.                                     
000798     05 LO24-MESSAGGC  PIC X.                                     
000799     05 LO24-MESSAGGP  PIC X.                                     
000800     05 LO24-MESSAGGH  PIC X.                                     
000801     05 LO24-MESSAGGV  PIC X.                                     
000802     05 LO24-MESSAGGO  PIC X(56).                                 
000803***************************************************************** 
000804* SDF: AVMLO24 AVBLO24                                            
000805***************************************************************** 
000806 01   AVBLO24I REDEFINES AVILO24I.                                
000807     05 FILLER    PIC X(12).                                      
000808     05 BO24-CODSOCIEL      COMP PIC S9(4).                       
000809     05 BO24-CODSOCIEF      PIC X.                                
000810     05 FILLER    PIC X(4).                                       
000811     05 BO24-CODSOCIEI      PIC X(2).                             
000812     05 BO24-NOMSOCIEL      COMP PIC S9(4).                       
000813     05 BO24-NOMSOCIEF      PIC X.                                
000814     05 FILLER    PIC X(4).                                       
000815     05 BO24-NOMSOCIEI      PIC X(21).                            
000816     05 BO24-FLAGSOSPL      COMP PIC S9(4).                       
000817     05 BO24-FLAGSOSPF      PIC X.                                
000818     05 FILLER    PIC X(4).                                       
000819     05 BO24-FLAGSOSPI      PIC X.                                
000820     05 BO24-CODCLIENL      COMP PIC S9(4).                       
000821     05 BO24-CODCLIENF      PIC X.                                
000822     05 FILLER    PIC X(4).                                       
000823     05 BO24-CODCLIENI      PIC X(5).                             
000824     05 BO24-RAGFATTUL      COMP PIC S9(4).                       
000825     05 BO24-RAGFATTUF      PIC X.                                
000826     05 FILLER    PIC X(4).                                       
000827     05 BO24-RAGFATTUI      PIC X(23).                            
000828     05 BO24-AAAACOMPL      COMP PIC S9(4).                       
000829     05 BO24-AAAACOMPF      PIC X.                                
000830     05 FILLER    PIC X(4).                                       
000831     05 BO24-AAAACOMPI      PIC X(4).                             
000832     05 BO24-MMMMCOMPL      COMP PIC S9(4).                       
000833     05 BO24-MMMMCOMPF      PIC X.                                
000834     05 FILLER    PIC X(4).                                       
000835     05 BO24-MMMMCOMPI      PIC X(2).                             
000836     05 BO24-STATUSXXL      COMP PIC S9(4).                       
000837     05 BO24-STATUSXXF      PIC X.                                
000838     05 FILLER    PIC X(4).                                       
000839     05 BO24-STATUSXXI      PIC X.                                
000840     05 BO24-CODSERVIL      COMP PIC S9(4).                       
000841     05 BO24-CODSERVIF      PIC X.                                
000842     05 FILLER    PIC X(4).                                       
000843     05 BO24-CODSERVII      PIC X(6).                             
000844     05 BO24-DESSERVIL      COMP PIC S9(4).                       
000845     05 BO24-DESSERVIF      PIC X.                                
000846     05 FILLER    PIC X(4).                                       
000847     05 BO24-DESSERVII      PIC X(35).                            
000848     05 BO24-TIPSERVIL      COMP PIC S9(4).                       
000849     05 BO24-TIPSERVIF      PIC X.                                
000850     05 FILLER    PIC X(4).                                       
000851     05 BO24-TIPSERVII      PIC X.                                
000852     05 BO24-DESTIPSEL      COMP PIC S9(4).                       
000853     05 BO24-DESTIPSEF      PIC X.                                
000854     05 FILLER    PIC X(4).                                       
000855     05 BO24-DESTIPSEI      PIC X(9).                             
000856     05 BO24-CENCOSTDL      COMP PIC S9(4).                       
000857     05 BO24-CENCOSTDF      PIC X.                                
000858     05 FILLER    PIC X(4).                                       
000859     05 BO24-CENCOSTDI      PIC X(5).                             
000860     05 BO24-CENCOSTAL      COMP PIC S9(4).                       
000861     05 BO24-CENCOSTAF      PIC X.                                
000862     05 FILLER    PIC X(4).                                       
000863     05 BO24-CENCOSTAI      PIC X(5).                             
000864     05 BO24-CONTODCEL      COMP PIC S9(4).                       
000865     05 BO24-CONTODCEF      PIC X.                                
000866     05 FILLER    PIC X(4).                                       
000867     05 BO24-CONTODCEI      PIC X(6).                             
000868     05 BO24-AANUMFATL      COMP PIC S9(4).                       
000869     05 BO24-AANUMFATF      PIC X.                                
000870     05 FILLER    PIC X(4).                                       
000871     05 BO24-AANUMFATI      PIC X(8).                             
000872     05 BO24-OCODCLIEL      COMP PIC S9(4).                       
000873     05 BO24-OCODCLIEF      PIC X.                                
000874     05 FILLER    PIC X(4).                                       
000875     05 BO24-OCODCLIEI      PIC X(5).                             
000876     05 BO24-ORAGFATTL      COMP PIC S9(4).                       
000877     05 BO24-ORAGFATTF      PIC X.                                
000878     05 FILLER    PIC X(4).                                       
000879     05 BO24-ORAGFATTI      PIC X(24).                            
000880     05 BO24-TOTIMPORL      COMP PIC S9(4).                       
000881     05 BO24-TOTIMPORF      PIC X.                                
000882     05 FILLER    PIC X(4).                                       
000883     05 BO24-TOTIMPORI      PIC X(14).                            
000884     05 BO24-TOTQUANTL      COMP PIC S9(4).                       
000885     05 BO24-TOTQUANTF      PIC X.                                
000886     05 FILLER    PIC X(4).                                       
000887     05 BO24-TOTQUANTI      PIC X(14).                            
000888     05 BO24-RIGAI OCCURS   17 TIMES .                            
000889       09 BO24-OPERAZIOL    COMP PIC S9(4).                       
000890       09 BO24-OPERAZIOF    PIC X.                                
000891       09 FILLER  PIC X(4).                                       
000892       09 BO24-OPERAZIOI    PIC X.                                
000893       09 BO24-RAAMMCOML    COMP PIC S9(4).                       
000894       09 BO24-RAAMMCOMF    PIC X.                                
000895       09 FILLER  PIC X(4).                                       
000896       09 BO24-RAAMMCOMI    PIC X(6).                             
000897       09 BO24-RTIPSERVL    COMP PIC S9(4).                       
000898       09 BO24-RTIPSERVF    PIC X.                                
000899       09 FILLER  PIC X(4).                                       
000900       09 BO24-RTIPSERVI    PIC X.                                
000901       09 BO24-RCODSERVL    COMP PIC S9(4).                       
000902       09 BO24-RCODSERVF    PIC X.                                
000903       09 FILLER  PIC X(4).                                       
000904       09 BO24-RCODSERVI    PIC X(6).                             
000905       09 BO24-RDESSERVL    COMP PIC S9(4).                       
000906       09 BO24-RDESSERVF    PIC X.                                
000907       09 FILLER  PIC X(4).                                       
000908       09 BO24-RDESSERVI    PIC X(28).                            
000909       09 BO24-RCODDIVIL    COMP PIC S9(4).                       
000910       09 BO24-RCODDIVIF    PIC X.                                
000911       09 FILLER  PIC X(4).                                       
000912       09 BO24-RCODDIVII    PIC X(2).                             
000913       09 BO24-RIMPORDIL    COMP PIC S9(4).                       
000914       09 BO24-RIMPORDIF    PIC X.                                
000915       09 FILLER  PIC X(4).                                       
000916       09 BO24-RIMPORDII    PIC X(14).                            
000917       09 BO24-RQTAORDIL    COMP PIC S9(4).                       
000918       09 BO24-RQTAORDIF    PIC X.                                
000919       09 FILLER  PIC X(4).                                       
000920       09 BO24-RQTAORDII    PIC X(14).                            
000921     05 BO24-MAPRPAGL  COMP PIC S9(4).                            
000922     05 BO24-MAPRPAGF  PIC X.                                     
000923     05 FILLER    PIC X(4).                                       
000924     05 BO24-MAPRPAGI  PIC X(4).                                  
000925     05 BO24-MAPPPAGL  COMP PIC S9(4).                            
000926     05 BO24-MAPPPAGF  PIC X.                                     
000927     05 FILLER    PIC X(4).                                       
000928     05 BO24-MAPPPAGI  PIC X(4).                                  
000929     05 BO24-MESSAGGL  COMP PIC S9(4).                            
000930     05 BO24-MESSAGGF  PIC X.                                     
000931     05 FILLER    PIC X(4).                                       
000932     05 BO24-MESSAGGI  PIC X(56).                                 
000933***************************************************************** 
000934* SDF: AVMLO24 AVBLO24                                            
000935***************************************************************** 
000936 01   AVBLO24O REDEFINES AVILO24I.                                
000937     05 FILLER    PIC X(12).                                      
000938     05 FILLER    PIC X(2).                                       
000939     05 BO24-CODSOCIEA      PIC X.                                
000940     05 BO24-CODSOCIEC PIC X.                                     
000941     05 BO24-CODSOCIEP PIC X.                                     
000942     05 BO24-CODSOCIEH PIC X.                                     
000943     05 BO24-CODSOCIEV PIC X.                                     
000944     05 BO24-CODSOCIEO      PIC X(2).                             
000945     05 FILLER    PIC X(2).                                       
000946     05 BO24-NOMSOCIEA      PIC X.                                
000947     05 BO24-NOMSOCIEC PIC X.                                     
000948     05 BO24-NOMSOCIEP PIC X.                                     
000949     05 BO24-NOMSOCIEH PIC X.                                     
000950     05 BO24-NOMSOCIEV PIC X.                                     
000951     05 BO24-NOMSOCIEO      PIC X(21).                            
000952     05 FILLER    PIC X(2).                                       
000953     05 BO24-FLAGSOSPA      PIC X.                                
000954     05 BO24-FLAGSOSPC PIC X.                                     
000955     05 BO24-FLAGSOSPP PIC X.                                     
000956     05 BO24-FLAGSOSPH PIC X.                                     
000957     05 BO24-FLAGSOSPV PIC X.                                     
000958     05 BO24-FLAGSOSPO      PIC X.                                
000959     05 FILLER    PIC X(2).                                       
000960     05 BO24-CODCLIENA      PIC X.                                
000961     05 BO24-CODCLIENC PIC X.                                     
000962     05 BO24-CODCLIENP PIC X.                                     
000963     05 BO24-CODCLIENH PIC X.                                     
000964     05 BO24-CODCLIENV PIC X.                                     
000965     05 BO24-CODCLIENO      PIC X(5).                             
000966     05 FILLER    PIC X(2).                                       
000967     05 BO24-RAGFATTUA      PIC X.                                
000968     05 BO24-RAGFATTUC PIC X.                                     
000969     05 BO24-RAGFATTUP PIC X.                                     
000970     05 BO24-RAGFATTUH PIC X.                                     
000971     05 BO24-RAGFATTUV PIC X.                                     
000972     05 BO24-RAGFATTUO      PIC X(23).                            
000973     05 FILLER    PIC X(2).                                       
000974     05 BO24-AAAACOMPA      PIC X.                                
000975     05 BO24-AAAACOMPC PIC X.                                     
000976     05 BO24-AAAACOMPP PIC X.                                     
000977     05 BO24-AAAACOMPH PIC X.                                     
000978     05 BO24-AAAACOMPV PIC X.                                     
000979     05 BO24-AAAACOMPO      PIC X(4).                             
000980     05 FILLER    PIC X(2).                                       
000981     05 BO24-MMMMCOMPA      PIC X.                                
000982     05 BO24-MMMMCOMPC PIC X.                                     
000983     05 BO24-MMMMCOMPP PIC X.                                     
000984     05 BO24-MMMMCOMPH PIC X.                                     
000985     05 BO24-MMMMCOMPV PIC X.                                     
000986     05 BO24-MMMMCOMPO      PIC X(2).                             
000987     05 FILLER    PIC X(2).                                       
000988     05 BO24-STATUSXXA      PIC X.                                
000989     05 BO24-STATUSXXC PIC X.                                     
000990     05 BO24-STATUSXXP PIC X.                                     
000991     05 BO24-STATUSXXH PIC X.                                     
000992     05 BO24-STATUSXXV PIC X.                                     
000993     05 BO24-STATUSXXO      PIC X.                                
000994     05 FILLER    PIC X(2).                                       
000995     05 BO24-CODSERVIA      PIC X.                                
000996     05 BO24-CODSERVIC PIC X.                                     
000997     05 BO24-CODSERVIP PIC X.                                     
000998     05 BO24-CODSERVIH PIC X.                                     
000999     05 BO24-CODSERVIV PIC X.                                     
001000     05 BO24-CODSERVIO      PIC X(6).                             
001001     05 FILLER    PIC X(2).                                       
001002     05 BO24-DESSERVIA      PIC X.                                
001003     05 BO24-DESSERVIC PIC X.                                     
001004     05 BO24-DESSERVIP PIC X.                                     
001005     05 BO24-DESSERVIH PIC X.                                     
001006     05 BO24-DESSERVIV PIC X.                                     
001007     05 BO24-DESSERVIO      PIC X(35).                            
001008     05 FILLER    PIC X(2).                                       
001009     05 BO24-TIPSERVIA      PIC X.                                
001010     05 BO24-TIPSERVIC PIC X.                                     
001011     05 BO24-TIPSERVIP PIC X.                                     
001012     05 BO24-TIPSERVIH PIC X.                                     
001013     05 BO24-TIPSERVIV PIC X.                                     
001014     05 BO24-TIPSERVIO      PIC X.                                
001015     05 FILLER    PIC X(2).                                       
001016     05 BO24-DESTIPSEA      PIC X.                                
001017     05 BO24-DESTIPSEC PIC X.                                     
001018     05 BO24-DESTIPSEP PIC X.                                     
001019     05 BO24-DESTIPSEH PIC X.                                     
001020     05 BO24-DESTIPSEV PIC X.                                     
001021     05 BO24-DESTIPSEO      PIC X(9).                             
001022     05 FILLER    PIC X(2).                                       
001023     05 BO24-CENCOSTDA      PIC X.                                
001024     05 BO24-CENCOSTDC PIC X.                                     
001025     05 BO24-CENCOSTDP PIC X.                                     
001026     05 BO24-CENCOSTDH PIC X.                                     
001027     05 BO24-CENCOSTDV PIC X.                                     
001028     05 BO24-CENCOSTDO      PIC X(5).                             
001029     05 FILLER    PIC X(2).                                       
001030     05 BO24-CENCOSTAA      PIC X.                                
001031     05 BO24-CENCOSTAC PIC X.                                     
001032     05 BO24-CENCOSTAP PIC X.                                     
001033     05 BO24-CENCOSTAH PIC X.                                     
001034     05 BO24-CENCOSTAV PIC X.                                     
001035     05 BO24-CENCOSTAO      PIC X(5).                             
001036     05 FILLER    PIC X(2).                                       
001037     05 BO24-CONTODCEA      PIC X.                                
001038     05 BO24-CONTODCEC PIC X.                                     
001039     05 BO24-CONTODCEP PIC X.                                     
001040     05 BO24-CONTODCEH PIC X.                                     
001041     05 BO24-CONTODCEV PIC X.                                     
001042     05 BO24-CONTODCEO      PIC X(6).                             
001043     05 FILLER    PIC X(2).                                       
001044     05 BO24-AANUMFATA      PIC X.                                
001045     05 BO24-AANUMFATC PIC X.                                     
001046     05 BO24-AANUMFATP PIC X.                                     
001047     05 BO24-AANUMFATH PIC X.                                     
001048     05 BO24-AANUMFATV PIC X.                                     
001049     05 BO24-AANUMFATO      PIC X(8).                             
001050     05 FILLER    PIC X(2).                                       
001051     05 BO24-OCODCLIEA      PIC X.                                
001052     05 BO24-OCODCLIEC PIC X.                                     
001053     05 BO24-OCODCLIEP PIC X.                                     
001054     05 BO24-OCODCLIEH PIC X.                                     
001055     05 BO24-OCODCLIEV PIC X.                                     
001056     05 BO24-OCODCLIEO      PIC X(5).                             
001057     05 FILLER    PIC X(2).                                       
001058     05 BO24-ORAGFATTA      PIC X.                                
001059     05 BO24-ORAGFATTC PIC X.                                     
001060     05 BO24-ORAGFATTP PIC X.                                     
001061     05 BO24-ORAGFATTH PIC X.                                     
001062     05 BO24-ORAGFATTV PIC X.                                     
001063     05 BO24-ORAGFATTO      PIC X(24).                            
001064     05 FILLER    PIC X(2).                                       
001065     05 BO24-TOTIMPORA      PIC X.                                
001066     05 BO24-TOTIMPORC PIC X.                                     
001067     05 BO24-TOTIMPORP PIC X.                                     
001068     05 BO24-TOTIMPORH PIC X.                                     
001069     05 BO24-TOTIMPORV PIC X.                                     
001070     05 BO24-TOTIMPORO      PIC Z(10)9,99.                        
001071     05 FILLER    PIC X(2).                                       
001072     05 BO24-TOTQUANTA      PIC X.                                
001073     05 BO24-TOTQUANTC PIC X.                                     
001074     05 BO24-TOTQUANTP PIC X.                                     
001075     05 BO24-TOTQUANTH PIC X.                                     
001076     05 BO24-TOTQUANTV PIC X.                                     
001077     05 BO24-TOTQUANTO      PIC Z(10)9,99.                        
001078     05 BO24-RIGAO OCCURS   17 TIMES .                            
001079       09 FILLER       PIC X(2).                                  
001080       09 BO24-OPERAZIOA    PIC X.                                
001081       09 BO24-OPERAZIOC    PIC X.                                
001082       09 BO24-OPERAZIOP    PIC X.                                
001083       09 BO24-OPERAZIOH    PIC X.                                
001084       09 BO24-OPERAZIOV    PIC X.                                
001085       09 BO24-OPERAZIOO    PIC X.                                
001086       09 FILLER       PIC X(2).                                  
001087       09 BO24-RAAMMCOMA    PIC X.                                
001088       09 BO24-RAAMMCOMC    PIC X.                                
001089       09 BO24-RAAMMCOMP    PIC X.                                
001090       09 BO24-RAAMMCOMH    PIC X.                                
001091       09 BO24-RAAMMCOMV    PIC X.                                
001092       09 BO24-RAAMMCOMO    PIC X(6).                             
001093       09 FILLER       PIC X(2).                                  
001094       09 BO24-RTIPSERVA    PIC X.                                
001095       09 BO24-RTIPSERVC    PIC X.                                
001096       09 BO24-RTIPSERVP    PIC X.                                
001097       09 BO24-RTIPSERVH    PIC X.                                
001098       09 BO24-RTIPSERVV    PIC X.                                
001099       09 BO24-RTIPSERVO    PIC X.                                
001100       09 FILLER       PIC X(2).                                  
001101       09 BO24-RCODSERVA    PIC X.                                
001102       09 BO24-RCODSERVC    PIC X.                                
001103       09 BO24-RCODSERVP    PIC X.                                
001104       09 BO24-RCODSERVH    PIC X.                                
001105       09 BO24-RCODSERVV    PIC X.                                
001106       09 BO24-RCODSERVO    PIC X(6).                             
001107       09 FILLER       PIC X(2).                                  
001108       09 BO24-RDESSERVA    PIC X.                                
001109       09 BO24-RDESSERVC    PIC X.                                
001110       09 BO24-RDESSERVP    PIC X.                                
001111       09 BO24-RDESSERVH    PIC X.                                
001112       09 BO24-RDESSERVV    PIC X.                                
001113       09 BO24-RDESSERVO    PIC X(28).                            
001114       09 FILLER       PIC X(2).                                  
001115       09 BO24-RCODDIVIA    PIC X.                                
001116       09 BO24-RCODDIVIC    PIC X.                                
001117       09 BO24-RCODDIVIP    PIC X.                                
001118       09 BO24-RCODDIVIH    PIC X.                                
001119       09 BO24-RCODDIVIV    PIC X.                                
001120       09 BO24-RCODDIVIO    PIC X(2).                             
001121       09 FILLER       PIC X(2).                                  
001122       09 BO24-RIMPORDIA    PIC X.                                
001123       09 BO24-RIMPORDIC    PIC X.                                
001124       09 BO24-RIMPORDIP    PIC X.                                
001125       09 BO24-RIMPORDIH    PIC X.                                
001126       09 BO24-RIMPORDIV    PIC X.                                
001127       09 BO24-RIMPORDIO    PIC Z(10)9,99.                        
001128       09 FILLER       PIC X(2).                                  
001129       09 BO24-RQTAORDIA    PIC X.                                
001130       09 BO24-RQTAORDIC    PIC X.                                
001131       09 BO24-RQTAORDIP    PIC X.                                
001132       09 BO24-RQTAORDIH    PIC X.                                
001133       09 BO24-RQTAORDIV    PIC X.                                
001134       09 BO24-RQTAORDIO    PIC Z(10)9,99.                        
001135     05 FILLER    PIC X(2).                                       
001136     05 BO24-MAPRPAGA  PIC X.                                     
001137     05 BO24-MAPRPAGC  PIC X.                                     
001138     05 BO24-MAPRPAGP  PIC X.                                     
001139     05 BO24-MAPRPAGH  PIC X.                                     
001140     05 BO24-MAPRPAGV  PIC X.                                     
001141     05 BO24-MAPRPAGO  PIC 9(4).                                  
001142     05 FILLER    PIC X(2).                                       
001143     05 BO24-MAPPPAGA  PIC X.                                     
001144     05 BO24-MAPPPAGC  PIC X.                                     
001145     05 BO24-MAPPPAGP  PIC X.                                     
001146     05 BO24-MAPPPAGH  PIC X.                                     
001147     05 BO24-MAPPPAGV  PIC X.                                     
001148     05 BO24-MAPPPAGO  PIC 9(4).                                  
001149     05 FILLER    PIC X(2).                                       
001150     05 BO24-MESSAGGA  PIC X.                                     
001151     05 BO24-MESSAGGC  PIC X.                                     
001152     05 BO24-MESSAGGP  PIC X.                                     
001153     05 BO24-MESSAGGH  PIC X.                                     
001154     05 BO24-MESSAGGV  PIC X.                                     
001155     05 BO24-MESSAGGO  PIC X(56).                                 
001156***************************************************************** 
001157* SDF: AVMLO24 AVDLO24                                            
001158***************************************************************** 
001159 01   AVDLO24I REDEFINES AVILO24I.                                
001160     05 FILLER    PIC X(12).                                      
001161     05 DO24-CODSOCIEL      COMP PIC S9(4).                       
001162     05 DO24-CODSOCIEF      PIC X.                                
001163     05 FILLER    PIC X(4).                                       
001164     05 DO24-CODSOCIEI      PIC X(2).                             
001165     05 DO24-NOMSOCIEL      COMP PIC S9(4).                       
001166     05 DO24-NOMSOCIEF      PIC X.                                
001167     05 FILLER    PIC X(4).                                       
001168     05 DO24-NOMSOCIEI      PIC X(21).                            
001169     05 DO24-FLAGSOSPL      COMP PIC S9(4).                       
001170     05 DO24-FLAGSOSPF      PIC X.                                
001171     05 FILLER    PIC X(4).                                       
001172     05 DO24-FLAGSOSPI      PIC X.                                
001173     05 DO24-CODCLIENL      COMP PIC S9(4).                       
001174     05 DO24-CODCLIENF      PIC X.                                
001175     05 FILLER    PIC X(4).                                       
001176     05 DO24-CODCLIENI      PIC X(5).                             
001177     05 DO24-RAGFATTUL      COMP PIC S9(4).                       
001178     05 DO24-RAGFATTUF      PIC X.                                
001179     05 FILLER    PIC X(4).                                       
001180     05 DO24-RAGFATTUI      PIC X(23).                            
001181     05 DO24-AAAACOMPL      COMP PIC S9(4).                       
001182     05 DO24-AAAACOMPF      PIC X.                                
001183     05 FILLER    PIC X(4).                                       
001184     05 DO24-AAAACOMPI      PIC X(4).                             
001185     05 DO24-MMMMCOMPL      COMP PIC S9(4).                       
001186     05 DO24-MMMMCOMPF      PIC X.                                
001187     05 FILLER    PIC X(4).                                       
001188     05 DO24-MMMMCOMPI      PIC X(2).                             
001189     05 DO24-STATUSXXL      COMP PIC S9(4).                       
001190     05 DO24-STATUSXXF      PIC X.                                
001191     05 FILLER    PIC X(4).                                       
001192     05 DO24-STATUSXXI      PIC X.                                
001193     05 DO24-CODSERVIL      COMP PIC S9(4).                       
001194     05 DO24-CODSERVIF      PIC X.                                
001195     05 FILLER    PIC X(4).                                       
001196     05 DO24-CODSERVII      PIC X(6).                             
001197     05 DO24-DESSERVIL      COMP PIC S9(4).                       
001198     05 DO24-DESSERVIF      PIC X.                                
001199     05 FILLER    PIC X(4).                                       
001200     05 DO24-DESSERVII      PIC X(35).                            
001201     05 DO24-TIPSERVIL      COMP PIC S9(4).                       
001202     05 DO24-TIPSERVIF      PIC X.                                
001203     05 FILLER    PIC X(4).                                       
001204     05 DO24-TIPSERVII      PIC X.                                
001205     05 DO24-DESTIPSEL      COMP PIC S9(4).                       
001206     05 DO24-DESTIPSEF      PIC X.                                
001207     05 FILLER    PIC X(4).                                       
001208     05 DO24-DESTIPSEI      PIC X(9).                             
001209     05 DO24-CENCOSTDL      COMP PIC S9(4).                       
001210     05 DO24-CENCOSTDF      PIC X.                                
001211     05 FILLER    PIC X(4).                                       
001212     05 DO24-CENCOSTDI      PIC X(5).                             
001213     05 DO24-CENCOSTAL      COMP PIC S9(4).                       
001214     05 DO24-CENCOSTAF      PIC X.                                
001215     05 FILLER    PIC X(4).                                       
001216     05 DO24-CENCOSTAI      PIC X(5).                             
001217     05 DO24-CONTODCEL      COMP PIC S9(4).                       
001218     05 DO24-CONTODCEF      PIC X.                                
001219     05 FILLER    PIC X(4).                                       
001220     05 DO24-CONTODCEI      PIC X(6).                             
001221     05 DO24-AANUMFATL      COMP PIC S9(4).                       
001222     05 DO24-AANUMFATF      PIC X.                                
001223     05 FILLER    PIC X(4).                                       
001224     05 DO24-AANUMFATI      PIC X(8).                             
001225     05 DO24-OCODCLIEL      COMP PIC S9(4).                       
001226     05 DO24-OCODCLIEF      PIC X.                                
001227     05 FILLER    PIC X(4).                                       
001228     05 DO24-OCODCLIEI      PIC X(5).                             
001229     05 DO24-ORAGFATTL      COMP PIC S9(4).                       
001230     05 DO24-ORAGFATTF      PIC X.                                
001231     05 FILLER    PIC X(4).                                       
001232     05 DO24-ORAGFATTI      PIC X(24).                            
001233     05 DO24-TOTIMPORL      COMP PIC S9(4).                       
001234     05 DO24-TOTIMPORF      PIC X.                                
001235     05 FILLER    PIC X(4).                                       
001236     05 DO24-TOTIMPORI      PIC X(14).                            
001237     05 DO24-TOTQUANTL      COMP PIC S9(4).                       
001238     05 DO24-TOTQUANTF      PIC X.                                
001239     05 FILLER    PIC X(4).                                       
001240     05 DO24-TOTQUANTI      PIC X(14).                            
001241     05 DO24-RIGAI OCCURS   17 TIMES .                            
001242       09 DO24-OPERAZIOL    COMP PIC S9(4).                       
001243       09 DO24-OPERAZIOF    PIC X.                                
001244       09 FILLER  PIC X(4).                                       
001245       09 DO24-OPERAZIOI    PIC X.                                
001246       09 DO24-RAAMMCOML    COMP PIC S9(4).                       
001247       09 DO24-RAAMMCOMF    PIC X.                                
001248       09 FILLER  PIC X(4).                                       
001249       09 DO24-RAAMMCOMI    PIC X(6).                             
001250       09 DO24-RTIPSERVL    COMP PIC S9(4).                       
001251       09 DO24-RTIPSERVF    PIC X.                                
001252       09 FILLER  PIC X(4).                                       
001253       09 DO24-RTIPSERVI    PIC X.                                
001254       09 DO24-RCODSERVL    COMP PIC S9(4).                       
001255       09 DO24-RCODSERVF    PIC X.                                
001256       09 FILLER  PIC X(4).                                       
001257       09 DO24-RCODSERVI    PIC X(6).                             
001258       09 DO24-RDESSERVL    COMP PIC S9(4).                       
001259       09 DO24-RDESSERVF    PIC X.                                
001260       09 FILLER  PIC X(4).                                       
001261       09 DO24-RDESSERVI    PIC X(28).                            
001262       09 DO24-RCODDIVIL    COMP PIC S9(4).                       
001263       09 DO24-RCODDIVIF    PIC X.                                
001264       09 FILLER  PIC X(4).                                       
001265       09 DO24-RCODDIVII    PIC X(2).                             
001266       09 DO24-RIMPORDIL    COMP PIC S9(4).                       
001267       09 DO24-RIMPORDIF    PIC X.                                
001268       09 FILLER  PIC X(4).                                       
001269       09 DO24-RIMPORDII    PIC X(14).                            
001270       09 DO24-RQTAORDIL    COMP PIC S9(4).                       
001271       09 DO24-RQTAORDIF    PIC X.                                
001272       09 FILLER  PIC X(4).                                       
001273       09 DO24-RQTAORDII    PIC X(14).                            
001274     05 DO24-MAPRPAGL  COMP PIC S9(4).                            
001275     05 DO24-MAPRPAGF  PIC X.                                     
001276     05 FILLER    PIC X(4).                                       
001277     05 DO24-MAPRPAGI  PIC X(4).                                  
001278     05 DO24-MAPPPAGL  COMP PIC S9(4).                            
001279     05 DO24-MAPPPAGF  PIC X.                                     
001280     05 FILLER    PIC X(4).                                       
001281     05 DO24-MAPPPAGI  PIC X(4).                                  
001282     05 DO24-MESSAGGL  COMP PIC S9(4).                            
001283     05 DO24-MESSAGGF  PIC X.                                     
001284     05 FILLER    PIC X(4).                                       
001285     05 DO24-MESSAGGI  PIC X(56).                                 
001286***************************************************************** 
001287* SDF: AVMLO24 AVDLO24                                            
001288***************************************************************** 
001289 01   AVDLO24O REDEFINES AVILO24I.                                
001290     05 FILLER    PIC X(12).                                      
001291     05 FILLER    PIC X(2).                                       
001292     05 DO24-CODSOCIEA      PIC X.                                
001293     05 DO24-CODSOCIEC PIC X.                                     
001294     05 DO24-CODSOCIEP PIC X.                                     
001295     05 DO24-CODSOCIEH PIC X.                                     
001296     05 DO24-CODSOCIEV PIC X.                                     
001297     05 DO24-CODSOCIEO      PIC X(2).                             
001298     05 FILLER    PIC X(2).                                       
001299     05 DO24-NOMSOCIEA      PIC X.                                
001300     05 DO24-NOMSOCIEC PIC X.                                     
001301     05 DO24-NOMSOCIEP PIC X.                                     
001302     05 DO24-NOMSOCIEH PIC X.                                     
001303     05 DO24-NOMSOCIEV PIC X.                                     
001304     05 DO24-NOMSOCIEO      PIC X(21).                            
001305     05 FILLER    PIC X(2).                                       
001306     05 DO24-FLAGSOSPA      PIC X.                                
001307     05 DO24-FLAGSOSPC PIC X.                                     
001308     05 DO24-FLAGSOSPP PIC X.                                     
001309     05 DO24-FLAGSOSPH PIC X.                                     
001310     05 DO24-FLAGSOSPV PIC X.                                     
001311     05 DO24-FLAGSOSPO      PIC X.                                
001312     05 FILLER    PIC X(2).                                       
001313     05 DO24-CODCLIENA      PIC X.                                
001314     05 DO24-CODCLIENC PIC X.                                     
001315     05 DO24-CODCLIENP PIC X.                                     
001316     05 DO24-CODCLIENH PIC X.                                     
001317     05 DO24-CODCLIENV PIC X.                                     
001318     05 DO24-CODCLIENO      PIC X(5).                             
001319     05 FILLER    PIC X(2).                                       
001320     05 DO24-RAGFATTUA      PIC X.                                
001321     05 DO24-RAGFATTUC PIC X.                                     
001322     05 DO24-RAGFATTUP PIC X.                                     
001323     05 DO24-RAGFATTUH PIC X.                                     
001324     05 DO24-RAGFATTUV PIC X.                                     
001325     05 DO24-RAGFATTUO      PIC X(23).                            
001326     05 FILLER    PIC X(2).                                       
001327     05 DO24-AAAACOMPA      PIC X.                                
001328     05 DO24-AAAACOMPC PIC X.                                     
001329     05 DO24-AAAACOMPP PIC X.                                     
001330     05 DO24-AAAACOMPH PIC X.                                     
001331     05 DO24-AAAACOMPV PIC X.                                     
001332     05 DO24-AAAACOMPO      PIC X(4).                             
001333     05 FILLER    PIC X(2).                                       
001334     05 DO24-MMMMCOMPA      PIC X.                                
001335     05 DO24-MMMMCOMPC PIC X.                                     
001336     05 DO24-MMMMCOMPP PIC X.                                     
001337     05 DO24-MMMMCOMPH PIC X.                                     
001338     05 DO24-MMMMCOMPV PIC X.                                     
001339     05 DO24-MMMMCOMPO      PIC X(2).                             
001340     05 FILLER    PIC X(2).                                       
001341     05 DO24-STATUSXXA      PIC X.                                
001342     05 DO24-STATUSXXC PIC X.                                     
001343     05 DO24-STATUSXXP PIC X.                                     
001344     05 DO24-STATUSXXH PIC X.                                     
001345     05 DO24-STATUSXXV PIC X.                                     
001346     05 DO24-STATUSXXO      PIC X.                                
001347     05 FILLER    PIC X(2).                                       
001348     05 DO24-CODSERVIA      PIC X.                                
001349     05 DO24-CODSERVIC PIC X.                                     
001350     05 DO24-CODSERVIP PIC X.                                     
001351     05 DO24-CODSERVIH PIC X.                                     
001352     05 DO24-CODSERVIV PIC X.                                     
001353     05 DO24-CODSERVIO      PIC X(6).                             
001354     05 FILLER    PIC X(2).                                       
001355     05 DO24-DESSERVIA      PIC X.                                
001356     05 DO24-DESSERVIC PIC X.                                     
001357     05 DO24-DESSERVIP PIC X.                                     
001358     05 DO24-DESSERVIH PIC X.                                     
001359     05 DO24-DESSERVIV PIC X.                                     
001360     05 DO24-DESSERVIO      PIC X(35).                            
001361     05 FILLER    PIC X(2).                                       
001362     05 DO24-TIPSERVIA      PIC X.                                
001363     05 DO24-TIPSERVIC PIC X.                                     
001364     05 DO24-TIPSERVIP PIC X.                                     
001365     05 DO24-TIPSERVIH PIC X.                                     
001366     05 DO24-TIPSERVIV PIC X.                                     
001367     05 DO24-TIPSERVIO      PIC X.                                
001368     05 FILLER    PIC X(2).                                       
001369     05 DO24-DESTIPSEA      PIC X.                                
001370     05 DO24-DESTIPSEC PIC X.                                     
001371     05 DO24-DESTIPSEP PIC X.                                     
001372     05 DO24-DESTIPSEH PIC X.                                     
001373     05 DO24-DESTIPSEV PIC X.                                     
001374     05 DO24-DESTIPSEO      PIC X(9).                             
001375     05 FILLER    PIC X(2).                                       
001376     05 DO24-CENCOSTDA      PIC X.                                
001377     05 DO24-CENCOSTDC PIC X.                                     
001378     05 DO24-CENCOSTDP PIC X.                                     
001379     05 DO24-CENCOSTDH PIC X.                                     
001380     05 DO24-CENCOSTDV PIC X.                                     
001381     05 DO24-CENCOSTDO      PIC X(5).                             
001382     05 FILLER    PIC X(2).                                       
001383     05 DO24-CENCOSTAA      PIC X.                                
001384     05 DO24-CENCOSTAC PIC X.                                     
001385     05 DO24-CENCOSTAP PIC X.                                     
001386     05 DO24-CENCOSTAH PIC X.                                     
001387     05 DO24-CENCOSTAV PIC X.                                     
001388     05 DO24-CENCOSTAO      PIC X(5).                             
001389     05 FILLER    PIC X(2).                                       
001390     05 DO24-CONTODCEA      PIC X.                                
001391     05 DO24-CONTODCEC PIC X.                                     
001392     05 DO24-CONTODCEP PIC X.                                     
001393     05 DO24-CONTODCEH PIC X.                                     
001394     05 DO24-CONTODCEV PIC X.                                     
001395     05 DO24-CONTODCEO      PIC X(6).                             
001396     05 FILLER    PIC X(2).                                       
001397     05 DO24-AANUMFATA      PIC X.                                
001398     05 DO24-AANUMFATC PIC X.                                     
001399     05 DO24-AANUMFATP PIC X.                                     
001400     05 DO24-AANUMFATH PIC X.                                     
001401     05 DO24-AANUMFATV PIC X.                                     
001402     05 DO24-AANUMFATO      PIC X(8).                             
001403     05 FILLER    PIC X(2).                                       
001404     05 DO24-OCODCLIEA      PIC X.                                
001405     05 DO24-OCODCLIEC PIC X.                                     
001406     05 DO24-OCODCLIEP PIC X.                                     
001407     05 DO24-OCODCLIEH PIC X.                                     
001408     05 DO24-OCODCLIEV PIC X.                                     
001409     05 DO24-OCODCLIEO      PIC X(5).                             
001410     05 FILLER    PIC X(2).                                       
001411     05 DO24-ORAGFATTA      PIC X.                                
001412     05 DO24-ORAGFATTC PIC X.                                     
001413     05 DO24-ORAGFATTP PIC X.                                     
001414     05 DO24-ORAGFATTH PIC X.                                     
001415     05 DO24-ORAGFATTV PIC X.                                     
001416     05 DO24-ORAGFATTO      PIC X(24).                            
001417     05 FILLER    PIC X(2).                                       
001418     05 DO24-TOTIMPORA      PIC X.                                
001419     05 DO24-TOTIMPORC PIC X.                                     
001420     05 DO24-TOTIMPORP PIC X.                                     
001421     05 DO24-TOTIMPORH PIC X.                                     
001422     05 DO24-TOTIMPORV PIC X.                                     
001423     05 DO24-TOTIMPORO      PIC Z(10)9,99.                        
001424     05 FILLER    PIC X(2).                                       
001425     05 DO24-TOTQUANTA      PIC X.                                
001426     05 DO24-TOTQUANTC PIC X.                                     
001427     05 DO24-TOTQUANTP PIC X.                                     
001428     05 DO24-TOTQUANTH PIC X.                                     
001429     05 DO24-TOTQUANTV PIC X.                                     
001430     05 DO24-TOTQUANTO      PIC Z(10)9,99.                        
001431     05 DO24-RIGAO OCCURS   17 TIMES .                            
001432       09 FILLER       PIC X(2).                                  
001433       09 DO24-OPERAZIOA    PIC X.                                
001434       09 DO24-OPERAZIOC    PIC X.                                
001435       09 DO24-OPERAZIOP    PIC X.                                
001436       09 DO24-OPERAZIOH    PIC X.                                
001437       09 DO24-OPERAZIOV    PIC X.                                
001438       09 DO24-OPERAZIOO    PIC X.                                
001439       09 FILLER       PIC X(2).                                  
001440       09 DO24-RAAMMCOMA    PIC X.                                
001441       09 DO24-RAAMMCOMC    PIC X.                                
001442       09 DO24-RAAMMCOMP    PIC X.                                
001443       09 DO24-RAAMMCOMH    PIC X.                                
001444       09 DO24-RAAMMCOMV    PIC X.                                
001445       09 DO24-RAAMMCOMO    PIC X(6).                             
001446       09 FILLER       PIC X(2).                                  
001447       09 DO24-RTIPSERVA    PIC X.                                
001448       09 DO24-RTIPSERVC    PIC X.                                
001449       09 DO24-RTIPSERVP    PIC X.                                
001450       09 DO24-RTIPSERVH    PIC X.                                
001451       09 DO24-RTIPSERVV    PIC X.                                
001452       09 DO24-RTIPSERVO    PIC X.                                
001453       09 FILLER       PIC X(2).                                  
001454       09 DO24-RCODSERVA    PIC X.                                
001455       09 DO24-RCODSERVC    PIC X.                                
001456       09 DO24-RCODSERVP    PIC X.                                
001457       09 DO24-RCODSERVH    PIC X.                                
001458       09 DO24-RCODSERVV    PIC X.                                
001459       09 DO24-RCODSERVO    PIC X(6).                             
001460       09 FILLER       PIC X(2).                                  
001461       09 DO24-RDESSERVA    PIC X.                                
001462       09 DO24-RDESSERVC    PIC X.                                
001463       09 DO24-RDESSERVP    PIC X.                                
001464       09 DO24-RDESSERVH    PIC X.                                
001465       09 DO24-RDESSERVV    PIC X.                                
001466       09 DO24-RDESSERVO    PIC X(28).                            
001467       09 FILLER       PIC X(2).                                  
001468       09 DO24-RCODDIVIA    PIC X.                                
001469       09 DO24-RCODDIVIC    PIC X.                                
001470       09 DO24-RCODDIVIP    PIC X.                                
001471       09 DO24-RCODDIVIH    PIC X.                                
001472       09 DO24-RCODDIVIV    PIC X.                                
001473       09 DO24-RCODDIVIO    PIC X(2).                             
001474       09 FILLER       PIC X(2).                                  
001475       09 DO24-RIMPORDIA    PIC X.                                
001476       09 DO24-RIMPORDIC    PIC X.                                
001477       09 DO24-RIMPORDIP    PIC X.                                
001478       09 DO24-RIMPORDIH    PIC X.                                
001479       09 DO24-RIMPORDIV    PIC X.                                
001480       09 DO24-RIMPORDIO    PIC Z(10)9,99.                        
001481       09 FILLER       PIC X(2).                                  
001482       09 DO24-RQTAORDIA    PIC X.                                
001483       09 DO24-RQTAORDIC    PIC X.                                
001484       09 DO24-RQTAORDIP    PIC X.                                
001485       09 DO24-RQTAORDIH    PIC X.                                
001486       09 DO24-RQTAORDIV    PIC X.                                
001487       09 DO24-RQTAORDIO    PIC Z(10)9,99.                        
001488     05 FILLER    PIC X(2).                                       
001489     05 DO24-MAPRPAGA  PIC X.                                     
001490     05 DO24-MAPRPAGC  PIC X.                                     
001491     05 DO24-MAPRPAGP  PIC X.                                     
001492     05 DO24-MAPRPAGH  PIC X.                                     
001493     05 DO24-MAPRPAGV  PIC X.                                     
001494     05 DO24-MAPRPAGO  PIC 9(4).                                  
001495     05 FILLER    PIC X(2).                                       
001496     05 DO24-MAPPPAGA  PIC X.                                     
001497     05 DO24-MAPPPAGC  PIC X.                                     
001498     05 DO24-MAPPPAGP  PIC X.                                     
001499     05 DO24-MAPPPAGH  PIC X.                                     
001500     05 DO24-MAPPPAGV  PIC X.                                     
001501     05 DO24-MAPPPAGO  PIC 9(4).                                  
001502     05 FILLER    PIC X(2).                                       
001503     05 DO24-MESSAGGA  PIC X.                                     
001504     05 DO24-MESSAGGC  PIC X.                                     
001505     05 DO24-MESSAGGP  PIC X.                                     
001506     05 DO24-MESSAGGH  PIC X.                                     
001507     05 DO24-MESSAGGV  PIC X.                                     
001508     05 DO24-MESSAGGO  PIC X(56).                                 
001509***************************************************************** 
001510* SDF: AVMLO24 AVFLO24                                            
001511***************************************************************** 
001512 01   AVFLO24I REDEFINES AVILO24I.                                
001513     05 FILLER    PIC X(12).                                      
001514     05 FO24-CODSOCIEL      COMP PIC S9(4).                       
001515     05 FO24-CODSOCIEF      PIC X.                                
001516     05 FILLER    PIC X(4).                                       
001517     05 FO24-CODSOCIEI      PIC X(2).                             
001518     05 FO24-NOMSOCIEL      COMP PIC S9(4).                       
001519     05 FO24-NOMSOCIEF      PIC X.                                
001520     05 FILLER    PIC X(4).                                       
001521     05 FO24-NOMSOCIEI      PIC X(21).                            
001522     05 FO24-FLAGSOSPL      COMP PIC S9(4).                       
001523     05 FO24-FLAGSOSPF      PIC X.                                
001524     05 FILLER    PIC X(4).                                       
001525     05 FO24-FLAGSOSPI      PIC X.                                
001526     05 FO24-CODCLIENL      COMP PIC S9(4).                       
001527     05 FO24-CODCLIENF      PIC X.                                
001528     05 FILLER    PIC X(4).                                       
001529     05 FO24-CODCLIENI      PIC X(5).                             
001530     05 FO24-RAGFATTUL      COMP PIC S9(4).                       
001531     05 FO24-RAGFATTUF      PIC X.                                
001532     05 FILLER    PIC X(4).                                       
001533     05 FO24-RAGFATTUI      PIC X(23).                            
001534     05 FO24-AAAACOMPL      COMP PIC S9(4).                       
001535     05 FO24-AAAACOMPF      PIC X.                                
001536     05 FILLER    PIC X(4).                                       
001537     05 FO24-AAAACOMPI      PIC X(4).                             
001538     05 FO24-MMMMCOMPL      COMP PIC S9(4).                       
001539     05 FO24-MMMMCOMPF      PIC X.                                
001540     05 FILLER    PIC X(4).                                       
001541     05 FO24-MMMMCOMPI      PIC X(2).                             
001542     05 FO24-STATUSXXL      COMP PIC S9(4).                       
001543     05 FO24-STATUSXXF      PIC X.                                
001544     05 FILLER    PIC X(4).                                       
001545     05 FO24-STATUSXXI      PIC X.                                
001546     05 FO24-CODSERVIL      COMP PIC S9(4).                       
001547     05 FO24-CODSERVIF      PIC X.                                
001548     05 FILLER    PIC X(4).                                       
001549     05 FO24-CODSERVII      PIC X(6).                             
001550     05 FO24-DESSERVIL      COMP PIC S9(4).                       
001551     05 FO24-DESSERVIF      PIC X.                                
001552     05 FILLER    PIC X(4).                                       
001553     05 FO24-DESSERVII      PIC X(35).                            
001554     05 FO24-TIPSERVIL      COMP PIC S9(4).                       
001555     05 FO24-TIPSERVIF      PIC X.                                
001556     05 FILLER    PIC X(4).                                       
001557     05 FO24-TIPSERVII      PIC X.                                
001558     05 FO24-DESTIPSEL      COMP PIC S9(4).                       
001559     05 FO24-DESTIPSEF      PIC X.                                
001560     05 FILLER    PIC X(4).                                       
001561     05 FO24-DESTIPSEI      PIC X(9).                             
001562     05 FO24-CENCOSTDL      COMP PIC S9(4).                       
001563     05 FO24-CENCOSTDF      PIC X.                                
001564     05 FILLER    PIC X(4).                                       
001565     05 FO24-CENCOSTDI      PIC X(5).                             
001566     05 FO24-CENCOSTAL      COMP PIC S9(4).                       
001567     05 FO24-CENCOSTAF      PIC X.                                
001568     05 FILLER    PIC X(4).                                       
001569     05 FO24-CENCOSTAI      PIC X(5).                             
001570     05 FO24-CONTODCEL      COMP PIC S9(4).                       
001571     05 FO24-CONTODCEF      PIC X.                                
001572     05 FILLER    PIC X(4).                                       
001573     05 FO24-CONTODCEI      PIC X(6).                             
001574     05 FO24-AANUMFATL      COMP PIC S9(4).                       
001575     05 FO24-AANUMFATF      PIC X.                                
001576     05 FILLER    PIC X(4).                                       
001577     05 FO24-AANUMFATI      PIC X(8).                             
001578     05 FO24-OCODCLIEL      COMP PIC S9(4).                       
001579     05 FO24-OCODCLIEF      PIC X.                                
001580     05 FILLER    PIC X(4).                                       
001581     05 FO24-OCODCLIEI      PIC X(5).                             
001582     05 FO24-ORAGFATTL      COMP PIC S9(4).                       
001583     05 FO24-ORAGFATTF      PIC X.                                
001584     05 FILLER    PIC X(4).                                       
001585     05 FO24-ORAGFATTI      PIC X(24).                            
001586     05 FO24-TOTIMPORL      COMP PIC S9(4).                       
001587     05 FO24-TOTIMPORF      PIC X.                                
001588     05 FILLER    PIC X(4).                                       
001589     05 FO24-TOTIMPORI      PIC X(14).                            
001590     05 FO24-TOTQUANTL      COMP PIC S9(4).                       
001591     05 FO24-TOTQUANTF      PIC X.                                
001592     05 FILLER    PIC X(4).                                       
001593     05 FO24-TOTQUANTI      PIC X(14).                            
001594     05 FO24-RIGAI OCCURS   17 TIMES .                            
001595       09 FO24-OPERAZIOL    COMP PIC S9(4).                       
001596       09 FO24-OPERAZIOF    PIC X.                                
001597       09 FILLER  PIC X(4).                                       
001598       09 FO24-OPERAZIOI    PIC X.                                
001599       09 FO24-RAAMMCOML    COMP PIC S9(4).                       
001600       09 FO24-RAAMMCOMF    PIC X.                                
001601       09 FILLER  PIC X(4).                                       
001602       09 FO24-RAAMMCOMI    PIC X(6).                             
001603       09 FO24-RTIPSERVL    COMP PIC S9(4).                       
001604       09 FO24-RTIPSERVF    PIC X.                                
001605       09 FILLER  PIC X(4).                                       
001606       09 FO24-RTIPSERVI    PIC X.                                
001607       09 FO24-RCODSERVL    COMP PIC S9(4).                       
001608       09 FO24-RCODSERVF    PIC X.                                
001609       09 FILLER  PIC X(4).                                       
001610       09 FO24-RCODSERVI    PIC X(6).                             
001611       09 FO24-RDESSERVL    COMP PIC S9(4).                       
001612       09 FO24-RDESSERVF    PIC X.                                
001613       09 FILLER  PIC X(4).                                       
001614       09 FO24-RDESSERVI    PIC X(28).                            
001615       09 FO24-RCODDIVIL    COMP PIC S9(4).                       
001616       09 FO24-RCODDIVIF    PIC X.                                
001617       09 FILLER  PIC X(4).                                       
001618       09 FO24-RCODDIVII    PIC X(2).                             
001619       09 FO24-RIMPORDIL    COMP PIC S9(4).                       
001620       09 FO24-RIMPORDIF    PIC X.                                
001621       09 FILLER  PIC X(4).                                       
001622       09 FO24-RIMPORDII    PIC X(14).                            
001623       09 FO24-RQTAORDIL    COMP PIC S9(4).                       
001624       09 FO24-RQTAORDIF    PIC X.                                
001625       09 FILLER  PIC X(4).                                       
001626       09 FO24-RQTAORDII    PIC X(14).                            
001627     05 FO24-MAPRPAGL  COMP PIC S9(4).                            
001628     05 FO24-MAPRPAGF  PIC X.                                     
001629     05 FILLER    PIC X(4).                                       
001630     05 FO24-MAPRPAGI  PIC X(4).                                  
001631     05 FO24-MAPPPAGL  COMP PIC S9(4).                            
001632     05 FO24-MAPPPAGF  PIC X.                                     
001633     05 FILLER    PIC X(4).                                       
001634     05 FO24-MAPPPAGI  PIC X(4).                                  
001635     05 FO24-MESSAGGL  COMP PIC S9(4).                            
001636     05 FO24-MESSAGGF  PIC X.                                     
001637     05 FILLER    PIC X(4).                                       
001638     05 FO24-MESSAGGI  PIC X(56).                                 
001639***************************************************************** 
001640* SDF: AVMLO24 AVFLO24                                            
001641***************************************************************** 
001642 01   AVFLO24O REDEFINES AVILO24I.                                
001643     05 FILLER    PIC X(12).                                      
001644     05 FILLER    PIC X(2).                                       
001645     05 FO24-CODSOCIEA      PIC X.                                
001646     05 FO24-CODSOCIEC PIC X.                                     
001647     05 FO24-CODSOCIEP PIC X.                                     
001648     05 FO24-CODSOCIEH PIC X.                                     
001649     05 FO24-CODSOCIEV PIC X.                                     
001650     05 FO24-CODSOCIEO      PIC X(2).                             
001651     05 FILLER    PIC X(2).                                       
001652     05 FO24-NOMSOCIEA      PIC X.                                
001653     05 FO24-NOMSOCIEC PIC X.                                     
001654     05 FO24-NOMSOCIEP PIC X.                                     
001655     05 FO24-NOMSOCIEH PIC X.                                     
001656     05 FO24-NOMSOCIEV PIC X.                                     
001657     05 FO24-NOMSOCIEO      PIC X(21).                            
001658     05 FILLER    PIC X(2).                                       
001659     05 FO24-FLAGSOSPA      PIC X.                                
001660     05 FO24-FLAGSOSPC PIC X.                                     
001661     05 FO24-FLAGSOSPP PIC X.                                     
001662     05 FO24-FLAGSOSPH PIC X.                                     
001663     05 FO24-FLAGSOSPV PIC X.                                     
001664     05 FO24-FLAGSOSPO      PIC X.                                
001665     05 FILLER    PIC X(2).                                       
001666     05 FO24-CODCLIENA      PIC X.                                
001667     05 FO24-CODCLIENC PIC X.                                     
001668     05 FO24-CODCLIENP PIC X.                                     
001669     05 FO24-CODCLIENH PIC X.                                     
001670     05 FO24-CODCLIENV PIC X.                                     
001671     05 FO24-CODCLIENO      PIC X(5).                             
001672     05 FILLER    PIC X(2).                                       
001673     05 FO24-RAGFATTUA      PIC X.                                
001674     05 FO24-RAGFATTUC PIC X.                                     
001675     05 FO24-RAGFATTUP PIC X.                                     
001676     05 FO24-RAGFATTUH PIC X.                                     
001677     05 FO24-RAGFATTUV PIC X.                                     
001678     05 FO24-RAGFATTUO      PIC X(23).                            
001679     05 FILLER    PIC X(2).                                       
001680     05 FO24-AAAACOMPA      PIC X.                                
001681     05 FO24-AAAACOMPC PIC X.                                     
001682     05 FO24-AAAACOMPP PIC X.                                     
001683     05 FO24-AAAACOMPH PIC X.                                     
001684     05 FO24-AAAACOMPV PIC X.                                     
001685     05 FO24-AAAACOMPO      PIC X(4).                             
001686     05 FILLER    PIC X(2).                                       
001687     05 FO24-MMMMCOMPA      PIC X.                                
001688     05 FO24-MMMMCOMPC PIC X.                                     
001689     05 FO24-MMMMCOMPP PIC X.                                     
001690     05 FO24-MMMMCOMPH PIC X.                                     
001691     05 FO24-MMMMCOMPV PIC X.                                     
001692     05 FO24-MMMMCOMPO      PIC X(2).                             
001693     05 FILLER    PIC X(2).                                       
001694     05 FO24-STATUSXXA      PIC X.                                
001695     05 FO24-STATUSXXC PIC X.                                     
001696     05 FO24-STATUSXXP PIC X.                                     
001697     05 FO24-STATUSXXH PIC X.                                     
001698     05 FO24-STATUSXXV PIC X.                                     
001699     05 FO24-STATUSXXO      PIC X.                                
001700     05 FILLER    PIC X(2).                                       
001701     05 FO24-CODSERVIA      PIC X.                                
001702     05 FO24-CODSERVIC PIC X.                                     
001703     05 FO24-CODSERVIP PIC X.                                     
001704     05 FO24-CODSERVIH PIC X.                                     
001705     05 FO24-CODSERVIV PIC X.                                     
001706     05 FO24-CODSERVIO      PIC X(6).                             
001707     05 FILLER    PIC X(2).                                       
001708     05 FO24-DESSERVIA      PIC X.                                
001709     05 FO24-DESSERVIC PIC X.                                     
001710     05 FO24-DESSERVIP PIC X.                                     
001711     05 FO24-DESSERVIH PIC X.                                     
001712     05 FO24-DESSERVIV PIC X.                                     
001713     05 FO24-DESSERVIO      PIC X(35).                            
001714     05 FILLER    PIC X(2).                                       
001715     05 FO24-TIPSERVIA      PIC X.                                
001716     05 FO24-TIPSERVIC PIC X.                                     
001717     05 FO24-TIPSERVIP PIC X.                                     
001718     05 FO24-TIPSERVIH PIC X.                                     
001719     05 FO24-TIPSERVIV PIC X.                                     
001720     05 FO24-TIPSERVIO      PIC X.                                
001721     05 FILLER    PIC X(2).                                       
001722     05 FO24-DESTIPSEA      PIC X.                                
001723     05 FO24-DESTIPSEC PIC X.                                     
001724     05 FO24-DESTIPSEP PIC X.                                     
001725     05 FO24-DESTIPSEH PIC X.                                     
001726     05 FO24-DESTIPSEV PIC X.                                     
001727     05 FO24-DESTIPSEO      PIC X(9).                             
001728     05 FILLER    PIC X(2).                                       
001729     05 FO24-CENCOSTDA      PIC X.                                
001730     05 FO24-CENCOSTDC PIC X.                                     
001731     05 FO24-CENCOSTDP PIC X.                                     
001732     05 FO24-CENCOSTDH PIC X.                                     
001733     05 FO24-CENCOSTDV PIC X.                                     
001734     05 FO24-CENCOSTDO      PIC X(5).                             
001735     05 FILLER    PIC X(2).                                       
001736     05 FO24-CENCOSTAA      PIC X.                                
001737     05 FO24-CENCOSTAC PIC X.                                     
001738     05 FO24-CENCOSTAP PIC X.                                     
001739     05 FO24-CENCOSTAH PIC X.                                     
001740     05 FO24-CENCOSTAV PIC X.                                     
001741     05 FO24-CENCOSTAO      PIC X(5).                             
001742     05 FILLER    PIC X(2).                                       
001743     05 FO24-CONTODCEA      PIC X.                                
001744     05 FO24-CONTODCEC PIC X.                                     
001745     05 FO24-CONTODCEP PIC X.                                     
001746     05 FO24-CONTODCEH PIC X.                                     
001747     05 FO24-CONTODCEV PIC X.                                     
001748     05 FO24-CONTODCEO      PIC X(6).                             
001749     05 FILLER    PIC X(2).                                       
001750     05 FO24-AANUMFATA      PIC X.                                
001751     05 FO24-AANUMFATC PIC X.                                     
001752     05 FO24-AANUMFATP PIC X.                                     
001753     05 FO24-AANUMFATH PIC X.                                     
001754     05 FO24-AANUMFATV PIC X.                                     
001755     05 FO24-AANUMFATO      PIC X(8).                             
001756     05 FILLER    PIC X(2).                                       
001757     05 FO24-OCODCLIEA      PIC X.                                
001758     05 FO24-OCODCLIEC PIC X.                                     
001759     05 FO24-OCODCLIEP PIC X.                                     
001760     05 FO24-OCODCLIEH PIC X.                                     
001761     05 FO24-OCODCLIEV PIC X.                                     
001762     05 FO24-OCODCLIEO      PIC X(5).                             
001763     05 FILLER    PIC X(2).                                       
001764     05 FO24-ORAGFATTA      PIC X.                                
001765     05 FO24-ORAGFATTC PIC X.                                     
001766     05 FO24-ORAGFATTP PIC X.                                     
001767     05 FO24-ORAGFATTH PIC X.                                     
001768     05 FO24-ORAGFATTV PIC X.                                     
001769     05 FO24-ORAGFATTO      PIC X(24).                            
001770     05 FILLER    PIC X(2).                                       
001771     05 FO24-TOTIMPORA      PIC X.                                
001772     05 FO24-TOTIMPORC PIC X.                                     
001773     05 FO24-TOTIMPORP PIC X.                                     
001774     05 FO24-TOTIMPORH PIC X.                                     
001775     05 FO24-TOTIMPORV PIC X.                                     
001776     05 FO24-TOTIMPORO      PIC Z(10)9,99.                        
001777     05 FILLER    PIC X(2).                                       
001778     05 FO24-TOTQUANTA      PIC X.                                
001779     05 FO24-TOTQUANTC PIC X.                                     
001780     05 FO24-TOTQUANTP PIC X.                                     
001781     05 FO24-TOTQUANTH PIC X.                                     
001782     05 FO24-TOTQUANTV PIC X.                                     
001783     05 FO24-TOTQUANTO      PIC Z(10)9,99.                        
001784     05 FO24-RIGAO OCCURS   17 TIMES .                            
001785       09 FILLER       PIC X(2).                                  
001786       09 FO24-OPERAZIOA    PIC X.                                
001787       09 FO24-OPERAZIOC    PIC X.                                
001788       09 FO24-OPERAZIOP    PIC X.                                
001789       09 FO24-OPERAZIOH    PIC X.                                
001790       09 FO24-OPERAZIOV    PIC X.                                
001791       09 FO24-OPERAZIOO    PIC X.                                
001792       09 FILLER       PIC X(2).                                  
001793       09 FO24-RAAMMCOMA    PIC X.                                
001794       09 FO24-RAAMMCOMC    PIC X.                                
001795       09 FO24-RAAMMCOMP    PIC X.                                
001796       09 FO24-RAAMMCOMH    PIC X.                                
001797       09 FO24-RAAMMCOMV    PIC X.                                
001798       09 FO24-RAAMMCOMO    PIC X(6).                             
001799       09 FILLER       PIC X(2).                                  
001800       09 FO24-RTIPSERVA    PIC X.                                
001801       09 FO24-RTIPSERVC    PIC X.                                
001802       09 FO24-RTIPSERVP    PIC X.                                
001803       09 FO24-RTIPSERVH    PIC X.                                
001804       09 FO24-RTIPSERVV    PIC X.                                
001805       09 FO24-RTIPSERVO    PIC X.                                
001806       09 FILLER       PIC X(2).                                  
001807       09 FO24-RCODSERVA    PIC X.                                
001808       09 FO24-RCODSERVC    PIC X.                                
001809       09 FO24-RCODSERVP    PIC X.                                
001810       09 FO24-RCODSERVH    PIC X.                                
001811       09 FO24-RCODSERVV    PIC X.                                
001812       09 FO24-RCODSERVO    PIC X(6).                             
001813       09 FILLER       PIC X(2).                                  
001814       09 FO24-RDESSERVA    PIC X.                                
001815       09 FO24-RDESSERVC    PIC X.                                
001816       09 FO24-RDESSERVP    PIC X.                                
001817       09 FO24-RDESSERVH    PIC X.                                
001818       09 FO24-RDESSERVV    PIC X.                                
001819       09 FO24-RDESSERVO    PIC X(28).                            
001820       09 FILLER       PIC X(2).                                  
001821       09 FO24-RCODDIVIA    PIC X.                                
001822       09 FO24-RCODDIVIC    PIC X.                                
001823       09 FO24-RCODDIVIP    PIC X.                                
001824       09 FO24-RCODDIVIH    PIC X.                                
001825       09 FO24-RCODDIVIV    PIC X.                                
001826       09 FO24-RCODDIVIO    PIC X(2).                             
001827       09 FILLER       PIC X(2).                                  
001828       09 FO24-RIMPORDIA    PIC X.                                
001829       09 FO24-RIMPORDIC    PIC X.                                
001830       09 FO24-RIMPORDIP    PIC X.                                
001831       09 FO24-RIMPORDIH    PIC X.                                
001832       09 FO24-RIMPORDIV    PIC X.                                
001833       09 FO24-RIMPORDIO    PIC Z(10)9,99.                        
001834       09 FILLER       PIC X(2).                                  
001835       09 FO24-RQTAORDIA    PIC X.                                
001836       09 FO24-RQTAORDIC    PIC X.                                
001837       09 FO24-RQTAORDIP    PIC X.                                
001838       09 FO24-RQTAORDIH    PIC X.                                
001839       09 FO24-RQTAORDIV    PIC X.                                
001840       09 FO24-RQTAORDIO    PIC Z(10)9,99.                        
001841     05 FILLER    PIC X(2).                                       
001842     05 FO24-MAPRPAGA  PIC X.                                     
001843     05 FO24-MAPRPAGC  PIC X.                                     
001844     05 FO24-MAPRPAGP  PIC X.                                     
001845     05 FO24-MAPRPAGH  PIC X.                                     
001846     05 FO24-MAPRPAGV  PIC X.                                     
001847     05 FO24-MAPRPAGO  PIC 9(4).                                  
001848     05 FILLER    PIC X(2).                                       
001849     05 FO24-MAPPPAGA  PIC X.                                     
001850     05 FO24-MAPPPAGC  PIC X.                                     
001851     05 FO24-MAPPPAGP  PIC X.                                     
001852     05 FO24-MAPPPAGH  PIC X.                                     
001853     05 FO24-MAPPPAGV  PIC X.                                     
001854     05 FO24-MAPPPAGO  PIC 9(4).                                  
001855     05 FILLER    PIC X(2).                                       
001856     05 FO24-MESSAGGA  PIC X.                                     
001857     05 FO24-MESSAGGC  PIC X.                                     
001858     05 FO24-MESSAGGP  PIC X.                                     
001859     05 FO24-MESSAGGH  PIC X.                                     
001860     05 FO24-MESSAGGV  PIC X.                                     
001861     05 FO24-MESSAGGO  PIC X(56).                                 
001862***************************************************************** 
001863* SDF: AVMLO24 AVJLO24                                            
001864***************************************************************** 
001865 01   AVJLO24I REDEFINES AVILO24I.                                
001866     05 FILLER    PIC X(12).                                      
001867     05 JO24-CODSOCIEL      COMP PIC S9(4).                       
001868     05 JO24-CODSOCIEF      PIC X.                                
001869     05 FILLER    PIC X(4).                                       
001870     05 JO24-CODSOCIEI      PIC X(2).                             
001871     05 JO24-NOMSOCIEL      COMP PIC S9(4).                       
001872     05 JO24-NOMSOCIEF      PIC X.                                
001873     05 FILLER    PIC X(4).                                       
001874     05 JO24-NOMSOCIEI      PIC X(21).                            
001875     05 JO24-FLAGSOSPL      COMP PIC S9(4).                       
001876     05 JO24-FLAGSOSPF      PIC X.                                
001877     05 FILLER    PIC X(4).                                       
001878     05 JO24-FLAGSOSPI      PIC X.                                
001879     05 JO24-CODCLIENL      COMP PIC S9(4).                       
001880     05 JO24-CODCLIENF      PIC X.                                
001881     05 FILLER    PIC X(4).                                       
001882     05 JO24-CODCLIENI      PIC X(5).                             
001883     05 JO24-RAGFATTUL      COMP PIC S9(4).                       
001884     05 JO24-RAGFATTUF      PIC X.                                
001885     05 FILLER    PIC X(4).                                       
001886     05 JO24-RAGFATTUI      PIC X(23).                            
001887     05 JO24-AAAACOMPL      COMP PIC S9(4).                       
001888     05 JO24-AAAACOMPF      PIC X.                                
001889     05 FILLER    PIC X(4).                                       
001890     05 JO24-AAAACOMPI      PIC X(4).                             
001891     05 JO24-MMMMCOMPL      COMP PIC S9(4).                       
001892     05 JO24-MMMMCOMPF      PIC X.                                
001893     05 FILLER    PIC X(4).                                       
001894     05 JO24-MMMMCOMPI      PIC X(2).                             
001895     05 JO24-STATUSXXL      COMP PIC S9(4).                       
001896     05 JO24-STATUSXXF      PIC X.                                
001897     05 FILLER    PIC X(4).                                       
001898     05 JO24-STATUSXXI      PIC X.                                
001899     05 JO24-CODSERVIL      COMP PIC S9(4).                       
001900     05 JO24-CODSERVIF      PIC X.                                
001901     05 FILLER    PIC X(4).                                       
001902     05 JO24-CODSERVII      PIC X(6).                             
001903     05 JO24-DESSERVIL      COMP PIC S9(4).                       
001904     05 JO24-DESSERVIF      PIC X.                                
001905     05 FILLER    PIC X(4).                                       
001906     05 JO24-DESSERVII      PIC X(35).                            
001907     05 JO24-TIPSERVIL      COMP PIC S9(4).                       
001908     05 JO24-TIPSERVIF      PIC X.                                
001909     05 FILLER    PIC X(4).                                       
001910     05 JO24-TIPSERVII      PIC X.                                
001911     05 JO24-DESTIPSEL      COMP PIC S9(4).                       
001912     05 JO24-DESTIPSEF      PIC X.                                
001913     05 FILLER    PIC X(4).                                       
001914     05 JO24-DESTIPSEI      PIC X(9).                             
001915     05 JO24-CENCOSTDL      COMP PIC S9(4).                       
001916     05 JO24-CENCOSTDF      PIC X.                                
001917     05 FILLER    PIC X(4).                                       
001918     05 JO24-CENCOSTDI      PIC X(5).                             
001919     05 JO24-CENCOSTAL      COMP PIC S9(4).                       
001920     05 JO24-CENCOSTAF      PIC X.                                
001921     05 FILLER    PIC X(4).                                       
001922     05 JO24-CENCOSTAI      PIC X(5).                             
001923     05 JO24-CONTODCEL      COMP PIC S9(4).                       
001924     05 JO24-CONTODCEF      PIC X.                                
001925     05 FILLER    PIC X(4).                                       
001926     05 JO24-CONTODCEI      PIC X(6).                             
001927     05 JO24-AANUMFATL      COMP PIC S9(4).                       
001928     05 JO24-AANUMFATF      PIC X.                                
001929     05 FILLER    PIC X(4).                                       
001930     05 JO24-AANUMFATI      PIC X(8).                             
001931     05 JO24-OCODCLIEL      COMP PIC S9(4).                       
001932     05 JO24-OCODCLIEF      PIC X.                                
001933     05 FILLER    PIC X(4).                                       
001934     05 JO24-OCODCLIEI      PIC X(5).                             
001935     05 JO24-ORAGFATTL      COMP PIC S9(4).                       
001936     05 JO24-ORAGFATTF      PIC X.                                
001937     05 FILLER    PIC X(4).                                       
001938     05 JO24-ORAGFATTI      PIC X(24).                            
001939     05 JO24-TOTIMPORL      COMP PIC S9(4).                       
001940     05 JO24-TOTIMPORF      PIC X.                                
001941     05 FILLER    PIC X(4).                                       
001942     05 JO24-TOTIMPORI      PIC X(14).                            
001943     05 JO24-TOTQUANTL      COMP PIC S9(4).                       
001944     05 JO24-TOTQUANTF      PIC X.                                
001945     05 FILLER    PIC X(4).                                       
001946     05 JO24-TOTQUANTI      PIC X(14).                            
001947     05 JO24-RIGAI OCCURS   17 TIMES .                            
001948       09 JO24-OPERAZIOL    COMP PIC S9(4).                       
001949       09 JO24-OPERAZIOF    PIC X.                                
001950       09 FILLER  PIC X(4).                                       
001951       09 JO24-OPERAZIOI    PIC X.                                
001952       09 JO24-RAAMMCOML    COMP PIC S9(4).                       
001953       09 JO24-RAAMMCOMF    PIC X.                                
001954       09 FILLER  PIC X(4).                                       
001955       09 JO24-RAAMMCOMI    PIC X(6).                             
001956       09 JO24-RTIPSERVL    COMP PIC S9(4).                       
001957       09 JO24-RTIPSERVF    PIC X.                                
001958       09 FILLER  PIC X(4).                                       
001959       09 JO24-RTIPSERVI    PIC X.                                
001960       09 JO24-RCODSERVL    COMP PIC S9(4).                       
001961       09 JO24-RCODSERVF    PIC X.                                
001962       09 FILLER  PIC X(4).                                       
001963       09 JO24-RCODSERVI    PIC X(6).                             
001964       09 JO24-RDESSERVL    COMP PIC S9(4).                       
001965       09 JO24-RDESSERVF    PIC X.                                
001966       09 FILLER  PIC X(4).                                       
001967       09 JO24-RDESSERVI    PIC X(28).                            
001968       09 JO24-RCODDIVIL    COMP PIC S9(4).                       
001969       09 JO24-RCODDIVIF    PIC X.                                
001970       09 FILLER  PIC X(4).                                       
001971       09 JO24-RCODDIVII    PIC X(2).                             
001972       09 JO24-RIMPORDIL    COMP PIC S9(4).                       
001973       09 JO24-RIMPORDIF    PIC X.                                
001974       09 FILLER  PIC X(4).                                       
001975       09 JO24-RIMPORDII    PIC X(14).                            
001976       09 JO24-RQTAORDIL    COMP PIC S9(4).                       
001977       09 JO24-RQTAORDIF    PIC X.                                
001978       09 FILLER  PIC X(4).                                       
001979       09 JO24-RQTAORDII    PIC X(14).                            
001980     05 JO24-MAPRPAGL  COMP PIC S9(4).                            
001981     05 JO24-MAPRPAGF  PIC X.                                     
001982     05 FILLER    PIC X(4).                                       
001983     05 JO24-MAPRPAGI  PIC X(4).                                  
001984     05 JO24-MAPPPAGL  COMP PIC S9(4).                            
001985     05 JO24-MAPPPAGF  PIC X.                                     
001986     05 FILLER    PIC X(4).                                       
001987     05 JO24-MAPPPAGI  PIC X(4).                                  
001988     05 JO24-MESSAGGL  COMP PIC S9(4).                            
001989     05 JO24-MESSAGGF  PIC X.                                     
001990     05 FILLER    PIC X(4).                                       
001991     05 JO24-MESSAGGI  PIC X(56).                                 
001992***************************************************************** 
001993* SDF: AVMLO24 AVJLO24                                            
001994***************************************************************** 
001995 01   AVJLO24O REDEFINES AVILO24I.                                
001996     05 FILLER    PIC X(12).                                      
001997     05 FILLER    PIC X(2).                                       
001998     05 JO24-CODSOCIEA      PIC X.                                
001999     05 JO24-CODSOCIEC PIC X.                                     
002000     05 JO24-CODSOCIEP PIC X.                                     
002001     05 JO24-CODSOCIEH PIC X.                                     
002002     05 JO24-CODSOCIEV PIC X.                                     
002003     05 JO24-CODSOCIEO      PIC X(2).                             
002004     05 FILLER    PIC X(2).                                       
002005     05 JO24-NOMSOCIEA      PIC X.                                
002006     05 JO24-NOMSOCIEC PIC X.                                     
002007     05 JO24-NOMSOCIEP PIC X.                                     
002008     05 JO24-NOMSOCIEH PIC X.                                     
002009     05 JO24-NOMSOCIEV PIC X.                                     
002010     05 JO24-NOMSOCIEO      PIC X(21).                            
002011     05 FILLER    PIC X(2).                                       
002012     05 JO24-FLAGSOSPA      PIC X.                                
002013     05 JO24-FLAGSOSPC PIC X.                                     
002014     05 JO24-FLAGSOSPP PIC X.                                     
002015     05 JO24-FLAGSOSPH PIC X.                                     
002016     05 JO24-FLAGSOSPV PIC X.                                     
002017     05 JO24-FLAGSOSPO      PIC X.                                
002018     05 FILLER    PIC X(2).                                       
002019     05 JO24-CODCLIENA      PIC X.                                
002020     05 JO24-CODCLIENC PIC X.                                     
002021     05 JO24-CODCLIENP PIC X.                                     
002022     05 JO24-CODCLIENH PIC X.                                     
002023     05 JO24-CODCLIENV PIC X.                                     
002024     05 JO24-CODCLIENO      PIC X(5).                             
002025     05 FILLER    PIC X(2).                                       
002026     05 JO24-RAGFATTUA      PIC X.                                
002027     05 JO24-RAGFATTUC PIC X.                                     
002028     05 JO24-RAGFATTUP PIC X.                                     
002029     05 JO24-RAGFATTUH PIC X.                                     
002030     05 JO24-RAGFATTUV PIC X.                                     
002031     05 JO24-RAGFATTUO      PIC X(23).                            
002032     05 FILLER    PIC X(2).                                       
002033     05 JO24-AAAACOMPA      PIC X.                                
002034     05 JO24-AAAACOMPC PIC X.                                     
002035     05 JO24-AAAACOMPP PIC X.                                     
002036     05 JO24-AAAACOMPH PIC X.                                     
002037     05 JO24-AAAACOMPV PIC X.                                     
002038     05 JO24-AAAACOMPO      PIC X(4).                             
002039     05 FILLER    PIC X(2).                                       
002040     05 JO24-MMMMCOMPA      PIC X.                                
002041     05 JO24-MMMMCOMPC PIC X.                                     
002042     05 JO24-MMMMCOMPP PIC X.                                     
002043     05 JO24-MMMMCOMPH PIC X.                                     
002044     05 JO24-MMMMCOMPV PIC X.                                     
002045     05 JO24-MMMMCOMPO      PIC X(2).                             
002046     05 FILLER    PIC X(2).                                       
002047     05 JO24-STATUSXXA      PIC X.                                
002048     05 JO24-STATUSXXC PIC X.                                     
002049     05 JO24-STATUSXXP PIC X.                                     
002050     05 JO24-STATUSXXH PIC X.                                     
002051     05 JO24-STATUSXXV PIC X.                                     
002052     05 JO24-STATUSXXO      PIC X.                                
002053     05 FILLER    PIC X(2).                                       
002054     05 JO24-CODSERVIA      PIC X.                                
002055     05 JO24-CODSERVIC PIC X.                                     
002056     05 JO24-CODSERVIP PIC X.                                     
002057     05 JO24-CODSERVIH PIC X.                                     
002058     05 JO24-CODSERVIV PIC X.                                     
002059     05 JO24-CODSERVIO      PIC X(6).                             
002060     05 FILLER    PIC X(2).                                       
002061     05 JO24-DESSERVIA      PIC X.                                
002062     05 JO24-DESSERVIC PIC X.                                     
002063     05 JO24-DESSERVIP PIC X.                                     
002064     05 JO24-DESSERVIH PIC X.                                     
002065     05 JO24-DESSERVIV PIC X.                                     
002066     05 JO24-DESSERVIO      PIC X(35).                            
002067     05 FILLER    PIC X(2).                                       
002068     05 JO24-TIPSERVIA      PIC X.                                
002069     05 JO24-TIPSERVIC PIC X.                                     
002070     05 JO24-TIPSERVIP PIC X.                                     
002071     05 JO24-TIPSERVIH PIC X.                                     
002072     05 JO24-TIPSERVIV PIC X.                                     
002073     05 JO24-TIPSERVIO      PIC X.                                
002074     05 FILLER    PIC X(2).                                       
002075     05 JO24-DESTIPSEA      PIC X.                                
002076     05 JO24-DESTIPSEC PIC X.                                     
002077     05 JO24-DESTIPSEP PIC X.                                     
002078     05 JO24-DESTIPSEH PIC X.                                     
002079     05 JO24-DESTIPSEV PIC X.                                     
002080     05 JO24-DESTIPSEO      PIC X(9).                             
002081     05 FILLER    PIC X(2).                                       
002082     05 JO24-CENCOSTDA      PIC X.                                
002083     05 JO24-CENCOSTDC PIC X.                                     
002084     05 JO24-CENCOSTDP PIC X.                                     
002085     05 JO24-CENCOSTDH PIC X.                                     
002086     05 JO24-CENCOSTDV PIC X.                                     
002087     05 JO24-CENCOSTDO      PIC X(5).                             
002088     05 FILLER    PIC X(2).                                       
002089     05 JO24-CENCOSTAA      PIC X.                                
002090     05 JO24-CENCOSTAC PIC X.                                     
002091     05 JO24-CENCOSTAP PIC X.                                     
002092     05 JO24-CENCOSTAH PIC X.                                     
002093     05 JO24-CENCOSTAV PIC X.                                     
002094     05 JO24-CENCOSTAO      PIC X(5).                             
002095     05 FILLER    PIC X(2).                                       
002096     05 JO24-CONTODCEA      PIC X.                                
002097     05 JO24-CONTODCEC PIC X.                                     
002098     05 JO24-CONTODCEP PIC X.                                     
002099     05 JO24-CONTODCEH PIC X.                                     
002100     05 JO24-CONTODCEV PIC X.                                     
002101     05 JO24-CONTODCEO      PIC X(6).                             
002102     05 FILLER    PIC X(2).                                       
002103     05 JO24-AANUMFATA      PIC X.                                
002104     05 JO24-AANUMFATC PIC X.                                     
002105     05 JO24-AANUMFATP PIC X.                                     
002106     05 JO24-AANUMFATH PIC X.                                     
002107     05 JO24-AANUMFATV PIC X.                                     
002108     05 JO24-AANUMFATO      PIC X(8).                             
002109     05 FILLER    PIC X(2).                                       
002110     05 JO24-OCODCLIEA      PIC X.                                
002111     05 JO24-OCODCLIEC PIC X.                                     
002112     05 JO24-OCODCLIEP PIC X.                                     
002113     05 JO24-OCODCLIEH PIC X.                                     
002114     05 JO24-OCODCLIEV PIC X.                                     
002115     05 JO24-OCODCLIEO      PIC X(5).                             
002116     05 FILLER    PIC X(2).                                       
002117     05 JO24-ORAGFATTA      PIC X.                                
002118     05 JO24-ORAGFATTC PIC X.                                     
002119     05 JO24-ORAGFATTP PIC X.                                     
002120     05 JO24-ORAGFATTH PIC X.                                     
002121     05 JO24-ORAGFATTV PIC X.                                     
002122     05 JO24-ORAGFATTO      PIC X(24).                            
002123     05 FILLER    PIC X(2).                                       
002124     05 JO24-TOTIMPORA      PIC X.                                
002125     05 JO24-TOTIMPORC PIC X.                                     
002126     05 JO24-TOTIMPORP PIC X.                                     
002127     05 JO24-TOTIMPORH PIC X.                                     
002128     05 JO24-TOTIMPORV PIC X.                                     
002129     05 JO24-TOTIMPORO      PIC Z(10)9,99.                        
002130     05 FILLER    PIC X(2).                                       
002131     05 JO24-TOTQUANTA      PIC X.                                
002132     05 JO24-TOTQUANTC PIC X.                                     
002133     05 JO24-TOTQUANTP PIC X.                                     
002134     05 JO24-TOTQUANTH PIC X.                                     
002135     05 JO24-TOTQUANTV PIC X.                                     
002136     05 JO24-TOTQUANTO      PIC Z(10)9,99.                        
002137     05 JO24-RIGAO OCCURS   17 TIMES .                            
002138       09 FILLER       PIC X(2).                                  
002139       09 JO24-OPERAZIOA    PIC X.                                
002140       09 JO24-OPERAZIOC    PIC X.                                
002141       09 JO24-OPERAZIOP    PIC X.                                
002142       09 JO24-OPERAZIOH    PIC X.                                
002143       09 JO24-OPERAZIOV    PIC X.                                
002144       09 JO24-OPERAZIOO    PIC X.                                
002145       09 FILLER       PIC X(2).                                  
002146       09 JO24-RAAMMCOMA    PIC X.                                
002147       09 JO24-RAAMMCOMC    PIC X.                                
002148       09 JO24-RAAMMCOMP    PIC X.                                
002149       09 JO24-RAAMMCOMH    PIC X.                                
002150       09 JO24-RAAMMCOMV    PIC X.                                
002151       09 JO24-RAAMMCOMO    PIC X(6).                             
002152       09 FILLER       PIC X(2).                                  
002153       09 JO24-RTIPSERVA    PIC X.                                
002154       09 JO24-RTIPSERVC    PIC X.                                
002155       09 JO24-RTIPSERVP    PIC X.                                
002156       09 JO24-RTIPSERVH    PIC X.                                
002157       09 JO24-RTIPSERVV    PIC X.                                
002158       09 JO24-RTIPSERVO    PIC X.                                
002159       09 FILLER       PIC X(2).                                  
002160       09 JO24-RCODSERVA    PIC X.                                
002161       09 JO24-RCODSERVC    PIC X.                                
002162       09 JO24-RCODSERVP    PIC X.                                
002163       09 JO24-RCODSERVH    PIC X.                                
002164       09 JO24-RCODSERVV    PIC X.                                
002165       09 JO24-RCODSERVO    PIC X(6).                             
002166       09 FILLER       PIC X(2).                                  
002167       09 JO24-RDESSERVA    PIC X.                                
002168       09 JO24-RDESSERVC    PIC X.                                
002169       09 JO24-RDESSERVP    PIC X.                                
002170       09 JO24-RDESSERVH    PIC X.                                
002171       09 JO24-RDESSERVV    PIC X.                                
002172       09 JO24-RDESSERVO    PIC X(28).                            
002173       09 FILLER       PIC X(2).                                  
002174       09 JO24-RCODDIVIA    PIC X.                                
002175       09 JO24-RCODDIVIC    PIC X.                                
002176       09 JO24-RCODDIVIP    PIC X.                                
002177       09 JO24-RCODDIVIH    PIC X.                                
002178       09 JO24-RCODDIVIV    PIC X.                                
002179       09 JO24-RCODDIVIO    PIC X(2).                             
002180       09 FILLER       PIC X(2).                                  
002181       09 JO24-RIMPORDIA    PIC X.                                
002182       09 JO24-RIMPORDIC    PIC X.                                
002183       09 JO24-RIMPORDIP    PIC X.                                
002184       09 JO24-RIMPORDIH    PIC X.                                
002185       09 JO24-RIMPORDIV    PIC X.                                
002186       09 JO24-RIMPORDIO    PIC Z(10)9,99.                        
002187       09 FILLER       PIC X(2).                                  
002188       09 JO24-RQTAORDIA    PIC X.                                
002189       09 JO24-RQTAORDIC    PIC X.                                
002190       09 JO24-RQTAORDIP    PIC X.                                
002191       09 JO24-RQTAORDIH    PIC X.                                
002192       09 JO24-RQTAORDIV    PIC X.                                
002193       09 JO24-RQTAORDIO    PIC Z(10)9,99.                        
002194     05 FILLER    PIC X(2).                                       
002195     05 JO24-MAPRPAGA  PIC X.                                     
002196     05 JO24-MAPRPAGC  PIC X.                                     
002197     05 JO24-MAPRPAGP  PIC X.                                     
002198     05 JO24-MAPRPAGH  PIC X.                                     
002199     05 JO24-MAPRPAGV  PIC X.                                     
002200     05 JO24-MAPRPAGO  PIC 9(4).                                  
002201     05 FILLER    PIC X(2).                                       
002202     05 JO24-MAPPPAGA  PIC X.                                     
002203     05 JO24-MAPPPAGC  PIC X.                                     
002204     05 JO24-MAPPPAGP  PIC X.                                     
002205     05 JO24-MAPPPAGH  PIC X.                                     
002206     05 JO24-MAPPPAGV  PIC X.                                     
002207     05 JO24-MAPPPAGO  PIC 9(4).                                  
002208     05 FILLER    PIC X(2).                                       
002209     05 JO24-MESSAGGA  PIC X.                                     
002210     05 JO24-MESSAGGC  PIC X.                                     
002211     05 JO24-MESSAGGP  PIC X.                                     
002212     05 JO24-MESSAGGH  PIC X.                                     
002213     05 JO24-MESSAGGV  PIC X.                                     
002214     05 JO24-MESSAGGO  PIC X(56).                                 
002215*--------------------------------DLOGI.TORDILOGI                  
002216 01  FILLER                      PIC X(8) VALUE 'FDLOG652'.       
002217*    EXEC SQL INCLUDE FDLOG652 END-EXEC.                          
      *>>((file: FDLOG652))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TORDILOGI                 *
000003******************************************************************
000004 01  DCLTORDILOGI.                                                
000005*                       AANUMORD                                  
000006     10 L652-AANUMORD        PIC X(8).                            
000007*                       CODCLIEN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000008     10 L652-CODCLIEN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000009*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000010     10 L652-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000011*                       CDDIVISI                                  
000012     10 L652-CDDIVISI        PIC X(1).                            
000013*                       DTCARORD                                  
000014     10 L652-DTCARORD        PIC X(8).                            
000015*                       CODDIVIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000016     10 L652-CODDIVIS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000017*                       TIPSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000018     10 L652-TIPSERVI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000019*                       FLAGAUTO                                  
000020     10 L652-FLAGAUTO        PIC X(1).                            
000021*                       FLAGGIVA                                  
000022     10 L652-FLAGGIVA        PIC X(1).                            
000023*                       CONTODCE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000024     10 L652-CONTODCE        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025*                       DTEVAORD                                  
000026     10 L652-DTEVAORD        PIC X(8).                            
000027*                       AANUMFAT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000028     10 L652-AANUMFAT        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000029*                       DTFATTUR                                  
000030     10 L652-DTFATTUR        PIC X(8).                            
000031*                       NRPREATT                                  
000032     10 L652-NRPREATT        PIC X(10).                           
000033*                       DTPREATT                                  
000034     10 L652-DTPREATT        PIC X(8).                            
000035*                       DTCREAZI                                  
000036     10 L652-DTCREAZI        PIC X(8).                            
000037*                       DTULTVAR                                  
000038     10 L652-DTULTVAR        PIC X(8).                            
000039*                       CODUTVAR                                  
000040     10 L652-CODUTVAR        PIC X(6).                            
000041*                       DTANNULL                                  
000042     10 L652-DTANNULL        PIC X(8).                            
000043*                       SOCIEMER                                  
000044     10 L652-SOCIEMER        PIC X(2).                            
000045*                       DATAESTR                                  
000046     10 L652-DATAESTR        PIC X(8).                            
000047*                       AAMMCOMP                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000048     10 L652-AAMMCOMP        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000049*                       FLAGSOSP                                  
000050     10 L652-FLAGSOSP        PIC X(1).                            
000051*                       CODUTEVB                                  
000052     10 L652-CODUTEVB        PIC X(6).                            
000053*                       ESENTIVA                                  
000054     10 L652-ESENTIVA        PIC X(1).                            
000055*                       FLORDIVB                                  
000056     10 L652-FLORDIVB        PIC X(1).                            
000057******************************************************************
000058* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 26      *
000059******************************************************************
      *<<((file: FDLOG652))
002218*--------------------------------DLOGI.TRIGORDILOGI               
002219 01  FILLER                      PIC X(8) VALUE 'FDLOG653'.       
002220*    EXEC SQL INCLUDE FDLOG653 END-EXEC.                          
      *>>((file: FDLOG653))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TRIGORDILOGI              *
000003******************************************************************
000004 01  DCLTRIGORDILOGI.                                             
000005     10 L653-AANUMORD        PIC X(8).                            
000006     10 L653-NRRIGORD        PIC S9(5)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000007     10 L653-CODSERVI        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000008     10 L653-UNMISURA        PIC X(2).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000009     10 L653-QTAORDIN        PIC S9(7)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000010     10 L653-PREZZORD        PIC S9(7)V9(4) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000011     10 L653-IMPORDIN        PIC S9(11)V9(2) USAGE COMP-3.        
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000012     10 L653-NOTENOTE        PIC X(40).                           
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000013     10 L653-CENCOSTD        PIC X(5).                            
000014     10 L653-CENCOSTA        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000015     10 L653-RIFECLIE        PIC X(15).                           
000016     10 L653-DTCREAZI        PIC X(8).                            
000017     10 L653-DTULTVAR        PIC X(8).                            
000018     10 L653-CODUTVAR        PIC X(6).                            
000019     10 L653-DTANNULL        PIC X(8).                            
000020     10 L653-IMPORIVA        PIC S9(11)V9(2) USAGE COMP-3.        
000021******************************************************************
000022* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 16      *
000023******************************************************************
      *<<((file: FDLOG653))
002221*--------------------------------DLOGI.TSERVIZI                   
002222 01  FILLER                      PIC X(8) VALUE 'FDLOG651'.       
002223*    EXEC SQL INCLUDE FDLOG651 END-EXEC.                          
      *>>((file: FDLOG651))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TSERVIZI                  *
000003******************************************************************
000004 01  DCLTSERVIZI.                                                 
000005*                       CODSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006     10 L651-CODSERVI        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007*                       DESSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000008     10 L651-DESSERVI        PIC X(40).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000009*                       UNMISURA                                  
000010     10 L651-UNMISURA        PIC X(2).                            
000011*                       TIPSERVI                                  
000012     10 L651-TIPSERVI        PIC X(1).                            
000013*                       DTCREAZI                                  
000014     10 L651-DTCREAZI        PIC X(8).                            
000015*                       DTULTVAR                                  
000016     10 L651-DTULTVAR        PIC X(8).                            
000017*                       CODUTVAR                                  
000018     10 L651-CODUTVAR        PIC X(6).                            
000019*                       CONTODCD                                  
000020     10 L651-CONTODCD        PIC X(6).                            
000021*                       CONTODCA                                  
000022     10 L651-CONTODCA        PIC X(6).                            
000023*                       CENCOSTA                                  
000024     10 L651-CENCOSTA        PIC X(5).                            
000025     10 L651-ESENTIVA        PIC X(1).                            
000026     10 L651-CONTPROV        PIC X(6).                            
000027******************************************************************
000028* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 12      *
000029******************************************************************
      *<<((file: FDLOG651))
002224*--------------------------------DANAGRAF.TDATEELAB               
002225 01  FILLER                      PIC X(8) VALUE 'FDANA847'.       
002226*    EXEC SQL INCLUDE FDANA847 END-EXEC.                          
      *>>((file: FDANA847))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TDATEELAB)                               *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA847))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        QUOTE                                                   *
000007* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000008******************************************************************
000009     
      *EXEC SQL DECLARE DANAGRAF.TDATEELAB TABLE                    
000010*     ( SIGLDATA                       CHAR(8) NOT NULL,           
000011*       TIPODATA                       CHAR(1) NOT NULL,           
000012*       DTINELAB                       CHAR(8) NOT NULL,           
000013*       TMINELAB                       CHAR(6) NOT NULL,           
000014*       DTFIELAB                       CHAR(8) NOT NULL,           
000015*       TMFIELAB                       CHAR(6) NOT NULL,           
000016*       DESCDATA                       CHAR(25) NOT NULL,          
000017*       FILLA200                       CHAR(200) NOT NULL,         
000018*       FILLB200                       CHAR(200) NOT NULL,         
000019*       FILLC200                       CHAR(200) NOT NULL,         
000020*       FILLD200                       CHAR(200) NOT NULL,         
000021*       FILLE200                       CHAR(200) NOT NULL,         
000022*       FILLF200                       CHAR(200) NOT NULL,         
000023*       FILLG200                       CHAR(200) NOT NULL,         
000024*       FILLH200                       CHAR(200) NOT NULL,         
000025*       FILLI200                       CHAR(200) NOT NULL,         
000026*       FILLJ200                       CHAR(200) NOT NULL,         
000027*       FILLK200                       CHAR(200) NOT NULL,         
000028*       FILLL200                       CHAR(200) NOT NULL,         
000029*       FILLM200                       CHAR(200) NOT NULL,         
000030*       FILLN200                       CHAR(200) NOT NULL,         
000031*       FILLO200                       CHAR(200) NOT NULL          
000032*     ) END-EXEC
                                                                        
000033******************************************************************
000034* COBOL DECLARATION FOR TABLE DANAGRAF.TDATEELAB                 *
000035******************************************************************
000036 01  DCLTDATEELAB.                                                
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000037     10 A847-SIGLDATA        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000038     10 A847-TIPODATA        PIC X(1).                            
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000039     10 A847-DTINELAB        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000040     10 A847-TMINELAB        PIC X(6).                            
000041     10 A847-DTFIELAB        PIC X(8).                            
000042     10 A847-TMFIELAB        PIC X(6).                            
000043     10 A847-DESCDATA        PIC X(25).                           
000044     10 A847-FILLA200        PIC X(200).                          
000045     10 A847-FILLB200        PIC X(200).                          
000046     10 A847-FILLC200        PIC X(200).                          
000047     10 A847-FILLD200        PIC X(200).                          
000048     10 A847-FILLE200        PIC X(200).                          
000049     10 A847-FILLF200        PIC X(200).                          
000050     10 A847-FILLG200        PIC X(200).                          
000051     10 A847-FILLH200        PIC X(200).                          
000052     10 A847-FILLI200        PIC X(200).                          
000053     10 A847-FILLJ200        PIC X(200).                          
000054     10 A847-FILLK200        PIC X(200).                          
000055     10 A847-FILLL200        PIC X(200).                          
000056     10 A847-FILLM200        PIC X(200).                          
000057     10 A847-FILLN200        PIC X(200).                          
000058     10 A847-FILLO200        PIC X(200).                          
000059******************************************************************
000060* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 22      *
000061******************************************************************
      *<<((file: FDANA847))
002227*--------------------------------DANAGRAF.TCLIENTI                
002228 01  FILLER                      PIC X(8) VALUE 'FDANA901'.       
002229*    EXEC SQL INCLUDE FDANA901 END-EXEC.                          
      *>>((file: FDANA901))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TCLIENTI                  *
000003******************************************************************
000004 01  DCLTCLIENTI.                                                 
000005*                       CODCLIEN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006     10 A901-CODCLIEN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007*                       STATCLIE                                  
000008     10 A901-STATCLIE        PIC X(1).                            
000009*                       GENECLIE                                  
000010     10 A901-GENECLIE        PIC X(1).                            
000011*                       TIPOCLIE                                  
000012     10 A901-TIPOCLIE        PIC X(1).                            
000013*                       TIPOCONS                                  
000014     10 A901-TIPOCONS        PIC X(1).                            
000015*                       CLIFOCON                                  
000016     10 A901-CLIFOCON        PIC X(5).                            
000017*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000018     10 A901-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000019*                       CAPOCONT                                  
000020     10 A901-CAPOCONT        PIC X(5).                            
000021*                       CODFISCA                                  
000022     10 A901-CODFISCA        PIC X(16).                           
000023*                       ESENTIVA                                  
000024     10 A901-ESENTIVA        PIC X(1).                            
000025*                       NUMESIVA                                  
000026     10 A901-NUMESIVA        PIC X(5).                            
000027*                       DATESIVA                                  
000028     10 A901-DATESIVA        PIC X(8).                            
000029*                       UFFICIVA                                  
000030     10 A901-UFFICIVA        PIC X(18).                           
000031*                       IMPESIVA                                  
000032     10 A901-IMPESIVA        PIC S9(4)V USAGE COMP-3.             
000033*                       BANCAPPO                                  
000034     10 A901-BANCAPPO        PIC X(3).                            
000035*                       NOMBANCL                                  
000036     10 A901-NOMBANCL        PIC X(114).                          
000037*                       CONTOCOR                                  
000038     10 A901-CONTOCOR        PIC X(13).                           
000039*                       ASSOBANC                                  
000040     10 A901-ASSOBANC        PIC X(5).                            
000041*                       AVVIBANC                                  
000042     10 A901-AVVIBANC        PIC X(5).                            
000043*                       CLIEFATT                                  
000044     10 A901-CLIEFATT        PIC X(5).                            
000045*                       PAESFATT                                  
000046     10 A901-PAESFATT        PIC X(3).                            
000047*                       RAGFATTU                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000048     10 A901-RAGFATTU        PIC X(24).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000049*                       ESRAGFAT                                  
000050     10 A901-ESRAGFAT        PIC X(24).                           
000051*                       INDFATTU                                  
000052     10 A901-INDFATTU        PIC X(24).                           
000053*                       ESINDFAT                                  
000054     10 A901-ESINDFAT        PIC X(24).                           
000055*                       CITFATTU                                  
000056     10 A901-CITFATTU        PIC X(18).                           
000057*                       ESCITFAT                                  
000058     10 A901-ESCITFAT        PIC X(18).                           
000059*                       CAPFATTU                                  
000060     10 A901-CAPFATTU        PIC X(5).                            
000061*                       PAESMERC                                  
000062     10 A901-PAESMERC        PIC X(3).                            
000063*                       RAGMERCE                                  
000064     10 A901-RAGMERCE        PIC X(24).                           
000065*                       ESRAGMER                                  
000066     10 A901-ESRAGMER        PIC X(24).                           
000067*                       INDMERCE                                  
000068     10 A901-INDMERCE        PIC X(24).                           
000069*                       ESINDMER                                  
000070     10 A901-ESINDMER        PIC X(24).                           
000071*                       CITMERCE                                  
000072     10 A901-CITMERCE        PIC X(18).                           
000073*                       ESCITMER                                  
000074     10 A901-ESCITMER        PIC X(18).                           
000075*                       CAPMERCE                                  
000076     10 A901-CAPMERCE        PIC X(5).                            
000077*                       ZONAMERC                                  
000078     10 A901-ZONAMERC        PIC X(2).                            
000079*                       TELCLIEN                                  
000080     10 A901-TELCLIEN        PIC X(20).                           
000081*                       TLXCLIEN                                  
000082     10 A901-TLXCLIEN        PIC X(20).                           
000083*                       FAXCLIEN                                  
000084     10 A901-FAXCLIEN        PIC X(20).                           
000085*                       RIFEMIRO                                  
000086     10 A901-RIFEMIRO        PIC X(11).                           
000087*                       PAESORDI                                  
000088     10 A901-PAESORDI        PIC X(3).                            
000089*                       ZONAORDI                                  
000090     10 A901-ZONAORDI        PIC X(2).                            
000091*                       DATVASTA                                  
000092     10 A901-DATVASTA        PIC X(8).                            
000093*                       ATTENZDI                                  
000094     10 A901-ATTENZDI        PIC X(24).                           
000095*                       CONDPAGA                                  
000096     10 A901-CONDPAGA        PIC X(3).                            
000097*                       MMESCLU1                                  
000098     10 A901-MMESCLU1        PIC S9(2)V USAGE COMP-3.             
000099*                       MMESCLU2                                  
000100     10 A901-MMESCLU2        PIC S9(2)V USAGE COMP-3.             
000101*                       GGSCATRA                                  
000102     10 A901-GGSCATRA        PIC S9(2)V USAGE COMP-3.             
000103*                       NUMGGVIA                                  
000104     10 A901-NUMGGVIA        PIC S9(2)V USAGE COMP-3.             
000105*                       TIPOTRAT                                  
000106     10 A901-TIPOTRAT        PIC X(1).                            
000107*                       ALTERSPE                                  
000108     10 A901-ALTERSPE        PIC X(1).                            
000109*                       CODILING                                  
000110     10 A901-CODILING        PIC X(1).                            
000111*                       DTULTVAR                                  
000112     10 A901-DTULTVAR        PIC X(8).                            
000113*                       TIPCLCAR                                  
000114     10 A901-TIPCLCAR        PIC X(1).                            
000115*                       SPETRASP                                  
000116     10 A901-SPETRASP        PIC X(1).                            
000117*                       DTCREAZI                                  
000118     10 A901-DTCREAZI        PIC X(8).                            
000119*                       CODDIVIS                                  
000120     10 A901-CODDIVIS        PIC X(2).                            
000121*                       CDIVACEE                                  
000122     10 A901-CDIVACEE        PIC X(14).                           
000123*                       ZONAFATT                                  
000124     10 A901-ZONAFATT        PIC X(2).                            
000125*                       CLASDOGA                                  
000126     10 A901-CLASDOGA        PIC X(1).                            
000127*                       INTNCLIE                                  
000128     10 A901-INTNCLIE        PIC X(50).                           
000129*                       CAPOCOMM                                  
000130     10 A901-CAPOCOMM        PIC X(5).                            
000131*                       PRIORITA                                  
000132     10 A901-PRIORITA        PIC X(1).                            
000133*                       BULSTATX                                  
000134     10 A901-BULSTATX        PIC X(13).                           
000135*                       CODUTVAR                                  
000136     10 A901-CODUTVAR        PIC X(6).                            
000137*                       CODUTCRE                                  
000138     10 A901-CODUTCRE        PIC X(6).                            
000139*                       CDRESCON                                  
000140     10 A901-CDRESCON        PIC X(2).                            
000141*                       CENCOACQ                                  
000142     10 A901-CENCOACQ        PIC X(5).                            
000143*                       CAPOSOCI                                  
000144     10 A901-CAPOSOCI        PIC X(5).                            
000145*                       CDFISCAL                                  
000146     10 A901-CDFISCAL        PIC X(16).                           
000147*                       CONDPACA                                  
000148     10 A901-CONDPACA        PIC X(3).                            
000149*                       CODXIBAN                                  
000150     10 A901-CODXIBAN        PIC X(4).                            
000151*                       CODXXCIN                                  
000152     10 A901-CODXXCIN        PIC X(2).                            
000153*                       ZIPFATTU                                  
000154     10 A901-ZIPFATTU        PIC X(15).                           
000155*                       ZIPMERCE                                  
000156     10 A901-ZIPMERCE        PIC X(15).                           
000157*                       TIPOLIST                                  
000158     10 A901-TIPOLIST        PIC X(1).                            
000159*                       SWIFTCOD                                  
000160     10 A901-SWIFTCOD        PIC X(11).                           
000161*                       PERCEIVA                                  
000162     10 A901-PERCEIVA        PIC S9(3)V9(2) USAGE COMP-3.         
000163*                       DTVALIVA                                  
000164     10 A901-DTVALIVA        PIC X(8).                            
000165*                       CLASSCLI                                  
000166     10 A901-CLASSCLI        PIC X(1).                            
000167*                       RATINGCO                                  
000168     10 A901-RATINGCO        PIC X(3).                            
000169*                       RISCHCLI                                  
000170     10 A901-RISCHCLI        PIC X(1).                            
000171*                                                                 
000172     10 A901-NRPROIVA        PIC X(30).                           
000173*                                                                 
000174     10 A901-IMPESNEW        PIC S9(9)V9(2) USAGE COMP-3.         
000175     10 A901-TIPOSTAG        PIC X(1).                            
000176     10 A901-FLFATELE        PIC X(1).                            
000177     10 A901-CDDESTFE        PIC X(7).                            
000178     10 A901-INPECCLI        PIC X(50).                           
000179******************************************************************
000180* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 88      *
000181******************************************************************
      *<<((file: FDANA901))
002230*--------------------------------DANAGRAF.TSOCIETA                
002231 01  FILLER                      PIC X(8) VALUE 'FDANA531'.       
002232*    EXEC SQL INCLUDE FDANA531 END-EXEC.                          
      *>>((file: FDANA531))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TSOCIETA                  *
000003******************************************************************
000004 01  DCLTSOCIETA.                                                 
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 A531-CODSOCIE        PIC X(2).                            
000006     10 A531-NOMSOCIE        PIC X(23).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007     10 A531-CODFORNI        PIC X(5).                            
000008     10 A531-TASSINTE        PIC S9(3)V9(2) USAGE COMP-3.         
000009     10 A531-CODPAESE        PIC X(3).                            
000010     10 A531-NRGGRISC        PIC S9(3)V USAGE COMP-3.             
000011     10 A531-CODPIANO        PIC X(2).                            
000012     10 A531-CITTASOC        PIC X(18).                           
000013     10 A531-FLPAGIVA        PIC X(1).                            
000014     10 A531-FLFATACQ        PIC X(1).                            
000015     10 A531-CODAZIEN        PIC X(5).                            
000016     10 A531-FLIVATRA        PIC X(1).                            
000017     10 A531-CODDIVIS        PIC X(2).                            
000018     10 A531-COSTINTE        PIC S9(3)V9(2) USAGE COMP-3.         
000019     10 A531-FLCONTAB        PIC X(1).                            
000020     10 A531-FLAGMAGA        PIC X(1).                            
000021     10 A531-RAGSOCIE        PIC X(50).                           
000022     10 A531-SOCIECON        PIC X(2).                            
000023     10 A531-DTCREAZI        PIC X(8).                            
000024     10 A531-DTULTVAR        PIC X(8).                            
000025     10 A531-CODUTVAR        PIC X(6).                            
000026     10 A531-INDLEGAL        PIC X(35).                           
000027     10 A531-CAPLEGAL        PIC X(5).                            
000028     10 A531-CITLEGAL        PIC X(18).                           
000029     10 A531-CODFISCA        PIC X(16).                           
000030     10 A531-CODDIVRI        PIC X(2).                            
000031     10 A531-SOCIEGTM        PIC X(2).                            
000032     10 A531-GENEFATT        PIC X(1).                            
000033     10 A531-FLAGATTI        PIC X(1).                            
000034     10 A531-DIVISOLD        PIC X(2).                            
000035     10 A531-DTFINOLD        PIC X(8).                            
000036     10 A531-DIVRIOLD        PIC X(2).                            
000037     10 A531-DIVIRIFA        PIC X(2).                            
000038     10 A531-FLEURUSA        PIC X(1).                            
000039     10 A531-FLAGLIMI        PIC X(1).                            
000040     10 A531-FLFILIAL        PIC X(1).                            
000041     10 A531-FLPRESEN        PIC X(1).                            
000042     10 A531-CODSOCPA        PIC X(1).                            
000043     10 A531-FLBOLGVB        PIC X(1).                            
000044     10 A531-FLSTCART        PIC X(1).                            
000045     10 A531-FLDIPEST        PIC X(1).                            
000046     10 A531-CODFIRMA        PIC X(8).                            
000047     10 A531-DESFIRMA        PIC X(24).                           
000048     10 A531-CDSOCJDE        PIC X(5).                            
000049     10 A531-CODFORNV        PIC X(5).                            
000050     10 A531-CODFORNA        PIC X(5).                            
000051     10 A531-IMPCCASO        PIC S9(13) COMP-3.                   
000052     10 A531-TRIBCCIA        PIC X(10).                           
000053     10 A531-PROLEGAL        PIC X(2).                            
000054     10 A531-FLSOCSAP        PIC X(1).                            
000055     10 A531-DIVIXLAV        PIC X(2).                            
000056******************************************************************
000057* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 51      *
000058******************************************************************
      *<<((file: FDANA531))
002233*--------------------------------DANAGRAF.TMESSAGGI               
002234 01  FILLER                      PIC X(8) VALUE 'FDANA846'.       
002235*    EXEC SQL INCLUDE FDANA846 END-EXEC.                          
      *>>((file: FDANA846))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TMESSAGGI)                               *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA846))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        QUOTE                                                   *
000007* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000008******************************************************************
000009     
      *EXEC SQL DECLARE DANAGRAF.TMESSAGGI TABLE                    
000010*     ( CODERROR                       CHAR(5) NOT NULL,           
000011*       CODILING                       CHAR(1) NOT NULL,           
000012*       MSGERROR                       CHAR(60) NOT NULL,          
000013*       TIPOMESS                       CHAR(1) NOT NULL,           
000014*       DTCREAZI                       CHAR(8) NOT NULL,           
000015*       DTULTVAR                       CHAR(8) NOT NULL,           
000016*       CODUTVAR                       CHAR(6) NOT NULL            
000017*     ) END-EXEC
                                                                        
000018******************************************************************
000019* COBOL DECLARATION FOR TABLE DANAGRAF.TMESSAGGI                 *
000020******************************************************************
000021 01  DCLTMESSAGGI.                                                
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000022     10 A846-CODERROR        PIC X(5).                            
000023     10 A846-CODILING        PIC X(1).                            
000024     10 A846-MSGERROR        PIC X(60).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025     10 A846-TIPOMESS        PIC X(1).                            
000026     10 A846-DTCREAZI        PIC X(8).                            
000027     10 A846-DTULTVAR        PIC X(8).                            
000028     10 A846-CODUTVAR        PIC X(6).                            
000029******************************************************************
000030* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 7       *
000031******************************************************************
      *<<((file: FDANA846))
002236*--------------------------------DANAGRAF.TDATARIO                
002237 01  FILLER                      PIC X(8) VALUE 'FDANA973'.       
002238*    EXEC SQL INCLUDE FDANA973 END-EXEC.                          
      *>>((file: FDANA973))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TDATARIO)                                *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA973))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(A973-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DANAGRAF.TDATARIO TABLE                     
000012*     ( DTGIORNO                       CHAR(8) NOT NULL,           
000013*       PRGIORNO                       DECIMAL(7, 0) NOT NULL,     
000014*       NUMGIORN                       CHAR(3) NOT NULL,           
000015*       NUMSETTI                       CHAR(2) NOT NULL,           
000016*       NRGGSETT                       CHAR(1) NOT NULL,           
000017*       DTINISET                       CHAR(8) NOT NULL,           
000018*       DTFINSET                       CHAR(8) NOT NULL,           
000019*       DTINIMES                       CHAR(8) NOT NULL,           
000020*       DTFINMES                       CHAR(8) NOT NULL,           
000021*       ANNOSETT                       CHAR(6) NOT NULL,           
000022*       FLAGFEST                       CHAR(1) NOT NULL            
000023*     ) END-EXEC
                                                                        
000024******************************************************************
000025* COBOL DECLARATION FOR TABLE DANAGRAF.TDATARIO                  *
000026******************************************************************
000027 01  DCLTDATARIO.                                                 
000028*                       DTGIORNO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000029     10 A973-DTGIORNO        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000030*                       PRGIORNO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000031     10 A973-PRGIORNO        PIC S9(7)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000032*                       NUMGIORN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000033     10 A973-NUMGIORN        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000034*                       NUMSETTI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000035     10 A973-NUMSETTI        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000036*                       NRGGSETT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000037     10 A973-NRGGSETT        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000038*                       DTINISET                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000039     10 A973-DTINISET        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000040*                       DTFINSET                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000041     10 A973-DTFINSET        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000042*                       DTINIMES                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000043     10 A973-DTINIMES        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000044*                       DTFINMES                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000045     10 A973-DTFINMES        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000046*                       ANNOSETT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000047     10 A973-ANNOSETT        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000048*                       FLAGFEST                                  
000049     10 A973-FLAGFEST        PIC X(1).                            
000050******************************************************************
000051* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 11      *
000052******************************************************************
      *<<((file: FDANA973))
002239*--------------------------------DCDTGG                           
002240 01  FILLER                      PIC X(8) VALUE '**DCDTGG'.       
002241*    EXEC SQL INCLUDE DCDTGG   END-EXEC.                          
      *>>((file: DCDTGG))
000001*----------------------------------------------------------------*
000002*----               AREA PER SUBROUTINE SRDTGG               ----*
000003*----------------------------------------------------------------*
000004 01  DCDTGG.                                                      
000005*-------------------------------------------- CAMPI DI INPUT      
000006     02 DTGG-DTRICHIE         PIC X(08)         VALUE SPACES.     
000007     02 DTGG-PRRICHIE         PIC S9(7) COMP-3  VALUE +0.         
000008                                                                  
000009*-------------------------------------------- CAMPI DI OUTPUT     
000010     02 DTGG-DTGIORNO.                                            
000011        03 DTGG-SAGIORNO.                                         
000012           04 DTGG-SSGIORNO   PIC XX.                             
000013           04 DTGG-AAGIORNO   PIC XX.                             
000014        03 DTGG-MMGIORNO      PIC XX.                             
000015        03 DTGG-GGGIORNO      PIC XX.                             
000016     02 DTGG-PRGIORNO         PIC S9(7) COMP-3.                   
000017     02 DTGG-NUMSETTI         PIC X(02).                          
000018     02 DTGG-NUMGIORN         PIC X(03).                          
000019     02 DTGG-NRGGSETT         PIC X(01).                          
000020     02 DTGG-DTINISET.                                            
000021        03 DTGG-SAINISET.                                         
000022           04 DTGG-SSINISET   PIC XX.                             
000023           04 DTGG-AAINISET   PIC XX.                             
000024        03 DTGG-MMINISET      PIC XX.                             
000025        03 DTGG-GGINISET      PIC XX.                             
000026     02 DTGG-DTFINSET         PIC X(08).                          
000027     02 DTGG-DTINIMES         PIC X(08).                          
000028     02 DTGG-DTFINMES         PIC X(08).                          
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000029     02 DTGG-CURRENDT         PIC X(08).                          
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000030     02 DTGG-DTCURREN.                                            
000031        03 DTGG-AACURREN      PIC X(04).                          
000032        03 DTGG-MMCURREN      PIC X(02).                          
000033        03 DTGG-GGCURREN      PIC X(02).                          
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000034     02 DTGG-DATAGIOR         PIC X(10).                          
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000035     02 DTGG-ANNOSETT.                                            
000036        03 DTGG-SSAASETT      PIC X(04).                          
000037        03 DTGG-SETTSETT      PIC X(02).                          
000038     02 DTGG-FILLER4          PIC X(04).                          
000039     02 DTGG-RETUCODE         PIC X(04).                          
000040*----------------------------------------------------------------*
      *<<((file: DCDTGG))
002242*    RICERCA PER CODICE CLIENTE                                   
002244     
      *EXEC SQL 
      *DECLARE POINTER1  CURSOR FOR                            
002245*           SELECT A.CODCLIEN, A.AAMMCOMP                          
002246*                 ,A.TIPSERVI                                      
002247*                 ,B.CODSERVI                                      
002248*                 ,A.CODDIVIS, S.DESSERVI                          
002249*                 ,SUM(B.QTAORDIN) QTAORDIN                        
002250*                 ,SUM(B.IMPORDIN) IMPORDIN                        
002251*             FROM DLOGISTI.TORDILOGI    A                         
002252*                 ,DLOGISTI.TRIGORDILOGI B                         
002253*                 ,DLOGISTI.TSERVIZI     S                         
002254*            WHERE A.CODSOCIE = :L652-CODSOCIE                     
002255*              AND A.CODCLIEN BETWEEN :MIN-CODCLIEN                
002256*                                 AND :MAX-CODCLIEN                
002257*              AND A.CONTODCE LIKE :L652-CONTODCE                  
002258*              AND A.TIPSERVI BETWEEN :MIN-TIPSERVI                
002259*                                 AND :MAX-TIPSERVI                
002260*              AND A.AAMMCOMP BETWEEN :MIN-AAMMCOMP                
002261*                                 AND :MAX-AAMMCOMP                
002262*              AND A.DTEVAORD BETWEEN :MIN-DTEVAORD                
002263*                                 AND :MAX-DTEVAORD                
002264*              AND A.DTFATTUR BETWEEN :MIN-DTFATTUR                
002265*                                 AND :MAX-DTFATTUR                
002266*              AND A.FLAGSOSP BETWEEN :MIN-FLAGSOSP                
002267*                                 AND :MAX-FLAGSOSP                
002268*              AND A.AANUMFAT BETWEEN :MIN-AANUMFAT                
002269*                                 AND :MAX-AANUMFAT                
002270*              AND A.DTANNULL = ' '                                
002271*              AND A.AANUMORD = B.AANUMORD                         
002272*              AND B.DTANNULL = ' '                                
002273*              AND B.CODSERVI LIKE :L653-CODSERVI                  
002274*              AND B.CENCOSTD LIKE :L653-CENCOSTD                  
002275*              AND B.CENCOSTA LIKE :L653-CENCOSTA                  
002276*              AND S.CODSERVI = B.CODSERVI                         
002277*              AND S.DESSERVI LIKE :L651-DESSERVI                  
002278*            GROUP BY A.CODCLIEN, A.AAMMCOMP                       
002279*                    ,A.TIPSERVI, B.CODSERVI                       
002280*                    ,A.CODDIVIS, S.DESSERVI                       
002281*            UNION ALL                                             
002282*           SELECT A.CODCLIEN, A.AAMMCOMP                          
002283*                 ,A.TIPSERVI                                      
002284*                 ,CASE WHEN B.CODSERVI > ' '                      
002285*                       THEN B.CODSERVI                            
002286*                       ELSE '??????' END CODSERVI                 
002287*                 ,A.CODDIVIS, ' ' DESSERVI                        
002288*                 ,SUM(B.QTAORDIN) QTAORDIN                        
002289*                 ,SUM(B.IMPORDIN) IMPORDIN                        
002290*             FROM DLOGISTI.TORDILOGI    A                         
002291*                 ,DLOGISTI.TRIGORDILOGI B                         
002292*            WHERE A.CODSOCIE = :L652-CODSOCIE                     
002293*              AND A.CODCLIEN BETWEEN :MIN-CODCLIEN                
002294*                                 AND :MAX-CODCLIEN                
002295*              AND A.CONTODCE LIKE :L652-CONTODCE                  
002296*              AND A.TIPSERVI BETWEEN :MIN-TIPSERVI                
002297*                                 AND :MAX-TIPSERVI                
002298*              AND A.AAMMCOMP BETWEEN :MIN-AAMMCOMP                
002299*                                 AND :MAX-AAMMCOMP                
002300*              AND A.DTEVAORD BETWEEN :MIN-DTEVAORD                
002301*                                 AND :MAX-DTEVAORD                
002302*              AND A.DTFATTUR BETWEEN :MIN-DTFATTUR                
002303*                                 AND :MAX-DTFATTUR                
002304*              AND A.FLAGSOSP BETWEEN :MIN-FLAGSOSP                
002305*                                 AND :MAX-FLAGSOSP                
002306*              AND A.AANUMFAT BETWEEN :MIN-AANUMFAT                
002307*                                 AND :MAX-AANUMFAT                
002308*              AND A.DTANNULL = ' '                                
002309*              AND A.AANUMORD = B.AANUMORD                         
002310*              AND B.DTANNULL = ' '                                
002311*              AND B.CODSERVI LIKE :L653-CODSERVI                  
002312*              AND B.CENCOSTD LIKE :L653-CENCOSTD                  
002313*              AND B.CENCOSTA LIKE :L653-CENCOSTA                  
002314*              AND NOT EXISTS                                      
002315*                 (SELECT S.CODSERVI                               
002316*                    FROM DLOGISTI.TSERVIZI S                      
002317*                   WHERE S.CODSERVI = B.CODSERVI)                 
002318*            GROUP BY A.CODCLIEN, A.AAMMCOMP                       
002319*                    ,A.TIPSERVI, B.CODSERVI                       
002320*                    ,A.CODDIVIS                                   
002321*            ORDER BY 1 , 2 , 3 , 4                                
002322*     END-EXEC
                                                                        
002323*    RICERCA CLIENTE (PF13)                                       
002325     
      *EXEC SQL 
      *DECLARE POINTPF13 CURSOR FOR                            
002326*           SELECT CODCLIEN, RAGFATTU                              
002327*             FROM DANAGRAF.TCLIENTI                               
002328*            WHERE CODCLIEN > :WS-CODCLIEN                         
002329*              AND RAGFATTU LIKE :WS-RAGFATTU                      
002330*            ORDER BY CODCLIEN                                     
002331*     END-EXEC
                                                                        
002332*    RICERCA CLIENTE (PF14)                                       
002334     
      *EXEC SQL 
      *DECLARE POINTPF14 CURSOR FOR                            
002335*           SELECT CODCLIEN, RAGFATTU                              
002336*             FROM DANAGRAF.TCLIENTI                               
002337*            WHERE CODCLIEN < :WS-CODCLIEN                         
002338*              AND RAGFATTU LIKE :WS-RAGFATTU                      
002339*            ORDER BY CODCLIEN DESC                                
002340*     END-EXEC
                                                                        
002343*    EXEC SQL                                                     
      *         INCLUDE SQLCA                                           
      *    END-EXEC.                                                    
      *>>((file: SQLCA))
000001****************************************************************<*
000002* Copyright (c) 2016-2023 NTT DATA, Inc. All rights reserved.  *<*
000003* Users of NTT DATA Enterprise COBOL may freely                *<*
000004* redistribute this copybook.                                  *<*
000005****************************************************************<*
000006                                                                  
000007 01  SQLCA GLOBAL.                                                
000008     05  SQLCAID                PIC X(8).                         
000009     05  SQLCABC                PIC S9(9) COMP-5.                 
000010     05  SQLCODE                PIC S9(9) COMP-5.                 
000011     05  SQLERRM.                                                 
000012         49  SQLERRML           PIC S9(4) COMP-5.                 
000013         49  SQLERRMC           PIC X(254).                       
000014     05  SQLERRP                PIC X(8).                         
000015     05  SQLERRD OCCURS 6 TIMES PIC S9(9) COMP-5.                 
000016     05  SQLWARN.                                                 
000017         10 SQLWARN0            PIC X(1).                         
000018         10 SQLWARN1            PIC X(1).                         
000019         10 SQLWARN2            PIC X(1).                         
000020         10 SQLWARN3            PIC X(1).                         
000021         10 SQLWARN4            PIC X(1).                         
000022         10 SQLWARN5            PIC X(1).                         
000023         10 SQLWARN6            PIC X(1).                         
000024         10 SQLWARN7            PIC X(1).                         
000025     05  SQLSTATE               PIC X(5).                         
000026     05  SQLEXT                 PIC S9(5) COMP-3 VALUE 1.         
      *<<((file: SQLCA))
002344****************************************************************  
002345*                                                                 
002346* Copyright (c) 2016-2022 NTT DATA, Inc.                          
002347* All rights reserved.                                            
002348*                                                                 
002349****************************************************************  
002350 01  DFHEIV.                                                      
002351   02  DFHEIV0               PIC X(35).                           
002352   02  DFHEIV1               PIC X(08).                           
002353   02  DFHEIV2               PIC X(08).                           
002354   02  DFHEIV3               PIC X(08).                           
002355   02  DFHEIV4               PIC X(06).                           
002356   02  DFHEIV5               PIC X(04).                           
002357   02  DFHEIV6               PIC X(04).                           
002358   02  DFHEIV7               PIC X(02).                           
002359   02  DFHEIV8               PIC X(02).                           
002360   02  DFHEIV9               PIC X(01).                           
002361   02  DFHEIV10              PIC S9(7) COMP-3.                    
002362   02  DFHEIV11              PIC S9(4) COMP SYNC.                 
002363   02  DFHEIV12              PIC S9(4) COMP SYNC.                 
002364   02  DFHEIV13              PIC S9(4) COMP SYNC.                 
002365   02  DFHEIV14              PIC S9(4) COMP SYNC.                 
002366   02  DFHEIV15              PIC S9(4) COMP SYNC.                 
002367   02  DFHEIV16              PIC S9(9) COMP SYNC.                 
002368   02  DFHEIV17              PIC X(04).                           
002369   02  DFHEIV18              PIC X(04).                           
002370   02  DFHEIV19              PIC X(04).                           
002371   02  DFHEIV20              USAGE IS POINTER.                    
002372   02  DFHEIV21              USAGE IS POINTER.                    
002373   02  DFHEIV22              USAGE IS POINTER.                    
002374   02  DFHEIV23              USAGE IS POINTER.                    
002375   02  DFHEIV24              USAGE IS POINTER.                    
002376   02  DFHEIV25              PIC S9(9) COMP SYNC.                 
002377   02  DFHEIV26              PIC S9(9) COMP SYNC.                 
002378   02  DFHEIV27              PIC S9(9) COMP SYNC.                 
002379   02  DFHEIV28              PIC S9(9) COMP SYNC.                 
002380   02  DFHEIV29              PIC S9(9) COMP SYNC.                 
002381   02  DFHEIV30              PIC S9(9) COMP SYNC.                 
002382   02  DFHEIV31              PIC S9(9) COMP SYNC.                 
002383   02  DFHEIV32              PIC S9(4) COMP SYNC.                 
002384   02  DFHEIV33              PIC S9(4) COMP SYNC.                 
002385   02  DFHEIV34              PIC S9(4) COMP SYNC.                 
002386   02  DFHEIV35              PIC S9(4) COMP SYNC.                 
002387   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.         
002388   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.      
002389   02  FILLER                PIC X(02).                           
002390   02  DFHEIV99              PIC X(08) VALUE SPACE.               
002391   02  DFHEIVL0              PIC X(48) VALUE SPACE.               
002392   02  DFHEIVL1              PIC X(48) VALUE SPACE.               
002393   02  DFHEIVL2              PIC X(48) VALUE SPACE.               
002394   02  DFHEIVL3              PIC X(48) VALUE SPACE.               
002395   02  DFHEIVL4              PIC X(255) VALUE SPACE.              
002396   02  DFHEIVL5              PIC X(255) VALUE SPACE.              
002397 LINKAGE  SECTION.                                                
002398***************************************************************** 
002399*                                                               * 
002400* Copyright (c) 2016-2022 NTT DATA, Inc.                        * 
002401* All rights reserved.                                          * 
002402*                                                               * 
002403***************************************************************** 
002404 01  dfheiblk.                                                    
002405     02  eibtime          pic s9(7) comp-3.                       
002406     02  eibdate          pic s9(7) comp-3.                       
002407     02  eibtrnid         pic x(4).                               
002408     02  eibtaskn         pic s9(7) comp-3.                       
002409     02  eibtrmid         pic x(4).                               
002410     02  dfheigdi         pic s9(4) comp.                         
002411     02  eibcposn         pic s9(4) comp.                         
002412     02  eibcalen         pic s9(4) comp.                         
002413     02  eibaid           pic x(1).                               
002414     02  eibfiller1       pic x(1).                               
002415     02  eibfn            pic x(2).                               
002416     02  eibfiller2       pic x(2).                               
002417     02  eibrcode         pic x(6).                               
002418     02  eibfiller3       pic x(2).                               
002419     02  eibds            pic x(8).                               
002420     02  eibreqid         pic x(8).                               
002421     02  eibrsrce         pic x(8).                               
002422     02  eibsync          pic x(1).                               
002423     02  eibfree          pic x(1).                               
002424     02  eibrecv          pic x(1).                               
002425     02  eibsend          pic x(1).                               
002426     02  eibatt           pic x(1).                               
002427     02  eibeoc           pic x(1).                               
002428     02  eibfmh           pic x(1).                               
002429     02  eibcompl         pic x(1).                               
002430     02  eibsig           pic x(1).                               
002431     02  eibconf          pic x(1).                               
002432     02  eiberr           pic x(1).                               
002433     02  eibrldbk         pic x(1).                               
002434     02  eiberrcd         pic x(4).                               
002435     02  eibsynrb         pic x(1).                               
002436     02  eibnodat         pic x(1).                               
002437     02  eibfiller5       pic x(2).                               
002438     02  eibresp          pic s9(8) comp.                         
002439     02  eibresp2         pic s9(8) comp.                         
002440     02  dfheigdj         pic s9(4) comp.                         
002441     02  dfheigdk         pic s9(4) comp.                         
002442*----------------*                                                
002443 01  DFHCOMMAREA.                                                 
002444*    COPY DCLCOMMA.                                               
002445     02 LK-AREABYTE PIC X OCCURS 0 TO 4096 TIMES                  
002446                       DEPENDING ON EIBCALEN OF DFHEIBLK.         
002447*-----------------------------------------------------------------
002448 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.                   
002448 VCOBOL-DUMMY-PROCEDURE.
002449 0000-DFHENTRY SECTION.                                           
002450     MOVE FUNCTION WHEN-COMPILED TO DFHEIVL0(1:21).               
002451     MOVE SPACES TO DFHEIV2.                                      
002452     MOVE '9#                    &   ' TO DFHEIV0.                
002453     MOVE 'AVTLO24' TO DFHEIV1.                                   
002454     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1       
002455          DFHEIVL0 DFHEIV2.                                       
002456*-----------------------------------------------------------------
002457                                                                  
002458* EXEC CICS HANDLE ABEND LABEL(Z00-ERRORE)     END-EXEC.          
002459*    MOVE '..L                   " " #00002450' TO DFHEIV0        
002460     MOVE X'2E2E4C202020202020202020' &                           
002461          X'202020202020202020202220' &                           
002462          X'2220233030303032343530' TO DFHEIV0                    
002463     CALL 'kxdfhei1' USING DFHEIV0,                               
002464           DFHEIV99                                               
002465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002466                                                                  
002467     
      *EXEC SQL WHENEVER SQLERROR GO TO Z00-ERRORE END-EXEC
                                                                        
002468     PERFORM A00-INIZIALIZZAZIONE                                 
002469        THRU A00-EX.                                              
002470     IF  EIBCALEN NOT > ZERO                                      
002471         PERFORM B00-ARRIVO-DA-START                              
002472            THRU B00-EX                                           
002473     ELSE                                                         
002474         MOVE DFHCOMMAREA        TO WCOM-AREAXXXX                 
002475         MOVE 'AVMLO24'          TO WNOMEMAP                      
002476         MOVE WCOM-CODILING      TO WCODLING                      
002477         IF EIBAID = DFHENTER OR                                  
002478            EIBAID = DFHPF10  OR                                  
002479            EIBAID = DFHPF13  OR                                  
002480            EIBAID = DFHPF14                                      
002481            PERFORM C00-RICEVI-MAPPA                              
002482               THRU C00-EX                                        
002483         ELSE                                                     
002484            PERFORM D00-GESTIONE-PF                               
002485               THRU D00-EX.                                       
002486     PERFORM E30-INVIA-MAPPA                                      
002487        THRU E30-EX.                                              
002488     PERFORM U00-RETURN-TRAN                                      
002489        THRU U00-EX.                                              
002490*----------------------------------------------------------------*
002491 A00-INIZIALIZZAZIONE.                                            
002492*----------------------------------------------------------------*
002493     MOVE +500                   TO WCOM-LUNGHEZZ.                
002494     MOVE EIBTRMID               TO WPAGVIDE                      
002495                                    WPAGVID2.                     
002496     MOVE LOW-VALUE              TO AVILO24O.                     
002497     MOVE 17                     TO WNUMRIGA.                     
002498     MOVE LENGTH OF WPAGREFE     TO WPAGLPAG.                     
002499     MOVE LENGTH OF WPAGREF2     TO WPAGLPA2.                     
002500 A00-EX. EXIT.                                                    
002501*----------------------------------------------------------------*
002502 B00-ARRIVO-DA-START.                                             
002503*----------------------------------------------------------------*
002504                                                                  
002505* EXEC CICS HANDLE CONDITION ENDDATA (B05-NORESP)                 
002506*                               END-EXEC                          
002507*    MOVE '"$&                   ! # #00002488' TO DFHEIV0        
002508     MOVE X'222426202020202020202020' &                           
002509          X'202020202020202020202120' &                           
002510          X'2320233030303032343838' TO DFHEIV0                    
002511     CALL 'kxdfhei1' USING DFHEIV0                                
002512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
002513                                                                  
002514* EXEC CICS RETRIEVE INTO   (WCOM-AREAXXXX)                       
002515*                       LENGTH (WCOM-LUNGHEZZ)                    
002516*                       END-EXEC                                  
002517*    MOVE '0*I L                 &   #00002490' TO DFHEIV0        
002518     MOVE X'302A49204C20202020202020' &                           
002519          X'202020202020202020202620' &                           
002520          X'2020233030303032343930' TO DFHEIV0                    
002521     CALL 'kxdfhei1' USING DFHEIV0,                               
002522           WCOM-AREAXXXX,                                         
002523           WCOM-LUNGHEZZ,                                         
002524           DFHEIV99,                                              
002525           DFHEIV99,                                              
002526           DFHEIV99                                               
002527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
002528     INITIALIZE  WCOM-DATIPROG.                                   
002529     PERFORM LEGGO-RICICLO                                        
002530        THRU LEGGO-RICICLO-EX.                                    
002531     PERFORM B10-PRIMA-VOLTA                                      
002532        THRU B10-EX.                                              
002533     IF WCOM-DTCARORD NOT > SPACES                                
002534        PERFORM L30-SELECT-DATEELAB                               
002535           THRU L30-EX                                            
002536        MOVE A847-DTINELAB       TO WCOM-DTCARORD.                
002537     MOVE WCOM-CODSOCIE          TO LO24-CODSOCIEO.               
002538     MOVE WCOM-CODCLIEN          TO LO24-CODCLIENO.               
002539     MOVE WCOM-RAGFATTU          TO LO24-RAGFATTUO.               
002540     MOVE WCOM-DTCARORD(1:4)     TO LO24-AAAACOMPO.               
002541     MOVE WCOM-DTCARORD(5:2)     TO LO24-MMMMCOMPO.               
002542     MOVE WCOM-SALDATOX          TO LO24-FLAGSOSPO.               
002543     MOVE WCOM-STATUSXX          TO LO24-STATUSXXO.               
002544     MOVE WCOM-CODSERVI          TO LO24-CODSERVIO.               
002545     MOVE WCOM-DESSERVI          TO LO24-DESSERVIO.               
002546     MOVE WCOM-TIPSERVI          TO LO24-TIPSERVIO.               
002547     MOVE WCOM-CONTODCE          TO LO24-CONTODCEO.               
002548     MOVE WCOM-AANUMFAT          TO LO24-AANUMFATO.               
002549     MOVE WCOM-CENCOSTD          TO LO24-CENCOSTDO.               
002550     MOVE WCOM-CENCOSTA          TO LO24-CENCOSTAO.               
002551     PERFORM C20-GESTIONE-RICICLO                                 
002552        THRU C20-EX.                                              
002553 B00-EX. EXIT.                                                    
002554*----------------------------------------------------------------*
002555 B05-NORESP.                                                      
002556*----------------------------------------------------------------*
002557                                                                  
002558* EXEC CICS SEND CONTROL                                          
002559*                   ERASE                                         
002560*                   CURSOR                                        
002561*                   FREEKB                                        
002562*                   END-EXEC.                                     
002563     MOVE -1                                                      
002564       TO DFHEIV11                                                
002565*    MOVE '82     CT  E F        (   #00002522' TO DFHEIV0        
002566     MOVE X'383220202020204354202045' &                           
002567          X'204620202020202020202820' &                           
002568          X'2020233030303032353232' TO DFHEIV0                    
002569     CALL 'kxdfhei1' USING DFHEIV0,                               
002570           DFHEIV99,                                              
002571           DFHEIV99,                                              
002572           DFHEIV99,                                              
002573           DFHEIV11,                                              
002574           DFHEIV99,                                              
002575           DFHEIV99,                                              
002576           DFHEIV99                                               
002577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002578                                                                  
002579                                                                  
002580* EXEC CICS RETURN END-EXEC.                                      
002581*    MOVE '.(                    ''   #00002527' TO DFHEIV0       
002582     MOVE X'2E2820202020202020202020' &                           
002583          X'202020202020202020202720' &                           
002584          X'2020233030303032353237' TO DFHEIV0                    
002585     CALL 'kxdfhei1' USING DFHEIV0,                               
002586           DFHEIV99,                                              
002587           DFHEIV99,                                              
002588           DFHEIV99,                                              
002589           DFHEIV99,                                              
002590           DFHEIV99,                                              
002591           DFHEIV99                                               
002592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002593                                                                  
002594                                                                  
002595* GOBACK.                                                         
002596     MOVE '9%                    "   ' TO DFHEIV0                 
002597     MOVE 'AVTLO24' TO DFHEIV1                                    
002598     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1                        
002599     GOBACK.                                                      
002600 B05-EX. EXIT.                                                    
002601*----------------------------------------------------------------*
002602 B10-PRIMA-VOLTA.                                                 
002603*----------------------------------------------------------------*
002604     PERFORM U20-DELETE-TS                                        
002605        THRU U20-EX.                                              
002606     PERFORM U22-DELETE-TS2                                       
002607        THRU U22-EX.                                              
002608     MOVE 'AVTLO24'              TO WCOM-NOMEPRGM                 
002609     MOVE EIBTRNID               TO WCOM-TRANSAZI                 
002610     MOVE ZEROES                 TO WCOM-PAGIRICH                 
002611                                    WCOM-PAGILIST                 
002612                                    WPAGRICH.                     
002613     MOVE 99999                  TO WCOM-PAGIULTI                 
002614     MOVE 'AVMLO24'              TO WNOMEMAP                      
002615     MOVE WCOM-CODILING          TO WCODLING                      
002616     IF  WCOM-MENUTRAN (WCOM-INDITRAN) NOT = WCOM-TRANSAZI        
002617         ADD  1                  TO WCOM-INDITRAN                 
002618         MOVE WCOM-TRANSAZI      TO WCOM-MENUTRAN (WCOM-INDITRAN) 
002619         MOVE ZEROES             TO WCOM-PAGITRAN (WCOM-INDITRAN).
002620     IF  WCOM-INDITRAN > 10                                       
002621         MOVE 'TRTR'             TO WCOM-CODABEND                 
002622         PERFORM Z00-ERRORE                                       
002623            THRU Z00-EX.                                          
002624 B10-EX. EXIT.                                                    
002625*----------------------------------------------------------------*
002626 C00-RICEVI-MAPPA.                                                
002627*----------------------------------------------------------------*
002628                                                                  
002629* EXEC CICS RECEIVE MAP    (WNOMEMAP)                             
002630*                      MAPSET ('AVMLO24')                         
002631*                      INTO   (AVILO24I)                          
002632*                      END-EXEC.                                  
002633     MOVE LENGTH OF                                               
002634      AVILO24I                                                    
002635       TO DFHEIV11                                                
002636     MOVE 'AVMLO24' TO DFHEIV1                                    
002637*    MOVE '8"T I  L              ''   #00002557' TO DFHEIV0       
002638     MOVE X'382254204920204C20202020' &                           
002639          X'202020202020202020202720' &                           
002640          X'2020233030303032353537' TO DFHEIV0                    
002641     CALL 'kxdfhei1' USING DFHEIV0,                               
002642           WNOMEMAP,                                              
002643           AVILO24I,                                              
002644           DFHEIV11,                                              
002645           DFHEIV1,                                               
002646           DFHEIV99,                                              
002647           DFHEIV99                                               
002648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002649                                                                  
002650     MOVE LOW-VALUE              TO LO24-MESSAGGO.                
002651     MOVE SPACES                 TO MESS-CODERROR.                
002652     IF LO24-MAPRPAGI IS NUMERIC AND                              
002653        LO24-MAPRPAGI > ZERO                                      
002654        MOVE LO24-MAPRPAGI       TO WPAGRICH                      
002655     ELSE                                                         
002656       MOVE WCOM-PAGIRICH        TO WPAGRICH.                     
002657     IF WPAGRICH NOT = WCOM-PAGIRICH                              
002658        PERFORM E20-PAGINA-PRONTA                                 
002659           THRU E20-EX                                            
002660     ELSE                                                         
002661        IF EIBAID = DFHPF13 OR                                    
002662           EIBAID = DFHPF14                                       
002663           PERFORM C10-CERCA-CLIENTE                              
002664              THRU C10-EX                                         
002665        ELSE                                                      
002666          INSPECT LO24-CODSOCIEI REPLACING ALL LOW-VALUE BY SPACES
002667          INSPECT LO24-CODCLIENI REPLACING ALL LOW-VALUE BY SPACES
002668          INSPECT LO24-RAGFATTUI REPLACING ALL LOW-VALUE BY SPACES
002669          INSPECT LO24-AAAACOMPI REPLACING ALL LOW-VALUE BY SPACES
002670          INSPECT LO24-MMMMCOMPI REPLACING ALL LOW-VALUE BY SPACES
002671          INSPECT LO24-STATUSXXI REPLACING ALL LOW-VALUE BY SPACES
002672          INSPECT LO24-FLAGSOSPI REPLACING ALL LOW-VALUE BY SPACES
002673          INSPECT LO24-CODSERVII REPLACING ALL LOW-VALUE BY SPACES
002674          INSPECT LO24-DESSERVII REPLACING ALL LOW-VALUE BY SPACES
002675          INSPECT LO24-TIPSERVII REPLACING ALL LOW-VALUE BY SPACES
002676          INSPECT LO24-CONTODCEI REPLACING ALL LOW-VALUE BY SPACES
002677          INSPECT LO24-AANUMFATI REPLACING ALL LOW-VALUE BY SPACES
002678          INSPECT LO24-CENCOSTAI REPLACING ALL LOW-VALUE BY SPACES
002679          INSPECT LO24-CENCOSTDI REPLACING ALL LOW-VALUE BY SPACES
002680          IF LO24-CODSOCIEI NOT = WCOM-CODSOCIE OR                
002681             LO24-CODCLIENI NOT = WCOM-CODCLIEN OR                
002682             LO24-RAGFATTUI NOT = WCOM-RAGFATTU OR                
002683             LO24-AAAACOMPI NOT = WCOM-DTCARORD(1:4) OR           
002684             LO24-MMMMCOMPI NOT = WCOM-DTCARORD(5:2) OR           
002685             LO24-FLAGSOSPI NOT = WCOM-SALDATOX OR                
002686             LO24-STATUSXXI NOT = WCOM-STATUSXX OR                
002687             LO24-CODSERVII NOT = WCOM-CODSERVI OR                
002688             LO24-DESSERVII NOT = WCOM-DESSERVI OR                
002689             LO24-TIPSERVII NOT = WCOM-TIPSERVI OR                
002690             LO24-CONTODCEI NOT = WCOM-CONTODCE OR                
002691             LO24-CENCOSTDI NOT = WCOM-CENCOSTD OR                
002692             LO24-CENCOSTAI NOT = WCOM-CENCOSTA OR                
002693             LO24-AANUMFATI NOT = WCOM-AANUMFAT                   
002694             PERFORM C20-GESTIONE-RICICLO                         
002695                THRU C20-EX                                       
002696          ELSE                                                    
002697             PERFORM C40-GESTIONE-RICEVI                          
002698                THRU C40-EX.                                      
002699 C00-EX. EXIT.                                                    
002700*----------------------------------------------------------------*
002701 C10-CERCA-CLIENTE.                                               
002702*----------------------------------------------------------------*
002703     IF LO24-RAGFATTUI NOT = WCOM-RAGFATTU AND                    
002704        LO24-RAGFATTUI > SPACES                                   
002705        MOVE LO24-RAGFATTUI      TO WCOM-RAGFATT2                 
002706        MOVE SPACES              TO WS-CODCLIEN                   
002707        PERFORM C15-RICERCA-FORNITORE                             
002708           THRU C15-EX                                            
002709     ELSE                                                         
002710        IF WCOM-RAGFATT2 > SPACES                                 
002711           MOVE LO24-CODCLIENI   TO WS-CODCLIEN                   
002712           PERFORM C15-RICERCA-FORNITORE                          
002713              THRU C15-EX.                                        
002714 C10-EX. EXIT.                                                    
002715*----------------------------------------------------------------*
002716 C15-RICERCA-FORNITORE.                                           
002717*----------------------------------------------------------------*
002718     PERFORM C17-DESCRIZIONE-MAPPA                                
002719        THRU C17-EX.                                              
002720     MOVE 'OPEN'                 TO WCOM-FILEFUNZ.                
002721     MOVE 'C15-'                 TO WCOM-CODABEND.                
002722     MOVE SPACES                 TO WCOM-FILECTRL.                
002723     STRING WS-CODCLIEN ' ' WS-RAGFATTU                           
002724        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
002725     IF EIBAID = DFHPF13                                          
002726        MOVE 'POINTPF13'         TO WCOM-FILENOME                 
002727        
      *EXEC SQL OPEN POINTPF13 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 1 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CODCLIEN
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-RAGFATTU
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
002728     ELSE                                                         
002729        MOVE 'POINTPF14'         TO WCOM-FILENOME                 
002730        
      *EXEC SQL OPEN POINTPF14 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 2 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CODCLIEN
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-RAGFATTU
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                              .                         
002731     IF EIBAID = DFHPF13                                          
002732        PERFORM L01-FETCH-POINTPF13                               
002733           THRU L01-EX                                            
002734     ELSE                                                         
002735        PERFORM L02-FETCH-POINTPF14                               
002736           THRU L02-EX.                                           
002737     MOVE SQLCODE                TO WS-SQLCODE2.                  
002738     MOVE 'CLOSE'                TO WCOM-FILEFUNZ.                
002739     MOVE 'C15-'                 TO WCOM-CODABEND.                
002740     MOVE SPACES                 TO WCOM-FILECTRL.                
002741     STRING WS-CODCLIEN ' ' WS-RAGFATTU                           
002742        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
002743     IF EIBAID = DFHPF13                                          
002744        MOVE 'POINTPF13'         TO WCOM-FILENOME                 
002745        
      *EXEC SQL CLOSE POINTPF13 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
002746     ELSE                                                         
002747        MOVE 'POINTPF14'         TO WCOM-FILENOME                 
002748        
      *EXEC SQL CLOSE POINTPF14 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                               .                        
002749     IF WS-SQLCODE2 = ZEROES                                      
002750        MOVE A901-CODCLIEN       TO LO24-CODCLIENO                
002751        MOVE A901-RAGFATTU       TO LO24-RAGFATTUO                
002752                                    WCOM-RAGFATTU                 
002753        PERFORM C20-GESTIONE-RICICLO                              
002754           THRU C20-EX.                                           
002755 C15-EX. EXIT.                                                    
002756*----------------------------------------------------------------*
002757 C17-DESCRIZIONE-MAPPA.                                           
002758*----------------------------------------------------------------*
002759     MOVE SPACES                 TO WS-RAGFATT3.                  
002760     MOVE 1                      TO WS-IND2                       
002761     MOVE WCOM-RAGFATT2          TO WS-RAGFATT2.                  
002762     INSPECT WS-RAGFATT2 REPLACING ALL LOW-VALUE BY SPACES.       
002763     PERFORM VARYING WS-IND1 FROM 1 BY 1                          
002764               UNTIL WS-IND1 > 24                                 
002765        IF WS-BYTE2(WS-IND1) NUMERIC   OR                         
002766          (WS-BYTE2(WS-IND1) NOT < 'A' AND                        
002767           WS-BYTE2(WS-IND1) NOT > 'Z' ) OR                       
002768           WS-BYTE2(WS-IND1) = SPACES  OR                         
002769           WS-BYTE2(WS-IND1) = '%'                                
002770           MOVE WS-BYTE2(WS-IND1) TO WS-BYTE3(WS-IND2)            
002771           ADD 1                 TO WS-IND2                       
002772        END-IF                                                    
002773     END-PERFORM.                                                 
002774     STRING '%' WS-RAGFATT3 DELIMITED BY SIZE                     
002775                               INTO WS-RAGFATTU.                  
002776     INSPECT WS-RAGFATTU REPLACING ALL SPACES BY '%'.             
002777 C17-EX. EXIT.                                                    
002778*----------------------------------------------------------------*
002779 C20-GESTIONE-RICICLO.                                            
002780*----------------------------------------------------------------*
002781     MOVE LOW-VALUE              TO WCOM-CODSOCIE                 
002782                                    WCOM-CODCLIEN                 
002783                                    WCOM-RAGFATTU                 
002784                                    WCOM-STATUSXX                 
002785                                    WCOM-SALDATOX                 
002786                                    WCOM-CODSERVI                 
002787                                    WCOM-DESSERVI                 
002788                                    WCOM-TIPSERVI                 
002789                                    WCOM-CONTODCE                 
002790                                    WCOM-CENCOSTD                 
002791                                    WCOM-CENCOSTA                 
002792                                    WCOM-AANUMFAT                 
002793                                    WCOM-DTCARORD                 
002794     PERFORM C21-CONTROLLA-RICHIESTA                              
002795        THRU C21-EX.                                              
002796     PERFORM U20-DELETE-TS                                        
002797        THRU U20-EX.                                              
002798     PERFORM U22-DELETE-TS2                                       
002799        THRU U22-EX.                                              
002800     MOVE 99999                  TO WCOM-PAGIULTI.                
002801     MOVE ZERO                   TO WCOM-PAGIRICH                 
002802                                    WCOM-PAGILIST                 
002803                                    WPAGRICH.                     
002804     PERFORM E99-PULISCI-MAPPA                                    
002805        THRU E99-EX                                               
002806     IF ERRORE                                                    
002807        GO TO C20-EX.                                             
002808     MOVE LO24-CODSOCIEI         TO WCOM-CODSOCIE.                
002809     MOVE LO24-CODCLIENI         TO WCOM-CODCLIEN.                
002810     MOVE LO24-RAGFATTUI         TO WCOM-RAGFATTU.                
002811     MOVE LO24-STATUSXXI         TO WCOM-STATUSXX.                
002812     MOVE LO24-FLAGSOSPI         TO WCOM-SALDATOX.                
002813     MOVE LO24-CODSERVII         TO WCOM-CODSERVI.                
002814     MOVE LO24-DESSERVII         TO WCOM-DESSERVI.                
002815     MOVE LO24-TIPSERVII         TO WCOM-TIPSERVI.                
002816     MOVE LO24-CONTODCEI         TO WCOM-CONTODCE.                
002817     MOVE LO24-CENCOSTDI         TO WCOM-CENCOSTD.                
002818     MOVE LO24-CENCOSTAI         TO WCOM-CENCOSTA.                
002819     MOVE LO24-AANUMFATI         TO WCOM-AANUMFAT.                
002820     MOVE LO24-AAAACOMPI         TO WCOM-DTCARORD(1:4)            
002821     MOVE LO24-MMMMCOMPI         TO WCOM-DTCARORD(5:2)            
002822     PERFORM E10-PREPARA-PAGINE                                   
002823        THRU E10-EX.                                              
002824     PERFORM E20-PAGINA-PRONTA                                    
002825        THRU E20-EX.                                              
002826 C20-EX. EXIT.                                                    
002827*----------------------------------------------------------------*
002828 C21-CONTROLLA-RICHIESTA.                                         
002829*----------------------------------------------------------------*
002830     INSPECT LO24-RAGFATTUI REPLACING ALL LOW-VALUE BY SPACES.    
002831     INSPECT LO24-CODCLIENI REPLACING ALL LOW-VALUE BY SPACES.    
002832     INSPECT LO24-CODSERVII REPLACING ALL LOW-VALUE BY SPACES.    
002833     INSPECT LO24-DESSERVII REPLACING ALL LOW-VALUE BY SPACES.    
002834     INSPECT LO24-AANUMFATI REPLACING ALL LOW-VALUE BY SPACES.    
002835     IF LO24-CODCLIENI NOT > SPACES AND                           
002836        LO24-RAGFATTUI NOT > SPACES AND                           
002837        LO24-CODSERVII NOT > SPACES AND                           
002838        LO24-DESSERVII NOT > SPACES AND                           
002839        LO24-AANUMFATI NOT > SPACES                               
002840        MOVE '*'                 TO WSWERROR                      
002841        MOVE '00010'             TO MESS-CODERROR                 
002842        MOVE DFHUNIMD            TO LO24-CODCLIENA                
002843                                    LO24-RAGFATTUA                
002844                                    LO24-CODSERVIA                
002845                                    LO24-DESSERVIA                
002846                                    LO24-AANUMFATA                
002847        MOVE DFHRED              TO LO24-CODCLIENC                
002848                                    LO24-RAGFATTUC                
002849                                    LO24-CODSERVIC                
002850                                    LO24-DESSERVIC                
002851                                    LO24-AANUMFATC                
002852        MOVE -1                  TO LO24-CODCLIENL                
002853        GO TO C21-EX.                                             
002854*    CONTROLLO FATTURA                                            
002855     IF LO24-AANUMFATI > SPACES                                   
002856        MOVE LO24-AANUMFATI      TO L652-AANUMFAT                 
002857        PERFORM L20-SELECT-ORDILOGI-FATT                          
002858           THRU L20-EX                                            
002859        IF SQLCODE = +100                                         
002860           MOVE '*'              TO WSWERROR                      
002861           MOVE '00172'          TO MESS-CODERROR                 
002862           MOVE DFHUNIMD         TO LO24-AANUMFATA                
002863           MOVE DFHRED           TO LO24-AANUMFATC                
002864           MOVE -1               TO LO24-AANUMFATL                
002865           GO TO C21-EX                                           
002866        ELSE                                                      
002867           MOVE 'T'              TO LO24-STATUSXXI                
002868           MOVE 'T'              TO LO24-FLAGSOSPI                
002869           MOVE L652-CODSOCIE    TO LO24-CODSOCIEI                
002870           MOVE SPACES           TO LO24-CODCLIENI                
002871                                    LO24-RAGFATTUI                
002872                                    LO24-AAAACOMPI                
002873                                    LO24-MMMMCOMPI                
002874                                    LO24-CODSERVII                
002875                                    LO24-DESSERVII                
002876                                    LO24-TIPSERVII                
002877                                    LO24-DESTIPSEI                
002878                                    LO24-CONTODCEI                
002879                                    LO24-CENCOSTDI                
002880                                    LO24-CENCOSTAI                
002881           MOVE SPACES           TO WCOM-RAGFATT2.                
002882*    CONTROLLO CLIENTE E RAGIONE SOCIALE                          
002883     IF LO24-CODCLIENI > SPACES                                   
002884        MOVE SPACES              TO LO24-RAGFATTUI                
002885        MOVE +5                  TO WLENGTH                       
002886        CALL WWTWSNU USING WLENGTH LO24-CODCLIENI                 
002887        MOVE LO24-CODCLIENI      TO A901-CODCLIEN                 
002888        PERFORM L15-SELECT-CLIENTI                                
002889           THRU L15-EX                                            
002890        MOVE A901-CODSOCIE       TO LO24-CODSOCIEO                
002891        MOVE A901-RAGFATTU       TO LO24-RAGFATTUO                
002892     ELSE                                                         
002893        IF LO24-RAGFATTUI > SPACES                                
002894           MOVE LO24-RAGFATTUI   TO WCOM-RAGFATT2                 
002895           PERFORM L17-SELECT-RAGFATTU                            
002896              THRU L17-EX                                         
002897           IF SQLCODE = +100                                      
002898              MOVE '*'           TO WSWERROR                      
002899              MOVE '00053'       TO MESS-CODERROR                 
002900              MOVE DFHUNIMD      TO LO24-RAGFATTUA                
002901              MOVE DFHRED        TO LO24-RAGFATTUC                
002902              MOVE -1            TO LO24-RAGFATTUL                
002903              GO TO C21-EX                                        
002904           ELSE                                                   
002905              MOVE 'T'              TO LO24-STATUSXXI             
002906              MOVE A901-CODSOCIE    TO LO24-CODSOCIEI             
002907              MOVE A901-CODCLIEN    TO LO24-CODCLIENI             
002908              MOVE A901-RAGFATTU    TO LO24-RAGFATTUI.            
002909*    CONTROLLO SOCIETA'                                           
002910     INSPECT LO24-CODSOCIEI REPLACING ALL LOW-VALUE BY SPACES.    
002911     IF LO24-CODSOCIEI NOT > SPACES                               
002912        MOVE '*'                 TO WSWERROR                      
002913        MOVE '00036'             TO MESS-CODERROR                 
002914        MOVE DFHUNIMD            TO LO24-CODSOCIEA                
002915        MOVE DFHRED              TO LO24-CODSOCIEC                
002916        MOVE -1                  TO LO24-CODSOCIEL                
002917        GO TO C21-EX                                              
002918     ELSE                                                         
002919        MOVE LO24-CODSOCIEI      TO A531-CODSOCIE                 
002920        PERFORM L10-SELECT-SOCIETA                                
002921           THRU L10-EX                                            
002922        IF SQLCODE = +100                                         
002923           MOVE '*'              TO WSWERROR                      
002924           MOVE '00036'          TO MESS-CODERROR                 
002925           MOVE DFHUNIMD         TO LO24-CODSOCIEA                
002926           MOVE DFHRED           TO LO24-CODSOCIEC                
002927           MOVE -1               TO LO24-CODSOCIEL                
002928           GO TO C21-EX                                           
002929        ELSE                                                      
002930           MOVE A531-NOMSOCIE    TO LO24-NOMSOCIEO.               
002931     IF LO24-AANUMFATI > SPACES                                   
002932        GO TO C21-EX.                                             
002933*    CONTROLLO DATA COMPETENZA                                    
002934     INSPECT LO24-AAAACOMPI REPLACING ALL LOW-VALUE BY SPACES.    
002935     INSPECT LO24-MMMMCOMPI REPLACING ALL LOW-VALUE BY SPACES.    
002936     IF LO24-AAAACOMPI NOT > SPACES                               
002937        MOVE WCOM-DTCREAZI       TO LO24-AAAACOMPO.               
002938     IF LO24-AAAACOMPI NOT > SPACES                               
002939        MOVE '*'                 TO WSWERROR                      
002940        MOVE '00006'             TO MESS-CODERROR                 
002941        MOVE DFHUNIMD            TO LO24-AAAACOMPA                
002942        MOVE DFHRED              TO LO24-AAAACOMPC                
002943        MOVE -1                  TO LO24-AAAACOMPL                
002944        GO TO C21-EX                                              
002945     ELSE                                                         
002946        MOVE LO24-AAAACOMPI(1:4) TO DTGG-DTRICHIE(1:4)            
002947        MOVE '01'                TO DTGG-DTRICHIE(5:2)            
002948        IF LO24-MMMMCOMPI > ' '                                   
002949           MOVE LO24-MMMMCOMPI   TO DTGG-DTRICHIE(5:2)            
002950        END-IF                                                    
002951        MOVE '01'                TO DTGG-DTRICHIE(7:2)            
002952        PERFORM SRDTGG                                            
002953           THRU SRDTGG-EX                                         
002954        IF DTGG-RETUCODE NOT = '****'                             
002955           MOVE '*'              TO WSWERROR                      
002956           MOVE '00006'          TO MESS-CODERROR                 
002957           MOVE DFHUNIMD         TO LO24-AAAACOMPA                
002958           MOVE DFHRED           TO LO24-AAAACOMPC                
002959           IF LO24-MMMMCOMPI > ' '                                
002960              MOVE DFHRED        TO LO24-MMMMCOMPC                
002961           END-IF                                                 
002962           MOVE -1               TO LO24-AAAACOMPL                
002963           GO TO C21-EX.                                          
002964*    CONTROLLO STATUS                                             
002965     INSPECT LO24-STATUSXXI REPLACING ALL LOW-VALUE BY SPACES.    
002966     IF LO24-STATUSXXI NOT > SPACES                               
002967        MOVE 'N'                 TO LO24-STATUSXXI                
002968     ELSE                                                         
002969        IF LO24-STATUSXXI NOT = 'N' AND 'F' AND 'T'               
002970           MOVE '*'              TO WSWERROR                      
002971           MOVE '00016'          TO MESS-CODERROR                 
002972           MOVE DFHRED           TO LO24-STATUSXXC                
002973           MOVE DFHUNIMD         TO LO24-STATUSXXA                
002974           MOVE -1               TO LO24-STATUSXXL                
002975           GO TO C21-EX.                                          
002976*    CONTROLLO SOSPESO                                            
002977     INSPECT LO24-FLAGSOSPI REPLACING ALL LOW-VALUE BY SPACES.    
002978     IF LO24-FLAGSOSPI NOT > SPACES                               
002979        MOVE 'T'                 TO LO24-FLAGSOSPI                
002980     ELSE                                                         
002981        IF LO24-FLAGSOSPI NOT = 'S' AND 'N' AND 'T'               
002982           MOVE '*'              TO WSWERROR                      
002983           MOVE '00920'          TO MESS-CODERROR                 
002984           MOVE DFHRED           TO LO24-FLAGSOSPC                
002985           MOVE DFHUNIMD         TO LO24-FLAGSOSPA                
002986           MOVE -1               TO LO24-FLAGSOSPL                
002987           GO TO C21-EX.                                          
002988*    CONTROLLO SERVIZIO E NOME SERVIZIO                           
002989     INSPECT LO24-CODSERVII REPLACING ALL LOW-VALUE BY SPACES.    
002990     INSPECT LO24-DESSERVII REPLACING ALL LOW-VALUE BY SPACES.    
002991     IF LO24-CODSERVII(1:1) > SPACES  AND                         
002992        LO24-CODSERVII(1:1) NOT = '%' AND                         
002993        LO24-CODSERVII(2:1) > SPACES  AND                         
002994        LO24-CODSERVII(2:1) NOT = '%' AND                         
002995        LO24-CODSERVII(3:1) > SPACES  AND                         
002996        LO24-CODSERVII(3:1) NOT = '%' AND                         
002997        LO24-CODSERVII(4:1) > SPACES  AND                         
002998        LO24-CODSERVII(4:1) NOT = '%' AND                         
002999        LO24-CODSERVII(5:1) > SPACES  AND                         
003000        LO24-CODSERVII(5:1) NOT = '%' AND                         
003001        LO24-CODSERVII(6:1) > SPACES  AND                         
003002        LO24-CODSERVII(6:1) NOT = '%'                             
003003        MOVE SPACES              TO LO24-DESSERVII                
003004        MOVE LO24-CODSERVII      TO L651-CODSERVI                 
003005        PERFORM L18-SELECT-SERVIZI                                
003006           THRU L18-EX                                            
003007        MOVE L651-DESSERVI       TO LO24-DESSERVIO.               
003008*    CONTROLLO TIPO SERVIZIO                                      
003009     INSPECT LO24-TIPSERVII REPLACING ALL LOW-VALUE BY SPACES.    
003010     MOVE SPACES                 TO LO24-DESTIPSEI.               
003011     IF WCOM-MENUTRAN(1) NOT = 'LOGI'                             
003012        MOVE 'L'                 TO LO24-TIPSERVII                
003013        MOVE MESS-CODERROR TO WS-CODERROR                         
003014        MOVE '02733'             TO MESS-CODERROR                 
003015        PERFORM U10-DECODIFICA-MESSAGGI                           
003016           THRU U10-EX                                            
003017        MOVE MESS-MESSAGGI       TO LO24-DESTIPSEO                
003018        MOVE WS-CODERROR         TO MESS-CODERROR                 
003019        MOVE SPACES              TO MESS-MSGERROR                 
003020        MOVE SPACES              TO WS-CODERROR                   
003021     ELSE                                                         
003022        IF LO24-TIPSERVII > SPACES                                
003023           IF LO24-TIPSERVII NOT = 'M' AND 'T'                    
003024              MOVE '*'           TO WSWERROR                      
003025              MOVE '01678'       TO MESS-CODERROR                 
003026              MOVE DFHRED        TO LO24-TIPSERVIC                
003027              MOVE DFHUNIMD      TO LO24-TIPSERVIA                
003028              MOVE -1            TO LO24-TIPSERVIL                
003029              GO TO C21-EX                                        
003030           ELSE                                                   
003031              IF LO24-TIPSERVII = 'T'                             
003032                 MOVE MESS-CODERROR TO WS-CODERROR                
003033                 MOVE '02476'       TO MESS-CODERROR              
003034                 PERFORM U10-DECODIFICA-MESSAGGI                  
003035                    THRU U10-EX                                   
003036                 MOVE MESS-MESSAGGI TO LO24-DESTIPSEO             
003037                 MOVE WS-CODERROR   TO MESS-CODERROR              
003038                 MOVE SPACES        TO MESS-MSGERROR              
003039                 MOVE SPACES        TO WS-CODERROR                
003040              ELSE                                                
003041                 IF LO24-TIPSERVII = 'M'                          
003042                    MOVE MESS-CODERROR TO WS-CODERROR             
003043                    MOVE '02477'       TO MESS-CODERROR           
003044                    PERFORM U10-DECODIFICA-MESSAGGI               
003045                       THRU U10-EX                                
003046                    MOVE MESS-MESSAGGI TO LO24-DESTIPSEO          
003047                    MOVE WS-CODERROR   TO MESS-CODERROR           
003048                    MOVE SPACES        TO MESS-MSGERROR           
003049                    MOVE SPACES        TO WS-CODERROR.            
003050     INSPECT LO24-CONTODCEI REPLACING ALL LOW-VALUE BY SPACES.    
003051 C21-EX. EXIT.                                                    
003052*----------------------------------------------------------------*
003053 C40-GESTIONE-RICEVI.                                             
003054*----------------------------------------------------------------*
003055     MOVE WCOM-PAGIRICH          TO WNUMITEM.                     
003056     PERFORM R00-READQ-WPAGCTRL                                   
003057        THRU R00-EX.                                              
003058     PERFORM F00-CONTROLLI                                        
003059        THRU F00-EX.                                              
003060 C40-EX. EXIT.                                                    
003061*----------------------------------------------------------------*
003062 D00-GESTIONE-PF.                                                 
003063*----------------------------------------------------------------*
003064     IF EIBAID NOT = DFHPF1 AND                                   
003065        EIBAID NOT = DFHPF2 AND                                   
003066        EIBAID NOT = DFHPF7 AND                                   
003067        EIBAID NOT = DFHPF8                                       
003068        PERFORM D30-FUNZIONI-ESTERNE                              
003069           THRU D30-EX                                            
003070     ELSE                                                         
003071        IF WCOM-PAGIRICH > ZEROES                                 
003072           PERFORM D10-IMPOSTA-PAGINA                             
003073              THRU D10-EX                                         
003074           PERFORM E20-PAGINA-PRONTA                              
003075              THRU E20-EX                                         
003076        ELSE                                                      
003077           PERFORM U02-NORESP                                     
003078              THRU U02-EX.                                        
003079 D00-EX. EXIT.                                                    
003080*----------------------------------------------------------------*
003081 D10-IMPOSTA-PAGINA.                                              
003082*----------------------------------------------------------------*
003083                                                                  
003084* EXEC CICS RECEIVE MAP    (WNOMEMAP)                             
003085*                      MAPSET ('AVMLO24')                         
003086*                      INTO   (AVILO24I)                          
003087*                      END-EXEC.                                  
003088     MOVE LENGTH OF                                               
003089      AVILO24I                                                    
003090       TO DFHEIV11                                                
003091     MOVE 'AVMLO24' TO DFHEIV1                                    
003092*    MOVE '8"T I  L              ''   #00002994' TO DFHEIV0       
003093     MOVE X'382254204920204C20202020' &                           
003094          X'202020202020202020202720' &                           
003095          X'2020233030303032393934' TO DFHEIV0                    
003096     CALL 'kxdfhei1' USING DFHEIV0,                               
003097           WNOMEMAP,                                              
003098           AVILO24I,                                              
003099           DFHEIV11,                                              
003100           DFHEIV1,                                               
003101           DFHEIV99,                                              
003102           DFHEIV99                                               
003103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003104                                                                  
003105     EVALUATE EIBAID                                              
003106         WHEN DFHPF1                                              
003107              COMPUTE WPAGRICH = WCOM-PAGIRICH + 1                
003108         WHEN DFHPF2                                              
003109              COMPUTE WPAGRICH = WCOM-PAGIRICH - 1                
003110         WHEN DFHPF7                                              
003111              MOVE 1             TO WPAGRICH                      
003112         WHEN DFHPF8                                              
003113              MOVE WCOM-PAGIULTI TO WPAGRICH                      
003114     END-EVALUATE.                                                
003115 D10-EX. EXIT.                                                    
003116*----------------------------------------------------------------*
003117 D30-FUNZIONI-ESTERNE.                                            
003118*----------------------------------------------------------------*
003119     MOVE  '*'                   TO WCOM-DELETETS.                
003120                                                                  
003121* EXEC CICS LINK PROGRAM  ('WWTTIM15')                            
003122*                   COMMAREA (WCOM-AREAXXXX)                      
003123*                   LENGTH   (WCOM-LUNGHEZZ)                      
003124*                   END-EXEC.                                     
003125     MOVE 'WWTTIM15' TO DFHEIV1                                   
003126*    MOVE '."C                   (   #00003013' TO DFHEIV0        
003127     MOVE X'2E2243202020202020202020' &                           
003128          X'202020202020202020202820' &                           
003129          X'2020233030303033303133' TO DFHEIV0                    
003130     CALL 'kxdfhei1' USING DFHEIV0,                               
003131           DFHEIV1,                                               
003132           WCOM-AREAXXXX,                                         
003133           WCOM-LUNGHEZZ,                                         
003134           DFHEIV99,                                              
003135           DFHEIV99,                                              
003136           DFHEIV99,                                              
003137           DFHEIV99                                               
003138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003139                                                                  
003140     IF  WCOM-RETURNXX = '*'                                      
003141                                                                  
003142* EXEC CICS RETURN END-EXEC                                       
003143*    MOVE '.(                    ''   #00003018' TO DFHEIV0       
003144     MOVE X'2E2820202020202020202020' &                           
003145          X'202020202020202020202720' &                           
003146          X'2020233030303033303138' TO DFHEIV0                    
003147     CALL 'kxdfhei1' USING DFHEIV0,                               
003148           DFHEIV99,                                              
003149           DFHEIV99,                                              
003150           DFHEIV99,                                              
003151           DFHEIV99,                                              
003152           DFHEIV99,                                              
003153           DFHEIV99                                               
003154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
003155     ELSE                                                         
003156         PERFORM U00-RETURN-TRAN                                  
003157            THRU U00-EX.                                          
003158 D30-EX. EXIT.                                                    
003159*----------------------------------------------------------------*
003160 E10-PREPARA-PAGINE.                                              
003161*----------------------------------------------------------------*
003162     INITIALIZE                     WPAGREF2                      
003163     PERFORM O00-OPEN-POINTER                                     
003164        THRU O00-EX.                                              
003165     PERFORM L00-FETCH-POINTER                                    
003166        THRU L00-EX.                                              
003167     PERFORM E13-PREPARA-TS                                       
003168        THRU E13-EX                                               
003169             UNTIL WS-SQLCODE = +100.                             
003170     PERFORM O10-CLOSE-POINTER                                    
003171        THRU O10-EX.                                              
003172     IF WCOM-PAGILIST > ZEROES                                    
003173        PERFORM R22-WRITEQ-WPA2                                   
003174           THRU R22-EX                                            
003175        MOVE WCOM-PAGILIST       TO WCOM-PAGIULTI                 
003176        IF WCOM-PAGITRAN (WCOM-INDITRAN) > ZEROES                 
003177           MOVE WCOM-PAGITRAN (WCOM-INDITRAN)                     
003178                                 TO WPAGRICH                      
003179           MOVE ZEROES           TO WCOM-PAGITRAN (WCOM-INDITRAN) 
003180        ELSE                                                      
003181           MOVE 1                TO WPAGRICH                      
003182     ELSE                                                         
003183        PERFORM E99-PULISCI-MAPPA                                 
003184           THRU E99-EX                                            
003185        IF MESS-CODERROR NOT > SPACES                             
003186           MOVE '00002'          TO MESS-CODERROR.                
003187 E10-EX. EXIT.                                                    
003188*----------------------------------------------------------------*
003189 E13-PREPARA-TS.                                                  
003190*----------------------------------------------------------------*
003191     MOVE SPACES                 TO WPAGREFE.                     
003192     INITIALIZE                     WPAGREFE.                     
003193     MOVE L652-CODCLIEN          TO WPAG-OCODCLIE                 
003194                                    A901-CODCLIEN.                
003195     PERFORM L15-SELECT-CLIENTI                                   
003196        THRU L15-EX.                                              
003197     MOVE A901-RAGFATTU          TO WPAG-ORAGFATT.                
003198     PERFORM E14-RIGA-TS                                          
003199        THRU E14-EX                                               
003200             VARYING WINDRIGA FROM 1 BY 1                         
003201               UNTIL WINDRIGA > WNUMRIGA                          
003202                  OR WPAG-OCODCLIE NOT = L652-CODCLIEN            
003203                  OR WS-SQLCODE = +100.                           
003204     PERFORM R20-WRITEQ-WPAG                                      
003205        THRU R20-EX.                                              
003206 E13-EX. EXIT.                                                    
003207*----------------------------------------------------------------*
003208 E14-RIGA-TS.                                                     
003209*----------------------------------------------------------------*
003210     MOVE L652-AAMMCOMP          TO WPAG-RAAMMCOM(WINDRIGA).      
003211     MOVE L652-TIPSERVI          TO WPAG-RTIPSERV(WINDRIGA).      
003212     MOVE L653-CODSERVI          TO WPAG-RCODSERV(WINDRIGA).      
003213     MOVE L651-DESSERVI          TO WPAG-RDESSERV(WINDRIGA).      
003214     MOVE L652-CODDIVIS          TO WPAG-RCODDIVI(WINDRIGA).      
003215     MOVE L653-IMPORDIN          TO WPAG-RIMPORDI(WINDRIGA).      
003216     MOVE L653-QTAORDIN          TO WPAG-RQTAORDI(WINDRIGA).      
003217     PERFORM VARYING WS-IND2 FROM 1 BY 1                          
003218       UNTIL WS-IND2                    > 100                     
003219          OR WPA2-CODCLIEN(WS-IND2)     = L652-CODCLIEN           
003220          OR WPA2-CODCLIEN(WS-IND2) NOT > ' '                     
003221     END-PERFORM                                                  
003222     IF WS-IND2 NOT > 100                                         
003223        MOVE L652-CODCLIEN       TO WPA2-CODCLIEN(WS-IND2)        
003224        ADD L653-QTAORDIN        TO WPA2-TOTQUANT(WS-IND2)        
003225        ADD L653-IMPORDIN        TO WPA2-TOTIMPOR(WS-IND2).       
003226     PERFORM L00-FETCH-POINTER                                    
003227        THRU L00-EX.                                              
003228 E14-EX. EXIT.                                                    
003229*----------------------------------------------------------------*
003230 E20-PAGINA-PRONTA.                                               
003231*----------------------------------------------------------------*
003232     IF WCOM-PAGILIST = ZERO                                      
003233        GO TO E20-EX.                                             
003234     IF  WPAGRICH  LESS  1                                        
003235         MOVE 1                  TO WPAGRICH.                     
003236     IF  WPAGRICH  > WCOM-PAGIULTI                                
003237         MOVE WCOM-PAGIULTI      TO WPAGRICH.                     
003238     MOVE WPAGRICH               TO WCOM-PAGIRICH                 
003239     MOVE WPAGRICH               TO WNUMITEM                      
003240     PERFORM R00-READQ-WPAGCTRL                                   
003241        THRU R00-EX.                                              
003242     PERFORM R10-READQ-WPAGCTR2                                   
003243        THRU R10-EX.                                              
003244     PERFORM E99-PULISCI-MAPPA                                    
003245        THRU E99-EX.                                              
003246     MOVE WPAG-OCODCLIE           TO LO24-OCODCLIEI               
003247     MOVE WPAG-ORAGFATT           TO LO24-ORAGFATTI               
003248     PERFORM E21-SPOSTA-IN-MAPPA                                  
003249        THRU E21-EX                                               
003250             VARYING WINDRIGA FROM 1 BY 1                         
003251               UNTIL WINDRIGA > WNUMRIGA                          
003252                  OR WPAG-RAAMMCOM (WINDRIGA) NOT > SPACES.       
003253     PERFORM VARYING WS-IND2 FROM 1 BY 1                          
003254       UNTIL WS-IND2                    > 100                     
003255          OR WPA2-CODCLIEN(WS-IND2) NOT > ' '                     
003256          OR WPA2-CODCLIEN(WS-IND2)     = WPAG-OCODCLIE           
003257     END-PERFORM.                                                 
003258     IF WPA2-CODCLIEN(WS-IND2) = WPAG-OCODCLIE                    
003259        MOVE WPA2-TOTQUANT(WS-IND2)  TO LO24-TOTQUANTO            
003260        MOVE WPA2-TOTIMPOR(WS-IND2)  TO LO24-TOTIMPORO.           
003261 E20-EX. EXIT.                                                    
003262*----------------------------------------------------------------*
003263 E21-SPOSTA-IN-MAPPA.                                             
003264*----------------------------------------------------------------*
003265     MOVE WPAG-RAAMMCOM(WINDRIGA) TO LO24-RAAMMCOMI(WINDRIGA).    
003266     MOVE WPAG-RTIPSERV(WINDRIGA) TO LO24-RTIPSERVO(WINDRIGA).    
003267     MOVE WPAG-RCODSERV(WINDRIGA) TO LO24-RCODSERVO(WINDRIGA).    
003268     MOVE WPAG-RDESSERV(WINDRIGA) TO LO24-RDESSERVO(WINDRIGA).    
003269     MOVE WPAG-RCODDIVI(WINDRIGA) TO LO24-RCODDIVIO(WINDRIGA).    
003270     MOVE WPAG-RIMPORDI(WINDRIGA) TO LO24-RIMPORDIO(WINDRIGA).    
003271     MOVE WPAG-RQTAORDI(WINDRIGA) TO LO24-RQTAORDIO(WINDRIGA).    
003272 E21-EX. EXIT.                                                    
003273*----------------------------------------------------------------*
003274 E99-PULISCI-MAPPA.                                               
003275*----------------------------------------------------------------*
003276     MOVE LOW-VALUE              TO LO24-OCODCLIEI                
003277                                    LO24-ORAGFATTI                
003278                                    LO24-TOTQUANTI                
003279                                    LO24-TOTIMPORI                
003280     PERFORM VARYING WINDRIGA FROM 1 BY 1                         
003281       UNTIL WINDRIGA > WNUMRIGA                                  
003282             MOVE LOW-VALUE      TO LO24-RIGAO(WINDRIGA)          
003283     END-PERFORM.                                                 
003284 E99-EX. EXIT.                                                    
003285*----------------------------------------------------------------*
003286 E30-INVIA-MAPPA.                                                 
003287*----------------------------------------------------------------*
003288     IF WCOM-PAGIULTI NOT = 99999                                 
003289        MOVE WCOM-PAGIULTI       TO LO24-MAPPPAGO                 
003290     ELSE                                                         
003291        MOVE ALL '*'             TO LO24-MAPPPAGI.                
003292     MOVE WCOM-PAGIRICH          TO LO24-MAPRPAGO.                
003293     IF MESS-CODERROR NOT > SPACES                                
003294        MOVE '00003'             TO MESS-CODERROR.                
003295     PERFORM U10-DECODIFICA-MESSAGGI                              
003296        THRU U10-EX.                                              
003297     IF NOT ERRORE                                                
003298        IF WCOM-PAGILIST NOT > ZEROS                              
003299           MOVE -1               TO LO24-CODSOCIEL                
003300        ELSE                                                      
003301           MOVE -1               TO LO24-OPERAZIOL(1).            
003302     PERFORM P00-ATTRIBUTI-RIGA                                   
003303        THRU P00-EX                                               
003304             VARYING WINDRIGA FROM 1 BY 1                         
003305               UNTIL WINDRIGA > WNUMRIGA.                         
003306                                                                  
003307* EXEC CICS SEND MAPSET ('AVMLO24')                               
003308*                   MAP    (WNOMEMAP)                             
003309*                   FROM   (AVILO24O)                             
003310*                   ERASE                                         
003311*                   CURSOR                                        
003312*                   END-EXEC.                                     
003313     MOVE LENGTH OF                                               
003314      AVILO24O                                                    
003315       TO DFHEIV12                                                
003316     MOVE -1                                                      
003317       TO DFHEIV11                                                
003318     MOVE 'AVMLO24' TO DFHEIV1                                    
003319*    MOVE '8$     CT  E      L F ,   #00003170' TO DFHEIV0        
003320     MOVE X'382420202020204354202045' &                           
003321          X'2020202020204C2046202C20' &                           
003322          X'2020233030303033313730' TO DFHEIV0                    
003323     CALL 'kxdfhei1' USING DFHEIV0,                               
003324           WNOMEMAP,                                              
003325           AVILO24O,                                              
003326           DFHEIV12,                                              
003327           DFHEIV1,                                               
003328           DFHEIV99,                                              
003329           DFHEIV99,                                              
003330           DFHEIV99,                                              
003331           DFHEIV11,                                              
003332           DFHEIV99,                                              
003333           DFHEIV99,                                              
003334           DFHEIV99                                               
003335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003336                                                                  
003337 E30-EX. EXIT.                                                    
003338*----------------------------------------------------------------*
003339 F00-CONTROLLI.                                                   
003340*----------------------------------------------------------------*
003341     MOVE SPACES                 TO WS-OPERAZIO.                  
003342     PERFORM F10-CTRL-OPERAZIONE                                  
003343        THRU F10-EX                                               
003344             VARYING WINDRIGA FROM 1 BY 1                         
003345               UNTIL WINDRIGA > WNUMRIGA                          
003346                  OR ERRORE.                                      
003347     IF ERRORE OR WS-OPERAZIO NOT > SPACES                        
003348        GO TO F00-EX.                                             
003349     PERFORM F30-CTRL-SELEZIONE                                   
003350        THRU F30-EX                                               
003351             VARYING WINDRIGA FROM 1 BY 1                         
003352               UNTIL WINDRIGA > WNUMRIGA                          
003353                  OR ERRORE.                                      
003354 F00-EX. EXIT.                                                    
003355*----------------------------------------------------------------*
003356 F10-CTRL-OPERAZIONE.                                             
003357*----------------------------------------------------------------*
003358     IF LO24-OPERAZIOI(WINDRIGA) NOT > SPACES                     
003359        GO TO F10-EX.                                             
003360     IF LO24-OPERAZIOI(WINDRIGA) NOT = '*'                        
003361        MOVE '*'                 TO WSWERROR                      
003362        MOVE '00004'             TO MESS-CODERROR                 
003363        MOVE DFHUNIMD            TO LO24-OPERAZIOA (WINDRIGA)     
003364        MOVE DFHRED              TO LO24-OPERAZIOC (WINDRIGA)     
003365        MOVE -1                  TO LO24-OPERAZIOL (WINDRIGA)     
003366        GO TO F10-EX                                              
003367     ELSE                                                         
003368        IF WS-OPERAZIO NOT > SPACES                               
003369           MOVE LO24-OPERAZIOI (WINDRIGA) TO WS-OPERAZIO          
003370        ELSE                                                      
003371           IF WS-OPERAZIO NOT = LO24-OPERAZIOI(WINDRIGA)          
003372              MOVE '*'           TO WSWERROR                      
003373              MOVE '00037'       TO MESS-CODERROR                 
003374              MOVE DFHUNIMD      TO LO24-OPERAZIOA (WINDRIGA)     
003375              MOVE DFHRED        TO LO24-OPERAZIOC (WINDRIGA)     
003376              MOVE -1            TO LO24-OPERAZIOL (WINDRIGA)     
003377              GO TO F10-EX                                        
003378           ELSE                                                   
003379              IF LO24-OPERAZIOI(WINDRIGA) = '*'                   
003380                 MOVE '*'        TO WSWERROR                      
003381                 MOVE '00037'    TO MESS-CODERROR                 
003382                 MOVE DFHUNIMD   TO LO24-OPERAZIOA (WINDRIGA)     
003383                 MOVE DFHRED     TO LO24-OPERAZIOC (WINDRIGA)     
003384                 MOVE -1         TO LO24-OPERAZIOL (WINDRIGA)     
003385                 GO TO F10-EX.                                    
003386 F10-EX. EXIT.                                                    
003387*----------------------------------------------------------------*
003388 F30-CTRL-SELEZIONE.                                              
003389*----------------------------------------------------------------*
003390     IF LO24-OPERAZIOI(WINDRIGA) NOT > SPACES                     
003391        GO TO F30-EX.                                             
003392     IF LO24-OPERAZIOI(WINDRIGA) = '*'                            
003393        PERFORM F40-LANCIA-DETTAGLIO                              
003394           THRU F40-EX.                                           
003395 F30-EX. EXIT.                                                    
003396*----------------------------------------------------------------*
003397 F40-LANCIA-DETTAGLIO.                                            
003398*----------------------------------------------------------------*
003399     MOVE WCOM-PAGIRICH          TO WCOM-PAGITRAN(WCOM-INDITRAN). 
003400     PERFORM SCRIVO-RICICLO                                       
003401        THRU SCRIVO-RICICLO-EX.                                   
003402     MOVE WPAG-OCODCLIE              TO WCOM-CODCLIEN             
003403     MOVE WPAG-RAAMMCOM(WINDRIGA)    TO WCOM-DTCARORD             
003404     MOVE WPAG-RCODSERV(WINDRIGA)    TO WCOM-CODSERVI             
003405     MOVE 'LO22'                     TO WTRANSID                  
003406     PERFORM U05-START-TRANSID                                    
003407        THRU U05-EX.                                              
003408 F40-EX. EXIT.                                                    
003409*---------------------------------------------------------------* 
003410 L00-FETCH-POINTER.                                               
003411*---------------------------------------------------------------* 
003412     MOVE 'L00-'                 TO WCOM-CODABEND.                
003413     MOVE 'FETCH'                TO WCOM-FILEFUNZ.                
003414     MOVE 'POINTER1'             TO WCOM-FILENOME                 
003416     
      *EXEC SQL 
      *FETCH POINTER1                                         
003417*            INTO :L652-CODCLIEN, :L652-AAMMCOMP                   
003418*                ,:L652-TIPSERVI, :L653-CODSERVI                   
003419*                ,:L652-CODDIVIS, :L651-DESSERVI                   
003420*                ,:L653-QTAORDIN                                   
003421*                ,:L653-IMPORDIN                                   
003422*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 3 TO SQL-STMT-ID 
           MOVE 8 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODCLIEN
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AAMMCOMP
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-TIPSERVI
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CODSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODDIVIS
            BY VALUE 0
                     0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-DESSERVI
            BY VALUE 0
                     0

           MOVE 521 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-QTAORDIN
            BY VALUE 0
                     0

           MOVE 525 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-IMPORDIN
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003423     MOVE SQLCODE                TO WS-SQLCODE.                   
003424 L00-EX. EXIT.                                                    
003425*----------------------------------------------------------------*
003426 L01-FETCH-POINTPF13.                                             
003427*----------------------------------------------------------------*
003428     MOVE 'L01-'                 TO WCOM-CODABEND.                
003429     MOVE 'FETCH'                TO WCOM-FILEFUNZ.                
003430     MOVE 'POINTPF13'            TO WCOM-FILENOME.                
003431     MOVE SPACES                 TO WCOM-FILECTRL.                
003432     STRING WS-CODCLIEN ' ' WS-RAGFATTU                           
003433        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
003435     
      *EXEC SQL 
      *FETCH POINTPF13                                         
003436*           INTO :A901-CODCLIEN, :A901-RAGFATTU                    
003437*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 4 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODCLIEN
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-RAGFATTU
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003438     MOVE SQLCODE                TO WS-SQLCODE2.                  
003439 L01-EX. EXIT.                                                    
003440*----------------------------------------------------------------*
003441 L02-FETCH-POINTPF14.                                             
003442*----------------------------------------------------------------*
003443     MOVE 'L02-'                 TO WCOM-CODABEND.                
003444     MOVE 'FETCH'                TO WCOM-FILEFUNZ.                
003445     MOVE 'POINTPF14'            TO WCOM-FILENOME.                
003446     MOVE SPACES                 TO WCOM-FILECTRL.                
003447     STRING WS-CODCLIEN ' ' WS-RAGFATTU                           
003448        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
003450     
      *EXEC SQL 
      *FETCH POINTPF14                                         
003451*           INTO :A901-CODCLIEN, :A901-RAGFATTU                    
003452*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 5 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODCLIEN
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-RAGFATTU
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003453     MOVE SQLCODE                TO WS-SQLCODE2.                  
003454 L02-EX. EXIT.                                                    
003455*---------------------------------------------------------------* 
003456 L10-SELECT-SOCIETA.                                              
003457*---------------------------------------------------------------* 
003458     MOVE 'L10-'                 TO WCOM-CODABEND.                
003459     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003460     MOVE 'TSOCIETA'             TO WCOM-FILENOME.                
003461     MOVE A531-CODSOCIE          TO WCOM-FILECTRL.                
003463     
      *EXEC SQL 
      *SELECT CODSOCIE, NOMSOCIE                               
003464*            INTO :A531-CODSOCIE, :A531-NOMSOCIE                   
003465*            FROM DANAGRAF.TSOCIETA                                
003466*           WHERE CODSOCIE = :A531-CODSOCIE                        
003467*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 6 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 7 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 23 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-NOMSOCIE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 4 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003468 L10-EX. EXIT.                                                    
003469*---------------------------------------------------------------* 
003470 L15-SELECT-CLIENTI.                                              
003471*---------------------------------------------------------------* 
003472     MOVE 'L15-'                 TO WCOM-CODABEND.                
003473     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003474     MOVE 'CLIENTI'              TO WCOM-FILENOME.                
003475     MOVE A901-CODCLIEN          TO WCOM-FILECTRL.                
003476     MOVE SPACES                 TO A901-CODSOCIE.                
003477     MOVE ALL '?'                TO A901-RAGFATTU.                
003479     
      *EXEC SQL 
      *SELECT CODSOCIE, RAGFATTU                               
003480*            INTO :A901-CODSOCIE, :A901-RAGFATTU                   
003481*            FROM DANAGRAF.TCLIENTI                                
003482*           WHERE CODCLIEN = :A901-CODCLIEN                        
003483*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 8 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODCLIEN
            BY VALUE 0
                     0

           MOVE 9 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODSOCIE
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-RAGFATTU
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 5 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003484 L15-EX. EXIT.                                                    
003485*---------------------------------------------------------------* 
003486 L17-SELECT-RAGFATTU.                                             
003487*---------------------------------------------------------------* 
003488     PERFORM C17-DESCRIZIONE-MAPPA                                
003489        THRU C17-EX.                                              
003490     MOVE 'L17-'                 TO WCOM-CODABEND.                
003491     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003492     MOVE 'CLIENTI'              TO WCOM-FILENOME.                
003493     MOVE WS-RAGFATTU            TO WCOM-FILECTRL.                
003494     MOVE SPACES                 TO A901-CODSOCIE.                
003495     MOVE SPACES                 TO A901-CODCLIEN.                
003496     MOVE ALL '?'                TO A901-RAGFATTU.                
003498     
      *EXEC SQL 
      *SELECT X.ORDINAME, X.CODSOCIE                           
003499*                ,X.CODCLIEN, X.RAGFATTU                           
003500*            INTO :WSWS-ORDINAME, :A901-CODSOCIE                   
003501*                ,:A901-CODCLIEN, :A901-RAGFATTU                   
003502*            FROM (                                                
003503*            SELECT '1' AS ORDINAME, C.CODSOCIE                    
003504*                       ,C.CODCLIEN, C.RAGFATTU                    
003505*              FROM DANAGRAF.TCLIENTI C                            
003506*                  ,DLOGISTI.TORDILOGI O                           
003507*             WHERE C.RAGFATTU LIKE :WS-RAGFATTU                   
003508*               AND C.CODCLIEN=O.CODCLIEN                          
003509*               AND O.DTANNULL = ' '                               
003510*            UNION ALL                                             
003511*            SELECT '2' AS ORDINAME, C.CODSOCIE                    
003512*                       ,C.CODCLIEN, C.RAGFATTU                    
003513*              FROM DANAGRAF.TCLIENTI C                            
003514*             WHERE C.RAGFATTU LIKE :WS-RAGFATTU                   
003515*               AND NOT EXISTS (SELECT O.AANUMORD                  
003516*                                 FROM DLOGISTI.TORDILOGI O        
003517*                                WHERE C.CODCLIEN = O.CODCLIEN     
003518*                                  AND O.DTANNULL = ' ')           
003519*                 ) AS X                                           
003520*             ORDER BY 1, 2                                        
003521*             FETCH FIRST ROW ONLY                                 
003522*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 10 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-RAGFATTU
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-RAGFATTU
            BY VALUE 0
                     0

           MOVE 11 TO SQL-STMT-ID 
           MOVE 4 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WSWS-ORDINAME
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODSOCIE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODCLIEN
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-RAGFATTU
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 6 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003523 L17-EX. EXIT.                                                    
003524*---------------------------------------------------------------* 
003525 L18-SELECT-SERVIZI.                                              
003526*---------------------------------------------------------------* 
003527     MOVE 'L18-'                 TO WCOM-CODABEND.                
003528     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003529     MOVE 'SERVIZI'              TO WCOM-FILENOME.                
003530     MOVE L651-CODSERVI          TO WCOM-FILECTRL.                
003531     MOVE ALL '?'                TO L651-DESSERVI.                
003533     
      *EXEC SQL 
      *SELECT DESSERVI                                         
003534*            INTO :L651-DESSERVI                                   
003535*            FROM DLOGISTI.TSERVIZI                                
003536*           WHERE CODSERVI = :L651-CODSERVI                        
003537*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 12 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CODSERVI
            BY VALUE 0
                     0

           MOVE 13 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-DESSERVI
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 7 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003538 L18-EX. EXIT.                                                    
003539*----------------------------------------------------------------*
003540 L20-SELECT-ORDILOGI-FATT.                                        
003541*----------------------------------------------------------------*
003542     MOVE 'L20-'                 TO WCOM-CODABEND.                
003543     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003544     MOVE 'ORDILOGI'             TO WCOM-FILENOME.                
003545     MOVE L652-AANUMFAT          TO WCOM-FILECTRL.                
003546     MOVE SPACES                 TO L652-CODSOCIE.                
003548     
      *EXEC SQL 
      *SELECT DISTINCT CODSOCIE                               
003549*             INTO :L652-CODSOCIE                                  
003550*             FROM DLOGISTI.TORDILOGI                              
003551*            WHERE AANUMFAT = :L652-AANUMFAT                       
003552*              AND DTANNULL = ' '                                  
003553*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 14 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-AANUMFAT
            BY VALUE 0
                     0

           MOVE 15 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODSOCIE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 8 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003554 L20-EX. EXIT.                                                    
003555*----------------------------------------------------------------*
003556 L30-SELECT-DATEELAB.                                             
003557*----------------------------------------------------------------*
003558     MOVE 'MENSILE'              TO A847-SIGLDATA                 
003559     MOVE 'L30-'                 TO WCOM-CODABEND.                
003560     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
003561     MOVE 'DATEELAB'             TO WCOM-FILENOME.                
003562     MOVE A847-SIGLDATA          TO WCOM-FILECTRL.                
003563     MOVE SPACES                 TO A847-DTINELAB.                
003565     
      *EXEC SQL 
      *SELECT DTINELAB                                        
003566*             INTO :A847-DTINELAB                                  
003567*             FROM DANAGRAF.TDATEELAB                              
003568*            WHERE SIGLDATA = :A847-SIGLDATA                       
003569*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 16 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A847-SIGLDATA
            BY VALUE 0
                     0

           MOVE 17 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A847-DTINELAB
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 9 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
003570 L30-EX. EXIT.                                                    
003571*----------------------------------------------------------------*
003572 O00-OPEN-POINTER.                                                
003573*----------------------------------------------------------------*
003574     MOVE WCOM-CODSOCIE          TO L652-CODSOCIE.                
003575     MOVE SPACES                 TO MIN-CODCLIEN                  
003576*    MOVE ALL '9'                TO MAX-CODCLIEN                  
003577     MOVE ALL 'Z'                TO MAX-CODCLIEN                  
003578     IF WCOM-CODCLIEN > ' '                                       
003579        MOVE WCOM-CODCLIEN       TO MIN-CODCLIEN                  
003580                                    MAX-CODCLIEN.                 
003581     MOVE SPACES                 TO MIN-AANUMFAT                  
003582*    MOVE ALL '9'                TO MAX-AANUMFAT                  
003583     MOVE ALL 'Z'                TO MAX-AANUMFAT                  
003584     IF WCOM-AANUMFAT > ' '                                       
003585        MOVE WCOM-AANUMFAT       TO MIN-AANUMFAT                  
003586                                    MAX-AANUMFAT.                 
003587     MOVE WCOM-CONTODCE          TO L652-CONTODCE.                
003588     INSPECT L652-CONTODCE REPLACING ALL SPACES BY '%'.           
003589     MOVE WCOM-CENCOSTD          TO L653-CENCOSTD.                
003590     INSPECT L653-CENCOSTD REPLACING ALL SPACES BY '%'.           
003591     MOVE WCOM-CENCOSTA          TO L653-CENCOSTA.                
003592     INSPECT L653-CENCOSTA REPLACING ALL SPACES BY '%'.           
003593     MOVE WCOM-CODSERVI          TO L653-CODSERVI                 
003594     INSPECT L653-CODSERVI REPLACING ALL SPACES BY '%'.           
003595     MOVE WCOM-DESSERVI          TO L651-DESSERVI                 
003596     INSPECT L651-DESSERVI REPLACING ALL SPACES BY '%'.           
003597     MOVE SPACES                 TO MIN-TIPSERVI.                 
003598*    MOVE ALL '9'                TO MAX-TIPSERVI.                 
003599     MOVE ALL 'Z'                TO MAX-TIPSERVI.                 
003600     IF WCOM-TIPSERVI > SPACES                                    
003601        MOVE WCOM-TIPSERVI       TO MIN-TIPSERVI                  
003602        MOVE WCOM-TIPSERVI       TO MAX-TIPSERVI.                 
003603     IF WCOM-MENUTRAN(1) NOT = 'LOGI'                             
003604        MOVE 'L'                 TO MIN-TIPSERVI                  
003605                                    MAX-TIPSERVI.                 
003606     MOVE WCOM-DTCARORD          TO MIN-AAMMCOMP(1:4)             
003607                                    MAX-AAMMCOMP(1:4)             
003608     MOVE '01'                   TO MIN-AAMMCOMP(5:2)             
003609     MOVE '12'                   TO MAX-AAMMCOMP(5:2)             
003610     IF WCOM-DTCARORD(5:2) > SPACES                               
003611        MOVE WCOM-DTCARORD(5:2)  TO MIN-AAMMCOMP(5:2)             
003612                                    MAX-AAMMCOMP(5:2).            
003613     MOVE '        '             TO MIN-DTEVAORD.                 
003614     MOVE '99999999'             TO MAX-DTEVAORD.                 
003615     MOVE '        '             TO MIN-DTFATTUR.                 
003616     MOVE '        '             TO MAX-DTFATTUR.                 
003617     IF WCOM-STATUSXX = 'F'                                       
003618        MOVE '00000000'          TO MIN-DTEVAORD                  
003619        MOVE '99999999'          TO MAX-DTEVAORD                  
003620        MOVE '00000000'          TO MIN-DTFATTUR                  
003621        MOVE '99999999'          TO MAX-DTFATTUR.                 
003622     IF WCOM-STATUSXX = 'T'                                       
003623        MOVE '        '          TO MIN-DTEVAORD                  
003624        MOVE '99999999'          TO MAX-DTEVAORD                  
003625        MOVE '        '          TO MIN-DTFATTUR                  
003626        MOVE '99999999'          TO MAX-DTFATTUR.                 
003627     MOVE SPACES                 TO MIN-FLAGSOSP.                 
003628*    MOVE ALL '9'                TO MAX-FLAGSOSP.                 
003629     MOVE ALL 'Z'                TO MAX-FLAGSOSP.                 
003630     IF WCOM-SALDATOX = 'S'                                       
003631        MOVE 'S'                 TO MIN-FLAGSOSP                  
003632                                    MAX-FLAGSOSP.                 
003633     IF WCOM-SALDATOX = 'N'                                       
003634        MOVE ' '                 TO MIN-FLAGSOSP                  
003635                                    MAX-FLAGSOSP.                 
003636     MOVE 'O00-'                 TO WCOM-CODABEND.                
003637     MOVE 'OPEN'                 TO WCOM-FILEFUNZ                 
003638     STRING WCOM-CODSOCIE ' ' WCOM-CODCLIEN                       
003639            WCOM-CODSERVI ' ' WCOM-RAGFATTU                       
003640            WCOM-TIPSERVI ' ' WCOM-CONTODCE                       
003641            WCOM-AANUMFAT                                         
003642     DELIMITED BY SIZE         INTO WCOM-FILECTRL.                
003643     MOVE 'POINTER1'             TO WCOM-FILENOME                 
003644     
      *EXEC SQL OPEN POINTER1 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 18 TO SQL-STMT-ID 
           MOVE 39 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODSOCIE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-CODCLIEN
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-CODCLIEN
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CONTODCE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-TIPSERVI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-TIPSERVI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-AAMMCOMP
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-AAMMCOMP
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-DTEVAORD
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-DTEVAORD
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-DTFATTUR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 11 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-DTFATTUR
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 12 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-FLAGSOSP
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 13 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-FLAGSOSP
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 14 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-AANUMFAT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 15 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-AANUMFAT
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 16 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CODSERVI
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 17 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CENCOSTD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 18 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CENCOSTA
            BY VALUE 0
                     0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 19 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-DESSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 20 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODSOCIE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 21 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-CODCLIEN
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 22 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-CODCLIEN
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 23 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CONTODCE
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 24 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-TIPSERVI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 25 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-TIPSERVI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 26 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-AAMMCOMP
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 27 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-AAMMCOMP
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 28 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-DTEVAORD
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 29 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-DTEVAORD
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 30 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-DTFATTUR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 31 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-DTFATTUR
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 32 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-FLAGSOSP
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 33 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-FLAGSOSP
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 34 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MIN-AANUMFAT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 35 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE MAX-AANUMFAT
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 36 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CODSERVI
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 37 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CENCOSTD
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 38 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CENCOSTA
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                          .                             
003645 O00-EX. EXIT.                                                    
003646*----------------------------------------------------------------*
003647 O10-CLOSE-POINTER.                                               
003648*----------------------------------------------------------------*
003649     MOVE 'O10-'                 TO WCOM-CODABEND.                
003650     MOVE 'CLOSE'                TO WCOM-FILEFUNZ                 
003651     STRING WCOM-CODSOCIE ' ' WCOM-CODCLIEN                       
003652            WCOM-CODSERVI ' ' WCOM-RAGFATTU                       
003653            WCOM-TIPSERVI ' ' WCOM-CONTODCE                       
003654            WCOM-AANUMFAT                                         
003655     DELIMITED BY SIZE         INTO WCOM-FILECTRL.                
003656     MOVE 'POINTER1'             TO WCOM-FILENOME                 
003657     
      *EXEC SQL CLOSE POINTER1 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                           .                            
003658 O10-EX. EXIT.                                                    
003659*----------------------------------------------------------------*
003660 P00-ATTRIBUTI-RIGA.                                              
003661*----------------------------------------------------------------*
003662     IF LO24-RAAMMCOMI(WINDRIGA) NOT > SPACES                     
003663        MOVE DFHBLUE             TO LO24-OPERAZIOC(WINDRIGA)      
003664        MOVE DFHDFHI             TO LO24-OPERAZIOH(WINDRIGA)      
003665        MOVE DFHBMASF            TO LO24-OPERAZIOA(WINDRIGA).     
003666     IF LO24-RAAMMCOMI(WINDRIGA) = LO24-RAAMMCOMI(WINDRIGA - 1)   
003667        MOVE DFHPRODM            TO LO24-RAAMMCOMA(WINDRIGA)      
003668        IF LO24-RTIPSERVI(WINDRIGA) = LO24-RTIPSERVI(WINDRIGA - 1)
003669           MOVE DFHPRODM         TO LO24-RTIPSERVA(WINDRIGA).     
003670 P00-EX. EXIT.                                                   
003671*----------------------------------------------------------------*
003672 R00-READQ-WPAGCTRL.                                              
003673*----------------------------------------------------------------*
003674     MOVE SPACES                 TO WPAGREFE.                     
003675     INITIALIZE                     WPAGREFE.                     
003676                                                                  
003677* EXEC CICS HANDLE CONDITION ITEMERR (R00-EX)                     
003678*                               QIDERR  (R00-EX)                  
003679*    END-EXEC.                                                    
003680*    MOVE '"$<N                  ! $ #00003515' TO DFHEIV0        
003681     MOVE X'22243C4E2020202020202020' &                           
003682          X'202020202020202020202120' &                           
003683          X'2420233030303033353135' TO DFHEIV0                    
003684     CALL 'kxdfhei1' USING DFHEIV0                                
003685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003686                                                                  
003687                                                                  
003688* EXEC CICS READQ  TS QUEUE   (WPAGCTRL)                          
003689*                        INTO    (WPAGREFE)                       
003690*                        ITEM    (WNUMITEM)                       
003691*                        LENGTH  (WPAGLPAG)                       
003692*                        END-EXEC.                                
003693*    MOVE '*$II   L              ''   #00003518' TO DFHEIV0       
003694     MOVE X'2A2449492020204C20202020' &                           
003695          X'202020202020202020202720' &                           
003696          X'2020233030303033353138' TO DFHEIV0                    
003697     CALL 'kxdfhei1' USING DFHEIV0,                               
003698           WPAGCTRL,                                              
003699           WPAGREFE,                                              
003700           WPAGLPAG,                                              
003701           WNUMITEM,                                              
003702           DFHEIV99,                                              
003703           DFHEIV99                                               
003704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003705                                                                  
003706 R00-EX. EXIT.                                                    
003707*----------------------------------------------------------------*
003708 R10-READQ-WPAGCTR2.                                              
003709*----------------------------------------------------------------*
003710     MOVE SPACES                 TO WPAGREF2.                     
003711     INITIALIZE                     WPAGREF2.                     
003712                                                                  
003713* EXEC CICS HANDLE CONDITION ITEMERR (R10-EX)                     
003714*                               QIDERR  (R10-EX)                  
003715*    END-EXEC.                                                    
003716*    MOVE '"$<N                  ! % #00003529' TO DFHEIV0        
003717     MOVE X'22243C4E2020202020202020' &                           
003718          X'202020202020202020202120' &                           
003719          X'2520233030303033353239' TO DFHEIV0                    
003720     CALL 'kxdfhei1' USING DFHEIV0                                
003721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003722                                                                  
003723                                                                  
003724* EXEC CICS READQ  TS QUEUE   (WPAGCTR2)                          
003725*                        INTO    (WPAGREF2)                       
003726*                        ITEM    (1)                              
003727*                        LENGTH  (WPAGLPA2)                       
003728*                        END-EXEC.                                
003729     MOVE 1                                                       
003730       TO DFHEIV11                                                
003731*    MOVE '*$II   L              ''   #00003532' TO DFHEIV0       
003732     MOVE X'2A2449492020204C20202020' &                           
003733          X'202020202020202020202720' &                           
003734          X'2020233030303033353332' TO DFHEIV0                    
003735     CALL 'kxdfhei1' USING DFHEIV0,                               
003736           WPAGCTR2,                                              
003737           WPAGREF2,                                              
003738           WPAGLPA2,                                              
003739           DFHEIV11,                                              
003740           DFHEIV99,                                              
003741           DFHEIV99                                               
003742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003743                                                                  
003744 R10-EX. EXIT.                                                    
003745*----------------------------------------------------------------*
003746 R20-WRITEQ-WPAG.                                                 
003747*----------------------------------------------------------------*
003748     ADD  1                      TO WCOM-PAGILIST.                
003749                                                                  
003750* EXEC CICS WRITEQ TS    QUEUE (WPAGCTRL)                         
003751*                           FROM  (WPAGREFE)                      
003752*                           LENGTH(WPAGLPAG)                      
003753*                           END-EXEC.                             
003754*    MOVE '*"     L              ''   #00003542' TO DFHEIV0       
003755     MOVE X'2A2220202020204C20202020' &                           
003756          X'202020202020202020202720' &                           
003757          X'2020233030303033353432' TO DFHEIV0                    
003758     CALL 'kxdfhei1' USING DFHEIV0,                               
003759           WPAGCTRL,                                              
003760           WPAGREFE,                                              
003761           WPAGLPAG,                                              
003762           DFHEIV99,                                              
003763           DFHEIV99,                                              
003764           DFHEIV99                                               
003765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003766                                                                  
003767 R20-EX. EXIT.                                                    
003768*----------------------------------------------------------------*
003769 R22-WRITEQ-WPA2.                                                 
003770*----------------------------------------------------------------*
003771                                                                  
003772* EXEC CICS WRITEQ TS    QUEUE (WPAGCTR2)                         
003773*                           FROM  (WPAGREF2)                      
003774*                           LENGTH(WPAGLPA2)                      
003775*                           END-EXEC.                             
003776*    MOVE '*"     L              ''   #00003550' TO DFHEIV0       
003777     MOVE X'2A2220202020204C20202020' &                           
003778          X'202020202020202020202720' &                           
003779          X'2020233030303033353530' TO DFHEIV0                    
003780     CALL 'kxdfhei1' USING DFHEIV0,                               
003781           WPAGCTR2,                                              
003782           WPAGREF2,                                              
003783           WPAGLPA2,                                              
003784           DFHEIV99,                                              
003785           DFHEIV99,                                              
003786           DFHEIV99                                               
003787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003788                                                                  
003789 R22-EX. EXIT.                                                    
003790*----------------------------------------------------------------*
003791 U00-RETURN-TRAN.                                                 
003792*----------------------------------------------------------------*
003793                                                                  
003794* EXEC CICS RETURN TRANSID  (EIBTRNID)                            
003795*                     COMMAREA (WCOM-AREAXXXX)                    
003796*                     LENGTH   (WCOM-LUNGHEZZ)                    
003797*    END-EXEC.                                                    
003798*    MOVE '.(CT                  ''   #00003558' TO DFHEIV0       
003799     MOVE X'2E2843542020202020202020' &                           
003800          X'202020202020202020202720' &                           
003801          X'2020233030303033353538' TO DFHEIV0                    
003802     CALL 'kxdfhei1' USING DFHEIV0,                               
003803           EIBTRNID,                                              
003804           WCOM-AREAXXXX,                                         
003805           WCOM-LUNGHEZZ,                                         
003806           DFHEIV99,                                              
003807           DFHEIV99,                                              
003808           DFHEIV99                                               
003809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003810                                                                  
003811 U00-EX. EXIT.                                                    
003812*----------------------------------------------------------------*
003813 U02-NORESP.                                                      
003814*----------------------------------------------------------------*
003815                                                                  
003816* EXEC CICS SEND CONTROL                                          
003817*                   FREEKB                                        
003818*                   END-EXEC.                                     
003819*    MOVE '82      T    F        (   #00003566' TO DFHEIV0        
003820     MOVE X'383220202020202054202020' &                           
003821          X'204620202020202020202820' &                           
003822          X'2020233030303033353636' TO DFHEIV0                    
003823     CALL 'kxdfhei1' USING DFHEIV0,                               
003824           DFHEIV99,                                              
003825           DFHEIV99,                                              
003826           DFHEIV99,                                              
003827           DFHEIV99,                                              
003828           DFHEIV99,                                              
003829           DFHEIV99,                                              
003830           DFHEIV99                                               
003831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003832                                                                  
003833     PERFORM U00-RETURN-TRAN                                      
003834        THRU U00-EX.                                              
003835 U02-EX. EXIT.                                                    
003836*----------------------------------------------------------------*
003837 U05-START-TRANSID.                                               
003838*----------------------------------------------------------------*
003839                                                                  
003840* EXEC CICS START   TRANSID (WTRANSID)                            
003841*                      FROM    (WCOM-AREAXXXX)                    
003842*                      LENGTH  (WCOM-LUNGHEZZ)                    
003843*                      TERMID  (EIBTRMID)                         
003844*                      END-EXEC                                   
003845*    MOVE '0( LFT                1   #00003575' TO DFHEIV0        
003846     MOVE X'3028204C4654202020202020' &                           
003847          X'202020202020202020203120' &                           
003848          X'2020233030303033353735' TO DFHEIV0                    
003849     CALL 'kxdfhei1' USING DFHEIV0,                               
003850           DFHEIV99,                                              
003851           WTRANSID,                                              
003852           DFHEIV99,                                              
003853           WCOM-AREAXXXX,                                         
003854           WCOM-LUNGHEZZ,                                         
003855           EIBTRMID,                                              
003856           DFHEIV99,                                              
003857           DFHEIV99,                                              
003858           DFHEIV99,                                              
003859           DFHEIV99,                                              
003860           DFHEIV99,                                              
003861           DFHEIV99,                                              
003862           DFHEIV99,                                              
003863           DFHEIV99,                                              
003864           DFHEIV99,                                              
003865           DFHEIV99                                               
003866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
003867                                                                  
003868* EXEC CICS RETURN  END-EXEC.                                     
003869*    MOVE '.(                    ''   #00003580' TO DFHEIV0       
003870     MOVE X'2E2820202020202020202020' &                           
003871          X'202020202020202020202720' &                           
003872          X'2020233030303033353830' TO DFHEIV0                    
003873     CALL 'kxdfhei1' USING DFHEIV0,                               
003874           DFHEIV99,                                              
003875           DFHEIV99,                                              
003876           DFHEIV99,                                              
003877           DFHEIV99,                                              
003878           DFHEIV99,                                              
003879           DFHEIV99                                               
003880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003881                                                                  
003882 U05-EX. EXIT.                                                    
003883*----------------------------------------------------------------*
003884 U10-DECODIFICA-MESSAGGI.                                         
003885*----------------------------------------------------------------*
003886     MOVE WCOM-CODILING          TO MESS-CODILING.                
003887*    EXEC SQL  INCLUDE SRMESS  END-EXEC.                          
      *>>((file: SRMESS))
000001*-------------------------------------------------- SRMESS START* 
000002*-  AUTHOR: FEBBRAIOLA DOMENICO & GIUSEPPE RASPINO              * 
000003*---------------------------------------------------------------* 
000004*                                                               * 
000005*  SUBROUTINE PER LA RICERCA DEI MESSAGGI IN LINGUA             * 
000006*                                                               * 
000007*  N.B.  INSERIRE IN WORKING STORAGE :                          * 
000008*            EXEC SQL INCLUDE FDANA846 END-EXEC.                * 
000009*            COPY  DCMESS                                       * 
000010*                                                               * 
000011*  N.B.  IMPOSTARE DATI IN :                                    * 
000012*            MESS-CODERROR                                      * 
000013*            MESS-CODILING                                      * 
000014*                                                               * 
000015***************************************************************** 
000016                                                                  
000017     MOVE 'SELECT'             TO WCOM-FILEFUNZ                   
000018     MOVE 'FDANA846'           TO WCOM-FILENOME                   
000019     MOVE 'SRME'               TO WCOM-CODABEND                   
000020     MOVE MESS-CODERROR        TO WCOM-FILECTRL                   
000021                                                                  
000022     MOVE SPACES               TO MESS-CAMPI-OUTPUT.              
000023     MOVE MESS-CODERROR        TO A846-CODERROR.                  
000024     MOVE MESS-CODILING        TO A846-CODILING.                  
000025                                                                  
000027     
      *EXEC SQL 
      *SELECT MSGERROR                                         
000028*          INTO  :A846-MSGERROR                                    
000029*          FROM   DANAGRAF.TMESSAGGI                               
000030*          WHERE  CODERROR = :A846-CODERROR AND                    
000031*                 CODILING = :A846-CODILING                        
000032*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 19 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODERROR
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODILING
            BY VALUE 0
                     0

           MOVE 20 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 60 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-MSGERROR
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 10 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000033                                                                  
000034     IF SQLCODE NOT EQUAL ZEROS AND                               
000035        SQLCODE NOT EQUAL +100                                    
000036        PERFORM Z00-ERRORE                                        
000037           THRU Z00-EX                                            
000038     ELSE                                                         
000039        IF SQLCODE EQUAL ZEROS                                    
000040           MOVE MESS-CODERROR    TO MESS-COMCODER                 
000041           MOVE A846-MSGERROR    TO MESS-MESSAGGI                 
000042        ELSE                                                      
000043           MOVE '99999'          TO A846-CODERROR                 
000044           MOVE MESS-CODILING    TO A846-CODILING                 
000046           
      *EXEC SQL 
      *SELECT MSGERROR                                   
000047*                INTO  :A846-MSGERROR                              
000048*                FROM   DANAGRAF.TMESSAGGI                         
000049*                WHERE  CODERROR = :A846-CODERROR AND              
000050*                       CODILING = :A846-CODILING                  
000051*           END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 21 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODERROR
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODILING
            BY VALUE 0
                     0

           MOVE 22 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 60 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-MSGERROR
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 11 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000052           IF SQLCODE EQUAL ZEROS                                 
000053              MOVE MESS-CODERROR TO MESS-COMCODER                 
000054              MOVE A846-MSGERROR TO MESS-MESSAGGI                 
000055           ELSE                                                   
000056              IF SQLCODE = 100                                    
000057                 MOVE MESS-CODERROR   TO MESS-COMCODER            
000058                 MOVE '*** MESSAGGIO  NON  TROVATO ****'          
000059                                      TO MESS-MESSAGGI            
000060              ELSE                                                
000061                 PERFORM Z00-ERRORE                               
000062                     THRU Z00-EX.                                 
000063                                                                  
000064*------------------------------------------------- SRMESS    END* 
      *<<((file: SRMESS))
003888     MOVE MESS-MSGERROR          TO LO24-MESSAGGO.                
003889 U10-EX. EXIT.                                                    
003890*----------------------------------------------------------------*
003891 U20-DELETE-TS.                                                   
003892*----------------------------------------------------------------*
003893                                                                  
003894* EXEC CICS DELETEQ TS QUEUE   (WPAGCTRL)                         
003895*              NOHANDLE                                           
003896*              END-EXEC.                                          
003897*    MOVE '*&                    #  N#00003592' TO DFHEIV0        
003898     MOVE X'2A2620202020202020202020' &                           
003899          X'202020202020202020202320' &                           
003900          X'204E233030303033353932' TO DFHEIV0                    
003901     CALL 'kxdfhei1' USING DFHEIV0,                               
003902           WPAGCTRL,                                              
003903           DFHEIV99                                               
003904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003905                                                                  
003906 U20-EX. EXIT.                                                    
003907*----------------------------------------------------------------*
003908 U22-DELETE-TS2.                                                  
003909*----------------------------------------------------------------*
003910                                                                  
003911* EXEC CICS DELETEQ TS QUEUE   (WPAGCTR2)                         
003912*              NOHANDLE                                           
003913*              END-EXEC.                                          
003914*    MOVE '*&                    #  N#00003599' TO DFHEIV0        
003915     MOVE X'2A2620202020202020202020' &                           
003916          X'202020202020202020202320' &                           
003917          X'204E233030303033353939' TO DFHEIV0                    
003918     CALL 'kxdfhei1' USING DFHEIV0,                               
003919           WPAGCTR2,                                              
003920           DFHEIV99                                               
003921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003922                                                                  
003923 U22-EX. EXIT.                                                    
003924*----------------------------------------------------------------*
003925*    EXEC SQL INCLUDE SRDTGG END-EXEC.                            
      *>>((file: SRDTGG))
000001*---------------------------------------------------------------* 
000002*    RICERCA DATA DEL GIORNO SULLA TABELLA-DB2 ''TDATARIO''     * 
000003*    PER IL CORRETTO UTILIZZO VEDI IL DATA MANAGER.            *  
000004*---------------------------------------------------------------* 
000005* N.B.  INSERIRE IN WORKING STORAGE :                           * 
000006*                                                               * 
000007*    EXEC SQL INCLUDE FDANA973 END-EXEC.                        * 
000008*    EXEC SQL INCLUDE DCDTGG   END-EXEC.                        * 
000009*    COPY DCWCOMMA(PER PROGRAMMI TP)  X COMODI GESTIONE ERRORI  * 
000010*    COPY DCDB2ER(PER PROGRAMMI BATCH)X COMODI GESTIONE ERRORI  * 
000011*                                                               * 
000012*---------------------------------------------------------------* 
000013                                                                  
000014 SRDTGG.                                                          
000015                                                                  
000016     MOVE +0                     TO DTGG-PRGIORNO.                
000017                                                                  
000018     MOVE SPACES                 TO DTGG-NUMGIORN                 
000019                                    DTGG-DTGIORNO                 
000020                                    DTGG-NUMSETTI                 
000021                                    DTGG-NRGGSETT                 
000022                                    DTGG-DTINISET                 
000023                                    DTGG-DTFINSET                 
000024                                    DTGG-DTINIMES                 
000025                                    DTGG-DTFINMES                 
000026                                    DTGG-ANNOSETT                 
000027                                    DTGG-RETUCODE.                
000028                                                                  
000030     
      *EXEC SQL 
      *SELECT CURRENT DATE                                     
000031*          INTO :DTGG-DATAGIOR                                     
000032*          FROM DANAGRAF.VANAGRAF_082                              
000033*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 23 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE DTGG-DATAGIOR
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 12 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000034                                                                  
000035     MOVE DTGG-DATAGIOR(1:4)     TO DTGG-AACURREN.                
000036     MOVE DTGG-DATAGIOR(6:2)     TO DTGG-MMCURREN.                
000037     MOVE DTGG-DATAGIOR(9:2)     TO DTGG-GGCURREN.                
000038                                                                  
000039     MOVE DTGG-DTCURREN          TO DTGG-CURRENDT.                
000040                                                                  
000041     IF DTGG-DTRICHIE  NOT GREATER SPACES AND                     
000042        DTGG-PRRICHIE  NOT GREATER ZEROES                         
000043        PERFORM SRDTGG-A10-RICERCA-GIORNO                         
000044           THRU SRDTGG-A10-EX                                     
000045     ELSE                                                         
000046        IF DTGG-DTRICHIE   GREATER SPACES                         
000047           MOVE DTGG-DTRICHIE    TO A973-DTGIORNO                 
000048           PERFORM SRDTGG-A20-CALCOLO-DATARIC                     
000049              THRU SRDTGG-A20-EX                                  
000050        ELSE                                                      
000051           MOVE DTGG-PRRICHIE    TO A973-PRGIORNO                 
000052           PERFORM SRDTGG-A30-CALCOLO-PROGRES                     
000053              THRU SRDTGG-A30-EX.                                 
000054                                                                  
000055 SRDTGG-EX. EXIT.                                                 
000056                                                                  
000057*---------------------------------------------------------------* 
000058 SRDTGG-A10-RICERCA-GIORNO.                                       
000059*---------------------------------------------------------------* 
000060                                                                  
000061     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
000062     MOVE 'DATARIO'              TO WCOM-FILENOME.                
000063     MOVE 'DB2 '                 TO WCOM-CODABEND.                
000064     MOVE 'A10-RI'               TO WCOM-FILECTRL.                
000065     MOVE 'ERRORE IN SRDTGG-A10' TO WCOM-MESSAGES.                
000066                                                                  
000068     
      *EXEC SQL 
      *SELECT DTGIORNO, PRGIORNO, NUMGIORN                     
000069*                ,NUMSETTI, NRGGSETT, ANNOSETT                     
000070*                ,DTINISET, DTFINSET                               
000071*                ,DTINIMES, DTFINMES                               
000072*            INTO :A973-DTGIORNO, :A973-PRGIORNO, :A973-NUMGIORN   
000073*                ,:A973-NUMSETTI, :A973-NRGGSETT, :A973-ANNOSETT   
000074*                ,:A973-DTINISET, :A973-DTFINSET                   
000075*                ,:A973-DTINIMES, :A973-DTFINMES                   
000076*            FROM DANAGRAF.TDATARIO                                
000077*           WHERE DTGIORNO = :DTGG-CURRENDT                        
000078*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 24 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE DTGG-CURRENDT
            BY VALUE 0
                     0

           MOVE 25 TO SQL-STMT-ID 
           MOVE 10 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTGIORNO
            BY VALUE 0
                     0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-PRGIORNO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NUMGIORN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NUMSETTI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NRGGSETT
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-ANNOSETT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTINISET
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTFINSET
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTINIMES
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTFINMES
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 13 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000079                                                                  
000080     IF SQLCODE EQUAL 0                                           
000081        MOVE '****'              TO DTGG-RETUCODE                 
000082        MOVE A973-DTGIORNO       TO DTGG-DTGIORNO                 
000083        MOVE A973-PRGIORNO       TO DTGG-PRGIORNO                 
000084        MOVE A973-NUMSETTI       TO DTGG-NUMSETTI                 
000085        MOVE A973-NUMGIORN       TO DTGG-NUMGIORN                 
000086        MOVE A973-NRGGSETT       TO DTGG-NRGGSETT                 
000087        MOVE A973-DTINISET       TO DTGG-DTINISET                 
000088        MOVE A973-DTFINSET       TO DTGG-DTFINSET                 
000089        MOVE A973-DTINIMES       TO DTGG-DTINIMES                 
000090        MOVE A973-DTFINMES       TO DTGG-DTFINMES                 
000091        MOVE A973-ANNOSETT       TO DTGG-ANNOSETT                 
000092     ELSE                                                         
000093        IF SQLCODE EQUAL 100                                      
000094           MOVE 'MRNF'           TO DTGG-RETUCODE                 
000095        ELSE                                                      
000096           MOVE 'ERRO'           TO DTGG-RETUCODE.                
000097                                                                  
000098 SRDTGG-A10-EX. EXIT.                                            
000099                                                                  
000100*---------------------------------------------------------------* 
000101 SRDTGG-A20-CALCOLO-DATARIC.                                      
000102*---------------------------------------------------------------* 
000103                                                                  
000104     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
000105     MOVE 'DATARIO'              TO WCOM-FILENOME.                
000106     MOVE 'DB2 '                 TO WCOM-CODABEND.                
000107     MOVE  A973-DTGIORNO         TO WCOM-FILECTRL.                
000108     MOVE 'ERRORE IN SRDTGG-A20' TO WCOM-MESSAGES.                
000109                                                                  
000111     
      *EXEC SQL 
      *SELECT DTGIORNO, PRGIORNO, NUMGIORN                     
000112*                ,NUMSETTI, NRGGSETT, ANNOSETT                     
000113*                ,DTINISET, DTFINSET                               
000114*                ,DTINIMES, DTFINMES                               
000115*            INTO :A973-DTGIORNO, :A973-PRGIORNO, :A973-NUMGIORN   
000116*                ,:A973-NUMSETTI, :A973-NRGGSETT, :A973-ANNOSETT   
000117*                ,:A973-DTINISET, :A973-DTFINSET                   
000118*                ,:A973-DTINIMES, :A973-DTFINMES                   
000119*            FROM DANAGRAF.TDATARIO                                
000120*           WHERE DTGIORNO = :A973-DTGIORNO                        
000121*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 26 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTGIORNO
            BY VALUE 0
                     0

           MOVE 27 TO SQL-STMT-ID 
           MOVE 10 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTGIORNO
            BY VALUE 0
                     0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-PRGIORNO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NUMGIORN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NUMSETTI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NRGGSETT
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-ANNOSETT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTINISET
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTFINSET
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTINIMES
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTFINMES
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 14 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000122                                                                  
000123     IF SQLCODE EQUAL 0                                           
000124        MOVE '****'              TO DTGG-RETUCODE                 
000125        MOVE A973-DTGIORNO       TO DTGG-DTGIORNO                 
000126        MOVE A973-PRGIORNO       TO DTGG-PRGIORNO                 
000127        MOVE A973-NUMSETTI       TO DTGG-NUMSETTI                 
000128        MOVE A973-NUMGIORN       TO DTGG-NUMGIORN                 
000129        MOVE A973-NRGGSETT       TO DTGG-NRGGSETT                 
000130        MOVE A973-DTINISET       TO DTGG-DTINISET                 
000131        MOVE A973-DTFINSET       TO DTGG-DTFINSET                 
000132        MOVE A973-DTINIMES       TO DTGG-DTINIMES                 
000133        MOVE A973-DTFINMES       TO DTGG-DTFINMES                 
000134        MOVE A973-ANNOSETT       TO DTGG-ANNOSETT                 
000135     ELSE                                                         
000136        IF SQLCODE EQUAL 100                                      
000137           MOVE 'MRNF'           TO DTGG-RETUCODE                 
000138        ELSE                                                      
000139           MOVE 'ERRO'           TO DTGG-RETUCODE.                
000140                                                                  
000141 SRDTGG-A20-EX. EXIT.                                            
000142                                                                  
000143*---------------------------------------------------------------* 
000144 SRDTGG-A30-CALCOLO-PROGRES.                                      
000145*---------------------------------------------------------------* 
000146                                                                  
000147     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
000148     MOVE 'DATARIO'              TO WCOM-FILENOME.                
000149     MOVE 'DB2 '                 TO WCOM-CODABEND.                
000150     MOVE 'ERRORE IN SRDTGG-A30' TO WCOM-MESSAGES.                
000151                                                                  
000153     
      *EXEC SQL 
      *SELECT DTGIORNO, PRGIORNO, NUMGIORN                     
000154*                ,NUMSETTI, NRGGSETT, ANNOSETT                     
000155*                ,DTINISET, DTFINSET                               
000156*                ,DTINIMES, DTFINMES                               
000157*            INTO :A973-DTGIORNO, :A973-PRGIORNO, :A973-NUMGIORN   
000158*                ,:A973-NUMSETTI, :A973-NRGGSETT, :A973-ANNOSETT   
000159*                ,:A973-DTINISET, :A973-DTFINSET                   
000160*                ,:A973-DTINIMES, :A973-DTFINMES                   
000161*            FROM DANAGRAF.TDATARIO                                
000162*           WHERE PRGIORNO = :A973-PRGIORNO                        
000163*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 28 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-PRGIORNO
            BY VALUE 0
                     0

           MOVE 29 TO SQL-STMT-ID 
           MOVE 10 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTGIORNO
            BY VALUE 0
                     0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-PRGIORNO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NUMGIORN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NUMSETTI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NRGGSETT
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-ANNOSETT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTINISET
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTFINSET
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTINIMES
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTFINMES
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 15 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000164                                                                  
000165     IF SQLCODE EQUAL 0                                           
000166        MOVE '****'              TO DTGG-RETUCODE                 
000167        MOVE A973-DTGIORNO       TO DTGG-DTGIORNO                 
000168        MOVE A973-PRGIORNO       TO DTGG-PRGIORNO                 
000169        MOVE A973-NUMSETTI       TO DTGG-NUMSETTI                 
000170        MOVE A973-NUMGIORN       TO DTGG-NUMGIORN                 
000171        MOVE A973-NRGGSETT       TO DTGG-NRGGSETT                 
000172        MOVE A973-DTINISET       TO DTGG-DTINISET                 
000173        MOVE A973-DTFINSET       TO DTGG-DTFINSET                 
000174        MOVE A973-DTINIMES       TO DTGG-DTINIMES                 
000175        MOVE A973-DTFINMES       TO DTGG-DTFINMES                 
000176        MOVE A973-ANNOSETT       TO DTGG-ANNOSETT                 
000177     ELSE                                                         
000178        IF SQLCODE EQUAL 100                                      
000179           MOVE 'MRNF'           TO DTGG-RETUCODE                 
000180        ELSE                                                      
000181           MOVE 'ERRO'           TO DTGG-RETUCODE.                
000182                                                                  
000183 SRDTGG-A30-EX. EXIT.                                            
000184*--------------------------------------------------------------*  
      *<<((file: SRDTGG))
003926*----------------------------------------------------------------*
003927*COPY DCWTSTRP.                                                   
003928*------------------------------------- -------------------------* 
003929*                    --- DCWTSTRp ---                           * 
003930*                GESTIONE DATI PER RICICLO.                     * 
003931*---------------------------------------------------------------* 
003932 LEGGO-RICICLO.                                                   
003933                                                                  
003934* EXEC CICS HANDLE CONDITION ITEMERR (LEGGO-RICICLO-EX)           
003935*                           QIDERR  (LEGGO-RICICLO-EX)            
003936*END-EXEC.                                                        
003937*    MOVE '"$<N                  ! & #00003612' TO DFHEIV0        
003938     MOVE X'22243C4E2020202020202020' &                           
003939          X'202020202020202020202120' &                           
003940          X'2620233030303033363132' TO DFHEIV0                    
003941     CALL 'kxdfhei1' USING DFHEIV0                                
003942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003943                                                                  
003944*    CALL 'DFHEI1' USING DFHEIV0                                  
003945*     SERVICE LABEL                                               
003946*     GO TO  LEGGO-RICICLO-EX LEGGO-RICICLO-EX DEPENDING ON       
003947*    DFHEIGDI.                                                    
003948     MOVE  1                     TO TSTR-ITEMXXXX.                
003949     MOVE EIBTRNID               TO TSTR-NOMETRAN.                
003950     MOVE EIBTRMID               TO TSTR-NOMETERM.                
003951                                                                  
003952* EXEC CICS READQ  TS QUEUE   (TSTR-NOMECODA)                     
003953*                    INTO    (TSTR-AREATSTR)                      
003954*                    ITEM    (TSTR-ITEMXXXX)                      
003955*                    LENGTH  (TSTR-LENGCODA)                      
003956*END-EXEC.                                                        
003957*    MOVE '*$II   L              ''   #00003622' TO DFHEIV0       
003958     MOVE X'2A2449492020204C20202020' &                           
003959          X'202020202020202020202720' &                           
003960          X'2020233030303033363232' TO DFHEIV0                    
003961     CALL 'kxdfhei1' USING DFHEIV0,                               
003962           TSTR-NOMECODA,                                         
003963           TSTR-AREATSTR,                                         
003964           TSTR-LENGCODA,                                         
003965           TSTR-ITEMXXXX,                                         
003966           DFHEIV99,                                              
003967           DFHEIV99                                               
003968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003969                                                                  
003970*    CALL 'DFHEI1' USING DFHEIV0  TSTR-NOMECODA TSTR-AREATSTR     
003971*    TSTR-LENGCODA DFHDUMMY TSTR-ITEMXXXX.                        
003972     MOVE TSTR-AREATSTR          TO WCOM-AREAXXXX.                
003973                                                                  
003974* EXEC CICS DELETEQ TS QUEUE  (TSTR-NOMECODA)                     
003975*                     NOHANDLE                                    
003976*END-EXEC.                                                        
003977*    MOVE '*&                    #  N#00003630' TO DFHEIV0        
003978     MOVE X'2A2620202020202020202020' &                           
003979          X'202020202020202020202320' &                           
003980          X'204E233030303033363330' TO DFHEIV0                    
003981     CALL 'kxdfhei1' USING DFHEIV0,                               
003982           TSTR-NOMECODA,                                         
003983           DFHEIV99                                               
003984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003985                                                                  
003986*    CALL 'DFHEI1' USING DFHEIV0  TSTR-NOMECODA.                  
003987 LEGGO-RICICLO-EX. EXIT.                                          
003988 SCRIVO-RICICLO.                                                  
003989     MOVE WCOM-AREAXXXX          TO TSTR-AREATSTR.                
003990     MOVE  1                     TO TSTR-ITEMXXXX.                
003991     MOVE EIBTRNID               TO TSTR-NOMETRAN.                
003992     MOVE EIBTRMID               TO TSTR-NOMETERM.                
003993                                                                  
003994* EXEC CICS DELETEQ TS QUEUE  (TSTR-NOMECODA)                     
003995*                     NOHANDLE                                    
003996*END-EXEC.                                                        
003997*    MOVE '*&                    #  N#00003640' TO DFHEIV0        
003998     MOVE X'2A2620202020202020202020' &                           
003999          X'202020202020202020202320' &                           
004000          X'204E233030303033363430' TO DFHEIV0                    
004001     CALL 'kxdfhei1' USING DFHEIV0,                               
004002           TSTR-NOMECODA,                                         
004003           DFHEIV99                                               
004004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
004005                                                                  
004006*    CALL 'DFHEI1' USING DFHEIV0  TSTR-NOMECODA.                  
004007                                                                  
004008* EXEC CICS WRITEQ TS  QUEUE  (TSTR-NOMECODA)                     
004009*                     FROM   (TSTR-AREATSTR)                      
004010*                     ITEM   (TSTR-ITEMXXXX)                      
004011*                     LENGTH (TSTR-LENGCODA)                      
004012*END-EXEC.                                                        
004013*    MOVE '*" I   L              ''   #00003644' TO DFHEIV0       
004014     MOVE X'2A2220492020204C20202020' &                           
004015          X'202020202020202020202720' &                           
004016          X'2020233030303033363434' TO DFHEIV0                    
004017     CALL 'kxdfhei1' USING DFHEIV0,                               
004018           TSTR-NOMECODA,                                         
004019           TSTR-AREATSTR,                                         
004020           TSTR-LENGCODA,                                         
004021           TSTR-ITEMXXXX,                                         
004022           DFHEIV99,                                              
004023           DFHEIV99                                               
004024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
004025                                                                  
004026*    CALL 'DFHEI1' USING DFHEIV0  TSTR-NOMECODA TSTR-AREATSTR     
004027*    TSTR-LENGCODA DFHDUMMY TSTR-ITEMXXXX.                        
004028 SCRIVO-RICICLO-EX. EXIT.                                         
004029*---------------------------------------------------------------* 
004030*COPY DCPERDB2.                                                   
004031*SRERCICS/P---------S = SOURCE / P = PRECOMPILED ----------------*
004032*----*  ROUTINE INTERCETTA ERRORE CICS                      *----*
004033*----*                                                      *----*
004034*----------------------------------------------------------------*
004035*       QUESTA ROUTINE E' LA PRIMA DA DICHIARARE COME COPY        
004036*----*                                                      *----*
004037*----------------------------------------------------------------*
004038*    ES.    **                                                    
004039*    ES.         COPY SRERCICP.                                   
004040*    ES.    **   SE VOGLIO INTERCETTARE ERRORE DB2                
004041*    ES.         COPY SRERDB2P                                    
004042*    ES.    **   SE VOGLIO INTERCETTARE ERRORE TOTAL              
004043*    ES.         COPY SRERDB2P                                    
004044*    ES.    **  ETC.                                              
004045*    ES.                                                          
004046*    ES.    **   ULTIMA ROUTINE CHE RILASCIA TR-ERRE  PER DECODI  
004047*    ES.    **   ERRORE                                           
004048*    ES.         COPY SRERENDS                                    
004049*                                                                 
004050*----------------------------------------------------------------*
004051 Z00-ERRORE.                                                      
004052*----------------------------------------------------------------*
004053     MOVE DFHEIV0                TO T-COMLINE.                    
004054     PERFORM                                                      
004055        VARYING INDERR FROM 1 BY 1                                
004056            UNTIL INDERR GREATER 25                               
004057               OR EL-COMLINE (INDERR) EQUAL ZERO                  
004058     END-PERFORM.                                                 
004059     MOVE SPACES                 TO WLINEAXX.                     
004060     IF INDERR LESS 26                                            
004061        MOVE EL-COMLINE (INDERR) TO EL-LINE (1)                   
004062        ADD 1                    TO INDERR                        
004063        MOVE EL-COMLINE (INDERR) TO EL-LINE (2)                   
004064        ADD 1                    TO INDERR                        
004065        MOVE EL-COMLINE (INDERR) TO EL-LINE (3)                   
004066        ADD 1                    TO INDERR                        
004067        MOVE EL-COMLINE (INDERR) TO EL-LINE (4)                   
004068        ADD 1                    TO INDERR                        
004069        MOVE EL-COMLINE (INDERR) TO EL-LINE (5).                  
004070     MOVE WLINEAXX               TO WCOM-PRGMLINE.                
004071     MOVE EIBFN                  TO WCOM-CODEIBFN.                
004072     MOVE EIBRCODE               TO WCOM-CODERCOD.                
004073     MOVE SPACES                 TO WCOM-ABENCICS.                
004074     IF EIBRESP  NOT = ZERO OR                                    
004075        EIBRESP2 NOT = ZERO                                       
004076                                                                  
004077* EXEC CICS                                                       
004078*      ASSIGN ABCODE (WCOM-ABENCICS)                              
004079*END-EXEC.                                                        
004080*    MOVE '"((                   "   #00003699' TO DFHEIV0        
004081     MOVE X'222828202020202020202020' &                           
004082          X'202020202020202020202220' &                           
004083          X'2020233030303033363939' TO DFHEIV0                    
004084     CALL 'kxdfhei1' USING DFHEIV0,                               
004085           WCOM-ABENCICS                                          
004086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
004087                                                                  
004088*       CALL 'DFHEI1' USING DFHEIV0  WCOM-ABENCICS.               
004089*SRERDB2S/P -----------------------------------------------------*
004090*----*  ROUTINE INTERCETTA ERRORE DB2                       *----*
004091*----*                                                      *----*
004092*----------------------------------------------------------------*
004093*       QUESTA ROUTINE E' DA DICHIARARE DOPO LA SRERCICS          
004094*                                                                 
004095     MOVE 'ABEN'                 TO WCOM-CODATSX1.                
004096     MOVE EIBTRMID               TO WCOM-CODATSX2.                
004097*    MOVE LENGTH OF SQLCA        TO WCOM-LUNGHERR.                
004098     MOVE 136                    TO WCOM-LUNGHERR.                
004099                                                                  
004100* EXEC CICS WRITEQ TS    QUEUE  (WCOM-CODATSXX)                   
004101*                       FROM   (SQLCA)                            
004102*                       LENGTH (WCOM-LUNGHERR)                    
004103*END-EXEC.                                                        
004104*    MOVE '*"     L              ''   #00003713' TO DFHEIV0       
004105     MOVE X'2A2220202020204C20202020' &                           
004106          X'202020202020202020202720' &                           
004107          X'2020233030303033373133' TO DFHEIV0                    
004108     CALL 'kxdfhei1' USING DFHEIV0,                               
004109           WCOM-CODATSXX,                                         
004110           SQLCA,                                                 
004111           WCOM-LUNGHERR,                                         
004112           DFHEIV99,                                              
004113           DFHEIV99,                                              
004114           DFHEIV99                                               
004115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
004116                                                                  
004117*    CALL 'DFHEI1' USING DFHEIV0  WCOM-CODATSXX SQLCA             
004118*    WCOM-LUNGHERR.                                               
004119*SRERENDS/P------------------------------------------------------*
004120*----*  ROUTINE FINALE                                      *----*
004121*----*                                                      *----*
004122*----------------------------------------------------------------*
004123*       QUESTA ROUTINE DA DICHIARARE PER ULTIMA NELLA SEQUNZA     
004124*       DELLE COPY  PER INTERCETTARE L'ERRORE                     
004125*----------------------------------------------------------------*
004126*----------------------------------------------------------------*
004127      MOVE EIBTRNID              TO WCOM-TRANSAZI.                
004128                                                                  
004129* EXEC CICS SYNCPOINT ROLLBACK                                    
004130*END-EXEC.                                                        
004131*    MOVE '6"R                   !   #00003728' TO DFHEIV0        
004132     MOVE X'362252202020202020202020' &                           
004133          X'202020202020202020202120' &                           
004134          X'2020233030303033373238' TO DFHEIV0                    
004135     CALL 'kxdfhei1' USING DFHEIV0                                
004136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
004137                                                                  
004138*     CALL 'DFHEI1' USING DFHEIV0.                                
004139                                                                  
004140* EXEC CICS ASSIGN SYSID (WCOM-SYSID)                             
004141*END-EXEC.                                                        
004142*    MOVE '"(         $          "   #00003731' TO DFHEIV0        
004143     MOVE X'222820202020202020202024' &                           
004144          X'202020202020202020202220' &                           
004145          X'2020233030303033373331' TO DFHEIV0                    
004146     CALL 'kxdfhei1' USING DFHEIV0,                               
004147           WCOM-SYSID                                             
004148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
004149                                                                  
004150*     CALL 'DFHEI1' USING DFHEIV0  WCOM-SYSID.                    
004151      MOVE 'ABEN'                    TO WCOM-CODATSX1.            
004152      MOVE EIBTRMID                  TO WCOM-CODATSX2.            
004153*     MOVE LENGTH OF WCOM-AREA-ERROR TO WCOM-LUNGHERR.            
004154      MOVE 200                       TO WCOM-LUNGHERR.            
004155*EXEC CICS WRITEQ TS QUEUE  (WCOM-CODATSXX)                       
004156                                                                  
004157* EXEC CICS WRITEQ TS                                             
004158*                    QUEUE  (WCOM-CODATSXX)                       
004159*                    FROM   (WCOM-AREA-ERROR)                     
004160*                    LENGTH (WCOM-LUNGHERR)                       
004161*END-EXEC.                                                        
004162*    MOVE '*"     L              ''   #00003739' TO DFHEIV0       
004163     MOVE X'2A2220202020204C20202020' &                           
004164          X'202020202020202020202720' &                           
004165          X'2020233030303033373339' TO DFHEIV0                    
004166     CALL 'kxdfhei1' USING DFHEIV0,                               
004167           WCOM-CODATSXX,                                         
004168           WCOM-AREA-ERROR,                                       
004169           WCOM-LUNGHERR,                                         
004170           DFHEIV99,                                              
004171           DFHEIV99,                                              
004172           DFHEIV99                                               
004173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
004174                                                                  
004175*     CALL 'DFHEI1' USING DFHEIV0  WCOM-CODATSXX WCOM-AREA-ERROR  
004176*    WCOM-LUNGHERR.                                               
004177                                                                  
004178* EXEC CICS START TRANSID ('ERRE')                                
004179*                FROM    (WCOM-AREAXXXX)                          
004180*                LENGTH  (WCOM-LUNGHEZZ)                          
004181*                TERMID  (EIBTRMID)                               
004182*END-EXEC.                                                        
004183     MOVE 'ERRE' TO DFHEIV5                                       
004184*    MOVE '0( LFT                1   #00003746' TO DFHEIV0        
004185     MOVE X'3028204C4654202020202020' &                           
004186          X'202020202020202020203120' &                           
004187          X'2020233030303033373436' TO DFHEIV0                    
004188     CALL 'kxdfhei1' USING DFHEIV0,                               
004189           DFHEIV99,                                              
004190           DFHEIV5,                                               
004191           DFHEIV99,                                              
004192           WCOM-AREAXXXX,                                         
004193           WCOM-LUNGHEZZ,                                         
004194           EIBTRMID,                                              
004195           DFHEIV99,                                              
004196           DFHEIV99,                                              
004197           DFHEIV99,                                              
004198           DFHEIV99,                                              
004199           DFHEIV99,                                              
004200           DFHEIV99,                                              
004201           DFHEIV99,                                              
004202           DFHEIV99,                                              
004203           DFHEIV99,                                              
004204           DFHEIV99                                               
004205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
004206                                                                  
004207*      MOVE 'ERRE' TO DFHC0040                                    
004208*     CALL 'DFHEI1' USING DFHEIV0  DFHEID0 DFHDUMMY DFHC0040      
004209*    WCOM-AREAXXXX WCOM-LUNGHEZZ EIBTRMID.                        
004210                                                                  
004211* EXEC CICS ABEND ABCODE (WCOM-ABENCICS)                          
004212*                CANCEL                                           
004213*END-EXEC.                                                        
004214*    MOVE '.,AC                  "   #00003754' TO DFHEIV0        
004215     MOVE X'2E2C41432020202020202020' &                           
004216          X'202020202020202020202220' &                           
004217          X'2020233030303033373534' TO DFHEIV0                    
004218     CALL 'kxdfhei1' USING DFHEIV0,                               
004219           WCOM-ABENCICS                                          
004220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
004221                                                                  
004222*     CALL 'DFHEI1' USING DFHEIV0  WCOM-ABENCICS.                 
004223 Z00-EX. EXIT.                                                    
004224*----------------------------------------------------------------*
004225                                                                  
004226 9999-DFHBACK SECTION.                                            
004227     MOVE '9%                    "   ' TO DFHEIV0                 
004228     MOVE 'AVTLO24' TO DFHEIV1                                    
004229     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1                        
004230     GOBACK.                                                      
004231 9999-DFHEXIT.                                                    
004232     IF DFHEIGDJ EQUAL 0001                                       
004233         NEXT SENTENCE                                            
004234     ELSE IF DFHEIGDJ EQUAL 2                                     
004235         GO TO Z00-ERRORE                                         
004236         DEPENDING ON DFHEIGDI                                    
004237     ELSE IF DFHEIGDJ EQUAL 3                                     
004238         GO TO B05-NORESP                                         
004239         DEPENDING ON DFHEIGDI                                    
004240     ELSE IF DFHEIGDJ EQUAL 4                                     
004241         GO TO R00-EX,                                            
004242               R00-EX                                             
004243         DEPENDING ON DFHEIGDI                                    
004244     ELSE IF DFHEIGDJ EQUAL 5                                     
004245         GO TO R10-EX,                                            
004246               R10-EX                                             
004247         DEPENDING ON DFHEIGDI                                    
004248     ELSE IF DFHEIGDJ EQUAL 6                                     
004249         GO TO LEGGO-RICICLO-EX,                                  
004250               LEGGO-RICICLO-EX                                   
004251         DEPENDING ON DFHEIGDI.                                   
004252     MOVE '9%                    "   ' TO DFHEIV0                 
004253     MOVE 'AVTLO24' TO DFHEIV1                                    
004254     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1                        
004255     GOBACK.                                                      
