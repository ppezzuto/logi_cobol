      *((program: AVTLO50.cblx))
000001*-------------* PROGRAMMA  CICS/DB2 COBOL2 *--------------------* 
000002 ID  DIVISION.                                                    
000003*-------------*                                                   
000004 PROGRAM-ID. AVTLO50.                             
000005*---------------------------------------------------------------* 
000006*               GESTIONE LISTINI LOGISTICA                      * 
000007*---------------------------------------------------------------* 
000008*  IL PROGRAMMA GESTISCE I LISTINI PER  SERVIZI DI LOGISTICA    * 
000009*                                                               * 
000010*  OPERAZIONI IN RIGA:                                          * 
000011*  - V -   PER VARIARE UN LISTINO                               * 
000012*  - / -   PER CANELLARE UN LISTINO                             * 
000013*  - I -   PER INSERIRE UN LISTINO                              * 
000014*---------------------------------------------------------------* 
000015 ENVIRONMENT DIVISION.                                            
000016*---------------------*                                           
000017 CONFIGURATION SECTION.                                           
000018 SPECIAL-NAMES.                                                   
000019     DECIMAL-POINT IS COMMA.                                      
000020 DATA DIVISION.                                                   
000021*--------------*                                                  
000022 WORKING-STORAGE SECTION.

       01  SQLDA-ID pic 9(4) comp-5.
       01  SQLDSIZE pic 9(4) comp-5.
       01  SQL-STMT-ID pic 9(4) comp-5.
       01  SQLVAR-INDEX pic 9(4) comp-5.
       01  SQL-DATA-TYPE pic 9(4) comp-5.
       01  SQL-HOST-VAR-LENGTH pic 9(9) comp-5.
       01  SQL-S-HOST-VAR-LENGTH pic 9(9) comp-5.
       01  SQL-S-LITERAL pic X(258).
       01  SQL-LITERAL1 pic X(130).
       01  SQL-LITERAL2 pic X(130).
       01  SQL-LITERAL3 pic X(130).
       01  SQL-LITERAL4 pic X(130).
       01  SQL-LITERAL5 pic X(130).
       01  SQL-LITERAL6 pic X(130).
       01  SQL-LITERAL7 pic X(130).
       01  SQL-LITERAL8 pic X(130).
       01  SQL-LITERAL9 pic X(130).
       01  SQL-LITERAL10 pic X(130).
       01  SQL-IS-LITERAL pic 9(4) comp-5 value 1.
       01  SQL-IS-INPUT-HVAR pic 9(4) comp-5 value 2.
       01  SQL-CALL-TYPE pic 9(4) comp-5.
       01  SQL-SECTIONUMBER pic 9(4) comp-5.
       01  SQL-INPUT-SQLDA-ID pic 9(4) comp-5.
       01  SQL-OUTPUT-SQLDA-ID pic 9(4) comp-5.
       01  SQLA-PROGRAM-ID.
           05 SQL-PART1 pic 9(4) COMP-5 value 172.
           05 SQL-PART2 pic X(6) value "AEAQAI".
           05 SQL-PART3 pic X(24) value "BALEMfFn01111 2         ".
           05 SQL-PART4 pic 9(4) COMP-5 value 8.
           05 SQL-PART5 pic X(8) value "DB2XMT  ".
           05 SQL-PART6 pic X(120) value LOW-VALUES.
           05 SQL-PART7 pic 9(4) COMP-5 value 8.
           05 SQL-PART8 pic X(8) value "AVTLO50 ".
           05 SQL-PART9 pic X(120) value LOW-VALUES.
                                                                        
000023 01  DFH-START PIC X(04).                                         
000024 01  FILLER                      PIC X(08) VALUE 'DCWCOMMA'.      
000025*    COPY DCWCOMMA.                                               
000026*---------------------------------------------------------------* 
000027*----*            AREA DI PASSAGGIO DATI - WWTERRE         *----* 
000028*---------------------------------------------------------------* 
000029 01  WCOM-LUNGHERR                PIC S9(4) COMP VALUE +200.      
000030 01  WCOM-AREA-ERROR.                                             
000031     02 FILLER                    PIC X(8) VALUE 'CICSERRO'.      
000032     02 WCOM-FILEMESG.                                            
000033        04 WCOM-FILEFUNZ          PIC X(10).                      
000034        04 WCOM-FILESTAT          PIC X(5).                       
000035        04 WCOM-SQLCODEX REDEFINES WCOM-FILESTAT                  
000036                                  PIC -Z(4).                      
000037        04 WCOM-FILENOME          PIC X(30).                      
000038        04 WCOM-FILECTR1.                                         
000039           05 WCOM-FILECTRL       PIC X(35).                      
000040     02 WCOM-MESSAGE1 REDEFINES WCOM-FILEMESG.                    
000041        05 WCOM-MESSAGES          PIC X(80).                      
000042     02 WCOM-CODABEND             PIC X(4).                       
000043     02 WCOM-ABENCICS             PIC X(4).                       
000044     02 WCOM-PRGMLINE             PIC X(5)  VALUE SPACES.         
000045     02 WCOM-CODEIBFN             PIC X(2).                       
000046     02 WCOM-CODERCOD             PIC X(6).                       
000047     02 FILLER                    PIC X(91).                      
000048*---------------------------------------------------------------* 
000049*----*                AREA DI COMMAREA                     *----* 
000050*---------------------------------------------------------------* 
000051*---------------------- LUNGHEZZA WCOM-AREAXXXX                   
000052 01  WCOM-LUNGHEZZ                     PIC S9(4) COMP VALUE +300. 
000053*---------------------- NOME DEL PROGRAMMA                        
000054 01  WCOM-AREAXXXX.                                               
000055     05  WCOM-NOMEPRGM                 PIC X(8)  VALUE SPACES.    
000056*---------------------- PAGINA RICHIESTA                          
000057     05  WCOM-PAGIRICH                 PIC S9(5) COMP-3.          
000058*---------------------- PAGINA LISTATA                            
000059     05  WCOM-PAGILIST                 PIC S9(5) COMP-3.          
000060*---------------------- PAGINA ULTIMA                             
000061     05  WCOM-PAGIULTI                 PIC S9(5) COMP-3.          
000062*---------------------- FLAG PER MODULO GESTIONE FUNZIONI ESTERNE 
000063     05  WCOM-FLAGFUNZ.                                           
000064         10  WCOM-RETURNXX             PIC X(1).                  
000065         10  WCOM-DELETETS             PIC X(1).                  
000066         10  WCOM-CODILING             PIC X(1).                  
000067*---------------------- FLAG PER AGGIORNAMENTI                    
000068     05  WCOM-FLAGPRGM                 PIC X(1)  VALUE SPACES.    
000069*---------------------- SOTTOSISTEMA CICS                         
000070     05  WCOM-SYSID                    PIC X(4)  VALUE '????'.    
000071*---------------------- PRINTER ABBINATA CON 'P'                  
000072     05  WCOM-PRINTERX                 PIC X(4).                  
000073*---------------------- PRINTER ASSOCIATA MAG. FINITI             
000074     05  WCOM-PRINTERY                 PIC X(4).                  
000075*---------------------- PRINTER ASSOCIATA ALLA TRANSAZIONE        
000076     05  WCOM-PRINTERT                 PIC X(4).                  
000077*---------------------- PRINTER BAR-CODE O MODULI SPECIALI        
000078     05  WCOM-PRINTERB                 PIC X(4).                  
000079*---------------------- TRANSAZIONE                               
000080     05  WCOM-TRANSAZI                 PIC X(4).                  
000081*---------------------- DATA DEL GIORNO DA MENU'                  
000082     05  WCOM-DATAXXXX.                                           
000083         10  WCOM-DATAGGXX             PIC X(2).                  
000084         10  WCOM-DATAGGXN REDEFINES WCOM-DATAGGXX  PIC 9(2).     
000085         10  WCOM-BARRAUNO             PIC X(1).                  
000086         10  WCOM-DATAMMXX             PIC X(2).                  
000087         10  WCOM-DATAMMXN REDEFINES WCOM-DATAMMXX  PIC 9(2).     
000088         10  WCOM-BARRADUE             PIC X(1).                  
000089         10  WCOM-DATAAAXX.                                       
000090             15 WCOM-DATAAAX1          PIC 9(1).                  
000091             15 WCOM-DATAAAX2          PIC 9(1).                  
000092         10  WCOM-DATAAAXN REDEFINES WCOM-DATAAAXX  PIC 9(2).     
000093*---------------------- NOME DELLA CODA TS GENERICA               
000094     05  WCOM-CODATSXX.                                           
000095         10 WCOM-CODATSX1              PIC X(4)  VALUE SPACES.    
000096         10 WCOM-CODATSX2              PIC X(4)  VALUE SPACES.    
000097*---------------------- DATA DEL GIORNO                           
000098     05  WCOM-DTCREAZI.                                           
000099         10 WCOM-DTCREAZI-SY.                                     
000100            15 WCOM-DTCREAZI-SS        PIC X(2).                  
000101            15 WCOM-DTCREAZI-YY        PIC X(2).                  
000102         10 WCOM-DTCREAZI-SYN REDEFINES WCOM-DTCREAZI-SY PIC 9(4).
000103         10 WCOM-DTCREAZI-MM           PIC X(2).                  
000104         10 WCOM-DTCREAZI-DD           PIC X(2).                  
000105*---------------------- CODICE UTENTE                             
000106     05  WCOM-UTENCICS                 PIC X(6).                  
000107*---------------------- TRANSAZIONI NELL' AMBITO DELLA RICHIESTA  
000108     05  WCOM-INDITRAN                 PIC 9(2).                  
000109     05  WCOM-TABETRAN.                                           
000110         10  WCOM-MENUTRAN  OCCURS 10  PIC X(4).                  
000111         10  WCOM-PAGITRAN  OCCURS 10  PIC S9(5) COMP-3.          
000112*---------------------- FLAG AVVISI UTENTI/TRANSAZIONI DA SCTUTENT
000113     05  WCOM-FLAGUTEN                 PIC X(1).                  
000114     05  WCOM-FLAGTRAN                 PIC X(1).                  
000115*---------------------- FLAG UTENTI LIMITATI                      
000116     05  WCOM-FLAGLIMI                 PIC X(1).                  
000117*---------------------- LIBERI                                    
000118     05  FILLER                        PIC X(25).                 
000119*---------------------- RICHIESTA                                 
000120     05  WCOM-RIKIESTA.                                           
000121         10   WCOM-COMODOXX            PIC X(125).                
000122*    COPY DCLOGI.                                                 
000123******************************************************************
000124*                        *** DCLOGI ***                          *
000125*     DSECT RELATIVA ALLA COMMAREA DEGLI ORDINI DI LOGISTICA     *
000126*                    - LUNGHEZZA 175 BYTES -                     *
000127******************************************************************
000128         10  FILLER                           PIC X(200).         
000129     05  WORK-RICHIESTA REDEFINES WCOM-RIKIESTA.                  
000130         10  WCOM-DCLOGI.                                         
000131             15  WCOM-CODUTENT                PIC X(06).          
000132             15  WCOM-CODSOCIE                PIC X(02).          
000133             15  WCOM-CDDIVISI                PIC X(01).          
000134             15  WCOM-CODDEPOS                PIC X(02).          
000135             15  WCOM-CODCLIEN                PIC X(05).          
000136             15  WCOM-CLIFOCON                PIC X(05).          
000137             15  WCOM-CODSERVI                PIC X(06).          
000138             15  WCOM-TIPSERVI                PIC X(01).          
000139             15  WCOM-CODDIVIS                PIC X(02).          
000140             15  WCOM-UNMISURA                PIC X(02).          
000141             15  WCOM-AANUMORD                PIC X(08).          
000142             15  WCOM-NRRIGORD                PIC S9(3)  COMP-3.  
000143             15  WCOM-CONTODCE                PIC X(06).          
000144             15  WCOM-SALDATOX                PIC X(01).          
000145             15  WCOM-OPERAZIO                PIC X(01).          
000146             15  WCOM-DECIDIVI                PIC X(01).          
000147             15  WCOM-CONTOPER                PIC S9(5)  COMP-3.  
000148             15  WCOM-CODERROR                PIC X(05).          
000149             15  WCOM-FLAGAUTO                PIC X(01).          
000150             15  WCOM-SOCIEMER                PIC X(02).          
000151             15  WCOM-TIPOARTI                PIC X(01).          
000152             15  WCOM-PAESPROV                PIC X(03).          
000153             15  WCOM-PAESMERC                PIC X(03).          
000154             15  WCOM-DTCARORD                PIC X(08).          
000155             15  WCOM-FLAGMANU                PIC X(01).          
000156             15  WCOM-FLAGGIVA                PIC X(01).          
000157             15  WCOM-TIPORECO                PIC X(04).          
000158             15  WCOM-AANUMFAT                PIC X(08).          
000159             15  WCOM-DTFATTUR                PIC X(08).          
000160             15  WCOM-NRPREATT                PIC X(18).          
000161             15  WCOM-DTPREATT                PIC X(08).          
000162             15  WCOM-STATUSXX                PIC X(01).          
000163             15  WCOM-AAMMCOMP                PIC X(06).          
000164             15  WCOM-CENCOSTD                PIC X(05).          
000165             15  WCOM-CENCOSTA                PIC X(05).          
000166             15  WCOM-ESENTIVA                PIC X(01).          
000167             15  FILLER                       PIC X(32).          
000168*--------------------------------------------------------------*  
000169     10  WCOM-DATIPROG.                                           
000170         15 WCOM-RAGFATTU        PIC X(24).                       
000171         15 WCOM-RAGFATT2        PIC X(24).                       
000172         15 WCOM-DTINILIS        PIC X(06).                       
000173         15 WCOM-DTFINLIS        PIC X(06).                       
000174         15 WCOM-CODSOCI1        PIC X(02).                       
000175         15 WCOM-CAMBIODT        PIC X(01).                       
000176         15 FILLER               PIC X(87).                       
000177 01  FILLER                      PIC X(08)  VALUE 'DCWWORK1'.     
000178*    COPY DCWWORK1.                                               
000179***************************************************************** 
000180******            DATI DI USO GENERALE      (DCWWORK1)     ****** 
000181***************************************************************** 
000182 01  DCW-WORK1.                                                   
000183*----------------- NOME MAPPA CON GESTIONE CODICE LINGUA          
000184     05 WNOMEMAP.                                                 
000185        10  FILLER                     PIC X(2).                  
000186        10  WCODLING                   PIC X.                     
000187        10  FILLER                     PIC X(4).                  
000188*----------------- COMODO LINEA CONTENENTE L'ULTIMO EXEC CICS     
000189     05 WLINEAXX.                                                 
000190        10  EL-LINE    OCCURS 5        PIC X.                     
000191*----------------- COMODO CONTENENTE DFHEIV0                      
000192     05 T-COMLINE.                                                
000193        10  EL-COMLINE OCCURS 29       PIC X.                     
000194*----------------- INDICE PER SCORRERE LA T-COMLINE.              
000195     05 INDERR                         PIC S9(5) COMP-3 VALUE +0. 
000196*----------------- TRANSAZIONE IMPOSTATA AL MOMENTO DEL PF5 / PF4 
000197     05 WTRANSID                       PIC X(4) VALUE SPACES.     
000198*----------------- INDICE DELLA RIGA DI MAPPA                     
000199     05 WINDRIGA                       PIC S9(3) COMP-3 VALUE +0. 
000200*----------------- NUMERO MASSIMO DI RIGHE IN UNA MAPPA           
000201     05 WNUMRIGA                       PIC 9(2)        VALUE 0.   
000202*----------------- FLAG PER GLI ERRORI A LIVELLO DI DATI-MAPPA    
000203     05 WSWERROR                       PIC X      VALUE SPACES.   
000204        88 ERRORE                                 VALUE '*'.      
000205*----------------- NUMERO PAGINA RICHIESTO                        
000206     05 WPAGRICH                       PIC S9(5) COMP-3 VALUE +0. 
000207*----------------- NUMERO RECORD CODA-TS                          
000208     05 WNUMITEM                       PIC S9(4) COMP VALUE +0.   
000209*----------------- INDICE DELLA CODA DI PAGINAZIONE TS            
000210     05 WPAGIPAG                       PIC S9(4) COMP VALUE +0.   
000211*----------------- CHIAVE DELLA CODA DI PAGINAZIONE TS            
000212     05 WPAGCTRL.                                                 
000213        10  WPAGNOME                   PIC X(4)    VALUE 'PAGI'.  
000214        10  WPAGVIDE                   PIC X(4).                  
000215*----------------- LUNGHEZZA  CODA DI PAGINAZIONE TS              
000216     05 WPAGLPAG                       PIC S9(4) COMP VALUE +0.   
000217*----------------- ABSOLUTE TIME                                  
000218     05 WABSTIME                       PIC S9(15) COMP-3 VALUE +0.
000219*----------------- ABSOLUTE YEAR                                  
000220     05 WABSYEAR                       PIC S9(8) COMP VALUE +0.   
000221*----------------- FOR RESP OPTION                                
000222     05 WEIBRESP                       PIC S9(8) COMP VALUE +0.   
000223*----------------- FOR CVDA  (CICS VALUE DATA AREA)               
000224     05 WNOLOG                         PIC S9(8) COMP VALUE +0.   
000225     05 WCVDA                          PIC S9(8) COMP VALUE +0.   
000226     05 WCVDA-OPEN                     PIC S9(8) COMP VALUE +18.  
000227     05 WCVDA-CLOSED                   PIC S9(8) COMP VALUE +19.  
000228*----------------- FOR BIF DEEDIT                                 
000229     05 WWTWSNU                        PIC X(8) VALUE 'WWTWSNU'.  
000230     05 WLENGTH                        PIC S9(4) COMP.            
000231*----------------- AREA DELLA CODA TS DI PAGINAZIONE              
000232 01  WPAGREFE.                                                    
000233     05  FILLER                        PIC X    VALUE SPACES.     
000234     05  WPAGREF1 OCCURS 18.                                      
000235         15  WPAG-OPERAZIO       PIC X(01).                       
000236         15  WPAG-CODSERVI       PIC X(06).                       
000237         15  WPAG-DESSERVI       PIC X(40).                       
000238         15  WPAG-UNMISURA       PIC X(02).                       
000239         15  WPAG-PREZZLIS       PIC S9(07)V9(4) COMP-3.          
000240         15  WPAG-PERCLIST       PIC S9(03)V99   COMP-3.          
000241 01  WLO50-CODA.                                                  
000242     05 WLO50-TIPSERVI           PIC X(01).                       
000243     05 WLO50-CODSOCIE           PIC X(02).                       
000244     05 WLO50-WINDRIGA           PIC 9(02).                       
000245     05 WLO50-RIGA OCCURS 18.                                     
000246         10 WLO50-CODSERVI       PIC X(06).                       
000247         10 WLO50-DESSERVI       PIC X(40).                       
000248         10 WLO50-UNMISURA       PIC X(02).                       
000249         10 WLO50-PREZZLIS       PIC S9(07)V9(4) COMP-3.          
000250         10 WLO50-PERCLIST       PIC S9(03)V99   COMP-3.          
000251 01  FILLER                      PIC X(08) VALUE 'COMODI**'.      
000252 01  COMODI.                                                      
000253     05  WS-SQLCODE              PIC S9(5) COMP-3 VALUE +0.       
000254     05  WS-SQLCODE2             PIC S9(5) COMP-3 VALUE +0.       
000255     05  WS-OPERAZIO             PIC X(01)  VALUE SPACES.         
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000256     05  WS-DTFINLIS             PIC X(06)  VALUE SPACES.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000257     05  WS-PROGPREC             PIC X(08)  VALUE SPACES.         
000258     05  WS-IND1                 PIC S9(3) COMP-3 VALUE +0.       
000259     05  WS-IND2                 PIC S9(3) COMP-3 VALUE +0.       
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000260     05  WS-CODCLIEN             PIC X(05)  VALUE SPACES.         
000261     05  WS-RAGFATTU             PIC X(24)  VALUE SPACES.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000262     05  WS-RAGFATT2.                                             
000263         10 WS-BYTE2             PIC X OCCURS 24.                 
000264     05  WS-RAGFATT3.                                             
000265         10 WS-BYTE3             PIC X OCCURS 24.                 
000266     05 WPAGLO50.                                                 
000267        10 FILLER                PIC X(04)  VALUE 'SERV'.         
000268        10 WLO50-TERMINAL        PIC X(04).                       
000269     05 WLO50-LENGTH             PIC S9(4) COMP.                  
000270     05 WLO50-ITEM               PIC S9(4) COMP.                  
000271     05 WLO50-WNUMRIGA           PIC S9(5) COMP-3.                
000272*---------------------------------------------------------------- 
000273 01  FILLER                      PIC X(08) VALUE '*DFHAID*'.      
000274*    COPY DFHAID   SUPPRESS.                                      
000275***************************************************************** 
000276*                                                               * 
000277* Copyright (c) 2016-2022 NTT DATA, Inc.                        * 
000278* All rights reserved.                                          * 
000279*                                                               * 
000280***************************************************************** 
000281 01  DFHAID.                                                      
000282     02  DFHNULL   PIC X VALUE "-".                               
000283     02  DFHENTER  PIC X VALUE "'".                               
000284     02  DFHCLEAR  PIC X VALUE "_".                               
000285     02  DFHCLRP   PIC X VALUE "|".                               
000286     02  DFHPEN    PIC X VALUE "=".                               
000287     02  DFHOPID   PIC X VALUE "W".                               
000288     02  DFHMSRE   PIC X VALUE "X".                               
000289     02  DFHSTRF   PIC X VALUE "h".                               
000290     02  DFHTRIG   PIC X VALUE '"'.                               
000291     02  DFHPA1    PIC X VALUE "%".                               
000292     02  DFHPA2    PIC X VALUE ">".                               
000293     02  DFHPA3    PIC X VALUE ",".                               
000294     02  DFHPF1    PIC X VALUE "1".                               
000295     02  DFHPF2    PIC X VALUE "2".                               
000296     02  DFHPF3    PIC X VALUE "3".                               
000297     02  DFHPF4    PIC X VALUE "4".                               
000298     02  DFHPF5    PIC X VALUE "5".                               
000299     02  DFHPF6    PIC X VALUE "6".                               
000300     02  DFHPF7    PIC X VALUE "7".                               
000301     02  DFHPF8    PIC X VALUE "8".                               
000302     02  DFHPF9    PIC X VALUE "9".                               
000303     02  DFHPF10   PIC X VALUE ":".                               
000304     02  DFHPF11   PIC X VALUE "#".                               
000305     02  DFHPF12   PIC X VALUE "@".                               
000306     02  DFHPF13   PIC X VALUE "A".                               
000307     02  DFHPF14   PIC X VALUE "B".                               
000308     02  DFHPF15   PIC X VALUE "C".                               
000309     02  DFHPF16   PIC X VALUE "D".                               
000310     02  DFHPF17   PIC X VALUE "E".                               
000311     02  DFHPF18   PIC X VALUE "F".                               
000312     02  DFHPF19   PIC X VALUE "G".                               
000313     02  DFHPF20   PIC X VALUE "H".                               
000314     02  DFHPF21   PIC X VALUE "I".                               
000315     02  DFHPF22   PIC X VALUE "[".                               
000316     02  DFHPF23   PIC X VALUE ".".                               
000317     02  DFHPF24   PIC X VALUE "<".                               
000318 01  FILLER                      PIC X(08) VALUE 'DCWATTRI'.      
000319*    COPY DCWATTRI SUPPRESS.                                      
000320******************************************************************
000321******       VALORI    DEGLI   ATTRIBUTI    (WCOPATTR)      ******
000322******************************************************************
000323 01       DFHBMSCA.                                               
000324   05     DFHBMEOF                    PIC X  VALUE ' '.           
000325*  X'80'  CC DI RITORNO DI UN CAMPO ANNULLATO CON CANCEL F.C.     
000326   05     DFHBMUNP                    PIC X  VALUE ' '.           
000327*  X'40'  NON PROTETTO                                            
000328   05     DFHBMFSE                    PIC X  VALUE 'A'.           
000329*  X'C1'  NON PROTETTO MDT                                        
000330   05     DFHUNPSP                    PIC X  VALUE 'D'.           
000331*  X'C4'  NON PROTETTO SELEZIONABILE                              
000332   05     DFHUNPSM                    PIC X  VALUE 'E'.           
000333*  X'C5'  NON PROTETTO SELEZIONABILE MDT                          
000334   05     DFHBMBRY                    PIC X  VALUE 'H'.           
000335*  X'C8'  NON PROTETTO LUMINOSO SELEZIONABILE                     
000336   05     DFHUNIMD                    PIC X  VALUE 'I'.           
000337*  X'C9'  NON PROTETTO LUMINOSO SELEZIONABILE MDT                 
000338   05     DFHBMDAR                    PIC X  VALUE '<'.           
000339*  X'4C'  NON PROTETTO NON VISIBILE                               
000340   05     DFHUNNOD                    PIC X  VALUE '('.           
000341*  X'4D'  NON PROTETTO NON VISIBILE MDT                           
000342   05     DFHBMUNN                    PIC X  VALUE '&'.           
000343*  X'50'  NON PROTETTO NUMERICO                                   
000344   05     DFHUNNUM                    PIC X  VALUE 'J'.           
000345*  X'D1'  NON PROTETTO NUMERICO MDT                               
000346   05     DFHUNPNS                    PIC X  VALUE 'M'.           
000347*  X'D4'  NON PROTETTO NUMERICO SELEZIONABILE                     
000348   05     DFHUNNSM                    PIC X  VALUE 'N'.           
000349*  X'D5'  NON PROTETTO NUMERICO SELEZIONABILE MDT                 
000350   05     DFHUNNBS                    PIC X  VALUE 'Q'.           
000351*  X'D8'  NON PROTETTO NUMERICO LUMINOSO SELEZIONABILE            
000352   05     DFHUNBSM                    PIC X  VALUE 'R'.           
000353*  X'D9'  NON PROTETTO NUMERICO LUMINOSO SELEZIONABILE MDT        
000354   05     DFHUNPND                    PIC X  VALUE '*'.           
000355*  X'5C'  NON PROTETTO NUMERICO NON VISIBILE                      
000356   05     DFHUNNON                    PIC X  VALUE ')'.           
000357*  X'5D'  NON PROTETTO NUMERICO NON VISIBILE MDT                  
000358   05     DFHBMPRO                    PIC X  VALUE '-'.           
000359*  X'60'  PROTETTO                                                
000360   05     DFHBMPRF                    PIC X  VALUE '/'.           
000361*  X'61'  PROTETTO MDT                                            
000362   05     DFHPROSP                    PIC X  VALUE 'U'.           
000363*  X'E4'  PROTETTO SELEZIONABILE                                  
000364   05     DFHPRSPM                    PIC X  VALUE 'V'.           
000365*  X'E5'  PROTETTO SELEZIONABILE MDT                              
000366   05     DFHPROTI                    PIC X  VALUE 'Y'.           
000367*  X'E8'  PROTETTO LUMINOSO SELEZIONABILE                         
000368   05     DFHPRLSM                    PIC X  VALUE 'Z'.           
000369*  X'E9'  PROTETTO LUMINOSO SELEZIONABILE MDT                     
000370   05     DFHPROTN                    PIC X  VALUE '%'.           
000371*  X'6C'  PROTETTO NON VISIBILE                                   
000372   05     DFHPRODM                    PIC X  VALUE '_'.           
000373*  X'6D'  PROTETTO NON VISIBILE MDT                               
000374   05     DFHBMASK                    PIC X  VALUE '0'.           
000375*  X'F0'  PROTETTO SKIP                                           
000376   05     DFHBMASF                    PIC X  VALUE '1'.           
000377*  X'F1'  PROTETTO SKIP  MDT                                      
000378   05     DFHPRSKS                    PIC X  VALUE '4'.           
000379*  X'F4'  PROTETTO SKIP  SELEZIONABILE                            
000380   05     DFHPSKSM                    PIC X  VALUE '5'.           
000381*  X'F5'  PROTETTO SKIP  SELEZIONABILE MDT                        
000382   05     DFHBMASB                    PIC X  VALUE '8'.           
000383*  X'F8'  PROTETTO SKIP  LUMINOSO SELEZIONABILE                   
000384   05     DFHPROIM                    PIC X  VALUE '9'.           
000385*  X'F9'  PROTETTO SKIP  LUMINOSO SELEZIONABILE MDT               
000386*  05     DFHPRSKD                    PIC X  VALUE '§'.           
000387   05     DFHPRSKD                    PIC X  VALUE '@'.           
000388*  X'7C'  PROTETTO SKIP  NON VISIBILE                             
000389   05     DFHPSKDM                    PIC X  VALUE QUOTE.         
000390*  X'7D'  PROTETTO SKIP  NON VISIBILE MDT                         
000391   05     DFHBLUE                     PIC X  VALUE '1'.           
000392*  X'F1'  COLORE BLUE                                             
000393   05     DFHRED                      PIC X  VALUE '2'.           
000394*  X'F2'  COLORE ROSSO                                            
000395   05     DFHPINK                     PIC X  VALUE '3'.           
000396*  X'F3'  COLORE ROSA                                             
000397   05     DFHGREEN                    PIC X  VALUE '4'.           
000398*  X'F4'  COLORE VERDE                                            
000399   05     DFHTURQ                     PIC X  VALUE '5'.           
000400*  X'F5'  COLORE AZZURRO                                          
000401   05     DFHYELLO                    PIC X  VALUE '6'.           
000402*  X'F6'  COLORE GIALLO                                           
000403   05     DFHNEUTR                    PIC X  VALUE '7'.           
000404*  X'F7'  COLORE NEUTRO                                           
000405   05     DFHDFHI                     PIC X  VALUE HIGH-VALUE.    
000406*  X'FF'  TOGLIE LA SOTTOLINEATURA (UNDERLINE)                    
000407   05     DFHUNDLN                    PIC X  VALUE '4'.           
000408*  X'F4'  IMPOSTA LA SOTTOLINEATURA (UNDERLINE)                   
000409   05     DFHREVRS                    PIC X  VALUE '2'.           
000410*  X'F4'  IMPOSTA IL REVERSE                                      
000411   05     DFHALL                      PIC X  VALUE ' '.           
000412*  X'00'  PULISCE GLI ATTRIBUTI PRENDENDO QUELLI DI MAPPA         
000413 01  FILLER                      PIC X(08) VALUE '*DCMESS*'.      
000414*    COPY DCMESS.                                                 
000415********************     DCMESS           ************************
000416*********  COPY PER ESECUZIONE DELLA SUBROUTINE SRMESS     *******
000417*********  GESTIONE MESSAGGI DI ERRORE TP/BATCH            *******
000418******************************************************************
000419 01  DCMESS.                                                      
000420     05  MESS-CAMPI-INPUT.                                        
000421         10  MESS-CODERROR      PIC X(5)       VALUE SPACES.      
000422         10  MESS-CODILING      PIC X(1)       VALUE SPACES.      
000423     05  MESS-CAMPI-OUTPUT.                                       
000424         10  MESS-MSGERROR.                                       
000425             15  MESS-COMCODER  PIC X(5)       VALUE SPACES.      
000426             15  FILLER         PIC X          VALUE SPACES.      
000427             15  MESS-MESSAGGI  PIC X(66)      VALUE SPACES.      
000428 01  FILLER                      PIC X(08) VALUE '*AVMLO50'.      
000429*    COPY AVMLO50.                                                
000430*   Micro Focus Enterprise Developer  2.2.01204                   
000431*   Micro Focus BMS Screen Painter (ver BMSIDE_2-2-20)            
000432*   MapSet Name   AVMLO50                                         
000433*   Date Created  01/17/2019                                      
000434*   Time Created  15:14:29                                        
000435*  Input Data For Map AVILO50                                     
000436   01 AVILO50I.                                                   
000437      03 FILLER                         PIC X(12).                
000438      03 LO50-MAPDATAL                  PIC S9(4) COMP.           
000439      03 LO50-MAPDATAF                  PIC X.                    
000440      03 FILLER REDEFINES LO50-MAPDATAF.                          
000441         05 LO50-MAPDATAA                  PIC X.                 
000442      03 FILLER                         PIC X(4).                 
000443      03 LO50-MAPDATAI                  PIC X(8).                 
000444      03 LO50-MAPORAXL                  PIC S9(4) COMP.           
000445      03 LO50-MAPORAXF                  PIC X.                    
000446      03 FILLER REDEFINES LO50-MAPORAXF.                          
000447         05 LO50-MAPORAXA                  PIC X.                 
000448      03 FILLER                         PIC X(4).                 
000449      03 LO50-MAPORAXI                  PIC X(8).                 
000450      03 LO50-CODCLIENL                 PIC S9(4) COMP.           
000451      03 LO50-CODCLIENF                 PIC X.                    
000452      03 FILLER REDEFINES LO50-CODCLIENF.                         
000453         05 LO50-CODCLIENA                 PIC X.                 
000454      03 FILLER                         PIC X(4).                 
000455      03 LO50-CODCLIENI                 PIC X(5).                 
000456      03 LO50-RAGFATTUL                 PIC S9(4) COMP.           
000457      03 LO50-RAGFATTUF                 PIC X.                    
000458      03 FILLER REDEFINES LO50-RAGFATTUF.                         
000459         05 LO50-RAGFATTUA                 PIC X.                 
000460      03 FILLER                         PIC X(4).                 
000461      03 LO50-RAGFATTUI                 PIC X(24).                
000462      03 LO50-DTIPSERVL                 PIC S9(4) COMP.           
000463      03 LO50-DTIPSERVF                 PIC X.                    
000464      03 FILLER REDEFINES LO50-DTIPSERVF.                         
000465         05 LO50-DTIPSERVA                 PIC X.                 
000466      03 FILLER                         PIC X(4).                 
000467      03 LO50-DTIPSERVI                 PIC X(10).                
000468      03 LO50-DTINILISL                 PIC S9(4) COMP.           
000469      03 LO50-DTINILISF                 PIC X.                    
000470      03 FILLER REDEFINES LO50-DTINILISF.                         
000471         05 LO50-DTINILISA                 PIC X.                 
000472      03 FILLER                         PIC X(4).                 
000473      03 LO50-DTINILISI                 PIC X(6).                 
000474      03 LO50-DTFINLISL                 PIC S9(4) COMP.           
000475      03 LO50-DTFINLISF                 PIC X.                    
000476      03 FILLER REDEFINES LO50-DTFINLISF.                         
000477         05 LO50-DTFINLISA                 PIC X.                 
000478      03 FILLER                         PIC X(4).                 
000479      03 LO50-DTFINLISI                 PIC X(6).                 
000480      03 LO50-CODDIVISL                 PIC S9(4) COMP.           
000481      03 LO50-CODDIVISF                 PIC X.                    
000482      03 FILLER REDEFINES LO50-CODDIVISF.                         
000483         05 LO50-CODDIVISA                 PIC X.                 
000484      03 FILLER                         PIC X(4).                 
000485      03 LO50-CODDIVISI                 PIC X(2).                 
000486      03 LO50-SIGLADIVL                 PIC S9(4) COMP.           
000487      03 LO50-SIGLADIVF                 PIC X.                    
000488      03 FILLER REDEFINES LO50-SIGLADIVF.                         
000489         05 LO50-SIGLADIVA                 PIC X.                 
000490      03 FILLER                         PIC X(4).                 
000491      03 LO50-SIGLADIVI                 PIC X(3).                 
000492      03 LO50-RIGAI                     OCCURS 18 TIMES.          
000493         05 LO50-OPERAZIOL                 PIC S9(4) COMP.        
000494         05 LO50-OPERAZIOF                 PIC X.                 
000495         05 FILLER REDEFINES LO50-OPERAZIOF.                      
000496            07 LO50-OPERAZIOA                 PIC X.              
000497         05 FILLER                         PIC X(4).              
000498         05 LO50-OPERAZIOI                 PIC X(1).              
000499         05 LO50-CODSERVIL                 PIC S9(4) COMP.        
000500         05 LO50-CODSERVIF                 PIC X.                 
000501         05 FILLER REDEFINES LO50-CODSERVIF.                      
000502            07 LO50-CODSERVIA                 PIC X.              
000503         05 FILLER                         PIC X(4).              
000504         05 LO50-CODSERVII                 PIC X(6).              
000505         05 LO50-DESSERVIL                 PIC S9(4) COMP.        
000506         05 LO50-DESSERVIF                 PIC X.                 
000507         05 FILLER REDEFINES LO50-DESSERVIF.                      
000508            07 LO50-DESSERVIA                 PIC X.              
000509         05 FILLER                         PIC X(4).              
000510         05 LO50-DESSERVII                 PIC X(40).             
000511         05 LO50-UNMISURAL                 PIC S9(4) COMP.        
000512         05 LO50-UNMISURAF                 PIC X.                 
000513         05 FILLER REDEFINES LO50-UNMISURAF.                      
000514            07 LO50-UNMISURAA                 PIC X.              
000515         05 FILLER                         PIC X(4).              
000516         05 LO50-UNMISURAI                 PIC X(2).              
000517         05 LO50-PREZZLISL                 PIC S9(4) COMP.        
000518         05 LO50-PREZZLISF                 PIC X.                 
000519         05 FILLER REDEFINES LO50-PREZZLISF.                      
000520            07 LO50-PREZZLISA                 PIC X.              
000521         05 FILLER                         PIC X(4).              
000522         05 LO50-PREZZLISI                 PIC X(12).             
000523         05 LO50-PERCLISTL                 PIC S9(4) COMP.        
000524         05 LO50-PERCLISTF                 PIC X.                 
000525         05 FILLER REDEFINES LO50-PERCLISTF.                      
000526            07 LO50-PERCLISTA                 PIC X.              
000527         05 FILLER                         PIC X(4).              
000528         05 LO50-PERCLISTI                 PIC X(5).              
000529      03 LO50-MAPRPAGL                  PIC S9(4) COMP.           
000530      03 LO50-MAPRPAGF                  PIC X.                    
000531      03 FILLER REDEFINES LO50-MAPRPAGF.                          
000532         05 LO50-MAPRPAGA                  PIC X.                 
000533      03 FILLER                         PIC X(4).                 
000534      03 LO50-MAPRPAGI                  PIC X(4).                 
000535      03 LO50-MAPPPAGL                  PIC S9(4) COMP.           
000536      03 LO50-MAPPPAGF                  PIC X.                    
000537      03 FILLER REDEFINES LO50-MAPPPAGF.                          
000538         05 LO50-MAPPPAGA                  PIC X.                 
000539      03 FILLER                         PIC X(4).                 
000540      03 LO50-MAPPPAGI                  PIC X(4).                 
000541      03 LO50-MESSAGGL                  PIC S9(4) COMP.           
000542      03 LO50-MESSAGGF                  PIC X.                    
000543      03 FILLER REDEFINES LO50-MESSAGGF.                          
000544         05 LO50-MESSAGGA                  PIC X.                 
000545      03 FILLER                         PIC X(4).                 
000546      03 LO50-MESSAGGI                  PIC X(56).                
000547*  Output Data For Map AVILO50                                    
000548   01 AVILO50O REDEFINES AVILO50I.                                
000549      03 FILLER                         PIC X(12).                
000550      03 FILLER                         PIC X(3).                 
000551      03 LO50-MAPDATAC                  PIC X.                    
000552      03 LO50-MAPDATAP                  PIC X.                    
000553      03 LO50-MAPDATAH                  PIC X.                    
000554      03 LO50-MAPDATAV                  PIC X.                    
000555      03 LO50-MAPDATAO                  PIC X(8).                 
000556      03 FILLER                         PIC X(3).                 
000557      03 LO50-MAPORAXC                  PIC X.                    
000558      03 LO50-MAPORAXP                  PIC X.                    
000559      03 LO50-MAPORAXH                  PIC X.                    
000560      03 LO50-MAPORAXV                  PIC X.                    
000561      03 LO50-MAPORAXO                  PIC 99.99.99.             
000562      03 FILLER                         PIC X(3).                 
000563      03 LO50-CODCLIENC                 PIC X.                    
000564      03 LO50-CODCLIENP                 PIC X.                    
000565      03 LO50-CODCLIENH                 PIC X.                    
000566      03 LO50-CODCLIENV                 PIC X.                    
000567      03 LO50-CODCLIENO                 PIC X(5).                 
000568      03 FILLER                         PIC X(3).                 
000569      03 LO50-RAGFATTUC                 PIC X.                    
000570      03 LO50-RAGFATTUP                 PIC X.                    
000571      03 LO50-RAGFATTUH                 PIC X.                    
000572      03 LO50-RAGFATTUV                 PIC X.                    
000573      03 LO50-RAGFATTUO                 PIC X(24).                
000574      03 FILLER                         PIC X(3).                 
000575      03 LO50-DTIPSERVC                 PIC X.                    
000576      03 LO50-DTIPSERVP                 PIC X.                    
000577      03 LO50-DTIPSERVH                 PIC X.                    
000578      03 LO50-DTIPSERVV                 PIC X.                    
000579      03 LO50-DTIPSERVO                 PIC X(10).                
000580      03 FILLER                         PIC X(3).                 
000581      03 LO50-DTINILISC                 PIC X.                    
000582      03 LO50-DTINILISP                 PIC X.                    
000583      03 LO50-DTINILISH                 PIC X.                    
000584      03 LO50-DTINILISV                 PIC X.                    
000585      03 LO50-DTINILISO                 PIC X(6).                 
000586      03 FILLER                         PIC X(3).                 
000587      03 LO50-DTFINLISC                 PIC X.                    
000588      03 LO50-DTFINLISP                 PIC X.                    
000589      03 LO50-DTFINLISH                 PIC X.                    
000590      03 LO50-DTFINLISV                 PIC X.                    
000591      03 LO50-DTFINLISO                 PIC X(6).                 
000592      03 FILLER                         PIC X(3).                 
000593      03 LO50-CODDIVISC                 PIC X.                    
000594      03 LO50-CODDIVISP                 PIC X.                    
000595      03 LO50-CODDIVISH                 PIC X.                    
000596      03 LO50-CODDIVISV                 PIC X.                    
000597      03 LO50-CODDIVISO                 PIC X(2).                 
000598      03 FILLER                         PIC X(3).                 
000599      03 LO50-SIGLADIVC                 PIC X.                    
000600      03 LO50-SIGLADIVP                 PIC X.                    
000601      03 LO50-SIGLADIVH                 PIC X.                    
000602      03 LO50-SIGLADIVV                 PIC X.                    
000603      03 LO50-SIGLADIVO                 PIC X(3).                 
000604      03 LO50-RIGAO OCCURS 18.                                    
000605         05 FILLER                         PIC X(3).              
000606         05 LO50-OPERAZIOC                 PIC X.                 
000607         05 LO50-OPERAZIOP                 PIC X.                 
000608         05 LO50-OPERAZIOH                 PIC X.                 
000609         05 LO50-OPERAZIOV                 PIC X.                 
000610         05 LO50-OPERAZIOO                 PIC X(1).              
000611         05 FILLER                         PIC X(3).              
000612         05 LO50-CODSERVIC                 PIC X.                 
000613         05 LO50-CODSERVIP                 PIC X.                 
000614         05 LO50-CODSERVIH                 PIC X.                 
000615         05 LO50-CODSERVIV                 PIC X.                 
000616         05 LO50-CODSERVIO                 PIC X(6).              
000617         05 FILLER                         PIC X(3).              
000618         05 LO50-DESSERVIC                 PIC X.                 
000619         05 LO50-DESSERVIP                 PIC X.                 
000620         05 LO50-DESSERVIH                 PIC X.                 
000621         05 LO50-DESSERVIV                 PIC X.                 
000622         05 LO50-DESSERVIO                 PIC X(40).             
000623         05 FILLER                         PIC X(3).              
000624         05 LO50-UNMISURAC                 PIC X.                 
000625         05 LO50-UNMISURAP                 PIC X.                 
000626         05 LO50-UNMISURAH                 PIC X.                 
000627         05 LO50-UNMISURAV                 PIC X.                 
000628         05 LO50-UNMISURAO                 PIC X(2).              
000629         05 FILLER                         PIC X(3).              
000630         05 LO50-PREZZLISC                 PIC X.                 
000631         05 LO50-PREZZLISP                 PIC X.                 
000632         05 LO50-PREZZLISH                 PIC X.                 
000633         05 LO50-PREZZLISV                 PIC X.                 
000634         05 LO50-PREZZLISO                 PIC Z(7),ZZZZ.         
000635         05 FILLER                         PIC X(3).              
000636         05 LO50-PERCLISTC                 PIC X.                 
000637         05 LO50-PERCLISTP                 PIC X.                 
000638         05 LO50-PERCLISTH                 PIC X.                 
000639         05 LO50-PERCLISTV                 PIC X.                 
000640         05 LO50-PERCLISTO                 PIC ZZ,ZZ.             
000641      03 FILLER                         PIC X(3).                 
000642      03 LO50-MAPRPAGC                  PIC X.                    
000643      03 LO50-MAPRPAGP                  PIC X.                    
000644      03 LO50-MAPRPAGH                  PIC X.                    
000645      03 LO50-MAPRPAGV                  PIC X.                    
000646      03 LO50-MAPRPAGO                  PIC 9(4).                 
000647      03 FILLER                         PIC X(3).                 
000648      03 LO50-MAPPPAGC                  PIC X.                    
000649      03 LO50-MAPPPAGP                  PIC X.                    
000650      03 LO50-MAPPPAGH                  PIC X.                    
000651      03 LO50-MAPPPAGV                  PIC X.                    
000652      03 LO50-MAPPPAGO                  PIC 9(4).                 
000653      03 FILLER                         PIC X(3).                 
000654      03 LO50-MESSAGGC                  PIC X.                    
000655      03 LO50-MESSAGGP                  PIC X.                    
000656      03 LO50-MESSAGGH                  PIC X.                    
000657      03 LO50-MESSAGGV                  PIC X.                    
000658      03 LO50-MESSAGGO                  PIC X(56).                
000659 01  FILLER                      PIC X(08) VALUE 'DCWTESTN'.      
000660*    COPY DCWTESTN.                                               
000661 01  DCWTESTN.                                                    
000662     05 WSNU-INTEGERS       PIC 9(2).                             
000663     05 WSNU-DECIMALS       PIC 9(2).                             
000664     05 WSNU-SPACE1         PIC X(20).                            
000665     05 WSNU-NUMBER         PIC X(20).                            
000666     05 WSNU-FILLER1 REDEFINES WSNU-NUMBER.                       
000667        10 WSNU-BYTE OCCURS 20 TIMES PIC X.                       
000668     05 WSNU-SPACE2         PIC X(20).                            
000669     05 WSNU-FILLER0.                                             
000670       10 WSNU-MAXINTE        PIC 9(14).                          
000671       10 WSNU-MAXDECI        PIC S9(4).                          
000672     05 WSNU-MAXVALUE REDEFINES WSNU-FILLER0  PIC S9(14)V9(4).    
000673     05 WSNU-COMAXDECI      PIC S9(5)V9(5).                       
000674     05 WSNU-FILLER01 REDEFINES WSNU-COMAXDECI.                   
000675        10 WSNU-COMAXDEC15     PIC 9(5).                          
000676        10 WSNU-COMAXDEC25     PIC S9(5).                         
000677     05 WSNU-PLUSMINU       PIC X.                                
000678     05 WSNU-MAX            PIC S9(2).                            
000679     05 WSNU-IND            PIC S9(2).                            
000680     05 WSNU-INDN           PIC S9(2).                            
000681     05 WSNU-INDX           PIC S9(2).                            
000682     05 WSNU-NUMEOUTX       PIC X(20).                            
000683     05 WSNU-FILLER2 REDEFINES WSNU-NUMEOUTX.                     
000684        10 WSNU-PICX OCCURS 20 TIMES PIC X.                       
000685     05 WSNU-NUMEOUTN       PIC S9(14)V9(4).                      
000686     05 WSNU-FILLER3 REDEFINES WSNU-NUMEOUTN.                     
000687        10 WSNU-INT OCCURS 14 TIMES PIC 9.                        
000688        10 WSNU-DEC0.                                             
000689           15 WSNU-DEC OCCURS 4 TIMES PIC 9.                      
000690     05 WSNU-FORMAT.                                              
000691        10 WSNU-FORMATX OCCURS 20 TIMES PIC X.                    
000692     05 WSNU-WSWERROR          PIC X.                             
000693 01  FILLER                      PIC X(08) VALUE 'DCWTSTR0'.      
000694*    COPY DCWTSTR0.                                               
000695*------------------------------------- -------------------------* 
000696*                    --- DCWTSTR0 ---                           * 
000697*              DSECT PER SALVATAGGIO COMMAREA.                  * 
000698*---------------------------------------------------------------* 
000699 01  DCWTSTR0.                                                    
000700     05  TSTR-LENGCODA               PIC S9(4)  COMP VALUE +4096. 
000701     05  TSTR-ITEMXXXX               PIC S9(4)  COMP VALUE +0.    
000702     05  TSTR-NOMECODA.                                           
000703         10  TSTR-NOMETRAN           PIC X(4)   VALUE SPACES.     
000704         10  TSTR-NOMETERM           PIC X(4)   VALUE SPACES.     
000705     05  TSTR-AREATSTR               PIC X(4096) VALUE SPACES.    
000706*---------------------------------------------------------------* 
000707*--------------------------------DLOGI.TORDILOGI                  
000708 01  FILLER                      PIC X(8) VALUE 'FDLOG652'.       
000709*    EXEC SQL INCLUDE FDLOG652 END-EXEC.                          
      *>>((file: FDLOG652))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TORDILOGI                 *
000003******************************************************************
000004 01  DCLTORDILOGI.                                                
000005*                       AANUMORD                                  
000006     10 L652-AANUMORD        PIC X(8).                            
000007*                       CODCLIEN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000008     10 L652-CODCLIEN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000009*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000010     10 L652-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000011*                       CDDIVISI                                  
000012     10 L652-CDDIVISI        PIC X(1).                            
000013*                       DTCARORD                                  
000014     10 L652-DTCARORD        PIC X(8).                            
000015*                       CODDIVIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000016     10 L652-CODDIVIS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000017*                       TIPSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000018     10 L652-TIPSERVI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000019*                       FLAGAUTO                                  
000020     10 L652-FLAGAUTO        PIC X(1).                            
000021*                       FLAGGIVA                                  
000022     10 L652-FLAGGIVA        PIC X(1).                            
000023*                       CONTODCE                                  
000024     10 L652-CONTODCE        PIC X(6).                            
000025*                       DTEVAORD                                  
000026     10 L652-DTEVAORD        PIC X(8).                            
000027*                       AANUMFAT                                  
000028     10 L652-AANUMFAT        PIC X(8).                            
000029*                       DTFATTUR                                  
000030     10 L652-DTFATTUR        PIC X(8).                            
000031*                       NRPREATT                                  
000032     10 L652-NRPREATT        PIC X(10).                           
000033*                       DTPREATT                                  
000034     10 L652-DTPREATT        PIC X(8).                            
000035*                       DTCREAZI                                  
000036     10 L652-DTCREAZI        PIC X(8).                            
000037*                       DTULTVAR                                  
000038     10 L652-DTULTVAR        PIC X(8).                            
000039*                       CODUTVAR                                  
000040     10 L652-CODUTVAR        PIC X(6).                            
000041*                       DTANNULL                                  
000042     10 L652-DTANNULL        PIC X(8).                            
000043*                       SOCIEMER                                  
000044     10 L652-SOCIEMER        PIC X(2).                            
000045*                       DATAESTR                                  
000046     10 L652-DATAESTR        PIC X(8).                            
000047*                       AAMMCOMP                                  
000048     10 L652-AAMMCOMP        PIC X(6).                            
000049*                       FLAGSOSP                                  
000050     10 L652-FLAGSOSP        PIC X(1).                            
000051*                       CODUTEVB                                  
000052     10 L652-CODUTEVB        PIC X(6).                            
000053*                       ESENTIVA                                  
000054     10 L652-ESENTIVA        PIC X(1).                            
000055*                       FLORDIVB                                  
000056     10 L652-FLORDIVB        PIC X(1).                            
000057******************************************************************
000058* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 26      *
000059******************************************************************
      *<<((file: FDLOG652))
000710*--------------------------------DLOGI.TRIGORDILOGI               
000711 01  FILLER                      PIC X(8) VALUE 'FDLOG653'.       
000712*    EXEC SQL INCLUDE FDLOG653 END-EXEC.                          
      *>>((file: FDLOG653))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TRIGORDILOGI              *
000003******************************************************************
000004 01  DCLTRIGORDILOGI.                                             
000005     10 L653-AANUMORD        PIC X(8).                            
000006     10 L653-NRRIGORD        PIC S9(5)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000007     10 L653-CODSERVI        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000008     10 L653-UNMISURA        PIC X(2).                            
000009     10 L653-QTAORDIN        PIC S9(7)V9(2) USAGE COMP-3.         
000010     10 L653-PREZZORD        PIC S9(7)V9(4) USAGE COMP-3.         
000011     10 L653-IMPORDIN        PIC S9(11)V9(2) USAGE COMP-3.        
000012     10 L653-NOTENOTE        PIC X(40).                           
000013     10 L653-CENCOSTD        PIC X(5).                            
000014     10 L653-CENCOSTA        PIC X(5).                            
000015     10 L653-RIFECLIE        PIC X(15).                           
000016     10 L653-DTCREAZI        PIC X(8).                            
000017     10 L653-DTULTVAR        PIC X(8).                            
000018     10 L653-CODUTVAR        PIC X(6).                            
000019     10 L653-DTANNULL        PIC X(8).                            
000020     10 L653-IMPORIVA        PIC S9(11)V9(2) USAGE COMP-3.        
000021******************************************************************
000022* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 16      *
000023******************************************************************
      *<<((file: FDLOG653))
000713*--------------------------------DLOGI.TLISTILOGI                 
000714 01  FILLER                      PIC X(8) VALUE 'FDLOG654'.       
000715*    EXEC SQL INCLUDE FDLOG654 END-EXEC.                          
      *>>((file: FDLOG654))
000001******************************************************************
000002* DCLGEN TABLE(DLOGISTI.TLISTILOGI)                              *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDLOG654))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(L654-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DLOGISTI.TLISTILOGI TABLE                   
000012*     ( CODCLIEN                       CHAR(5) NOT NULL,           
000013*       DTINILIS                       CHAR(6) NOT NULL,           
000014*       DTFINLIS                       CHAR(6) NOT NULL,           
000015*       CODSERVI                       CHAR(6) NOT NULL,           
000016*       TIPSERVI                       CHAR(1) NOT NULL,           
000017*       CODDIVIS                       CHAR(2) NOT NULL,           
000018*       PREZZLIS                       DECIMAL(11, 4) NOT NULL,    
000019*       PERCLIST                       DECIMAL(5, 2) NOT NULL,     
000020*       DTCREAZI                       CHAR(8) NOT NULL,           
000021*       DTULTVAR                       CHAR(8) NOT NULL,           
000022*       CODUTVAR                       CHAR(8) NOT NULL            
000023*     ) END-EXEC
                                                                        
000024******************************************************************
000025* COBOL DECLARATION FOR TABLE DLOGISTI.TLISTILOGI                *
000026******************************************************************
000027 01  DCLTLISTILOGI.                                               
000028*                       CODCLIEN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000029     10 L654-CODCLIEN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000030*                       DTINILIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000031     10 L654-DTINILIS        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000032*                       DTFINLIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000033     10 L654-DTFINLIS        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000034*                       CODSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000035     10 L654-CODSERVI        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000036*                       TIPSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000037     10 L654-TIPSERVI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000038*                       CODDIVIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000039     10 L654-CODDIVIS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000040*                       PREZZLIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000041     10 L654-PREZZLIS        PIC S9(7)V9(4) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000042*                       PERCLIST                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000043     10 L654-PERCLIST        PIC S9(3)V9(2) USAGE COMP-3.         
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000044*                       DTCREAZI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000045     10 L654-DTCREAZI        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000046*                       DTULTVAR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000047     10 L654-DTULTVAR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000048*                       CODUTVAR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000049     10 L654-CODUTVAR        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000050******************************************************************
000051* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 11      *
000052******************************************************************
      *<<((file: FDLOG654))
000716*--------------------------------DLOGISTI.TSERVIZI                
000717 01  FILLER                      PIC X(8) VALUE 'FDLOG651'.       
000718*    EXEC SQL INCLUDE FDLOG651 END-EXEC.                          
      *>>((file: FDLOG651))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DLOGISTI.TSERVIZI                  *
000003******************************************************************
000004 01  DCLTSERVIZI.                                                 
000005*                       CODSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006     10 L651-CODSERVI        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007*                       DESSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000008     10 L651-DESSERVI        PIC X(40).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000009*                       UNMISURA                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000010     10 L651-UNMISURA        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000011*                       TIPSERVI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000012     10 L651-TIPSERVI        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000013*                       DTCREAZI                                  
000014     10 L651-DTCREAZI        PIC X(8).                            
000015*                       DTULTVAR                                  
000016     10 L651-DTULTVAR        PIC X(8).                            
000017*                       CODUTVAR                                  
000018     10 L651-CODUTVAR        PIC X(6).                            
000019*                       CONTODCD                                  
000020     10 L651-CONTODCD        PIC X(6).                            
000021*                       CONTODCA                                  
000022     10 L651-CONTODCA        PIC X(6).                            
000023*                       CENCOSTA                                  
000024     10 L651-CENCOSTA        PIC X(5).                            
000025     10 L651-ESENTIVA        PIC X(1).                            
000026     10 L651-CONTPROV        PIC X(6).                            
000027******************************************************************
000028* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 12      *
000029******************************************************************
      *<<((file: FDLOG651))
000719*--------------------------------DANAGRAF.TCLIENTI                
000720 01  FILLER                      PIC X(8) VALUE 'FDANA901'.       
000721*    EXEC SQL INCLUDE FDANA901 END-EXEC.                          
      *>>((file: FDANA901))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TCLIENTI                  *
000003******************************************************************
000004 01  DCLTCLIENTI.                                                 
000005*                       CODCLIEN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006     10 A901-CODCLIEN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007*                       STATCLIE                                  
000008     10 A901-STATCLIE        PIC X(1).                            
000009*                       GENECLIE                                  
000010     10 A901-GENECLIE        PIC X(1).                            
000011*                       TIPOCLIE                                  
000012     10 A901-TIPOCLIE        PIC X(1).                            
000013*                       TIPOCONS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000014     10 A901-TIPOCONS        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000015*                       CLIFOCON                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000016     10 A901-CLIFOCON        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000017*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000018     10 A901-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000019*                       CAPOCONT                                  
000020     10 A901-CAPOCONT        PIC X(5).                            
000021*                       CODFISCA                                  
000022     10 A901-CODFISCA        PIC X(16).                           
000023*                       ESENTIVA                                  
000024     10 A901-ESENTIVA        PIC X(1).                            
000025*                       NUMESIVA                                  
000026     10 A901-NUMESIVA        PIC X(5).                            
000027*                       DATESIVA                                  
000028     10 A901-DATESIVA        PIC X(8).                            
000029*                       UFFICIVA                                  
000030     10 A901-UFFICIVA        PIC X(18).                           
000031*                       IMPESIVA                                  
000032     10 A901-IMPESIVA        PIC S9(4)V USAGE COMP-3.             
000033*                       BANCAPPO                                  
000034     10 A901-BANCAPPO        PIC X(3).                            
000035*                       NOMBANCL                                  
000036     10 A901-NOMBANCL        PIC X(114).                          
000037*                       CONTOCOR                                  
000038     10 A901-CONTOCOR        PIC X(13).                           
000039*                       ASSOBANC                                  
000040     10 A901-ASSOBANC        PIC X(5).                            
000041*                       AVVIBANC                                  
000042     10 A901-AVVIBANC        PIC X(5).                            
000043*                       CLIEFATT                                  
000044     10 A901-CLIEFATT        PIC X(5).                            
000045*                       PAESFATT                                  
000046     10 A901-PAESFATT        PIC X(3).                            
000047*                       RAGFATTU                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000048     10 A901-RAGFATTU        PIC X(24).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000049*                       ESRAGFAT                                  
000050     10 A901-ESRAGFAT        PIC X(24).                           
000051*                       INDFATTU                                  
000052     10 A901-INDFATTU        PIC X(24).                           
000053*                       ESINDFAT                                  
000054     10 A901-ESINDFAT        PIC X(24).                           
000055*                       CITFATTU                                  
000056     10 A901-CITFATTU        PIC X(18).                           
000057*                       ESCITFAT                                  
000058     10 A901-ESCITFAT        PIC X(18).                           
000059*                       CAPFATTU                                  
000060     10 A901-CAPFATTU        PIC X(5).                            
000061*                       PAESMERC                                  
000062     10 A901-PAESMERC        PIC X(3).                            
000063*                       RAGMERCE                                  
000064     10 A901-RAGMERCE        PIC X(24).                           
000065*                       ESRAGMER                                  
000066     10 A901-ESRAGMER        PIC X(24).                           
000067*                       INDMERCE                                  
000068     10 A901-INDMERCE        PIC X(24).                           
000069*                       ESINDMER                                  
000070     10 A901-ESINDMER        PIC X(24).                           
000071*                       CITMERCE                                  
000072     10 A901-CITMERCE        PIC X(18).                           
000073*                       ESCITMER                                  
000074     10 A901-ESCITMER        PIC X(18).                           
000075*                       CAPMERCE                                  
000076     10 A901-CAPMERCE        PIC X(5).                            
000077*                       ZONAMERC                                  
000078     10 A901-ZONAMERC        PIC X(2).                            
000079*                       TELCLIEN                                  
000080     10 A901-TELCLIEN        PIC X(20).                           
000081*                       TLXCLIEN                                  
000082     10 A901-TLXCLIEN        PIC X(20).                           
000083*                       FAXCLIEN                                  
000084     10 A901-FAXCLIEN        PIC X(20).                           
000085*                       RIFEMIRO                                  
000086     10 A901-RIFEMIRO        PIC X(11).                           
000087*                       PAESORDI                                  
000088     10 A901-PAESORDI        PIC X(3).                            
000089*                       ZONAORDI                                  
000090     10 A901-ZONAORDI        PIC X(2).                            
000091*                       DATVASTA                                  
000092     10 A901-DATVASTA        PIC X(8).                            
000093*                       ATTENZDI                                  
000094     10 A901-ATTENZDI        PIC X(24).                           
000095*                       CONDPAGA                                  
000096     10 A901-CONDPAGA        PIC X(3).                            
000097*                       MMESCLU1                                  
000098     10 A901-MMESCLU1        PIC S9(2)V USAGE COMP-3.             
000099*                       MMESCLU2                                  
000100     10 A901-MMESCLU2        PIC S9(2)V USAGE COMP-3.             
000101*                       GGSCATRA                                  
000102     10 A901-GGSCATRA        PIC S9(2)V USAGE COMP-3.             
000103*                       NUMGGVIA                                  
000104     10 A901-NUMGGVIA        PIC S9(2)V USAGE COMP-3.             
000105*                       TIPOTRAT                                  
000106     10 A901-TIPOTRAT        PIC X(1).                            
000107*                       ALTERSPE                                  
000108     10 A901-ALTERSPE        PIC X(1).                            
000109*                       CODILING                                  
000110     10 A901-CODILING        PIC X(1).                            
000111*                       DTULTVAR                                  
000112     10 A901-DTULTVAR        PIC X(8).                            
000113*                       TIPCLCAR                                  
000114     10 A901-TIPCLCAR        PIC X(1).                            
000115*                       SPETRASP                                  
000116     10 A901-SPETRASP        PIC X(1).                            
000117*                       DTCREAZI                                  
000118     10 A901-DTCREAZI        PIC X(8).                            
000119*                       CODDIVIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000120     10 A901-CODDIVIS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000121*                       CDIVACEE                                  
000122     10 A901-CDIVACEE        PIC X(14).                           
000123*                       ZONAFATT                                  
000124     10 A901-ZONAFATT        PIC X(2).                            
000125*                       CLASDOGA                                  
000126     10 A901-CLASDOGA        PIC X(1).                            
000127*                       INTNCLIE                                  
000128     10 A901-INTNCLIE        PIC X(50).                           
000129*                       CAPOCOMM                                  
000130     10 A901-CAPOCOMM        PIC X(5).                            
000131*                       PRIORITA                                  
000132     10 A901-PRIORITA        PIC X(1).                            
000133*                       BULSTATX                                  
000134     10 A901-BULSTATX        PIC X(13).                           
000135*                       CODUTVAR                                  
000136     10 A901-CODUTVAR        PIC X(6).                            
000137*                       CODUTCRE                                  
000138     10 A901-CODUTCRE        PIC X(6).                            
000139*                       CDRESCON                                  
000140     10 A901-CDRESCON        PIC X(2).                            
000141*                       CENCOACQ                                  
000142     10 A901-CENCOACQ        PIC X(5).                            
000143*                       CAPOSOCI                                  
000144     10 A901-CAPOSOCI        PIC X(5).                            
000145*                       CDFISCAL                                  
000146     10 A901-CDFISCAL        PIC X(16).                           
000147*                       CONDPACA                                  
000148     10 A901-CONDPACA        PIC X(3).                            
000149*                       CODXIBAN                                  
000150     10 A901-CODXIBAN        PIC X(4).                            
000151*                       CODXXCIN                                  
000152     10 A901-CODXXCIN        PIC X(2).                            
000153*                       ZIPFATTU                                  
000154     10 A901-ZIPFATTU        PIC X(15).                           
000155*                       ZIPMERCE                                  
000156     10 A901-ZIPMERCE        PIC X(15).                           
000157*                       TIPOLIST                                  
000158     10 A901-TIPOLIST        PIC X(1).                            
000159*                       SWIFTCOD                                  
000160     10 A901-SWIFTCOD        PIC X(11).                           
000161*                       PERCEIVA                                  
000162     10 A901-PERCEIVA        PIC S9(3)V9(2) USAGE COMP-3.         
000163*                       DTVALIVA                                  
000164     10 A901-DTVALIVA        PIC X(8).                            
000165*                       CLASSCLI                                  
000166     10 A901-CLASSCLI        PIC X(1).                            
000167*                       RATINGCO                                  
000168     10 A901-RATINGCO        PIC X(3).                            
000169*                       RISCHCLI                                  
000170     10 A901-RISCHCLI        PIC X(1).                            
000171*                                                                 
000172     10 A901-NRPROIVA        PIC X(30).                           
000173*                                                                 
000174     10 A901-IMPESNEW        PIC S9(9)V9(2) USAGE COMP-3.         
000175     10 A901-TIPOSTAG        PIC X(1).                            
000176     10 A901-FLFATELE        PIC X(1).                            
000177     10 A901-CDDESTFE        PIC X(7).                            
000178     10 A901-INPECCLI        PIC X(50).                           
000179******************************************************************
000180* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 88      *
000181******************************************************************
      *<<((file: FDANA901))
000722*--------------------------------DANAGRAF.TDATARIO                
000723 01  FILLER                      PIC X(8) VALUE 'FDANA973'.       
000724*    EXEC SQL INCLUDE FDANA973 END-EXEC.                          
      *>>((file: FDANA973))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TDATARIO)                                *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA973))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(A973-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DANAGRAF.TDATARIO TABLE                     
000012*     ( DTGIORNO                       CHAR(8) NOT NULL,           
000013*       PRGIORNO                       DECIMAL(7, 0) NOT NULL,     
000014*       NUMGIORN                       CHAR(3) NOT NULL,           
000015*       NUMSETTI                       CHAR(2) NOT NULL,           
000016*       NRGGSETT                       CHAR(1) NOT NULL,           
000017*       DTINISET                       CHAR(8) NOT NULL,           
000018*       DTFINSET                       CHAR(8) NOT NULL,           
000019*       DTINIMES                       CHAR(8) NOT NULL,           
000020*       DTFINMES                       CHAR(8) NOT NULL,           
000021*       ANNOSETT                       CHAR(6) NOT NULL,           
000022*       FLAGFEST                       CHAR(1) NOT NULL            
000023*     ) END-EXEC
                                                                        
000024******************************************************************
000025* COBOL DECLARATION FOR TABLE DANAGRAF.TDATARIO                  *
000026******************************************************************
000027 01  DCLTDATARIO.                                                 
000028*                       DTGIORNO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000029     10 A973-DTGIORNO        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000030*                       PRGIORNO                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000031     10 A973-PRGIORNO        PIC S9(7)V USAGE COMP-3.             
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000032*                       NUMGIORN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000033     10 A973-NUMGIORN        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000034*                       NUMSETTI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000035     10 A973-NUMSETTI        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000036*                       NRGGSETT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000037     10 A973-NRGGSETT        PIC X(1).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000038*                       DTINISET                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000039     10 A973-DTINISET        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000040*                       DTFINSET                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000041     10 A973-DTFINSET        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000042*                       DTINIMES                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000043     10 A973-DTINIMES        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000044*                       DTFINMES                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000045     10 A973-DTFINMES        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000046*                       ANNOSETT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000047     10 A973-ANNOSETT        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000048*                       FLAGFEST                                  
000049     10 A973-FLAGFEST        PIC X(1).                            
000050******************************************************************
000051* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 11      *
000052******************************************************************
      *<<((file: FDANA973))
000725*--------------------------------DANAGRAF.TSOCIETA                
000726 01  FILLER                      PIC X(8) VALUE 'FDANA531'.       
000727*    EXEC SQL INCLUDE FDANA531 END-EXEC.                          
      *>>((file: FDANA531))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TSOCIETA                  *
000003******************************************************************
000004 01  DCLTSOCIETA.                                                 
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 A531-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000006     10 A531-NOMSOCIE        PIC X(23).                           
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000007     10 A531-CODFORNI        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000008     10 A531-TASSINTE        PIC S9(3)V9(2) USAGE COMP-3.         
000009     10 A531-CODPAESE        PIC X(3).                            
000010     10 A531-NRGGRISC        PIC S9(3)V USAGE COMP-3.             
000011     10 A531-CODPIANO        PIC X(2).                            
000012     10 A531-CITTASOC        PIC X(18).                           
000013     10 A531-FLPAGIVA        PIC X(1).                            
000014     10 A531-FLFATACQ        PIC X(1).                            
000015     10 A531-CODAZIEN        PIC X(5).                            
000016     10 A531-FLIVATRA        PIC X(1).                            
000017     10 A531-CODDIVIS        PIC X(2).                            
000018     10 A531-COSTINTE        PIC S9(3)V9(2) USAGE COMP-3.         
000019     10 A531-FLCONTAB        PIC X(1).                            
000020     10 A531-FLAGMAGA        PIC X(1).                            
000021     10 A531-RAGSOCIE        PIC X(50).                           
000022     10 A531-SOCIECON        PIC X(2).                            
000023     10 A531-DTCREAZI        PIC X(8).                            
000024     10 A531-DTULTVAR        PIC X(8).                            
000025     10 A531-CODUTVAR        PIC X(6).                            
000026     10 A531-INDLEGAL        PIC X(35).                           
000027     10 A531-CAPLEGAL        PIC X(5).                            
000028     10 A531-CITLEGAL        PIC X(18).                           
000029     10 A531-CODFISCA        PIC X(16).                           
000030     10 A531-CODDIVRI        PIC X(2).                            
000031     10 A531-SOCIEGTM        PIC X(2).                            
000032     10 A531-GENEFATT        PIC X(1).                            
000033     10 A531-FLAGATTI        PIC X(1).                            
000034     10 A531-DIVISOLD        PIC X(2).                            
000035     10 A531-DTFINOLD        PIC X(8).                            
000036     10 A531-DIVRIOLD        PIC X(2).                            
000037     10 A531-DIVIRIFA        PIC X(2).                            
000038     10 A531-FLEURUSA        PIC X(1).                            
000039     10 A531-FLAGLIMI        PIC X(1).                            
000040     10 A531-FLFILIAL        PIC X(1).                            
000041     10 A531-FLPRESEN        PIC X(1).                            
000042     10 A531-CODSOCPA        PIC X(1).                            
000043     10 A531-FLBOLGVB        PIC X(1).                            
000044     10 A531-FLSTCART        PIC X(1).                            
000045     10 A531-FLDIPEST        PIC X(1).                            
000046     10 A531-CODFIRMA        PIC X(8).                            
000047     10 A531-DESFIRMA        PIC X(24).                           
000048     10 A531-CDSOCJDE        PIC X(5).                            
000049     10 A531-CODFORNV        PIC X(5).                            
000050     10 A531-CODFORNA        PIC X(5).                            
000051     10 A531-IMPCCASO        PIC S9(13) COMP-3.                   
000052     10 A531-TRIBCCIA        PIC X(10).                           
000053     10 A531-PROLEGAL        PIC X(2).                            
000054     10 A531-FLSOCSAP        PIC X(1).                            
000055     10 A531-DIVIXLAV        PIC X(2).                            
000056******************************************************************
000057* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 51      *
000058******************************************************************
      *<<((file: FDANA531))
000728*--------------------------------DANAGRAF.TDIVISE                 
000729 01  FILLER                      PIC X(8) VALUE 'FDANA963'.       
000730*    EXEC SQL INCLUDE FDANA963 END-EXEC.                          
      *>>((file: FDANA963))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TDIVISE                   *
000003******************************************************************
000004 01  DCLTDIVISE.                                                  
000005*                       SIGLADIV                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006     10 A963-SIGLADIV        PIC X(3).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007*                       CAMBIODV                                  
000008     10 A963-CAMBIODV        PIC S9(5)V9(6) USAGE COMP-3.         
000009*                       DESCDIVI                                  
000010     10 A963-DESCDIVI        PIC X(20).                           
000011*                       CODDIVIS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000012     10 A963-CODDIVIS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000013*                       DECIDIVI                                  
000014     10 A963-DECIDIVI        PIC X(1).                            
000015*                       DIVIBANC                                  
000016     10 A963-DIVIBANC        PIC X(3).                            
000017*                       DIVIPREZ                                  
000018     10 A963-DIVIPREZ        PIC X(1).                            
000019*                       CODDIVRI                                  
000020     10 A963-CODDIVRI        PIC X(2).                            
000021*                       RAPPCAMB                                  
000022     10 A963-RAPPCAMB        PIC S9(5)V USAGE COMP-3.             
000023*                       CODDIGTM                                  
000024     10 A963-CODDIGTM        PIC X(2).                            
000025*                       FLAGEURO                                  
000026     10 A963-FLAGEURO        PIC X(1).                            
000027*                       SLDIVBAN                                  
000028     10 A963-SLDIVBAN        PIC X(3).                            
000029*                       CDDIVSCA                                  
000030     10 A963-CDDIVSCA        PIC X(2).                            
000031*                       FLDIVINT                                  
000032     10 A963-FLDIVINT        PIC X(1).                            
000033     10 A963-VBDIVSCA        PIC X(2).                            
000034******************************************************************
000035* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 15      *
000036******************************************************************
      *<<((file: FDANA963))
000731*--------------------------------DANAGRAF.TMESSAGGI               
000732 01  FILLER                      PIC X(8) VALUE 'FDANA846'.       
000733*    EXEC SQL INCLUDE FDANA846 END-EXEC.                          
      *>>((file: FDANA846))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TMESSAGGI)                               *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA846))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        QUOTE                                                   *
000007* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000008******************************************************************
000009     
      *EXEC SQL DECLARE DANAGRAF.TMESSAGGI TABLE                    
000010*     ( CODERROR                       CHAR(5) NOT NULL,           
000011*       CODILING                       CHAR(1) NOT NULL,           
000012*       MSGERROR                       CHAR(60) NOT NULL,          
000013*       TIPOMESS                       CHAR(1) NOT NULL,           
000014*       DTCREAZI                       CHAR(8) NOT NULL,           
000015*       DTULTVAR                       CHAR(8) NOT NULL,           
000016*       CODUTVAR                       CHAR(6) NOT NULL            
000017*     ) END-EXEC
                                                                        
000018******************************************************************
000019* COBOL DECLARATION FOR TABLE DANAGRAF.TMESSAGGI                 *
000020******************************************************************
000021 01  DCLTMESSAGGI.                                                
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000022     10 A846-CODERROR        PIC X(5).                            
000023     10 A846-CODILING        PIC X(1).                            
000024     10 A846-MSGERROR        PIC X(60).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025     10 A846-TIPOMESS        PIC X(1).                            
000026     10 A846-DTCREAZI        PIC X(8).                            
000027     10 A846-DTULTVAR        PIC X(8).                            
000028     10 A846-CODUTVAR        PIC X(6).                            
000029******************************************************************
000030* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 7       *
000031******************************************************************
      *<<((file: FDANA846))
000734*--------------------------------'DATEDATE'                       
000735 01  FILLER                      PIC X(8) VALUE 'FDANA082'.       
000736*    EXEC SQL INCLUDE FDANA082 END-EXEC.                          
      *>>((file: FDANA082))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.VANAGRAF_082)                            *
000003*        LIBRARY(PROG169.MTCSV440.DCLGEN(FDANA082))              *
000004*        LANGUAGE(COBOL)                                         *
000005*        QUOTE                                                   *
000006* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000007******************************************************************
000008     
      *EXEC SQL DECLARE DANAGRAF.VANAGRAF_082 TABLE                 
000009*     ( DATEDATE                       CHAR(10) NOT NULL           
000010*     ) END-EXEC
                                                                        
000011******************************************************************
000012* COBOL DECLARATION FOR TABLE DANAGRAF.VANAGRAF_082              *
000013******************************************************************
000014 01  DCLVANAGRAF-082.                                             
000015  10 A082-DATEDATE             PIC X(10).                         
000016******************************************************************
000017* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 1       *
000018******************************************************************
      *<<((file: FDANA082))
000737*--------------------------------DCDTGG                           
000738 01  FILLER                      PIC X(8) VALUE '**DCDTGG'.       
000739*    EXEC SQL INCLUDE DCDTGG   END-EXEC.                          
      *>>((file: DCDTGG))
000001*----------------------------------------------------------------*
000002*----               AREA PER SUBROUTINE SRDTGG               ----*
000003*----------------------------------------------------------------*
000004 01  DCDTGG.                                                      
000005*-------------------------------------------- CAMPI DI INPUT      
000006     02 DTGG-DTRICHIE         PIC X(08)         VALUE SPACES.     
000007     02 DTGG-PRRICHIE         PIC S9(7) COMP-3  VALUE +0.         
000008                                                                  
000009*-------------------------------------------- CAMPI DI OUTPUT     
000010     02 DTGG-DTGIORNO.                                            
000011        03 DTGG-SAGIORNO.                                         
000012           04 DTGG-SSGIORNO   PIC XX.                             
000013           04 DTGG-AAGIORNO   PIC XX.                             
000014        03 DTGG-MMGIORNO      PIC XX.                             
000015        03 DTGG-GGGIORNO      PIC XX.                             
000016     02 DTGG-PRGIORNO         PIC S9(7) COMP-3.                   
000017     02 DTGG-NUMSETTI         PIC X(02).                          
000018     02 DTGG-NUMGIORN         PIC X(03).                          
000019     02 DTGG-NRGGSETT         PIC X(01).                          
000020     02 DTGG-DTINISET.                                            
000021        03 DTGG-SAINISET.                                         
000022           04 DTGG-SSINISET   PIC XX.                             
000023           04 DTGG-AAINISET   PIC XX.                             
000024        03 DTGG-MMINISET      PIC XX.                             
000025        03 DTGG-GGINISET      PIC XX.                             
000026     02 DTGG-DTFINSET         PIC X(08).                          
000027     02 DTGG-DTINIMES         PIC X(08).                          
000028     02 DTGG-DTFINMES         PIC X(08).                          
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000029     02 DTGG-CURRENDT         PIC X(08).                          
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000030     02 DTGG-DTCURREN.                                            
000031        03 DTGG-AACURREN      PIC X(04).                          
000032        03 DTGG-MMCURREN      PIC X(02).                          
000033        03 DTGG-GGCURREN      PIC X(02).                          
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000034     02 DTGG-DATAGIOR         PIC X(10).                          
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000035     02 DTGG-ANNOSETT.                                            
000036        03 DTGG-SSAASETT      PIC X(04).                          
000037        03 DTGG-SETTSETT      PIC X(02).                          
000038     02 DTGG-FILLER4          PIC X(04).                          
000039     02 DTGG-RETUCODE         PIC X(04).                          
000040*----------------------------------------------------------------*
      *<<((file: DCDTGG))
000741     
      *EXEC SQL 
      *DECLARE POINTER1  CURSOR FOR                            
000742*           SELECT CODCLIEN, DTINILIS                              
000743*                 ,DTFINLIS, CODSERVI                              
000744*                 ,TIPSERVI, CODDIVIS                              
000745*                 ,PREZZLIS, PERCLIST                              
000746*             FROM DLOGISTI.TLISTILOGI A                           
000747*            WHERE CODCLIEN = :L654-CODCLIEN                       
000748*              AND DTINILIS = :L654-DTINILIS                       
000749*              AND DTFINLIS = :L654-DTFINLIS                       
000750*              AND TIPSERVI = :L654-TIPSERVI                       
000751*              AND CODDIVIS = :L654-CODDIVIS                       
000752*         ORDER BY CODSERVI                                        
000753*     END-EXEC
                                                                        
000755     
      *EXEC SQL 
      *DECLARE POINTPF13 CURSOR FOR                            
000756*           SELECT CODCLIEN, RAGFATTU                              
000757*             FROM DANAGRAF.TCLIENTI                               
000758*            WHERE CODCLIEN > :WS-CODCLIEN                         
000759*              AND RAGFATTU LIKE :WS-RAGFATTU                      
000760*              AND CODSOCIE = '22'                                 
000761*            ORDER BY CODCLIEN                                     
000762*     END-EXEC
                                                                        
000764     
      *EXEC SQL 
      *DECLARE POINTPF14 CURSOR FOR                            
000765*           SELECT CODCLIEN, RAGFATTU                              
000766*             FROM DANAGRAF.TCLIENTI                               
000767*            WHERE CODCLIEN < :WS-CODCLIEN                         
000768*              AND RAGFATTU LIKE :WS-RAGFATTU                      
000769*              AND CODSOCIE = '22'                                 
000770*            ORDER BY CODCLIEN DESC                                
000771*     END-EXEC
                                                                        
000774*    EXEC SQL                                                     
      *         INCLUDE SQLCA                                           
      *    END-EXEC.                                                    
      *>>((file: SQLCA))
000001****************************************************************<*
000002* Copyright (c) 2016-2023 NTT DATA, Inc. All rights reserved.  *<*
000003* Users of NTT DATA Enterprise COBOL may freely                *<*
000004* redistribute this copybook.                                  *<*
000005****************************************************************<*
000006                                                                  
000007 01  SQLCA GLOBAL.                                                
000008     05  SQLCAID                PIC X(8).                         
000009     05  SQLCABC                PIC S9(9) COMP-5.                 
000010     05  SQLCODE                PIC S9(9) COMP-5.                 
000011     05  SQLERRM.                                                 
000012         49  SQLERRML           PIC S9(4) COMP-5.                 
000013         49  SQLERRMC           PIC X(254).                       
000014     05  SQLERRP                PIC X(8).                         
000015     05  SQLERRD OCCURS 6 TIMES PIC S9(9) COMP-5.                 
000016     05  SQLWARN.                                                 
000017         10 SQLWARN0            PIC X(1).                         
000018         10 SQLWARN1            PIC X(1).                         
000019         10 SQLWARN2            PIC X(1).                         
000020         10 SQLWARN3            PIC X(1).                         
000021         10 SQLWARN4            PIC X(1).                         
000022         10 SQLWARN5            PIC X(1).                         
000023         10 SQLWARN6            PIC X(1).                         
000024         10 SQLWARN7            PIC X(1).                         
000025     05  SQLSTATE               PIC X(5).                         
000026     05  SQLEXT                 PIC S9(5) COMP-3 VALUE 1.         
      *<<((file: SQLCA))
000775****************************************************************  
000776*                                                                 
000777* Copyright (c) 2016-2022 NTT DATA, Inc.                          
000778* All rights reserved.                                            
000779*                                                                 
000780****************************************************************  
000781 01  DFHEIV.                                                      
000782   02  DFHEIV0               PIC X(35).                           
000783   02  DFHEIV1               PIC X(08).                           
000784   02  DFHEIV2               PIC X(08).                           
000785   02  DFHEIV3               PIC X(08).                           
000786   02  DFHEIV4               PIC X(06).                           
000787   02  DFHEIV5               PIC X(04).                           
000788   02  DFHEIV6               PIC X(04).                           
000789   02  DFHEIV7               PIC X(02).                           
000790   02  DFHEIV8               PIC X(02).                           
000791   02  DFHEIV9               PIC X(01).                           
000792   02  DFHEIV10              PIC S9(7) COMP-3.                    
000793   02  DFHEIV11              PIC S9(4) COMP SYNC.                 
000794   02  DFHEIV12              PIC S9(4) COMP SYNC.                 
000795   02  DFHEIV13              PIC S9(4) COMP SYNC.                 
000796   02  DFHEIV14              PIC S9(4) COMP SYNC.                 
000797   02  DFHEIV15              PIC S9(4) COMP SYNC.                 
000798   02  DFHEIV16              PIC S9(9) COMP SYNC.                 
000799   02  DFHEIV17              PIC X(04).                           
000800   02  DFHEIV18              PIC X(04).                           
000801   02  DFHEIV19              PIC X(04).                           
000802   02  DFHEIV20              USAGE IS POINTER.                    
000803   02  DFHEIV21              USAGE IS POINTER.                    
000804   02  DFHEIV22              USAGE IS POINTER.                    
000805   02  DFHEIV23              USAGE IS POINTER.                    
000806   02  DFHEIV24              USAGE IS POINTER.                    
000807   02  DFHEIV25              PIC S9(9) COMP SYNC.                 
000808   02  DFHEIV26              PIC S9(9) COMP SYNC.                 
000809   02  DFHEIV27              PIC S9(9) COMP SYNC.                 
000810   02  DFHEIV28              PIC S9(9) COMP SYNC.                 
000811   02  DFHEIV29              PIC S9(9) COMP SYNC.                 
000812   02  DFHEIV30              PIC S9(9) COMP SYNC.                 
000813   02  DFHEIV31              PIC S9(9) COMP SYNC.                 
000814   02  DFHEIV32              PIC S9(4) COMP SYNC.                 
000815   02  DFHEIV33              PIC S9(4) COMP SYNC.                 
000816   02  DFHEIV34              PIC S9(4) COMP SYNC.                 
000817   02  DFHEIV35              PIC S9(4) COMP SYNC.                 
000818   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.         
000819   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.      
000820   02  FILLER                PIC X(02).                           
000821   02  DFHEIV99              PIC X(08) VALUE SPACE.               
000822   02  DFHEIVL0              PIC X(48) VALUE SPACE.               
000823   02  DFHEIVL1              PIC X(48) VALUE SPACE.               
000824   02  DFHEIVL2              PIC X(48) VALUE SPACE.               
000825   02  DFHEIVL3              PIC X(48) VALUE SPACE.               
000826   02  DFHEIVL4              PIC X(255) VALUE SPACE.              
000827   02  DFHEIVL5              PIC X(255) VALUE SPACE.              
000828 LINKAGE  SECTION.                                                
000829***************************************************************** 
000830*                                                               * 
000831* Copyright (c) 2016-2022 NTT DATA, Inc.                        * 
000832* All rights reserved.                                          * 
000833*                                                               * 
000834***************************************************************** 
000835 01  dfheiblk.                                                    
000836     02  eibtime          pic s9(7) comp-3.                       
000837     02  eibdate          pic s9(7) comp-3.                       
000838     02  eibtrnid         pic x(4).                               
000839     02  eibtaskn         pic s9(7) comp-3.                       
000840     02  eibtrmid         pic x(4).                               
000841     02  dfheigdi         pic s9(4) comp.                         
000842     02  eibcposn         pic s9(4) comp.                         
000843     02  eibcalen         pic s9(4) comp.                         
000844     02  eibaid           pic x(1).                               
000845     02  eibfiller1       pic x(1).                               
000846     02  eibfn            pic x(2).                               
000847     02  eibfiller2       pic x(2).                               
000848     02  eibrcode         pic x(6).                               
000849     02  eibfiller3       pic x(2).                               
000850     02  eibds            pic x(8).                               
000851     02  eibreqid         pic x(8).                               
000852     02  eibrsrce         pic x(8).                               
000853     02  eibsync          pic x(1).                               
000854     02  eibfree          pic x(1).                               
000855     02  eibrecv          pic x(1).                               
000856     02  eibsend          pic x(1).                               
000857     02  eibatt           pic x(1).                               
000858     02  eibeoc           pic x(1).                               
000859     02  eibfmh           pic x(1).                               
000860     02  eibcompl         pic x(1).                               
000861     02  eibsig           pic x(1).                               
000862     02  eibconf          pic x(1).                               
000863     02  eiberr           pic x(1).                               
000864     02  eibrldbk         pic x(1).                               
000865     02  eiberrcd         pic x(4).                               
000866     02  eibsynrb         pic x(1).                               
000867     02  eibnodat         pic x(1).                               
000868     02  eibfiller5       pic x(2).                               
000869     02  eibresp          pic s9(8) comp.                         
000870     02  eibresp2         pic s9(8) comp.                         
000871     02  dfheigdj         pic s9(4) comp.                         
000872     02  dfheigdk         pic s9(4) comp.                         
000873*----------------*                                                
000874 01  DFHCOMMAREA.                                                 
000875*    COPY DCLCOMMA.                                               
000876     02 LK-AREABYTE PIC X OCCURS 0 TO 4096 TIMES                  
000877                       DEPENDING ON EIBCALEN OF DFHEIBLK.         
000878*-----------------------------------------------------------------
000879 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.                   
000879 VCOBOL-DUMMY-PROCEDURE.
000880 0000-DFHENTRY SECTION.                                           
000881     MOVE FUNCTION WHEN-COMPILED TO DFHEIVL0(1:21).               
000882     MOVE SPACES TO DFHEIV2.                                      
000883     MOVE '9#                    &   ' TO DFHEIV0.                
000884     MOVE 'AVTLO50' TO DFHEIV1.                                   
000885     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1       
000886          DFHEIVL0 DFHEIV2.                                       
000887*-----------------------------------------------------------------
000888                                                                  
000889* EXEC CICS HANDLE ABEND LABEL(Z00-ERRORE)     END-EXEC.          
000890*    MOVE '..L                   " " #00000881' TO DFHEIV0        
000891     MOVE X'2E2E4C202020202020202020' &                           
000892          X'202020202020202020202220' &                           
000893          X'2220233030303030383831' TO DFHEIV0                    
000894     CALL 'kxdfhei1' USING DFHEIV0,                               
000895           DFHEIV99                                               
000896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
000897                                                                  
000898     PERFORM A00-INIZIALIZZAZIONE                                 
000899        THRU A00-EX.                                              
000900     IF  EIBCALEN NOT > ZERO                                      
000901         PERFORM B00-ARRIVO-DA-START                              
000902            THRU B00-EX                                           
000903     ELSE                                                         
000904         MOVE DFHCOMMAREA        TO WCOM-AREAXXXX                 
000905         MOVE 'AVMLO50'          TO WNOMEMAP                      
000906         MOVE WCOM-CODILING      TO WCODLING                      
000907         IF EIBAID = DFHENTER OR                                  
000908            EIBAID = DFHPF10  OR                                  
000909            EIBAID = DFHPF13  OR                                  
000910            EIBAID = DFHPF14                                      
000911            PERFORM C00-RICEVI-MAPPA                              
000912               THRU C00-EX                                        
000913         ELSE                                                     
000914            PERFORM D00-GESTIONE-PF                               
000915               THRU D00-EX.                                       
000916     PERFORM E30-INVIA-MAPPA                                      
000917        THRU E30-EX.                                              
000918     PERFORM U00-RETURN-TRAN                                      
000919        THRU U00-EX.                                              
000920*----------------------------------------------------------------*
000921 A00-INIZIALIZZAZIONE.                                            
000922*----------------------------------------------------------------*
000923     MOVE +500                   TO WCOM-LUNGHEZZ.                
000924     MOVE 'LOLI'                 TO WPAGNOME                      
000925     MOVE EIBTRMID               TO WPAGVIDE                      
000926                                    WLO50-TERMINAL                
000927     MOVE LOW-VALUE              TO AVILO50O.                     
000928     MOVE 18                     TO WNUMRIGA.                     
000929     MOVE LENGTH OF WPAGREFE     TO WPAGLPAG.                     
000930     MOVE LENGTH OF WLO50-CODA   TO WLO50-LENGTH.                 
000931     MOVE 18                     TO WLO50-WNUMRIGA.               
000932 A00-EX. EXIT.                                                    
000933*----------------------------------------------------------------*
000934 B00-ARRIVO-DA-START.                                             
000935*----------------------------------------------------------------*
000936                                                                  
000937* EXEC CICS HANDLE CONDITION ENDDATA (B05-NORESP)                 
000938*                               END-EXEC                          
000939*    MOVE '"$&                   ! # #00000920' TO DFHEIV0        
000940     MOVE X'222426202020202020202020' &                           
000941          X'202020202020202020202120' &                           
000942          X'2320233030303030393230' TO DFHEIV0                    
000943     CALL 'kxdfhei1' USING DFHEIV0                                
000944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
000945                                                                  
000946* EXEC CICS RETRIEVE INTO   (WCOM-AREAXXXX)                       
000947*                       LENGTH (WCOM-LUNGHEZZ)                    
000948*                       END-EXEC                                  
000949*    MOVE '0*I L                 &   #00000922' TO DFHEIV0        
000950     MOVE X'302A49204C20202020202020' &                           
000951          X'202020202020202020202620' &                           
000952          X'2020233030303030393232' TO DFHEIV0                    
000953     CALL 'kxdfhei1' USING DFHEIV0,                               
000954           WCOM-AREAXXXX,                                         
000955           WCOM-LUNGHEZZ,                                         
000956           DFHEIV99,                                              
000957           DFHEIV99,                                              
000958           DFHEIV99                                               
000959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
000960     MOVE WCOM-NOMEPRGM          TO WS-PROGPREC.                  
000961     IF WS-PROGPREC = 'AVTLO10'                                   
000962        PERFORM LEGGO-RICICLO                                     
000963           THRU LEGGO-RICICLO-EX.                                 
000964     PERFORM B10-PRIMA-VOLTA                                      
000965        THRU B10-EX.                                              
000966     IF WS-PROGPREC = 'AVTLO10'                                   
000967        MOVE WCOM-PAGITRAN(WCOM-INDITRAN) TO WCOM-PAGIRICH        
000968        PERFORM B20-PROPONI-DATI                                  
000969           THRU B20-EX                                            
000970        PERFORM B30-PULISCI-CODA                                  
000971           THRU B30-EX                                            
000972     ELSE                                                         
000973        PERFORM U30-DELETE-WPAGLO50                               
000974           THRU U30-EX                                            
000975        MOVE WCOM-CODCLIEN          TO LO50-CODCLIENI             
000976        MOVE WCOM-RAGFATTU          TO LO50-RAGFATTUI             
000977        MOVE WCOM-DTINILIS          TO LO50-DTINILISI             
000978        MOVE WCOM-DTFINLIS          TO LO50-DTFINLISI             
000979        MOVE WCOM-CODDIVIS          TO LO50-CODDIVISI             
000980        MOVE SPACES                 TO WCOM-CODSOCI1              
000981                                       WCOM-CAMBIODT              
000982        PERFORM C20-GESTIONE-RICICLO                              
000983           THRU C20-EX.                                           
000984 B00-EX. EXIT.                                                    
000985*----------------------------------------------------------------*
000986 B05-NORESP.                                                      
000987*----------------------------------------------------------------*
000988                                                                  
000989* EXEC CICS SEND CONTROL                                          
000990*                   ERASE                                         
000991*                   CURSOR                                        
000992*                   FREEKB                                        
000993*                   END-EXEC.                                     
000994     MOVE -1                                                      
000995       TO DFHEIV11                                                
000996*    MOVE '82     CT  E F        (   #00000953' TO DFHEIV0        
000997     MOVE X'383220202020204354202045' &                           
000998          X'204620202020202020202820' &                           
000999          X'2020233030303030393533' TO DFHEIV0                    
001000     CALL 'kxdfhei1' USING DFHEIV0,                               
001001           DFHEIV99,                                              
001002           DFHEIV99,                                              
001003           DFHEIV99,                                              
001004           DFHEIV11,                                              
001005           DFHEIV99,                                              
001006           DFHEIV99,                                              
001007           DFHEIV99                                               
001008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001009                                                                  
001010                                                                  
001011* EXEC CICS RETURN END-EXEC.                                      
001012*    MOVE '.(                    ''   #00000958' TO DFHEIV0       
001013     MOVE X'2E2820202020202020202020' &                           
001014          X'202020202020202020202720' &                           
001015          X'2020233030303030393538' TO DFHEIV0                    
001016     CALL 'kxdfhei1' USING DFHEIV0,                               
001017           DFHEIV99,                                              
001018           DFHEIV99,                                              
001019           DFHEIV99,                                              
001020           DFHEIV99,                                              
001021           DFHEIV99,                                              
001022           DFHEIV99                                               
001023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001024                                                                  
001025                                                                  
001026* GOBACK.                                                         
001027     MOVE '9%                    "   ' TO DFHEIV0                 
001028     MOVE 'AVTLO50' TO DFHEIV1                                    
001029     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1                        
001030     GOBACK.                                                      
001031 B05-EX. EXIT.                                                    
001032*----------------------------------------------------------------*
001033 B10-PRIMA-VOLTA.                                                 
001034*----------------------------------------------------------------*
001035     MOVE 'AVTLO50'              TO WCOM-NOMEPRGM                 
001036     MOVE EIBTRNID               TO WCOM-TRANSAZI                 
001037     IF WS-PROGPREC NOT = 'AVTLO10'                               
001038        PERFORM U20-DELETE-TS                                     
001039           THRU U20-EX                                            
001040       MOVE ZEROES               TO WCOM-PAGIRICH                 
001041                                    WCOM-PAGILIST                 
001042                                    WPAGRICH                      
001043        MOVE 99999               TO WCOM-PAGIULTI.                
001044     MOVE 'AVMLO50'              TO WNOMEMAP                      
001045     MOVE WCOM-CODILING          TO WCODLING                      
001046     IF  WCOM-MENUTRAN (WCOM-INDITRAN) NOT = WCOM-TRANSAZI        
001047         ADD  1                  TO WCOM-INDITRAN                 
001048         MOVE WCOM-TRANSAZI      TO WCOM-MENUTRAN (WCOM-INDITRAN) 
001049         MOVE ZEROES             TO WCOM-PAGITRAN (WCOM-INDITRAN).
001050     IF  WCOM-INDITRAN > 10                                       
001051         MOVE 'TRTR'             TO WCOM-CODABEND                 
001052         PERFORM Z00-ERRORE                                       
001053            THRU Z00-EX.                                          
001054 B10-EX. EXIT.                                                    
001055*----------------------------------------------------------------*
001056 B20-PROPONI-DATI.                                                
001057*----------------------------------------------------------------*
001058     MOVE 1                      TO WLO50-ITEM.                   
001059     MOVE WCOM-CODCLIEN          TO LO50-CODCLIENO                
001060     MOVE WCOM-RAGFATTU          TO LO50-RAGFATTUO                
001061     MOVE WCOM-DTINILIS          TO LO50-DTINILISO                
001062     MOVE WCOM-DTFINLIS          TO LO50-DTFINLISO                
001063     MOVE WCOM-CODDIVIS          TO LO50-CODDIVISO                
001064     PERFORM R10-READQ-WPAGLO50                                   
001065        THRU R10-EX                                               
001066     MOVE 'I'                    TO WCOM-FLAGPRGM                 
001067     PERFORM VARYING WINDRIGA FROM 2 BY 1                         
001068       UNTIL WINDRIGA GREATER WNUMRIGA                            
001069             MOVE 'I'            TO LO50-OPERAZIOO(WINDRIGA)      
001070     END-PERFORM.                                                 
001071     MOVE 1                      TO WINDRIGA                      
001072     PERFORM VARYING WLO50-WINDRIGA FROM 1 BY 1                   
001073        UNTIL WLO50-WINDRIGA GREATER WLO50-WNUMRIGA               
001074           OR WLO50-CODSERVI(WLO50-WINDRIGA) NOT > SPACES         
001075        MOVE WLO50-CODSERVI(WLO50-WINDRIGA)                       
001076                                 TO LO50-CODSERVIO(WINDRIGA)      
001077        MOVE WLO50-DESSERVI(WLO50-WINDRIGA)                       
001078                                 TO LO50-DESSERVIO(WINDRIGA)      
001079        MOVE WLO50-UNMISURA(WLO50-WINDRIGA)                       
001080                                 TO LO50-UNMISURAO(WINDRIGA)      
001081        MOVE WLO50-PREZZLIS(WLO50-WINDRIGA)                       
001082                                 TO LO50-PREZZLISO(WINDRIGA)      
001083        MOVE WLO50-PERCLIST(WLO50-WINDRIGA)                       
001084                                 TO LO50-PERCLISTO(WINDRIGA)      
001085        ADD 1                    TO WINDRIGA                      
001086     END-PERFORM.                                                 
001087 B20-EX. EXIT.                                                    
001088*----------------------------------------------------------------*
001089 B30-PULISCI-CODA.                                                
001090*----------------------------------------------------------------*
001091     PERFORM VARYING WLO50-WINDRIGA FROM 2 BY 1                   
001092        UNTIL WLO50-WINDRIGA GREATER WLO50-WNUMRIGA               
001093        MOVE SPACES              TO WLO50-CODSERVI(WLO50-WINDRIGA)
001094        MOVE SPACES              TO WLO50-DESSERVI(WLO50-WINDRIGA)
001095        MOVE SPACES              TO WLO50-UNMISURA(WLO50-WINDRIGA)
001096        MOVE ZEROES              TO WLO50-PREZZLIS(WLO50-WINDRIGA)
001097                                    WLO50-PERCLIST(WLO50-WINDRIGA)
001098     END-PERFORM.                                                 
001099     MOVE 1                      TO WLO50-ITEM.                   
001100     MOVE 1                      TO WLO50-WINDRIGA                
001101     PERFORM R30-REWRITE-WPAGLO50                                 
001102        THRU R30-EX.                                              
001103 B30-EX. EXIT.                                                    
001104*----------------------------------------------------------------*
001105 C00-RICEVI-MAPPA.                                                
001106*----------------------------------------------------------------*
001107                                                                  
001108* EXEC CICS RECEIVE MAP    (WNOMEMAP)                             
001109*                      MAPSET ('AVMLO50')                         
001110*                      INTO   (AVILO50I)                          
001111*                      END-EXEC.                                  
001112     MOVE LENGTH OF                                               
001113      AVILO50I                                                    
001114       TO DFHEIV11                                                
001115     MOVE 'AVMLO50' TO DFHEIV1                                    
001116*    MOVE '8"T I  L              ''   #00001036' TO DFHEIV0       
001117     MOVE X'382254204920204C20202020' &                           
001118          X'202020202020202020202720' &                           
001119          X'2020233030303031303336' TO DFHEIV0                    
001120     CALL 'kxdfhei1' USING DFHEIV0,                               
001121           WNOMEMAP,                                              
001122           AVILO50I,                                              
001123           DFHEIV11,                                              
001124           DFHEIV1,                                               
001125           DFHEIV99,                                              
001126           DFHEIV99                                               
001127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001128                                                                  
001129     MOVE LOW-VALUE              TO LO50-MESSAGGO.                
001130     MOVE SPACES                 TO MESS-CODERROR.                
001131     IF LO50-MAPRPAGI IS NUMERIC AND                              
001132        LO50-MAPRPAGI > ZERO                                      
001133        MOVE LO50-MAPRPAGI       TO WPAGRICH                      
001134     ELSE                                                         
001135       MOVE WCOM-PAGIRICH        TO WPAGRICH.                     
001136     IF WPAGRICH NOT = WCOM-PAGIRICH                              
001137        MOVE SPACES              TO WCOM-FLAGPRGM                 
001138        PERFORM E20-PAGINA-PRONTA                                 
001139           THRU E20-EX                                            
001140     ELSE                                                         
001141        IF EIBAID = DFHPF13 OR                                    
001142           EIBAID = DFHPF14                                       
001143           MOVE SPACES           TO WCOM-FLAGPRGM                 
001144           PERFORM C10-CERCA-CLIENTE                              
001145              THRU C10-EX                                         
001146        ELSE                                                      
001147          INSPECT LO50-CODCLIENI REPLACING ALL LOW-VALUE BY SPACES
001148          INSPECT LO50-RAGFATTUI REPLACING ALL LOW-VALUE BY SPACES
001149          INSPECT LO50-DTINILISI REPLACING ALL LOW-VALUE BY SPACES
001150          INSPECT LO50-DTFINLISI REPLACING ALL LOW-VALUE BY SPACES
001151          INSPECT LO50-CODDIVISI REPLACING ALL LOW-VALUE BY SPACES
001152          IF LO50-CODCLIENI NOT = WCOM-CODCLIEN OR                
001153             LO50-RAGFATTUI NOT = WCOM-RAGFATTU OR                
001154             LO50-DTINILISI NOT = WCOM-DTINILIS OR                
001155             LO50-DTFINLISI NOT = WCOM-DTFINLIS OR                
001156             LO50-CODDIVISI NOT = WCOM-CODDIVIS                   
001157             PERFORM C20-GESTIONE-RICICLO                         
001158                THRU C20-EX                                       
001159          ELSE                                                    
001160             PERFORM C40-GESTIONE-RICEVI                          
001161                THRU C40-EX.                                      
001162 C00-EX. EXIT.                                                    
001163*----------------------------------------------------------------*
001164 C10-CERCA-CLIENTE.                                               
001165*----------------------------------------------------------------*
001166     IF LO50-RAGFATTUI NOT = WCOM-RAGFATTU AND                    
001167        LO50-RAGFATTUI > SPACES  AND                              
001168        WCOM-RAGFATT2 NOT > SPACES                                
001169        MOVE LO50-RAGFATTUI      TO WCOM-RAGFATT2                 
001170        MOVE SPACES              TO WS-CODCLIEN                   
001171        PERFORM C15-RICERCA-FORNITORE                             
001172           THRU C15-EX                                            
001173     ELSE                                                         
001174        IF WCOM-RAGFATT2 > SPACES                                 
001175           MOVE LO50-CODCLIENI   TO WS-CODCLIEN                   
001176           PERFORM C15-RICERCA-FORNITORE                          
001177              THRU C15-EX.                                        
001178 C10-EX. EXIT.                                                    
001179*----------------------------------------------------------------*
001180 C15-RICERCA-FORNITORE.                                           
001181*----------------------------------------------------------------*
001182     PERFORM C17-DESCRIZIONE-MAPPA                                
001183        THRU C17-EX.                                              
001184     MOVE 'OPEN'                 TO WCOM-FILEFUNZ.                
001185     MOVE 'C15-'                 TO WCOM-CODABEND.                
001186     MOVE SPACES                 TO WCOM-FILECTRL.                
001187     STRING WS-CODCLIEN ' ' WS-RAGFATTU                           
001188        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
001189     IF EIBAID = DFHPF13                                          
001190        MOVE 'POINTPF13'         TO WCOM-FILENOME                 
001191        
      *EXEC SQL OPEN POINTPF13 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 1 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CODCLIEN
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-RAGFATTU
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001192     ELSE                                                         
001193        MOVE 'POINTPF14'         TO WCOM-FILENOME                 
001194        
      *EXEC SQL OPEN POINTPF14 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 2 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-CODCLIEN
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-RAGFATTU
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                                              .                         
001195     IF SQLCODE NOT = ZEROES                                      
001196        PERFORM Z00-ERRORE                                        
001197           THRU Z00-EX.                                           
001198     IF EIBAID = DFHPF13                                          
001199        PERFORM L01-FETCH-POINTPF13                               
001200           THRU L01-EX                                            
001201     ELSE                                                         
001202        PERFORM L02-FETCH-POINTPF14                               
001203           THRU L02-EX.                                           
001204     MOVE SQLCODE                TO WS-SQLCODE2.                  
001205     MOVE 'CLOSE'                TO WCOM-FILEFUNZ.                
001206     MOVE 'C15-'                 TO WCOM-CODABEND.                
001207     MOVE SPACES                 TO WCOM-FILECTRL.                
001208     STRING WS-CODCLIEN ' ' WS-RAGFATTU                           
001209        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
001210     IF EIBAID = DFHPF13                                          
001211        MOVE 'POINTPF13'         TO WCOM-FILENOME                 
001212        
      *EXEC SQL CLOSE POINTPF13 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
001213     ELSE                                                         
001214        MOVE 'POINTPF14'         TO WCOM-FILENOME                 
001215        
      *EXEC SQL CLOSE POINTPF14 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                                               .                        
001216     IF SQLCODE NOT = ZEROES                                      
001217        PERFORM Z00-ERRORE                                        
001218           THRU Z00-EX.                                           
001219     IF WS-SQLCODE2 = ZEROES                                      
001220        MOVE A901-CODCLIEN       TO LO50-CODCLIENO                
001221        MOVE A901-RAGFATTU       TO LO50-RAGFATTUO                
001222                                    WCOM-RAGFATTU                 
001223        PERFORM C20-GESTIONE-RICICLO                              
001224           THRU C20-EX.                                           
001225 C15-EX. EXIT.                                                    
001226*----------------------------------------------------------------*
001227 C17-DESCRIZIONE-MAPPA.                                           
001228*----------------------------------------------------------------*
001229     MOVE SPACES                 TO WS-RAGFATT3.                  
001230     MOVE 1                      TO WS-IND2                       
001231     MOVE WCOM-RAGFATT2          TO WS-RAGFATT2.                  
001232     INSPECT WS-RAGFATT2 REPLACING ALL LOW-VALUE BY SPACES.       
001233     PERFORM VARYING WS-IND1 FROM 1 BY 1                          
001234               UNTIL WS-IND1 > 24                                 
001235        IF WS-BYTE2(WS-IND1) NUMERIC   OR                         
001236          (WS-BYTE2(WS-IND1) NOT < 'A' AND                        
001237           WS-BYTE2(WS-IND1) NOT > 'Z' ) OR                       
001238           WS-BYTE2(WS-IND1) = SPACES  OR                         
001239           WS-BYTE2(WS-IND1) = '%'                                
001240           MOVE WS-BYTE2(WS-IND1) TO WS-BYTE3(WS-IND2)            
001241           ADD 1                 TO WS-IND2                       
001242        END-IF                                                    
001243     END-PERFORM.                                                 
001244     STRING '%' WS-RAGFATT3 DELIMITED BY SIZE                     
001245                               INTO WS-RAGFATTU.                  
001246     INSPECT WS-RAGFATTU REPLACING ALL SPACES BY '%'.             
001247 C17-EX. EXIT.                                                    
001248*----------------------------------------------------------------*
001249 C20-GESTIONE-RICICLO.                                            
001250*----------------------------------------------------------------*
001251     MOVE SPACES                 TO WCOM-FLAGPRGM                 
001252     MOVE LOW-VALUE              TO WCOM-CODCLIEN                 
001253                                    WCOM-RAGFATTU                 
001254                                    WCOM-DTINILIS                 
001255                                    WCOM-DTFINLIS                 
001256                                    WCOM-CODDIVIS.                
001257     PERFORM C21-CONTROLLA-RICHIESTA                              
001258        THRU C21-EX.                                              
001259     PERFORM U20-DELETE-TS                                        
001260        THRU U20-EX.                                              
001261     PERFORM U30-DELETE-WPAGLO50                                  
001262        THRU U30-EX.                                              
001263     MOVE 99999                  TO WCOM-PAGIULTI.                
001264     MOVE ZERO                   TO WCOM-PAGIRICH                 
001265                                    WCOM-PAGILIST                 
001266                                    WPAGRICH.                     
001267     PERFORM E99-PULISCI-MAPPA                                    
001268        THRU E99-EX                                               
001269     IF ERRORE                                                    
001270        GO TO C20-EX.                                             
001271     MOVE SPACES                 TO WCOM-CAMBIODT.                
001272     IF LO50-DTINILISI NOT = WCOM-DTINILIS OR                     
001273        LO50-DTFINLISI NOT = WCOM-DTFINLIS                        
001274        MOVE 'S'                 TO WCOM-CAMBIODT.                
001275     MOVE LO50-CODCLIENI         TO WCOM-CODCLIEN.                
001276     MOVE LO50-RAGFATTUI         TO WCOM-RAGFATTU.                
001277     MOVE LO50-DTINILISI         TO WCOM-DTINILIS.                
001278     MOVE LO50-DTFINLISI         TO WCOM-DTFINLIS.                
001279     MOVE LO50-CODDIVISI         TO WCOM-CODDIVIS.                
001280     MOVE SPACES                 TO WCOM-CODSOCI1                 
001281     IF A901-CLIFOCON > SPACES                                    
001282        MOVE A901-CLIFOCON       TO A531-CODFORNI                 
001283        PERFORM L10-SELECT-SOCIETA                                
001284           THRU L10-EX                                            
001285        MOVE A531-CODSOCIE       TO WCOM-CODSOCI1                 
001286     ELSE                                                         
001287        MOVE A901-CODSOCIE       TO WCOM-CODSOCI1.                
001288     IF WCOM-CODSOCI1 = '08'                                      
001289        MOVE '16'                TO WCOM-CODSOCI1                 
001290     ELSE                                                         
001291        IF A901-TIPOCONS = 'T'                                    
001292           MOVE '15'             TO WCOM-CODSOCI1.                
001293     PERFORM E10-PREPARA-PAGINE                                   
001294        THRU E10-EX.                                              
001295     PERFORM E20-PAGINA-PRONTA                                    
001296        THRU E20-EX.                                              
001297 C20-EX. EXIT.                                                    
001298*----------------------------------------------------------------*
001299 C21-CONTROLLA-RICHIESTA.                                         
001300*----------------------------------------------------------------*
001301     INSPECT LO50-CODCLIENI REPLACING ALL LOW-VALUE BY SPACES.    
001302     INSPECT LO50-RAGFATTUI REPLACING ALL LOW-VALUE BY SPACES.    
001303     INSPECT LO50-DTINILISI REPLACING ALL LOW-VALUE BY SPACES.    
001304     INSPECT LO50-DTFINLISI REPLACING ALL LOW-VALUE BY SPACES.    
001305     INSPECT LO50-CODDIVISI REPLACING ALL LOW-VALUE BY SPACES.    
001306     IF LO50-CODCLIENI NOT > SPACES AND                           
001307        LO50-RAGFATTUI NOT > SPACES                               
001308        MOVE '*'                 TO WSWERROR                      
001309        MOVE '00053'             TO MESS-CODERROR                 
001310        MOVE DFHUNIMD            TO LO50-CODCLIENA                
001311                                    LO50-RAGFATTUA                
001312        MOVE DFHRED              TO LO50-CODCLIENC                
001313                                    LO50-RAGFATTUC                
001314        MOVE -1                  TO LO50-CODCLIENL                
001315        GO TO C21-EX.                                             
001316     IF LO50-CODCLIENI > SPACES                                   
001317        MOVE SPACES              TO LO50-RAGFATTUI                
001318        MOVE +5                  TO WLENGTH                       
001319        CALL WWTWSNU USING WLENGTH LO50-CODCLIENI                 
001320        MOVE LO50-CODCLIENI      TO A901-CODCLIEN                 
001321        PERFORM L15-SELECT-CLIENTI                                
001322           THRU L15-EX                                            
001323        IF SQLCODE = +100                                         
001324           MOVE '*'              TO WSWERROR                      
001325           MOVE '00112'          TO MESS-CODERROR                 
001326           MOVE DFHUNIMD         TO LO50-CODCLIENA                
001327           MOVE DFHRED           TO LO50-CODCLIENC                
001328           MOVE -1               TO LO50-CODCLIENL                
001329           GO TO C21-EX                                           
001330        ELSE                                                      
001331           MOVE A901-RAGFATTU    TO LO50-RAGFATTUO                
001332        END-IF                                                    
001333     ELSE                                                         
001334        IF LO50-RAGFATTUI > SPACES                                
001335           MOVE LO50-RAGFATTUI   TO WCOM-RAGFATT2                 
001336           PERFORM L17-SELECT-RAGFATTU                            
001337              THRU L17-EX                                         
001338           IF SQLCODE = +100                                      
001339              MOVE '*'           TO WSWERROR                      
001340              MOVE '00112'       TO MESS-CODERROR                 
001341              MOVE DFHUNIMD      TO LO50-RAGFATTUA                
001342              MOVE DFHRED        TO LO50-RAGFATTUC                
001343              MOVE -1            TO LO50-RAGFATTUL                
001344              GO TO C21-EX                                        
001345           ELSE                                                   
001346              MOVE A901-CODCLIEN TO LO50-CODCLIENI                
001347              MOVE A901-RAGFATTU TO LO50-RAGFATTUI.               
001348     IF LO50-DTINILISI NOT > SPACES                               
001349        MOVE '*'                 TO WSWERROR                      
001350        MOVE '00006'             TO MESS-CODERROR                 
001351        MOVE DFHUNIMD            TO LO50-DTINILISA                
001352        MOVE DFHRED              TO LO50-DTINILISC                
001353        MOVE -1                  TO LO50-DTINILISL                
001354        GO TO C21-EX                                              
001355     ELSE                                                         
001356        MOVE LO50-DTINILISI      TO DTGG-DTRICHIE(1:6)            
001357        MOVE '01'                TO DTGG-DTRICHIE(7:2)            
001358        PERFORM SRDTGG                                            
001359           THRU SRDTGG-EX                                         
001360        IF DTGG-RETUCODE NOT = '****'                             
001361           MOVE '*'              TO WSWERROR                      
001362           MOVE '00006'          TO MESS-CODERROR                 
001363           MOVE DFHUNIMD         TO LO50-DTINILISA                
001364           MOVE DFHRED           TO LO50-DTINILISC                
001365           MOVE -1               TO LO50-DTINILISL                
001366           GO TO C21-EX.                                          
001367     IF LO50-DTFINLISI NOT > SPACES                               
001368        MOVE '*'                 TO WSWERROR                      
001369        MOVE '00006'             TO MESS-CODERROR                 
001370        MOVE DFHUNIMD            TO LO50-DTFINLISA                
001371        MOVE DFHRED              TO LO50-DTFINLISC                
001372        MOVE -1                  TO LO50-DTFINLISL                
001373        GO TO C21-EX                                              
001374     ELSE                                                         
001375        MOVE LO50-DTFINLISI      TO DTGG-DTRICHIE(1:6)            
001376        MOVE '01'                TO DTGG-DTRICHIE(7:2)            
001377        PERFORM SRDTGG                                            
001378           THRU SRDTGG-EX                                         
001379        IF DTGG-RETUCODE NOT = '****'                             
001380           MOVE '*'              TO WSWERROR                      
001381           MOVE '00006'          TO MESS-CODERROR                 
001382           MOVE DFHUNIMD         TO LO50-DTFINLISA                
001383           MOVE DFHRED           TO LO50-DTFINLISC                
001384           MOVE -1               TO LO50-DTFINLISL                
001385           GO TO C21-EX.                                          
001386     IF LO50-DTINILISI > LO50-DTFINLISI                           
001387        MOVE '*'                 TO WSWERROR                      
001388        MOVE '00053'             TO MESS-CODERROR                 
001389        MOVE DFHUNIMD            TO LO50-DTFINLISA                
001390                                    LO50-DTINILISA                
001391        MOVE DFHRED              TO LO50-DTFINLISC                
001392                                    LO50-DTINILISC                
001393        MOVE -1                  TO LO50-DTFINLISL                
001394        GO TO C21-EX.                                             
001395     MOVE SPACES                 TO LO50-SIGLADIVO                
001396     IF LO50-CODDIVISI NOT > SPACES                               
001397        MOVE A901-CODDIVIS       TO LO50-CODDIVISI.               
001398     IF LO50-CODDIVISI > SPACES                                   
001399        MOVE LO50-CODDIVISI      TO A963-CODDIVIS                 
001400        PERFORM L20-SELECT-DIVISE                                 
001401           THRU L20-EX                                            
001402        IF SQLCODE = +100                                         
001403           MOVE '*'              TO WSWERROR                      
001404           MOVE '00986'          TO MESS-CODERROR                 
001405           MOVE DFHUNIMD         TO LO50-CODDIVISA                
001406           MOVE DFHRED           TO LO50-CODDIVISC                
001407           MOVE -1               TO LO50-CODDIVISL                
001408           GO TO C21-EX                                           
001409        ELSE                                                      
001410           MOVE A963-SIGLADIV    TO LO50-SIGLADIVO.               
001411 C21-EX. EXIT.                                                    
001412*----------------------------------------------------------------*
001413 C40-GESTIONE-RICEVI.                                             
001414*----------------------------------------------------------------*
001415     MOVE WCOM-PAGIRICH          TO WNUMITEM.                     
001416     PERFORM R00-READQ-WPAGCTRL                                   
001417        THRU R00-EX.                                              
001418     PERFORM F00-CONTROLLI                                        
001419        THRU F00-EX.                                              
001420     IF ERRORE OR                                                 
001421        WS-OPERAZIO NOT > SPACES                                  
001422        GO TO C40-EX.                                             
001423     IF EIBAID = DFHPF10                                          
001424        PERFORM G00-AGGIORNAMENTI                                 
001425           THRU G00-EX                                            
001426     ELSE                                                         
001427        MOVE '00030'          TO MESS-CODERROR.                   
001428 C40-EX. EXIT.                                                    
001429*----------------------------------------------------------------*
001430 D00-GESTIONE-PF.                                                 
001431*----------------------------------------------------------------*
001432     IF EIBAID NOT = DFHPF1 AND                                   
001433        EIBAID NOT = DFHPF2 AND                                   
001434        EIBAID NOT = DFHPF7 AND                                   
001435        EIBAID NOT = DFHPF8 AND                                   
001436        EIBAID NOT = DFHPF9                                       
001437        PERFORM D30-FUNZIONI-ESTERNE                              
001438           THRU D30-EX                                            
001439     ELSE                                                         
001440        IF EIBAID = DFHPF9                                        
001441           IF WCOM-FLAGPRGM NOT = 'I'                             
001442              PERFORM D20-INSERIMENTO                             
001443                 THRU D20-EX                                      
001444           ELSE                                                   
001445              PERFORM U02-NORESP                                  
001446                 THRU U02-EX                                      
001447           END-IF                                                 
001448        ELSE                                                      
001449           IF WCOM-PAGIRICH > ZEROES                              
001450              PERFORM D10-IMPOSTA-PAGINA                          
001451                 THRU D10-EX                                      
001452              PERFORM E20-PAGINA-PRONTA                           
001453                 THRU E20-EX                                      
001454           ELSE                                                   
001455              PERFORM U02-NORESP                                  
001456                 THRU U02-EX.                                     
001457 D00-EX. EXIT.                                                    
001458*----------------------------------------------------------------*
001459 D10-IMPOSTA-PAGINA.                                              
001460*----------------------------------------------------------------*
001461     MOVE SPACES                 TO WCOM-FLAGPRGM                 
001462                                                                  
001463* EXEC CICS RECEIVE MAP    (WNOMEMAP)                             
001464*                      MAPSET ('AVMLO50')                         
001465*                      INTO   (AVILO50I)                          
001466*                      END-EXEC.                                  
001467     MOVE LENGTH OF                                               
001468      AVILO50I                                                    
001469       TO DFHEIV11                                                
001470     MOVE 'AVMLO50' TO DFHEIV1                                    
001471*    MOVE '8"T I  L              ''   #00001373' TO DFHEIV0       
001472     MOVE X'382254204920204C20202020' &                           
001473          X'202020202020202020202720' &                           
001474          X'2020233030303031333733' TO DFHEIV0                    
001475     CALL 'kxdfhei1' USING DFHEIV0,                               
001476           WNOMEMAP,                                              
001477           AVILO50I,                                              
001478           DFHEIV11,                                              
001479           DFHEIV1,                                               
001480           DFHEIV99,                                              
001481           DFHEIV99                                               
001482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001483                                                                  
001484     EVALUATE EIBAID                                              
001485         WHEN DFHPF1                                              
001486              COMPUTE WPAGRICH = WCOM-PAGIRICH + 1                
001487         WHEN DFHPF2                                              
001488              COMPUTE WPAGRICH = WCOM-PAGIRICH - 1                
001489         WHEN DFHPF7                                              
001490              MOVE 1             TO WPAGRICH                      
001491         WHEN DFHPF8                                              
001492              MOVE WCOM-PAGIULTI TO WPAGRICH                      
001493     END-EVALUATE.                                                
001494 D10-EX. EXIT.                                                    
001495*----------------------------------------------------------------*
001496 D20-INSERIMENTO.                                                 
001497*----------------------------------------------------------------*
001498                                                                  
001499* EXEC CICS RECEIVE MAP    (WNOMEMAP)                             
001500*                      MAPSET ('AVMLO50')                         
001501*                      INTO   (AVILO50I)                          
001502*                      END-EXEC.                                  
001503     MOVE LENGTH OF                                               
001504      AVILO50I                                                    
001505       TO DFHEIV11                                                
001506     MOVE 'AVMLO50' TO DFHEIV1                                    
001507*    MOVE '8"T I  L              ''   #00001391' TO DFHEIV0       
001508     MOVE X'382254204920204C20202020' &                           
001509          X'202020202020202020202720' &                           
001510          X'2020233030303031333931' TO DFHEIV0                    
001511     CALL 'kxdfhei1' USING DFHEIV0,                               
001512           WNOMEMAP,                                              
001513           AVILO50I,                                              
001514           DFHEIV11,                                              
001515           DFHEIV1,                                               
001516           DFHEIV99,                                              
001517           DFHEIV99                                               
001518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001519                                                                  
001520     IF WCOM-CAMBIODT = 'S'                                       
001521        MOVE WCOM-CODCLIEN          TO L654-CODCLIEN              
001522        MOVE 'M'                    TO L654-TIPSERVI              
001523        MOVE WCOM-CODDIVIS          TO L654-CODDIVIS              
001524        PERFORM L30-SELECT-LISTILOGI                              
001525           THRU L30-EX                                            
001526        IF LO50-DTINILISI NOT > WS-DTFINLIS OR                    
001527           LO50-DTFINLISI NOT > WS-DTFINLIS                       
001528           MOVE '*'                 TO WSWERROR                   
001529           MOVE '02249'             TO MESS-CODERROR              
001530           MOVE DFHUNIMD            TO LO50-DTINILISA             
001531           MOVE DFHUNIMD            TO LO50-DTFINLISA             
001532           MOVE DFHRED              TO LO50-DTINILISC             
001533           MOVE DFHRED              TO LO50-DTFINLISC             
001534           MOVE -1                  TO LO50-DTINILISL             
001535           GO TO D20-EX.                                          
001536     MOVE 'I'                       TO WCOM-FLAGPRGM              
001537     PERFORM D22-PRIMA-RIGA                                       
001538        THRU D22-EX                                               
001539     PERFORM VARYING WINDRIGA FROM 2 BY 1                         
001540       UNTIL WINDRIGA GREATER WNUMRIGA                            
001541             MOVE 'I'             TO LO50-OPERAZIOO(WINDRIGA)     
001542     END-PERFORM.                                                 
001543 D20-EX. EXIT.                                                    
001544*----------------------------------------------------------------*
001545 D21-SPOSTA-IN-MAPPA.                                             
001546*----------------------------------------------------------------*
001547     MOVE WPAG-CODSERVI(WINDRIGA) TO LO50-CODSERVIO(1)            
001548                                     WLO50-CODSERVI(1)            
001549     MOVE WPAG-DESSERVI(WINDRIGA) TO LO50-DESSERVIO(1)            
001550                                     WLO50-DESSERVI(1)            
001551     MOVE WPAG-UNMISURA(WINDRIGA) TO LO50-UNMISURAO(1)            
001552                                     WLO50-UNMISURA(1)            
001553     MOVE WPAG-PREZZLIS(WINDRIGA) TO LO50-PREZZLISO(1)            
001554                                     WLO50-PREZZLIS(1)            
001555     MOVE WPAG-PERCLIST(WINDRIGA) TO LO50-PERCLISTO(1)            
001556                                     WLO50-PERCLIST(1).           
001557 D21-EX. EXIT.                                                    
001558*----------------------------------------------------------------*
001559 D22-PRIMA-RIGA.                                                  
001560*----------------------------------------------------------------*
001561     IF WCOM-PAGILIST > 0                                         
001562        MOVE WCOM-PAGIULTI          TO WNUMITEM                   
001563        PERFORM R00-READQ-WPAGCTRL                                
001564           THRU R00-EX                                            
001565     ELSE                                                         
001566        MOVE ALL 'X'                TO WPAG-CODSERVI (1)          
001567                                       WLO50-CODSERVI(1)          
001568                                       WPAG-DESSERVI (1)          
001569                                       WLO50-DESSERVI(1)          
001570                                       WPAG-UNMISURA (1)          
001571                                       WLO50-UNMISURA(1)          
001572        MOVE 9999999,9999           TO WPAG-PREZZLIS (1)          
001573                                       WLO50-PREZZLIS(1)          
001574        MOVE 999,99                 TO WPAG-PERCLIST (1)          
001575                                       WLO50-PERCLIST(1).         
001576     PERFORM E99-PULISCI-MAPPA                                    
001577        THRU E99-EX                                               
001578     PERFORM D21-SPOSTA-IN-MAPPA                                  
001579        THRU D21-EX                                               
001580        VARYING WINDRIGA FROM 1 BY 1                              
001581          UNTIL WINDRIGA GREATER WNUMRIGA                         
001582             OR WPAG-CODSERVI(WINDRIGA) NOT GREATER SPACES.       
001583     MOVE 'M'                    TO WLO50-TIPSERVI                
001584     MOVE WCOM-CODSOCI1          TO WLO50-CODSOCIE                
001585     MOVE 1                      TO WLO50-WINDRIGA                
001586     PERFORM R30-REWRITE-WPAGLO50                                 
001587        THRU R30-EX.                                              
001588 D22-EX. EXIT.                                                    
001589*----------------------------------------------------------------*
001590 D30-FUNZIONI-ESTERNE.                                            
001591*----------------------------------------------------------------*
001592     MOVE SPACES                 TO WCOM-FLAGPRGM                 
001593     MOVE  '*'                   TO WCOM-DELETETS.                
001594     PERFORM U20-DELETE-TS                                        
001595        THRU U20-EX.                                              
001596     PERFORM U30-DELETE-WPAGLO50                                  
001597        THRU U30-EX.                                              
001598                                                                  
001599* EXEC CICS LINK PROGRAM  ('WWTTIM15')                            
001600*                   COMMAREA (WCOM-AREAXXXX)                      
001601*                   LENGTH   (WCOM-LUNGHEZZ)                      
001602*                   END-EXEC.                                     
001603     MOVE 'WWTTIM15' TO DFHEIV1                                   
001604*    MOVE '."C                   (   #00001473' TO DFHEIV0        
001605     MOVE X'2E2243202020202020202020' &                           
001606          X'202020202020202020202820' &                           
001607          X'2020233030303031343733' TO DFHEIV0                    
001608     CALL 'kxdfhei1' USING DFHEIV0,                               
001609           DFHEIV1,                                               
001610           WCOM-AREAXXXX,                                         
001611           WCOM-LUNGHEZZ,                                         
001612           DFHEIV99,                                              
001613           DFHEIV99,                                              
001614           DFHEIV99,                                              
001615           DFHEIV99                                               
001616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001617                                                                  
001618     IF  WCOM-RETURNXX = '*'                                      
001619                                                                  
001620* EXEC CICS RETURN END-EXEC                                       
001621*    MOVE '.(                    ''   #00001478' TO DFHEIV0       
001622     MOVE X'2E2820202020202020202020' &                           
001623          X'202020202020202020202720' &                           
001624          X'2020233030303031343738' TO DFHEIV0                    
001625     CALL 'kxdfhei1' USING DFHEIV0,                               
001626           DFHEIV99,                                              
001627           DFHEIV99,                                              
001628           DFHEIV99,                                              
001629           DFHEIV99,                                              
001630           DFHEIV99,                                              
001631           DFHEIV99                                               
001632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
001633     ELSE                                                         
001634         PERFORM U00-RETURN-TRAN                                  
001635            THRU U00-EX.                                          
001636 D30-EX. EXIT.                                                    
001637*----------------------------------------------------------------*
001638 E10-PREPARA-PAGINE.                                              
001639*----------------------------------------------------------------*
001640     MOVE WCOM-CODCLIEN          TO L654-CODCLIEN                 
001641     MOVE WCOM-DTINILIS          TO L654-DTINILIS                 
001642     MOVE WCOM-DTFINLIS          TO L654-DTFINLIS                 
001643     MOVE WCOM-CODDIVIS          TO L654-CODDIVIS                 
001644     MOVE 'M'                    TO L654-TIPSERVI                 
001645     PERFORM O00-OPEN-POINTER                                     
001646        THRU O00-EX.                                              
001647     PERFORM L00-FETCH-POINTER                                    
001648        THRU L00-EX.                                              
001649     IF SQLCODE = ZEROES                                          
001650        MOVE SPACES              TO WCOM-CAMBIODT.                
001651     PERFORM E13-PREPARA-TS                                       
001652        THRU E13-EX                                               
001653             UNTIL WS-SQLCODE = +100.                             
001654     PERFORM O10-CLOSE-POINTER                                    
001655        THRU O10-EX.                                              
001656     IF WCOM-PAGILIST > ZEROES                                    
001657        MOVE WCOM-PAGILIST       TO WCOM-PAGIULTI                 
001658        IF WCOM-PAGITRAN (WCOM-INDITRAN) > ZEROES                 
001659           MOVE WCOM-PAGITRAN (WCOM-INDITRAN)                     
001660                                 TO WPAGRICH                      
001661           MOVE ZEROES           TO WCOM-PAGITRAN (WCOM-INDITRAN) 
001662        ELSE                                                      
001663           MOVE 1                TO WPAGRICH                      
001664     ELSE                                                         
001665        PERFORM E99-PULISCI-MAPPA                                 
001666           THRU E99-EX                                            
001667        IF MESS-CODERROR NOT > SPACES                             
001668           MOVE '00002'          TO MESS-CODERROR.                
001669 E10-EX. EXIT.                                                    
001670*----------------------------------------------------------------*
001671 E13-PREPARA-TS.                                                  
001672*----------------------------------------------------------------*
001673     MOVE SPACES                 TO WPAGREFE.                     
001674     INITIALIZE                     WPAGREFE.                     
001675     PERFORM E14-RIGA-TS                                          
001676        THRU E14-EX                                               
001677             VARYING WINDRIGA FROM 1 BY 1                         
001678               UNTIL WINDRIGA > WNUMRIGA                          
001679                  OR WS-SQLCODE = +100.                           
001680     PERFORM R20-WRITEQ-WPAG                                      
001681        THRU R20-EX.                                              
001682 E13-EX. EXIT.                                                    
001683*----------------------------------------------------------------*
001684 E14-RIGA-TS.                                                     
001685*----------------------------------------------------------------*
001686     MOVE L654-CODSERVI          TO WPAG-CODSERVI(WINDRIGA)       
001687                                    L651-CODSERVI                 
001688     PERFORM L18-SELECT-SERVIZI                                   
001689        THRU L18-EX                                               
001690     MOVE L651-DESSERVI          TO WPAG-DESSERVI(WINDRIGA).      
001691     MOVE L651-UNMISURA          TO WPAG-UNMISURA(WINDRIGA).      
001692     MOVE L654-PREZZLIS          TO WPAG-PREZZLIS(WINDRIGA).      
001693     MOVE L654-PERCLIST          TO WPAG-PERCLIST(WINDRIGA).      
001694     PERFORM L00-FETCH-POINTER                                    
001695        THRU L00-EX.                                              
001696 E14-EX. EXIT.                                                    
001697*----------------------------------------------------------------*
001698 E20-PAGINA-PRONTA.                                               
001699*----------------------------------------------------------------*
001700     IF WCOM-PAGILIST = ZERO                                      
001701        GO TO E20-EX.                                             
001702     IF  WPAGRICH  LESS  1                                        
001703         MOVE 1                  TO WPAGRICH.                     
001704     IF  WPAGRICH  > WCOM-PAGIULTI                                
001705         MOVE WCOM-PAGIULTI      TO WPAGRICH.                     
001706     MOVE WPAGRICH               TO WCOM-PAGIRICH                 
001707     MOVE WPAGRICH               TO WNUMITEM                      
001708     PERFORM R00-READQ-WPAGCTRL                                   
001709        THRU R00-EX.                                              
001710     PERFORM E99-PULISCI-MAPPA                                    
001711        THRU E99-EX.                                              
001712     PERFORM E21-SPOSTA-IN-MAPPA                                  
001713        THRU E21-EX                                               
001714             VARYING WINDRIGA FROM 1 BY 1                         
001715               UNTIL WINDRIGA > WNUMRIGA                          
001716                  OR WPAG-CODSERVI (WINDRIGA) NOT > SPACES.       
001717 E20-EX. EXIT.                                                    
001718*----------------------------------------------------------------*
001719 E21-SPOSTA-IN-MAPPA.                                             
001720*----------------------------------------------------------------*
001721     MOVE WPAG-CODSERVI(WINDRIGA) TO LO50-CODSERVIO(WINDRIGA).    
001722     MOVE WPAG-DESSERVI(WINDRIGA) TO LO50-DESSERVIO(WINDRIGA).    
001723     MOVE WPAG-UNMISURA(WINDRIGA) TO LO50-UNMISURAO(WINDRIGA).    
001724     MOVE WPAG-PREZZLIS(WINDRIGA) TO LO50-PREZZLISO(WINDRIGA).    
001725     MOVE WPAG-PERCLIST(WINDRIGA) TO LO50-PERCLISTO(WINDRIGA).    
001726 E21-EX. EXIT.                                                    
001727*----------------------------------------------------------------*
001728 E99-PULISCI-MAPPA.                                               
001729*----------------------------------------------------------------*
001730     PERFORM VARYING WINDRIGA FROM 1 BY 1                         
001731       UNTIL WINDRIGA > WNUMRIGA                                  
001732             MOVE LOW-VALUE      TO LO50-RIGAO(WINDRIGA)          
001733     END-PERFORM.                                                 
001734 E99-EX. EXIT.                                                    
001735*----------------------------------------------------------------*
001736 E30-INVIA-MAPPA.                                                 
001737*----------------------------------------------------------------*
001738     MOVE WCOM-PAGIRICH          TO WNUMITEM.                     
001739     PERFORM R00-READQ-WPAGCTRL                                   
001740        THRU R00-EX.                                              
001741     MOVE WCOM-DATAXXXX          TO LO50-MAPDATAO.                
001742     MOVE EIBTIME                TO LO50-MAPORAXO.                
001743     IF WCOM-PAGIULTI NOT = 99999                                 
001744        MOVE WCOM-PAGIULTI       TO LO50-MAPPPAGO                 
001745     ELSE                                                         
001746        MOVE ALL '*'             TO LO50-MAPPPAGI.                
001747     MOVE WCOM-PAGIRICH          TO LO50-MAPRPAGO.                
001748     IF MESS-CODERROR NOT > SPACES                                
001749        MOVE '00003'             TO MESS-CODERROR.                
001750     PERFORM U10-DECODIFICA-MESSAGGI                              
001751        THRU U10-EX.                                              
001752     IF NOT ERRORE                                                
001753        IF WCOM-FLAGPRGM = 'I'                                    
001754           MOVE -1               TO LO50-CODSERVIL(2)             
001755        ELSE                                                      
001756           IF WCOM-PAGILIST NOT > ZEROS                           
001757              MOVE -1            TO LO50-CODCLIENL                
001758           ELSE                                                   
001759              MOVE -1            TO LO50-OPERAZIOL(1).            
001760     MOVE 'MAGAZZINO'            TO LO50-DTIPSERVO.               
001761     PERFORM P00-ATTRIBUTI-RIGA                                   
001762        THRU P00-EX                                               
001763             VARYING WINDRIGA FROM 1 BY 1                         
001764               UNTIL WINDRIGA > WNUMRIGA.                         
001765                                                                  
001766* EXEC CICS SEND MAPSET ('AVMLO50')                               
001767*                   MAP    (WNOMEMAP)                             
001768*                   FROM   (AVILO50O)                             
001769*                   ERASE                                         
001770*                   CURSOR                                        
001771*                   END-EXEC.                                     
001772     MOVE LENGTH OF                                               
001773      AVILO50O                                                    
001774       TO DFHEIV12                                                
001775     MOVE -1                                                      
001776       TO DFHEIV11                                                
001777     MOVE 'AVMLO50' TO DFHEIV1                                    
001778*    MOVE '8$     CT  E      L F ,   #00001611' TO DFHEIV0        
001779     MOVE X'382420202020204354202045' &                           
001780          X'2020202020204C2046202C20' &                           
001781          X'2020233030303031363131' TO DFHEIV0                    
001782     CALL 'kxdfhei1' USING DFHEIV0,                               
001783           WNOMEMAP,                                              
001784           AVILO50O,                                              
001785           DFHEIV12,                                              
001786           DFHEIV1,                                               
001787           DFHEIV99,                                              
001788           DFHEIV99,                                              
001789           DFHEIV99,                                              
001790           DFHEIV11,                                              
001791           DFHEIV99,                                              
001792           DFHEIV99,                                              
001793           DFHEIV99                                               
001794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001795                                                                  
001796 E30-EX. EXIT.                                                    
001797*----------------------------------------------------------------*
001798 F00-CONTROLLI.                                                   
001799*----------------------------------------------------------------*
001800     MOVE SPACES                 TO WS-OPERAZIO.                  
001801     MOVE 1                      TO WLO50-ITEM.                   
001802     PERFORM R10-READQ-WPAGLO50                                   
001803        THRU R10-EX.                                              
001804     MOVE 1                      TO WLO50-WINDRIGA.               
001805     PERFORM F10-CTRL-OPERAZIONE                                  
001806        THRU F10-EX                                               
001807             VARYING WINDRIGA FROM 1 BY 1                         
001808               UNTIL WINDRIGA > WNUMRIGA                          
001809                  OR ERRORE.                                      
001810     PERFORM F30-CTRL-SELEZIONE                                   
001811        THRU F30-EX                                               
001812             VARYING WINDRIGA FROM 1 BY 1                         
001813               UNTIL WINDRIGA > WNUMRIGA                          
001814                  OR ERRORE.                                      
001815 F00-EX. EXIT.                                                    
001816*----------------------------------------------------------------*
001817 F10-CTRL-OPERAZIONE.                                             
001818*----------------------------------------------------------------*
001819     IF LO50-OPERAZIOI(WINDRIGA) NOT > SPACES                     
001820        GO TO F10-EX.                                             
001821     IF LO50-OPERAZIOI(WINDRIGA) NOT = 'V' AND                    
001822        LO50-OPERAZIOI(WINDRIGA) NOT = '/' AND                    
001823        LO50-OPERAZIOI(WINDRIGA) NOT = 'I'                        
001824        MOVE '*'                 TO WSWERROR                      
001825        MOVE '00004'             TO MESS-CODERROR                 
001826        MOVE DFHUNIMD            TO LO50-OPERAZIOA (WINDRIGA)     
001827        MOVE DFHRED              TO LO50-OPERAZIOC (WINDRIGA)     
001828        MOVE -1                  TO LO50-OPERAZIOL (WINDRIGA)     
001829        GO TO F10-EX                                              
001830     ELSE                                                         
001831        IF WCOM-FLAGPRGM                = 'I' AND                 
001832           LO50-CODSERVII(WINDRIGA) NOT > ' ' AND                 
001833           LO50-PREZZLISI(WINDRIGA) NOT > ' ' AND                 
001834           LO50-PERCLISTI(WINDRIGA) NOT > ' '                     
001835           CONTINUE                                               
001836        ELSE                                                      
001837           IF WS-OPERAZIO NOT > SPACES                            
001838              MOVE LO50-OPERAZIOI (WINDRIGA) TO WS-OPERAZIO       
001839           ELSE                                                   
001840              IF WS-OPERAZIO NOT = LO50-OPERAZIOI(WINDRIGA)       
001841                 MOVE '*'        TO WSWERROR                      
001842                 MOVE '00037'    TO MESS-CODERROR                 
001843                 MOVE DFHUNIMD   TO LO50-OPERAZIOA (WINDRIGA)     
001844                 MOVE DFHRED     TO LO50-OPERAZIOC (WINDRIGA)     
001845                 MOVE -1         TO LO50-OPERAZIOL (WINDRIGA)     
001846                 GO TO F10-EX.                                    
001847     IF LO50-OPERAZIOI(WINDRIGA) = 'I' AND                        
001848        WCOM-FLAGPRGM NOT = 'I'                                   
001849        MOVE '*'               TO WSWERROR                        
001850        MOVE '00319'           TO MESS-CODERROR                   
001851        MOVE DFHUNIMD          TO LO50-OPERAZIOA(WINDRIGA)        
001852        MOVE DFHRED            TO LO50-OPERAZIOC(WINDRIGA)        
001853        MOVE -1                TO LO50-OPERAZIOL(WINDRIGA)        
001854        GO TO F10-EX.                                             
001855 F10-EX. EXIT.                                                    
001856*----------------------------------------------------------------*
001857 F30-CTRL-SELEZIONE.                                              
001858*----------------------------------------------------------------*
001859     IF WCOM-FLAGPRGM            NOT = 'I' AND                    
001860        LO50-OPERAZIOI(WINDRIGA) NOT = 'V' AND                    
001861        WPAG-CODSERVI (WINDRIGA)     > SPACES                     
001862        PERFORM E21-SPOSTA-IN-MAPPA                               
001863           THRU E21-EX.                                           
001864     INSPECT LO50-CODSERVII(WINDRIGA)                             
001865                             REPLACING ALL LOW-VALUE BY SPACES    
001866     INSPECT LO50-PREZZLISI(WINDRIGA)                             
001867                             REPLACING ALL LOW-VALUE BY SPACES    
001868     INSPECT LO50-PERCLISTI(WINDRIGA)                             
001869                             REPLACING ALL LOW-VALUE BY SPACES    
001870     IF WCOM-FLAGPRGM                = 'I' AND                    
001871        WINDRIGA > 1                                              
001872        MOVE SPACES              TO LO50-DESSERVIO(WINDRIGA)      
001873                                    LO50-UNMISURAO(WINDRIGA).     
001874     IF WCOM-FLAGPRGM                = 'I' AND                    
001875        LO50-CODSERVII(WINDRIGA) NOT > ' ' AND                    
001876        LO50-PREZZLISI(WINDRIGA) NOT > ' ' AND                    
001877        LO50-PERCLISTI(WINDRIGA) NOT > ' '                        
001878        GO TO F30-EX.                                             
001879     IF LO50-OPERAZIOI(WINDRIGA) = 'I' OR 'V'                     
001880        PERFORM F40-CTRL-INSE-VAR                                 
001881           THRU F40-EX.                                           
001882     IF LO50-OPERAZIOI(WINDRIGA) = '/'                            
001883        PERFORM F60-CTRL-CANCELLA                                 
001884           THRU F60-EX.                                           
001885 F30-EX. EXIT.                                                    
001886*----------------------------------------------------------------*
001887 F40-CTRL-INSE-VAR.                                               
001888*----------------------------------------------------------------*
001889     IF LO50-OPERAZIOI(WINDRIGA) = 'I'                            
001890        PERFORM F50-CTRL-INSE                                     
001891           THRU F50-EX                                            
001892        IF ERRORE                                                 
001893           GO TO F40-EX.                                          
001894*    IF LO50-PREZZLISI (WINDRIGA) NOT > SPACES AND                
001895*       LO50-PERCLISTI (WINDRIGA) NOT > SPACES                    
001896*          CONTINUE                                               
001897*       ELSE                                                      
001898*          MOVE '*'              TO WSWERROR                      
001899*          MOVE '01976'          TO MESS-CODERROR                 
001900*          MOVE DFHUNIMD         TO LO50-PREZZLISA(WINDRIGA)      
001901*          MOVE DFHRED           TO LO50-PREZZLISC(WINDRIGA)      
001902*          MOVE -1               TO LO50-PREZZLISL(WINDRIGA)      
001903*          MOVE DFHUNIMD         TO LO50-PERCLISTA(WINDRIGA)      
001904*          MOVE DFHRED           TO LO50-PERCLISTC(WINDRIGA)      
001905*          GO TO F40-EX.                                          
001906     IF LO50-PREZZLISI(WINDRIGA) > SPACES                         
001907        MOVE LO50-PREZZLISI(WINDRIGA) TO WSNU-NUMBER              
001908        MOVE 4                   TO WSNU-DECIMALS                 
001909        MOVE 7                   TO WSNU-INTEGERS                 
001910        PERFORM SRWTESTN                                          
001911           THRU SRWTESTN-EX                                       
001912        IF WSNU-WSWERROR = '*' OR                                 
001913           WSNU-NUMEOUTN NOT > ZERO                               
001914           MOVE '*'              TO WSWERROR                      
001915           MOVE '00059'          TO MESS-CODERROR                 
001916           MOVE DFHUNIMD         TO LO50-PREZZLISA(WINDRIGA)      
001917           MOVE DFHRED           TO LO50-PREZZLISC(WINDRIGA)      
001918           MOVE -1               TO LO50-PREZZLISL(WINDRIGA)      
001919           GO TO F40-EX                                           
001920        ELSE                                                      
001921           MOVE WSNU-NUMEOUTN    TO LO50-PREZZLISO(WINDRIGA)      
001922           MOVE WSNU-NUMEOUTN    TO WPAG-PREZZLIS (WINDRIGA)      
001923                                   WLO50-PREZZLIS(WLO50-WINDRIGA) 
001924        END-IF                                                    
001925     ELSE                                                         
001926        MOVE ZEROES              TO WPAG-PREZZLIS (WINDRIGA)      
001927                                   WLO50-PREZZLIS(WLO50-WINDRIGA).
001928     IF LO50-PERCLISTI(WINDRIGA) > SPACES                         
001929        IF LO50-UNMISURAI(WINDRIGA) NOT = '% '                    
001930           MOVE '*'              TO WSWERROR                      
001931           MOVE '01487'          TO MESS-CODERROR                 
001932           MOVE DFHUNIMD         TO LO50-PERCLISTA(WINDRIGA)      
001933           MOVE DFHRED           TO LO50-PERCLISTC(WINDRIGA)      
001934           MOVE -1               TO LO50-PERCLISTL(WINDRIGA)      
001935           GO TO F40-EX                                           
001936        ELSE                                                      
001937           MOVE LO50-PERCLISTI(WINDRIGA) TO WSNU-NUMBER           
001938           MOVE 2                TO WSNU-DECIMALS                 
001939           MOVE 2                TO WSNU-INTEGERS                 
001940           PERFORM SRWTESTN                                       
001941              THRU SRWTESTN-EX                                    
001942           IF WSNU-WSWERROR = '*' OR                              
001943              WSNU-NUMEOUTN NOT > ZERO                            
001944              MOVE '*'           TO WSWERROR                      
001945              MOVE '00059'       TO MESS-CODERROR                 
001946              MOVE DFHUNIMD      TO LO50-PERCLISTA(WINDRIGA)      
001947              MOVE DFHRED        TO LO50-PERCLISTC(WINDRIGA)      
001948              MOVE -1            TO LO50-PERCLISTL(WINDRIGA)      
001949              GO TO F40-EX                                        
001950           ELSE                                                   
001951              MOVE WSNU-NUMEOUTN TO LO50-PERCLISTO(WINDRIGA)      
001952              MOVE WSNU-NUMEOUTN TO WPAG-PERCLIST (WINDRIGA)      
001953                                   WLO50-PERCLIST(WLO50-WINDRIGA) 
001954           END-IF                                                 
001955        END-IF                                                    
001956     ELSE                                                         
001957        MOVE ZEROES              TO WPAG-PERCLIST (WINDRIGA)      
001958                                   WLO50-PERCLIST(WLO50-WINDRIGA).
001959     IF LO50-PREZZLISI (WINDRIGA) > SPACES AND                    
001960        LO50-PERCLISTI (WINDRIGA) > SPACES                        
001961        MOVE '*'                 TO WSWERROR                      
001962        MOVE '00486'             TO MESS-CODERROR                 
001963        MOVE DFHUNIMD            TO LO50-PREZZLISA(WINDRIGA)      
001964        MOVE DFHRED              TO LO50-PREZZLISC(WINDRIGA)      
001965        MOVE -1                  TO LO50-PREZZLISL(WINDRIGA)      
001966        MOVE DFHUNIMD            TO LO50-PERCLISTA(WINDRIGA)      
001967        MOVE DFHRED              TO LO50-PERCLISTC(WINDRIGA)      
001968        GO TO F40-EX.                                             
001969 F40-EX. EXIT.                                                    
001970*----------------------------------------------------------------*
001971 F50-CTRL-INSE.                                                   
001972*----------------------------------------------------------------*
001973     MOVE SPACES                 TO LO50-DESSERVIO(WINDRIGA)      
001974     MOVE SPACES                 TO LO50-UNMISURAO(WINDRIGA)      
001975     MOVE 'M'                    TO WLO50-TIPSERVI                
001976     MOVE WCOM-CODSOCI1          TO WLO50-CODSOCIE                
001977     IF LO50-CODSERVII(WINDRIGA)(1:1) = '?'                       
001978        PERFORM R30-REWRITE-WPAGLO50                              
001979           THRU R30-EX                                            
001980        MOVE WCOM-PAGIRICH       TO WCOM-PAGITRAN(WCOM-INDITRAN)  
001981        PERFORM SCRIVO-RICICLO                                    
001982           THRU SCRIVO-RICICLO-EX                                 
001983        MOVE 'LO10'              TO WTRANSID                      
001984        PERFORM U05-START-TRANSID                                 
001985           THRU U05-EX.                                           
001986     IF LO50-CODSERVII(WINDRIGA) NOT > SPACES                     
001987        MOVE '*'                 TO WSWERROR                      
001988        MOVE '02478'             TO MESS-CODERROR                 
001989        MOVE DFHRED              TO LO50-CODSERVIC(WINDRIGA)      
001990        MOVE DFHUNIMD            TO LO50-CODSERVIA(WINDRIGA)      
001991        MOVE -1                  TO LO50-CODSERVIL(WINDRIGA)      
001992        GO TO F50-EX                                              
001993     ELSE                                                         
001994        ADD 1                    TO WLO50-WINDRIGA                
001995        MOVE LO50-CODSERVII(WINDRIGA)                             
001996                                 TO L651-CODSERVI                 
001997                                   WLO50-CODSERVI(WLO50-WINDRIGA) 
001998        PERFORM L18-SELECT-SERVIZI                                
001999           THRU L18-EX                                            
002000        IF SQLCODE = +100 OR                                      
002001           LO50-CODSERVII(WINDRIGA)(1:2) NOT = WCOM-CODSOCI1      
002002           MOVE '*'              TO WSWERROR                      
002003           MOVE '02478'          TO MESS-CODERROR                 
002004           MOVE DFHRED           TO LO50-CODSERVIC(WINDRIGA)      
002005           MOVE DFHUNIMD         TO LO50-CODSERVIA(WINDRIGA)      
002006           MOVE -1               TO LO50-CODSERVIL(WINDRIGA)      
002007           GO TO F50-EX                                           
002008        ELSE                                                      
002009           MOVE L651-DESSERVI    TO LO50-DESSERVIO(WINDRIGA)      
002010                                   WLO50-DESSERVI(WLO50-WINDRIGA) 
002011           MOVE L651-UNMISURA    TO LO50-UNMISURAO(WINDRIGA)      
002012                                   WLO50-UNMISURA(WLO50-WINDRIGA).
002013     PERFORM VARYING WS-IND1 FROM 1 BY 1                          
002014       UNTIL WS-IND1 > WNUMRIGA                                   
002015          OR ERRORE                                               
002016             IF WS-IND1 NOT = WINDRIGA                            
002017                IF LO50-CODSERVII(WS-IND1) =                      
002018                   LO50-CODSERVII(WINDRIGA)                       
002019                   MOVE '*'       TO WSWERROR                     
002020                   MOVE '00110'   TO MESS-CODERROR                
002021                   MOVE DFHRED    TO LO50-CODSERVIC(WINDRIGA)     
002022                   MOVE DFHUNIMD  TO LO50-CODSERVIA(WINDRIGA)     
002023                   MOVE -1        TO LO50-CODSERVIL(WINDRIGA)     
002024                   GO TO F50-EX                                   
002025                END-IF                                            
002026             END-IF                                               
002027     END-PERFORM.                                                 
002028     MOVE WCOM-CODCLIEN              TO L654-CODCLIEN             
002029     MOVE WCOM-CODDIVIS              TO L654-CODDIVIS             
002030     MOVE WCOM-DTINILIS              TO L654-DTINILIS             
002031     MOVE WCOM-DTFINLIS              TO L654-DTFINLIS             
002032     MOVE LO50-CODSERVII(WINDRIGA)   TO L654-CODSERVI             
002033     PERFORM L40-SELECT-LISTILOGI                                 
002034        THRU L40-EX                                               
002035     IF SQLCODE = 0                                               
002036        MOVE '*'                  TO WSWERROR                     
002037        MOVE '00110'              TO MESS-CODERROR                
002038        MOVE DFHRED               TO LO50-CODSERVIC(WINDRIGA)     
002039        MOVE DFHUNIMD             TO LO50-CODSERVIA(WINDRIGA)     
002040        MOVE -1                   TO LO50-CODSERVIL(WINDRIGA)     
002041        GO TO F50-EX.                                             
002042 F50-EX. EXIT.                                                    
002043*----------------------------------------------------------------*
002044 F60-CTRL-CANCELLA.                                               
002045*----------------------------------------------------------------*
002046     MOVE 'M'                        TO L652-TIPSERVI             
002047     MOVE '22'                       TO L652-CODSOCIE             
002048     MOVE WCOM-CODCLIEN              TO L652-CODCLIEN             
002049     MOVE WCOM-CODDIVIS              TO L652-CODDIVIS             
002050     MOVE LO50-CODSERVII(WINDRIGA)   TO L653-CODSERVI             
002051     MOVE WCOM-DTINILIS              TO L654-DTINILIS             
002052     MOVE WCOM-DTFINLIS              TO L654-DTFINLIS             
002053     PERFORM L50-SELECT-ORDILOGI                                  
002054        THRU L50-EX                                               
002055     IF SQLCODE = 0                                               
002056        MOVE '*'                  TO WSWERROR                     
002057        MOVE '00029'              TO MESS-CODERROR                
002058        MOVE DFHRED               TO LO50-OPERAZIOC(WINDRIGA)     
002059        MOVE DFHUNIMD             TO LO50-OPERAZIOA(WINDRIGA)     
002060        MOVE -1                   TO LO50-OPERAZIOL(WINDRIGA)     
002061        GO TO F60-EX.                                             
002062 F60-EX. EXIT.                                                    
002063*---------------------------------------------------------------* 
002064 G00-AGGIORNAMENTI.                                               
002065*---------------------------------------------------------------* 
002066     PERFORM G10-SCORRI-RIGHE                                     
002067        THRU G10-EX                                               
002068           VARYING WINDRIGA FROM 1 BY 1                           
002069             UNTIL WINDRIGA > WNUMRIGA.                           
002070     PERFORM U20-DELETE-TS                                        
002071        THRU U20-EX.                                              
002072     PERFORM U30-DELETE-WPAGLO50                                  
002073        THRU U30-EX.                                              
002074     MOVE WCOM-PAGIRICH          TO WCOM-PAGITRAN(WCOM-INDITRAN). 
002075     MOVE 99999                  TO WCOM-PAGIULTI.                
002076     MOVE ZERO                   TO WCOM-PAGIRICH                 
002077                                    WCOM-PAGILIST                 
002078                                    WPAGRICH.                     
002079     MOVE SPACES                 TO WCOM-FLAGPRGM                 
002080     PERFORM E10-PREPARA-PAGINE                                   
002081        THRU E10-EX.                                              
002082     PERFORM E20-PAGINA-PRONTA                                    
002083        THRU E20-EX.                                              
002084     MOVE '00005'                TO MESS-CODERROR.                
002085 G00-EX. EXIT.                                                    
002086*---------------------------------------------------------------* 
002087 G10-SCORRI-RIGHE.                                                
002088*---------------------------------------------------------------* 
002089     IF LO50-OPERAZIOI(WINDRIGA) NOT > SPACES OR                  
002090        LO50-CODSERVII(WINDRIGA) NOT > SPACES                     
002091        GO TO G10-EX.                                             
002092     MOVE SPACES                   TO DCLTLISTILOGI.              
002093     INITIALIZE                       DCLTLISTILOGI.              
002094     MOVE WCOM-CODCLIEN            TO L654-CODCLIEN.              
002095     MOVE WCOM-DTINILIS            TO L654-DTINILIS.              
002096     MOVE WCOM-DTFINLIS            TO L654-DTFINLIS.              
002097     MOVE 'M'                      TO L654-TIPSERVI.              
002098     MOVE WCOM-CODDIVIS            TO L654-CODDIVIS.              
002099     MOVE LO50-CODSERVII(WINDRIGA) TO L654-CODSERVI.              
002100     MOVE WPAG-PREZZLIS(WINDRIGA)  TO L654-PREZZLIS.              
002101     MOVE WPAG-PERCLIST(WINDRIGA)  TO L654-PERCLIST.              
002102     MOVE WCOM-DTCREAZI            TO L654-DTCREAZI               
002103                                      L654-DTULTVAR.              
002104     MOVE WCOM-UTENCICS            TO L654-CODUTVAR.              
002105     IF LO50-OPERAZIOI(WINDRIGA) = 'I'                            
002106        PERFORM G20-INSERT-LISTILOGI                              
002107           THRU G20-EX.                                           
002108     IF LO50-OPERAZIOI(WINDRIGA) = 'V'                            
002109        PERFORM G30-UPDATE-LISTILOGI                              
002110           THRU G30-EX.                                           
002111     IF LO50-OPERAZIOI(WINDRIGA) = '/'                            
002112        PERFORM G40-DELETE-LISTILOGI                              
002113           THRU G40-EX.                                           
002114 G10-EX. EXIT.                                                    
002115*---------------------------------------------------------------* 
002116 G20-INSERT-LISTILOGI.                                            
002117*---------------------------------------------------------------* 
002118     MOVE 'G20-'                   TO WCOM-CODABEND.              
002119     MOVE 'INSERT'                 TO WCOM-FILEFUNZ.              
002120     MOVE 'LISTILOGI'              TO WCOM-FILENOME.              
002121     MOVE SPACES                   TO WCOM-FILECTRL.              
002122     STRING L654-CODCLIEN ' ' L654-DTINILIS ' '                   
002123            L654-DTFINLIS ' ' L654-TIPSERVI ' '                   
002124            L654-CODSERVI ' ' L654-CODDIVIS                       
002125        DELIMITED BY SIZE        INTO WCOM-FILECTRL.              
002127     
      *EXEC SQL 
      *INSERT INTO DLOGISTI.TLISTILOGI                         
002128*                (CODCLIEN                                         
002129*                ,DTINILIS                                         
002130*                ,DTFINLIS                                         
002131*                ,CODSERVI                                         
002132*                ,TIPSERVI                                         
002133*                ,CODDIVIS                                         
002134*                ,PREZZLIS                                         
002135*                ,PERCLIST                                         
002136*                ,DTCREAZI                                         
002137*                ,DTULTVAR                                         
002138*                ,CODUTVAR)                                        
002139*          VALUES                                                  
002140*                (:L654-CODCLIEN                                   
002141*                ,:L654-DTINILIS                                   
002142*                ,:L654-DTFINLIS                                   
002143*                ,:L654-CODSERVI                                   
002144*                ,:L654-TIPSERVI                                   
002145*                ,:L654-CODDIVIS                                   
002146*                ,:L654-PREZZLIS                                   
002147*                ,:L654-PERCLIST                                   
002148*                ,:L654-DTCREAZI                                   
002149*                ,:L654-DTULTVAR                                   
002150*                ,:L654-CODUTVAR)                                  
002151*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 3 TO SQL-STMT-ID 
           MOVE 11 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODCLIEN
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTINILIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTFINLIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODSERVI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-TIPSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODDIVIS
            BY VALUE 0
                     0

           MOVE 1035 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-PREZZLIS
            BY VALUE 0
                     0

           MOVE 517 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-PERCLIST
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTCREAZI
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTULTVAR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 10 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODUTVAR
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 4 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002152     IF SQLCODE NOT = 0                                           
002153        PERFORM Z00-ERRORE                                        
002154           THRU Z00-EX.                                           
002155 G20-EX. EXIT.                                                    
002156*---------------------------------------------------------------* 
002157 G30-UPDATE-LISTILOGI.                                            
002158*---------------------------------------------------------------* 
002159     MOVE 'G30-'                   TO WCOM-CODABEND.              
002160     MOVE 'UPDATE'                 TO WCOM-FILEFUNZ.              
002161     MOVE 'LISTILOGI'              TO WCOM-FILENOME.              
002162     MOVE SPACES                   TO WCOM-FILECTRL.              
002163     STRING L654-CODCLIEN ' ' L654-DTINILIS ' '                   
002164            L654-DTFINLIS ' ' L654-TIPSERVI ' '                   
002165            L654-CODDIVIS ' ' L654-CODSERVI                       
002166        DELIMITED BY SIZE        INTO WCOM-FILECTRL.              
002168     
      *EXEC SQL 
      *UPDATE DLOGISTI.TLISTILOGI                              
002169*             SET PREZZLIS = :L654-PREZZLIS                        
002170*                ,PERCLIST = :L654-PERCLIST                        
002171*                ,DTULTVAR = :L654-DTULTVAR                        
002172*                ,CODUTVAR = :L654-CODUTVAR                        
002173*           WHERE CODCLIEN = :L654-CODCLIEN                        
002174*             AND DTINILIS = :L654-DTINILIS                        
002175*             AND DTFINLIS = :L654-DTFINLIS                        
002176*             AND TIPSERVI = :L654-TIPSERVI                        
002177*             AND CODDIVIS = :L654-CODDIVIS                        
002178*             AND CODSERVI = :L654-CODSERVI                        
002179*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 4 TO SQL-STMT-ID 
           MOVE 10 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1035 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-PREZZLIS
            BY VALUE 0
                     0

           MOVE 517 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-PERCLIST
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTULTVAR
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODUTVAR
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODCLIEN
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTINILIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTFINLIS
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-TIPSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODDIVIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODSERVI
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 5 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002180     IF SQLCODE NOT = 0                                           
002181        PERFORM Z00-ERRORE                                        
002182           THRU Z00-EX.                                           
002183 G30-EX. EXIT.                                                    
002184*---------------------------------------------------------------* 
002185 G40-DELETE-LISTILOGI.                                            
002186*---------------------------------------------------------------* 
002187     MOVE 'G40-'                   TO WCOM-CODABEND.              
002188     MOVE 'DELETE'                 TO WCOM-FILEFUNZ.              
002189     MOVE 'LISTILOGI'              TO WCOM-FILENOME.              
002190     MOVE SPACES                   TO WCOM-FILECTRL.              
002191     STRING L654-CODCLIEN ' ' L654-DTINILIS ' '                   
002192            L654-DTFINLIS ' ' L654-TIPSERVI ' '                   
002193            L654-CODDIVIS ' ' L654-CODSERVI                       
002194        DELIMITED BY SIZE        INTO WCOM-FILECTRL.              
002196     
      *EXEC SQL 
      *DELETE FROM DLOGISTI.TLISTILOGI                         
002197*           WHERE CODCLIEN = :L654-CODCLIEN                        
002198*             AND DTINILIS = :L654-DTINILIS                        
002199*             AND DTFINLIS = :L654-DTFINLIS                        
002200*             AND TIPSERVI = :L654-TIPSERVI                        
002201*             AND CODDIVIS = :L654-CODDIVIS                        
002202*             AND CODSERVI = :L654-CODSERVI                        
002203*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 5 TO SQL-STMT-ID 
           MOVE 6 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODCLIEN
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTINILIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTFINLIS
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-TIPSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODDIVIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODSERVI
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 6 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002204     IF SQLCODE NOT = 0                                           
002205        PERFORM Z00-ERRORE                                        
002206           THRU Z00-EX.                                           
002207 G40-EX. EXIT.                                                    
002208*---------------------------------------------------------------* 
002209 L00-FETCH-POINTER.                                               
002210*---------------------------------------------------------------* 
002211     MOVE 'L00-'                 TO WCOM-CODABEND.                
002212     MOVE 'FETCH'                TO WCOM-FILEFUNZ.                
002213     MOVE 'POINTER1'             TO WCOM-FILENOME                 
002214     MOVE SPACES                 TO WCOM-FILECTRL.                
002215     STRING L654-CODCLIEN ' ' L654-DTINILIS ' '                   
002216            L654-DTFINLIS ' ' L654-CODDIVIS                       
002217       DELIMITED BY SIZE       INTO WCOM-FILECTRL.                
002219     
      *EXEC SQL 
      *FETCH POINTER1                                         
002220*            INTO :L654-CODCLIEN, :L654-DTINILIS                   
002221*                ,:L654-DTFINLIS, :L654-CODSERVI                   
002222*                ,:L654-TIPSERVI, :L654-CODDIVIS                   
002223*                ,:L654-PREZZLIS, :L654-PERCLIST                   
002224*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 6 TO SQL-STMT-ID 
           MOVE 8 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODCLIEN
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTINILIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTFINLIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODSERVI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-TIPSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODDIVIS
            BY VALUE 0
                     0

           MOVE 1035 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-PREZZLIS
            BY VALUE 0
                     0

           MOVE 517 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-PERCLIST
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
002225     MOVE SQLCODE                TO WS-SQLCODE.                   
002226     IF SQLCODE NOT = 0 AND +100                                  
002227        PERFORM Z00-ERRORE                                        
002228           THRU Z00-EX.                                           
002229 L00-EX. EXIT.                                                    
002230*----------------------------------------------------------------*
002231 L01-FETCH-POINTPF13.                                             
002232*----------------------------------------------------------------*
002233     MOVE 'L01-'                 TO WCOM-CODABEND.                
002234     MOVE 'FETCH'                TO WCOM-FILEFUNZ.                
002235     MOVE 'POINTPF13'            TO WCOM-FILENOME.                
002236     MOVE SPACES                 TO WCOM-FILECTRL.                
002237     STRING WS-CODCLIEN ' ' WS-RAGFATTU                           
002238        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
002240     
      *EXEC SQL 
      *FETCH POINTPF13                                         
002241*           INTO :A901-CODCLIEN, :A901-RAGFATTU                    
002242*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 7 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODCLIEN
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-RAGFATTU
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002243     IF SQLCODE NOT = ZEROES AND +100                             
002244        PERFORM Z00-ERRORE                                        
002245           THRU Z00-EX.                                           
002246     MOVE SQLCODE                TO WS-SQLCODE2.                  
002247 L01-EX. EXIT.                                                    
002248*----------------------------------------------------------------*
002249 L02-FETCH-POINTPF14.                                             
002250*----------------------------------------------------------------*
002251     MOVE 'L02-'                 TO WCOM-CODABEND.                
002252     MOVE 'FETCH'                TO WCOM-FILEFUNZ.                
002253     MOVE 'POINTPF14'            TO WCOM-FILENOME.                
002254     MOVE SPACES                 TO WCOM-FILECTRL.                
002255     STRING WS-CODCLIEN ' ' WS-RAGFATTU                           
002256        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
002258     
      *EXEC SQL 
      *FETCH POINTPF14                                         
002259*           INTO :A901-CODCLIEN, :A901-RAGFATTU                    
002260*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 8 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODCLIEN
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-RAGFATTU
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 25 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002261     IF SQLCODE NOT = ZEROES AND +100                             
002262        PERFORM Z00-ERRORE                                        
002263           THRU Z00-EX.                                           
002264     MOVE SQLCODE                TO WS-SQLCODE2.                  
002265 L02-EX. EXIT.                                                    
002266*---------------------------------------------------------------* 
002267 L10-SELECT-SOCIETA.                                              
002268*---------------------------------------------------------------* 
002269     MOVE 'L10-'                 TO WCOM-CODABEND.                
002270     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002271     MOVE 'TSOCIETA'             TO WCOM-FILENOME.                
002272     MOVE A531-CODFORNI          TO WCOM-FILECTRL.                
002274     
      *EXEC SQL 
      *SELECT CODSOCIE                                         
002275*            INTO :A531-CODSOCIE                                   
002276*            FROM DANAGRAF.TSOCIETA                                
002277*           WHERE CODFORNI = :A531-CODFORNI                        
002278*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 9 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODFORNI
            BY VALUE 0
                     0

           MOVE 10 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 7 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002279     IF SQLCODE NOT = 0                                           
002280        PERFORM Z00-ERRORE                                        
002281           THRU Z00-EX.                                           
002282 L10-EX. EXIT.                                                    
002283*---------------------------------------------------------------* 
002284 L15-SELECT-CLIENTI.                                              
002285*---------------------------------------------------------------* 
002286     MOVE 'L15-'                 TO WCOM-CODABEND.                
002287     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002288     MOVE 'CLIENTI'              TO WCOM-FILENOME.                
002289     MOVE A901-CODCLIEN          TO WCOM-FILECTRL.                
002290     MOVE SPACES                 TO A901-CODSOCIE                 
002291                                    A901-CLIFOCON                 
002292                                    A901-TIPOCONS.                
002293     MOVE ALL '?'                TO A901-RAGFATTU.                
002295     
      *EXEC SQL 
      *SELECT CODSOCIE, RAGFATTU                               
002296*                ,CLIFOCON, CODDIVIS                               
002297*                ,TIPOCONS                                         
002298*            INTO :A901-CODSOCIE, :A901-RAGFATTU                   
002299*                ,:A901-CLIFOCON, :A901-CODDIVIS                   
002300*                ,:A901-TIPOCONS                                   
002301*            FROM DANAGRAF.TCLIENTI                                
002302*           WHERE CODCLIEN = :A901-CODCLIEN                        
002303*             AND CODSOCIE = '22'                                  
002304*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 11 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODCLIEN
            BY VALUE 0
                     0

           MOVE 12 TO SQL-STMT-ID 
           MOVE 5 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODSOCIE
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-RAGFATTU
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CLIFOCON
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODDIVIS
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-TIPOCONS
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 8 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002305     IF SQLCODE NOT = 0 AND +100                                  
002306        PERFORM Z00-ERRORE                                        
002307           THRU Z00-EX.                                           
002308 L15-EX. EXIT.                                                    
002309*---------------------------------------------------------------* 
002310 L17-SELECT-RAGFATTU.                                             
002311*---------------------------------------------------------------* 
002312     PERFORM C17-DESCRIZIONE-MAPPA                                
002313        THRU C17-EX.                                              
002314     MOVE 'L17-'                 TO WCOM-CODABEND.                
002315     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002316     MOVE 'CLIENTI'              TO WCOM-FILENOME.                
002317     MOVE WS-RAGFATTU            TO WCOM-FILECTRL.                
002318     MOVE SPACES                 TO A901-CODSOCIE                 
002319                                    A901-CODCLIEN                 
002320                                    A901-CLIFOCON                 
002321                                    A901-TIPOCONS.                
002322     MOVE ALL '?'                TO A901-RAGFATTU.                
002324     
      *EXEC SQL 
      *SELECT CODCLIEN, RAGFATTU                               
002325*                ,CLIFOCON, CODSOCIE                               
002326*                ,CODDIVIS, TIPOCONS                               
002327*            INTO :A901-CODCLIEN, :A901-RAGFATTU                   
002328*                ,:A901-CLIFOCON, :A901-CODSOCIE                   
002329*                ,:A901-CODDIVIS, :A901-TIPOCONS                   
002330*            FROM DANAGRAF.TCLIENTI                                
002331*           WHERE RAGFATTU LIKE :WS-RAGFATTU                       
002332*             AND CODSOCIE = '22'                                  
002333*          ORDER BY 1                                              
002334*          FETCH FIRST ROW ONLY                                    
002335*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 13 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-RAGFATTU
            BY VALUE 0
                     0

           MOVE 14 TO SQL-STMT-ID 
           MOVE 6 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODCLIEN
            BY VALUE 0
                     0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-RAGFATTU
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CLIFOCON
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODSOCIE
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODDIVIS
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-TIPOCONS
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 9 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002336     IF SQLCODE NOT = 0 AND +100                                  
002337        PERFORM Z00-ERRORE                                        
002338           THRU Z00-EX.                                           
002339 L17-EX. EXIT.                                                    
002340*---------------------------------------------------------------* 
002341 L18-SELECT-SERVIZI.                                              
002342*---------------------------------------------------------------* 
002343     MOVE 'M'                    TO L651-TIPSERVI                 
002344     MOVE 'L18-'                 TO WCOM-CODABEND.                
002345     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002346     MOVE 'SERVIZI'              TO WCOM-FILENOME.                
002347     MOVE SPACES                 TO WCOM-FILECTRL.                
002348     STRING L651-TIPSERVI ' ' L651-CODSERVI                       
002349        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
002350     MOVE ALL '?'                TO L651-DESSERVI.                
002351     MOVE ALL '?'                TO L651-UNMISURA.                
002353     
      *EXEC SQL 
      *SELECT DESSERVI, UNMISURA                               
002354*            INTO :L651-DESSERVI, :L651-UNMISURA                   
002355*            FROM DLOGISTI.TSERVIZI                                
002356*           WHERE CODSERVI = :L651-CODSERVI                        
002357*             AND TIPSERVI = :L651-TIPSERVI                        
002358*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 15 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-CODSERVI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-TIPSERVI
            BY VALUE 0
                     0

           MOVE 16 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 40 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-DESSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L651-UNMISURA
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 10 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002359     IF SQLCODE NOT = 0 AND +100                                  
002360        PERFORM Z00-ERRORE                                        
002361           THRU Z00-EX.                                           
002362 L18-EX. EXIT.                                                    
002363*----------------------------------------------------------------*
002364 L20-SELECT-DIVISE.                                               
002365*----------------------------------------------------------------*
002366     MOVE 'L20-'                 TO WCOM-CODABEND.                
002367     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002368     MOVE 'DIVISE'               TO WCOM-FILENOME.                
002369     MOVE A963-CODDIVIS          TO WCOM-FILECTRL.                
002371     
      *EXEC SQL 
      *SELECT DISTINCT SIGLADIV                               
002372*             INTO :A963-SIGLADIV                                  
002373*             FROM DANAGRAF.TDIVISE                                
002374*            WHERE CODDIVIS = :A963-CODDIVIS                       
002375*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 17 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A963-CODDIVIS
            BY VALUE 0
                     0

           MOVE 18 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A963-SIGLADIV
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 11 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002376     IF SQLCODE NOT = ZEROES AND +100                             
002377        PERFORM Z00-ERRORE                                        
002378           THRU Z00-EX.                                           
002379 L20-EX. EXIT.                                                    
002380*---------------------------------------------------------------* 
002381 L30-SELECT-LISTILOGI.                                            
002382*---------------------------------------------------------------* 
002383     MOVE 'L30-'                 TO WCOM-CODABEND.                
002384     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002385     MOVE 'LISTILOGI'            TO WCOM-FILENOME.                
002386     MOVE SPACES                 TO WCOM-FILECTRL.                
002387     STRING L654-CODCLIEN ' ' L654-TIPSERVI ' '                   
002388            L654-CODDIVIS                                         
002389        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
002391     
      *EXEC SQL 
      *SELECT VALUE(MAX(DTFINLIS), ' ' )                       
002392*            INTO :WS-DTFINLIS                                     
002393*            FROM DLOGISTI.TLISTILOGI                              
002394*           WHERE CODCLIEN = :L654-CODCLIEN                        
002395*             AND TIPSERVI = :L654-TIPSERVI                        
002396*             AND CODDIVIS = :L654-CODDIVIS                        
002397*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 19 TO SQL-STMT-ID 
           MOVE 3 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODCLIEN
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-TIPSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODDIVIS
            BY VALUE 0
                     0

           MOVE 20 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE WS-DTFINLIS
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 12 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002398     IF SQLCODE NOT = 0                                           
002399        PERFORM Z00-ERRORE                                        
002400           THRU Z00-EX.                                           
002401 L30-EX. EXIT.                                                    
002402*---------------------------------------------------------------* 
002403 L40-SELECT-LISTILOGI.                                            
002404*---------------------------------------------------------------* 
002405     MOVE 'L40-'                 TO WCOM-CODABEND.                
002406     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002407     MOVE 'LISTILOGI'            TO WCOM-FILENOME.                
002408     MOVE SPACES                 TO WCOM-FILECTRL.                
002409     MOVE SPACES                 TO WCOM-FILECTRL.                
002410     STRING L654-CODCLIEN ' ' L654-DTINILIS ' '                   
002411            L654-DTFINLIS ' ' L654-CODDIVIS ' '                   
002412            L654-CODSERVI                                         
002413     DELIMITED BY SIZE         INTO WCOM-FILECTRL.                
002415     
      *EXEC SQL 
      *SELECT CODSERVI                                         
002416*            INTO :L654-CODSERVI                                   
002417*            FROM DLOGISTI.TLISTILOGI                              
002418*           WHERE CODCLIEN = :L654-CODCLIEN                        
002419*             AND CODDIVIS = :L654-CODDIVIS                        
002420*             AND DTINILIS = :L654-DTINILIS                        
002421*             AND DTFINLIS = :L654-DTFINLIS                        
002422*             AND CODSERVI = :L654-CODSERVI                        
002423*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 21 TO SQL-STMT-ID 
           MOVE 5 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODCLIEN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODDIVIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTINILIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTFINLIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODSERVI
            BY VALUE 0
                     0

           MOVE 22 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODSERVI
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 13 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002424     IF SQLCODE NOT = 0  AND +100                                 
002425        PERFORM Z00-ERRORE                                        
002426           THRU Z00-EX.                                           
002427 L40-EX. EXIT.                                                    
002428*---------------------------------------------------------------* 
002429 L50-SELECT-ORDILOGI.                                             
002430*---------------------------------------------------------------* 
002431     MOVE 'L50-'                 TO WCOM-CODABEND.                
002432     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
002433     MOVE 'ORDILOGI'             TO WCOM-FILENOME.                
002434     MOVE SPACES                 TO WCOM-FILECTRL.                
002435     STRING L652-TIPSERVI ' ' L652-CODSOCIE ' '                   
002436            L652-CODCLIEN ' ' L652-CODDIVIS ' '                   
002437            L653-CODSERVI ' ' L654-DTINILIS ' '                   
002438            L654-DTFINLIS                                         
002439     DELIMITED BY SIZE         INTO WCOM-FILECTRL.                
002441     
      *EXEC SQL 
      *SELECT DISTINCT CODSERVI                                
002442*            INTO :L653-CODSERVI                                   
002443*            FROM DLOGISTI.TORDILOGI    A                          
002444*                ,DLOGISTI.TRIGORDILOGI B                          
002445*           WHERE A.AANUMORD = B.AANUMORD                          
002446*             AND A.TIPSERVI = :L652-TIPSERVI                      
002447*             AND A.CODSOCIE = :L652-CODSOCIE                      
002448*             AND A.CODCLIEN = :L652-CODCLIEN                      
002449*             AND A.CODDIVIS = :L652-CODDIVIS                      
002450*             AND B.CODSERVI = :L653-CODSERVI                      
002451*             AND A.DTANNULL = ' '                                 
002452*             AND B.DTANNULL = ' '                                 
002453*             AND A.AAMMCOMP  BETWEEN :L654-DTINILIS               
002454*                                 AND :L654-DTFINLIS               
002455*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 23 TO SQL-STMT-ID 
           MOVE 7 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-TIPSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODSOCIE
            BY VALUE 0
                     0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODCLIEN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L652-CODDIVIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CODSERVI
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTINILIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTFINLIS
            BY VALUE 0
                     0

           MOVE 24 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L653-CODSERVI
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 14 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
002456     IF SQLCODE NOT = 0  AND +100                                 
002457        PERFORM Z00-ERRORE                                        
002458           THRU Z00-EX.                                           
002459 L50-EX. EXIT.                                                    
002460*----------------------------------------------------------------*
002461 O00-OPEN-POINTER.                                                
002462*----------------------------------------------------------------*
002463     MOVE 'O00-'                 TO WCOM-CODABEND.                
002464     MOVE 'OPEN'                 TO WCOM-FILEFUNZ                 
002465     MOVE 'POINTER1'             TO WCOM-FILENOME                 
002466     MOVE SPACES                 TO WCOM-FILECTRL.                
002467     STRING L654-CODCLIEN ' ' L654-DTINILIS ' '                   
002468            L654-DTFINLIS ' ' L654-CODDIVIS                       
002469     DELIMITED BY SIZE         INTO WCOM-FILECTRL.                
002470     
      *EXEC SQL OPEN POINTER1 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 25 TO SQL-STMT-ID 
           MOVE 5 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODCLIEN
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTINILIS
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-DTFINLIS
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-TIPSERVI
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE L654-CODDIVIS
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 26 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
002471     IF SQLCODE NOT = ZEROES                                      
002472        PERFORM Z00-ERRORE                                        
002473           THRU Z00-EX.                                           
002474 O00-EX. EXIT.                                                    
002475*----------------------------------------------------------------*
002476 O10-CLOSE-POINTER.                                               
002477*----------------------------------------------------------------*
002478     MOVE 'O10-'                 TO WCOM-CODABEND.                
002479     MOVE 'CLOSE'                TO WCOM-FILEFUNZ                 
002480     MOVE 'POINTER1'             TO WCOM-FILENOME                 
002481     MOVE SPACES                 TO WCOM-FILECTRL.                
002482     
      *EXEC SQL CLOSE POINTER1 END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 20 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
002483     IF SQLCODE NOT = ZEROES                                      
002484        PERFORM Z00-ERRORE                                        
002485           THRU Z00-EX.                                           
002486 O10-EX. EXIT.                                                    
002487*----------------------------------------------------------------*
002488 P00-ATTRIBUTI-RIGA.                                              
002489*----------------------------------------------------------------*
002490     IF WCOM-FLAGPRGM = 'I'                                       
002491        MOVE DFHBMASF            TO LO50-OPERAZIOA (WINDRIGA)     
002492        MOVE DFHBLUE             TO LO50-OPERAZIOC (WINDRIGA)     
002493        MOVE DFHDFHI             TO LO50-OPERAZIOH (WINDRIGA)     
002494        IF WINDRIGA      = 1                                      
002495           MOVE DFHBMASF         TO LO50-CODSERVIA (WINDRIGA)     
002496                                    LO50-PREZZLISA (WINDRIGA)     
002497                                    LO50-PERCLISTA (WINDRIGA)     
002498           MOVE DFHBLUE          TO LO50-CODSERVIC (WINDRIGA)     
002499                                    LO50-PREZZLISC (WINDRIGA)     
002500                                    LO50-PERCLISTC (WINDRIGA)     
002501           MOVE DFHDFHI          TO LO50-CODSERVIH (WINDRIGA)     
002502                                    LO50-PREZZLISH (WINDRIGA)     
002503                                    LO50-PERCLISTH (WINDRIGA).    
002504     IF WCOM-FLAGPRGM NOT = 'I'                                   
002505        MOVE DFHBLUE             TO LO50-CODSERVIC(WINDRIGA)      
002506        MOVE DFHDFHI             TO LO50-CODSERVIH(WINDRIGA)      
002507        MOVE DFHBMASF            TO LO50-CODSERVIA(WINDRIGA)      
002508        IF WPAG-CODSERVI(WINDRIGA) NOT > SPACES                   
002509           MOVE DFHBLUE          TO LO50-OPERAZIOC(WINDRIGA)      
002510                                    LO50-PREZZLISC(WINDRIGA)      
002511                                    LO50-PERCLISTC(WINDRIGA)      
002512           MOVE DFHDFHI          TO LO50-OPERAZIOH(WINDRIGA)      
002513                                    LO50-PREZZLISH(WINDRIGA)      
002514                                    LO50-PERCLISTH(WINDRIGA)      
002515           MOVE DFHBMASF         TO LO50-OPERAZIOA(WINDRIGA)      
002516                                    LO50-PREZZLISA(WINDRIGA)      
002517                                    LO50-PERCLISTA(WINDRIGA).     
002518 P00-EX. EXIT.                                                   
002519*----------------------------------------------------------------*
002520 R00-READQ-WPAGCTRL.                                              
002521*----------------------------------------------------------------*
002522     MOVE SPACES                 TO WPAGREFE.                     
002523     INITIALIZE                     WPAGREFE.                     
002524                                                                  
002525* EXEC CICS HANDLE CONDITION ITEMERR (R00-EX)                     
002526*                               QIDERR  (R00-EX)                  
002527*    END-EXEC.                                                    
002528*    MOVE '"$<N                  ! $ #00002346' TO DFHEIV0        
002529     MOVE X'22243C4E2020202020202020' &                           
002530          X'202020202020202020202120' &                           
002531          X'2420233030303032333436' TO DFHEIV0                    
002532     CALL 'kxdfhei1' USING DFHEIV0                                
002533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002534                                                                  
002535                                                                  
002536* EXEC CICS READQ  TS QUEUE   (WPAGCTRL)                          
002537*                        INTO    (WPAGREFE)                       
002538*                        ITEM    (WNUMITEM)                       
002539*                        LENGTH  (WPAGLPAG)                       
002540*                        END-EXEC.                                
002541*    MOVE '*$II   L              ''   #00002349' TO DFHEIV0       
002542     MOVE X'2A2449492020204C20202020' &                           
002543          X'202020202020202020202720' &                           
002544          X'2020233030303032333439' TO DFHEIV0                    
002545     CALL 'kxdfhei1' USING DFHEIV0,                               
002546           WPAGCTRL,                                              
002547           WPAGREFE,                                              
002548           WPAGLPAG,                                              
002549           WNUMITEM,                                              
002550           DFHEIV99,                                              
002551           DFHEIV99                                               
002552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002553                                                                  
002554 R00-EX. EXIT.                                                    
002555*----------------------------------------------------------------*
002556 R10-READQ-WPAGLO50.                                              
002557*----------------------------------------------------------------*
002558     MOVE SPACES                 TO WLO50-CODA.                   
002559     INITIALIZE                     WLO50-CODA.                   
002560                                                                  
002561* EXEC CICS HANDLE CONDITION ITEMERR (R10-EX)                     
002562*                               QIDERR  (R10-EX)                  
002563*    END-EXEC.                                                    
002564*    MOVE '"$<N                  ! % #00002360' TO DFHEIV0        
002565     MOVE X'22243C4E2020202020202020' &                           
002566          X'202020202020202020202120' &                           
002567          X'2520233030303032333630' TO DFHEIV0                    
002568     CALL 'kxdfhei1' USING DFHEIV0                                
002569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002570                                                                  
002571                                                                  
002572* EXEC CICS READQ  TS QUEUE   (WPAGLO50)                          
002573*                        INTO    (WLO50-CODA)                     
002574*                        ITEM    (WLO50-ITEM)                     
002575*                        LENGTH  (WLO50-LENGTH)                   
002576*                        END-EXEC.                                
002577*    MOVE '*$II   L              ''   #00002363' TO DFHEIV0       
002578     MOVE X'2A2449492020204C20202020' &                           
002579          X'202020202020202020202720' &                           
002580          X'2020233030303032333633' TO DFHEIV0                    
002581     CALL 'kxdfhei1' USING DFHEIV0,                               
002582           WPAGLO50,                                              
002583           WLO50-CODA,                                            
002584           WLO50-LENGTH,                                          
002585           WLO50-ITEM,                                            
002586           DFHEIV99,                                              
002587           DFHEIV99                                               
002588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002589                                                                  
002590 R10-EX. EXIT.                                                    
002591*----------------------------------------------------------------*
002592 R20-WRITEQ-WPAG.                                                 
002593*----------------------------------------------------------------*
002594     ADD  1                      TO WCOM-PAGILIST.                
002595                                                                  
002596* EXEC CICS WRITEQ TS    QUEUE (WPAGCTRL)                         
002597*                           FROM  (WPAGREFE)                      
002598*                           LENGTH(WPAGLPAG)                      
002599*                           END-EXEC.                             
002600*    MOVE '*"     L              ''   #00002373' TO DFHEIV0       
002601     MOVE X'2A2220202020204C20202020' &                           
002602          X'202020202020202020202720' &                           
002603          X'2020233030303032333733' TO DFHEIV0                    
002604     CALL 'kxdfhei1' USING DFHEIV0,                               
002605           WPAGCTRL,                                              
002606           WPAGREFE,                                              
002607           WPAGLPAG,                                              
002608           DFHEIV99,                                              
002609           DFHEIV99,                                              
002610           DFHEIV99                                               
002611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002612                                                                  
002613 R20-EX. EXIT.                                                    
002614*-----------------------------------------------------------*     
002615 R30-REWRITE-WPAGLO50.                                            
002616*-----------------------------------------------------------*     
002617                                                                  
002618* EXEC CICS HANDLE CONDITION ITEMERR(R30-FINE)                    
002619*                               QIDERR (R30-FINE)                 
002620*    END-EXEC.                                                    
002621*    MOVE '"$<N                  ! & #00002381' TO DFHEIV0        
002622     MOVE X'22243C4E2020202020202020' &                           
002623          X'202020202020202020202120' &                           
002624          X'2620233030303032333831' TO DFHEIV0                    
002625     CALL 'kxdfhei1' USING DFHEIV0                                
002626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002627                                                                  
002628                                                                  
002629* EXEC CICS WRITEQ TS QUEUE (WPAGLO50)                            
002630*                        FROM  (WLO50-CODA)                       
002631*                        LENGTH(WLO50-LENGTH)                     
002632*                        ITEM  (WLO50-ITEM)                       
002633*                        REWRITE                                  
002634*    END-EXEC.                                                    
002635*    MOVE '*" IR  L              ''   #00002384' TO DFHEIV0       
002636     MOVE X'2A2220495220204C20202020' &                           
002637          X'202020202020202020202720' &                           
002638          X'2020233030303032333834' TO DFHEIV0                    
002639     CALL 'kxdfhei1' USING DFHEIV0,                               
002640           WPAGLO50,                                              
002641           WLO50-CODA,                                            
002642           WLO50-LENGTH,                                          
002643           WLO50-ITEM,                                            
002644           DFHEIV99,                                              
002645           DFHEIV99                                               
002646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002647                                                                  
002648     GO TO R30-EX.                                                
002649 R30-FINE.                                                        
002650     PERFORM R40-WRITEQ-WPAGLO50                                  
002651        THRU R40-EX.                                              
002652 R30-EX. EXIT.                                                    
002653*----------------------------------------------------------------*
002654 R40-WRITEQ-WPAGLO50.                                             
002655*----------------------------------------------------------------*
002656                                                                  
002657* EXEC CICS WRITEQ TS    QUEUE (WPAGLO50)                         
002658*                           FROM  (WLO50-CODA)                    
002659*                           LENGTH(WLO50-LENGTH)                  
002660*                           END-EXEC.                             
002661*    MOVE '*"     L              ''   #00002398' TO DFHEIV0       
002662     MOVE X'2A2220202020204C20202020' &                           
002663          X'202020202020202020202720' &                           
002664          X'2020233030303032333938' TO DFHEIV0                    
002665     CALL 'kxdfhei1' USING DFHEIV0,                               
002666           WPAGLO50,                                              
002667           WLO50-CODA,                                            
002668           WLO50-LENGTH,                                          
002669           DFHEIV99,                                              
002670           DFHEIV99,                                              
002671           DFHEIV99                                               
002672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002673                                                                  
002674 R40-EX. EXIT.                                                    
002675*----------------------------------------------------------------*
002676 U00-RETURN-TRAN.                                                 
002677*----------------------------------------------------------------*
002678                                                                  
002679* EXEC CICS RETURN TRANSID  (EIBTRNID)                            
002680*                     COMMAREA (WCOM-AREAXXXX)                    
002681*                     LENGTH   (WCOM-LUNGHEZZ)                    
002682*    END-EXEC.                                                    
002683*    MOVE '.(CT                  ''   #00002406' TO DFHEIV0       
002684     MOVE X'2E2843542020202020202020' &                           
002685          X'202020202020202020202720' &                           
002686          X'2020233030303032343036' TO DFHEIV0                    
002687     CALL 'kxdfhei1' USING DFHEIV0,                               
002688           EIBTRNID,                                              
002689           WCOM-AREAXXXX,                                         
002690           WCOM-LUNGHEZZ,                                         
002691           DFHEIV99,                                              
002692           DFHEIV99,                                              
002693           DFHEIV99                                               
002694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002695                                                                  
002696 U00-EX. EXIT.                                                    
002697*----------------------------------------------------------------*
002698 U02-NORESP.                                                      
002699*----------------------------------------------------------------*
002700                                                                  
002701* EXEC CICS SEND CONTROL                                          
002702*                   FREEKB                                        
002703*                   END-EXEC.                                     
002704*    MOVE '82      T    F        (   #00002414' TO DFHEIV0        
002705     MOVE X'383220202020202054202020' &                           
002706          X'204620202020202020202820' &                           
002707          X'2020233030303032343134' TO DFHEIV0                    
002708     CALL 'kxdfhei1' USING DFHEIV0,                               
002709           DFHEIV99,                                              
002710           DFHEIV99,                                              
002711           DFHEIV99,                                              
002712           DFHEIV99,                                              
002713           DFHEIV99,                                              
002714           DFHEIV99,                                              
002715           DFHEIV99                                               
002716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002717                                                                  
002718     PERFORM U00-RETURN-TRAN                                      
002719        THRU U00-EX.                                              
002720 U02-EX. EXIT.                                                    
002721*----------------------------------------------------------------*
002722 U05-START-TRANSID.                                               
002723*----------------------------------------------------------------*
002724                                                                  
002725* EXEC CICS START   TRANSID (WTRANSID)                            
002726*                      FROM    (WCOM-AREAXXXX)                    
002727*                      LENGTH  (WCOM-LUNGHEZZ)                    
002728*                      TERMID  (EIBTRMID)                         
002729*                      END-EXEC                                   
002730*    MOVE '0( LFT                1   #00002423' TO DFHEIV0        
002731     MOVE X'3028204C4654202020202020' &                           
002732          X'202020202020202020203120' &                           
002733          X'2020233030303032343233' TO DFHEIV0                    
002734     CALL 'kxdfhei1' USING DFHEIV0,                               
002735           DFHEIV99,                                              
002736           WTRANSID,                                              
002737           DFHEIV99,                                              
002738           WCOM-AREAXXXX,                                         
002739           WCOM-LUNGHEZZ,                                         
002740           EIBTRMID,                                              
002741           DFHEIV99,                                              
002742           DFHEIV99,                                              
002743           DFHEIV99,                                              
002744           DFHEIV99,                                              
002745           DFHEIV99,                                              
002746           DFHEIV99,                                              
002747           DFHEIV99,                                              
002748           DFHEIV99,                                              
002749           DFHEIV99,                                              
002750           DFHEIV99                                               
002751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
002752                                                                  
002753* EXEC CICS RETURN  END-EXEC.                                     
002754*    MOVE '.(                    ''   #00002428' TO DFHEIV0       
002755     MOVE X'2E2820202020202020202020' &                           
002756          X'202020202020202020202720' &                           
002757          X'2020233030303032343238' TO DFHEIV0                    
002758     CALL 'kxdfhei1' USING DFHEIV0,                               
002759           DFHEIV99,                                              
002760           DFHEIV99,                                              
002761           DFHEIV99,                                              
002762           DFHEIV99,                                              
002763           DFHEIV99,                                              
002764           DFHEIV99                                               
002765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002766                                                                  
002767 U05-EX. EXIT.                                                    
002768*----------------------------------------------------------------*
002769 U10-DECODIFICA-MESSAGGI.                                         
002770*----------------------------------------------------------------*
002771     MOVE WCOM-CODILING          TO MESS-CODILING.                
002772*    EXEC SQL  INCLUDE SRMESS  END-EXEC.                          
      *>>((file: SRMESS))
000001*-------------------------------------------------- SRMESS START* 
000002*-  AUTHOR: FEBBRAIOLA DOMENICO & GIUSEPPE RASPINO              * 
000003*---------------------------------------------------------------* 
000004*                                                               * 
000005*  SUBROUTINE PER LA RICERCA DEI MESSAGGI IN LINGUA             * 
000006*                                                               * 
000007*  N.B.  INSERIRE IN WORKING STORAGE :                          * 
000008*            EXEC SQL INCLUDE FDANA846 END-EXEC.                * 
000009*            COPY  DCMESS                                       * 
000010*                                                               * 
000011*  N.B.  IMPOSTARE DATI IN :                                    * 
000012*            MESS-CODERROR                                      * 
000013*            MESS-CODILING                                      * 
000014*                                                               * 
000015***************************************************************** 
000016                                                                  
000017     MOVE 'SELECT'             TO WCOM-FILEFUNZ                   
000018     MOVE 'FDANA846'           TO WCOM-FILENOME                   
000019     MOVE 'SRME'               TO WCOM-CODABEND                   
000020     MOVE MESS-CODERROR        TO WCOM-FILECTRL                   
000021                                                                  
000022     MOVE SPACES               TO MESS-CAMPI-OUTPUT.              
000023     MOVE MESS-CODERROR        TO A846-CODERROR.                  
000024     MOVE MESS-CODILING        TO A846-CODILING.                  
000025                                                                  
000027     
      *EXEC SQL 
      *SELECT MSGERROR                                         
000028*          INTO  :A846-MSGERROR                                    
000029*          FROM   DANAGRAF.TMESSAGGI                               
000030*          WHERE  CODERROR = :A846-CODERROR AND                    
000031*                 CODILING = :A846-CODILING                        
000032*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 26 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODERROR
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODILING
            BY VALUE 0
                     0

           MOVE 27 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 60 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-MSGERROR
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 15 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000033                                                                  
000034     IF SQLCODE NOT EQUAL ZEROS AND                               
000035        SQLCODE NOT EQUAL +100                                    
000036        PERFORM Z00-ERRORE                                        
000037           THRU Z00-EX                                            
000038     ELSE                                                         
000039        IF SQLCODE EQUAL ZEROS                                    
000040           MOVE MESS-CODERROR    TO MESS-COMCODER                 
000041           MOVE A846-MSGERROR    TO MESS-MESSAGGI                 
000042        ELSE                                                      
000043           MOVE '99999'          TO A846-CODERROR                 
000044           MOVE MESS-CODILING    TO A846-CODILING                 
000046           
      *EXEC SQL 
      *SELECT MSGERROR                                   
000047*                INTO  :A846-MSGERROR                              
000048*                FROM   DANAGRAF.TMESSAGGI                         
000049*                WHERE  CODERROR = :A846-CODERROR AND              
000050*                       CODILING = :A846-CODILING                  
000051*           END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 28 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODERROR
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODILING
            BY VALUE 0
                     0

           MOVE 29 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 60 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-MSGERROR
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 16 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000052           IF SQLCODE EQUAL ZEROS                                 
000053              MOVE MESS-CODERROR TO MESS-COMCODER                 
000054              MOVE A846-MSGERROR TO MESS-MESSAGGI                 
000055           ELSE                                                   
000056              IF SQLCODE = 100                                    
000057                 MOVE MESS-CODERROR   TO MESS-COMCODER            
000058                 MOVE '*** MESSAGGIO  NON  TROVATO ****'          
000059                                      TO MESS-MESSAGGI            
000060              ELSE                                                
000061                 PERFORM Z00-ERRORE                               
000062                     THRU Z00-EX.                                 
000063                                                                  
000064*------------------------------------------------- SRMESS    END* 
      *<<((file: SRMESS))
002773     MOVE MESS-MSGERROR          TO LO50-MESSAGGO.                
002774 U10-EX. EXIT.                                                    
002775*----------------------------------------------------------------*
002776 U20-DELETE-TS.                                                   
002777*----------------------------------------------------------------*
002778                                                                  
002779* EXEC CICS DELETEQ TS QUEUE   (WPAGCTRL)                         
002780*              NOHANDLE                                           
002781*              END-EXEC.                                          
002782*    MOVE '*&                    #  N#00002440' TO DFHEIV0        
002783     MOVE X'2A2620202020202020202020' &                           
002784          X'202020202020202020202320' &                           
002785          X'204E233030303032343430' TO DFHEIV0                    
002786     CALL 'kxdfhei1' USING DFHEIV0,                               
002787           WPAGCTRL,                                              
002788           DFHEIV99                                               
002789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002790                                                                  
002791 U20-EX. EXIT.                                                    
002792*----------------------------------------------------------------*
002793 U30-DELETE-WPAGLO50.                                             
002794*----------------------------------------------------------------*
002795                                                                  
002796* EXEC CICS DELETEQ TS QUEUE   (WPAGLO50)                         
002797*              NOHANDLE                                           
002798*              END-EXEC.                                          
002799*    MOVE '*&                    #  N#00002447' TO DFHEIV0        
002800     MOVE X'2A2620202020202020202020' &                           
002801          X'202020202020202020202320' &                           
002802          X'204E233030303032343437' TO DFHEIV0                    
002803     CALL 'kxdfhei1' USING DFHEIV0,                               
002804           WPAGLO50,                                              
002805           DFHEIV99                                               
002806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002807                                                                  
002808 U30-EX. EXIT.                                                    
002809*----------------------------------------------------------------*
002810*    EXEC SQL INCLUDE SRDTGG END-EXEC.                            
      *>>((file: SRDTGG))
000001*---------------------------------------------------------------* 
000002*    RICERCA DATA DEL GIORNO SULLA TABELLA-DB2 ''TDATARIO''     * 
000003*    PER IL CORRETTO UTILIZZO VEDI IL DATA MANAGER.            *  
000004*---------------------------------------------------------------* 
000005* N.B.  INSERIRE IN WORKING STORAGE :                           * 
000006*                                                               * 
000007*    EXEC SQL INCLUDE FDANA973 END-EXEC.                        * 
000008*    EXEC SQL INCLUDE DCDTGG   END-EXEC.                        * 
000009*    COPY DCWCOMMA(PER PROGRAMMI TP)  X COMODI GESTIONE ERRORI  * 
000010*    COPY DCDB2ER(PER PROGRAMMI BATCH)X COMODI GESTIONE ERRORI  * 
000011*                                                               * 
000012*---------------------------------------------------------------* 
000013                                                                  
000014 SRDTGG.                                                          
000015                                                                  
000016     MOVE +0                     TO DTGG-PRGIORNO.                
000017                                                                  
000018     MOVE SPACES                 TO DTGG-NUMGIORN                 
000019                                    DTGG-DTGIORNO                 
000020                                    DTGG-NUMSETTI                 
000021                                    DTGG-NRGGSETT                 
000022                                    DTGG-DTINISET                 
000023                                    DTGG-DTFINSET                 
000024                                    DTGG-DTINIMES                 
000025                                    DTGG-DTFINMES                 
000026                                    DTGG-ANNOSETT                 
000027                                    DTGG-RETUCODE.                
000028                                                                  
000030     
      *EXEC SQL 
      *SELECT CURRENT DATE                                     
000031*          INTO :DTGG-DATAGIOR                                     
000032*          FROM DANAGRAF.VANAGRAF_082                              
000033*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 30 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 10 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE DTGG-DATAGIOR
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 0 TO SQL-INPUT-SQLDA-ID 
           MOVE 17 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000034                                                                  
000035     MOVE DTGG-DATAGIOR(1:4)     TO DTGG-AACURREN.                
000036     MOVE DTGG-DATAGIOR(6:2)     TO DTGG-MMCURREN.                
000037     MOVE DTGG-DATAGIOR(9:2)     TO DTGG-GGCURREN.                
000038                                                                  
000039     MOVE DTGG-DTCURREN          TO DTGG-CURRENDT.                
000040                                                                  
000041     IF DTGG-DTRICHIE  NOT GREATER SPACES AND                     
000042        DTGG-PRRICHIE  NOT GREATER ZEROES                         
000043        PERFORM SRDTGG-A10-RICERCA-GIORNO                         
000044           THRU SRDTGG-A10-EX                                     
000045     ELSE                                                         
000046        IF DTGG-DTRICHIE   GREATER SPACES                         
000047           MOVE DTGG-DTRICHIE    TO A973-DTGIORNO                 
000048           PERFORM SRDTGG-A20-CALCOLO-DATARIC                     
000049              THRU SRDTGG-A20-EX                                  
000050        ELSE                                                      
000051           MOVE DTGG-PRRICHIE    TO A973-PRGIORNO                 
000052           PERFORM SRDTGG-A30-CALCOLO-PROGRES                     
000053              THRU SRDTGG-A30-EX.                                 
000054                                                                  
000055 SRDTGG-EX. EXIT.                                                 
000056                                                                  
000057*---------------------------------------------------------------* 
000058 SRDTGG-A10-RICERCA-GIORNO.                                       
000059*---------------------------------------------------------------* 
000060                                                                  
000061     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
000062     MOVE 'DATARIO'              TO WCOM-FILENOME.                
000063     MOVE 'DB2 '                 TO WCOM-CODABEND.                
000064     MOVE 'A10-RI'               TO WCOM-FILECTRL.                
000065     MOVE 'ERRORE IN SRDTGG-A10' TO WCOM-MESSAGES.                
000066                                                                  
000068     
      *EXEC SQL 
      *SELECT DTGIORNO, PRGIORNO, NUMGIORN                     
000069*                ,NUMSETTI, NRGGSETT, ANNOSETT                     
000070*                ,DTINISET, DTFINSET                               
000071*                ,DTINIMES, DTFINMES                               
000072*            INTO :A973-DTGIORNO, :A973-PRGIORNO, :A973-NUMGIORN   
000073*                ,:A973-NUMSETTI, :A973-NRGGSETT, :A973-ANNOSETT   
000074*                ,:A973-DTINISET, :A973-DTFINSET                   
000075*                ,:A973-DTINIMES, :A973-DTFINMES                   
000076*            FROM DANAGRAF.TDATARIO                                
000077*           WHERE DTGIORNO = :DTGG-CURRENDT                        
000078*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 31 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE DTGG-CURRENDT
            BY VALUE 0
                     0

           MOVE 32 TO SQL-STMT-ID 
           MOVE 10 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTGIORNO
            BY VALUE 0
                     0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-PRGIORNO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NUMGIORN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NUMSETTI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NRGGSETT
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-ANNOSETT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTINISET
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTFINSET
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTINIMES
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTFINMES
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 18 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000079                                                                  
000080     IF SQLCODE EQUAL 0                                           
000081        MOVE '****'              TO DTGG-RETUCODE                 
000082        MOVE A973-DTGIORNO       TO DTGG-DTGIORNO                 
000083        MOVE A973-PRGIORNO       TO DTGG-PRGIORNO                 
000084        MOVE A973-NUMSETTI       TO DTGG-NUMSETTI                 
000085        MOVE A973-NUMGIORN       TO DTGG-NUMGIORN                 
000086        MOVE A973-NRGGSETT       TO DTGG-NRGGSETT                 
000087        MOVE A973-DTINISET       TO DTGG-DTINISET                 
000088        MOVE A973-DTFINSET       TO DTGG-DTFINSET                 
000089        MOVE A973-DTINIMES       TO DTGG-DTINIMES                 
000090        MOVE A973-DTFINMES       TO DTGG-DTFINMES                 
000091        MOVE A973-ANNOSETT       TO DTGG-ANNOSETT                 
000092     ELSE                                                         
000093        IF SQLCODE EQUAL 100                                      
000094           MOVE 'MRNF'           TO DTGG-RETUCODE                 
000095        ELSE                                                      
000096           MOVE 'ERRO'           TO DTGG-RETUCODE.                
000097                                                                  
000098 SRDTGG-A10-EX. EXIT.                                            
000099                                                                  
000100*---------------------------------------------------------------* 
000101 SRDTGG-A20-CALCOLO-DATARIC.                                      
000102*---------------------------------------------------------------* 
000103                                                                  
000104     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
000105     MOVE 'DATARIO'              TO WCOM-FILENOME.                
000106     MOVE 'DB2 '                 TO WCOM-CODABEND.                
000107     MOVE  A973-DTGIORNO         TO WCOM-FILECTRL.                
000108     MOVE 'ERRORE IN SRDTGG-A20' TO WCOM-MESSAGES.                
000109                                                                  
000111     
      *EXEC SQL 
      *SELECT DTGIORNO, PRGIORNO, NUMGIORN                     
000112*                ,NUMSETTI, NRGGSETT, ANNOSETT                     
000113*                ,DTINISET, DTFINSET                               
000114*                ,DTINIMES, DTFINMES                               
000115*            INTO :A973-DTGIORNO, :A973-PRGIORNO, :A973-NUMGIORN   
000116*                ,:A973-NUMSETTI, :A973-NRGGSETT, :A973-ANNOSETT   
000117*                ,:A973-DTINISET, :A973-DTFINSET                   
000118*                ,:A973-DTINIMES, :A973-DTFINMES                   
000119*            FROM DANAGRAF.TDATARIO                                
000120*           WHERE DTGIORNO = :A973-DTGIORNO                        
000121*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 33 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTGIORNO
            BY VALUE 0
                     0

           MOVE 34 TO SQL-STMT-ID 
           MOVE 10 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTGIORNO
            BY VALUE 0
                     0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-PRGIORNO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NUMGIORN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NUMSETTI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NRGGSETT
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-ANNOSETT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTINISET
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTFINSET
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTINIMES
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTFINMES
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 19 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000122                                                                  
000123     IF SQLCODE EQUAL 0                                           
000124        MOVE '****'              TO DTGG-RETUCODE                 
000125        MOVE A973-DTGIORNO       TO DTGG-DTGIORNO                 
000126        MOVE A973-PRGIORNO       TO DTGG-PRGIORNO                 
000127        MOVE A973-NUMSETTI       TO DTGG-NUMSETTI                 
000128        MOVE A973-NUMGIORN       TO DTGG-NUMGIORN                 
000129        MOVE A973-NRGGSETT       TO DTGG-NRGGSETT                 
000130        MOVE A973-DTINISET       TO DTGG-DTINISET                 
000131        MOVE A973-DTFINSET       TO DTGG-DTFINSET                 
000132        MOVE A973-DTINIMES       TO DTGG-DTINIMES                 
000133        MOVE A973-DTFINMES       TO DTGG-DTFINMES                 
000134        MOVE A973-ANNOSETT       TO DTGG-ANNOSETT                 
000135     ELSE                                                         
000136        IF SQLCODE EQUAL 100                                      
000137           MOVE 'MRNF'           TO DTGG-RETUCODE                 
000138        ELSE                                                      
000139           MOVE 'ERRO'           TO DTGG-RETUCODE.                
000140                                                                  
000141 SRDTGG-A20-EX. EXIT.                                            
000142                                                                  
000143*---------------------------------------------------------------* 
000144 SRDTGG-A30-CALCOLO-PROGRES.                                      
000145*---------------------------------------------------------------* 
000146                                                                  
000147     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
000148     MOVE 'DATARIO'              TO WCOM-FILENOME.                
000149     MOVE 'DB2 '                 TO WCOM-CODABEND.                
000150     MOVE 'ERRORE IN SRDTGG-A30' TO WCOM-MESSAGES.                
000151                                                                  
000153     
      *EXEC SQL 
      *SELECT DTGIORNO, PRGIORNO, NUMGIORN                     
000154*                ,NUMSETTI, NRGGSETT, ANNOSETT                     
000155*                ,DTINISET, DTFINSET                               
000156*                ,DTINIMES, DTFINMES                               
000157*            INTO :A973-DTGIORNO, :A973-PRGIORNO, :A973-NUMGIORN   
000158*                ,:A973-NUMSETTI, :A973-NRGGSETT, :A973-ANNOSETT   
000159*                ,:A973-DTINISET, :A973-DTFINSET                   
000160*                ,:A973-DTINIMES, :A973-DTFINMES                   
000161*            FROM DANAGRAF.TDATARIO                                
000162*           WHERE PRGIORNO = :A973-PRGIORNO                        
000163*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 35 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-PRGIORNO
            BY VALUE 0
                     0

           MOVE 36 TO SQL-STMT-ID 
           MOVE 10 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTGIORNO
            BY VALUE 0
                     0

           MOVE 7 TO SQL-HOST-VAR-LENGTH
           MOVE 484 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-PRGIORNO
            BY VALUE 0
                     0

           MOVE 3 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NUMGIORN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NUMSETTI
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-NRGGSETT
            BY VALUE 0
                     0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-ANNOSETT
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTINISET
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTFINSET
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTINIMES
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 9 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A973-DTFINMES
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 20 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000164                                                                  
000165     IF SQLCODE EQUAL 0                                           
000166        MOVE '****'              TO DTGG-RETUCODE                 
000167        MOVE A973-DTGIORNO       TO DTGG-DTGIORNO                 
000168        MOVE A973-PRGIORNO       TO DTGG-PRGIORNO                 
000169        MOVE A973-NUMSETTI       TO DTGG-NUMSETTI                 
000170        MOVE A973-NUMGIORN       TO DTGG-NUMGIORN                 
000171        MOVE A973-NRGGSETT       TO DTGG-NRGGSETT                 
000172        MOVE A973-DTINISET       TO DTGG-DTINISET                 
000173        MOVE A973-DTFINSET       TO DTGG-DTFINSET                 
000174        MOVE A973-DTINIMES       TO DTGG-DTINIMES                 
000175        MOVE A973-DTFINMES       TO DTGG-DTFINMES                 
000176        MOVE A973-ANNOSETT       TO DTGG-ANNOSETT                 
000177     ELSE                                                         
000178        IF SQLCODE EQUAL 100                                      
000179           MOVE 'MRNF'           TO DTGG-RETUCODE                 
000180        ELSE                                                      
000181           MOVE 'ERRO'           TO DTGG-RETUCODE.                
000182                                                                  
000183 SRDTGG-A30-EX. EXIT.                                            
000184*--------------------------------------------------------------*  
      *<<((file: SRDTGG))
002811*----------------------------------------------------------------*
002812*COPY SRWTESTN.                                                   
002813*----------------------------------------------------------------*
002814 SRWTESTN.                                                        
002815     PERFORM WTESTN0-TEST-NUMERIC                                 
002816        THRU WTESTN0-EX.                                          
002817 SRWTESTN-EX. EXIT.                                               
002818 WTESTN0-TEST-NUMERIC.                                            
002819     MOVE SPACE          TO WSNU-WSWERROR.                        
002820     MOVE ZERO           TO WSNU-NUMEOUTN                         
002821                            WSNU-MAX                              
002822                            WSNU-NUMEOUTX.                        
002823     MOVE SPACE          TO WSNU-SPACE1                           
002824                            WSNU-SPACE2                           
002825                            WSNU-PLUSMINU.                        
002826     PERFORM VARYING WSNU-IND FROM 1 BY 1                         
002827             UNTIL WSNU-BYTE (WSNU-IND) = '+' OR '-'              
002828                OR WSNU-IND GREATER 18                            
002829     END-PERFORM.                                                 
002830     IF WSNU-BYTE (WSNU-IND) = '+' OR '-'                         
002831        MOVE WSNU-BYTE (WSNU-IND) TO WSNU-PLUSMINU.               
002832     PERFORM VARYING WSNU-MAX FROM 1 BY 1                         
002833             UNTIL WSNU-BYTE (WSNU-MAX) = ','                     
002834                OR WSNU-MAX GREATER 18                            
002835     END-PERFORM.                                                 
002836     IF WSNU-BYTE (WSNU-MAX) = ',' AND                            
002837        WSNU-DECIMALS = ZERO                                      
002838        MOVE '*' TO WSNU-WSWERROR.                                
002839     IF WSNU-BYTE (WSNU-MAX)  = ',' AND                           
002840        WSNU-DECIMALS GREATER ZERO                                
002841        COMPUTE WSNU-INDX = WSNU-INTEGERS + 1                     
002842        MOVE ',' TO WSNU-PICX (WSNU-INDX)                         
002843        MOVE WSNU-MAX TO WSNU-IND                                 
002844        MOVE ZERO     TO WSNU-INDN                                
002845        PERFORM WTEST101-MOVE-BYTE THRU WTEST101-EX               
002846                UNTIL WSNU-IND GREATER 18.                        
002847     IF WSNU-DECIMALS = ZERO                                      
002848        MOVE WSNU-INTEGERS TO WSNU-MAX                            
002849     ELSE                                                         
002850        IF WSNU-BYTE (WSNU-MAX) NOT = ','                         
002851           COMPUTE WSNU-MAX = WSNU-INTEGERS +  1                  
002852           MOVE ',' TO WSNU-PICX (WSNU-MAX)                       
002853           MOVE 18  TO WSNU-MAX                                   
002854        ELSE                                                      
002855           ADD -1 TO WSNU-MAX.                                    
002856     MOVE      14       TO WSNU-INDN                              
002857     MOVE WSNU-INTEGERS TO WSNU-INDX                              
002858     PERFORM WTEST102-MOVE-BYTE THRU WTEST102-EX                  
002859                                     18 TIMES.                    
002860     PERFORM WTEST104-LOOP THRU WTEST104-EX                       
002861             VARYING WSNU-IND  FROM 1 BY 1                        
002862             UNTIL (WSNU-PICX(WSNU-IND) GREATER '0'  AND          
002863                    WSNU-PICX(WSNU-IND) IS NUMERIC) OR            
002864                   WSNU-IND GREATER WSNU-INTEGERS                 
002865     IF WSNU-PLUSMINU GREATER SPACE AND WSNU-NUMEOUTN NOT = 0     
002866        ADD -1             TO WSNU-IND                            
002867        MOVE WSNU-PLUSMINU TO WSNU-PICX(WSNU-IND)                 
002868        IF WSNU-PLUSMINU = '-'                                    
002869           COMPUTE WSNU-NUMEOUTN = WSNU-NUMEOUTN * -1             
002870        ELSE                                                      
002871           IF WSNU-PLUSMINU = '+'                                 
002872              COMPUTE WSNU-NUMEOUTN = WSNU-NUMEOUTN * +1.         
002873     MOVE ZERO  TO WSNU-IND                                       
002874     MOVE SPACE TO WSNU-FORMAT                                    
002875     PERFORM WTEST105-LOOP THRU WTEST105-EX                       
002876                                WSNU-INTEGERS  TIMES              
002877     IF WSNU-DECIMALS GREATER ZERO                                
002878        ADD 1        TO WSNU-IND                                  
002879        MOVE ','     TO WSNU-FORMATX (WSNU-IND)                   
002880        PERFORM WTEST105-LOOP THRU WTEST105-EX                    
002881                                   WSNU-DECIMALS TIMES.           
002882 WTESTN0-EX. EXIT.                                                
002883 WTEST101-MOVE-BYTE.                                              
002884     ADD 1        TO WSNU-IND                                     
002885     IF WSNU-BYTE (WSNU-IND) IS NUMERIC                           
002886        ADD    1  TO WSNU-INDN                                    
002887        MOVE WSNU-BYTE (WSNU-IND) TO WSNU-DEC (WSNU-INDN)         
002888        ADD    1  TO WSNU-INDX                                    
002889        MOVE WSNU-BYTE (WSNU-IND) TO WSNU-PICX(WSNU-INDX)         
002890     ELSE                                                         
002891        IF WSNU-BYTE (WSNU-IND) GREATER SPACE AND                 
002892           WSNU-BYTE (WSNU-IND) NOT = WSNU-PLUSMINU               
002893           MOVE '*' TO WSNU-WSWERROR.                             
002894 WTEST101-EX. EXIT.                                               
002895 WTEST102-MOVE-BYTE.                                              
002896     IF WSNU-BYTE (WSNU-MAX) IS NUMERIC                           
002897        MOVE WSNU-BYTE (WSNU-MAX) TO WSNU-INT  (WSNU-INDN)        
002898        IF WSNU-INDX GREATER ZEROS                                
002899           MOVE WSNU-BYTE (WSNU-MAX) TO WSNU-PICX (WSNU-INDX)     
002900        END-IF                                                    
002901        ADD -1 TO WSNU-INDX WSNU-INDN                             
002902     ELSE                                                         
002903        IF WSNU-BYTE (WSNU-MAX) GREATER SPACE AND                 
002904           WSNU-BYTE (WSNU-MAX) NOT = WSNU-PLUSMINU               
002905           MOVE '*' TO WSNU-WSWERROR.                             
002906     ADD -1 TO WSNU-MAX.                                          
002907 WTEST102-EX. EXIT.                                               
002908 WTEST104-LOOP.                                                   
002909     MOVE SPACE TO WSNU-PICX(WSNU-IND).                           
002910 WTEST104-EX. EXIT.                                               
002911 WTEST105-LOOP.                                                   
002912     ADD 1      TO WSNU-IND.                                      
002913     MOVE '£'   TO WSNU-FORMATX(WSNU-IND).                        
002914 WTEST105-EX. EXIT.                                               
002915*----------------------------------------------------------------*
002916*COPY DCWTSTRP.                                                   
002917*------------------------------------- -------------------------* 
002918*                    --- DCWTSTRp ---                           * 
002919*                GESTIONE DATI PER RICICLO.                     * 
002920*---------------------------------------------------------------* 
002921 LEGGO-RICICLO.                                                   
002922                                                                  
002923* EXEC CICS HANDLE CONDITION ITEMERR (LEGGO-RICICLO-EX)           
002924*                           QIDERR  (LEGGO-RICICLO-EX)            
002925*END-EXEC.                                                        
002926*    MOVE '"$<N                  ! '' #00002564' TO DFHEIV0       
002927     MOVE X'22243C4E2020202020202020' &                           
002928          X'202020202020202020202120' &                           
002929          X'2720233030303032353634' TO DFHEIV0                    
002930     CALL 'kxdfhei1' USING DFHEIV0                                
002931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002932                                                                  
002933*    CALL 'DFHEI1' USING DFHEIV0                                  
002934*     SERVICE LABEL                                               
002935*     GO TO  LEGGO-RICICLO-EX LEGGO-RICICLO-EX DEPENDING ON       
002936*    DFHEIGDI.                                                    
002937     MOVE  1                     TO TSTR-ITEMXXXX.                
002938     MOVE EIBTRNID               TO TSTR-NOMETRAN.                
002939     MOVE EIBTRMID               TO TSTR-NOMETERM.                
002940                                                                  
002941* EXEC CICS READQ  TS QUEUE   (TSTR-NOMECODA)                     
002942*                    INTO    (TSTR-AREATSTR)                      
002943*                    ITEM    (TSTR-ITEMXXXX)                      
002944*                    LENGTH  (TSTR-LENGCODA)                      
002945*END-EXEC.                                                        
002946*    MOVE '*$II   L              ''   #00002574' TO DFHEIV0       
002947     MOVE X'2A2449492020204C20202020' &                           
002948          X'202020202020202020202720' &                           
002949          X'2020233030303032353734' TO DFHEIV0                    
002950     CALL 'kxdfhei1' USING DFHEIV0,                               
002951           TSTR-NOMECODA,                                         
002952           TSTR-AREATSTR,                                         
002953           TSTR-LENGCODA,                                         
002954           TSTR-ITEMXXXX,                                         
002955           DFHEIV99,                                              
002956           DFHEIV99                                               
002957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002958                                                                  
002959*    CALL 'DFHEI1' USING DFHEIV0  TSTR-NOMECODA TSTR-AREATSTR     
002960*    TSTR-LENGCODA DFHDUMMY TSTR-ITEMXXXX.                        
002961     MOVE TSTR-AREATSTR          TO WCOM-AREAXXXX.                
002962                                                                  
002963* EXEC CICS DELETEQ TS QUEUE  (TSTR-NOMECODA)                     
002964*                     NOHANDLE                                    
002965*END-EXEC.                                                        
002966*    MOVE '*&                    #  N#00002582' TO DFHEIV0        
002967     MOVE X'2A2620202020202020202020' &                           
002968          X'202020202020202020202320' &                           
002969          X'204E233030303032353832' TO DFHEIV0                    
002970     CALL 'kxdfhei1' USING DFHEIV0,                               
002971           TSTR-NOMECODA,                                         
002972           DFHEIV99                                               
002973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002974                                                                  
002975*    CALL 'DFHEI1' USING DFHEIV0  TSTR-NOMECODA.                  
002976 LEGGO-RICICLO-EX. EXIT.                                          
002977 SCRIVO-RICICLO.                                                  
002978     MOVE WCOM-AREAXXXX          TO TSTR-AREATSTR.                
002979     MOVE  1                     TO TSTR-ITEMXXXX.                
002980     MOVE EIBTRNID               TO TSTR-NOMETRAN.                
002981     MOVE EIBTRMID               TO TSTR-NOMETERM.                
002982                                                                  
002983* EXEC CICS DELETEQ TS QUEUE  (TSTR-NOMECODA)                     
002984*                     NOHANDLE                                    
002985*END-EXEC.                                                        
002986*    MOVE '*&                    #  N#00002592' TO DFHEIV0        
002987     MOVE X'2A2620202020202020202020' &                           
002988          X'202020202020202020202320' &                           
002989          X'204E233030303032353932' TO DFHEIV0                    
002990     CALL 'kxdfhei1' USING DFHEIV0,                               
002991           TSTR-NOMECODA,                                         
002992           DFHEIV99                                               
002993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002994                                                                  
002995*    CALL 'DFHEI1' USING DFHEIV0  TSTR-NOMECODA.                  
002996                                                                  
002997* EXEC CICS WRITEQ TS  QUEUE  (TSTR-NOMECODA)                     
002998*                     FROM   (TSTR-AREATSTR)                      
002999*                     ITEM   (TSTR-ITEMXXXX)                      
003000*                     LENGTH (TSTR-LENGCODA)                      
003001*END-EXEC.                                                        
003002*    MOVE '*" I   L              ''   #00002596' TO DFHEIV0       
003003     MOVE X'2A2220492020204C20202020' &                           
003004          X'202020202020202020202720' &                           
003005          X'2020233030303032353936' TO DFHEIV0                    
003006     CALL 'kxdfhei1' USING DFHEIV0,                               
003007           TSTR-NOMECODA,                                         
003008           TSTR-AREATSTR,                                         
003009           TSTR-LENGCODA,                                         
003010           TSTR-ITEMXXXX,                                         
003011           DFHEIV99,                                              
003012           DFHEIV99                                               
003013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003014                                                                  
003015*    CALL 'DFHEI1' USING DFHEIV0  TSTR-NOMECODA TSTR-AREATSTR     
003016*    TSTR-LENGCODA DFHDUMMY TSTR-ITEMXXXX.                        
003017 SCRIVO-RICICLO-EX. EXIT.                                         
003018*---------------------------------------------------------------* 
003019*COPY DCPERDB2.                                                   
003020*SRERCICS/P---------S = SOURCE / P = PRECOMPILED ----------------*
003021*----*  ROUTINE INTERCETTA ERRORE CICS                      *----*
003022*----*                                                      *----*
003023*----------------------------------------------------------------*
003024*       QUESTA ROUTINE E' LA PRIMA DA DICHIARARE COME COPY        
003025*----*                                                      *----*
003026*----------------------------------------------------------------*
003027*    ES.    **                                                    
003028*    ES.         COPY SRERCICP.                                   
003029*    ES.    **   SE VOGLIO INTERCETTARE ERRORE DB2                
003030*    ES.         COPY SRERDB2P                                    
003031*    ES.    **   SE VOGLIO INTERCETTARE ERRORE TOTAL              
003032*    ES.         COPY SRERDB2P                                    
003033*    ES.    **  ETC.                                              
003034*    ES.                                                          
003035*    ES.    **   ULTIMA ROUTINE CHE RILASCIA TR-ERRE  PER DECODI  
003036*    ES.    **   ERRORE                                           
003037*    ES.         COPY SRERENDS                                    
003038*                                                                 
003039*----------------------------------------------------------------*
003040 Z00-ERRORE.                                                      
003041*----------------------------------------------------------------*
003042     MOVE DFHEIV0                TO T-COMLINE.                    
003043     PERFORM                                                      
003044        VARYING INDERR FROM 1 BY 1                                
003045            UNTIL INDERR GREATER 25                               
003046               OR EL-COMLINE (INDERR) EQUAL ZERO                  
003047     END-PERFORM.                                                 
003048     MOVE SPACES                 TO WLINEAXX.                     
003049     IF INDERR LESS 26                                            
003050        MOVE EL-COMLINE (INDERR) TO EL-LINE (1)                   
003051        ADD 1                    TO INDERR                        
003052        MOVE EL-COMLINE (INDERR) TO EL-LINE (2)                   
003053        ADD 1                    TO INDERR                        
003054        MOVE EL-COMLINE (INDERR) TO EL-LINE (3)                   
003055        ADD 1                    TO INDERR                        
003056        MOVE EL-COMLINE (INDERR) TO EL-LINE (4)                   
003057        ADD 1                    TO INDERR                        
003058        MOVE EL-COMLINE (INDERR) TO EL-LINE (5).                  
003059     MOVE WLINEAXX               TO WCOM-PRGMLINE.                
003060     MOVE EIBFN                  TO WCOM-CODEIBFN.                
003061     MOVE EIBRCODE               TO WCOM-CODERCOD.                
003062     MOVE SPACES                 TO WCOM-ABENCICS.                
003063     IF EIBRESP  NOT = ZERO OR                                    
003064        EIBRESP2 NOT = ZERO                                       
003065                                                                  
003066* EXEC CICS                                                       
003067*      ASSIGN ABCODE (WCOM-ABENCICS)                              
003068*END-EXEC.                                                        
003069*    MOVE '"((                   "   #00002651' TO DFHEIV0        
003070     MOVE X'222828202020202020202020' &                           
003071          X'202020202020202020202220' &                           
003072          X'2020233030303032363531' TO DFHEIV0                    
003073     CALL 'kxdfhei1' USING DFHEIV0,                               
003074           WCOM-ABENCICS                                          
003075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003076                                                                  
003077*       CALL 'DFHEI1' USING DFHEIV0  WCOM-ABENCICS.               
003078*SRERDB2S/P -----------------------------------------------------*
003079*----*  ROUTINE INTERCETTA ERRORE DB2                       *----*
003080*----*                                                      *----*
003081*----------------------------------------------------------------*
003082*       QUESTA ROUTINE E' DA DICHIARARE DOPO LA SRERCICS          
003083*                                                                 
003084     MOVE 'ABEN'                 TO WCOM-CODATSX1.                
003085     MOVE EIBTRMID               TO WCOM-CODATSX2.                
003086*    MOVE LENGTH OF SQLCA        TO WCOM-LUNGHERR.                
003087     MOVE 136                    TO WCOM-LUNGHERR.                
003088                                                                  
003089* EXEC CICS WRITEQ TS    QUEUE  (WCOM-CODATSXX)                   
003090*                       FROM   (SQLCA)                            
003091*                       LENGTH (WCOM-LUNGHERR)                    
003092*END-EXEC.                                                        
003093*    MOVE '*"     L              ''   #00002665' TO DFHEIV0       
003094     MOVE X'2A2220202020204C20202020' &                           
003095          X'202020202020202020202720' &                           
003096          X'2020233030303032363635' TO DFHEIV0                    
003097     CALL 'kxdfhei1' USING DFHEIV0,                               
003098           WCOM-CODATSXX,                                         
003099           SQLCA,                                                 
003100           WCOM-LUNGHERR,                                         
003101           DFHEIV99,                                              
003102           DFHEIV99,                                              
003103           DFHEIV99                                               
003104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003105                                                                  
003106*    CALL 'DFHEI1' USING DFHEIV0  WCOM-CODATSXX SQLCA             
003107*    WCOM-LUNGHERR.                                               
003108*SRERENDS/P------------------------------------------------------*
003109*----*  ROUTINE FINALE                                      *----*
003110*----*                                                      *----*
003111*----------------------------------------------------------------*
003112*       QUESTA ROUTINE DA DICHIARARE PER ULTIMA NELLA SEQUNZA     
003113*       DELLE COPY  PER INTERCETTARE L'ERRORE                     
003114*----------------------------------------------------------------*
003115*----------------------------------------------------------------*
003116      MOVE EIBTRNID              TO WCOM-TRANSAZI.                
003117                                                                  
003118* EXEC CICS SYNCPOINT ROLLBACK                                    
003119*END-EXEC.                                                        
003120*    MOVE '6"R                   !   #00002680' TO DFHEIV0        
003121     MOVE X'362252202020202020202020' &                           
003122          X'202020202020202020202120' &                           
003123          X'2020233030303032363830' TO DFHEIV0                    
003124     CALL 'kxdfhei1' USING DFHEIV0                                
003125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003126                                                                  
003127*     CALL 'DFHEI1' USING DFHEIV0.                                
003128                                                                  
003129* EXEC CICS ASSIGN SYSID (WCOM-SYSID)                             
003130*END-EXEC.                                                        
003131*    MOVE '"(         $          "   #00002683' TO DFHEIV0        
003132     MOVE X'222820202020202020202024' &                           
003133          X'202020202020202020202220' &                           
003134          X'2020233030303032363833' TO DFHEIV0                    
003135     CALL 'kxdfhei1' USING DFHEIV0,                               
003136           WCOM-SYSID                                             
003137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003138                                                                  
003139*     CALL 'DFHEI1' USING DFHEIV0  WCOM-SYSID.                    
003140      MOVE 'ABEN'                    TO WCOM-CODATSX1.            
003141      MOVE EIBTRMID                  TO WCOM-CODATSX2.            
003142*     MOVE LENGTH OF WCOM-AREA-ERROR TO WCOM-LUNGHERR.            
003143      MOVE 200                       TO WCOM-LUNGHERR.            
003144*EXEC CICS WRITEQ TS QUEUE  (WCOM-CODATSXX)                       
003145                                                                  
003146* EXEC CICS WRITEQ TS                                             
003147*                    QUEUE  (WCOM-CODATSXX)                       
003148*                    FROM   (WCOM-AREA-ERROR)                     
003149*                    LENGTH (WCOM-LUNGHERR)                       
003150*END-EXEC.                                                        
003151*    MOVE '*"     L              ''   #00002691' TO DFHEIV0       
003152     MOVE X'2A2220202020204C20202020' &                           
003153          X'202020202020202020202720' &                           
003154          X'2020233030303032363931' TO DFHEIV0                    
003155     CALL 'kxdfhei1' USING DFHEIV0,                               
003156           WCOM-CODATSXX,                                         
003157           WCOM-AREA-ERROR,                                       
003158           WCOM-LUNGHERR,                                         
003159           DFHEIV99,                                              
003160           DFHEIV99,                                              
003161           DFHEIV99                                               
003162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003163                                                                  
003164*     CALL 'DFHEI1' USING DFHEIV0  WCOM-CODATSXX WCOM-AREA-ERROR  
003165*    WCOM-LUNGHERR.                                               
003166                                                                  
003167* EXEC CICS START TRANSID ('ERRE')                                
003168*                FROM    (WCOM-AREAXXXX)                          
003169*                LENGTH  (WCOM-LUNGHEZZ)                          
003170*                TERMID  (EIBTRMID)                               
003171*END-EXEC.                                                        
003172     MOVE 'ERRE' TO DFHEIV5                                       
003173*    MOVE '0( LFT                1   #00002698' TO DFHEIV0        
003174     MOVE X'3028204C4654202020202020' &                           
003175          X'202020202020202020203120' &                           
003176          X'2020233030303032363938' TO DFHEIV0                    
003177     CALL 'kxdfhei1' USING DFHEIV0,                               
003178           DFHEIV99,                                              
003179           DFHEIV5,                                               
003180           DFHEIV99,                                              
003181           WCOM-AREAXXXX,                                         
003182           WCOM-LUNGHEZZ,                                         
003183           EIBTRMID,                                              
003184           DFHEIV99,                                              
003185           DFHEIV99,                                              
003186           DFHEIV99,                                              
003187           DFHEIV99,                                              
003188           DFHEIV99,                                              
003189           DFHEIV99,                                              
003190           DFHEIV99,                                              
003191           DFHEIV99,                                              
003192           DFHEIV99,                                              
003193           DFHEIV99                                               
003194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003195                                                                  
003196*      MOVE 'ERRE' TO DFHC0040                                    
003197*     CALL 'DFHEI1' USING DFHEIV0  DFHEID0 DFHDUMMY DFHC0040      
003198*    WCOM-AREAXXXX WCOM-LUNGHEZZ EIBTRMID.                        
003199                                                                  
003200* EXEC CICS ABEND ABCODE (WCOM-ABENCICS)                          
003201*                CANCEL                                           
003202*END-EXEC.                                                        
003203*    MOVE '.,AC                  "   #00002706' TO DFHEIV0        
003204     MOVE X'2E2C41432020202020202020' &                           
003205          X'202020202020202020202220' &                           
003206          X'2020233030303032373036' TO DFHEIV0                    
003207     CALL 'kxdfhei1' USING DFHEIV0,                               
003208           WCOM-ABENCICS                                          
003209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
003210                                                                  
003211*     CALL 'DFHEI1' USING DFHEIV0  WCOM-ABENCICS.                 
003212 Z00-EX. EXIT.                                                    
003213*----------------------------------------------------------------*
003214                                                                  
003215 9999-DFHBACK SECTION.                                            
003216     MOVE '9%                    "   ' TO DFHEIV0                 
003217     MOVE 'AVTLO50' TO DFHEIV1                                    
003218     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1                        
003219     GOBACK.                                                      
003220 9999-DFHEXIT.                                                    
003221     IF DFHEIGDJ EQUAL 0001                                       
003222         NEXT SENTENCE                                            
003223     ELSE IF DFHEIGDJ EQUAL 2                                     
003224         GO TO Z00-ERRORE                                         
003225         DEPENDING ON DFHEIGDI                                    
003226     ELSE IF DFHEIGDJ EQUAL 3                                     
003227         GO TO B05-NORESP                                         
003228         DEPENDING ON DFHEIGDI                                    
003229     ELSE IF DFHEIGDJ EQUAL 4                                     
003230         GO TO R00-EX,                                            
003231               R00-EX                                             
003232         DEPENDING ON DFHEIGDI                                    
003233     ELSE IF DFHEIGDJ EQUAL 5                                     
003234         GO TO R10-EX,                                            
003235               R10-EX                                             
003236         DEPENDING ON DFHEIGDI                                    
003237     ELSE IF DFHEIGDJ EQUAL 6                                     
003238         GO TO R30-FINE,                                          
003239               R30-FINE                                           
003240         DEPENDING ON DFHEIGDI                                    
003241     ELSE IF DFHEIGDJ EQUAL 7                                     
003242         GO TO LEGGO-RICICLO-EX,                                  
003243               LEGGO-RICICLO-EX                                   
003244         DEPENDING ON DFHEIGDI.                                   
003245     MOVE '9%                    "   ' TO DFHEIV0                 
003246     MOVE 'AVTLO50' TO DFHEIV1                                    
003247     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1                        
003248     GOBACK.                                                      
