      *((program: AVTLOGI.cblx))
000001*---------------*  PROGRAMMA  TP - COBOL2 - DB2 *--------------*  
000002 ID  DIVISION.                                                    
000003*---------------*                                                 
000004 PROGRAM-ID. AVTLOGI.                 
000005*---------------------------------------------------------------* 
000006*                 M E N U    P R I N C I P A L E                * 
000007*---------------------------------------------------------------* 
000008*                  GESTIONE ORDINI LOGISTICA                    * 
000009*                  --------------------------                   * 
000010*---------------------------------------------------------------* 
000011 ENVIRONMENT DIVISION.                                            
000012*------------------------*                                        
000013 CONFIGURATION SECTION.                                           
000014 SPECIAL-NAMES.                                                   
000015     DECIMAL-POINT IS COMMA.                                      
000016 DATA DIVISION.                                                   
000017*------------------------*                                        
000018*------------------------*                                        
000019 WORKING-STORAGE SECTION.

       01  SQLDA-ID pic 9(4) comp-5.
       01  SQLDSIZE pic 9(4) comp-5.
       01  SQL-STMT-ID pic 9(4) comp-5.
       01  SQLVAR-INDEX pic 9(4) comp-5.
       01  SQL-DATA-TYPE pic 9(4) comp-5.
       01  SQL-HOST-VAR-LENGTH pic 9(9) comp-5.
       01  SQL-S-HOST-VAR-LENGTH pic 9(9) comp-5.
       01  SQL-S-LITERAL pic X(258).
       01  SQL-LITERAL1 pic X(130).
       01  SQL-LITERAL2 pic X(130).
       01  SQL-LITERAL3 pic X(130).
       01  SQL-LITERAL4 pic X(130).
       01  SQL-LITERAL5 pic X(130).
       01  SQL-LITERAL6 pic X(130).
       01  SQL-LITERAL7 pic X(130).
       01  SQL-LITERAL8 pic X(130).
       01  SQL-LITERAL9 pic X(130).
       01  SQL-LITERAL10 pic X(130).
       01  SQL-IS-LITERAL pic 9(4) comp-5 value 1.
       01  SQL-IS-INPUT-HVAR pic 9(4) comp-5 value 2.
       01  SQL-CALL-TYPE pic 9(4) comp-5.
       01  SQL-SECTIONUMBER pic 9(4) comp-5.
       01  SQL-INPUT-SQLDA-ID pic 9(4) comp-5.
       01  SQL-OUTPUT-SQLDA-ID pic 9(4) comp-5.
       01  SQLA-PROGRAM-ID.
           05 SQL-PART1 pic 9(4) COMP-5 value 172.
           05 SQL-PART2 pic X(6) value "AEAQAI".
           05 SQL-PART3 pic X(24) value "NAPaRLJo01111 2         ".
           05 SQL-PART4 pic 9(4) COMP-5 value 8.
           05 SQL-PART5 pic X(8) value "DB2XMT  ".
           05 SQL-PART6 pic X(120) value LOW-VALUES.
           05 SQL-PART7 pic 9(4) COMP-5 value 8.
           05 SQL-PART8 pic X(8) value "AVTLOGI ".
           05 SQL-PART9 pic X(120) value LOW-VALUES.
                                                                        
000020 01  DFH-START PIC X(04).                                         
000021*------------------------*                                        
000022 01  FILLER                PIC X(8)  VALUE 'DCWCOMMA'.            
000023*    COPY DCWCOMMA.                                               
000024*---------------------------------------------------------------* 
000025*----*            AREA DI PASSAGGIO DATI - WWTERRE         *----* 
000026*---------------------------------------------------------------* 
000027 01  WCOM-LUNGHERR                PIC S9(4) COMP VALUE +200.      
000028 01  WCOM-AREA-ERROR.                                             
000029     02 FILLER                    PIC X(8) VALUE 'CICSERRO'.      
000030     02 WCOM-FILEMESG.                                            
000031        04 WCOM-FILEFUNZ          PIC X(10).                      
000032        04 WCOM-FILESTAT          PIC X(5).                       
000033        04 WCOM-SQLCODEX REDEFINES WCOM-FILESTAT                  
000034                                  PIC -Z(4).                      
000035        04 WCOM-FILENOME          PIC X(30).                      
000036        04 WCOM-FILECTR1.                                         
000037           05 WCOM-FILECTRL       PIC X(35).                      
000038     02 WCOM-MESSAGE1 REDEFINES WCOM-FILEMESG.                    
000039        05 WCOM-MESSAGES          PIC X(80).                      
000040     02 WCOM-CODABEND             PIC X(4).                       
000041     02 WCOM-ABENCICS             PIC X(4).                       
000042     02 WCOM-PRGMLINE             PIC X(5)  VALUE SPACES.         
000043     02 WCOM-CODEIBFN             PIC X(2).                       
000044     02 WCOM-CODERCOD             PIC X(6).                       
000045     02 FILLER                    PIC X(91).                      
000046*---------------------------------------------------------------* 
000047*----*                AREA DI COMMAREA                     *----* 
000048*---------------------------------------------------------------* 
000049*---------------------- LUNGHEZZA WCOM-AREAXXXX                   
000050 01  WCOM-LUNGHEZZ                     PIC S9(4) COMP VALUE +300. 
000051*---------------------- NOME DEL PROGRAMMA                        
000052 01  WCOM-AREAXXXX.                                               
000053     05  WCOM-NOMEPRGM                 PIC X(8)  VALUE SPACES.    
000054*---------------------- PAGINA RICHIESTA                          
000055     05  WCOM-PAGIRICH                 PIC S9(5) COMP-3.          
000056*---------------------- PAGINA LISTATA                            
000057     05  WCOM-PAGILIST                 PIC S9(5) COMP-3.          
000058*---------------------- PAGINA ULTIMA                             
000059     05  WCOM-PAGIULTI                 PIC S9(5) COMP-3.          
000060*---------------------- FLAG PER MODULO GESTIONE FUNZIONI ESTERNE 
000061     05  WCOM-FLAGFUNZ.                                           
000062         10  WCOM-RETURNXX             PIC X(1).                  
000063         10  WCOM-DELETETS             PIC X(1).                  
000064         10  WCOM-CODILING             PIC X(1).                  
000065*---------------------- FLAG PER AGGIORNAMENTI                    
000066     05  WCOM-FLAGPRGM                 PIC X(1)  VALUE SPACES.    
000067*---------------------- SOTTOSISTEMA CICS                         
000068     05  WCOM-SYSID                    PIC X(4)  VALUE '????'.    
000069*---------------------- PRINTER ABBINATA CON 'P'                  
000070     05  WCOM-PRINTERX                 PIC X(4).                  
000071*---------------------- PRINTER ASSOCIATA MAG. FINITI             
000072     05  WCOM-PRINTERY                 PIC X(4).                  
000073*---------------------- PRINTER ASSOCIATA ALLA TRANSAZIONE        
000074     05  WCOM-PRINTERT                 PIC X(4).                  
000075*---------------------- PRINTER BAR-CODE O MODULI SPECIALI        
000076     05  WCOM-PRINTERB                 PIC X(4).                  
000077*---------------------- TRANSAZIONE                               
000078     05  WCOM-TRANSAZI                 PIC X(4).                  
000079*---------------------- DATA DEL GIORNO DA MENU'                  
000080     05  WCOM-DATAXXXX.                                           
000081         10  WCOM-DATAGGXX             PIC X(2).                  
000082         10  WCOM-DATAGGXN REDEFINES WCOM-DATAGGXX  PIC 9(2).     
000083         10  WCOM-BARRAUNO             PIC X(1).                  
000084         10  WCOM-DATAMMXX             PIC X(2).                  
000085         10  WCOM-DATAMMXN REDEFINES WCOM-DATAMMXX  PIC 9(2).     
000086         10  WCOM-BARRADUE             PIC X(1).                  
000087         10  WCOM-DATAAAXX.                                       
000088             15 WCOM-DATAAAX1          PIC 9(1).                  
000089             15 WCOM-DATAAAX2          PIC 9(1).                  
000090         10  WCOM-DATAAAXN REDEFINES WCOM-DATAAAXX  PIC 9(2).     
000091*---------------------- NOME DELLA CODA TS GENERICA               
000092     05  WCOM-CODATSXX.                                           
000093         10 WCOM-CODATSX1              PIC X(4)  VALUE SPACES.    
000094         10 WCOM-CODATSX2              PIC X(4)  VALUE SPACES.    
000095*---------------------- DATA DEL GIORNO                           
000096     05  WCOM-DTCREAZI.                                           
000097         10 WCOM-DTCREAZI-SY.                                     
000098            15 WCOM-DTCREAZI-SS        PIC X(2).                  
000099            15 WCOM-DTCREAZI-YY        PIC X(2).                  
000100         10 WCOM-DTCREAZI-SYN REDEFINES WCOM-DTCREAZI-SY PIC 9(4).
000101         10 WCOM-DTCREAZI-MM           PIC X(2).                  
000102         10 WCOM-DTCREAZI-DD           PIC X(2).                  
000103*---------------------- CODICE UTENTE                             
000104     05  WCOM-UTENCICS                 PIC X(6).                  
000105*---------------------- TRANSAZIONI NELL' AMBITO DELLA RICHIESTA  
000106     05  WCOM-INDITRAN                 PIC 9(2).                  
000107     05  WCOM-TABETRAN.                                           
000108         10  WCOM-MENUTRAN  OCCURS 10  PIC X(4).                  
000109         10  WCOM-PAGITRAN  OCCURS 10  PIC S9(5) COMP-3.          
000110*---------------------- FLAG AVVISI UTENTI/TRANSAZIONI DA SCTUTENT
000111     05  WCOM-FLAGUTEN                 PIC X(1).                  
000112     05  WCOM-FLAGTRAN                 PIC X(1).                  
000113*---------------------- FLAG UTENTI LIMITATI                      
000114     05  WCOM-FLAGLIMI                 PIC X(1).                  
000115*---------------------- LIBERI                                    
000116     05  FILLER                        PIC X(25).                 
000117*---------------------- RICHIESTA                                 
000118     05  WCOM-RIKIESTA.                                           
000119         10   WCOM-COMODOXX            PIC X(125).                
000120*    COPY DCLOGI.                                                 
000121******************************************************************
000122*                        *** DCLOGI ***                          *
000123*     DSECT RELATIVA ALLA COMMAREA DEGLI ORDINI DI LOGISTICA     *
000124*                    - LUNGHEZZA 175 BYTES -                     *
000125******************************************************************
000126         10  FILLER                           PIC X(200).         
000127     05  WORK-RICHIESTA REDEFINES WCOM-RIKIESTA.                  
000128         10  WCOM-DCLOGI.                                         
000129             15  WCOM-CODUTENT                PIC X(06).          
000130             15  WCOM-CODSOCIE                PIC X(02).          
000131             15  WCOM-CDDIVISI                PIC X(01).          
000132             15  WCOM-CODDEPOS                PIC X(02).          
000133             15  WCOM-CODCLIEN                PIC X(05).          
000134             15  WCOM-CLIFOCON                PIC X(05).          
000135             15  WCOM-CODSERVI                PIC X(06).          
000136             15  WCOM-TIPSERVI                PIC X(01).          
000137             15  WCOM-CODDIVIS                PIC X(02).          
000138             15  WCOM-UNMISURA                PIC X(02).          
000139             15  WCOM-AANUMORD                PIC X(08).          
000140             15  WCOM-NRRIGORD                PIC S9(3)  COMP-3.  
000141             15  WCOM-CONTODCE                PIC X(06).          
000142             15  WCOM-SALDATOX                PIC X(01).          
000143             15  WCOM-OPERAZIO                PIC X(01).          
000144             15  WCOM-DECIDIVI                PIC X(01).          
000145             15  WCOM-CONTOPER                PIC S9(5)  COMP-3.  
000146             15  WCOM-CODERROR                PIC X(05).          
000147             15  WCOM-FLAGAUTO                PIC X(01).          
000148             15  WCOM-SOCIEMER                PIC X(02).          
000149             15  WCOM-TIPOARTI                PIC X(01).          
000150             15  WCOM-PAESPROV                PIC X(03).          
000151             15  WCOM-PAESMERC                PIC X(03).          
000152             15  WCOM-DTCARORD                PIC X(08).          
000153             15  WCOM-FLAGMANU                PIC X(01).          
000154             15  WCOM-FLAGGIVA                PIC X(01).          
000155             15  WCOM-TIPORECO                PIC X(04).          
000156             15  WCOM-AANUMFAT                PIC X(08).          
000157             15  WCOM-DTFATTUR                PIC X(08).          
000158             15  WCOM-NRPREATT                PIC X(18).          
000159             15  WCOM-DTPREATT                PIC X(08).          
000160             15  WCOM-STATUSXX                PIC X(01).          
000161             15  WCOM-AAMMCOMP                PIC X(06).          
000162             15  WCOM-CENCOSTD                PIC X(05).          
000163             15  WCOM-CENCOSTA                PIC X(05).          
000164             15  WCOM-ESENTIVA                PIC X(01).          
000165             15  FILLER                       PIC X(32).          
000166*--------------------------------------------------------------*  
000167     10  FILLER            PIC X(150).                            
000168 01  FILLER                PIC X(8)  VALUE 'DCWWORK1'.            
000169*    COPY DCWWORK1.                                               
000170***************************************************************** 
000171******            DATI DI USO GENERALE      (DCWWORK1)     ****** 
000172***************************************************************** 
000173 01  DCW-WORK1.                                                   
000174*----------------- NOME MAPPA CON GESTIONE CODICE LINGUA          
000175     05 WNOMEMAP.                                                 
000176        10  FILLER                     PIC X(2).                  
000177        10  WCODLING                   PIC X.                     
000178        10  FILLER                     PIC X(4).                  
000179*----------------- COMODO LINEA CONTENENTE L'ULTIMO EXEC CICS     
000180     05 WLINEAXX.                                                 
000181        10  EL-LINE    OCCURS 5        PIC X.                     
000182*----------------- COMODO CONTENENTE DFHEIV0                      
000183     05 T-COMLINE.                                                
000184        10  EL-COMLINE OCCURS 29       PIC X.                     
000185*----------------- INDICE PER SCORRERE LA T-COMLINE.              
000186     05 INDERR                         PIC S9(5) COMP-3 VALUE +0. 
000187*----------------- TRANSAZIONE IMPOSTATA AL MOMENTO DEL PF5 / PF4 
000188     05 WTRANSID                       PIC X(4) VALUE SPACES.     
000189*----------------- INDICE DELLA RIGA DI MAPPA                     
000190     05 WINDRIGA                       PIC S9(3) COMP-3 VALUE +0. 
000191*----------------- NUMERO MASSIMO DI RIGHE IN UNA MAPPA           
000192     05 WNUMRIGA                       PIC 9(2)        VALUE 0.   
000193*----------------- FLAG PER GLI ERRORI A LIVELLO DI DATI-MAPPA    
000194     05 WSWERROR                       PIC X      VALUE SPACES.   
000195        88 ERRORE                                 VALUE '*'.      
000196*----------------- NUMERO PAGINA RICHIESTO                        
000197     05 WPAGRICH                       PIC S9(5) COMP-3 VALUE +0. 
000198*----------------- NUMERO RECORD CODA-TS                          
000199     05 WNUMITEM                       PIC S9(4) COMP VALUE +0.   
000200*----------------- INDICE DELLA CODA DI PAGINAZIONE TS            
000201     05 WPAGIPAG                       PIC S9(4) COMP VALUE +0.   
000202*----------------- CHIAVE DELLA CODA DI PAGINAZIONE TS            
000203     05 WPAGCTRL.                                                 
000204        10  WPAGNOME                   PIC X(4)    VALUE 'PAGI'.  
000205        10  WPAGVIDE                   PIC X(4).                  
000206*----------------- LUNGHEZZA  CODA DI PAGINAZIONE TS              
000207     05 WPAGLPAG                       PIC S9(4) COMP VALUE +0.   
000208*----------------- ABSOLUTE TIME                                  
000209     05 WABSTIME                       PIC S9(15) COMP-3 VALUE +0.
000210*----------------- ABSOLUTE YEAR                                  
000211     05 WABSYEAR                       PIC S9(8) COMP VALUE +0.   
000212*----------------- FOR RESP OPTION                                
000213     05 WEIBRESP                       PIC S9(8) COMP VALUE +0.   
000214*----------------- FOR CVDA  (CICS VALUE DATA AREA)               
000215     05 WNOLOG                         PIC S9(8) COMP VALUE +0.   
000216     05 WCVDA                          PIC S9(8) COMP VALUE +0.   
000217     05 WCVDA-OPEN                     PIC S9(8) COMP VALUE +18.  
000218     05 WCVDA-CLOSED                   PIC S9(8) COMP VALUE +19.  
000219*----------------- FOR BIF DEEDIT                                 
000220     05 WWTWSNU                        PIC X(8) VALUE 'WWTWSNU'.  
000221     05 WLENGTH                        PIC S9(4) COMP.            
000222*----------------- AREA DELLA CODA TS DI PAGINAZIONE              
000223 01  WPAGREFE.                                                    
000224     05  FILLER                        PIC X    VALUE SPACES.     
000225 01  FILLER                      PIC X(08) VALUE '**COMODI'.      
000226 01  COMODI.                                                      
000227     05 FILLER                   PIC X(01) VALUE SPACES.          
000228 01  FILLER                      PIC X(08) VALUE '**SCELTA'.      
000229 01  WS-SCELTA                   PIC X(1)  VALUE ' '.             
000230     88 SCELTA                   VALUE '*'.                       
000231 01  FILLER                      PIC X(8) VALUE 'QUERYSEC'.       
000232 01  WS-USER-ID                  PIC X(10) VALUE SPACES.          
000233 01  WS-TRANS-ID                 PIC X(04) VALUE SPACES.          
000234 01  WS-USER-READABLE            PIC X(01) VALUE SPACES.          
000235     88 NOT-AUTHORIZED           VALUE ' '.                       
000236     88 AUTHORIZED               VALUE 'X'.                       
000237     88 SUCCESSFUL               VALUE ' ', 'X'.                  
000238 01  READABLE-GROUP REDEFINES WS-USER-READABLE.                   
000239     05 RETURN-VALUE             PIC 9(2) COMP-5.                 
000240     05 FILLER                   PIC X(3).                        
000241 01  FILLER                PIC X(8) VALUE 'DCMESS**'.             
000242*    COPY DCMESS.                                                 
000243********************     DCMESS           ************************
000244*********  COPY PER ESECUZIONE DELLA SUBROUTINE SRMESS     *******
000245*********  GESTIONE MESSAGGI DI ERRORE TP/BATCH            *******
000246******************************************************************
000247 01  DCMESS.                                                      
000248     05  MESS-CAMPI-INPUT.                                        
000249         10  MESS-CODERROR      PIC X(5)       VALUE SPACES.      
000250         10  MESS-CODILING      PIC X(1)       VALUE SPACES.      
000251     05  MESS-CAMPI-OUTPUT.                                       
000252         10  MESS-MSGERROR.                                       
000253             15  MESS-COMCODER  PIC X(5)       VALUE SPACES.      
000254             15  FILLER         PIC X          VALUE SPACES.      
000255             15  MESS-MESSAGGI  PIC X(66)      VALUE SPACES.      
000256 01  FILLER                PIC X(8) VALUE 'DCWTSTR0'.             
000257*    COPY DCWTSTR0.                                               
000258*------------------------------------- -------------------------* 
000259*                    --- DCWTSTR0 ---                           * 
000260*              DSECT PER SALVATAGGIO COMMAREA.                  * 
000261*---------------------------------------------------------------* 
000262 01  DCWTSTR0.                                                    
000263     05  TSTR-LENGCODA               PIC S9(4)  COMP VALUE +4096. 
000264     05  TSTR-ITEMXXXX               PIC S9(4)  COMP VALUE +0.    
000265     05  TSTR-NOMECODA.                                           
000266         10  TSTR-NOMETRAN           PIC X(4)   VALUE SPACES.     
000267         10  TSTR-NOMETERM           PIC X(4)   VALUE SPACES.     
000268     05  TSTR-AREATSTR               PIC X(4096) VALUE SPACES.    
000269*---------------------------------------------------------------* 
000270 01  FILLER                PIC X(8) VALUE 'DCWUTEN'.              
000271*    COPY DCWUTEN.                                                
000272******************************************************            
000273******         AREA PASSAGGIO CHIAMATA          ******            
000274******       MODULO  SCTUTEN (LENGTH 250)       ******            
000275******************************************************            
000276 01  DCWUTEN.                                                     
000277     05 UTEN-RETCOD              PIC S9(3).                       
000278     05 UTEN-FUNZIONE            PIC X(4).                        
000279     05 UTEN-TIPOCTRL            PIC X.                           
000280     05 FILLER                   PIC X(3).                        
000281*----- USER                                                       
000282     05 UTEN-USER                PIC X(10).                       
000283     05 UTEN-NOMUSER             PIC X(20).                       
000284*----- SOCIETA' COMMERCIALE                                       
000285     05 UTEN-CODSOCOM            PIC XX.                          
000286     05 UTEN-NOMSOCOM            PIC X(21).                       
000287*----- UFFICIO COMMERCIALE                                        
000288     05 UTEN-CODUFCOM            PIC XX.                          
000289     05 UTEN-NOMUFCOM            PIC X(15).                       
000290*----- DEPOSITO/STABILIMENTO DELLA MERCE                          
000291     05 UTEN-CODDEPOS            PIC XX.                          
000292     05 UTEN-CODSTABI REDEFINES UTEN-CODDEPOS PIC XX.             
000293     05 UTEN-NOMDEPOS            PIC X(24).                       
000294     05 UTEN-NOMSTABI REDEFINES UTEN-NOMDEPOS PIC X(24).          
000295*----- SOCIETA' PROPRIETARIA DELLA MERCE                          
000296     05 UTEN-CODSOMER            PIC XX.                          
000297     05 UTEN-NOMSOMER            PIC X(21).                       
000298*----- CODICE LINGUA                                              
000299     05 UTEN-CODLINGUA           PIC X.                           
000300*----- CODICE DI RITORNO DA WWTSIGN                               
000301     05 UTEN-MSGERROR.                                            
000302        10 UTEN-CODERROR         PIC X(5).                        
000303        10 UTEN-TXTERROR         PIC X(15).                       
000304*----- CODICE PROPRIETA' LOGICA MERCE                             
000305     05 UTEN-PROLOMER            PIC X(02).                       
000306*----- CODICE DEPOSITO FILO                                       
000307     05 UTEN-CODDEPFF            PIC X(02).                       
000308*----- CODICE DEPOSITO GREGGIO                                    
000309     05 UTEN-CODDEPGG            PIC X(02).                       
000310*----- CODICE DEPOSITO FINITO                                     
000311     05 UTEN-CODDEPTT            PIC X(02).                       
000312*----- FLAG AVVISO PER UTENTE                                     
000313     05 UTEN-FLAGUTEN            PIC X(01).                       
000314*----- FLAG AVVISO PER TRANSAZIONE                                
000315     05 UTEN-FLAGTRAN            PIC X(01).                       
000316*----- OPID                                                       
000317     05 UTEN-OPID                PIC X(3).                        
000318*----- FLAG UTENTE LIMITATO                                       
000319     05 UTEN-FLAGLIMI            PIC X(01).                       
000320*----- CODICE DEPOSITO PRESENZE                                   
000321     05 UTEN-CODDEPPR            PIC X(02).                       
000322     05 FILLER                   PIC X(83).                       
000323******************************************************            
000324******************************************************            
000325 01  FILLER                PIC X(8) VALUE '*DCJOBS*'.             
000326*    COPY DCJOBS.                                                 
000327***************************************************************** 
000328******            AREA DI PASSAGGIO DATI                   ****** 
000329***************************************************************** 
000330*---------------------- LUNGHEZZA COMMAREA                        
000331 01  DCJOBS.                                                      
000332*---------------------- AREA LENGTH                               
000333     05  JOBS-LUNGHEZZ          PIC S9(4) COMP VALUE +40.         
000334*---------------------- TRANSACTION NAME                          
000335     05  JOBS-CODITRAN                 PIC X(4).                  
000336*---------------------- COUPLING CODE                             
000337     05  JOBS-ABBITRAN                 PIC X(8).                  
000338*-------------RETURN CODE                                         
000339     05  JOBS-RETUCODE                 PIC X(4).                  
000340*-------------RETURN CODE SQL                                     
000341     05  JOBS-SQLCODE                  PIC S9(9) COMP-4.          
000342 01  FILLER                PIC X(8)  VALUE 'AVMLOGI '.            
000343*    COPY AVMLOGI.                                                
000344*   Micro Focus Enterprise Developer  2.2.01204                   
000345*   Micro Focus BMS Screen Painter (ver BMSIDE_2-2-20)            
000346*   MapSet Name   AVMLOGI                                         
000347*   Date Created  04/27/2022                                      
000348*   Time Created  16:36:20                                        
000349*  Input Data For Map AVILOGI                                     
000350   01 AVILOGII.                                                   
000351      03 FILLER                         PIC X(12).                
000352      03 LOGI-CODSOCIEL                 PIC S9(4) COMP.           
000353      03 LOGI-CODSOCIEF                 PIC X.                    
000354      03 FILLER REDEFINES LOGI-CODSOCIEF.                         
000355         05 LOGI-CODSOCIEA                 PIC X.                 
000356      03 FILLER                         PIC X(4).                 
000357      03 LOGI-CODSOCIEI                 PIC X(2).                 
000358      03 LOGI-NOMSOCIEL                 PIC S9(4) COMP.           
000359      03 LOGI-NOMSOCIEF                 PIC X.                    
000360      03 FILLER REDEFINES LOGI-NOMSOCIEF.                         
000361         05 LOGI-NOMSOCIEA                 PIC X.                 
000362      03 FILLER                         PIC X(4).                 
000363      03 LOGI-NOMSOCIEI                 PIC X(16).                
000364      03 LOGI-MAPDATAL                  PIC S9(4) COMP.           
000365      03 LOGI-MAPDATAF                  PIC X.                    
000366      03 FILLER REDEFINES LOGI-MAPDATAF.                          
000367         05 LOGI-MAPDATAA                  PIC X.                 
000368      03 FILLER                         PIC X(4).                 
000369      03 LOGI-MAPDATAI                  PIC X(10).                
000370      03 LOGI-MAPORAXL                  PIC S9(4) COMP.           
000371      03 LOGI-MAPORAXF                  PIC X.                    
000372      03 FILLER REDEFINES LOGI-MAPORAXF.                          
000373         05 LOGI-MAPORAXA                  PIC X.                 
000374      03 FILLER                         PIC X(4).                 
000375      03 LOGI-MAPORAXI                  PIC X(8).                 
000376      03 LOGI-ORA29XXXL                 PIC S9(4) COMP.           
000377      03 LOGI-ORA29XXXF                 PIC X.                    
000378      03 FILLER REDEFINES LOGI-ORA29XXXF.                         
000379         05 LOGI-ORA29XXXA                 PIC X.                 
000380      03 FILLER                         PIC X(4).                 
000381      03 LOGI-ORA29XXXI                 PIC X(5).                 
000382      03 LOGI-ORA50XXXL                 PIC S9(4) COMP.           
000383      03 LOGI-ORA50XXXF                 PIC X.                    
000384      03 FILLER REDEFINES LOGI-ORA50XXXF.                         
000385         05 LOGI-ORA50XXXA                 PIC X.                 
000386      03 FILLER                         PIC X(4).                 
000387      03 LOGI-ORA50XXXI                 PIC X(5).                 
000388      03 LOGI-ORA51XXXL                 PIC S9(4) COMP.           
000389      03 LOGI-ORA51XXXF                 PIC X.                    
000390      03 FILLER REDEFINES LOGI-ORA51XXXF.                         
000391         05 LOGI-ORA51XXXA                 PIC X.                 
000392      03 FILLER                         PIC X(4).                 
000393      03 LOGI-ORA51XXXI                 PIC X(5).                 
000394      03 LOGI-NRSCELTAL                 PIC S9(4) COMP.           
000395      03 LOGI-NRSCELTAF                 PIC X.                    
000396      03 FILLER REDEFINES LOGI-NRSCELTAF.                         
000397         05 LOGI-NRSCELTAA                 PIC X.                 
000398      03 FILLER                         PIC X(4).                 
000399      03 LOGI-NRSCELTAI                 PIC X(2).                 
000400      03 LOGI-CODCLIENL                 PIC S9(4) COMP.           
000401      03 LOGI-CODCLIENF                 PIC X.                    
000402      03 FILLER REDEFINES LOGI-CODCLIENF.                         
000403         05 LOGI-CODCLIENA                 PIC X.                 
000404      03 FILLER                         PIC X(4).                 
000405      03 LOGI-CODCLIENI                 PIC X(5).                 
000406      03 LOGI-RAGFATTUL                 PIC S9(4) COMP.           
000407      03 LOGI-RAGFATTUF                 PIC X.                    
000408      03 FILLER REDEFINES LOGI-RAGFATTUF.                         
000409         05 LOGI-RAGFATTUA                 PIC X.                 
000410      03 FILLER                         PIC X(4).                 
000411      03 LOGI-RAGFATTUI                 PIC X(24).                
000412      03 LOGI-MESSAGGIL                 PIC S9(4) COMP.           
000413      03 LOGI-MESSAGGIF                 PIC X.                    
000414      03 FILLER REDEFINES LOGI-MESSAGGIF.                         
000415         05 LOGI-MESSAGGIA                 PIC X.                 
000416      03 FILLER                         PIC X(4).                 
000417      03 LOGI-MESSAGGII                 PIC X(73).                
000418*  Output Data For Map AVILOGI                                    
000419   01 AVILOGIO REDEFINES AVILOGII.                                
000420      03 FILLER                         PIC X(12).                
000421      03 FILLER                         PIC X(3).                 
000422      03 LOGI-CODSOCIEC                 PIC X.                    
000423      03 LOGI-CODSOCIEP                 PIC X.                    
000424      03 LOGI-CODSOCIEH                 PIC X.                    
000425      03 LOGI-CODSOCIEV                 PIC X.                    
000426      03 LOGI-CODSOCIEO                 PIC X(2).                 
000427      03 FILLER                         PIC X(3).                 
000428      03 LOGI-NOMSOCIEC                 PIC X.                    
000429      03 LOGI-NOMSOCIEP                 PIC X.                    
000430      03 LOGI-NOMSOCIEH                 PIC X.                    
000431      03 LOGI-NOMSOCIEV                 PIC X.                    
000432      03 LOGI-NOMSOCIEO                 PIC X(16).                
000433      03 FILLER                         PIC X(3).                 
000434      03 LOGI-MAPDATAC                  PIC X.                    
000435      03 LOGI-MAPDATAP                  PIC X.                    
000436      03 LOGI-MAPDATAH                  PIC X.                    
000437      03 LOGI-MAPDATAV                  PIC X.                    
000438      03 LOGI-MAPDATAO                  PIC X(10).                
000439      03 FILLER                         PIC X(3).                 
000440      03 LOGI-MAPORAXC                  PIC X.                    
000441      03 LOGI-MAPORAXP                  PIC X.                    
000442      03 LOGI-MAPORAXH                  PIC X.                    
000443      03 LOGI-MAPORAXV                  PIC X.                    
000444      03 LOGI-MAPORAXO                  PIC 99.99.99.             
000445      03 FILLER                         PIC X(3).                 
000446      03 LOGI-ORA29XXXC                 PIC X.                    
000447      03 LOGI-ORA29XXXP                 PIC X.                    
000448      03 LOGI-ORA29XXXH                 PIC X.                    
000449      03 LOGI-ORA29XXXV                 PIC X.                    
000450      03 LOGI-ORA29XXXO                 PIC X(5).                 
000451      03 FILLER                         PIC X(3).                 
000452      03 LOGI-ORA50XXXC                 PIC X.                    
000453      03 LOGI-ORA50XXXP                 PIC X.                    
000454      03 LOGI-ORA50XXXH                 PIC X.                    
000455      03 LOGI-ORA50XXXV                 PIC X.                    
000456      03 LOGI-ORA50XXXO                 PIC X(5).                 
000457      03 FILLER                         PIC X(3).                 
000458      03 LOGI-ORA51XXXC                 PIC X.                    
000459      03 LOGI-ORA51XXXP                 PIC X.                    
000460      03 LOGI-ORA51XXXH                 PIC X.                    
000461      03 LOGI-ORA51XXXV                 PIC X.                    
000462      03 LOGI-ORA51XXXO                 PIC X(5).                 
000463      03 FILLER                         PIC X(3).                 
000464      03 LOGI-NRSCELTAC                 PIC X.                    
000465      03 LOGI-NRSCELTAP                 PIC X.                    
000466      03 LOGI-NRSCELTAH                 PIC X.                    
000467      03 LOGI-NRSCELTAV                 PIC X.                    
000468      03 LOGI-NRSCELTAO                 PIC X(2).                 
000469      03 FILLER                         PIC X(3).                 
000470      03 LOGI-CODCLIENC                 PIC X.                    
000471      03 LOGI-CODCLIENP                 PIC X.                    
000472      03 LOGI-CODCLIENH                 PIC X.                    
000473      03 LOGI-CODCLIENV                 PIC X.                    
000474      03 LOGI-CODCLIENO                 PIC X(5).                 
000475      03 FILLER                         PIC X(3).                 
000476      03 LOGI-RAGFATTUC                 PIC X.                    
000477      03 LOGI-RAGFATTUP                 PIC X.                    
000478      03 LOGI-RAGFATTUH                 PIC X.                    
000479      03 LOGI-RAGFATTUV                 PIC X.                    
000480      03 LOGI-RAGFATTUO                 PIC X(24).                
000481      03 FILLER                         PIC X(3).                 
000482      03 LOGI-MESSAGGIC                 PIC X.                    
000483      03 LOGI-MESSAGGIP                 PIC X.                    
000484      03 LOGI-MESSAGGIH                 PIC X.                    
000485      03 LOGI-MESSAGGIV                 PIC X.                    
000486      03 LOGI-MESSAGGIO                 PIC X(73).                
000487*    COPY DFHAID    SUPPRESS.                                     
000488***************************************************************** 
000489*                                                               * 
000490* Copyright (c) 2016-2022 NTT DATA, Inc.                        * 
000491* All rights reserved.                                          * 
000492*                                                               * 
000493***************************************************************** 
000494 01  DFHAID.                                                      
000495     02  DFHNULL   PIC X VALUE "-".                               
000496     02  DFHENTER  PIC X VALUE "'".                               
000497     02  DFHCLEAR  PIC X VALUE "_".                               
000498     02  DFHCLRP   PIC X VALUE "|".                               
000499     02  DFHPEN    PIC X VALUE "=".                               
000500     02  DFHOPID   PIC X VALUE "W".                               
000501     02  DFHMSRE   PIC X VALUE "X".                               
000502     02  DFHSTRF   PIC X VALUE "h".                               
000503     02  DFHTRIG   PIC X VALUE '"'.                               
000504     02  DFHPA1    PIC X VALUE "%".                               
000505     02  DFHPA2    PIC X VALUE ">".                               
000506     02  DFHPA3    PIC X VALUE ",".                               
000507     02  DFHPF1    PIC X VALUE "1".                               
000508     02  DFHPF2    PIC X VALUE "2".                               
000509     02  DFHPF3    PIC X VALUE "3".                               
000510     02  DFHPF4    PIC X VALUE "4".                               
000511     02  DFHPF5    PIC X VALUE "5".                               
000512     02  DFHPF6    PIC X VALUE "6".                               
000513     02  DFHPF7    PIC X VALUE "7".                               
000514     02  DFHPF8    PIC X VALUE "8".                               
000515     02  DFHPF9    PIC X VALUE "9".                               
000516     02  DFHPF10   PIC X VALUE ":".                               
000517     02  DFHPF11   PIC X VALUE "#".                               
000518     02  DFHPF12   PIC X VALUE "@".                               
000519     02  DFHPF13   PIC X VALUE "A".                               
000520     02  DFHPF14   PIC X VALUE "B".                               
000521     02  DFHPF15   PIC X VALUE "C".                               
000522     02  DFHPF16   PIC X VALUE "D".                               
000523     02  DFHPF17   PIC X VALUE "E".                               
000524     02  DFHPF18   PIC X VALUE "F".                               
000525     02  DFHPF19   PIC X VALUE "G".                               
000526     02  DFHPF20   PIC X VALUE "H".                               
000527     02  DFHPF21   PIC X VALUE "I".                               
000528     02  DFHPF22   PIC X VALUE "[".                               
000529     02  DFHPF23   PIC X VALUE ".".                               
000530     02  DFHPF24   PIC X VALUE "<".                               
000531*    COPY DCWATTRI  SUPPRESS.                                     
000532******************************************************************
000533******       VALORI    DEGLI   ATTRIBUTI    (WCOPATTR)      ******
000534******************************************************************
000535 01       DFHBMSCA.                                               
000536   05     DFHBMEOF                    PIC X  VALUE ' '.           
000537*  X'80'  CC DI RITORNO DI UN CAMPO ANNULLATO CON CANCEL F.C.     
000538   05     DFHBMUNP                    PIC X  VALUE ' '.           
000539*  X'40'  NON PROTETTO                                            
000540   05     DFHBMFSE                    PIC X  VALUE 'A'.           
000541*  X'C1'  NON PROTETTO MDT                                        
000542   05     DFHUNPSP                    PIC X  VALUE 'D'.           
000543*  X'C4'  NON PROTETTO SELEZIONABILE                              
000544   05     DFHUNPSM                    PIC X  VALUE 'E'.           
000545*  X'C5'  NON PROTETTO SELEZIONABILE MDT                          
000546   05     DFHBMBRY                    PIC X  VALUE 'H'.           
000547*  X'C8'  NON PROTETTO LUMINOSO SELEZIONABILE                     
000548   05     DFHUNIMD                    PIC X  VALUE 'I'.           
000549*  X'C9'  NON PROTETTO LUMINOSO SELEZIONABILE MDT                 
000550   05     DFHBMDAR                    PIC X  VALUE '<'.           
000551*  X'4C'  NON PROTETTO NON VISIBILE                               
000552   05     DFHUNNOD                    PIC X  VALUE '('.           
000553*  X'4D'  NON PROTETTO NON VISIBILE MDT                           
000554   05     DFHBMUNN                    PIC X  VALUE '&'.           
000555*  X'50'  NON PROTETTO NUMERICO                                   
000556   05     DFHUNNUM                    PIC X  VALUE 'J'.           
000557*  X'D1'  NON PROTETTO NUMERICO MDT                               
000558   05     DFHUNPNS                    PIC X  VALUE 'M'.           
000559*  X'D4'  NON PROTETTO NUMERICO SELEZIONABILE                     
000560   05     DFHUNNSM                    PIC X  VALUE 'N'.           
000561*  X'D5'  NON PROTETTO NUMERICO SELEZIONABILE MDT                 
000562   05     DFHUNNBS                    PIC X  VALUE 'Q'.           
000563*  X'D8'  NON PROTETTO NUMERICO LUMINOSO SELEZIONABILE            
000564   05     DFHUNBSM                    PIC X  VALUE 'R'.           
000565*  X'D9'  NON PROTETTO NUMERICO LUMINOSO SELEZIONABILE MDT        
000566   05     DFHUNPND                    PIC X  VALUE '*'.           
000567*  X'5C'  NON PROTETTO NUMERICO NON VISIBILE                      
000568   05     DFHUNNON                    PIC X  VALUE ')'.           
000569*  X'5D'  NON PROTETTO NUMERICO NON VISIBILE MDT                  
000570   05     DFHBMPRO                    PIC X  VALUE '-'.           
000571*  X'60'  PROTETTO                                                
000572   05     DFHBMPRF                    PIC X  VALUE '/'.           
000573*  X'61'  PROTETTO MDT                                            
000574   05     DFHPROSP                    PIC X  VALUE 'U'.           
000575*  X'E4'  PROTETTO SELEZIONABILE                                  
000576   05     DFHPRSPM                    PIC X  VALUE 'V'.           
000577*  X'E5'  PROTETTO SELEZIONABILE MDT                              
000578   05     DFHPROTI                    PIC X  VALUE 'Y'.           
000579*  X'E8'  PROTETTO LUMINOSO SELEZIONABILE                         
000580   05     DFHPRLSM                    PIC X  VALUE 'Z'.           
000581*  X'E9'  PROTETTO LUMINOSO SELEZIONABILE MDT                     
000582   05     DFHPROTN                    PIC X  VALUE '%'.           
000583*  X'6C'  PROTETTO NON VISIBILE                                   
000584   05     DFHPRODM                    PIC X  VALUE '_'.           
000585*  X'6D'  PROTETTO NON VISIBILE MDT                               
000586   05     DFHBMASK                    PIC X  VALUE '0'.           
000587*  X'F0'  PROTETTO SKIP                                           
000588   05     DFHBMASF                    PIC X  VALUE '1'.           
000589*  X'F1'  PROTETTO SKIP  MDT                                      
000590   05     DFHPRSKS                    PIC X  VALUE '4'.           
000591*  X'F4'  PROTETTO SKIP  SELEZIONABILE                            
000592   05     DFHPSKSM                    PIC X  VALUE '5'.           
000593*  X'F5'  PROTETTO SKIP  SELEZIONABILE MDT                        
000594   05     DFHBMASB                    PIC X  VALUE '8'.           
000595*  X'F8'  PROTETTO SKIP  LUMINOSO SELEZIONABILE                   
000596   05     DFHPROIM                    PIC X  VALUE '9'.           
000597*  X'F9'  PROTETTO SKIP  LUMINOSO SELEZIONABILE MDT               
000598*  05     DFHPRSKD                    PIC X  VALUE '§'.           
000599   05     DFHPRSKD                    PIC X  VALUE '@'.           
000600*  X'7C'  PROTETTO SKIP  NON VISIBILE                             
000601   05     DFHPSKDM                    PIC X  VALUE QUOTE.         
000602*  X'7D'  PROTETTO SKIP  NON VISIBILE MDT                         
000603   05     DFHBLUE                     PIC X  VALUE '1'.           
000604*  X'F1'  COLORE BLUE                                             
000605   05     DFHRED                      PIC X  VALUE '2'.           
000606*  X'F2'  COLORE ROSSO                                            
000607   05     DFHPINK                     PIC X  VALUE '3'.           
000608*  X'F3'  COLORE ROSA                                             
000609   05     DFHGREEN                    PIC X  VALUE '4'.           
000610*  X'F4'  COLORE VERDE                                            
000611   05     DFHTURQ                     PIC X  VALUE '5'.           
000612*  X'F5'  COLORE AZZURRO                                          
000613   05     DFHYELLO                    PIC X  VALUE '6'.           
000614*  X'F6'  COLORE GIALLO                                           
000615   05     DFHNEUTR                    PIC X  VALUE '7'.           
000616*  X'F7'  COLORE NEUTRO                                           
000617   05     DFHDFHI                     PIC X  VALUE HIGH-VALUE.    
000618*  X'FF'  TOGLIE LA SOTTOLINEATURA (UNDERLINE)                    
000619   05     DFHUNDLN                    PIC X  VALUE '4'.           
000620*  X'F4'  IMPOSTA LA SOTTOLINEATURA (UNDERLINE)                   
000621   05     DFHREVRS                    PIC X  VALUE '2'.           
000622*  X'F4'  IMPOSTA IL REVERSE                                      
000623   05     DFHALL                      PIC X  VALUE ' '.           
000624*  X'00'  PULISCE GLI ATTRIBUTI PRENDENDO QUELLI DI MAPPA         
000625*--------------------------DANAGRAF.TSOCIETA                      
000626 01  FILLER                PIC X(8) VALUE 'FDANA531'.             
000627*    EXEC SQL   INCLUDE FDANA531   END-EXEC.                      
      *>>((file: FDANA531))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TSOCIETA                  *
000003******************************************************************
000004 01  DCLTSOCIETA.                                                 
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000005     10 A531-CODSOCIE        PIC X(2).                            
000006     10 A531-NOMSOCIE        PIC X(23).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007     10 A531-CODFORNI        PIC X(5).                            
000008     10 A531-TASSINTE        PIC S9(3)V9(2) USAGE COMP-3.         
000009     10 A531-CODPAESE        PIC X(3).                            
000010     10 A531-NRGGRISC        PIC S9(3)V USAGE COMP-3.             
000011     10 A531-CODPIANO        PIC X(2).                            
000012     10 A531-CITTASOC        PIC X(18).                           
000013     10 A531-FLPAGIVA        PIC X(1).                            
000014     10 A531-FLFATACQ        PIC X(1).                            
000015     10 A531-CODAZIEN        PIC X(5).                            
000016     10 A531-FLIVATRA        PIC X(1).                            
000017     10 A531-CODDIVIS        PIC X(2).                            
000018     10 A531-COSTINTE        PIC S9(3)V9(2) USAGE COMP-3.         
000019     10 A531-FLCONTAB        PIC X(1).                            
000020     10 A531-FLAGMAGA        PIC X(1).                            
000021     10 A531-RAGSOCIE        PIC X(50).                           
000022     10 A531-SOCIECON        PIC X(2).                            
000023     10 A531-DTCREAZI        PIC X(8).                            
000024     10 A531-DTULTVAR        PIC X(8).                            
000025     10 A531-CODUTVAR        PIC X(6).                            
000026     10 A531-INDLEGAL        PIC X(35).                           
000027     10 A531-CAPLEGAL        PIC X(5).                            
000028     10 A531-CITLEGAL        PIC X(18).                           
000029     10 A531-CODFISCA        PIC X(16).                           
000030     10 A531-CODDIVRI        PIC X(2).                            
000031     10 A531-SOCIEGTM        PIC X(2).                            
000032     10 A531-GENEFATT        PIC X(1).                            
000033     10 A531-FLAGATTI        PIC X(1).                            
000034     10 A531-DIVISOLD        PIC X(2).                            
000035     10 A531-DTFINOLD        PIC X(8).                            
000036     10 A531-DIVRIOLD        PIC X(2).                            
000037     10 A531-DIVIRIFA        PIC X(2).                            
000038     10 A531-FLEURUSA        PIC X(1).                            
000039     10 A531-FLAGLIMI        PIC X(1).                            
000040     10 A531-FLFILIAL        PIC X(1).                            
000041     10 A531-FLPRESEN        PIC X(1).                            
000042     10 A531-CODSOCPA        PIC X(1).                            
000043     10 A531-FLBOLGVB        PIC X(1).                            
000044     10 A531-FLSTCART        PIC X(1).                            
000045     10 A531-FLDIPEST        PIC X(1).                            
000046     10 A531-CODFIRMA        PIC X(8).                            
000047     10 A531-DESFIRMA        PIC X(24).                           
000048     10 A531-CDSOCJDE        PIC X(5).                            
000049     10 A531-CODFORNV        PIC X(5).                            
000050     10 A531-CODFORNA        PIC X(5).                            
000051     10 A531-IMPCCASO        PIC S9(13) COMP-3.                   
000052     10 A531-TRIBCCIA        PIC X(10).                           
000053     10 A531-PROLEGAL        PIC X(2).                            
000054     10 A531-FLSOCSAP        PIC X(1).                            
000055     10 A531-DIVIXLAV        PIC X(2).                            
000056******************************************************************
000057* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 51      *
000058******************************************************************
      *<<((file: FDANA531))
000628*--------------------------DANAGRAF.TTEMPITRANS                   
000629 01  FILLER                PIC X(8) VALUE 'FDANA839'.             
000630*    EXEC SQL   INCLUDE FDANA839   END-EXEC.                      
      *>>((file: FDANA839))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TTEMPITRANS)                             *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA839))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        NAMES(A839-)                                            *
000007*        QUOTE                                                   *
000008*        COLSUFFIX(YES)                                          *
000009* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000010******************************************************************
000011     
      *EXEC SQL DECLARE DANAGRAF.TTEMPITRANS TABLE                  
000012*     ( CODUTENT                       CHAR(6) NOT NULL,           
000013*       CODITRAN                       CHAR(4) NOT NULL,           
000014*       CODIFUNZ                       CHAR(2) NOT NULL,           
000015*       INILAVOR                       CHAR(4) NOT NULL,           
000016*       CODSOCIE                       CHAR(2) NOT NULL,           
000017*       CODDEPOS                       CHAR(2) NOT NULL,           
000018*       NOTENOTE                       CHAR(60) NOT NULL,          
000019*       NOTENOT1                       CHAR(200) NOT NULL,         
000020*       FILLA200                       CHAR(200) NOT NULL,         
000021*       FILLB200                       CHAR(200) NOT NULL,         
000022*       FILLC200                       CHAR(200) NOT NULL,         
000023*       FILLD200                       CHAR(200) NOT NULL,         
000024*       FILLE200                       CHAR(200) NOT NULL,         
000025*       FILLF200                       CHAR(200) NOT NULL,         
000026*       FILLG200                       CHAR(200) NOT NULL,         
000027*       FILLH200                       CHAR(200) NOT NULL,         
000028*       FILLI200                       CHAR(200) NOT NULL,         
000029*       FILLJ200                       CHAR(200) NOT NULL,         
000030*       FILLK200                       CHAR(200) NOT NULL,         
000031*       FILLL200                       CHAR(200) NOT NULL,         
000032*       FILLM200                       CHAR(200) NOT NULL,         
000033*       FILLN200                       CHAR(200) NOT NULL,         
000034*       FILLO200                       CHAR(200) NOT NULL,         
000035*       DTCREAZI                       CHAR(8) NOT NULL            
000036*     ) END-EXEC
                                                                        
000037******************************************************************
000038* COBOL DECLARATION FOR TABLE DANAGRAF.TTEMPITRANS               *
000039******************************************************************
000040 01  DCLTTEMPITRANS.                                              
000041*                       CODUTENT                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000042     10 A839-CODUTENT        PIC X(6).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000043*                       CODITRAN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000044     10 A839-CODITRAN        PIC X(4).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000045*                       CODIFUNZ                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000046     10 A839-CODIFUNZ        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000047*                       INILAVOR                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000048     10 A839-INILAVOR        PIC X(4).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000049*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000050     10 A839-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000051*                       CODDEPOS                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000052     10 A839-CODDEPOS        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000053*                       NOTENOTE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000054     10 A839-NOTENOTE        PIC X(60).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000055*                       NOTENOT1                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000056     10 A839-NOTENOT1        PIC X(200).                          
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000057*                       FILLA200                                  
000058     10 A839-FILLA200        PIC X(200).                          
000059*                       FILLB200                                  
000060     10 A839-FILLB200        PIC X(200).                          
000061*                       FILLC200                                  
000062     10 A839-FILLC200        PIC X(200).                          
000063*                       FILLD200                                  
000064     10 A839-FILLD200        PIC X(200).                          
000065*                       FILLE200                                  
000066     10 A839-FILLE200        PIC X(200).                          
000067*                       FILLF200                                  
000068     10 A839-FILLF200        PIC X(200).                          
000069*                       FILLG200                                  
000070     10 A839-FILLG200        PIC X(200).                          
000071*                       FILLH200                                  
000072     10 A839-FILLH200        PIC X(200).                          
000073*                       FILLI200                                  
000074     10 A839-FILLI200        PIC X(200).                          
000075*                       FILLJ200                                  
000076     10 A839-FILLJ200        PIC X(200).                          
000077*                       FILLK200                                  
000078     10 A839-FILLK200        PIC X(200).                          
000079*                       FILLL200                                  
000080     10 A839-FILLL200        PIC X(200).                          
000081*                       FILLM200                                  
000082     10 A839-FILLM200        PIC X(200).                          
000083*                       FILLN200                                  
000084     10 A839-FILLN200        PIC X(200).                          
000085*                       FILLO200                                  
000086     10 A839-FILLO200        PIC X(200).                          
000087*                       DTCREAZI                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000088     10 A839-DTCREAZI        PIC X(8).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000089******************************************************************
000090* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 24      *
000091******************************************************************
      *<<((file: FDANA839))
000631*--------------------------DANAGRAF.TMESSAGGI                     
000632 01  FILLER                PIC X(8) VALUE 'FDANA846'.             
000633*    EXEC SQL   INCLUDE FDANA846   END-EXEC.                      
      *>>((file: FDANA846))
000001******************************************************************
000002* DCLGEN TABLE(DANAGRAF.TMESSAGGI)                               *
000003*        LIBRARY(MTTEST.SOURCE.LIBTEST(FDANA846))                *
000004*        ACTION(REPLACE)                                         *
000005*        LANGUAGE(COBOL)                                         *
000006*        QUOTE                                                   *
000007* ... IS THE DCLGEN COMMAND THAT MADE THE FOLLOWING STATEMENTS   *
000008******************************************************************
000009     
      *EXEC SQL DECLARE DANAGRAF.TMESSAGGI TABLE                    
000010*     ( CODERROR                       CHAR(5) NOT NULL,           
000011*       CODILING                       CHAR(1) NOT NULL,           
000012*       MSGERROR                       CHAR(60) NOT NULL,          
000013*       TIPOMESS                       CHAR(1) NOT NULL,           
000014*       DTCREAZI                       CHAR(8) NOT NULL,           
000015*       DTULTVAR                       CHAR(8) NOT NULL,           
000016*       CODUTVAR                       CHAR(6) NOT NULL            
000017*     ) END-EXEC
                                                                        
000018******************************************************************
000019* COBOL DECLARATION FOR TABLE DANAGRAF.TMESSAGGI                 *
000020******************************************************************
000021 01  DCLTMESSAGGI.                                                
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000022     10 A846-CODERROR        PIC X(5).                            
000023     10 A846-CODILING        PIC X(1).                            
000024     10 A846-MSGERROR        PIC X(60).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000025     10 A846-TIPOMESS        PIC X(1).                            
000026     10 A846-DTCREAZI        PIC X(8).                            
000027     10 A846-DTULTVAR        PIC X(8).                            
000028     10 A846-CODUTVAR        PIC X(6).                            
000029******************************************************************
000030* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 7       *
000031******************************************************************
      *<<((file: FDANA846))
000634*--------------------------DANAGRAF.TCLIENTI                      
000635 01  FILLER                PIC X(8) VALUE 'FDANA901'.             
000636*    EXEC SQL   INCLUDE FDANA901   END-EXEC.                      
      *>>((file: FDANA901))
000001******************************************************************
000002* COBOL DECLARATION FOR TABLE DANAGRAF.TCLIENTI                  *
000003******************************************************************
000004 01  DCLTCLIENTI.                                                 
000005*                       CODCLIEN                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000006     10 A901-CODCLIEN        PIC X(5).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000007*                       STATCLIE                                  
000008     10 A901-STATCLIE        PIC X(1).                            
000009*                       GENECLIE                                  
000010     10 A901-GENECLIE        PIC X(1).                            
000011*                       TIPOCLIE                                  
000012     10 A901-TIPOCLIE        PIC X(1).                            
000013*                       TIPOCONS                                  
000014     10 A901-TIPOCONS        PIC X(1).                            
000015*                       CLIFOCON                                  
000016     10 A901-CLIFOCON        PIC X(5).                            
000017*                       CODSOCIE                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000018     10 A901-CODSOCIE        PIC X(2).                            
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000019*                       CAPOCONT                                  
000020     10 A901-CAPOCONT        PIC X(5).                            
000021*                       CODFISCA                                  
000022     10 A901-CODFISCA        PIC X(16).                           
000023*                       ESENTIVA                                  
000024     10 A901-ESENTIVA        PIC X(1).                            
000025*                       NUMESIVA                                  
000026     10 A901-NUMESIVA        PIC X(5).                            
000027*                       DATESIVA                                  
000028     10 A901-DATESIVA        PIC X(8).                            
000029*                       UFFICIVA                                  
000030     10 A901-UFFICIVA        PIC X(18).                           
000031*                       IMPESIVA                                  
000032     10 A901-IMPESIVA        PIC S9(4)V USAGE COMP-3.             
000033*                       BANCAPPO                                  
000034     10 A901-BANCAPPO        PIC X(3).                            
000035*                       NOMBANCL                                  
000036     10 A901-NOMBANCL        PIC X(114).                          
000037*                       CONTOCOR                                  
000038     10 A901-CONTOCOR        PIC X(13).                           
000039*                       ASSOBANC                                  
000040     10 A901-ASSOBANC        PIC X(5).                            
000041*                       AVVIBANC                                  
000042     10 A901-AVVIBANC        PIC X(5).                            
000043*                       CLIEFATT                                  
000044     10 A901-CLIEFATT        PIC X(5).                            
000045*                       PAESFATT                                  
000046     10 A901-PAESFATT        PIC X(3).                            
000047*                       RAGFATTU                                  
vCOBOL     
      *EXEC SQL BEGIN DECLARE SECTION END-EXEC.
000048     10 A901-RAGFATTU        PIC X(24).                           
vCOBOL     
      *EXEC SQL END DECLARE SECTION END-EXEC
                                                 
000049*                       ESRAGFAT                                  
000050     10 A901-ESRAGFAT        PIC X(24).                           
000051*                       INDFATTU                                  
000052     10 A901-INDFATTU        PIC X(24).                           
000053*                       ESINDFAT                                  
000054     10 A901-ESINDFAT        PIC X(24).                           
000055*                       CITFATTU                                  
000056     10 A901-CITFATTU        PIC X(18).                           
000057*                       ESCITFAT                                  
000058     10 A901-ESCITFAT        PIC X(18).                           
000059*                       CAPFATTU                                  
000060     10 A901-CAPFATTU        PIC X(5).                            
000061*                       PAESMERC                                  
000062     10 A901-PAESMERC        PIC X(3).                            
000063*                       RAGMERCE                                  
000064     10 A901-RAGMERCE        PIC X(24).                           
000065*                       ESRAGMER                                  
000066     10 A901-ESRAGMER        PIC X(24).                           
000067*                       INDMERCE                                  
000068     10 A901-INDMERCE        PIC X(24).                           
000069*                       ESINDMER                                  
000070     10 A901-ESINDMER        PIC X(24).                           
000071*                       CITMERCE                                  
000072     10 A901-CITMERCE        PIC X(18).                           
000073*                       ESCITMER                                  
000074     10 A901-ESCITMER        PIC X(18).                           
000075*                       CAPMERCE                                  
000076     10 A901-CAPMERCE        PIC X(5).                            
000077*                       ZONAMERC                                  
000078     10 A901-ZONAMERC        PIC X(2).                            
000079*                       TELCLIEN                                  
000080     10 A901-TELCLIEN        PIC X(20).                           
000081*                       TLXCLIEN                                  
000082     10 A901-TLXCLIEN        PIC X(20).                           
000083*                       FAXCLIEN                                  
000084     10 A901-FAXCLIEN        PIC X(20).                           
000085*                       RIFEMIRO                                  
000086     10 A901-RIFEMIRO        PIC X(11).                           
000087*                       PAESORDI                                  
000088     10 A901-PAESORDI        PIC X(3).                            
000089*                       ZONAORDI                                  
000090     10 A901-ZONAORDI        PIC X(2).                            
000091*                       DATVASTA                                  
000092     10 A901-DATVASTA        PIC X(8).                            
000093*                       ATTENZDI                                  
000094     10 A901-ATTENZDI        PIC X(24).                           
000095*                       CONDPAGA                                  
000096     10 A901-CONDPAGA        PIC X(3).                            
000097*                       MMESCLU1                                  
000098     10 A901-MMESCLU1        PIC S9(2)V USAGE COMP-3.             
000099*                       MMESCLU2                                  
000100     10 A901-MMESCLU2        PIC S9(2)V USAGE COMP-3.             
000101*                       GGSCATRA                                  
000102     10 A901-GGSCATRA        PIC S9(2)V USAGE COMP-3.             
000103*                       NUMGGVIA                                  
000104     10 A901-NUMGGVIA        PIC S9(2)V USAGE COMP-3.             
000105*                       TIPOTRAT                                  
000106     10 A901-TIPOTRAT        PIC X(1).                            
000107*                       ALTERSPE                                  
000108     10 A901-ALTERSPE        PIC X(1).                            
000109*                       CODILING                                  
000110     10 A901-CODILING        PIC X(1).                            
000111*                       DTULTVAR                                  
000112     10 A901-DTULTVAR        PIC X(8).                            
000113*                       TIPCLCAR                                  
000114     10 A901-TIPCLCAR        PIC X(1).                            
000115*                       SPETRASP                                  
000116     10 A901-SPETRASP        PIC X(1).                            
000117*                       DTCREAZI                                  
000118     10 A901-DTCREAZI        PIC X(8).                            
000119*                       CODDIVIS                                  
000120     10 A901-CODDIVIS        PIC X(2).                            
000121*                       CDIVACEE                                  
000122     10 A901-CDIVACEE        PIC X(14).                           
000123*                       ZONAFATT                                  
000124     10 A901-ZONAFATT        PIC X(2).                            
000125*                       CLASDOGA                                  
000126     10 A901-CLASDOGA        PIC X(1).                            
000127*                       INTNCLIE                                  
000128     10 A901-INTNCLIE        PIC X(50).                           
000129*                       CAPOCOMM                                  
000130     10 A901-CAPOCOMM        PIC X(5).                            
000131*                       PRIORITA                                  
000132     10 A901-PRIORITA        PIC X(1).                            
000133*                       BULSTATX                                  
000134     10 A901-BULSTATX        PIC X(13).                           
000135*                       CODUTVAR                                  
000136     10 A901-CODUTVAR        PIC X(6).                            
000137*                       CODUTCRE                                  
000138     10 A901-CODUTCRE        PIC X(6).                            
000139*                       CDRESCON                                  
000140     10 A901-CDRESCON        PIC X(2).                            
000141*                       CENCOACQ                                  
000142     10 A901-CENCOACQ        PIC X(5).                            
000143*                       CAPOSOCI                                  
000144     10 A901-CAPOSOCI        PIC X(5).                            
000145*                       CDFISCAL                                  
000146     10 A901-CDFISCAL        PIC X(16).                           
000147*                       CONDPACA                                  
000148     10 A901-CONDPACA        PIC X(3).                            
000149*                       CODXIBAN                                  
000150     10 A901-CODXIBAN        PIC X(4).                            
000151*                       CODXXCIN                                  
000152     10 A901-CODXXCIN        PIC X(2).                            
000153*                       ZIPFATTU                                  
000154     10 A901-ZIPFATTU        PIC X(15).                           
000155*                       ZIPMERCE                                  
000156     10 A901-ZIPMERCE        PIC X(15).                           
000157*                       TIPOLIST                                  
000158     10 A901-TIPOLIST        PIC X(1).                            
000159*                       SWIFTCOD                                  
000160     10 A901-SWIFTCOD        PIC X(11).                           
000161*                       PERCEIVA                                  
000162     10 A901-PERCEIVA        PIC S9(3)V9(2) USAGE COMP-3.         
000163*                       DTVALIVA                                  
000164     10 A901-DTVALIVA        PIC X(8).                            
000165*                       CLASSCLI                                  
000166     10 A901-CLASSCLI        PIC X(1).                            
000167*                       RATINGCO                                  
000168     10 A901-RATINGCO        PIC X(3).                            
000169*                       RISCHCLI                                  
000170     10 A901-RISCHCLI        PIC X(1).                            
000171*                                                                 
000172     10 A901-NRPROIVA        PIC X(30).                           
000173*                                                                 
000174     10 A901-IMPESNEW        PIC S9(9)V9(2) USAGE COMP-3.         
000175     10 A901-TIPOSTAG        PIC X(1).                            
000176     10 A901-FLFATELE        PIC X(1).                            
000177     10 A901-CDDESTFE        PIC X(7).                            
000178     10 A901-INPECCLI        PIC X(50).                           
000179******************************************************************
000180* THE NUMBER OF COLUMNS DESCRIBED BY THIS DECLARATION IS 88      *
000181******************************************************************
      *<<((file: FDANA901))
000637*    EXEC SQL   INCLUDE SQLCA      END-EXEC.                      
      *>>((file: SQLCA))
000001****************************************************************<*
000002* Copyright (c) 2016-2023 NTT DATA, Inc. All rights reserved.  *<*
000003* Users of NTT DATA Enterprise COBOL may freely                *<*
000004* redistribute this copybook.                                  *<*
000005****************************************************************<*
000006                                                                  
000007 01  SQLCA GLOBAL.                                                
000008     05  SQLCAID                PIC X(8).                         
000009     05  SQLCABC                PIC S9(9) COMP-5.                 
000010     05  SQLCODE                PIC S9(9) COMP-5.                 
000011     05  SQLERRM.                                                 
000012         49  SQLERRML           PIC S9(4) COMP-5.                 
000013         49  SQLERRMC           PIC X(254).                       
000014     05  SQLERRP                PIC X(8).                         
000015     05  SQLERRD OCCURS 6 TIMES PIC S9(9) COMP-5.                 
000016     05  SQLWARN.                                                 
000017         10 SQLWARN0            PIC X(1).                         
000018         10 SQLWARN1            PIC X(1).                         
000019         10 SQLWARN2            PIC X(1).                         
000020         10 SQLWARN3            PIC X(1).                         
000021         10 SQLWARN4            PIC X(1).                         
000022         10 SQLWARN5            PIC X(1).                         
000023         10 SQLWARN6            PIC X(1).                         
000024         10 SQLWARN7            PIC X(1).                         
000025     05  SQLSTATE               PIC X(5).                         
000026     05  SQLEXT                 PIC S9(5) COMP-3 VALUE 1.         
      *<<((file: SQLCA))
000638*----------------*                                                
000639****************************************************************  
000640*                                                                 
000641* Copyright (c) 2016-2022 NTT DATA, Inc.                          
000642* All rights reserved.                                            
000643*                                                                 
000644****************************************************************  
000645 01  DFHEIV.                                                      
000646   02  DFHEIV0               PIC X(35).                           
000647   02  DFHEIV1               PIC X(08).                           
000648   02  DFHEIV2               PIC X(08).                           
000649   02  DFHEIV3               PIC X(08).                           
000650   02  DFHEIV4               PIC X(06).                           
000651   02  DFHEIV5               PIC X(04).                           
000652   02  DFHEIV6               PIC X(04).                           
000653   02  DFHEIV7               PIC X(02).                           
000654   02  DFHEIV8               PIC X(02).                           
000655   02  DFHEIV9               PIC X(01).                           
000656   02  DFHEIV10              PIC S9(7) COMP-3.                    
000657   02  DFHEIV11              PIC S9(4) COMP SYNC.                 
000658   02  DFHEIV12              PIC S9(4) COMP SYNC.                 
000659   02  DFHEIV13              PIC S9(4) COMP SYNC.                 
000660   02  DFHEIV14              PIC S9(4) COMP SYNC.                 
000661   02  DFHEIV15              PIC S9(4) COMP SYNC.                 
000662   02  DFHEIV16              PIC S9(9) COMP SYNC.                 
000663   02  DFHEIV17              PIC X(04).                           
000664   02  DFHEIV18              PIC X(04).                           
000665   02  DFHEIV19              PIC X(04).                           
000666   02  DFHEIV20              USAGE IS POINTER.                    
000667   02  DFHEIV21              USAGE IS POINTER.                    
000668   02  DFHEIV22              USAGE IS POINTER.                    
000669   02  DFHEIV23              USAGE IS POINTER.                    
000670   02  DFHEIV24              USAGE IS POINTER.                    
000671   02  DFHEIV25              PIC S9(9) COMP SYNC.                 
000672   02  DFHEIV26              PIC S9(9) COMP SYNC.                 
000673   02  DFHEIV27              PIC S9(9) COMP SYNC.                 
000674   02  DFHEIV28              PIC S9(9) COMP SYNC.                 
000675   02  DFHEIV29              PIC S9(9) COMP SYNC.                 
000676   02  DFHEIV30              PIC S9(9) COMP SYNC.                 
000677   02  DFHEIV31              PIC S9(9) COMP SYNC.                 
000678   02  DFHEIV32              PIC S9(4) COMP SYNC.                 
000679   02  DFHEIV33              PIC S9(4) COMP SYNC.                 
000680   02  DFHEIV34              PIC S9(4) COMP SYNC.                 
000681   02  DFHEIV35              PIC S9(4) COMP SYNC.                 
000682   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.         
000683   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.      
000684   02  FILLER                PIC X(02).                           
000685   02  DFHEIV99              PIC X(08) VALUE SPACE.               
000686   02  DFHEIVL0              PIC X(48) VALUE SPACE.               
000687   02  DFHEIVL1              PIC X(48) VALUE SPACE.               
000688   02  DFHEIVL2              PIC X(48) VALUE SPACE.               
000689   02  DFHEIVL3              PIC X(48) VALUE SPACE.               
000690   02  DFHEIVL4              PIC X(255) VALUE SPACE.              
000691   02  DFHEIVL5              PIC X(255) VALUE SPACE.              
000692 LINKAGE  SECTION.                                                
000693***************************************************************** 
000694*                                                               * 
000695* Copyright (c) 2016-2022 NTT DATA, Inc.                        * 
000696* All rights reserved.                                          * 
000697*                                                               * 
000698***************************************************************** 
000699 01  dfheiblk.                                                    
000700     02  eibtime          pic s9(7) comp-3.                       
000701     02  eibdate          pic s9(7) comp-3.                       
000702     02  eibtrnid         pic x(4).                               
000703     02  eibtaskn         pic s9(7) comp-3.                       
000704     02  eibtrmid         pic x(4).                               
000705     02  dfheigdi         pic s9(4) comp.                         
000706     02  eibcposn         pic s9(4) comp.                         
000707     02  eibcalen         pic s9(4) comp.                         
000708     02  eibaid           pic x(1).                               
000709     02  eibfiller1       pic x(1).                               
000710     02  eibfn            pic x(2).                               
000711     02  eibfiller2       pic x(2).                               
000712     02  eibrcode         pic x(6).                               
000713     02  eibfiller3       pic x(2).                               
000714     02  eibds            pic x(8).                               
000715     02  eibreqid         pic x(8).                               
000716     02  eibrsrce         pic x(8).                               
000717     02  eibsync          pic x(1).                               
000718     02  eibfree          pic x(1).                               
000719     02  eibrecv          pic x(1).                               
000720     02  eibsend          pic x(1).                               
000721     02  eibatt           pic x(1).                               
000722     02  eibeoc           pic x(1).                               
000723     02  eibfmh           pic x(1).                               
000724     02  eibcompl         pic x(1).                               
000725     02  eibsig           pic x(1).                               
000726     02  eibconf          pic x(1).                               
000727     02  eiberr           pic x(1).                               
000728     02  eibrldbk         pic x(1).                               
000729     02  eiberrcd         pic x(4).                               
000730     02  eibsynrb         pic x(1).                               
000731     02  eibnodat         pic x(1).                               
000732     02  eibfiller5       pic x(2).                               
000733     02  eibresp          pic s9(8) comp.                         
000734     02  eibresp2         pic s9(8) comp.                         
000735     02  dfheigdj         pic s9(4) comp.                         
000736     02  dfheigdk         pic s9(4) comp.                         
000737*----------------*                                                
000738 01  DFHCOMMAREA           PIC X(500).                            
000739*--------------------------------------------------------------*  
000740 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.                   
000740 VCOBOL-DUMMY-PROCEDURE.
000741 0000-DFHENTRY SECTION.                                           
000742     MOVE FUNCTION WHEN-COMPILED TO DFHEIVL0(1:21).               
000743     MOVE SPACES TO DFHEIV2.                                      
000744     MOVE '9#                    &   ' TO DFHEIV0.                
000745     MOVE 'AVTLOGI' TO DFHEIV1.                                   
000746     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1       
000747          DFHEIVL0 DFHEIV2.                                       
000748*--------------------------------------------------------------*  
000749     
      *EXEC SQL WHENEVER SQLERROR GO TO Z00-ERRORE  END-EXEC
                                                                        
000750                                                                  
000751* EXEC CICS HANDLE ABEND LABEL(Z00-ERRORE)      END-EXEC.         
000752*    MOVE '..L                   " " #00000743' TO DFHEIV0        
000753     MOVE X'2E2E4C202020202020202020' &                           
000754          X'202020202020202020202220' &                           
000755          X'2220233030303030373433' TO DFHEIV0                    
000756     CALL 'kxdfhei1' USING DFHEIV0,                               
000757           DFHEIV99                                               
000758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
000759                                                                  
000760     PERFORM A00-INIZIALIZZAZIONE                                 
000761        THRU A00-EX.                                              
000762     IF EIBCALEN NOT GREATER ZERO                                 
000763        PERFORM B00-ARRIVO-DA-START                               
000764           THRU B00-EX                                            
000765     ELSE                                                         
000766        MOVE DFHCOMMAREA         TO WCOM-AREAXXXX                 
000767        MOVE 'AVMLOGI'           TO WNOMEMAP                      
000768        MOVE WCOM-CODILING       TO WCODLING                      
000769        IF EIBAID EQUAL DFHENTER OR                               
000770           EIBAID EQUAL DFHPF10                                   
000771           PERFORM C00-RICEVI-MAPPA                               
000772              THRU C00-EX                                         
000773        ELSE                                                      
000774           PERFORM D00-FUNZIONI-ESTERNE                           
000775              THRU D00-EX.                                        
000776     PERFORM E00-INVIA-MAPPA                                      
000777        THRU E00-EX.                                              
000778     PERFORM U00-RETURN-TRAN                                      
000779        THRU U00-EX.                                              
000780                                                                  
000781* GOBACK.                                                         
000782     MOVE '9%                    "   ' TO DFHEIV0                 
000783     MOVE 'AVTLOGI' TO DFHEIV1                                    
000784     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1                        
000785     GOBACK.                                                      
000786*---------------------------------------------------------------- 
000787 A00-INIZIALIZZAZIONE.                                            
000788*---------------------------------------------------------------- 
000789     MOVE  +500                  TO WCOM-LUNGHEZZ.                
000790     MOVE EIBTRMID               TO WPAGVIDE.                     
000791     MOVE LOW-VALUE              TO AVILOGIO.                     
000792     MOVE SPACE                  TO WCOM-RIKIESTA.                
000793 A00-EX. EXIT.                                                   
000794*---------------------------------------------------------------- 
000795 B00-ARRIVO-DA-START.                                             
000796*---------------------------------------------------------------- 
000797                                                                  
000798* EXEC CICS IGNORE CONDITION ENDDATA                              
000799*    END-EXEC.                                                    
000800*    MOVE '"*&                   !   #00000776' TO DFHEIV0        
000801     MOVE X'222A26202020202020202020' &                           
000802          X'202020202020202020202120' &                           
000803          X'2020233030303030373736' TO DFHEIV0                    
000804     CALL 'kxdfhei1' USING DFHEIV0                                
000805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
000806                                                                  
000807                                                                  
000808* EXEC CICS RETRIEVE INTO   (WCOM-AREAXXXX)                       
000809*                       LENGTH (WCOM-LUNGHEZZ)                    
000810*    END-EXEC.                                                    
000811*    MOVE '0*I L                 &   #00000778' TO DFHEIV0        
000812     MOVE X'302A49204C20202020202020' &                           
000813          X'202020202020202020202620' &                           
000814          X'2020233030303030373738' TO DFHEIV0                    
000815     CALL 'kxdfhei1' USING DFHEIV0,                               
000816           WCOM-AREAXXXX,                                         
000817           WCOM-LUNGHEZZ,                                         
000818           DFHEIV99,                                              
000819           DFHEIV99,                                              
000820           DFHEIV99                                               
000821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
000822                                                                  
000823     PERFORM V00-CANCELLO-CODE-RICICLO                            
000824        THRU V00-EX.                                              
000825     MOVE SPACES                 TO WCOM-RIKIESTA.                
000826     PERFORM B10-PRIMA-VOLTA                                      
000827        THRU B10-EX.                                              
000828     MOVE 'AVTLOGI'              TO WCOM-NOMEPRGM.                
000829     MOVE EIBTRNID               TO WCOM-TRANSAZI.                
000830     IF WCOM-INDITRAN NOT > SPACE OR                              
000831        WCOM-MENUTRAN (1) = WCOM-TRANSAZI                         
000832        MOVE 1                   TO WCOM-INDITRAN                 
000833        MOVE WCOM-TRANSAZI       TO WCOM-MENUTRAN (WCOM-INDITRAN) 
000834     ELSE                                                         
000835        IF WCOM-MENUTRAN (WCOM-INDITRAN) NOT = WCOM-TRANSAZI      
000836           ADD  1                TO WCOM-INDITRAN                 
000837           MOVE WCOM-TRANSAZI    TO WCOM-MENUTRAN (WCOM-INDITRAN) 
000838           IF WCOM-INDITRAN GREATER 10                            
000839              MOVE 'TRTR'        TO WCOM-CODABEND                 
000840              PERFORM Z00-ERRORE                                  
000841                 THRU Z00-EX.                                     
000842     MOVE 'AVMLOGI'              TO WNOMEMAP.                     
000843     MOVE WCOM-CODILING          TO WCODLING.                     
000844        IF WCOM-MENUTRAN(1) = 'LOGI'                              
000845           MOVE '22'             TO WCOM-CODSOCIE                 
000846        ELSE                                                      
000847           IF WCOM-MENUTRAN(1) = 'NKOF'                           
000848              MOVE '24'          TO WCOM-CODSOCIE                 
000849           ELSE                                                   
000850              MOVE '25'          TO WCOM-CODSOCIE.                
000851     MOVE WCOM-CODSOCIE          TO LOGI-CODSOCIEI.               
000852     MOVE WCOM-CODSOCIE          TO A531-CODSOCIE.                
000853     PERFORM L00-SELECT-SOCIETA                                   
000854        THRU L00-EX.                                              
000855     MOVE A531-NOMSOCIE          TO LOGI-NOMSOCIEO.               
000856 B00-EX. EXIT.                                                   
000857*---------------------------------------------------------------- 
000858 B10-PRIMA-VOLTA.                                                 
000859*---------------------------------------------------------------- 
000860     MOVE SPACES                 TO DCWUTEN.                      
000861     MOVE 'CSSN'                 TO UTEN-FUNZIONE.                
000862                                                                  
000863* EXEC CICS HANDLE ABEND CANCEL                                   
000864*    END-EXEC.                                                    
000865*    MOVE '..C                   " # #00000821' TO DFHEIV0        
000866     MOVE X'2E2E43202020202020202020' &                           
000867          X'202020202020202020202220' &                           
000868          X'2320233030303030383231' TO DFHEIV0                    
000869     CALL 'kxdfhei1' USING DFHEIV0,                               
000870           DFHEIV99                                               
000871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
000872                                                                  
000873                                                                  
000874* EXEC CICS LINK PROGRAM  ('SCTUTEN')                             
000875*                   COMMAREA (DCWUTEN)                            
000876*                   LENGTH   (250)                                
000877*    END-EXEC.                                                    
000878     MOVE 'SCTUTEN' TO DFHEIV1                                    
000879     MOVE 250                                                     
000880       TO DFHEIV11                                                
000881*    MOVE '."C                   (   #00000823' TO DFHEIV0        
000882     MOVE X'2E2243202020202020202020' &                           
000883          X'202020202020202020202820' &                           
000884          X'2020233030303030383233' TO DFHEIV0                    
000885     CALL 'kxdfhei1' USING DFHEIV0,                               
000886           DFHEIV1,                                               
000887           DCWUTEN,                                               
000888           DFHEIV11,                                              
000889           DFHEIV99,                                              
000890           DFHEIV99,                                              
000891           DFHEIV99,                                              
000892           DFHEIV99                                               
000893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
000894                                                                  
000895                                                                  
000896* EXEC CICS HANDLE ABEND RESET                                    
000897*    END-EXEC.                                                    
000898*    MOVE '..R                   " $ #00000827' TO DFHEIV0        
000899     MOVE X'2E2E52202020202020202020' &                           
000900          X'202020202020202020202220' &                           
000901          X'2420233030303030383237' TO DFHEIV0                    
000902     CALL 'kxdfhei1' USING DFHEIV0,                               
000903           DFHEIV99                                               
000904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
000905                                                                  
000906     IF UTEN-USER NOT GREATER SPACES OR                           
000907        UTEN-USER = 'CICSDFL'                                     
000908        MOVE '00007'             TO MESS-CODERROR                 
000909     ELSE                                                         
000910        IF UTEN-RETCOD = 100                                      
000911           MOVE '00008'          TO MESS-CODERROR.                
000912     IF MESS-CODERROR GREATER SPACES                              
000913        MOVE 'I'                 TO WCOM-CODILING                 
000914        PERFORM U10-DECOD-MESSAGGI                                
000915           THRU U10-EX                                            
000916                                                                  
000917* EXEC CICS SEND FROM   (MESS-MSGERROR)                           
000918*                      LENGTH (66)                                
000919*                      ERASE                                      
000920*       END-EXEC                                                  
000921     MOVE 66                                                      
000922       TO DFHEIV11                                                
000923*    MOVE '$$      E         L F ,   #00000839' TO DFHEIV0        
000924     MOVE X'242420202020202045202020' &                           
000925          X'2020202020204C2046202C20' &                           
000926          X'2020233030303030383339' TO DFHEIV0                    
000927     CALL 'kxdfhei1' USING DFHEIV0,                               
000928           MESS-MSGERROR,                                         
000929           DFHEIV11,                                              
000930           DFHEIV99,                                              
000931           DFHEIV99,                                              
000932           DFHEIV99,                                              
000933           DFHEIV99,                                              
000934           DFHEIV99,                                              
000935           DFHEIV99,                                              
000936           DFHEIV99,                                              
000937           DFHEIV99,                                              
000938           DFHEIV99                                               
000939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
000940                                                                  
000941* EXEC CICS RETURN END-EXEC.                                      
000942*    MOVE '.(                    ''   #00000843' TO DFHEIV0       
000943     MOVE X'2E2820202020202020202020' &                           
000944          X'202020202020202020202720' &                           
000945          X'2020233030303030383433' TO DFHEIV0                    
000946     CALL 'kxdfhei1' USING DFHEIV0,                               
000947           DFHEIV99,                                              
000948           DFHEIV99,                                              
000949           DFHEIV99,                                              
000950           DFHEIV99,                                              
000951           DFHEIV99,                                              
000952           DFHEIV99                                               
000953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
000954                                                                  
000955     MOVE UTEN-USER              TO WCOM-UTENCICS.                
000956     MOVE 'I'                    TO WCOM-CODILING.                
000957     IF UTEN-CODLINGUA GREATER SPACE                              
000958        MOVE UTEN-CODLINGUA      TO WCOM-CODILING.                
000959     IF UTEN-CODSOMER GREATER SPACES                              
000960        MOVE UTEN-CODSOMER       TO WCOM-CODSOCIE                 
000961     ELSE                                                         
000962        MOVE UTEN-CODSOCOM       TO WCOM-CODSOCIE.                
000963                                                                  
000964* EXEC CICS HANDLE ABEND CANCEL                                   
000965*    END-EXEC.                                                    
000966*    MOVE '..C                   " % #00000852' TO DFHEIV0        
000967     MOVE X'2E2E43202020202020202020' &                           
000968          X'202020202020202020202220' &                           
000969          X'2520233030303030383532' TO DFHEIV0                    
000970     CALL 'kxdfhei1' USING DFHEIV0,                               
000971           DFHEIV99                                               
000972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
000973                                                                  
000974                                                                  
000975* EXEC CICS LINK PROGRAM  ('SCTCOMM')                             
000976*                   COMMAREA (WCOM-AREAXXXX)                      
000977*                   LENGTH   (WCOM-LUNGHEZZ)                      
000978*    END-EXEC.                                                    
000979     MOVE 'SCTCOMM' TO DFHEIV1                                    
000980*    MOVE '."C                   (   #00000854' TO DFHEIV0        
000981     MOVE X'2E2243202020202020202020' &                           
000982          X'202020202020202020202820' &                           
000983          X'2020233030303030383534' TO DFHEIV0                    
000984     CALL 'kxdfhei1' USING DFHEIV0,                               
000985           DFHEIV1,                                               
000986           WCOM-AREAXXXX,                                         
000987           WCOM-LUNGHEZZ,                                         
000988           DFHEIV99,                                              
000989           DFHEIV99,                                              
000990           DFHEIV99,                                              
000991           DFHEIV99                                               
000992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
000993                                                                  
000994                                                                  
000995* EXEC CICS HANDLE ABEND RESET                                    
000996*    END-EXEC.                                                    
000997*    MOVE '..R                   " & #00000858' TO DFHEIV0        
000998     MOVE X'2E2E52202020202020202020' &                           
000999          X'202020202020202020202220' &                           
001000          X'2620233030303030383538' TO DFHEIV0                    
001001     CALL 'kxdfhei1' USING DFHEIV0,                               
001002           DFHEIV99                                               
001003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001004                                                                  
001005*    ----  ----------- GESTIONE AVVISI ---------------  ----      
001006     IF MESS-CODERROR NOT GREATER SPACES                          
001007        IF UTEN-FLAGUTEN NOT GREATER SPACES AND                   
001008           UTEN-FLAGTRAN NOT GREATER SPACES                       
001009           CONTINUE                                               
001010        ELSE                                                      
001011           IF UTEN-FLAGUTEN GREATER SPACES AND                    
001012              UTEN-FLAGTRAN GREATER SPACES                        
001013              MOVE '00887'       TO MESS-CODERROR                 
001014           ELSE                                                   
001015              IF UTEN-FLAGUTEN GREATER SPACES                     
001016                 MOVE '00885'    TO MESS-CODERROR                 
001017              ELSE                                                
001018                 IF UTEN-FLAGTRAN GREATER SPACES                  
001019                    MOVE '00886' TO MESS-CODERROR.                
001020*    ---------------------------------------------- FINE AVVISI   
001021 B10-EX. EXIT.                                                   
001022*---------------------------------------------------------------- 
001023 C00-RICEVI-MAPPA.                                                
001024*---------------------------------------------------------------- 
001025                                                                  
001026* EXEC CICS RECEIVE MAP    (WNOMEMAP)                             
001027*                      MAPSET ('AVMLOGI')                         
001028*                      INTO   (AVILOGII)                          
001029*    END-EXEC.                                                    
001030     MOVE LENGTH OF                                               
001031      AVILOGII                                                    
001032       TO DFHEIV11                                                
001033     MOVE 'AVMLOGI' TO DFHEIV1                                    
001034*    MOVE '8"T I  L              ''   #00000880' TO DFHEIV0       
001035     MOVE X'382254204920204C20202020' &                           
001036          X'202020202020202020202720' &                           
001037          X'2020233030303030383830' TO DFHEIV0                    
001038     CALL 'kxdfhei1' USING DFHEIV0,                               
001039           WNOMEMAP,                                              
001040           AVILOGII,                                              
001041           DFHEIV11,                                              
001042           DFHEIV1,                                               
001043           DFHEIV99,                                              
001044           DFHEIV99                                               
001045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001046                                                                  
001047     MOVE LOW-VALUE              TO LOGI-MESSAGGIO.               
001048     PERFORM C10-CONTROLLA-RICHIESTA                              
001049        THRU C10-EX.                                              
001050     IF NOT ERRORE AND WTRANSID > ' '                             
001051        PERFORM U05-START                                         
001052           THRU U05-EX.                                           
001053 C00-EX. EXIT.                                                    
001054*---------------------------------------------------------------- 
001055 C10-CONTROLLA-RICHIESTA.                                         
001056*---------------------------------------------------------------- 
001057     INSPECT LOGI-CODSOCIEI REPLACING ALL LOW-VALUE BY SPACES.    
001058     MOVE SPACES                 TO LOGI-RAGFATTUO.               
001059     IF LOGI-CODSOCIEI NOT > SPACES                               
001060        MOVE DFHUNIMD            TO LOGI-CODSOCIEA                
001061        MOVE DFHRED              TO LOGI-CODSOCIEC                
001062        MOVE -1                  TO LOGI-CODSOCIEL                
001063        MOVE '00036'             TO MESS-CODERROR                 
001064        MOVE '*'                 TO WSWERROR                      
001065        GO TO C10-EX.                                             
001066     MOVE LOGI-CODSOCIEI         TO A531-CODSOCIE.                
001067     PERFORM L00-SELECT-SOCIETA                                   
001068        THRU L00-EX.                                              
001069     IF SQLCODE = 100                                             
001070        MOVE DFHUNIMD            TO LOGI-CODSOCIEA                
001071        MOVE DFHRED              TO LOGI-CODSOCIEC                
001072        MOVE -1                  TO LOGI-CODSOCIEL                
001073        MOVE '00036'             TO MESS-CODERROR                 
001074        MOVE '*'                 TO WSWERROR                      
001075        GO TO C10-EX.                                             
001076     MOVE A531-NOMSOCIE          TO LOGI-NOMSOCIEO.               
001077     MOVE LOGI-CODSOCIEI         TO WCOM-CODSOCIE.                
001078     MOVE 'A'                    TO WCOM-CDDIVISI.                
001079     IF WCOM-CODSOCIE = '09' OR '24' OR '25'                      
001080        MOVE 'T'                 TO WCOM-CDDIVISI                 
001081     ELSE                                                         
001082        IF WCOM-CODSOCIE = '16'                                   
001083           MOVE 'V'              TO WCOM-CDDIVISI.                
001084     MOVE SPACES                 TO WCOM-FLAGPRGM.                
001085     MOVE SPACES                 TO WTRANSID                      
001086                                    WS-SCELTA.                    
001087     IF LOGI-NRSCELTAI     > SPACES                               
001088        MOVE +2                  TO WLENGTH                       
001089        CALL WWTWSNU USING WLENGTH LOGI-NRSCELTAI.                
001090     IF LOGI-NRSCELTAI NOT EQUAL '10' AND '20' AND '21' AND       
001091                                 '22' AND '30' AND '99' AND       
001092                                 '50' AND '51' AND '98' AND       
001093                                 '11' AND '12' AND '29' AND       
001094                                 '23' AND '60'                    
001095        MOVE DFHUNIMD            TO LOGI-NRSCELTAA                
001096        MOVE DFHRED              TO LOGI-NRSCELTAC                
001097        MOVE -1                  TO LOGI-NRSCELTAL                
001098        MOVE '00176'             TO MESS-CODERROR                 
001099        MOVE '*'                 TO WSWERROR                      
001100        GO TO C10-EX.                                             
001101     IF LOGI-CODSOCIEI NOT = '22'                                 
001102        IF LOGI-NRSCELTAI  = '11' OR '12' OR                      
001103                             '29' OR '30'                         
001104           MOVE DFHUNIMD         TO LOGI-NRSCELTAA                
001105           MOVE DFHRED           TO LOGI-NRSCELTAC                
001106           MOVE -1               TO LOGI-NRSCELTAL                
001107           MOVE '00319'          TO MESS-CODERROR                 
001108           MOVE '*'              TO WSWERROR                      
001109           GO TO C10-EX.                                          
001110     IF LOGI-CODSOCIEI NOT = '22' AND '24'                        
001111        IF LOGI-NRSCELTAI  = '51'                                 
001112           MOVE DFHUNIMD         TO LOGI-NRSCELTAA                
001113           MOVE DFHRED           TO LOGI-NRSCELTAC                
001114           MOVE -1               TO LOGI-NRSCELTAL                
001115           MOVE '00319'          TO MESS-CODERROR                 
001116           MOVE '*'              TO WSWERROR                      
001117           GO TO C10-EX.                                          
001118     IF LOGI-CODSOCIEI = '22' AND                                 
001119        LOGI-NRSCELTAI = '51'                                     
001120        IF WCOM-UTENCICS = 'TB9432' OR                            
001121           WCOM-UTENCICS = 'CC8524' OR                            
001122           WCOM-UTENCICS = 'PP1995'                               
001123           CONTINUE                                               
001124        ELSE                                                      
001125           MOVE DFHUNIMD         TO LOGI-NRSCELTAA                
001126           MOVE DFHRED           TO LOGI-NRSCELTAC                
001127           MOVE -1               TO LOGI-NRSCELTAL                
001128           MOVE '00001'          TO MESS-CODERROR                 
001129           MOVE '*'              TO WSWERROR                      
001130           GO TO C10-EX.                                          
001131     IF LOGI-CODSOCIEI NOT = '24'                                 
001132        IF LOGI-NRSCELTAI  = '60'                                 
001133           MOVE DFHUNIMD         TO LOGI-NRSCELTAA                
001134           MOVE DFHRED           TO LOGI-NRSCELTAC                
001135           MOVE -1               TO LOGI-NRSCELTAL                
001136           MOVE '00319'          TO MESS-CODERROR                 
001137           MOVE '*'              TO WSWERROR                      
001138           GO TO C10-EX.                                          
001139     IF LOGI-NRSCELTAI = '10'                                     
001140        MOVE '*'                 TO WS-SCELTA                     
001141        MOVE 'LO10'              TO WTRANSID.                     
001142     IF NOT ERRORE AND NOT SCELTA                                 
001143        IF LOGI-NRSCELTAI = '11'                                  
001144           MOVE '*'              TO WS-SCELTA                     
001145           MOVE 'LO50'           TO WTRANSID.                     
001146     IF NOT ERRORE AND NOT SCELTA                                 
001147        IF LOGI-NRSCELTAI = '12'                                  
001148           MOVE '*'              TO WS-SCELTA                     
001149           MOVE 'LO60'           TO WTRANSID.                     
001150     IF NOT ERRORE AND NOT SCELTA                                 
001151        IF LOGI-NRSCELTAI = '20'                                  
001152           MOVE '*'              TO WS-SCELTA                     
001153           MOVE 'LO20'           TO WTRANSID.                     
001154     IF NOT ERRORE AND NOT SCELTA                                 
001155        IF LOGI-NRSCELTAI = '21'                                  
001156           MOVE 'V'              TO WCOM-FLAGPRGM                 
001157           MOVE '*'              TO WS-SCELTA                     
001158           MOVE 'LO20'           TO WTRANSID.                     
001159     IF NOT ERRORE AND NOT SCELTA                                 
001160        IF LOGI-NRSCELTAI = '22'                                  
001161           MOVE '*'              TO WS-SCELTA                     
001162           MOVE 'LO22'           TO WTRANSID.                     
001163     IF NOT ERRORE AND NOT SCELTA                                 
001164        IF LOGI-NRSCELTAI = '23'                                  
001165           MOVE '*'              TO WS-SCELTA                     
001166           MOVE 'LO24'           TO WTRANSID.                     
001167     IF NOT ERRORE AND NOT SCELTA                                 
001168        IF LOGI-NRSCELTAI = '29'                                  
001169           PERFORM C12-TRASM-ORDINI-FASHION                       
001170              THRU C12-EX.                                        
001171     IF NOT ERRORE AND NOT SCELTA                                 
001172        IF LOGI-NRSCELTAI = '30'                                  
001173           MOVE '*'              TO WS-SCELTA                     
001174           MOVE 'LO30'           TO WTRANSID.                     
001175     IF NOT ERRORE AND NOT SCELTA                                 
001176        IF LOGI-NRSCELTAI = '50' OR '51'                          
001177*******    IF LOGI-NRSCELTAI = '51'                               
001178*             MOVE 'LOGX'        TO WTRANSID                      
001179*             PERFORM C14-CONTROLLO-ABILITAZIONE                  
001180*                THRU C14-EX                                      
001181*             IF ERRORE                                           
001182*                GO TO C10-EX                                     
001183*             END-IF                                              
001184*******    END-IF                                                 
001185           PERFORM C15-CONTROLLA-FATT                             
001186              THRU C15-EX                                         
001187        ELSE                                                      
001188           MOVE SPACES           TO LOGI-CODCLIENO                
001189                                    LOGI-RAGFATTUO.               
001190     IF NOT ERRORE AND NOT SCELTA                                 
001191        IF LOGI-NRSCELTAI = '60'                                  
001192           MOVE '*'              TO WS-SCELTA                     
001193           MOVE 'LO70'           TO WTRANSID.                     
001194     IF NOT ERRORE AND NOT SCELTA                                 
001195        IF LOGI-NRSCELTAI = '98'                                  
001196           MOVE '*'              TO WS-SCELTA                     
001197           MOVE SPACES           TO WCOM-NOMEPRGM                 
001198           MOVE 'STAM'           TO WTRANSID.                     
001199     IF NOT ERRORE AND NOT SCELTA                                 
001200        IF LOGI-NRSCELTAI = '99'                                  
001201           MOVE '*'              TO WS-SCELTA                     
001202           MOVE SPACES           TO WCOM-NOMEPRGM                 
001203           MOVE SPACE            TO WCOM-RIKIESTA                 
001204           MOVE 'TA05'           TO WTRANSID.                     
001205 C10-EX. EXIT.                                                    
001206*---------------------------------------------------------------- 
001207 C12-TRASM-ORDINI-FASHION.                                        
001208*---------------------------------------------------------------- 
001209     MOVE '*'                    TO WS-SCELTA.                    
001210     MOVE EIBTRNID               TO A839-CODITRAN.                
001211     PERFORM L10-SELECT-TEMPITRANS                                
001212        THRU L10-EX.                                              
001213     IF SQLCODE NOT = +100                                        
001214        MOVE '*'                 TO WSWERROR                      
001215        MOVE '01491'             TO MESS-CODERROR                 
001216        MOVE DFHRED              TO LOGI-NRSCELTAC                
001217        MOVE DFHUNIMD            TO LOGI-NRSCELTAA                
001218        MOVE -1                  TO LOGI-NRSCELTAL.               
001219     IF NOT ERRORE                                                
001220        IF EIBAID EQUAL DFHPF10                                   
001221           PERFORM C30-LANCIA-PROCEDURA                           
001222              THRU C30-EX                                         
001223        ELSE                                                      
001224           MOVE '00030'          TO MESS-CODERROR.                
001225 C12-EX. EXIT.                                                    
001226*---------------------------------------------------------------- 
001227 C14-CONTROLLO-ABILITAZIONE.                                      
001228*---------------------------------------------------------------- 
001229*    MOVE DFHVALUE(NOLOG)        TO WNOLOG.                       
001230*    EXEC CICS QUERY SECURITY                                     
001231*                    RESTYPE    ('TRANSACTION')                   
001232*                    RESID      (WTRANSID)                        
001233*                    LOGMESSAGE (WNOLOG)                          
001234*                    READ       (WCVDA)                           
001235*    END-EXEC.                                                    
001236                                                                  
001237* EXEC CICS ASSIGN                                                
001238*              USERID(WS-USER-ID)                                 
001239*    END-EXEC.                                                    
001240*    MOVE '"(             (      "   #00001073' TO DFHEIV0        
001241     MOVE X'222820202020202020202020' &                           
001242          X'202020282020202020202220' &                           
001243          X'2020233030303031303733' TO DFHEIV0                    
001244     CALL 'kxdfhei1' USING DFHEIV0,                               
001245           WS-USER-ID                                             
001246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001247                                                                  
001248     MOVE WTRANSID               TO WS-TRANS-ID.                  
001249     MOVE SPACES                 TO WS-USER-READABLE.             
001250     CALL "querysec" USING WS-USER-ID WS-TRANS-ID                 
001251                     RETURNING                                    
001252                     INTO RETURN-VALUE.                           
001253**                                                                
001254     EVALUATE RETURN-VALUE                                        
001255        WHEN 88                                                   
001256* 88 IS HEX VALUE FOR 'X'                                         
001257             MOVE 'X'            TO WS-USER-READABLE              
001258        WHEN 32                                                   
001259* 32 IS HEX VALUE FOR SPACE                                       
001260             MOVE SPACES         TO WS-USER-READABLE              
001261     END-EVALUATE.                                                
001262**                                                                
001263*    IF WCVDA = DFHVALUE(NOTREADABLE)                             
001264     IF SUCCESSFUL                                                
001265        IF NOT-AUTHORIZED                                         
001266           MOVE '*'                 TO WSWERROR                   
001267           MOVE '00001'             TO MESS-CODERROR              
001268           MOVE -1                  TO LOGI-NRSCELTAL             
001269        END-IF                                                    
001270     ELSE                                                         
001271        PERFORM Z00-ERRORE                                        
001272           THRU Z00-EX                                            
001273     END-IF.                                                      
001274     MOVE SPACES                 TO WTRANSID.                     
001275 C14-EX. EXIT.                                                    
001276*---------------------------------------------------------------- 
001277 C15-CONTROLLA-FATT.                                              
001278*---------------------------------------------------------------- 
001279     MOVE '*'                    TO WS-SCELTA.                    
001280     MOVE EIBTRNID               TO A839-CODITRAN.                
001281     PERFORM L10-SELECT-TEMPITRANS                                
001282        THRU L10-EX.                                              
001283     IF SQLCODE NOT = +100                                        
001284        MOVE '*'                 TO WSWERROR                      
001285        MOVE '01491'             TO MESS-CODERROR                 
001286        MOVE DFHRED              TO LOGI-NRSCELTAC                
001287        MOVE DFHUNIMD            TO LOGI-NRSCELTAA                
001288        MOVE -1                  TO LOGI-NRSCELTAL                
001289     ELSE                                                         
001290        IF LOGI-CODCLIENI NOT > SPACES                            
001291           MOVE '*'              TO WSWERROR                      
001292           MOVE '00112'          TO MESS-CODERROR                 
001293           MOVE DFHRED           TO LOGI-CODCLIENC                
001294           MOVE DFHUNIMD         TO LOGI-CODCLIENA                
001295           MOVE -1               TO LOGI-CODCLIENL                
001296        ELSE                                                      
001297           MOVE LOGI-CODCLIENI   TO A901-CODCLIEN                 
001298           PERFORM L30-SELECT-CLIENTI                             
001299              THRU L30-EX                                         
001300           IF SQLCODE = +100                                      
001301              MOVE '*'           TO WSWERROR                      
001302              MOVE '00112'       TO MESS-CODERROR                 
001303              MOVE DFHRED        TO LOGI-CODCLIENC                
001304              MOVE DFHUNIMD      TO LOGI-CODCLIENA                
001305              MOVE -1            TO LOGI-CODCLIENL                
001306           ELSE                                                   
001307              MOVE A901-RAGFATTU TO LOGI-RAGFATTUO                
001308              IF EIBAID EQUAL DFHPF10                             
001309                 PERFORM C30-LANCIA-PROCEDURA                     
001310                    THRU C30-EX                                   
001311              ELSE                                                
001312                 MOVE '00030'    TO MESS-CODERROR.                
001313 C15-EX. EXIT.                                                    
001314*---------------------------------------------------------------- 
001315 C30-LANCIA-PROCEDURA.                                            
001316*---------------------------------------------------------------- 
001317     MOVE EIBTRNID               TO JOBS-CODITRAN                 
001318     MOVE SPACES                 TO JOBS-ABBITRAN                 
001319     STRING JOBS-CODITRAN LOGI-NRSCELTAI                          
001320        DELIMITED BY SIZE      INTO JOBS-ABBITRAN                 
001321                                                                  
001322* EXEC CICS HANDLE ABEND CANCEL END-EXEC                          
001323*    MOVE '..C                   " '' #00001149' TO DFHEIV0       
001324     MOVE X'2E2E43202020202020202020' &                           
001325          X'202020202020202020202220' &                           
001326          X'2720233030303031313439' TO DFHEIV0                    
001327     CALL 'kxdfhei1' USING DFHEIV0,                               
001328           DFHEIV99                                               
001329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
001330                                                                  
001331* EXEC CICS LINK PROGRAM  ('WWTJOBS')                             
001332*                   COMMAREA (DCJOBS)                             
001333*                   LENGTH   (JOBS-LUNGHEZZ)                      
001334*                   END-EXEC                                      
001335     MOVE 'WWTJOBS' TO DFHEIV1                                    
001336*    MOVE '."C                   (   #00001150' TO DFHEIV0        
001337     MOVE X'2E2243202020202020202020' &                           
001338          X'202020202020202020202820' &                           
001339          X'2020233030303031313530' TO DFHEIV0                    
001340     CALL 'kxdfhei1' USING DFHEIV0,                               
001341           DFHEIV1,                                               
001342           DCJOBS,                                                
001343           JOBS-LUNGHEZZ,                                         
001344           DFHEIV99,                                              
001345           DFHEIV99,                                              
001346           DFHEIV99,                                              
001347           DFHEIV99                                               
001348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
001349                                                                  
001350* EXEC CICS HANDLE ABEND RESET  END-EXEC                          
001351*    MOVE '..R                   " ( #00001154' TO DFHEIV0        
001352     MOVE X'2E2E52202020202020202020' &                           
001353          X'202020202020202020202220' &                           
001354          X'2820233030303031313534' TO DFHEIV0                    
001355     CALL 'kxdfhei1' USING DFHEIV0,                               
001356           DFHEIV99                                               
001357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
001358     IF JOBS-SQLCODE  NOT EQUAL ZEROS OR                          
001359        JOBS-RETUCODE NOT EQUAL '****'                            
001360        MOVE '*'                 TO WSWERROR                      
001361        MOVE '00711'             TO MESS-CODERROR                 
001362        MOVE DFHRED              TO LOGI-NRSCELTAC                
001363        MOVE DFHUNIMD            TO LOGI-NRSCELTAA                
001364        MOVE -1                  TO LOGI-NRSCELTAL                
001365     ELSE                                                         
001366        MOVE SPACES              TO DCLTTEMPITRANS                
001367        INITIALIZE                  DCLTTEMPITRANS                
001368        MOVE WCOM-UTENCICS       TO A839-CODUTENT                 
001369        MOVE EIBTRNID            TO A839-CODITRAN                 
001370        STRING LOGI-MAPORAXI(1:2)                                 
001371               LOGI-MAPORAXI(4:2)                                 
001372        DELIMITED BY SIZE      INTO A839-INILAVOR                 
001373        MOVE LOGI-NRSCELTAI      TO A839-CODIFUNZ                 
001374        MOVE WCOM-DTCREAZI       TO A839-DTCREAZI                 
001375        MOVE LOGI-CODSOCIEI      TO A839-CODSOCIE                 
001376        MOVE SPACES              TO A839-NOTENOTE                 
001377        IF LOGI-NRSCELTAI = '50' OR '51'                          
001378           MOVE A901-CODSOCIE    TO A839-CODSOCIE                 
001379           IF LOGI-NRSCELTAI = '51'                               
001380              MOVE 'D'           TO A839-NOTENOTE(1:1)            
001381           ELSE                                                   
001382              MOVE 'P'           TO A839-NOTENOTE(1:1)            
001383           END-IF                                                 
001384           MOVE LOGI-CODCLIENI   TO A839-NOTENOTE(3:5)            
001385        END-IF                                                    
001386        PERFORM I00-INSERT-TEMPITRANS                             
001387           THRU I00-EX                                            
001388        MOVE SPACES              TO LOGI-CODCLIENO                
001389        MOVE SPACES              TO LOGI-RAGFATTUO                
001390        MOVE SPACES              TO LOGI-NRSCELTAO.               
001391 C30-EX. EXIT.                                                    
001392*---------------------------------------------------------------- 
001393 D00-FUNZIONI-ESTERNE.                                            
001394*---------------------------------------------------------------- 
001395     MOVE '*'                    TO WCOM-DELETETS.                
001396                                                                  
001397* EXEC CICS LINK PROGRAM  ('WWTTIM15')                            
001398*                   COMMAREA (WCOM-AREAXXXX)                      
001399*                   LENGTH   (WCOM-LUNGHEZZ)                      
001400*    END-EXEC.                                                    
001401     MOVE 'WWTTIM15' TO DFHEIV1                                   
001402*    MOVE '."C                   (   #00001193' TO DFHEIV0        
001403     MOVE X'2E2243202020202020202020' &                           
001404          X'202020202020202020202820' &                           
001405          X'2020233030303031313933' TO DFHEIV0                    
001406     CALL 'kxdfhei1' USING DFHEIV0,                               
001407           DFHEIV1,                                               
001408           WCOM-AREAXXXX,                                         
001409           WCOM-LUNGHEZZ,                                         
001410           DFHEIV99,                                              
001411           DFHEIV99,                                              
001412           DFHEIV99,                                              
001413           DFHEIV99                                               
001414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001415                                                                  
001416     IF WCOM-RETURNXX = '*'                                       
001417                                                                  
001418* EXEC CICS RETURN END-EXEC                                       
001419*    MOVE '.(                    ''   #00001198' TO DFHEIV0       
001420     MOVE X'2E2820202020202020202020' &                           
001421          X'202020202020202020202720' &                           
001422          X'2020233030303031313938' TO DFHEIV0                    
001423     CALL 'kxdfhei1' USING DFHEIV0,                               
001424           DFHEIV99,                                              
001425           DFHEIV99,                                              
001426           DFHEIV99,                                              
001427           DFHEIV99,                                              
001428           DFHEIV99,                                              
001429           DFHEIV99                                               
001430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
001431     ELSE                                                         
001432         PERFORM U00-RETURN-TRAN                                  
001433            THRU U00-EX.                                          
001434 D00-EX. EXIT.                                                    
001435*---------------------------------------------------------------- 
001436 E00-INVIA-MAPPA.                                                 
001437*---------------------------------------------------------------- 
001438     MOVE WCOM-DATAXXXX          TO LOGI-MAPDATAO.                
001439     MOVE EIBTIME                TO LOGI-MAPORAXO.                
001440*    ----------------  GESTIONE AVVISI ---------------------      
001441     IF MESS-CODERROR GREATER SPACES                              
001442        IF MESS-CODERROR = '00885' OR '00886' OR '00887'          
001443           MOVE DFHRED              TO LOGI-MESSAGGIC             
001444           MOVE DFHREVRS            TO LOGI-MESSAGGIH             
001445*    ---------------------------- FINE AVVISI --------------      
001446     MOVE -1                     TO LOGI-NRSCELTAL.               
001447     IF MESS-CODERROR NOT GREATER SPACES                          
001448        MOVE '00003'             TO MESS-CODERROR.                
001449     PERFORM U10-DECOD-MESSAGGI                                   
001450        THRU U10-EX.                                              
001451     PERFORM E10-IMPOSTA-ORE                                      
001452        THRU E10-EX.                                              
001453     IF NOT ERRORE                                                
001454        MOVE -1                  TO LOGI-NRSCELTAL.               
001455     MOVE DFHBMASF               TO LOGI-CODSOCIEA.               
001456     MOVE DFHBLUE                TO LOGI-CODSOCIEC.               
001457                                                                  
001458* EXEC CICS SEND MAPSET    ('AVMLOGI')                            
001459*                   MAP        (WNOMEMAP)                         
001460*                   FROM       (AVILOGIO)                         
001461*                   ERASE                                         
001462*                   CURSOR                                        
001463*    END-EXEC.                                                    
001464     MOVE LENGTH OF                                               
001465      AVILOGIO                                                    
001466       TO DFHEIV12                                                
001467     MOVE -1                                                      
001468       TO DFHEIV11                                                
001469     MOVE 'AVMLOGI' TO DFHEIV1                                    
001470*    MOVE '8$     CT  E      L F ,   #00001225' TO DFHEIV0        
001471     MOVE X'382420202020204354202045' &                           
001472          X'2020202020204C2046202C20' &                           
001473          X'2020233030303031323235' TO DFHEIV0                    
001474     CALL 'kxdfhei1' USING DFHEIV0,                               
001475           WNOMEMAP,                                              
001476           AVILOGIO,                                              
001477           DFHEIV12,                                              
001478           DFHEIV1,                                               
001479           DFHEIV99,                                              
001480           DFHEIV99,                                              
001481           DFHEIV99,                                              
001482           DFHEIV11,                                              
001483           DFHEIV99,                                              
001484           DFHEIV99,                                              
001485           DFHEIV99                                               
001486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001487                                                                  
001488 E00-EX. EXIT.                                                    
001489*----------------------------------------------------------------*
001490 E10-IMPOSTA-ORE.                                                 
001491*----------------------------------------------------------------*
001492     MOVE EIBTRNID                  TO A839-CODITRAN              
001493     MOVE '50'                      TO A839-CODIFUNZ              
001494     PERFORM L20-SELECT-TEMPITRANS                                
001495        THRU L20-EX.                                              
001496     IF SQLCODE = 0                                               
001497        STRING  A839-INILAVOR(1:2)                                
001498                '.'                                               
001499                A839-INILAVOR(3:2)                                
001500                DELIMITED BY SIZE INTO LOGI-ORA50XXXO             
001501     ELSE                                                         
001502        MOVE SPACES                 TO LOGI-ORA50XXXO.            
001503     MOVE '51'                      TO A839-CODIFUNZ              
001504     PERFORM L20-SELECT-TEMPITRANS                                
001505        THRU L20-EX.                                              
001506     IF SQLCODE = 0                                               
001507        STRING  A839-INILAVOR(1:2)                                
001508                '.'                                               
001509                A839-INILAVOR(3:2)                                
001510                DELIMITED BY SIZE INTO LOGI-ORA51XXXO             
001511     ELSE                                                         
001512        MOVE SPACES                 TO LOGI-ORA51XXXO.            
001513     MOVE '29'                      TO A839-CODIFUNZ              
001514     PERFORM L20-SELECT-TEMPITRANS                                
001515        THRU L20-EX.                                              
001516     IF SQLCODE = 0                                               
001517        STRING  A839-INILAVOR(1:2)                                
001518                '.'                                               
001519                A839-INILAVOR(3:2)                                
001520                DELIMITED BY SIZE INTO LOGI-ORA29XXXO             
001521     ELSE                                                         
001522        MOVE SPACES                 TO LOGI-ORA29XXXO.            
001523 E10-EX. EXIT.                                                    
001524*----------------------------------------------------------------*
001525 I00-INSERT-TEMPITRANS.                                           
001526*----------------------------------------------------------------*
001527     MOVE 'INSERT'               TO WCOM-FILEFUNZ.                
001528     MOVE 'TEMPITRANS'           TO WCOM-FILENOME.                
001529     MOVE 'I00-'                 TO WCOM-CODABEND.                
001530     MOVE A839-CODITRAN          TO WCOM-FILECTRL.                
001532     
      *EXEC SQL 
      *INSERT INTO DANAGRAF.TTEMPITRANS                         
001533*                          (CODUTENT,                              
001534*                           CODITRAN,                              
001535*                           CODIFUNZ,                              
001536*                           INILAVOR,                              
001537*                           CODSOCIE,                              
001538*                           CODDEPOS,                              
001539*                           NOTENOTE,                              
001540*                           NOTENOT1,                              
001541*                           DTCREAZI)                              
001542*                VALUES    (:A839-CODUTENT,                        
001543*                           :A839-CODITRAN,                        
001544*                           :A839-CODIFUNZ,                        
001545*                           :A839-INILAVOR,                        
001546*                           :A839-CODSOCIE,                        
001547*                           :A839-CODDEPOS,                        
001548*                           :A839-NOTENOTE,                        
001549*                           :A839-NOTENOT1,                        
001550*                           :A839-DTCREAZI)                        
001551*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 1 TO SQL-STMT-ID 
           MOVE 9 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 6 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A839-CODUTENT
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A839-CODITRAN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 2 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A839-CODIFUNZ
            BY VALUE 0
                     0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 3 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A839-INILAVOR
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 4 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A839-CODSOCIE
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 5 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A839-CODDEPOS
            BY VALUE 0
                     0

           MOVE 60 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 6 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A839-NOTENOTE
            BY VALUE 0
                     0

           MOVE 200 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 7 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A839-NOTENOT1
            BY VALUE 0
                     0

           MOVE 8 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 8 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A839-DTCREAZI
            BY VALUE 0
                     0

           MOVE 0 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 1 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001552 I00-EX. EXIT.                                                    
001553*----------------------------------------------------------------*
001554 L00-SELECT-SOCIETA.                                              
001555*----------------------------------------------------------------*
001556     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001557     MOVE 'SOCIETA'              TO WCOM-FILENOME.                
001558     MOVE 'L00-'                 TO WCOM-CODABEND.                
001559     MOVE A531-CODSOCIE          TO WCOM-FILECTRL.                
001560     MOVE SPACES                 TO A531-NOMSOCIE.                
001562     
      *EXEC SQL 
      *SELECT NOMSOCIE                                         
001563*            INTO :A531-NOMSOCIE                                   
001564*            FROM DANAGRAF.TSOCIETA                                
001565*           WHERE CODSOCIE = :A531-CODSOCIE                        
001566*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 2 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-CODSOCIE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 23 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A531-NOMSOCIE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 2 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001567 L00-EX. EXIT.                                                    
001568*----------------------------------------------------------------*
001569 L10-SELECT-TEMPITRANS.                                           
001570*----------------------------------------------------------------*
001571     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001572     MOVE 'TEMPITRANS'           TO WCOM-FILENOME.                
001573     MOVE 'L10-'                 TO WCOM-CODABEND.                
001574     MOVE A839-CODITRAN          TO WCOM-FILECTRL.                
001576     
      *EXEC SQL 
      *SELECT INILAVOR                                         
001577*            INTO :A839-INILAVOR                                   
001578*            FROM DANAGRAF.TTEMPITRANS                             
001579*           WHERE CODITRAN = :A839-CODITRAN                        
001580*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 4 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A839-CODITRAN
            BY VALUE 0
                     0

           MOVE 5 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A839-INILAVOR
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 3 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001581 L10-EX. EXIT.                                                    
001582*----------------------------------------------------------------*
001583 L20-SELECT-TEMPITRANS.                                           
001584*----------------------------------------------------------------*
001585     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001586     MOVE 'TEMPITRANS'           TO WCOM-FILENOME.                
001587     MOVE 'L20-'                 TO WCOM-CODABEND.                
001588     MOVE SPACES                 TO WCOM-FILECTRL.                
001589     STRING A839-CODITRAN ' ' A839-CODIFUNZ                       
001590        DELIMITED BY SIZE      INTO WCOM-FILECTRL.                
001592     
      *EXEC SQL 
      *SELECT INILAVOR                                         
001593*            INTO :A839-INILAVOR                                   
001594*            FROM DANAGRAF.TTEMPITRANS                             
001595*           WHERE CODITRAN = :A839-CODITRAN                        
001596*             AND CODIFUNZ = :A839-CODIFUNZ                        
001597*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 6 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A839-CODITRAN
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A839-CODIFUNZ
            BY VALUE 0
                     0

           MOVE 7 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 4 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A839-INILAVOR
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 4 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001598 L20-EX. EXIT.                                                    
001599*----------------------------------------------------------------*
001600 L30-SELECT-CLIENTI.                                              
001601*----------------------------------------------------------------*
001602     MOVE 'SELECT'               TO WCOM-FILEFUNZ.                
001603     MOVE 'CLIENTI'              TO WCOM-FILENOME.                
001604     MOVE 'L30-'                 TO WCOM-CODABEND.                
001605     MOVE A901-CODCLIEN          TO WCOM-FILECTRL.                
001607     
      *EXEC SQL 
      *SELECT RAGFATTU, CODSOCIE                               
001608*            INTO :A901-RAGFATTU, :A901-CODSOCIE                   
001609*            FROM DANAGRAF.TCLIENTI                                
001610*           WHERE CODCLIEN = :A901-CODCLIEN                        
001611*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 8 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODCLIEN
            BY VALUE 0
                     0

           MOVE 9 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 24 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-RAGFATTU
            BY VALUE 0
                     0

           MOVE 2 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A901-CODSOCIE
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 5 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
001612 L30-EX. EXIT.                                                    
001613*--------------------------------------------------------------   
001614 U00-RETURN-TRAN.                                                 
001615*--------------------------------------------------------------   
001616                                                                  
001617* EXEC CICS RETURN TRANSID  (EIBTRNID)                            
001618*                     COMMAREA (WCOM-AREAXXXX)                    
001619*                     LENGTH   (WCOM-LUNGHEZZ)                    
001620*    END-EXEC.                                                    
001621*    MOVE '.(CT                  ''   #00001359' TO DFHEIV0       
001622     MOVE X'2E2843542020202020202020' &                           
001623          X'202020202020202020202720' &                           
001624          X'2020233030303031333539' TO DFHEIV0                    
001625     CALL 'kxdfhei1' USING DFHEIV0,                               
001626           EIBTRNID,                                              
001627           WCOM-AREAXXXX,                                         
001628           WCOM-LUNGHEZZ,                                         
001629           DFHEIV99,                                              
001630           DFHEIV99,                                              
001631           DFHEIV99                                               
001632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001633                                                                  
001634 U00-EX. EXIT.                                                  
001635*--------------------------------------------------------------   
001636 U05-START.                                                       
001637*--------------------------------------------------------------   
001638                                                                  
001639* EXEC CICS START   TRANSID (WTRANSID)                            
001640*                      FROM    (WCOM-AREAXXXX)                    
001641*                      LENGTH  (WCOM-LUNGHEZZ)                    
001642*                      TERMID  (EIBTRMID)                         
001643*    END-EXEC.                                                    
001644*    MOVE '0( LFT                1   #00001367' TO DFHEIV0        
001645     MOVE X'3028204C4654202020202020' &                           
001646          X'202020202020202020203120' &                           
001647          X'2020233030303031333637' TO DFHEIV0                    
001648     CALL 'kxdfhei1' USING DFHEIV0,                               
001649           DFHEIV99,                                              
001650           WTRANSID,                                              
001651           DFHEIV99,                                              
001652           WCOM-AREAXXXX,                                         
001653           WCOM-LUNGHEZZ,                                         
001654           EIBTRMID,                                              
001655           DFHEIV99,                                              
001656           DFHEIV99,                                              
001657           DFHEIV99,                                              
001658           DFHEIV99,                                              
001659           DFHEIV99,                                              
001660           DFHEIV99,                                              
001661           DFHEIV99,                                              
001662           DFHEIV99,                                              
001663           DFHEIV99,                                              
001664           DFHEIV99                                               
001665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001666                                                                  
001667                                                                  
001668* EXEC CICS RETURN  END-EXEC.                                     
001669*    MOVE '.(                    ''   #00001372' TO DFHEIV0       
001670     MOVE X'2E2820202020202020202020' &                           
001671          X'202020202020202020202720' &                           
001672          X'2020233030303031333732' TO DFHEIV0                    
001673     CALL 'kxdfhei1' USING DFHEIV0,                               
001674           DFHEIV99,                                              
001675           DFHEIV99,                                              
001676           DFHEIV99,                                              
001677           DFHEIV99,                                              
001678           DFHEIV99,                                              
001679           DFHEIV99                                               
001680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001681                                                                  
001682 U05-EX. EXIT.                                                  
001683*---------------------------------------------------------------- 
001684 U10-DECOD-MESSAGGI.                                              
001685*---------------------------------------------------------------- 
001686     MOVE WCOM-CODILING          TO MESS-CODILING.                
001689*    EXEC SQL                                                     
      *         INCLUDE SRMESS                                          
      *    END-EXEC.                                                    
      *>>((file: SRMESS))
000001*-------------------------------------------------- SRMESS START* 
000002*-  AUTHOR: FEBBRAIOLA DOMENICO & GIUSEPPE RASPINO              * 
000003*---------------------------------------------------------------* 
000004*                                                               * 
000005*  SUBROUTINE PER LA RICERCA DEI MESSAGGI IN LINGUA             * 
000006*                                                               * 
000007*  N.B.  INSERIRE IN WORKING STORAGE :                          * 
000008*            EXEC SQL INCLUDE FDANA846 END-EXEC.                * 
000009*            COPY  DCMESS                                       * 
000010*                                                               * 
000011*  N.B.  IMPOSTARE DATI IN :                                    * 
000012*            MESS-CODERROR                                      * 
000013*            MESS-CODILING                                      * 
000014*                                                               * 
000015***************************************************************** 
000016                                                                  
000017     MOVE 'SELECT'             TO WCOM-FILEFUNZ                   
000018     MOVE 'FDANA846'           TO WCOM-FILENOME                   
000019     MOVE 'SRME'               TO WCOM-CODABEND                   
000020     MOVE MESS-CODERROR        TO WCOM-FILECTRL                   
000021                                                                  
000022     MOVE SPACES               TO MESS-CAMPI-OUTPUT.              
000023     MOVE MESS-CODERROR        TO A846-CODERROR.                  
000024     MOVE MESS-CODILING        TO A846-CODILING.                  
000025                                                                  
000027     
      *EXEC SQL 
      *SELECT MSGERROR                                         
000028*          INTO  :A846-MSGERROR                                    
000029*          FROM   DANAGRAF.TMESSAGGI                               
000030*          WHERE  CODERROR = :A846-CODERROR AND                    
000031*                 CODILING = :A846-CODILING                        
000032*     END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 10 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODERROR
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODILING
            BY VALUE 0
                     0

           MOVE 11 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 60 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-MSGERROR
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 6 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                   .                                                    
000033                                                                  
000034     IF SQLCODE NOT EQUAL ZEROS AND                               
000035        SQLCODE NOT EQUAL +100                                    
000036        PERFORM Z00-ERRORE                                        
000037           THRU Z00-EX                                            
000038     ELSE                                                         
000039        IF SQLCODE EQUAL ZEROS                                    
000040           MOVE MESS-CODERROR    TO MESS-COMCODER                 
000041           MOVE A846-MSGERROR    TO MESS-MESSAGGI                 
000042        ELSE                                                      
000043           MOVE '99999'          TO A846-CODERROR                 
000044           MOVE MESS-CODILING    TO A846-CODILING                 
000046           
      *EXEC SQL 
      *SELECT MSGERROR                                   
000047*                INTO  :A846-MSGERROR                              
000048*                FROM   DANAGRAF.TMESSAGGI                         
000049*                WHERE  CODERROR = :A846-CODERROR AND              
000050*                       CODILING = :A846-CODILING                  
000051*           END-EXEC
           CALL "sqlgstrt" USING
              BY CONTENT SQLA-PROGRAM-ID
              BY VALUE 0
              BY REFERENCE SQLCA

           MOVE 12 TO SQL-STMT-ID 
           MOVE 2 TO SQLDSIZE 
           MOVE 2 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 5 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODERROR
            BY VALUE 0
                     0

           MOVE 1 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 1 TO SQLVAR-INDEX
           MOVE 2 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-CODILING
            BY VALUE 0
                     0

           MOVE 13 TO SQL-STMT-ID 
           MOVE 1 TO SQLDSIZE 
           MOVE 3 TO SQLDA-ID 

           CALL "sqlgaloc" USING
               BY VALUE SQLDA-ID 
                        SQLDSIZE
                        SQL-STMT-ID
                        0

           MOVE 60 TO SQL-HOST-VAR-LENGTH
           MOVE 452 TO SQL-DATA-TYPE
           MOVE 0 TO SQLVAR-INDEX
           MOVE 3 TO SQLDA-ID

           CALL "sqlgstlv" USING 
            BY VALUE SQLDA-ID
                     SQLVAR-INDEX
                     SQL-DATA-TYPE
                     SQL-HOST-VAR-LENGTH
            BY REFERENCE A846-MSGERROR
            BY VALUE 0
                     0

           MOVE 3 TO SQL-OUTPUT-SQLDA-ID 
           MOVE 2 TO SQL-INPUT-SQLDA-ID 
           MOVE 7 TO SQL-SECTIONUMBER 
           MOVE 24 TO SQL-CALL-TYPE 

           CALL "sqlgcall" USING
            BY VALUE SQL-CALL-TYPE 
                     SQL-SECTIONUMBER
                     SQL-INPUT-SQLDA-ID
                     SQL-OUTPUT-SQLDA-ID
                     0
             IF SQLCODE IN SQLCA < 0 THEN
               CALL "sqlgstop" USING
                 BY VALUE 0
               GO TO Z00-ERRORE
             END-IF 

           CALL "sqlgstop" USING
            BY VALUE 0
                                                                        
000052           IF SQLCODE EQUAL ZEROS                                 
000053              MOVE MESS-CODERROR TO MESS-COMCODER                 
000054              MOVE A846-MSGERROR TO MESS-MESSAGGI                 
000055           ELSE                                                   
000056              IF SQLCODE = 100                                    
000057                 MOVE MESS-CODERROR   TO MESS-COMCODER            
000058                 MOVE '*** MESSAGGIO  NON  TROVATO ****'          
000059                                      TO MESS-MESSAGGI            
000060              ELSE                                                
000061                 PERFORM Z00-ERRORE                               
000062                     THRU Z00-EX.                                 
000063                                                                  
000064*------------------------------------------------- SRMESS    END* 
      *<<((file: SRMESS))
001690     MOVE MESS-MSGERROR          TO LOGI-MESSAGGIO.               
001691 U10-EX. EXIT.                                                   
001692*-----------------------------------------------------------------
001693 V00-CANCELLO-CODE-RICICLO.                                       
001694*-----------------------------------------------------------------
001695     MOVE EIBTRMID               TO TSTR-NOMETERM.                
001696     MOVE 'LO10'                 TO TSTR-NOMETRAN.                
001697                                                                  
001698* EXEC CICS DELETEQ TS QUEUE     (TSTR-NOMECODA)                  
001699*                         NOHANDLE                                
001700*    END-EXEC                                                     
001701*    MOVE '*&                    #  N#00001388' TO DFHEIV0        
001702     MOVE X'2A2620202020202020202020' &                           
001703          X'202020202020202020202320' &                           
001704          X'204E233030303031333838' TO DFHEIV0                    
001705     CALL 'kxdfhei1' USING DFHEIV0,                               
001706           TSTR-NOMECODA,                                         
001707           DFHEIV99                                               
001708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
001709     MOVE 'LO20'                 TO TSTR-NOMETRAN.                
001710                                                                  
001711* EXEC CICS DELETEQ TS QUEUE     (TSTR-NOMECODA)                  
001712*                         NOHANDLE                                
001713*    END-EXEC                                                     
001714*    MOVE '*&                    #  N#00001392' TO DFHEIV0        
001715     MOVE X'2A2620202020202020202020' &                           
001716          X'202020202020202020202320' &                           
001717          X'204E233030303031333932' TO DFHEIV0                    
001718     CALL 'kxdfhei1' USING DFHEIV0,                               
001719           TSTR-NOMECODA,                                         
001720           DFHEIV99                                               
001721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
001722     MOVE 'LO22'                 TO TSTR-NOMETRAN.                
001723                                                                  
001724* EXEC CICS DELETEQ TS QUEUE     (TSTR-NOMECODA)                  
001725*                         NOHANDLE                                
001726*    END-EXEC                                                     
001727*    MOVE '*&                    #  N#00001396' TO DFHEIV0        
001728     MOVE X'2A2620202020202020202020' &                           
001729          X'202020202020202020202320' &                           
001730          X'204E233030303031333936' TO DFHEIV0                    
001731     CALL 'kxdfhei1' USING DFHEIV0,                               
001732           TSTR-NOMECODA,                                         
001733           DFHEIV99                                               
001734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
001735     MOVE 'LO20'                 TO TSTR-NOMETRAN.                
001736                                                                  
001737* EXEC CICS DELETEQ TS QUEUE     (TSTR-NOMECODA)                  
001738*                         NOHANDLE                                
001739*    END-EXEC                                                     
001740*    MOVE '*&                    #  N#00001400' TO DFHEIV0        
001741     MOVE X'2A2620202020202020202020' &                           
001742          X'202020202020202020202320' &                           
001743          X'204E233030303031343030' TO DFHEIV0                    
001744     CALL 'kxdfhei1' USING DFHEIV0,                               
001745           TSTR-NOMECODA,                                         
001746           DFHEIV99                                               
001747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK                     
001748     MOVE EIBTRMID               TO WPAGVIDE.                     
001749     MOVE 'LO10'                 TO WPAGNOME.                     
001750                                                                  
001751* EXEC CICS DELETEQ TS QUEUE  (WPAGCTRL)                          
001752*                         NOHANDLE                                
001753*    END-EXEC.                                                    
001754*    MOVE '*&                    #  N#00001405' TO DFHEIV0        
001755     MOVE X'2A2620202020202020202020' &                           
001756          X'202020202020202020202320' &                           
001757          X'204E233030303031343035' TO DFHEIV0                    
001758     CALL 'kxdfhei1' USING DFHEIV0,                               
001759           WPAGCTRL,                                              
001760           DFHEIV99                                               
001761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001762                                                                  
001763     MOVE 'LO20'                 TO WPAGNOME.                     
001764                                                                  
001765* EXEC CICS DELETEQ TS QUEUE  (WPAGCTRL)                          
001766*                         NOHANDLE                                
001767*    END-EXEC.                                                    
001768*    MOVE '*&                    #  N#00001409' TO DFHEIV0        
001769     MOVE X'2A2620202020202020202020' &                           
001770          X'202020202020202020202320' &                           
001771          X'204E233030303031343039' TO DFHEIV0                    
001772     CALL 'kxdfhei1' USING DFHEIV0,                               
001773           WPAGCTRL,                                              
001774           DFHEIV99                                               
001775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001776                                                                  
001777     MOVE 'LO24'                 TO WPAGNOME.                     
001778                                                                  
001779* EXEC CICS DELETEQ TS QUEUE  (WPAGCTRL)                          
001780*                         NOHANDLE                                
001781*    END-EXEC.                                                    
001782*    MOVE '*&                    #  N#00001413' TO DFHEIV0        
001783     MOVE X'2A2620202020202020202020' &                           
001784          X'202020202020202020202320' &                           
001785          X'204E233030303031343133' TO DFHEIV0                    
001786     CALL 'kxdfhei1' USING DFHEIV0,                               
001787           WPAGCTRL,                                              
001788           DFHEIV99                                               
001789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001790                                                                  
001791     MOVE 'LO30'                 TO WPAGNOME.                     
001792                                                                  
001793* EXEC CICS DELETEQ TS QUEUE  (WPAGCTRL)                          
001794*                         NOHANDLE                                
001795*    END-EXEC.                                                    
001796*    MOVE '*&                    #  N#00001417' TO DFHEIV0        
001797     MOVE X'2A2620202020202020202020' &                           
001798          X'202020202020202020202320' &                           
001799          X'204E233030303031343137' TO DFHEIV0                    
001800     CALL 'kxdfhei1' USING DFHEIV0,                               
001801           WPAGCTRL,                                              
001802           DFHEIV99                                               
001803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001804                                                                  
001805     MOVE 'LO40'                 TO WPAGNOME.                     
001806                                                                  
001807* EXEC CICS DELETEQ TS QUEUE  (WPAGCTRL)                          
001808*                         NOHANDLE                                
001809*    END-EXEC.                                                    
001810*    MOVE '*&                    #  N#00001421' TO DFHEIV0        
001811     MOVE X'2A2620202020202020202020' &                           
001812          X'202020202020202020202320' &                           
001813          X'204E233030303031343231' TO DFHEIV0                    
001814     CALL 'kxdfhei1' USING DFHEIV0,                               
001815           WPAGCTRL,                                              
001816           DFHEIV99                                               
001817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001818                                                                  
001819     MOVE 'LO50'                 TO WPAGNOME.                     
001820                                                                  
001821* EXEC CICS DELETEQ TS QUEUE  (WPAGCTRL)                          
001822*                         NOHANDLE                                
001823*    END-EXEC.                                                    
001824*    MOVE '*&                    #  N#00001425' TO DFHEIV0        
001825     MOVE X'2A2620202020202020202020' &                           
001826          X'202020202020202020202320' &                           
001827          X'204E233030303031343235' TO DFHEIV0                    
001828     CALL 'kxdfhei1' USING DFHEIV0,                               
001829           WPAGCTRL,                                              
001830           DFHEIV99                                               
001831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001832                                                                  
001833     MOVE 'LO60'                 TO WPAGNOME.                     
001834                                                                  
001835* EXEC CICS DELETEQ TS QUEUE  (WPAGCTRL)                          
001836*                         NOHANDLE                                
001837*    END-EXEC.                                                    
001838*    MOVE '*&                    #  N#00001429' TO DFHEIV0        
001839     MOVE X'2A2620202020202020202020' &                           
001840          X'202020202020202020202320' &                           
001841          X'204E233030303031343239' TO DFHEIV0                    
001842     CALL 'kxdfhei1' USING DFHEIV0,                               
001843           WPAGCTRL,                                              
001844           DFHEIV99                                               
001845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001846                                                                  
001847     MOVE 'LO70'                 TO WPAGNOME.                     
001848                                                                  
001849* EXEC CICS DELETEQ TS QUEUE  (WPAGCTRL)                          
001850*                         NOHANDLE                                
001851*    END-EXEC.                                                    
001852*    MOVE '*&                    #  N#00001433' TO DFHEIV0        
001853     MOVE X'2A2620202020202020202020' &                           
001854          X'202020202020202020202320' &                           
001855          X'204E233030303031343333' TO DFHEIV0                    
001856     CALL 'kxdfhei1' USING DFHEIV0,                               
001857           WPAGCTRL,                                              
001858           DFHEIV99                                               
001859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001860                                                                  
001861     MOVE 'SERV'                 TO WPAGNOME.                     
001862                                                                  
001863* EXEC CICS DELETEQ TS QUEUE  (WPAGCTRL)                          
001864*                         NOHANDLE                                
001865*    END-EXEC.                                                    
001866*    MOVE '*&                    #  N#00001437' TO DFHEIV0        
001867     MOVE X'2A2620202020202020202020' &                           
001868          X'202020202020202020202320' &                           
001869          X'204E233030303031343337' TO DFHEIV0                    
001870     CALL 'kxdfhei1' USING DFHEIV0,                               
001871           WPAGCTRL,                                              
001872           DFHEIV99                                               
001873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001874                                                                  
001875     MOVE 'LOLI'                 TO WPAGNOME.                     
001876                                                                  
001877* EXEC CICS DELETEQ TS QUEUE  (WPAGCTRL)                          
001878*                         NOHANDLE                                
001879*    END-EXEC.                                                    
001880*    MOVE '*&                    #  N#00001441' TO DFHEIV0        
001881     MOVE X'2A2620202020202020202020' &                           
001882          X'202020202020202020202320' &                           
001883          X'204E233030303031343431' TO DFHEIV0                    
001884     CALL 'kxdfhei1' USING DFHEIV0,                               
001885           WPAGCTRL,                                              
001886           DFHEIV99                                               
001887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001888                                                                  
001889     MOVE 'LOOR'                 TO WPAGNOME.                     
001890                                                                  
001891* EXEC CICS DELETEQ TS QUEUE  (WPAGCTRL)                          
001892*                         NOHANDLE                                
001893*    END-EXEC.                                                    
001894*    MOVE '*&                    #  N#00001445' TO DFHEIV0        
001895     MOVE X'2A2620202020202020202020' &                           
001896          X'202020202020202020202320' &                           
001897          X'204E233030303031343435' TO DFHEIV0                    
001898     CALL 'kxdfhei1' USING DFHEIV0,                               
001899           WPAGCTRL,                                              
001900           DFHEIV99                                               
001901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001902                                                                  
001903     MOVE 'ORDI'                 TO WPAGNOME.                     
001904                                                                  
001905* EXEC CICS DELETEQ TS QUEUE  (WPAGCTRL)                          
001906*                         NOHANDLE                                
001907*    END-EXEC.                                                    
001908*    MOVE '*&                    #  N#00001449' TO DFHEIV0        
001909     MOVE X'2A2620202020202020202020' &                           
001910          X'202020202020202020202320' &                           
001911          X'204E233030303031343439' TO DFHEIV0                    
001912     CALL 'kxdfhei1' USING DFHEIV0,                               
001913           WPAGCTRL,                                              
001914           DFHEIV99                                               
001915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001916                                                                  
001917 V00-EX. EXIT.                                                    
001918*---------------------------------------------------------------- 
001919*COPY DCPERDB2.                                                   
001920*SRERCICS/P---------S = SOURCE / P = PRECOMPILED ----------------*
001921*----*  ROUTINE INTERCETTA ERRORE CICS                      *----*
001922*----*                                                      *----*
001923*----------------------------------------------------------------*
001924*       QUESTA ROUTINE E' LA PRIMA DA DICHIARARE COME COPY        
001925*----*                                                      *----*
001926*----------------------------------------------------------------*
001927*    ES.    **                                                    
001928*    ES.         COPY SRERCICP.                                   
001929*    ES.    **   SE VOGLIO INTERCETTARE ERRORE DB2                
001930*    ES.         COPY SRERDB2P                                    
001931*    ES.    **   SE VOGLIO INTERCETTARE ERRORE TOTAL              
001932*    ES.         COPY SRERDB2P                                    
001933*    ES.    **  ETC.                                              
001934*    ES.                                                          
001935*    ES.    **   ULTIMA ROUTINE CHE RILASCIA TR-ERRE  PER DECODI  
001936*    ES.    **   ERRORE                                           
001937*    ES.         COPY SRERENDS                                    
001938*                                                                 
001939*----------------------------------------------------------------*
001940 Z00-ERRORE.                                                      
001941*----------------------------------------------------------------*
001942     MOVE DFHEIV0                TO T-COMLINE.                    
001943     PERFORM                                                      
001944        VARYING INDERR FROM 1 BY 1                                
001945            UNTIL INDERR GREATER 25                               
001946               OR EL-COMLINE (INDERR) EQUAL ZERO                  
001947     END-PERFORM.                                                 
001948     MOVE SPACES                 TO WLINEAXX.                     
001949     IF INDERR LESS 26                                            
001950        MOVE EL-COMLINE (INDERR) TO EL-LINE (1)                   
001951        ADD 1                    TO INDERR                        
001952        MOVE EL-COMLINE (INDERR) TO EL-LINE (2)                   
001953        ADD 1                    TO INDERR                        
001954        MOVE EL-COMLINE (INDERR) TO EL-LINE (3)                   
001955        ADD 1                    TO INDERR                        
001956        MOVE EL-COMLINE (INDERR) TO EL-LINE (4)                   
001957        ADD 1                    TO INDERR                        
001958        MOVE EL-COMLINE (INDERR) TO EL-LINE (5).                  
001959     MOVE WLINEAXX               TO WCOM-PRGMLINE.                
001960     MOVE EIBFN                  TO WCOM-CODEIBFN.                
001961     MOVE EIBRCODE               TO WCOM-CODERCOD.                
001962     MOVE SPACES                 TO WCOM-ABENCICS.                
001963     IF EIBRESP  NOT = ZERO OR                                    
001964        EIBRESP2 NOT = ZERO                                       
001965                                                                  
001966* EXEC CICS                                                       
001967*      ASSIGN ABCODE (WCOM-ABENCICS)                              
001968*END-EXEC.                                                        
001969*    MOVE '"((                   "   #00001500' TO DFHEIV0        
001970     MOVE X'222828202020202020202020' &                           
001971          X'202020202020202020202220' &                           
001972          X'2020233030303031353030' TO DFHEIV0                    
001973     CALL 'kxdfhei1' USING DFHEIV0,                               
001974           WCOM-ABENCICS                                          
001975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
001976                                                                  
001977*       CALL 'DFHEI1' USING DFHEIV0  WCOM-ABENCICS.               
001978*SRERDB2S/P -----------------------------------------------------*
001979*----*  ROUTINE INTERCETTA ERRORE DB2                       *----*
001980*----*                                                      *----*
001981*----------------------------------------------------------------*
001982*       QUESTA ROUTINE E' DA DICHIARARE DOPO LA SRERCICS          
001983*                                                                 
001984     MOVE 'ABEN'                 TO WCOM-CODATSX1.                
001985     MOVE EIBTRMID               TO WCOM-CODATSX2.                
001986*    MOVE LENGTH OF SQLCA        TO WCOM-LUNGHERR.                
001987     MOVE 136                    TO WCOM-LUNGHERR.                
001988                                                                  
001989* EXEC CICS WRITEQ TS    QUEUE  (WCOM-CODATSXX)                   
001990*                       FROM   (SQLCA)                            
001991*                       LENGTH (WCOM-LUNGHERR)                    
001992*END-EXEC.                                                        
001993*    MOVE '*"     L              ''   #00001514' TO DFHEIV0       
001994     MOVE X'2A2220202020204C20202020' &                           
001995          X'202020202020202020202720' &                           
001996          X'2020233030303031353134' TO DFHEIV0                    
001997     CALL 'kxdfhei1' USING DFHEIV0,                               
001998           WCOM-CODATSXX,                                         
001999           SQLCA,                                                 
002000           WCOM-LUNGHERR,                                         
002001           DFHEIV99,                                              
002002           DFHEIV99,                                              
002003           DFHEIV99                                               
002004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002005                                                                  
002006*    CALL 'DFHEI1' USING DFHEIV0  WCOM-CODATSXX SQLCA             
002007*    WCOM-LUNGHERR.                                               
002008*SRERENDS/P------------------------------------------------------*
002009*----*  ROUTINE FINALE                                      *----*
002010*----*                                                      *----*
002011*----------------------------------------------------------------*
002012*       QUESTA ROUTINE DA DICHIARARE PER ULTIMA NELLA SEQUNZA     
002013*       DELLE COPY  PER INTERCETTARE L'ERRORE                     
002014*----------------------------------------------------------------*
002015*----------------------------------------------------------------*
002016      MOVE EIBTRNID              TO WCOM-TRANSAZI.                
002017                                                                  
002018* EXEC CICS SYNCPOINT ROLLBACK                                    
002019*END-EXEC.                                                        
002020*    MOVE '6"R                   !   #00001529' TO DFHEIV0        
002021     MOVE X'362252202020202020202020' &                           
002022          X'202020202020202020202120' &                           
002023          X'2020233030303031353239' TO DFHEIV0                    
002024     CALL 'kxdfhei1' USING DFHEIV0                                
002025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002026                                                                  
002027*     CALL 'DFHEI1' USING DFHEIV0.                                
002028                                                                  
002029* EXEC CICS ASSIGN SYSID (WCOM-SYSID)                             
002030*END-EXEC.                                                        
002031*    MOVE '"(         $          "   #00001532' TO DFHEIV0        
002032     MOVE X'222820202020202020202024' &                           
002033          X'202020202020202020202220' &                           
002034          X'2020233030303031353332' TO DFHEIV0                    
002035     CALL 'kxdfhei1' USING DFHEIV0,                               
002036           WCOM-SYSID                                             
002037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002038                                                                  
002039*     CALL 'DFHEI1' USING DFHEIV0  WCOM-SYSID.                    
002040      MOVE 'ABEN'                    TO WCOM-CODATSX1.            
002041      MOVE EIBTRMID                  TO WCOM-CODATSX2.            
002042*     MOVE LENGTH OF WCOM-AREA-ERROR TO WCOM-LUNGHERR.            
002043      MOVE 200                       TO WCOM-LUNGHERR.            
002044*EXEC CICS WRITEQ TS QUEUE  (WCOM-CODATSXX)                       
002045                                                                  
002046* EXEC CICS WRITEQ TS                                             
002047*                    QUEUE  (WCOM-CODATSXX)                       
002048*                    FROM   (WCOM-AREA-ERROR)                     
002049*                    LENGTH (WCOM-LUNGHERR)                       
002050*END-EXEC.                                                        
002051*    MOVE '*"     L              ''   #00001540' TO DFHEIV0       
002052     MOVE X'2A2220202020204C20202020' &                           
002053          X'202020202020202020202720' &                           
002054          X'2020233030303031353430' TO DFHEIV0                    
002055     CALL 'kxdfhei1' USING DFHEIV0,                               
002056           WCOM-CODATSXX,                                         
002057           WCOM-AREA-ERROR,                                       
002058           WCOM-LUNGHERR,                                         
002059           DFHEIV99,                                              
002060           DFHEIV99,                                              
002061           DFHEIV99                                               
002062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002063                                                                  
002064*     CALL 'DFHEI1' USING DFHEIV0  WCOM-CODATSXX WCOM-AREA-ERROR  
002065*    WCOM-LUNGHERR.                                               
002066                                                                  
002067* EXEC CICS START TRANSID ('ERRE')                                
002068*                FROM    (WCOM-AREAXXXX)                          
002069*                LENGTH  (WCOM-LUNGHEZZ)                          
002070*                TERMID  (EIBTRMID)                               
002071*END-EXEC.                                                        
002072     MOVE 'ERRE' TO DFHEIV5                                       
002073*    MOVE '0( LFT                1   #00001547' TO DFHEIV0        
002074     MOVE X'3028204C4654202020202020' &                           
002075          X'202020202020202020203120' &                           
002076          X'2020233030303031353437' TO DFHEIV0                    
002077     CALL 'kxdfhei1' USING DFHEIV0,                               
002078           DFHEIV99,                                              
002079           DFHEIV5,                                               
002080           DFHEIV99,                                              
002081           WCOM-AREAXXXX,                                         
002082           WCOM-LUNGHEZZ,                                         
002083           EIBTRMID,                                              
002084           DFHEIV99,                                              
002085           DFHEIV99,                                              
002086           DFHEIV99,                                              
002087           DFHEIV99,                                              
002088           DFHEIV99,                                              
002089           DFHEIV99,                                              
002090           DFHEIV99,                                              
002091           DFHEIV99,                                              
002092           DFHEIV99,                                              
002093           DFHEIV99                                               
002094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002095                                                                  
002096*      MOVE 'ERRE' TO DFHC0040                                    
002097*     CALL 'DFHEI1' USING DFHEIV0  DFHEID0 DFHDUMMY DFHC0040      
002098*    WCOM-AREAXXXX WCOM-LUNGHEZZ EIBTRMID.                        
002099                                                                  
002100* EXEC CICS ABEND ABCODE (WCOM-ABENCICS)                          
002101*                CANCEL                                           
002102*END-EXEC.                                                        
002103*    MOVE '.,AC                  "   #00001555' TO DFHEIV0        
002104     MOVE X'2E2C41432020202020202020' &                           
002105          X'202020202020202020202220' &                           
002106          X'2020233030303031353535' TO DFHEIV0                    
002107     CALL 'kxdfhei1' USING DFHEIV0,                               
002108           WCOM-ABENCICS                                          
002109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.                    
002110                                                                  
002111*     CALL 'DFHEI1' USING DFHEIV0  WCOM-ABENCICS.                 
002112 Z00-EX. EXIT.                                                    
002113*---------------------------------------------------------------- 
002114                                                                  
002115 9999-DFHBACK SECTION.                                            
002116     MOVE '9%                    "   ' TO DFHEIV0                 
002117     MOVE 'AVTLOGI' TO DFHEIV1                                    
002118     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1                        
002119     GOBACK.                                                      
002120 9999-DFHEXIT.                                                    
002121     IF DFHEIGDJ EQUAL 0001                                       
002122         NEXT SENTENCE                                            
002123     ELSE IF DFHEIGDJ EQUAL 2                                     
002124         GO TO Z00-ERRORE                                         
002125         DEPENDING ON DFHEIGDI.                                   
002126     MOVE '9%                    "   ' TO DFHEIV0                 
002127     MOVE 'AVTLOGI' TO DFHEIV1                                    
002128     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1                        
002129     GOBACK.                                                      
